var vn=Object.defineProperty;var En=(_,a,$)=>a in _?vn(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$;var en=(_,a,$)=>(En(_,typeof a!="symbol"?a+"":a,$),$),wn=(_,a,$)=>{if(!a.has(_))throw TypeError("Cannot "+$)};var Vr=(_,a,$)=>(wn(_,a,"read from private field"),$?$.call(_):a.get(_)),tn=(_,a,$)=>{if(a.has(_))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(_):a.set(_,$)},Lr=(_,a,$,j)=>(wn(_,a,"write to private field"),j?j.call(_,$):a.set(_,$),$),_n=(_,a,$,j)=>({set _(_e){Lr(_,a,_e,$)},get _(){return Vr(_,a,j)}});function _mergeNamespaces(_,a){for(var $=0;$<a.length;$++){const j=a[$];if(typeof j!="string"&&!Array.isArray(j)){for(const _e in j)if(_e!=="default"&&!(_e in _)){const et=Object.getOwnPropertyDescriptor(j,_e);et&&Object.defineProperty(_,_e,et.get?et:{enumerable:!0,get:()=>j[_e]})}}}return Object.freeze(Object.defineProperty(_,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const _e of document.querySelectorAll('link[rel="modulepreload"]'))j(_e);new MutationObserver(_e=>{for(const et of _e)if(et.type==="childList")for(const tt of et.addedNodes)tt.tagName==="LINK"&&tt.rel==="modulepreload"&&j(tt)}).observe(document,{childList:!0,subtree:!0});function $(_e){const et={};return _e.integrity&&(et.integrity=_e.integrity),_e.referrerpolicy&&(et.referrerPolicy=_e.referrerpolicy),_e.crossorigin==="use-credentials"?et.credentials="include":_e.crossorigin==="anonymous"?et.credentials="omit":et.credentials="same-origin",et}function j(_e){if(_e.ep)return;_e.ep=!0;const et=$(_e);fetch(_e.href,et)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof{}<"u"?{}:typeof self<"u"?self:{};function getDefaultExportFromCjs(_){return _&&_.__esModule&&Object.prototype.hasOwnProperty.call(_,"default")?_.default:_}function getAugmentedNamespace(_){var a=_.default;if(typeof a=="function"){var $=function(){return a.apply(this,arguments)};$.prototype=a.prototype}else $={};return Object.defineProperty($,"__esModule",{value:!0}),Object.keys(_).forEach(function(j){var _e=Object.getOwnPropertyDescriptor(_,j);Object.defineProperty($,j,_e.get?_e:{enumerable:!0,get:function(){return _[j]}})}),$}var react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$2=Symbol.for("react.element"),n$2=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$2=Symbol.for("react.strict_mode"),r$3=Symbol.for("react.profiler"),t$2=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w$2=Symbol.for("react.suspense"),x$2=Symbol.for("react.memo"),y$2=Symbol.for("react.lazy"),z$3=Symbol.iterator;function A$2(_){return _===null||typeof _!="object"?null:(_=z$3&&_[z$3]||_["@@iterator"],typeof _=="function"?_:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(_,a,$){this.props=_,this.context=a,this.refs=D$1,this.updater=$||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(_,a){if(typeof _!="object"&&typeof _!="function"&&_!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,_,a,"setState")};E$1.prototype.forceUpdate=function(_){this.updater.enqueueForceUpdate(this,_,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(_,a,$){this.props=_,this.context=a,this.refs=D$1,this.updater=$||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$3={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(_,a,$){var j,_e={},et=null,tt=null;if(a!=null)for(j in a.ref!==void 0&&(tt=a.ref),a.key!==void 0&&(et=""+a.key),a)J.call(a,j)&&!L$1.hasOwnProperty(j)&&(_e[j]=a[j]);var rt=arguments.length-2;if(rt===1)_e.children=$;else if(1<rt){for(var nt=Array(rt),it=0;it<rt;it++)nt[it]=arguments[it+2];_e.children=nt}if(_&&_.defaultProps)for(j in rt=_.defaultProps,rt)_e[j]===void 0&&(_e[j]=rt[j]);return{$$typeof:l$2,type:_,key:et,ref:tt,props:_e,_owner:K$3.current}}function N$1(_,a){return{$$typeof:l$2,type:_.type,key:a,ref:_.ref,props:_.props,_owner:_._owner}}function O$1(_){return typeof _=="object"&&_!==null&&_.$$typeof===l$2}function escape$1(_){var a={"=":"=0",":":"=2"};return"$"+_.replace(/[=:]/g,function($){return a[$]})}var P$1=/\/+/g;function Q$1(_,a){return typeof _=="object"&&_!==null&&_.key!=null?escape$1(""+_.key):a.toString(36)}function R$2(_,a,$,j,_e){var et=typeof _;(et==="undefined"||et==="boolean")&&(_=null);var tt=!1;if(_===null)tt=!0;else switch(et){case"string":case"number":tt=!0;break;case"object":switch(_.$$typeof){case l$2:case n$2:tt=!0}}if(tt)return tt=_,_e=_e(tt),_=j===""?"."+Q$1(tt,0):j,I$1(_e)?($="",_!=null&&($=_.replace(P$1,"$&/")+"/"),R$2(_e,a,$,"",function(it){return it})):_e!=null&&(O$1(_e)&&(_e=N$1(_e,$+(!_e.key||tt&&tt.key===_e.key?"":(""+_e.key).replace(P$1,"$&/")+"/")+_)),a.push(_e)),1;if(tt=0,j=j===""?".":j+":",I$1(_))for(var rt=0;rt<_.length;rt++){et=_[rt];var nt=j+Q$1(et,rt);tt+=R$2(et,a,$,nt,_e)}else if(nt=A$2(_),typeof nt=="function")for(_=nt.call(_),rt=0;!(et=_.next()).done;)et=et.value,nt=j+Q$1(et,rt++),tt+=R$2(et,a,$,nt,_e);else if(et==="object")throw a=String(_),Error("Objects are not valid as a React child (found: "+(a==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":a)+"). If you meant to render a collection of children, use an array instead.");return tt}function S$1(_,a,$){if(_==null)return _;var j=[],_e=0;return R$2(_,j,"","",function(et){return a.call($,et,_e++)}),j}function T$1(_){if(_._status===-1){var a=_._result;a=a(),a.then(function($){(_._status===0||_._status===-1)&&(_._status=1,_._result=$)},function($){(_._status===0||_._status===-1)&&(_._status=2,_._result=$)}),_._status===-1&&(_._status=0,_._result=a)}if(_._status===1)return _._result.default;throw _._result}var U$1={current:null},V$2={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$2,ReactCurrentOwner:K$3};react_production_min.Children={map:S$1,forEach:function(_,a,$){S$1(_,function(){a.apply(this,arguments)},$)},count:function(_){var a=0;return S$1(_,function(){a++}),a},toArray:function(_){return S$1(_,function(a){return a})||[]},only:function(_){if(!O$1(_))throw Error("React.Children.only expected to receive a single React element child.");return _}};react_production_min.Component=E$1;react_production_min.Fragment=p$3;react_production_min.Profiler=r$3;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$2;react_production_min.Suspense=w$2;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.cloneElement=function(_,a,$){if(_==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+_+".");var j=C$1({},_.props),_e=_.key,et=_.ref,tt=_._owner;if(a!=null){if(a.ref!==void 0&&(et=a.ref,tt=K$3.current),a.key!==void 0&&(_e=""+a.key),_.type&&_.type.defaultProps)var rt=_.type.defaultProps;for(nt in a)J.call(a,nt)&&!L$1.hasOwnProperty(nt)&&(j[nt]=a[nt]===void 0&&rt!==void 0?rt[nt]:a[nt])}var nt=arguments.length-2;if(nt===1)j.children=$;else if(1<nt){rt=Array(nt);for(var it=0;it<nt;it++)rt[it]=arguments[it+2];j.children=rt}return{$$typeof:l$2,type:_.type,key:_e,ref:et,props:j,_owner:tt}};react_production_min.createContext=function(_){return _={$$typeof:u,_currentValue:_,_currentValue2:_,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},_.Provider={$$typeof:t$2,_context:_},_.Consumer=_};react_production_min.createElement=M$1;react_production_min.createFactory=function(_){var a=M$1.bind(null,_);return a.type=_,a};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(_){return{$$typeof:v$2,render:_}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(_){return{$$typeof:y$2,_payload:{_status:-1,_result:_},_init:T$1}};react_production_min.memo=function(_,a){return{$$typeof:x$2,type:_,compare:a===void 0?null:a}};react_production_min.startTransition=function(_){var a=V$2.transition;V$2.transition={};try{_()}finally{V$2.transition=a}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(_,a){return U$1.current.useCallback(_,a)};react_production_min.useContext=function(_){return U$1.current.useContext(_)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(_){return U$1.current.useDeferredValue(_)};react_production_min.useEffect=function(_,a){return U$1.current.useEffect(_,a)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(_,a,$){return U$1.current.useImperativeHandle(_,a,$)};react_production_min.useInsertionEffect=function(_,a){return U$1.current.useInsertionEffect(_,a)};react_production_min.useLayoutEffect=function(_,a){return U$1.current.useLayoutEffect(_,a)};react_production_min.useMemo=function(_,a){return U$1.current.useMemo(_,a)};react_production_min.useReducer=function(_,a,$){return U$1.current.useReducer(_,a,$)};react_production_min.useRef=function(_){return U$1.current.useRef(_)};react_production_min.useState=function(_){return U$1.current.useState(_)};react_production_min.useSyncExternalStore=function(_,a,$){return U$1.current.useSyncExternalStore(_,a,$)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.2.0";(function(_){_.exports=react_production_min})(react);const React=getDefaultExportFromCjs(react.exports),React$1=_mergeNamespaces({__proto__:null,default:React},[react.exports]);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(_){function a(At,Nt){var Bt=At.length;At.push(Nt);e:for(;0<Bt;){var Ot=Bt-1>>>1,bt=At[Ot];if(0<_e(bt,Nt))At[Ot]=Nt,At[Bt]=bt,Bt=Ot;else break e}}function $(At){return At.length===0?null:At[0]}function j(At){if(At.length===0)return null;var Nt=At[0],Bt=At.pop();if(Bt!==Nt){At[0]=Bt;e:for(var Ot=0,bt=At.length,Rt=bt>>>1;Ot<Rt;){var Gt=2*(Ot+1)-1,Pt=At[Gt],Ft=Gt+1,jt=At[Ft];if(0>_e(Pt,Bt))Ft<bt&&0>_e(jt,Pt)?(At[Ot]=jt,At[Ft]=Bt,Ot=Ft):(At[Ot]=Pt,At[Gt]=Bt,Ot=Gt);else if(Ft<bt&&0>_e(jt,Bt))At[Ot]=jt,At[Ft]=Bt,Ot=Ft;else break e}}return Nt}function _e(At,Nt){var Bt=At.sortIndex-Nt.sortIndex;return Bt!==0?Bt:At.id-Nt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var et=performance;_.unstable_now=function(){return et.now()}}else{var tt=Date,rt=tt.now();_.unstable_now=function(){return tt.now()-rt}}var nt=[],it=[],st=1,ot=null,at=3,lt=!1,ct=!1,ut=!1,dt=typeof setTimeout=="function"?setTimeout:null,ft=typeof clearTimeout=="function"?clearTimeout:null,pt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function yt(At){for(var Nt=$(it);Nt!==null;){if(Nt.callback===null)j(it);else if(Nt.startTime<=At)j(it),Nt.sortIndex=Nt.expirationTime,a(nt,Nt);else break;Nt=$(it)}}function mt(At){if(ut=!1,yt(At),!ct)if($(nt)!==null)ct=!0,xt(_t);else{var Nt=$(it);Nt!==null&&Tt(mt,Nt.startTime-At)}}function _t(At,Nt){ct=!1,ut&&(ut=!1,ft(St),St=-1),lt=!0;var Bt=at;try{for(yt(Nt),ot=$(nt);ot!==null&&(!(ot.expirationTime>Nt)||At&&!Mt());){var Ot=ot.callback;if(typeof Ot=="function"){ot.callback=null,at=ot.priorityLevel;var bt=Ot(ot.expirationTime<=Nt);Nt=_.unstable_now(),typeof bt=="function"?ot.callback=bt:ot===$(nt)&&j(nt),yt(Nt)}else j(nt);ot=$(nt)}if(ot!==null)var Rt=!0;else{var Gt=$(it);Gt!==null&&Tt(mt,Gt.startTime-Nt),Rt=!1}return Rt}finally{ot=null,at=Bt,lt=!1}}var vt=!1,ht=null,St=-1,It=5,Lt=-1;function Mt(){return!(_.unstable_now()-Lt<It)}function Kt(){if(ht!==null){var At=_.unstable_now();Lt=At;var Nt=!0;try{Nt=ht(!0,At)}finally{Nt?kt():(vt=!1,ht=null)}}else vt=!1}var kt;if(typeof pt=="function")kt=function(){pt(Kt)};else if(typeof MessageChannel<"u"){var gt=new MessageChannel,Et=gt.port2;gt.port1.onmessage=Kt,kt=function(){Et.postMessage(null)}}else kt=function(){dt(Kt,0)};function xt(At){ht=At,vt||(vt=!0,kt())}function Tt(At,Nt){St=dt(function(){At(_.unstable_now())},Nt)}_.unstable_IdlePriority=5,_.unstable_ImmediatePriority=1,_.unstable_LowPriority=4,_.unstable_NormalPriority=3,_.unstable_Profiling=null,_.unstable_UserBlockingPriority=2,_.unstable_cancelCallback=function(At){At.callback=null},_.unstable_continueExecution=function(){ct||lt||(ct=!0,xt(_t))},_.unstable_forceFrameRate=function(At){0>At||125<At?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):It=0<At?Math.floor(1e3/At):5},_.unstable_getCurrentPriorityLevel=function(){return at},_.unstable_getFirstCallbackNode=function(){return $(nt)},_.unstable_next=function(At){switch(at){case 1:case 2:case 3:var Nt=3;break;default:Nt=at}var Bt=at;at=Nt;try{return At()}finally{at=Bt}},_.unstable_pauseExecution=function(){},_.unstable_requestPaint=function(){},_.unstable_runWithPriority=function(At,Nt){switch(At){case 1:case 2:case 3:case 4:case 5:break;default:At=3}var Bt=at;at=At;try{return Nt()}finally{at=Bt}},_.unstable_scheduleCallback=function(At,Nt,Bt){var Ot=_.unstable_now();switch(typeof Bt=="object"&&Bt!==null?(Bt=Bt.delay,Bt=typeof Bt=="number"&&0<Bt?Ot+Bt:Ot):Bt=Ot,At){case 1:var bt=-1;break;case 2:bt=250;break;case 5:bt=1073741823;break;case 4:bt=1e4;break;default:bt=5e3}return bt=Bt+bt,At={id:st++,callback:Nt,priorityLevel:At,startTime:Bt,expirationTime:bt,sortIndex:-1},Bt>Ot?(At.sortIndex=Bt,a(it,At),$(nt)===null&&At===$(it)&&(ut?(ft(St),St=-1):ut=!0,Tt(mt,Bt-Ot))):(At.sortIndex=bt,a(nt,At),ct||lt||(ct=!0,xt(_t))),At},_.unstable_shouldYield=Mt,_.unstable_wrapCallback=function(At){var Nt=at;return function(){var Bt=at;at=Nt;try{return At.apply(this,arguments)}finally{at=Bt}}}})(scheduler_production_min);(function(_){_.exports=scheduler_production_min})(scheduler);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=react.exports,ca=scheduler.exports;function p$2(_){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+_,$=1;$<arguments.length;$++)a+="&args[]="+encodeURIComponent(arguments[$]);return"Minified React error #"+_+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(_,a){ha(_,a),ha(_+"Capture",a)}function ha(_,a){for(ea[_]=a,_=0;_<a.length;_++)da.add(a[_])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(_){return ja.call(ma,_)?!0:ja.call(la,_)?!1:ka.test(_)?ma[_]=!0:(la[_]=!0,!1)}function pa(_,a,$,j){if($!==null&&$.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return j?!1:$!==null?!$.acceptsBooleans:(_=_.toLowerCase().slice(0,5),_!=="data-"&&_!=="aria-");default:return!1}}function qa(_,a,$,j){if(a===null||typeof a>"u"||pa(_,a,$,j))return!0;if(j)return!1;if($!==null)switch($.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function v$1(_,a,$,j,_e,et,tt){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=j,this.attributeNamespace=_e,this.mustUseProperty=$,this.propertyName=_,this.type=a,this.sanitizeURL=et,this.removeEmptyString=tt}var z$2={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(_){z$2[_]=new v$1(_,0,!1,_,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(_){var a=_[0];z$2[a]=new v$1(a,1,!1,_[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(_){z$2[_]=new v$1(_,2,!1,_.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(_){z$2[_]=new v$1(_,2,!1,_,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(_){z$2[_]=new v$1(_,3,!1,_.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(_){z$2[_]=new v$1(_,3,!0,_,null,!1,!1)});["capture","download"].forEach(function(_){z$2[_]=new v$1(_,4,!1,_,null,!1,!1)});["cols","rows","size","span"].forEach(function(_){z$2[_]=new v$1(_,6,!1,_,null,!1,!1)});["rowSpan","start"].forEach(function(_){z$2[_]=new v$1(_,5,!1,_.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(_){return _[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(_){var a=_.replace(ra,sa);z$2[a]=new v$1(a,1,!1,_,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(_){var a=_.replace(ra,sa);z$2[a]=new v$1(a,1,!1,_,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(_){var a=_.replace(ra,sa);z$2[a]=new v$1(a,1,!1,_,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(_){z$2[_]=new v$1(_,1,!1,_.toLowerCase(),null,!1,!1)});z$2.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(_){z$2[_]=new v$1(_,1,!1,_.toLowerCase(),null,!0,!0)});function ta(_,a,$,j){var _e=z$2.hasOwnProperty(a)?z$2[a]:null;(_e!==null?_e.type!==0:j||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(qa(a,$,_e,j)&&($=null),j||_e===null?oa(a)&&($===null?_.removeAttribute(a):_.setAttribute(a,""+$)):_e.mustUseProperty?_[_e.propertyName]=$===null?_e.type===3?!1:"":$:(a=_e.attributeName,j=_e.attributeNamespace,$===null?_.removeAttribute(a):(_e=_e.type,$=_e===3||_e===4&&$===!0?"":""+$,j?_.setAttributeNS(j,a,$):_.setAttribute(a,$))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(_){return _===null||typeof _!="object"?null:(_=Ja&&_[Ja]||_["@@iterator"],typeof _=="function"?_:null)}var A$1=Object.assign,La;function Ma(_){if(La===void 0)try{throw Error()}catch($){var a=$.stack.trim().match(/\n( *(at )?)/);La=a&&a[1]||""}return`
`+La+_}var Na=!1;function Oa(_,a){if(!_||Na)return"";Na=!0;var $=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(it){var j=it}Reflect.construct(_,[],a)}else{try{a.call()}catch(it){j=it}_.call(a.prototype)}else{try{throw Error()}catch(it){j=it}_()}}catch(it){if(it&&j&&typeof it.stack=="string"){for(var _e=it.stack.split(`
`),et=j.stack.split(`
`),tt=_e.length-1,rt=et.length-1;1<=tt&&0<=rt&&_e[tt]!==et[rt];)rt--;for(;1<=tt&&0<=rt;tt--,rt--)if(_e[tt]!==et[rt]){if(tt!==1||rt!==1)do if(tt--,rt--,0>rt||_e[tt]!==et[rt]){var nt=`
`+_e[tt].replace(" at new "," at ");return _.displayName&&nt.includes("<anonymous>")&&(nt=nt.replace("<anonymous>",_.displayName)),nt}while(1<=tt&&0<=rt);break}}}finally{Na=!1,Error.prepareStackTrace=$}return(_=_?_.displayName||_.name:"")?Ma(_):""}function Pa(_){switch(_.tag){case 5:return Ma(_.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return _=Oa(_.type,!1),_;case 11:return _=Oa(_.type.render,!1),_;case 1:return _=Oa(_.type,!0),_;default:return""}}function Qa(_){if(_==null)return null;if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _;switch(_){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof _=="object")switch(_.$$typeof){case Ca:return(_.displayName||"Context")+".Consumer";case Ba:return(_._context.displayName||"Context")+".Provider";case Da:var a=_.render;return _=_.displayName,_||(_=a.displayName||a.name||"",_=_!==""?"ForwardRef("+_+")":"ForwardRef"),_;case Ga:return a=_.displayName||null,a!==null?a:Qa(_.type)||"Memo";case Ha:a=_._payload,_=_._init;try{return Qa(_(a))}catch{}}return null}function Ra(_){var a=_.type;switch(_.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return _=a.render,_=_.displayName||_.name||"",a.displayName||(_!==""?"ForwardRef("+_+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(a);case 8:return a===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function Sa(_){switch(typeof _){case"boolean":case"number":case"string":case"undefined":return _;case"object":return _;default:return""}}function Ta(_){var a=_.type;return(_=_.nodeName)&&_.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ua(_){var a=Ta(_)?"checked":"value",$=Object.getOwnPropertyDescriptor(_.constructor.prototype,a),j=""+_[a];if(!_.hasOwnProperty(a)&&typeof $<"u"&&typeof $.get=="function"&&typeof $.set=="function"){var _e=$.get,et=$.set;return Object.defineProperty(_,a,{configurable:!0,get:function(){return _e.call(this)},set:function(tt){j=""+tt,et.call(this,tt)}}),Object.defineProperty(_,a,{enumerable:$.enumerable}),{getValue:function(){return j},setValue:function(tt){j=""+tt},stopTracking:function(){_._valueTracker=null,delete _[a]}}}}function Va(_){_._valueTracker||(_._valueTracker=Ua(_))}function Wa(_){if(!_)return!1;var a=_._valueTracker;if(!a)return!0;var $=a.getValue(),j="";return _&&(j=Ta(_)?_.checked?"true":"false":_.value),_=j,_!==$?(a.setValue(_),!0):!1}function Xa(_){if(_=_||(typeof document<"u"?document:void 0),typeof _>"u")return null;try{return _.activeElement||_.body}catch{return _.body}}function Ya(_,a){var $=a.checked;return A$1({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:$??_._wrapperState.initialChecked})}function Za(_,a){var $=a.defaultValue==null?"":a.defaultValue,j=a.checked!=null?a.checked:a.defaultChecked;$=Sa(a.value!=null?a.value:$),_._wrapperState={initialChecked:j,initialValue:$,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function ab(_,a){a=a.checked,a!=null&&ta(_,"checked",a,!1)}function bb(_,a){ab(_,a);var $=Sa(a.value),j=a.type;if($!=null)j==="number"?($===0&&_.value===""||_.value!=$)&&(_.value=""+$):_.value!==""+$&&(_.value=""+$);else if(j==="submit"||j==="reset"){_.removeAttribute("value");return}a.hasOwnProperty("value")?cb(_,a.type,$):a.hasOwnProperty("defaultValue")&&cb(_,a.type,Sa(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(_.defaultChecked=!!a.defaultChecked)}function db(_,a,$){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var j=a.type;if(!(j!=="submit"&&j!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+_._wrapperState.initialValue,$||a===_.value||(_.value=a),_.defaultValue=a}$=_.name,$!==""&&(_.name=""),_.defaultChecked=!!_._wrapperState.initialChecked,$!==""&&(_.name=$)}function cb(_,a,$){(a!=="number"||Xa(_.ownerDocument)!==_)&&($==null?_.defaultValue=""+_._wrapperState.initialValue:_.defaultValue!==""+$&&(_.defaultValue=""+$))}var eb=Array.isArray;function fb(_,a,$,j){if(_=_.options,a){a={};for(var _e=0;_e<$.length;_e++)a["$"+$[_e]]=!0;for($=0;$<_.length;$++)_e=a.hasOwnProperty("$"+_[$].value),_[$].selected!==_e&&(_[$].selected=_e),_e&&j&&(_[$].defaultSelected=!0)}else{for($=""+Sa($),a=null,_e=0;_e<_.length;_e++){if(_[_e].value===$){_[_e].selected=!0,j&&(_[_e].defaultSelected=!0);return}a!==null||_[_e].disabled||(a=_[_e])}a!==null&&(a.selected=!0)}}function gb(_,a){if(a.dangerouslySetInnerHTML!=null)throw Error(p$2(91));return A$1({},a,{value:void 0,defaultValue:void 0,children:""+_._wrapperState.initialValue})}function hb(_,a){var $=a.value;if($==null){if($=a.children,a=a.defaultValue,$!=null){if(a!=null)throw Error(p$2(92));if(eb($)){if(1<$.length)throw Error(p$2(93));$=$[0]}a=$}a==null&&(a=""),$=a}_._wrapperState={initialValue:Sa($)}}function ib(_,a){var $=Sa(a.value),j=Sa(a.defaultValue);$!=null&&($=""+$,$!==_.value&&(_.value=$),a.defaultValue==null&&_.defaultValue!==$&&(_.defaultValue=$)),j!=null&&(_.defaultValue=""+j)}function jb(_){var a=_.textContent;a===_._wrapperState.initialValue&&a!==""&&a!==null&&(_.value=a)}function kb(_){switch(_){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(_,a){return _==null||_==="http://www.w3.org/1999/xhtml"?kb(a):_==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":_}var mb,nb=function(_){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,$,j,_e){MSApp.execUnsafeLocalFunction(function(){return _(a,$,j,_e)})}:_}(function(_,a){if(_.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in _)_.innerHTML=a;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=mb.firstChild;_.firstChild;)_.removeChild(_.firstChild);for(;a.firstChild;)_.appendChild(a.firstChild)}});function ob(_,a){if(a){var $=_.firstChild;if($&&$===_.lastChild&&$.nodeType===3){$.nodeValue=a;return}}_.textContent=a}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(_){qb.forEach(function(a){a=a+_.charAt(0).toUpperCase()+_.substring(1),pb[a]=pb[_]})});function rb(_,a,$){return a==null||typeof a=="boolean"||a===""?"":$||typeof a!="number"||a===0||pb.hasOwnProperty(_)&&pb[_]?(""+a).trim():a+"px"}function sb(_,a){_=_.style;for(var $ in a)if(a.hasOwnProperty($)){var j=$.indexOf("--")===0,_e=rb($,a[$],j);$==="float"&&($="cssFloat"),j?_.setProperty($,_e):_[$]=_e}}var tb=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(_,a){if(a){if(tb[_]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(p$2(137,_));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(p$2(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(p$2(61))}if(a.style!=null&&typeof a.style!="object")throw Error(p$2(62))}}function vb(_,a){if(_.indexOf("-")===-1)return typeof a.is=="string";switch(_){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(_){return _=_.target||_.srcElement||window,_.correspondingUseElement&&(_=_.correspondingUseElement),_.nodeType===3?_.parentNode:_}var yb=null,zb=null,Ab=null;function Bb(_){if(_=Cb(_)){if(typeof yb!="function")throw Error(p$2(280));var a=_.stateNode;a&&(a=Db(a),yb(_.stateNode,_.type,a))}}function Eb(_){zb?Ab?Ab.push(_):Ab=[_]:zb=_}function Fb(){if(zb){var _=zb,a=Ab;if(Ab=zb=null,Bb(_),a)for(_=0;_<a.length;_++)Bb(a[_])}}function Gb(_,a){return _(a)}function Hb(){}var Ib=!1;function Jb$1(_,a,$){if(Ib)return _(a,$);Ib=!0;try{return Gb(_,a,$)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb$1(_,a){var $=_.stateNode;if($===null)return null;var j=Db($);if(j===null)return null;$=j[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(j=!j.disabled)||(_=_.type,j=!(_==="button"||_==="input"||_==="select"||_==="textarea")),_=!j;break e;default:_=!1}if(_)return null;if($&&typeof $!="function")throw Error(p$2(231,a,typeof $));return $}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb$1(_,a,$,j,_e,et,tt,rt,nt){var it=Array.prototype.slice.call(arguments,3);try{a.apply($,it)}catch(st){this.onError(st)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(_){Ob=!0,Pb=_}};function Tb(_,a,$,j,_e,et,tt,rt,nt){Ob=!1,Pb=null,Nb$1.apply(Sb,arguments)}function Ub(_,a,$,j,_e,et,tt,rt,nt){if(Tb.apply(this,arguments),Ob){if(Ob){var it=Pb;Ob=!1,Pb=null}else throw Error(p$2(198));Qb||(Qb=!0,Rb=it)}}function Vb(_){var a=_,$=_;if(_.alternate)for(;a.return;)a=a.return;else{_=a;do a=_,(a.flags&4098)!==0&&($=a.return),_=a.return;while(_)}return a.tag===3?$:null}function Wb(_){if(_.tag===13){var a=_.memoizedState;if(a===null&&(_=_.alternate,_!==null&&(a=_.memoizedState)),a!==null)return a.dehydrated}return null}function Xb(_){if(Vb(_)!==_)throw Error(p$2(188))}function Yb(_){var a=_.alternate;if(!a){if(a=Vb(_),a===null)throw Error(p$2(188));return a!==_?null:_}for(var $=_,j=a;;){var _e=$.return;if(_e===null)break;var et=_e.alternate;if(et===null){if(j=_e.return,j!==null){$=j;continue}break}if(_e.child===et.child){for(et=_e.child;et;){if(et===$)return Xb(_e),_;if(et===j)return Xb(_e),a;et=et.sibling}throw Error(p$2(188))}if($.return!==j.return)$=_e,j=et;else{for(var tt=!1,rt=_e.child;rt;){if(rt===$){tt=!0,$=_e,j=et;break}if(rt===j){tt=!0,j=_e,$=et;break}rt=rt.sibling}if(!tt){for(rt=et.child;rt;){if(rt===$){tt=!0,$=et,j=_e;break}if(rt===j){tt=!0,j=et,$=_e;break}rt=rt.sibling}if(!tt)throw Error(p$2(189))}}if($.alternate!==j)throw Error(p$2(190))}if($.tag!==3)throw Error(p$2(188));return $.stateNode.current===$?_:a}function Zb(_){return _=Yb(_),_!==null?$b(_):null}function $b(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){var a=$b(_);if(a!==null)return a;_=_.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec$1=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc$1=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(_){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,_,void 0,(_.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(_){return _>>>=0,_===0?32:31-(pc(_)/qc|0)|0}var rc=64,sc=4194304;function tc(_){switch(_&-_){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return _&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return _}}function uc(_,a){var $=_.pendingLanes;if($===0)return 0;var j=0,_e=_.suspendedLanes,et=_.pingedLanes,tt=$&268435455;if(tt!==0){var rt=tt&~_e;rt!==0?j=tc(rt):(et&=tt,et!==0&&(j=tc(et)))}else tt=$&~_e,tt!==0?j=tc(tt):et!==0&&(j=tc(et));if(j===0)return 0;if(a!==0&&a!==j&&(a&_e)===0&&(_e=j&-j,et=a&-a,_e>=et||_e===16&&(et&4194240)!==0))return a;if((j&4)!==0&&(j|=$&16),a=_.entangledLanes,a!==0)for(_=_.entanglements,a&=j;0<a;)$=31-oc(a),_e=1<<$,j|=_[$],a&=~_e;return j}function vc(_,a){switch(_){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(_,a){for(var $=_.suspendedLanes,j=_.pingedLanes,_e=_.expirationTimes,et=_.pendingLanes;0<et;){var tt=31-oc(et),rt=1<<tt,nt=_e[tt];nt===-1?((rt&$)===0||(rt&j)!==0)&&(_e[tt]=vc(rt,a)):nt<=a&&(_.expiredLanes|=rt),et&=~rt}}function xc(_){return _=_.pendingLanes&-1073741825,_!==0?_:_&1073741824?1073741824:0}function yc(){var _=rc;return rc<<=1,(rc&4194240)===0&&(rc=64),_}function zc(_){for(var a=[],$=0;31>$;$++)a.push(_);return a}function Ac(_,a,$){_.pendingLanes|=a,a!==536870912&&(_.suspendedLanes=0,_.pingedLanes=0),_=_.eventTimes,a=31-oc(a),_[a]=$}function Bc(_,a){var $=_.pendingLanes&~a;_.pendingLanes=a,_.suspendedLanes=0,_.pingedLanes=0,_.expiredLanes&=a,_.mutableReadLanes&=a,_.entangledLanes&=a,a=_.entanglements;var j=_.eventTimes;for(_=_.expirationTimes;0<$;){var _e=31-oc($),et=1<<_e;a[_e]=0,j[_e]=-1,_[_e]=-1,$&=~et}}function Cc(_,a){var $=_.entangledLanes|=a;for(_=_.entanglements;$;){var j=31-oc($),_e=1<<j;_e&a|_[j]&a&&(_[j]|=a),$&=~_e}}var C=0;function Dc(_){return _&=-_,1<_?4<_?(_&268435455)!==0?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(_,a){switch(_){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(a.pointerId)}}function Tc(_,a,$,j,_e,et){return _===null||_.nativeEvent!==et?(_={blockedOn:a,domEventName:$,eventSystemFlags:j,nativeEvent:et,targetContainers:[_e]},a!==null&&(a=Cb(a),a!==null&&Fc(a)),_):(_.eventSystemFlags|=j,a=_.targetContainers,_e!==null&&a.indexOf(_e)===-1&&a.push(_e),_)}function Uc(_,a,$,j,_e){switch(a){case"focusin":return Lc=Tc(Lc,_,a,$,j,_e),!0;case"dragenter":return Mc=Tc(Mc,_,a,$,j,_e),!0;case"mouseover":return Nc=Tc(Nc,_,a,$,j,_e),!0;case"pointerover":var et=_e.pointerId;return Oc.set(et,Tc(Oc.get(et)||null,_,a,$,j,_e)),!0;case"gotpointercapture":return et=_e.pointerId,Pc.set(et,Tc(Pc.get(et)||null,_,a,$,j,_e)),!0}return!1}function Vc(_){var a=Wc(_.target);if(a!==null){var $=Vb(a);if($!==null){if(a=$.tag,a===13){if(a=Wb($),a!==null){_.blockedOn=a,Ic(_.priority,function(){Gc($)});return}}else if(a===3&&$.stateNode.current.memoizedState.isDehydrated){_.blockedOn=$.tag===3?$.stateNode.containerInfo:null;return}}}_.blockedOn=null}function Xc(_){if(_.blockedOn!==null)return!1;for(var a=_.targetContainers;0<a.length;){var $=Yc(_.domEventName,_.eventSystemFlags,a[0],_.nativeEvent);if($===null){$=_.nativeEvent;var j=new $.constructor($.type,$);wb=j,$.target.dispatchEvent(j),wb=null}else return a=Cb($),a!==null&&Fc(a),_.blockedOn=$,!1;a.shift()}return!0}function Zc(_,a,$){Xc(_)&&$.delete(a)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(_,a){_.blockedOn===a&&(_.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(_){function a(_e){return ad(_e,_)}if(0<Kc.length){ad(Kc[0],_);for(var $=1;$<Kc.length;$++){var j=Kc[$];j.blockedOn===_&&(j.blockedOn=null)}}for(Lc!==null&&ad(Lc,_),Mc!==null&&ad(Mc,_),Nc!==null&&ad(Nc,_),Oc.forEach(a),Pc.forEach(a),$=0;$<Qc.length;$++)j=Qc[$],j.blockedOn===_&&(j.blockedOn=null);for(;0<Qc.length&&($=Qc[0],$.blockedOn===null);)Vc($),$.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(_,a,$,j){var _e=C,et=cd.transition;cd.transition=null;try{C=1,fd(_,a,$,j)}finally{C=_e,cd.transition=et}}function gd(_,a,$,j){var _e=C,et=cd.transition;cd.transition=null;try{C=4,fd(_,a,$,j)}finally{C=_e,cd.transition=et}}function fd(_,a,$,j){if(dd){var _e=Yc(_,a,$,j);if(_e===null)hd(_,a,j,id$1,$),Sc(_,j);else if(Uc(_e,_,a,$,j))j.stopPropagation();else if(Sc(_,j),a&4&&-1<Rc.indexOf(_)){for(;_e!==null;){var et=Cb(_e);if(et!==null&&Ec(et),et=Yc(_,a,$,j),et===null&&hd(_,a,j,id$1,$),et===_e)break;_e=et}_e!==null&&j.stopPropagation()}else hd(_,a,j,null,$)}}var id$1=null;function Yc(_,a,$,j){if(id$1=null,_=xb(j),_=Wc(_),_!==null)if(a=Vb(_),a===null)_=null;else if($=a.tag,$===13){if(_=Wb(a),_!==null)return _;_=null}else if($===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;_=null}else a!==_&&(_=null);return id$1=_,null}function jd(_){switch(_){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec$1()){case fc:return 1;case gc$1:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var _,a=ld,$=a.length,j,_e="value"in kd?kd.value:kd.textContent,et=_e.length;for(_=0;_<$&&a[_]===_e[_];_++);var tt=$-_;for(j=1;j<=tt&&a[$-j]===_e[et-j];j++);return md=_e.slice(_,1<j?1-j:void 0)}function od(_){var a=_.keyCode;return"charCode"in _?(_=_.charCode,_===0&&a===13&&(_=13)):_=a,_===10&&(_=13),32<=_||_===13?_:0}function pd(){return!0}function qd(){return!1}function rd(_){function a($,j,_e,et,tt){this._reactName=$,this._targetInst=_e,this.type=j,this.nativeEvent=et,this.target=tt,this.currentTarget=null;for(var rt in _)_.hasOwnProperty(rt)&&($=_[rt],this[rt]=$?$(et):et[rt]);return this.isDefaultPrevented=(et.defaultPrevented!=null?et.defaultPrevented:et.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$1(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var $=this.nativeEvent;$&&($.preventDefault?$.preventDefault():typeof $.returnValue!="unknown"&&($.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var $=this.nativeEvent;$&&($.stopPropagation?$.stopPropagation():typeof $.cancelBubble!="unknown"&&($.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),a}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(_){return _.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$1({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$1({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(_){return _.relatedTarget===void 0?_.fromElement===_.srcElement?_.toElement:_.fromElement:_.relatedTarget},movementX:function(_){return"movementX"in _?_.movementX:(_!==yd&&(yd&&_.type==="mousemove"?(wd=_.screenX-yd.screenX,xd=_.screenY-yd.screenY):xd=wd=0,yd=_),wd)},movementY:function(_){return"movementY"in _?_.movementY:xd}}),Bd=rd(Ad),Cd=A$1({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$1({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$1({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$1({},sd,{clipboardData:function(_){return"clipboardData"in _?_.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$1({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(_){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(_):(_=Od[_])?!!a[_]:!1}function zd(){return Pd}var Qd=A$1({},ud,{key:function(_){if(_.key){var a=Md[_.key]||_.key;if(a!=="Unidentified")return a}return _.type==="keypress"?(_=od(_),_===13?"Enter":String.fromCharCode(_)):_.type==="keydown"||_.type==="keyup"?Nd[_.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(_){return _.type==="keypress"?od(_):0},keyCode:function(_){return _.type==="keydown"||_.type==="keyup"?_.keyCode:0},which:function(_){return _.type==="keypress"?od(_):_.type==="keydown"||_.type==="keyup"?_.keyCode:0}}),Rd=rd(Qd),Sd=A$1({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$1({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$1({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$1({},Ad,{deltaX:function(_){return"deltaX"in _?_.deltaX:"wheelDeltaX"in _?-_.wheelDeltaX:0},deltaY:function(_){return"deltaY"in _?_.deltaY:"wheelDeltaY"in _?-_.wheelDeltaY:"wheelDelta"in _?-_.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe$1=!1;function ge(_,a){switch(_){case"keyup":return $d.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(_){return _=_.detail,typeof _=="object"&&"data"in _?_.data:null}var ie=!1;function je(_,a){switch(_){case"compositionend":return he(a);case"keypress":return a.which!==32?null:(fe$1=!0,ee);case"textInput":return _=a.data,_===ee&&fe$1?null:_;default:return null}}function ke(_,a){if(ie)return _==="compositionend"||!ae&&ge(_,a)?(_=nd(),md=ld=kd=null,ie=!1,_):null;switch(_){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return de&&a.locale!=="ko"?null:a.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(_){var a=_&&_.nodeName&&_.nodeName.toLowerCase();return a==="input"?!!le[_.type]:a==="textarea"}function ne(_,a,$,j){Eb(j),a=oe(a,"onChange"),0<a.length&&($=new td("onChange","change",null,$,j),_.push({event:$,listeners:a}))}var pe=null,qe=null;function re$1(_){se(_,0)}function te(_){var a=ue(_);if(Wa(a))return _}function ve(_,a){if(_==="change")return a}var we=!1;if(ia){var xe$1;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe$1=ye}else xe$1=!1;we=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(_){if(_.propertyName==="value"&&te(qe)){var a=[];ne(a,qe,_,xb(_)),Jb$1(re$1,a)}}function Ce(_,a,$){_==="focusin"?(Ae(),pe=a,qe=$,pe.attachEvent("onpropertychange",Be)):_==="focusout"&&Ae()}function De(_){if(_==="selectionchange"||_==="keyup"||_==="keydown")return te(qe)}function Ee(_,a){if(_==="click")return te(a)}function Fe(_,a){if(_==="input"||_==="change")return te(a)}function Ge(_,a){return _===a&&(_!==0||1/_===1/a)||_!==_&&a!==a}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(_,a){if(He(_,a))return!0;if(typeof _!="object"||_===null||typeof a!="object"||a===null)return!1;var $=Object.keys(_),j=Object.keys(a);if($.length!==j.length)return!1;for(j=0;j<$.length;j++){var _e=$[j];if(!ja.call(a,_e)||!He(_[_e],a[_e]))return!1}return!0}function Je(_){for(;_&&_.firstChild;)_=_.firstChild;return _}function Ke(_,a){var $=Je(_);_=0;for(var j;$;){if($.nodeType===3){if(j=_+$.textContent.length,_<=a&&j>=a)return{node:$,offset:a-_};_=j}e:{for(;$;){if($.nextSibling){$=$.nextSibling;break e}$=$.parentNode}$=void 0}$=Je($)}}function Le(_,a){return _&&a?_===a?!0:_&&_.nodeType===3?!1:a&&a.nodeType===3?Le(_,a.parentNode):"contains"in _?_.contains(a):_.compareDocumentPosition?!!(_.compareDocumentPosition(a)&16):!1:!1}function Me(){for(var _=window,a=Xa();a instanceof _.HTMLIFrameElement;){try{var $=typeof a.contentWindow.location.href=="string"}catch{$=!1}if($)_=a.contentWindow;else break;a=Xa(_.document)}return a}function Ne(_){var a=_&&_.nodeName&&_.nodeName.toLowerCase();return a&&(a==="input"&&(_.type==="text"||_.type==="search"||_.type==="tel"||_.type==="url"||_.type==="password")||a==="textarea"||_.contentEditable==="true")}function Oe(_){var a=Me(),$=_.focusedElem,j=_.selectionRange;if(a!==$&&$&&$.ownerDocument&&Le($.ownerDocument.documentElement,$)){if(j!==null&&Ne($)){if(a=j.start,_=j.end,_===void 0&&(_=a),"selectionStart"in $)$.selectionStart=a,$.selectionEnd=Math.min(_,$.value.length);else if(_=(a=$.ownerDocument||document)&&a.defaultView||window,_.getSelection){_=_.getSelection();var _e=$.textContent.length,et=Math.min(j.start,_e);j=j.end===void 0?et:Math.min(j.end,_e),!_.extend&&et>j&&(_e=j,j=et,et=_e),_e=Ke($,et);var tt=Ke($,j);_e&&tt&&(_.rangeCount!==1||_.anchorNode!==_e.node||_.anchorOffset!==_e.offset||_.focusNode!==tt.node||_.focusOffset!==tt.offset)&&(a=a.createRange(),a.setStart(_e.node,_e.offset),_.removeAllRanges(),et>j?(_.addRange(a),_.extend(tt.node,tt.offset)):(a.setEnd(tt.node,tt.offset),_.addRange(a)))}}for(a=[],_=$;_=_.parentNode;)_.nodeType===1&&a.push({element:_,left:_.scrollLeft,top:_.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<a.length;$++)_=a[$],_.element.scrollLeft=_.left,_.element.scrollTop=_.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(_,a,$){var j=$.window===$?$.document:$.nodeType===9?$:$.ownerDocument;Te||Qe==null||Qe!==Xa(j)||(j=Qe,"selectionStart"in j&&Ne(j)?j={start:j.selectionStart,end:j.selectionEnd}:(j=(j.ownerDocument&&j.ownerDocument.defaultView||window).getSelection(),j={anchorNode:j.anchorNode,anchorOffset:j.anchorOffset,focusNode:j.focusNode,focusOffset:j.focusOffset}),Se&&Ie(Se,j)||(Se=j,j=oe(Re,"onSelect"),0<j.length&&(a=new td("onSelect","select",null,a,$),_.push({event:a,listeners:j}),a.target=Qe)))}function Ve(_,a){var $={};return $[_.toLowerCase()]=a.toLowerCase(),$["Webkit"+_]="webkit"+a,$["Moz"+_]="moz"+a,$}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(_){if(Xe[_])return Xe[_];if(!We[_])return _;var a=We[_],$;for($ in a)if(a.hasOwnProperty($)&&$ in Ye)return Xe[_]=a[$];return _}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(_,a){df.set(_,a),fa(a,[_])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(_,a,$){var j=_.type||"unknown-event";_.currentTarget=$,Ub(j,a,void 0,_),_.currentTarget=null}function se(_,a){a=(a&4)!==0;for(var $=0;$<_.length;$++){var j=_[$],_e=j.event;j=j.listeners;e:{var et=void 0;if(a)for(var tt=j.length-1;0<=tt;tt--){var rt=j[tt],nt=rt.instance,it=rt.currentTarget;if(rt=rt.listener,nt!==et&&_e.isPropagationStopped())break e;nf(_e,rt,it),et=nt}else for(tt=0;tt<j.length;tt++){if(rt=j[tt],nt=rt.instance,it=rt.currentTarget,rt=rt.listener,nt!==et&&_e.isPropagationStopped())break e;nf(_e,rt,it),et=nt}}}if(Qb)throw _=Rb,Qb=!1,Rb=null,_}function D(_,a){var $=a[of];$===void 0&&($=a[of]=new Set);var j=_+"__bubble";$.has(j)||(pf(a,_,2,!1),$.add(j))}function qf(_,a,$){var j=0;a&&(j|=4),pf($,_,j,a)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(_){if(!_[rf]){_[rf]=!0,da.forEach(function($){$!=="selectionchange"&&(mf.has($)||qf($,!1,_),qf($,!0,_))});var a=_.nodeType===9?_:_.ownerDocument;a===null||a[rf]||(a[rf]=!0,qf("selectionchange",!1,a))}}function pf(_,a,$,j){switch(jd(a)){case 1:var _e=ed;break;case 4:_e=gd;break;default:_e=fd}$=_e.bind(null,a,$,_),_e=void 0,!Lb||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_e=!0),j?_e!==void 0?_.addEventListener(a,$,{capture:!0,passive:_e}):_.addEventListener(a,$,!0):_e!==void 0?_.addEventListener(a,$,{passive:_e}):_.addEventListener(a,$,!1)}function hd(_,a,$,j,_e){var et=j;if((a&1)===0&&(a&2)===0&&j!==null)e:for(;;){if(j===null)return;var tt=j.tag;if(tt===3||tt===4){var rt=j.stateNode.containerInfo;if(rt===_e||rt.nodeType===8&&rt.parentNode===_e)break;if(tt===4)for(tt=j.return;tt!==null;){var nt=tt.tag;if((nt===3||nt===4)&&(nt=tt.stateNode.containerInfo,nt===_e||nt.nodeType===8&&nt.parentNode===_e))return;tt=tt.return}for(;rt!==null;){if(tt=Wc(rt),tt===null)return;if(nt=tt.tag,nt===5||nt===6){j=et=tt;continue e}rt=rt.parentNode}}j=j.return}Jb$1(function(){var it=et,st=xb($),ot=[];e:{var at=df.get(_);if(at!==void 0){var lt=td,ct=_;switch(_){case"keypress":if(od($)===0)break e;case"keydown":case"keyup":lt=Rd;break;case"focusin":ct="focus",lt=Fd;break;case"focusout":ct="blur",lt=Fd;break;case"beforeblur":case"afterblur":lt=Fd;break;case"click":if($.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":lt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":lt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":lt=Vd;break;case $e:case af:case bf:lt=Hd;break;case cf:lt=Xd;break;case"scroll":lt=vd;break;case"wheel":lt=Zd;break;case"copy":case"cut":case"paste":lt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":lt=Td}var ut=(a&4)!==0,dt=!ut&&_==="scroll",ft=ut?at!==null?at+"Capture":null:at;ut=[];for(var pt=it,yt;pt!==null;){yt=pt;var mt=yt.stateNode;if(yt.tag===5&&mt!==null&&(yt=mt,ft!==null&&(mt=Kb$1(pt,ft),mt!=null&&ut.push(tf(pt,mt,yt)))),dt)break;pt=pt.return}0<ut.length&&(at=new lt(at,ct,null,$,st),ot.push({event:at,listeners:ut}))}}if((a&7)===0){e:{if(at=_==="mouseover"||_==="pointerover",lt=_==="mouseout"||_==="pointerout",at&&$!==wb&&(ct=$.relatedTarget||$.fromElement)&&(Wc(ct)||ct[uf]))break e;if((lt||at)&&(at=st.window===st?st:(at=st.ownerDocument)?at.defaultView||at.parentWindow:window,lt?(ct=$.relatedTarget||$.toElement,lt=it,ct=ct?Wc(ct):null,ct!==null&&(dt=Vb(ct),ct!==dt||ct.tag!==5&&ct.tag!==6)&&(ct=null)):(lt=null,ct=it),lt!==ct)){if(ut=Bd,mt="onMouseLeave",ft="onMouseEnter",pt="mouse",(_==="pointerout"||_==="pointerover")&&(ut=Td,mt="onPointerLeave",ft="onPointerEnter",pt="pointer"),dt=lt==null?at:ue(lt),yt=ct==null?at:ue(ct),at=new ut(mt,pt+"leave",lt,$,st),at.target=dt,at.relatedTarget=yt,mt=null,Wc(st)===it&&(ut=new ut(ft,pt+"enter",ct,$,st),ut.target=yt,ut.relatedTarget=dt,mt=ut),dt=mt,lt&&ct)t:{for(ut=lt,ft=ct,pt=0,yt=ut;yt;yt=vf(yt))pt++;for(yt=0,mt=ft;mt;mt=vf(mt))yt++;for(;0<pt-yt;)ut=vf(ut),pt--;for(;0<yt-pt;)ft=vf(ft),yt--;for(;pt--;){if(ut===ft||ft!==null&&ut===ft.alternate)break t;ut=vf(ut),ft=vf(ft)}ut=null}else ut=null;lt!==null&&wf(ot,at,lt,ut,!1),ct!==null&&dt!==null&&wf(ot,dt,ct,ut,!0)}}e:{if(at=it?ue(it):window,lt=at.nodeName&&at.nodeName.toLowerCase(),lt==="select"||lt==="input"&&at.type==="file")var _t=ve;else if(me(at))if(we)_t=Fe;else{_t=De;var vt=Ce}else(lt=at.nodeName)&&lt.toLowerCase()==="input"&&(at.type==="checkbox"||at.type==="radio")&&(_t=Ee);if(_t&&(_t=_t(_,it))){ne(ot,_t,$,st);break e}vt&&vt(_,at,it),_==="focusout"&&(vt=at._wrapperState)&&vt.controlled&&at.type==="number"&&cb(at,"number",at.value)}switch(vt=it?ue(it):window,_){case"focusin":(me(vt)||vt.contentEditable==="true")&&(Qe=vt,Re=it,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(ot,$,st);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(ot,$,st)}var ht;if(ae)e:{switch(_){case"compositionstart":var St="onCompositionStart";break e;case"compositionend":St="onCompositionEnd";break e;case"compositionupdate":St="onCompositionUpdate";break e}St=void 0}else ie?ge(_,$)&&(St="onCompositionEnd"):_==="keydown"&&$.keyCode===229&&(St="onCompositionStart");St&&(de&&$.locale!=="ko"&&(ie||St!=="onCompositionStart"?St==="onCompositionEnd"&&ie&&(ht=nd()):(kd=st,ld="value"in kd?kd.value:kd.textContent,ie=!0)),vt=oe(it,St),0<vt.length&&(St=new Ld(St,_,null,$,st),ot.push({event:St,listeners:vt}),ht?St.data=ht:(ht=he($),ht!==null&&(St.data=ht)))),(ht=ce?je(_,$):ke(_,$))&&(it=oe(it,"onBeforeInput"),0<it.length&&(st=new Ld("onBeforeInput","beforeinput",null,$,st),ot.push({event:st,listeners:it}),st.data=ht))}se(ot,a)})}function tf(_,a,$){return{instance:_,listener:a,currentTarget:$}}function oe(_,a){for(var $=a+"Capture",j=[];_!==null;){var _e=_,et=_e.stateNode;_e.tag===5&&et!==null&&(_e=et,et=Kb$1(_,$),et!=null&&j.unshift(tf(_,et,_e)),et=Kb$1(_,a),et!=null&&j.push(tf(_,et,_e))),_=_.return}return j}function vf(_){if(_===null)return null;do _=_.return;while(_&&_.tag!==5);return _||null}function wf(_,a,$,j,_e){for(var et=a._reactName,tt=[];$!==null&&$!==j;){var rt=$,nt=rt.alternate,it=rt.stateNode;if(nt!==null&&nt===j)break;rt.tag===5&&it!==null&&(rt=it,_e?(nt=Kb$1($,et),nt!=null&&tt.unshift(tf($,nt,rt))):_e||(nt=Kb$1($,et),nt!=null&&tt.push(tf($,nt,rt)))),$=$.return}tt.length!==0&&_.push({event:a,listeners:tt})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(_){return(typeof _=="string"?_:""+_).replace(xf,`
`).replace(yf,"")}function Af(_,a,$){if(a=zf(a),zf(_)!==a&&$)throw Error(p$2(425))}function Bf(){}var Cf=null,Df=null;function Ef(_,a){return _==="textarea"||_==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(_){return Hf.resolve(null).then(_).catch(If)}:Ff;function If(_){setTimeout(function(){throw _})}function Kf(_,a){var $=a,j=0;do{var _e=$.nextSibling;if(_.removeChild($),_e&&_e.nodeType===8)if($=_e.data,$==="/$"){if(j===0){_.removeChild(_e),bd(a);return}j--}else $!=="$"&&$!=="$?"&&$!=="$!"||j++;$=_e}while($);bd(a)}function Lf(_){for(;_!=null;_=_.nextSibling){var a=_.nodeType;if(a===1||a===3)break;if(a===8){if(a=_.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return _}function Mf(_){_=_.previousSibling;for(var a=0;_;){if(_.nodeType===8){var $=_.data;if($==="$"||$==="$!"||$==="$?"){if(a===0)return _;a--}else $==="/$"&&a++}_=_.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(_){var a=_[Of];if(a)return a;for(var $=_.parentNode;$;){if(a=$[uf]||$[Of]){if($=a.alternate,a.child!==null||$!==null&&$.child!==null)for(_=Mf(_);_!==null;){if($=_[Of])return $;_=Mf(_)}return a}_=$,$=_.parentNode}return null}function Cb(_){return _=_[Of]||_[uf],!_||_.tag!==5&&_.tag!==6&&_.tag!==13&&_.tag!==3?null:_}function ue(_){if(_.tag===5||_.tag===6)return _.stateNode;throw Error(p$2(33))}function Db(_){return _[Pf]||null}var Sf=[],Tf=-1;function Uf(_){return{current:_}}function E(_){0>Tf||(_.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(_,a){Tf++,Sf[Tf]=_.current,_.current=a}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(_,a){var $=_.type.contextTypes;if(!$)return Vf;var j=_.stateNode;if(j&&j.__reactInternalMemoizedUnmaskedChildContext===a)return j.__reactInternalMemoizedMaskedChildContext;var _e={},et;for(et in $)_e[et]=a[et];return j&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=a,_.__reactInternalMemoizedMaskedChildContext=_e),_e}function Zf(_){return _=_.childContextTypes,_!=null}function $f(){E(Wf),E(H)}function ag(_,a,$){if(H.current!==Vf)throw Error(p$2(168));G(H,a),G(Wf,$)}function bg(_,a,$){var j=_.stateNode;if(a=a.childContextTypes,typeof j.getChildContext!="function")return $;j=j.getChildContext();for(var _e in j)if(!(_e in a))throw Error(p$2(108,Ra(_)||"Unknown",_e));return A$1({},$,j)}function cg(_){return _=(_=_.stateNode)&&_.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,_),G(Wf,Wf.current),!0}function dg(_,a,$){var j=_.stateNode;if(!j)throw Error(p$2(169));$?(_=bg(_,a,Xf),j.__reactInternalMemoizedMergedChildContext=_,E(Wf),E(H),G(H,_)):E(Wf),G(Wf,$)}var eg=null,fg=!1,gg=!1;function hg(_){eg===null?eg=[_]:eg.push(_)}function ig(_){fg=!0,hg(_)}function jg(){if(!gg&&eg!==null){gg=!0;var _=0,a=C;try{var $=eg;for(C=1;_<$.length;_++){var j=$[_];do j=j(!0);while(j!==null)}eg=null,fg=!1}catch(_e){throw eg!==null&&(eg=eg.slice(_+1)),ac(fc,jg),_e}finally{C=a,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(_,a){kg[lg++]=ng,kg[lg++]=mg,mg=_,ng=a}function ug(_,a,$){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=_;var j=rg;_=sg;var _e=32-oc(j)-1;j&=~(1<<_e),$+=1;var et=32-oc(a)+_e;if(30<et){var tt=_e-_e%5;et=(j&(1<<tt)-1).toString(32),j>>=tt,_e-=tt,rg=1<<32-oc(a)+_e|$<<_e|j,sg=et+_}else rg=1<<et|$<<_e|j,sg=_}function vg(_){_.return!==null&&(tg(_,1),ug(_,1,0))}function wg(_){for(;_===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;_===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(_,a){var $=Bg(5,null,null,0);$.elementType="DELETED",$.stateNode=a,$.return=_,a=_.deletions,a===null?(_.deletions=[$],_.flags|=16):a.push($)}function Cg(_,a){switch(_.tag){case 5:var $=_.type;return a=a.nodeType!==1||$.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(_.stateNode=a,xg=_,yg=Lf(a.firstChild),!0):!1;case 6:return a=_.pendingProps===""||a.nodeType!==3?null:a,a!==null?(_.stateNode=a,xg=_,yg=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?($=qg!==null?{id:rg,overflow:sg}:null,_.memoizedState={dehydrated:a,treeContext:$,retryLane:1073741824},$=Bg(18,null,null,0),$.stateNode=a,$.return=_,_.child=$,xg=_,yg=null,!0):!1;default:return!1}}function Dg(_){return(_.mode&1)!==0&&(_.flags&128)===0}function Eg(_){if(I){var a=yg;if(a){var $=a;if(!Cg(_,a)){if(Dg(_))throw Error(p$2(418));a=Lf($.nextSibling);var j=xg;a&&Cg(_,a)?Ag(j,$):(_.flags=_.flags&-4097|2,I=!1,xg=_)}}else{if(Dg(_))throw Error(p$2(418));_.flags=_.flags&-4097|2,I=!1,xg=_}}}function Fg(_){for(_=_.return;_!==null&&_.tag!==5&&_.tag!==3&&_.tag!==13;)_=_.return;xg=_}function Gg(_){if(_!==xg)return!1;if(!I)return Fg(_),I=!0,!1;var a;if((a=_.tag!==3)&&!(a=_.tag!==5)&&(a=_.type,a=a!=="head"&&a!=="body"&&!Ef(_.type,_.memoizedProps)),a&&(a=yg)){if(Dg(_))throw Hg(),Error(p$2(418));for(;a;)Ag(_,a),a=Lf(a.nextSibling)}if(Fg(_),_.tag===13){if(_=_.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(p$2(317));e:{for(_=_.nextSibling,a=0;_;){if(_.nodeType===8){var $=_.data;if($==="/$"){if(a===0){yg=Lf(_.nextSibling);break e}a--}else $!=="$"&&$!=="$!"&&$!=="$?"||a++}_=_.nextSibling}yg=null}}else yg=xg?Lf(_.stateNode.nextSibling):null;return!0}function Hg(){for(var _=yg;_;)_=Lf(_.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(_){zg===null?zg=[_]:zg.push(_)}var Kg=ua.ReactCurrentBatchConfig;function Lg(_,a){if(_&&_.defaultProps){a=A$1({},a),_=_.defaultProps;for(var $ in _)a[$]===void 0&&(a[$]=_[$]);return a}return a}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(_){var a=Mg.current;E(Mg),_._currentValue=a}function Sg(_,a,$){for(;_!==null;){var j=_.alternate;if((_.childLanes&a)!==a?(_.childLanes|=a,j!==null&&(j.childLanes|=a)):j!==null&&(j.childLanes&a)!==a&&(j.childLanes|=a),_===$)break;_=_.return}}function Tg(_,a){Ng=_,Pg=Og=null,_=_.dependencies,_!==null&&_.firstContext!==null&&((_.lanes&a)!==0&&(Ug=!0),_.firstContext=null)}function Vg(_){var a=_._currentValue;if(Pg!==_)if(_={context:_,memoizedValue:a,next:null},Og===null){if(Ng===null)throw Error(p$2(308));Og=_,Ng.dependencies={lanes:0,firstContext:_}}else Og=Og.next=_;return a}var Wg=null;function Xg(_){Wg===null?Wg=[_]:Wg.push(_)}function Yg(_,a,$,j){var _e=a.interleaved;return _e===null?($.next=$,Xg(a)):($.next=_e.next,_e.next=$),a.interleaved=$,Zg(_,j)}function Zg(_,a){_.lanes|=a;var $=_.alternate;for($!==null&&($.lanes|=a),$=_,_=_.return;_!==null;)_.childLanes|=a,$=_.alternate,$!==null&&($.childLanes|=a),$=_,_=_.return;return $.tag===3?$.stateNode:null}var $g=!1;function ah(_){_.updateQueue={baseState:_.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(_,a){_=_.updateQueue,a.updateQueue===_&&(a.updateQueue={baseState:_.baseState,firstBaseUpdate:_.firstBaseUpdate,lastBaseUpdate:_.lastBaseUpdate,shared:_.shared,effects:_.effects})}function ch(_,a){return{eventTime:_,lane:a,tag:0,payload:null,callback:null,next:null}}function dh(_,a,$){var j=_.updateQueue;if(j===null)return null;if(j=j.shared,(K$2&2)!==0){var _e=j.pending;return _e===null?a.next=a:(a.next=_e.next,_e.next=a),j.pending=a,Zg(_,$)}return _e=j.interleaved,_e===null?(a.next=a,Xg(j)):(a.next=_e.next,_e.next=a),j.interleaved=a,Zg(_,$)}function eh(_,a,$){if(a=a.updateQueue,a!==null&&(a=a.shared,($&4194240)!==0)){var j=a.lanes;j&=_.pendingLanes,$|=j,a.lanes=$,Cc(_,$)}}function fh(_,a){var $=_.updateQueue,j=_.alternate;if(j!==null&&(j=j.updateQueue,$===j)){var _e=null,et=null;if($=$.firstBaseUpdate,$!==null){do{var tt={eventTime:$.eventTime,lane:$.lane,tag:$.tag,payload:$.payload,callback:$.callback,next:null};et===null?_e=et=tt:et=et.next=tt,$=$.next}while($!==null);et===null?_e=et=a:et=et.next=a}else _e=et=a;$={baseState:j.baseState,firstBaseUpdate:_e,lastBaseUpdate:et,shared:j.shared,effects:j.effects},_.updateQueue=$;return}_=$.lastBaseUpdate,_===null?$.firstBaseUpdate=a:_.next=a,$.lastBaseUpdate=a}function gh(_,a,$,j){var _e=_.updateQueue;$g=!1;var et=_e.firstBaseUpdate,tt=_e.lastBaseUpdate,rt=_e.shared.pending;if(rt!==null){_e.shared.pending=null;var nt=rt,it=nt.next;nt.next=null,tt===null?et=it:tt.next=it,tt=nt;var st=_.alternate;st!==null&&(st=st.updateQueue,rt=st.lastBaseUpdate,rt!==tt&&(rt===null?st.firstBaseUpdate=it:rt.next=it,st.lastBaseUpdate=nt))}if(et!==null){var ot=_e.baseState;tt=0,st=it=nt=null,rt=et;do{var at=rt.lane,lt=rt.eventTime;if((j&at)===at){st!==null&&(st=st.next={eventTime:lt,lane:0,tag:rt.tag,payload:rt.payload,callback:rt.callback,next:null});e:{var ct=_,ut=rt;switch(at=a,lt=$,ut.tag){case 1:if(ct=ut.payload,typeof ct=="function"){ot=ct.call(lt,ot,at);break e}ot=ct;break e;case 3:ct.flags=ct.flags&-65537|128;case 0:if(ct=ut.payload,at=typeof ct=="function"?ct.call(lt,ot,at):ct,at==null)break e;ot=A$1({},ot,at);break e;case 2:$g=!0}}rt.callback!==null&&rt.lane!==0&&(_.flags|=64,at=_e.effects,at===null?_e.effects=[rt]:at.push(rt))}else lt={eventTime:lt,lane:at,tag:rt.tag,payload:rt.payload,callback:rt.callback,next:null},st===null?(it=st=lt,nt=ot):st=st.next=lt,tt|=at;if(rt=rt.next,rt===null){if(rt=_e.shared.pending,rt===null)break;at=rt,rt=at.next,at.next=null,_e.lastBaseUpdate=at,_e.shared.pending=null}}while(1);if(st===null&&(nt=ot),_e.baseState=nt,_e.firstBaseUpdate=it,_e.lastBaseUpdate=st,a=_e.shared.interleaved,a!==null){_e=a;do tt|=_e.lane,_e=_e.next;while(_e!==a)}else et===null&&(_e.shared.lanes=0);hh|=tt,_.lanes=tt,_.memoizedState=ot}}function ih(_,a,$){if(_=a.effects,a.effects=null,_!==null)for(a=0;a<_.length;a++){var j=_[a],_e=j.callback;if(_e!==null){if(j.callback=null,j=$,typeof _e!="function")throw Error(p$2(191,_e));_e.call(j)}}}var jh=new aa.Component().refs;function kh(_,a,$,j){a=_.memoizedState,$=$(j,a),$=$==null?a:A$1({},a,$),_.memoizedState=$,_.lanes===0&&(_.updateQueue.baseState=$)}var nh={isMounted:function(_){return(_=_._reactInternals)?Vb(_)===_:!1},enqueueSetState:function(_,a,$){_=_._reactInternals;var j=L(),_e=lh(_),et=ch(j,_e);et.payload=a,$!=null&&(et.callback=$),a=dh(_,et,_e),a!==null&&(mh(a,_,_e,j),eh(a,_,_e))},enqueueReplaceState:function(_,a,$){_=_._reactInternals;var j=L(),_e=lh(_),et=ch(j,_e);et.tag=1,et.payload=a,$!=null&&(et.callback=$),a=dh(_,et,_e),a!==null&&(mh(a,_,_e,j),eh(a,_,_e))},enqueueForceUpdate:function(_,a){_=_._reactInternals;var $=L(),j=lh(_),_e=ch($,j);_e.tag=2,a!=null&&(_e.callback=a),a=dh(_,_e,j),a!==null&&(mh(a,_,j,$),eh(a,_,j))}};function oh(_,a,$,j,_e,et,tt){return _=_.stateNode,typeof _.shouldComponentUpdate=="function"?_.shouldComponentUpdate(j,et,tt):a.prototype&&a.prototype.isPureReactComponent?!Ie($,j)||!Ie(_e,et):!0}function ph(_,a,$){var j=!1,_e=Vf,et=a.contextType;return typeof et=="object"&&et!==null?et=Vg(et):(_e=Zf(a)?Xf:H.current,j=a.contextTypes,et=(j=j!=null)?Yf(_,_e):Vf),a=new a($,et),_.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=nh,_.stateNode=a,a._reactInternals=_,j&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=_e,_.__reactInternalMemoizedMaskedChildContext=et),a}function qh(_,a,$,j){_=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps($,j),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps($,j),a.state!==_&&nh.enqueueReplaceState(a,a.state,null)}function rh$1(_,a,$,j){var _e=_.stateNode;_e.props=$,_e.state=_.memoizedState,_e.refs=jh,ah(_);var et=a.contextType;typeof et=="object"&&et!==null?_e.context=Vg(et):(et=Zf(a)?Xf:H.current,_e.context=Yf(_,et)),_e.state=_.memoizedState,et=a.getDerivedStateFromProps,typeof et=="function"&&(kh(_,a,et,$),_e.state=_.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof _e.getSnapshotBeforeUpdate=="function"||typeof _e.UNSAFE_componentWillMount!="function"&&typeof _e.componentWillMount!="function"||(a=_e.state,typeof _e.componentWillMount=="function"&&_e.componentWillMount(),typeof _e.UNSAFE_componentWillMount=="function"&&_e.UNSAFE_componentWillMount(),a!==_e.state&&nh.enqueueReplaceState(_e,_e.state,null),gh(_,$,_e,j),_e.state=_.memoizedState),typeof _e.componentDidMount=="function"&&(_.flags|=4194308)}function sh$1(_,a,$){if(_=$.ref,_!==null&&typeof _!="function"&&typeof _!="object"){if($._owner){if($=$._owner,$){if($.tag!==1)throw Error(p$2(309));var j=$.stateNode}if(!j)throw Error(p$2(147,_));var _e=j,et=""+_;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===et?a.ref:(a=function(tt){var rt=_e.refs;rt===jh&&(rt=_e.refs={}),tt===null?delete rt[et]:rt[et]=tt},a._stringRef=et,a)}if(typeof _!="string")throw Error(p$2(284));if(!$._owner)throw Error(p$2(290,_))}return _}function th(_,a){throw _=Object.prototype.toString.call(a),Error(p$2(31,_==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":_))}function uh(_){var a=_._init;return a(_._payload)}function vh(_){function a(ft,pt){if(_){var yt=ft.deletions;yt===null?(ft.deletions=[pt],ft.flags|=16):yt.push(pt)}}function $(ft,pt){if(!_)return null;for(;pt!==null;)a(ft,pt),pt=pt.sibling;return null}function j(ft,pt){for(ft=new Map;pt!==null;)pt.key!==null?ft.set(pt.key,pt):ft.set(pt.index,pt),pt=pt.sibling;return ft}function _e(ft,pt){return ft=wh(ft,pt),ft.index=0,ft.sibling=null,ft}function et(ft,pt,yt){return ft.index=yt,_?(yt=ft.alternate,yt!==null?(yt=yt.index,yt<pt?(ft.flags|=2,pt):yt):(ft.flags|=2,pt)):(ft.flags|=1048576,pt)}function tt(ft){return _&&ft.alternate===null&&(ft.flags|=2),ft}function rt(ft,pt,yt,mt){return pt===null||pt.tag!==6?(pt=xh(yt,ft.mode,mt),pt.return=ft,pt):(pt=_e(pt,yt),pt.return=ft,pt)}function nt(ft,pt,yt,mt){var _t=yt.type;return _t===ya?st(ft,pt,yt.props.children,mt,yt.key):pt!==null&&(pt.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===Ha&&uh(_t)===pt.type)?(mt=_e(pt,yt.props),mt.ref=sh$1(ft,pt,yt),mt.return=ft,mt):(mt=yh(yt.type,yt.key,yt.props,null,ft.mode,mt),mt.ref=sh$1(ft,pt,yt),mt.return=ft,mt)}function it(ft,pt,yt,mt){return pt===null||pt.tag!==4||pt.stateNode.containerInfo!==yt.containerInfo||pt.stateNode.implementation!==yt.implementation?(pt=zh(yt,ft.mode,mt),pt.return=ft,pt):(pt=_e(pt,yt.children||[]),pt.return=ft,pt)}function st(ft,pt,yt,mt,_t){return pt===null||pt.tag!==7?(pt=Ah(yt,ft.mode,mt,_t),pt.return=ft,pt):(pt=_e(pt,yt),pt.return=ft,pt)}function ot(ft,pt,yt){if(typeof pt=="string"&&pt!==""||typeof pt=="number")return pt=xh(""+pt,ft.mode,yt),pt.return=ft,pt;if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case va:return yt=yh(pt.type,pt.key,pt.props,null,ft.mode,yt),yt.ref=sh$1(ft,null,pt),yt.return=ft,yt;case wa:return pt=zh(pt,ft.mode,yt),pt.return=ft,pt;case Ha:var mt=pt._init;return ot(ft,mt(pt._payload),yt)}if(eb(pt)||Ka(pt))return pt=Ah(pt,ft.mode,yt,null),pt.return=ft,pt;th(ft,pt)}return null}function at(ft,pt,yt,mt){var _t=pt!==null?pt.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number")return _t!==null?null:rt(ft,pt,""+yt,mt);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case va:return yt.key===_t?nt(ft,pt,yt,mt):null;case wa:return yt.key===_t?it(ft,pt,yt,mt):null;case Ha:return _t=yt._init,at(ft,pt,_t(yt._payload),mt)}if(eb(yt)||Ka(yt))return _t!==null?null:st(ft,pt,yt,mt,null);th(ft,yt)}return null}function lt(ft,pt,yt,mt,_t){if(typeof mt=="string"&&mt!==""||typeof mt=="number")return ft=ft.get(yt)||null,rt(pt,ft,""+mt,_t);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case va:return ft=ft.get(mt.key===null?yt:mt.key)||null,nt(pt,ft,mt,_t);case wa:return ft=ft.get(mt.key===null?yt:mt.key)||null,it(pt,ft,mt,_t);case Ha:var vt=mt._init;return lt(ft,pt,yt,vt(mt._payload),_t)}if(eb(mt)||Ka(mt))return ft=ft.get(yt)||null,st(pt,ft,mt,_t,null);th(pt,mt)}return null}function ct(ft,pt,yt,mt){for(var _t=null,vt=null,ht=pt,St=pt=0,It=null;ht!==null&&St<yt.length;St++){ht.index>St?(It=ht,ht=null):It=ht.sibling;var Lt=at(ft,ht,yt[St],mt);if(Lt===null){ht===null&&(ht=It);break}_&&ht&&Lt.alternate===null&&a(ft,ht),pt=et(Lt,pt,St),vt===null?_t=Lt:vt.sibling=Lt,vt=Lt,ht=It}if(St===yt.length)return $(ft,ht),I&&tg(ft,St),_t;if(ht===null){for(;St<yt.length;St++)ht=ot(ft,yt[St],mt),ht!==null&&(pt=et(ht,pt,St),vt===null?_t=ht:vt.sibling=ht,vt=ht);return I&&tg(ft,St),_t}for(ht=j(ft,ht);St<yt.length;St++)It=lt(ht,ft,St,yt[St],mt),It!==null&&(_&&It.alternate!==null&&ht.delete(It.key===null?St:It.key),pt=et(It,pt,St),vt===null?_t=It:vt.sibling=It,vt=It);return _&&ht.forEach(function(Mt){return a(ft,Mt)}),I&&tg(ft,St),_t}function ut(ft,pt,yt,mt){var _t=Ka(yt);if(typeof _t!="function")throw Error(p$2(150));if(yt=_t.call(yt),yt==null)throw Error(p$2(151));for(var vt=_t=null,ht=pt,St=pt=0,It=null,Lt=yt.next();ht!==null&&!Lt.done;St++,Lt=yt.next()){ht.index>St?(It=ht,ht=null):It=ht.sibling;var Mt=at(ft,ht,Lt.value,mt);if(Mt===null){ht===null&&(ht=It);break}_&&ht&&Mt.alternate===null&&a(ft,ht),pt=et(Mt,pt,St),vt===null?_t=Mt:vt.sibling=Mt,vt=Mt,ht=It}if(Lt.done)return $(ft,ht),I&&tg(ft,St),_t;if(ht===null){for(;!Lt.done;St++,Lt=yt.next())Lt=ot(ft,Lt.value,mt),Lt!==null&&(pt=et(Lt,pt,St),vt===null?_t=Lt:vt.sibling=Lt,vt=Lt);return I&&tg(ft,St),_t}for(ht=j(ft,ht);!Lt.done;St++,Lt=yt.next())Lt=lt(ht,ft,St,Lt.value,mt),Lt!==null&&(_&&Lt.alternate!==null&&ht.delete(Lt.key===null?St:Lt.key),pt=et(Lt,pt,St),vt===null?_t=Lt:vt.sibling=Lt,vt=Lt);return _&&ht.forEach(function(Kt){return a(ft,Kt)}),I&&tg(ft,St),_t}function dt(ft,pt,yt,mt){if(typeof yt=="object"&&yt!==null&&yt.type===ya&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case va:e:{for(var _t=yt.key,vt=pt;vt!==null;){if(vt.key===_t){if(_t=yt.type,_t===ya){if(vt.tag===7){$(ft,vt.sibling),pt=_e(vt,yt.props.children),pt.return=ft,ft=pt;break e}}else if(vt.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===Ha&&uh(_t)===vt.type){$(ft,vt.sibling),pt=_e(vt,yt.props),pt.ref=sh$1(ft,vt,yt),pt.return=ft,ft=pt;break e}$(ft,vt);break}else a(ft,vt);vt=vt.sibling}yt.type===ya?(pt=Ah(yt.props.children,ft.mode,mt,yt.key),pt.return=ft,ft=pt):(mt=yh(yt.type,yt.key,yt.props,null,ft.mode,mt),mt.ref=sh$1(ft,pt,yt),mt.return=ft,ft=mt)}return tt(ft);case wa:e:{for(vt=yt.key;pt!==null;){if(pt.key===vt)if(pt.tag===4&&pt.stateNode.containerInfo===yt.containerInfo&&pt.stateNode.implementation===yt.implementation){$(ft,pt.sibling),pt=_e(pt,yt.children||[]),pt.return=ft,ft=pt;break e}else{$(ft,pt);break}else a(ft,pt);pt=pt.sibling}pt=zh(yt,ft.mode,mt),pt.return=ft,ft=pt}return tt(ft);case Ha:return vt=yt._init,dt(ft,pt,vt(yt._payload),mt)}if(eb(yt))return ct(ft,pt,yt,mt);if(Ka(yt))return ut(ft,pt,yt,mt);th(ft,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"?(yt=""+yt,pt!==null&&pt.tag===6?($(ft,pt.sibling),pt=_e(pt,yt),pt.return=ft,ft=pt):($(ft,pt),pt=xh(yt,ft.mode,mt),pt.return=ft,ft=pt),tt(ft)):$(ft,pt)}return dt}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(_){if(_===Dh)throw Error(p$2(174));return _}function Ih(_,a){switch(G(Gh,a),G(Fh,_),G(Eh,Dh),_=a.nodeType,_){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:lb(null,"");break;default:_=_===8?a.parentNode:a,a=_.namespaceURI||null,_=_.tagName,a=lb(a,_)}E(Eh),G(Eh,a)}function Jh(){E(Eh),E(Fh),E(Gh)}function Kh$1(_){Hh(Gh.current);var a=Hh(Eh.current),$=lb(a,_.type);a!==$&&(G(Fh,_),G(Eh,$))}function Lh(_){Fh.current===_&&(E(Eh),E(Fh))}var M=Uf(0);function Mh(_){for(var a=_;a!==null;){if(a.tag===13){var $=a.memoizedState;if($!==null&&($=$.dehydrated,$===null||$.data==="$?"||$.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===_)break;for(;a.sibling===null;){if(a.return===null||a.return===_)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Nh=[];function Oh(){for(var _=0;_<Nh.length;_++)Nh[_]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N=null,O=null,P=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q(){throw Error(p$2(321))}function Wh(_,a){if(a===null)return!1;for(var $=0;$<a.length&&$<_.length;$++)if(!He(_[$],a[$]))return!1;return!0}function Xh(_,a,$,j,_e,et){if(Rh=et,N=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Ph.current=_===null||_.memoizedState===null?Yh:Zh,_=$(j,_e),Th){et=0;do{if(Th=!1,Uh=0,25<=et)throw Error(p$2(301));et+=1,P=O=null,a.updateQueue=null,Ph.current=$h,_=$(j,_e)}while(Th)}if(Ph.current=ai,a=O!==null&&O.next!==null,Rh=0,P=O=N=null,Sh=!1,a)throw Error(p$2(300));return _}function bi(){var _=Uh!==0;return Uh=0,_}function ci(){var _={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P===null?N.memoizedState=P=_:P=P.next=_,P}function di(){if(O===null){var _=N.alternate;_=_!==null?_.memoizedState:null}else _=O.next;var a=P===null?N.memoizedState:P.next;if(a!==null)P=a,O=_;else{if(_===null)throw Error(p$2(310));O=_,_={memoizedState:O.memoizedState,baseState:O.baseState,baseQueue:O.baseQueue,queue:O.queue,next:null},P===null?N.memoizedState=P=_:P=P.next=_}return P}function ei(_,a){return typeof a=="function"?a(_):a}function fi(_){var a=di(),$=a.queue;if($===null)throw Error(p$2(311));$.lastRenderedReducer=_;var j=O,_e=j.baseQueue,et=$.pending;if(et!==null){if(_e!==null){var tt=_e.next;_e.next=et.next,et.next=tt}j.baseQueue=_e=et,$.pending=null}if(_e!==null){et=_e.next,j=j.baseState;var rt=tt=null,nt=null,it=et;do{var st=it.lane;if((Rh&st)===st)nt!==null&&(nt=nt.next={lane:0,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null}),j=it.hasEagerState?it.eagerState:_(j,it.action);else{var ot={lane:st,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null};nt===null?(rt=nt=ot,tt=j):nt=nt.next=ot,N.lanes|=st,hh|=st}it=it.next}while(it!==null&&it!==et);nt===null?tt=j:nt.next=rt,He(j,a.memoizedState)||(Ug=!0),a.memoizedState=j,a.baseState=tt,a.baseQueue=nt,$.lastRenderedState=j}if(_=$.interleaved,_!==null){_e=_;do et=_e.lane,N.lanes|=et,hh|=et,_e=_e.next;while(_e!==_)}else _e===null&&($.lanes=0);return[a.memoizedState,$.dispatch]}function gi(_){var a=di(),$=a.queue;if($===null)throw Error(p$2(311));$.lastRenderedReducer=_;var j=$.dispatch,_e=$.pending,et=a.memoizedState;if(_e!==null){$.pending=null;var tt=_e=_e.next;do et=_(et,tt.action),tt=tt.next;while(tt!==_e);He(et,a.memoizedState)||(Ug=!0),a.memoizedState=et,a.baseQueue===null&&(a.baseState=et),$.lastRenderedState=et}return[et,j]}function hi(){}function ii(_,a){var $=N,j=di(),_e=a(),et=!He(j.memoizedState,_e);if(et&&(j.memoizedState=_e,Ug=!0),j=j.queue,ji(ki.bind(null,$,j,_),[_]),j.getSnapshot!==a||et||P!==null&&P.memoizedState.tag&1){if($.flags|=2048,li(9,mi.bind(null,$,j,_e,a),void 0,null),R$1===null)throw Error(p$2(349));(Rh&30)!==0||ni($,a,_e)}return _e}function ni(_,a,$){_.flags|=16384,_={getSnapshot:a,value:$},a=N.updateQueue,a===null?(a={lastEffect:null,stores:null},N.updateQueue=a,a.stores=[_]):($=a.stores,$===null?a.stores=[_]:$.push(_))}function mi(_,a,$,j){a.value=$,a.getSnapshot=j,oi(a)&&pi(_)}function ki(_,a,$){return $(function(){oi(a)&&pi(_)})}function oi(_){var a=_.getSnapshot;_=_.value;try{var $=a();return!He(_,$)}catch{return!0}}function pi(_){var a=Zg(_,1);a!==null&&mh(a,_,1,-1)}function qi(_){var a=ci();return typeof _=="function"&&(_=_()),a.memoizedState=a.baseState=_,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:_},a.queue=_,_=_.dispatch=ri.bind(null,N,_),[a.memoizedState,_]}function li(_,a,$,j){return _={tag:_,create:a,destroy:$,deps:j,next:null},a=N.updateQueue,a===null?(a={lastEffect:null,stores:null},N.updateQueue=a,a.lastEffect=_.next=_):($=a.lastEffect,$===null?a.lastEffect=_.next=_:(j=$.next,$.next=_,_.next=j,a.lastEffect=_)),_}function si(){return di().memoizedState}function ti(_,a,$,j){var _e=ci();N.flags|=_,_e.memoizedState=li(1|a,$,void 0,j===void 0?null:j)}function ui(_,a,$,j){var _e=di();j=j===void 0?null:j;var et=void 0;if(O!==null){var tt=O.memoizedState;if(et=tt.destroy,j!==null&&Wh(j,tt.deps)){_e.memoizedState=li(a,$,et,j);return}}N.flags|=_,_e.memoizedState=li(1|a,$,et,j)}function vi(_,a){return ti(8390656,8,_,a)}function ji(_,a){return ui(2048,8,_,a)}function wi(_,a){return ui(4,2,_,a)}function xi(_,a){return ui(4,4,_,a)}function yi(_,a){if(typeof a=="function")return _=_(),a(_),function(){a(null)};if(a!=null)return _=_(),a.current=_,function(){a.current=null}}function zi(_,a,$){return $=$!=null?$.concat([_]):null,ui(4,4,yi.bind(null,a,_),$)}function Ai(){}function Bi(_,a){var $=di();a=a===void 0?null:a;var j=$.memoizedState;return j!==null&&a!==null&&Wh(a,j[1])?j[0]:($.memoizedState=[_,a],_)}function Ci(_,a){var $=di();a=a===void 0?null:a;var j=$.memoizedState;return j!==null&&a!==null&&Wh(a,j[1])?j[0]:(_=_(),$.memoizedState=[_,a],_)}function Di(_,a,$){return(Rh&21)===0?(_.baseState&&(_.baseState=!1,Ug=!0),_.memoizedState=$):(He($,a)||($=yc(),N.lanes|=$,hh|=$,_.baseState=!0),a)}function Ei(_,a){var $=C;C=$!==0&&4>$?$:4,_(!0);var j=Qh.transition;Qh.transition={};try{_(!1),a()}finally{C=$,Qh.transition=j}}function Fi(){return di().memoizedState}function Gi(_,a,$){var j=lh(_);if($={lane:j,action:$,hasEagerState:!1,eagerState:null,next:null},Hi(_))Ii(a,$);else if($=Yg(_,a,$,j),$!==null){var _e=L();mh($,_,j,_e),Ji($,a,j)}}function ri(_,a,$){var j=lh(_),_e={lane:j,action:$,hasEagerState:!1,eagerState:null,next:null};if(Hi(_))Ii(a,_e);else{var et=_.alternate;if(_.lanes===0&&(et===null||et.lanes===0)&&(et=a.lastRenderedReducer,et!==null))try{var tt=a.lastRenderedState,rt=et(tt,$);if(_e.hasEagerState=!0,_e.eagerState=rt,He(rt,tt)){var nt=a.interleaved;nt===null?(_e.next=_e,Xg(a)):(_e.next=nt.next,nt.next=_e),a.interleaved=_e;return}}catch{}finally{}$=Yg(_,a,_e,j),$!==null&&(_e=L(),mh($,_,j,_e),Ji($,a,j))}}function Hi(_){var a=_.alternate;return _===N||a!==null&&a===N}function Ii(_,a){Th=Sh=!0;var $=_.pending;$===null?a.next=a:(a.next=$.next,$.next=a),_.pending=a}function Ji(_,a,$){if(($&4194240)!==0){var j=a.lanes;j&=_.pendingLanes,$|=j,a.lanes=$,Cc(_,$)}}var ai={readContext:Vg,useCallback:Q,useContext:Q,useEffect:Q,useImperativeHandle:Q,useInsertionEffect:Q,useLayoutEffect:Q,useMemo:Q,useReducer:Q,useRef:Q,useState:Q,useDebugValue:Q,useDeferredValue:Q,useTransition:Q,useMutableSource:Q,useSyncExternalStore:Q,useId:Q,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(_,a){return ci().memoizedState=[_,a===void 0?null:a],_},useContext:Vg,useEffect:vi,useImperativeHandle:function(_,a,$){return $=$!=null?$.concat([_]):null,ti(4194308,4,yi.bind(null,a,_),$)},useLayoutEffect:function(_,a){return ti(4194308,4,_,a)},useInsertionEffect:function(_,a){return ti(4,2,_,a)},useMemo:function(_,a){var $=ci();return a=a===void 0?null:a,_=_(),$.memoizedState=[_,a],_},useReducer:function(_,a,$){var j=ci();return a=$!==void 0?$(a):a,j.memoizedState=j.baseState=a,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_,lastRenderedState:a},j.queue=_,_=_.dispatch=Gi.bind(null,N,_),[j.memoizedState,_]},useRef:function(_){var a=ci();return _={current:_},a.memoizedState=_},useState:qi,useDebugValue:Ai,useDeferredValue:function(_){return ci().memoizedState=_},useTransition:function(){var _=qi(!1),a=_[0];return _=Ei.bind(null,_[1]),ci().memoizedState=_,[a,_]},useMutableSource:function(){},useSyncExternalStore:function(_,a,$){var j=N,_e=ci();if(I){if($===void 0)throw Error(p$2(407));$=$()}else{if($=a(),R$1===null)throw Error(p$2(349));(Rh&30)!==0||ni(j,a,$)}_e.memoizedState=$;var et={value:$,getSnapshot:a};return _e.queue=et,vi(ki.bind(null,j,et,_),[_]),j.flags|=2048,li(9,mi.bind(null,j,et,$,a),void 0,null),$},useId:function(){var _=ci(),a=R$1.identifierPrefix;if(I){var $=sg,j=rg;$=(j&~(1<<32-oc(j)-1)).toString(32)+$,a=":"+a+"R"+$,$=Uh++,0<$&&(a+="H"+$.toString(32)),a+=":"}else $=Vh++,a=":"+a+"r"+$.toString(32)+":";return _.memoizedState=a},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(_){var a=di();return Di(a,O.memoizedState,_)},useTransition:function(){var _=fi(ei)[0],a=di().memoizedState;return[_,a]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(_){var a=di();return O===null?a.memoizedState=_:Di(a,O.memoizedState,_)},useTransition:function(){var _=gi(ei)[0],a=di().memoizedState;return[_,a]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(_,a){try{var $="",j=a;do $+=Pa(j),j=j.return;while(j);var _e=$}catch(et){_e=`
Error generating stack: `+et.message+`
`+et.stack}return{value:_,source:a,stack:_e,digest:null}}function Li(_,a,$){return{value:_,source:null,stack:$??null,digest:a??null}}function Mi(_,a){try{console.error(a.value)}catch($){setTimeout(function(){throw $})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(_,a,$){$=ch(-1,$),$.tag=3,$.payload={element:null};var j=a.value;return $.callback=function(){Pi||(Pi=!0,Qi=j),Mi(_,a)},$}function Ri(_,a,$){$=ch(-1,$),$.tag=3;var j=_.type.getDerivedStateFromError;if(typeof j=="function"){var _e=a.value;$.payload=function(){return j(_e)},$.callback=function(){Mi(_,a)}}var et=_.stateNode;return et!==null&&typeof et.componentDidCatch=="function"&&($.callback=function(){Mi(_,a),typeof j!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var tt=a.stack;this.componentDidCatch(a.value,{componentStack:tt!==null?tt:""})}),$}function Ti(_,a,$){var j=_.pingCache;if(j===null){j=_.pingCache=new Ni;var _e=new Set;j.set(a,_e)}else _e=j.get(a),_e===void 0&&(_e=new Set,j.set(a,_e));_e.has($)||(_e.add($),_=Ui.bind(null,_,a,$),a.then(_,_))}function Vi(_){do{var a;if((a=_.tag===13)&&(a=_.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return _;_=_.return}while(_!==null);return null}function Wi(_,a,$,j,_e){return(_.mode&1)===0?(_===a?_.flags|=65536:(_.flags|=128,$.flags|=131072,$.flags&=-52805,$.tag===1&&($.alternate===null?$.tag=17:(a=ch(-1,1),a.tag=2,dh($,a,1))),$.lanes|=1),_):(_.flags|=65536,_.lanes=_e,_)}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi(_,a,$,j){a.child=_===null?Ch(a,null,$,j):Bh(a,_.child,$,j)}function Zi(_,a,$,j,_e){$=$.render;var et=a.ref;return Tg(a,_e),j=Xh(_,a,$,j,et,_e),$=bi(),_!==null&&!Ug?(a.updateQueue=_.updateQueue,a.flags&=-2053,_.lanes&=~_e,$i(_,a,_e)):(I&&$&&vg(a),a.flags|=1,Yi(_,a,j,_e),a.child)}function aj(_,a,$,j,_e){if(_===null){var et=$.type;return typeof et=="function"&&!bj(et)&&et.defaultProps===void 0&&$.compare===null&&$.defaultProps===void 0?(a.tag=15,a.type=et,cj(_,a,et,j,_e)):(_=yh($.type,null,j,a,a.mode,_e),_.ref=a.ref,_.return=a,a.child=_)}if(et=_.child,(_.lanes&_e)===0){var tt=et.memoizedProps;if($=$.compare,$=$!==null?$:Ie,$(tt,j)&&_.ref===a.ref)return $i(_,a,_e)}return a.flags|=1,_=wh(et,j),_.ref=a.ref,_.return=a,a.child=_}function cj(_,a,$,j,_e){if(_!==null){var et=_.memoizedProps;if(Ie(et,j)&&_.ref===a.ref)if(Ug=!1,a.pendingProps=j=et,(_.lanes&_e)!==0)(_.flags&131072)!==0&&(Ug=!0);else return a.lanes=_.lanes,$i(_,a,_e)}return dj(_,a,$,j,_e)}function ej(_,a,$){var j=a.pendingProps,_e=j.children,et=_!==null?_.memoizedState:null;if(j.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(fj,gj),gj|=$;else{if(($&1073741824)===0)return _=et!==null?et.baseLanes|$:$,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:_,cachePool:null,transitions:null},a.updateQueue=null,G(fj,gj),gj|=_,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},j=et!==null?et.baseLanes:$,G(fj,gj),gj|=j}else et!==null?(j=et.baseLanes|$,a.memoizedState=null):j=$,G(fj,gj),gj|=j;return Yi(_,a,_e,$),a.child}function hj(_,a){var $=a.ref;(_===null&&$!==null||_!==null&&_.ref!==$)&&(a.flags|=512,a.flags|=2097152)}function dj(_,a,$,j,_e){var et=Zf($)?Xf:H.current;return et=Yf(a,et),Tg(a,_e),$=Xh(_,a,$,j,et,_e),j=bi(),_!==null&&!Ug?(a.updateQueue=_.updateQueue,a.flags&=-2053,_.lanes&=~_e,$i(_,a,_e)):(I&&j&&vg(a),a.flags|=1,Yi(_,a,$,_e),a.child)}function ij(_,a,$,j,_e){if(Zf($)){var et=!0;cg(a)}else et=!1;if(Tg(a,_e),a.stateNode===null)jj(_,a),ph(a,$,j),rh$1(a,$,j,_e),j=!0;else if(_===null){var tt=a.stateNode,rt=a.memoizedProps;tt.props=rt;var nt=tt.context,it=$.contextType;typeof it=="object"&&it!==null?it=Vg(it):(it=Zf($)?Xf:H.current,it=Yf(a,it));var st=$.getDerivedStateFromProps,ot=typeof st=="function"||typeof tt.getSnapshotBeforeUpdate=="function";ot||typeof tt.UNSAFE_componentWillReceiveProps!="function"&&typeof tt.componentWillReceiveProps!="function"||(rt!==j||nt!==it)&&qh(a,tt,j,it),$g=!1;var at=a.memoizedState;tt.state=at,gh(a,j,tt,_e),nt=a.memoizedState,rt!==j||at!==nt||Wf.current||$g?(typeof st=="function"&&(kh(a,$,st,j),nt=a.memoizedState),(rt=$g||oh(a,$,rt,j,at,nt,it))?(ot||typeof tt.UNSAFE_componentWillMount!="function"&&typeof tt.componentWillMount!="function"||(typeof tt.componentWillMount=="function"&&tt.componentWillMount(),typeof tt.UNSAFE_componentWillMount=="function"&&tt.UNSAFE_componentWillMount()),typeof tt.componentDidMount=="function"&&(a.flags|=4194308)):(typeof tt.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=j,a.memoizedState=nt),tt.props=j,tt.state=nt,tt.context=it,j=rt):(typeof tt.componentDidMount=="function"&&(a.flags|=4194308),j=!1)}else{tt=a.stateNode,bh(_,a),rt=a.memoizedProps,it=a.type===a.elementType?rt:Lg(a.type,rt),tt.props=it,ot=a.pendingProps,at=tt.context,nt=$.contextType,typeof nt=="object"&&nt!==null?nt=Vg(nt):(nt=Zf($)?Xf:H.current,nt=Yf(a,nt));var lt=$.getDerivedStateFromProps;(st=typeof lt=="function"||typeof tt.getSnapshotBeforeUpdate=="function")||typeof tt.UNSAFE_componentWillReceiveProps!="function"&&typeof tt.componentWillReceiveProps!="function"||(rt!==ot||at!==nt)&&qh(a,tt,j,nt),$g=!1,at=a.memoizedState,tt.state=at,gh(a,j,tt,_e);var ct=a.memoizedState;rt!==ot||at!==ct||Wf.current||$g?(typeof lt=="function"&&(kh(a,$,lt,j),ct=a.memoizedState),(it=$g||oh(a,$,it,j,at,ct,nt)||!1)?(st||typeof tt.UNSAFE_componentWillUpdate!="function"&&typeof tt.componentWillUpdate!="function"||(typeof tt.componentWillUpdate=="function"&&tt.componentWillUpdate(j,ct,nt),typeof tt.UNSAFE_componentWillUpdate=="function"&&tt.UNSAFE_componentWillUpdate(j,ct,nt)),typeof tt.componentDidUpdate=="function"&&(a.flags|=4),typeof tt.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof tt.componentDidUpdate!="function"||rt===_.memoizedProps&&at===_.memoizedState||(a.flags|=4),typeof tt.getSnapshotBeforeUpdate!="function"||rt===_.memoizedProps&&at===_.memoizedState||(a.flags|=1024),a.memoizedProps=j,a.memoizedState=ct),tt.props=j,tt.state=ct,tt.context=nt,j=it):(typeof tt.componentDidUpdate!="function"||rt===_.memoizedProps&&at===_.memoizedState||(a.flags|=4),typeof tt.getSnapshotBeforeUpdate!="function"||rt===_.memoizedProps&&at===_.memoizedState||(a.flags|=1024),j=!1)}return kj(_,a,$,j,et,_e)}function kj(_,a,$,j,_e,et){hj(_,a);var tt=(a.flags&128)!==0;if(!j&&!tt)return _e&&dg(a,$,!1),$i(_,a,et);j=a.stateNode,Xi.current=a;var rt=tt&&typeof $.getDerivedStateFromError!="function"?null:j.render();return a.flags|=1,_!==null&&tt?(a.child=Bh(a,_.child,null,et),a.child=Bh(a,null,rt,et)):Yi(_,a,rt,et),a.memoizedState=j.state,_e&&dg(a,$,!0),a.child}function lj(_){var a=_.stateNode;a.pendingContext?ag(_,a.pendingContext,a.pendingContext!==a.context):a.context&&ag(_,a.context,!1),Ih(_,a.containerInfo)}function mj(_,a,$,j,_e){return Ig(),Jg(_e),a.flags|=256,Yi(_,a,$,j),a.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(_){return{baseLanes:_,cachePool:null,transitions:null}}function pj(_,a,$){var j=a.pendingProps,_e=M.current,et=!1,tt=(a.flags&128)!==0,rt;if((rt=tt)||(rt=_!==null&&_.memoizedState===null?!1:(_e&2)!==0),rt?(et=!0,a.flags&=-129):(_===null||_.memoizedState!==null)&&(_e|=1),G(M,_e&1),_===null)return Eg(a),_=a.memoizedState,_!==null&&(_=_.dehydrated,_!==null)?((a.mode&1)===0?a.lanes=1:_.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(tt=j.children,_=j.fallback,et?(j=a.mode,et=a.child,tt={mode:"hidden",children:tt},(j&1)===0&&et!==null?(et.childLanes=0,et.pendingProps=tt):et=qj(tt,j,0,null),_=Ah(_,j,$,null),et.return=a,_.return=a,et.sibling=_,a.child=et,a.child.memoizedState=oj($),a.memoizedState=nj,_):rj(a,tt));if(_e=_.memoizedState,_e!==null&&(rt=_e.dehydrated,rt!==null))return sj(_,a,tt,j,rt,_e,$);if(et){et=j.fallback,tt=a.mode,_e=_.child,rt=_e.sibling;var nt={mode:"hidden",children:j.children};return(tt&1)===0&&a.child!==_e?(j=a.child,j.childLanes=0,j.pendingProps=nt,a.deletions=null):(j=wh(_e,nt),j.subtreeFlags=_e.subtreeFlags&14680064),rt!==null?et=wh(rt,et):(et=Ah(et,tt,$,null),et.flags|=2),et.return=a,j.return=a,j.sibling=et,a.child=j,j=et,et=a.child,tt=_.child.memoizedState,tt=tt===null?oj($):{baseLanes:tt.baseLanes|$,cachePool:null,transitions:tt.transitions},et.memoizedState=tt,et.childLanes=_.childLanes&~$,a.memoizedState=nj,j}return et=_.child,_=et.sibling,j=wh(et,{mode:"visible",children:j.children}),(a.mode&1)===0&&(j.lanes=$),j.return=a,j.sibling=null,_!==null&&($=a.deletions,$===null?(a.deletions=[_],a.flags|=16):$.push(_)),a.child=j,a.memoizedState=null,j}function rj(_,a){return a=qj({mode:"visible",children:a},_.mode,0,null),a.return=_,_.child=a}function tj(_,a,$,j){return j!==null&&Jg(j),Bh(a,_.child,null,$),_=rj(a,a.pendingProps.children),_.flags|=2,a.memoizedState=null,_}function sj(_,a,$,j,_e,et,tt){if($)return a.flags&256?(a.flags&=-257,j=Li(Error(p$2(422))),tj(_,a,tt,j)):a.memoizedState!==null?(a.child=_.child,a.flags|=128,null):(et=j.fallback,_e=a.mode,j=qj({mode:"visible",children:j.children},_e,0,null),et=Ah(et,_e,tt,null),et.flags|=2,j.return=a,et.return=a,j.sibling=et,a.child=j,(a.mode&1)!==0&&Bh(a,_.child,null,tt),a.child.memoizedState=oj(tt),a.memoizedState=nj,et);if((a.mode&1)===0)return tj(_,a,tt,null);if(_e.data==="$!"){if(j=_e.nextSibling&&_e.nextSibling.dataset,j)var rt=j.dgst;return j=rt,et=Error(p$2(419)),j=Li(et,j,void 0),tj(_,a,tt,j)}if(rt=(tt&_.childLanes)!==0,Ug||rt){if(j=R$1,j!==null){switch(tt&-tt){case 4:_e=2;break;case 16:_e=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_e=32;break;case 536870912:_e=268435456;break;default:_e=0}_e=(_e&(j.suspendedLanes|tt))!==0?0:_e,_e!==0&&_e!==et.retryLane&&(et.retryLane=_e,Zg(_,_e),mh(j,_,_e,-1))}return uj(),j=Li(Error(p$2(421))),tj(_,a,tt,j)}return _e.data==="$?"?(a.flags|=128,a.child=_.child,a=vj.bind(null,_),_e._reactRetry=a,null):(_=et.treeContext,yg=Lf(_e.nextSibling),xg=a,I=!0,zg=null,_!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=_.id,sg=_.overflow,qg=a),a=rj(a,j.children),a.flags|=4096,a)}function wj(_,a,$){_.lanes|=a;var j=_.alternate;j!==null&&(j.lanes|=a),Sg(_.return,a,$)}function xj(_,a,$,j,_e){var et=_.memoizedState;et===null?_.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:j,tail:$,tailMode:_e}:(et.isBackwards=a,et.rendering=null,et.renderingStartTime=0,et.last=j,et.tail=$,et.tailMode=_e)}function yj(_,a,$){var j=a.pendingProps,_e=j.revealOrder,et=j.tail;if(Yi(_,a,j.children,$),j=M.current,(j&2)!==0)j=j&1|2,a.flags|=128;else{if(_!==null&&(_.flags&128)!==0)e:for(_=a.child;_!==null;){if(_.tag===13)_.memoizedState!==null&&wj(_,$,a);else if(_.tag===19)wj(_,$,a);else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===a)break e;for(;_.sibling===null;){if(_.return===null||_.return===a)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}j&=1}if(G(M,j),(a.mode&1)===0)a.memoizedState=null;else switch(_e){case"forwards":for($=a.child,_e=null;$!==null;)_=$.alternate,_!==null&&Mh(_)===null&&(_e=$),$=$.sibling;$=_e,$===null?(_e=a.child,a.child=null):(_e=$.sibling,$.sibling=null),xj(a,!1,_e,$,et);break;case"backwards":for($=null,_e=a.child,a.child=null;_e!==null;){if(_=_e.alternate,_!==null&&Mh(_)===null){a.child=_e;break}_=_e.sibling,_e.sibling=$,$=_e,_e=_}xj(a,!0,$,null,et);break;case"together":xj(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function jj(_,a){(a.mode&1)===0&&_!==null&&(_.alternate=null,a.alternate=null,a.flags|=2)}function $i(_,a,$){if(_!==null&&(a.dependencies=_.dependencies),hh|=a.lanes,($&a.childLanes)===0)return null;if(_!==null&&a.child!==_.child)throw Error(p$2(153));if(a.child!==null){for(_=a.child,$=wh(_,_.pendingProps),a.child=$,$.return=a;_.sibling!==null;)_=_.sibling,$=$.sibling=wh(_,_.pendingProps),$.return=a;$.sibling=null}return a.child}function zj(_,a,$){switch(a.tag){case 3:lj(a),Ig();break;case 5:Kh$1(a);break;case 1:Zf(a.type)&&cg(a);break;case 4:Ih(a,a.stateNode.containerInfo);break;case 10:var j=a.type._context,_e=a.memoizedProps.value;G(Mg,j._currentValue),j._currentValue=_e;break;case 13:if(j=a.memoizedState,j!==null)return j.dehydrated!==null?(G(M,M.current&1),a.flags|=128,null):($&a.child.childLanes)!==0?pj(_,a,$):(G(M,M.current&1),_=$i(_,a,$),_!==null?_.sibling:null);G(M,M.current&1);break;case 19:if(j=($&a.childLanes)!==0,(_.flags&128)!==0){if(j)return yj(_,a,$);a.flags|=128}if(_e=a.memoizedState,_e!==null&&(_e.rendering=null,_e.tail=null,_e.lastEffect=null),G(M,M.current),j)break;return null;case 22:case 23:return a.lanes=0,ej(_,a,$)}return $i(_,a,$)}var Aj,Bj,Cj,Dj;Aj=function(_,a){for(var $=a.child;$!==null;){if($.tag===5||$.tag===6)_.appendChild($.stateNode);else if($.tag!==4&&$.child!==null){$.child.return=$,$=$.child;continue}if($===a)break;for(;$.sibling===null;){if($.return===null||$.return===a)return;$=$.return}$.sibling.return=$.return,$=$.sibling}};Bj=function(){};Cj=function(_,a,$,j){var _e=_.memoizedProps;if(_e!==j){_=a.stateNode,Hh(Eh.current);var et=null;switch($){case"input":_e=Ya(_,_e),j=Ya(_,j),et=[];break;case"select":_e=A$1({},_e,{value:void 0}),j=A$1({},j,{value:void 0}),et=[];break;case"textarea":_e=gb(_,_e),j=gb(_,j),et=[];break;default:typeof _e.onClick!="function"&&typeof j.onClick=="function"&&(_.onclick=Bf)}ub($,j);var tt;$=null;for(it in _e)if(!j.hasOwnProperty(it)&&_e.hasOwnProperty(it)&&_e[it]!=null)if(it==="style"){var rt=_e[it];for(tt in rt)rt.hasOwnProperty(tt)&&($||($={}),$[tt]="")}else it!=="dangerouslySetInnerHTML"&&it!=="children"&&it!=="suppressContentEditableWarning"&&it!=="suppressHydrationWarning"&&it!=="autoFocus"&&(ea.hasOwnProperty(it)?et||(et=[]):(et=et||[]).push(it,null));for(it in j){var nt=j[it];if(rt=_e?.[it],j.hasOwnProperty(it)&&nt!==rt&&(nt!=null||rt!=null))if(it==="style")if(rt){for(tt in rt)!rt.hasOwnProperty(tt)||nt&&nt.hasOwnProperty(tt)||($||($={}),$[tt]="");for(tt in nt)nt.hasOwnProperty(tt)&&rt[tt]!==nt[tt]&&($||($={}),$[tt]=nt[tt])}else $||(et||(et=[]),et.push(it,$)),$=nt;else it==="dangerouslySetInnerHTML"?(nt=nt?nt.__html:void 0,rt=rt?rt.__html:void 0,nt!=null&&rt!==nt&&(et=et||[]).push(it,nt)):it==="children"?typeof nt!="string"&&typeof nt!="number"||(et=et||[]).push(it,""+nt):it!=="suppressContentEditableWarning"&&it!=="suppressHydrationWarning"&&(ea.hasOwnProperty(it)?(nt!=null&&it==="onScroll"&&D("scroll",_),et||rt===nt||(et=[])):(et=et||[]).push(it,nt))}$&&(et=et||[]).push("style",$);var it=et;(a.updateQueue=it)&&(a.flags|=4)}};Dj=function(_,a,$,j){$!==j&&(a.flags|=4)};function Ej(_,a){if(!I)switch(_.tailMode){case"hidden":a=_.tail;for(var $=null;a!==null;)a.alternate!==null&&($=a),a=a.sibling;$===null?_.tail=null:$.sibling=null;break;case"collapsed":$=_.tail;for(var j=null;$!==null;)$.alternate!==null&&(j=$),$=$.sibling;j===null?a||_.tail===null?_.tail=null:_.tail.sibling=null:j.sibling=null}}function S(_){var a=_.alternate!==null&&_.alternate.child===_.child,$=0,j=0;if(a)for(var _e=_.child;_e!==null;)$|=_e.lanes|_e.childLanes,j|=_e.subtreeFlags&14680064,j|=_e.flags&14680064,_e.return=_,_e=_e.sibling;else for(_e=_.child;_e!==null;)$|=_e.lanes|_e.childLanes,j|=_e.subtreeFlags,j|=_e.flags,_e.return=_,_e=_e.sibling;return _.subtreeFlags|=j,_.childLanes=$,a}function Fj(_,a,$){var j=a.pendingProps;switch(wg(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(a),null;case 1:return Zf(a.type)&&$f(),S(a),null;case 3:return j=a.stateNode,Jh(),E(Wf),E(H),Oh(),j.pendingContext&&(j.context=j.pendingContext,j.pendingContext=null),(_===null||_.child===null)&&(Gg(a)?a.flags|=4:_===null||_.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(_,a),S(a),null;case 5:Lh(a);var _e=Hh(Gh.current);if($=a.type,_!==null&&a.stateNode!=null)Cj(_,a,$,j,_e),_.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!j){if(a.stateNode===null)throw Error(p$2(166));return S(a),null}if(_=Hh(Eh.current),Gg(a)){j=a.stateNode,$=a.type;var et=a.memoizedProps;switch(j[Of]=a,j[Pf]=et,_=(a.mode&1)!==0,$){case"dialog":D("cancel",j),D("close",j);break;case"iframe":case"object":case"embed":D("load",j);break;case"video":case"audio":for(_e=0;_e<lf.length;_e++)D(lf[_e],j);break;case"source":D("error",j);break;case"img":case"image":case"link":D("error",j),D("load",j);break;case"details":D("toggle",j);break;case"input":Za(j,et),D("invalid",j);break;case"select":j._wrapperState={wasMultiple:!!et.multiple},D("invalid",j);break;case"textarea":hb(j,et),D("invalid",j)}ub($,et),_e=null;for(var tt in et)if(et.hasOwnProperty(tt)){var rt=et[tt];tt==="children"?typeof rt=="string"?j.textContent!==rt&&(et.suppressHydrationWarning!==!0&&Af(j.textContent,rt,_),_e=["children",rt]):typeof rt=="number"&&j.textContent!==""+rt&&(et.suppressHydrationWarning!==!0&&Af(j.textContent,rt,_),_e=["children",""+rt]):ea.hasOwnProperty(tt)&&rt!=null&&tt==="onScroll"&&D("scroll",j)}switch($){case"input":Va(j),db(j,et,!0);break;case"textarea":Va(j),jb(j);break;case"select":case"option":break;default:typeof et.onClick=="function"&&(j.onclick=Bf)}j=_e,a.updateQueue=j,j!==null&&(a.flags|=4)}else{tt=_e.nodeType===9?_e:_e.ownerDocument,_==="http://www.w3.org/1999/xhtml"&&(_=kb($)),_==="http://www.w3.org/1999/xhtml"?$==="script"?(_=tt.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild)):typeof j.is=="string"?_=tt.createElement($,{is:j.is}):(_=tt.createElement($),$==="select"&&(tt=_,j.multiple?tt.multiple=!0:j.size&&(tt.size=j.size))):_=tt.createElementNS(_,$),_[Of]=a,_[Pf]=j,Aj(_,a,!1,!1),a.stateNode=_;e:{switch(tt=vb($,j),$){case"dialog":D("cancel",_),D("close",_),_e=j;break;case"iframe":case"object":case"embed":D("load",_),_e=j;break;case"video":case"audio":for(_e=0;_e<lf.length;_e++)D(lf[_e],_);_e=j;break;case"source":D("error",_),_e=j;break;case"img":case"image":case"link":D("error",_),D("load",_),_e=j;break;case"details":D("toggle",_),_e=j;break;case"input":Za(_,j),_e=Ya(_,j),D("invalid",_);break;case"option":_e=j;break;case"select":_._wrapperState={wasMultiple:!!j.multiple},_e=A$1({},j,{value:void 0}),D("invalid",_);break;case"textarea":hb(_,j),_e=gb(_,j),D("invalid",_);break;default:_e=j}ub($,_e),rt=_e;for(et in rt)if(rt.hasOwnProperty(et)){var nt=rt[et];et==="style"?sb(_,nt):et==="dangerouslySetInnerHTML"?(nt=nt?nt.__html:void 0,nt!=null&&nb(_,nt)):et==="children"?typeof nt=="string"?($!=="textarea"||nt!=="")&&ob(_,nt):typeof nt=="number"&&ob(_,""+nt):et!=="suppressContentEditableWarning"&&et!=="suppressHydrationWarning"&&et!=="autoFocus"&&(ea.hasOwnProperty(et)?nt!=null&&et==="onScroll"&&D("scroll",_):nt!=null&&ta(_,et,nt,tt))}switch($){case"input":Va(_),db(_,j,!1);break;case"textarea":Va(_),jb(_);break;case"option":j.value!=null&&_.setAttribute("value",""+Sa(j.value));break;case"select":_.multiple=!!j.multiple,et=j.value,et!=null?fb(_,!!j.multiple,et,!1):j.defaultValue!=null&&fb(_,!!j.multiple,j.defaultValue,!0);break;default:typeof _e.onClick=="function"&&(_.onclick=Bf)}switch($){case"button":case"input":case"select":case"textarea":j=!!j.autoFocus;break e;case"img":j=!0;break e;default:j=!1}}j&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return S(a),null;case 6:if(_&&a.stateNode!=null)Dj(_,a,_.memoizedProps,j);else{if(typeof j!="string"&&a.stateNode===null)throw Error(p$2(166));if($=Hh(Gh.current),Hh(Eh.current),Gg(a)){if(j=a.stateNode,$=a.memoizedProps,j[Of]=a,(et=j.nodeValue!==$)&&(_=xg,_!==null))switch(_.tag){case 3:Af(j.nodeValue,$,(_.mode&1)!==0);break;case 5:_.memoizedProps.suppressHydrationWarning!==!0&&Af(j.nodeValue,$,(_.mode&1)!==0)}et&&(a.flags|=4)}else j=($.nodeType===9?$:$.ownerDocument).createTextNode(j),j[Of]=a,a.stateNode=j}return S(a),null;case 13:if(E(M),j=a.memoizedState,_===null||_.memoizedState!==null&&_.memoizedState.dehydrated!==null){if(I&&yg!==null&&(a.mode&1)!==0&&(a.flags&128)===0)Hg(),Ig(),a.flags|=98560,et=!1;else if(et=Gg(a),j!==null&&j.dehydrated!==null){if(_===null){if(!et)throw Error(p$2(318));if(et=a.memoizedState,et=et!==null?et.dehydrated:null,!et)throw Error(p$2(317));et[Of]=a}else Ig(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;S(a),et=!1}else zg!==null&&(Gj(zg),zg=null),et=!0;if(!et)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=$,a):(j=j!==null,j!==(_!==null&&_.memoizedState!==null)&&j&&(a.child.flags|=8192,(a.mode&1)!==0&&(_===null||(M.current&1)!==0?T===0&&(T=3):uj())),a.updateQueue!==null&&(a.flags|=4),S(a),null);case 4:return Jh(),Bj(_,a),_===null&&sf(a.stateNode.containerInfo),S(a),null;case 10:return Rg(a.type._context),S(a),null;case 17:return Zf(a.type)&&$f(),S(a),null;case 19:if(E(M),et=a.memoizedState,et===null)return S(a),null;if(j=(a.flags&128)!==0,tt=et.rendering,tt===null)if(j)Ej(et,!1);else{if(T!==0||_!==null&&(_.flags&128)!==0)for(_=a.child;_!==null;){if(tt=Mh(_),tt!==null){for(a.flags|=128,Ej(et,!1),j=tt.updateQueue,j!==null&&(a.updateQueue=j,a.flags|=4),a.subtreeFlags=0,j=$,$=a.child;$!==null;)et=$,_=j,et.flags&=14680066,tt=et.alternate,tt===null?(et.childLanes=0,et.lanes=_,et.child=null,et.subtreeFlags=0,et.memoizedProps=null,et.memoizedState=null,et.updateQueue=null,et.dependencies=null,et.stateNode=null):(et.childLanes=tt.childLanes,et.lanes=tt.lanes,et.child=tt.child,et.subtreeFlags=0,et.deletions=null,et.memoizedProps=tt.memoizedProps,et.memoizedState=tt.memoizedState,et.updateQueue=tt.updateQueue,et.type=tt.type,_=tt.dependencies,et.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),$=$.sibling;return G(M,M.current&1|2),a.child}_=_.sibling}et.tail!==null&&B()>Hj&&(a.flags|=128,j=!0,Ej(et,!1),a.lanes=4194304)}else{if(!j)if(_=Mh(tt),_!==null){if(a.flags|=128,j=!0,$=_.updateQueue,$!==null&&(a.updateQueue=$,a.flags|=4),Ej(et,!0),et.tail===null&&et.tailMode==="hidden"&&!tt.alternate&&!I)return S(a),null}else 2*B()-et.renderingStartTime>Hj&&$!==1073741824&&(a.flags|=128,j=!0,Ej(et,!1),a.lanes=4194304);et.isBackwards?(tt.sibling=a.child,a.child=tt):($=et.last,$!==null?$.sibling=tt:a.child=tt,et.last=tt)}return et.tail!==null?(a=et.tail,et.rendering=a,et.tail=a.sibling,et.renderingStartTime=B(),a.sibling=null,$=M.current,G(M,j?$&1|2:$&1),a):(S(a),null);case 22:case 23:return Ij(),j=a.memoizedState!==null,_!==null&&_.memoizedState!==null!==j&&(a.flags|=8192),j&&(a.mode&1)!==0?(gj&1073741824)!==0&&(S(a),a.subtreeFlags&6&&(a.flags|=8192)):S(a),null;case 24:return null;case 25:return null}throw Error(p$2(156,a.tag))}function Jj(_,a){switch(wg(a),a.tag){case 1:return Zf(a.type)&&$f(),_=a.flags,_&65536?(a.flags=_&-65537|128,a):null;case 3:return Jh(),E(Wf),E(H),Oh(),_=a.flags,(_&65536)!==0&&(_&128)===0?(a.flags=_&-65537|128,a):null;case 5:return Lh(a),null;case 13:if(E(M),_=a.memoizedState,_!==null&&_.dehydrated!==null){if(a.alternate===null)throw Error(p$2(340));Ig()}return _=a.flags,_&65536?(a.flags=_&-65537|128,a):null;case 19:return E(M),null;case 4:return Jh(),null;case 10:return Rg(a.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V$1=null;function Mj(_,a){var $=_.ref;if($!==null)if(typeof $=="function")try{$(null)}catch(j){W(_,a,j)}else $.current=null}function Nj(_,a,$){try{$()}catch(j){W(_,a,j)}}var Oj=!1;function Pj(_,a){if(Cf=dd,_=Me(),Ne(_)){if("selectionStart"in _)var $={start:_.selectionStart,end:_.selectionEnd};else e:{$=($=_.ownerDocument)&&$.defaultView||window;var j=$.getSelection&&$.getSelection();if(j&&j.rangeCount!==0){$=j.anchorNode;var _e=j.anchorOffset,et=j.focusNode;j=j.focusOffset;try{$.nodeType,et.nodeType}catch{$=null;break e}var tt=0,rt=-1,nt=-1,it=0,st=0,ot=_,at=null;t:for(;;){for(var lt;ot!==$||_e!==0&&ot.nodeType!==3||(rt=tt+_e),ot!==et||j!==0&&ot.nodeType!==3||(nt=tt+j),ot.nodeType===3&&(tt+=ot.nodeValue.length),(lt=ot.firstChild)!==null;)at=ot,ot=lt;for(;;){if(ot===_)break t;if(at===$&&++it===_e&&(rt=tt),at===et&&++st===j&&(nt=tt),(lt=ot.nextSibling)!==null)break;ot=at,at=ot.parentNode}ot=lt}$=rt===-1||nt===-1?null:{start:rt,end:nt}}else $=null}$=$||{start:0,end:0}}else $=null;for(Df={focusedElem:_,selectionRange:$},dd=!1,V$1=a;V$1!==null;)if(a=V$1,_=a.child,(a.subtreeFlags&1028)!==0&&_!==null)_.return=a,V$1=_;else for(;V$1!==null;){a=V$1;try{var ct=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(ct!==null){var ut=ct.memoizedProps,dt=ct.memoizedState,ft=a.stateNode,pt=ft.getSnapshotBeforeUpdate(a.elementType===a.type?ut:Lg(a.type,ut),dt);ft.__reactInternalSnapshotBeforeUpdate=pt}break;case 3:var yt=a.stateNode.containerInfo;yt.nodeType===1?yt.textContent="":yt.nodeType===9&&yt.documentElement&&yt.removeChild(yt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$2(163))}}catch(mt){W(a,a.return,mt)}if(_=a.sibling,_!==null){_.return=a.return,V$1=_;break}V$1=a.return}return ct=Oj,Oj=!1,ct}function Qj(_,a,$){var j=a.updateQueue;if(j=j!==null?j.lastEffect:null,j!==null){var _e=j=j.next;do{if((_e.tag&_)===_){var et=_e.destroy;_e.destroy=void 0,et!==void 0&&Nj(a,$,et)}_e=_e.next}while(_e!==j)}}function Rj(_,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var $=a=a.next;do{if(($.tag&_)===_){var j=$.create;$.destroy=j()}$=$.next}while($!==a)}}function Sj(_){var a=_.ref;if(a!==null){var $=_.stateNode;switch(_.tag){case 5:_=$;break;default:_=$}typeof a=="function"?a(_):a.current=_}}function Tj(_){var a=_.alternate;a!==null&&(_.alternate=null,Tj(a)),_.child=null,_.deletions=null,_.sibling=null,_.tag===5&&(a=_.stateNode,a!==null&&(delete a[Of],delete a[Pf],delete a[of],delete a[Qf],delete a[Rf])),_.stateNode=null,_.return=null,_.dependencies=null,_.memoizedProps=null,_.memoizedState=null,_.pendingProps=null,_.stateNode=null,_.updateQueue=null}function Uj(_){return _.tag===5||_.tag===3||_.tag===4}function Vj(_){e:for(;;){for(;_.sibling===null;){if(_.return===null||Uj(_.return))return null;_=_.return}for(_.sibling.return=_.return,_=_.sibling;_.tag!==5&&_.tag!==6&&_.tag!==18;){if(_.flags&2||_.child===null||_.tag===4)continue e;_.child.return=_,_=_.child}if(!(_.flags&2))return _.stateNode}}function Wj(_,a,$){var j=_.tag;if(j===5||j===6)_=_.stateNode,a?$.nodeType===8?$.parentNode.insertBefore(_,a):$.insertBefore(_,a):($.nodeType===8?(a=$.parentNode,a.insertBefore(_,$)):(a=$,a.appendChild(_)),$=$._reactRootContainer,$!=null||a.onclick!==null||(a.onclick=Bf));else if(j!==4&&(_=_.child,_!==null))for(Wj(_,a,$),_=_.sibling;_!==null;)Wj(_,a,$),_=_.sibling}function Xj(_,a,$){var j=_.tag;if(j===5||j===6)_=_.stateNode,a?$.insertBefore(_,a):$.appendChild(_);else if(j!==4&&(_=_.child,_!==null))for(Xj(_,a,$),_=_.sibling;_!==null;)Xj(_,a,$),_=_.sibling}var X=null,Yj=!1;function Zj(_,a,$){for($=$.child;$!==null;)ak(_,a,$),$=$.sibling}function ak(_,a,$){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,$)}catch{}switch($.tag){case 5:U||Mj($,a);case 6:var j=X,_e=Yj;X=null,Zj(_,a,$),X=j,Yj=_e,X!==null&&(Yj?(_=X,$=$.stateNode,_.nodeType===8?_.parentNode.removeChild($):_.removeChild($)):X.removeChild($.stateNode));break;case 18:X!==null&&(Yj?(_=X,$=$.stateNode,_.nodeType===8?Kf(_.parentNode,$):_.nodeType===1&&Kf(_,$),bd(_)):Kf(X,$.stateNode));break;case 4:j=X,_e=Yj,X=$.stateNode.containerInfo,Yj=!0,Zj(_,a,$),X=j,Yj=_e;break;case 0:case 11:case 14:case 15:if(!U&&(j=$.updateQueue,j!==null&&(j=j.lastEffect,j!==null))){_e=j=j.next;do{var et=_e,tt=et.destroy;et=et.tag,tt!==void 0&&((et&2)!==0||(et&4)!==0)&&Nj($,a,tt),_e=_e.next}while(_e!==j)}Zj(_,a,$);break;case 1:if(!U&&(Mj($,a),j=$.stateNode,typeof j.componentWillUnmount=="function"))try{j.props=$.memoizedProps,j.state=$.memoizedState,j.componentWillUnmount()}catch(rt){W($,a,rt)}Zj(_,a,$);break;case 21:Zj(_,a,$);break;case 22:$.mode&1?(U=(j=U)||$.memoizedState!==null,Zj(_,a,$),U=j):Zj(_,a,$);break;default:Zj(_,a,$)}}function bk(_){var a=_.updateQueue;if(a!==null){_.updateQueue=null;var $=_.stateNode;$===null&&($=_.stateNode=new Lj),a.forEach(function(j){var _e=ck.bind(null,_,j);$.has(j)||($.add(j),j.then(_e,_e))})}}function dk(_,a){var $=a.deletions;if($!==null)for(var j=0;j<$.length;j++){var _e=$[j];try{var et=_,tt=a,rt=tt;e:for(;rt!==null;){switch(rt.tag){case 5:X=rt.stateNode,Yj=!1;break e;case 3:X=rt.stateNode.containerInfo,Yj=!0;break e;case 4:X=rt.stateNode.containerInfo,Yj=!0;break e}rt=rt.return}if(X===null)throw Error(p$2(160));ak(et,tt,_e),X=null,Yj=!1;var nt=_e.alternate;nt!==null&&(nt.return=null),_e.return=null}catch(it){W(_e,a,it)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)ek(a,_),a=a.sibling}function ek(_,a){var $=_.alternate,j=_.flags;switch(_.tag){case 0:case 11:case 14:case 15:if(dk(a,_),fk(_),j&4){try{Qj(3,_,_.return),Rj(3,_)}catch(ut){W(_,_.return,ut)}try{Qj(5,_,_.return)}catch(ut){W(_,_.return,ut)}}break;case 1:dk(a,_),fk(_),j&512&&$!==null&&Mj($,$.return);break;case 5:if(dk(a,_),fk(_),j&512&&$!==null&&Mj($,$.return),_.flags&32){var _e=_.stateNode;try{ob(_e,"")}catch(ut){W(_,_.return,ut)}}if(j&4&&(_e=_.stateNode,_e!=null)){var et=_.memoizedProps,tt=$!==null?$.memoizedProps:et,rt=_.type,nt=_.updateQueue;if(_.updateQueue=null,nt!==null)try{rt==="input"&&et.type==="radio"&&et.name!=null&&ab(_e,et),vb(rt,tt);var it=vb(rt,et);for(tt=0;tt<nt.length;tt+=2){var st=nt[tt],ot=nt[tt+1];st==="style"?sb(_e,ot):st==="dangerouslySetInnerHTML"?nb(_e,ot):st==="children"?ob(_e,ot):ta(_e,st,ot,it)}switch(rt){case"input":bb(_e,et);break;case"textarea":ib(_e,et);break;case"select":var at=_e._wrapperState.wasMultiple;_e._wrapperState.wasMultiple=!!et.multiple;var lt=et.value;lt!=null?fb(_e,!!et.multiple,lt,!1):at!==!!et.multiple&&(et.defaultValue!=null?fb(_e,!!et.multiple,et.defaultValue,!0):fb(_e,!!et.multiple,et.multiple?[]:"",!1))}_e[Pf]=et}catch(ut){W(_,_.return,ut)}}break;case 6:if(dk(a,_),fk(_),j&4){if(_.stateNode===null)throw Error(p$2(162));_e=_.stateNode,et=_.memoizedProps;try{_e.nodeValue=et}catch(ut){W(_,_.return,ut)}}break;case 3:if(dk(a,_),fk(_),j&4&&$!==null&&$.memoizedState.isDehydrated)try{bd(a.containerInfo)}catch(ut){W(_,_.return,ut)}break;case 4:dk(a,_),fk(_);break;case 13:dk(a,_),fk(_),_e=_.child,_e.flags&8192&&(et=_e.memoizedState!==null,_e.stateNode.isHidden=et,!et||_e.alternate!==null&&_e.alternate.memoizedState!==null||(gk=B())),j&4&&bk(_);break;case 22:if(st=$!==null&&$.memoizedState!==null,_.mode&1?(U=(it=U)||st,dk(a,_),U=it):dk(a,_),fk(_),j&8192){if(it=_.memoizedState!==null,(_.stateNode.isHidden=it)&&!st&&(_.mode&1)!==0)for(V$1=_,st=_.child;st!==null;){for(ot=V$1=st;V$1!==null;){switch(at=V$1,lt=at.child,at.tag){case 0:case 11:case 14:case 15:Qj(4,at,at.return);break;case 1:Mj(at,at.return);var ct=at.stateNode;if(typeof ct.componentWillUnmount=="function"){j=at,$=at.return;try{a=j,ct.props=a.memoizedProps,ct.state=a.memoizedState,ct.componentWillUnmount()}catch(ut){W(j,$,ut)}}break;case 5:Mj(at,at.return);break;case 22:if(at.memoizedState!==null){hk(ot);continue}}lt!==null?(lt.return=at,V$1=lt):hk(ot)}st=st.sibling}e:for(st=null,ot=_;;){if(ot.tag===5){if(st===null){st=ot;try{_e=ot.stateNode,it?(et=_e.style,typeof et.setProperty=="function"?et.setProperty("display","none","important"):et.display="none"):(rt=ot.stateNode,nt=ot.memoizedProps.style,tt=nt!=null&&nt.hasOwnProperty("display")?nt.display:null,rt.style.display=rb("display",tt))}catch(ut){W(_,_.return,ut)}}}else if(ot.tag===6){if(st===null)try{ot.stateNode.nodeValue=it?"":ot.memoizedProps}catch(ut){W(_,_.return,ut)}}else if((ot.tag!==22&&ot.tag!==23||ot.memoizedState===null||ot===_)&&ot.child!==null){ot.child.return=ot,ot=ot.child;continue}if(ot===_)break e;for(;ot.sibling===null;){if(ot.return===null||ot.return===_)break e;st===ot&&(st=null),ot=ot.return}st===ot&&(st=null),ot.sibling.return=ot.return,ot=ot.sibling}}break;case 19:dk(a,_),fk(_),j&4&&bk(_);break;case 21:break;default:dk(a,_),fk(_)}}function fk(_){var a=_.flags;if(a&2){try{e:{for(var $=_.return;$!==null;){if(Uj($)){var j=$;break e}$=$.return}throw Error(p$2(160))}switch(j.tag){case 5:var _e=j.stateNode;j.flags&32&&(ob(_e,""),j.flags&=-33);var et=Vj(_);Xj(_,et,_e);break;case 3:case 4:var tt=j.stateNode.containerInfo,rt=Vj(_);Wj(_,rt,tt);break;default:throw Error(p$2(161))}}catch(nt){W(_,_.return,nt)}_.flags&=-3}a&4096&&(_.flags&=-4097)}function ik(_,a,$){V$1=_,jk(_)}function jk(_,a,$){for(var j=(_.mode&1)!==0;V$1!==null;){var _e=V$1,et=_e.child;if(_e.tag===22&&j){var tt=_e.memoizedState!==null||Kj;if(!tt){var rt=_e.alternate,nt=rt!==null&&rt.memoizedState!==null||U;rt=Kj;var it=U;if(Kj=tt,(U=nt)&&!it)for(V$1=_e;V$1!==null;)tt=V$1,nt=tt.child,tt.tag===22&&tt.memoizedState!==null?kk(_e):nt!==null?(nt.return=tt,V$1=nt):kk(_e);for(;et!==null;)V$1=et,jk(et),et=et.sibling;V$1=_e,Kj=rt,U=it}lk(_)}else(_e.subtreeFlags&8772)!==0&&et!==null?(et.return=_e,V$1=et):lk(_)}}function lk(_){for(;V$1!==null;){var a=V$1;if((a.flags&8772)!==0){var $=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:U||Rj(5,a);break;case 1:var j=a.stateNode;if(a.flags&4&&!U)if($===null)j.componentDidMount();else{var _e=a.elementType===a.type?$.memoizedProps:Lg(a.type,$.memoizedProps);j.componentDidUpdate(_e,$.memoizedState,j.__reactInternalSnapshotBeforeUpdate)}var et=a.updateQueue;et!==null&&ih(a,et,j);break;case 3:var tt=a.updateQueue;if(tt!==null){if($=null,a.child!==null)switch(a.child.tag){case 5:$=a.child.stateNode;break;case 1:$=a.child.stateNode}ih(a,tt,$)}break;case 5:var rt=a.stateNode;if($===null&&a.flags&4){$=rt;var nt=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":nt.autoFocus&&$.focus();break;case"img":nt.src&&($.src=nt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var it=a.alternate;if(it!==null){var st=it.memoizedState;if(st!==null){var ot=st.dehydrated;ot!==null&&bd(ot)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$2(163))}U||a.flags&512&&Sj(a)}catch(at){W(a,a.return,at)}}if(a===_){V$1=null;break}if($=a.sibling,$!==null){$.return=a.return,V$1=$;break}V$1=a.return}}function hk(_){for(;V$1!==null;){var a=V$1;if(a===_){V$1=null;break}var $=a.sibling;if($!==null){$.return=a.return,V$1=$;break}V$1=a.return}}function kk(_){for(;V$1!==null;){var a=V$1;try{switch(a.tag){case 0:case 11:case 15:var $=a.return;try{Rj(4,a)}catch(nt){W(a,$,nt)}break;case 1:var j=a.stateNode;if(typeof j.componentDidMount=="function"){var _e=a.return;try{j.componentDidMount()}catch(nt){W(a,_e,nt)}}var et=a.return;try{Sj(a)}catch(nt){W(a,et,nt)}break;case 5:var tt=a.return;try{Sj(a)}catch(nt){W(a,tt,nt)}}}catch(nt){W(a,a.return,nt)}if(a===_){V$1=null;break}var rt=a.sibling;if(rt!==null){rt.return=a.return,V$1=rt;break}V$1=a.return}}var mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K$2=0,R$1=null,Y=null,Z=0,gj=0,fj=Uf(0),T=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L(){return(K$2&6)!==0?B():Bk!==-1?Bk:Bk=B()}function lh(_){return(_.mode&1)===0?1:(K$2&2)!==0&&Z!==0?Z&-Z:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(_=C,_!==0||(_=window.event,_=_===void 0?16:jd(_.type)),_)}function mh(_,a,$,j){if(50<zk)throw zk=0,Ak=null,Error(p$2(185));Ac(_,$,j),((K$2&2)===0||_!==R$1)&&(_===R$1&&((K$2&2)===0&&(rk|=$),T===4&&Dk(_,Z)),Ek(_,j),$===1&&K$2===0&&(a.mode&1)===0&&(Hj=B()+500,fg&&jg()))}function Ek(_,a){var $=_.callbackNode;wc(_,a);var j=uc(_,_===R$1?Z:0);if(j===0)$!==null&&bc($),_.callbackNode=null,_.callbackPriority=0;else if(a=j&-j,_.callbackPriority!==a){if($!=null&&bc($),a===1)_.tag===0?ig(Fk.bind(null,_)):hg(Fk.bind(null,_)),Jf(function(){(K$2&6)===0&&jg()}),$=null;else{switch(Dc(j)){case 1:$=fc;break;case 4:$=gc$1;break;case 16:$=hc;break;case 536870912:$=jc;break;default:$=hc}$=Gk($,Hk.bind(null,_))}_.callbackPriority=a,_.callbackNode=$}}function Hk(_,a){if(Bk=-1,Ck=0,(K$2&6)!==0)throw Error(p$2(327));var $=_.callbackNode;if(Ik()&&_.callbackNode!==$)return null;var j=uc(_,_===R$1?Z:0);if(j===0)return null;if((j&30)!==0||(j&_.expiredLanes)!==0||a)a=Jk(_,j);else{a=j;var _e=K$2;K$2|=2;var et=Kk();(R$1!==_||Z!==a)&&(vk=null,Hj=B()+500,Lk(_,a));do try{Mk();break}catch(rt){Nk(_,rt)}while(1);Qg(),nk.current=et,K$2=_e,Y!==null?a=0:(R$1=null,Z=0,a=T)}if(a!==0){if(a===2&&(_e=xc(_),_e!==0&&(j=_e,a=Ok(_,_e))),a===1)throw $=qk,Lk(_,0),Dk(_,j),Ek(_,B()),$;if(a===6)Dk(_,j);else{if(_e=_.current.alternate,(j&30)===0&&!Pk(_e)&&(a=Jk(_,j),a===2&&(et=xc(_),et!==0&&(j=et,a=Ok(_,et))),a===1))throw $=qk,Lk(_,0),Dk(_,j),Ek(_,B()),$;switch(_.finishedWork=_e,_.finishedLanes=j,a){case 0:case 1:throw Error(p$2(345));case 2:Qk(_,uk,vk);break;case 3:if(Dk(_,j),(j&130023424)===j&&(a=gk+500-B(),10<a)){if(uc(_,0)!==0)break;if(_e=_.suspendedLanes,(_e&j)!==j){L(),_.pingedLanes|=_.suspendedLanes&_e;break}_.timeoutHandle=Ff(Qk.bind(null,_,uk,vk),a);break}Qk(_,uk,vk);break;case 4:if(Dk(_,j),(j&4194240)===j)break;for(a=_.eventTimes,_e=-1;0<j;){var tt=31-oc(j);et=1<<tt,tt=a[tt],tt>_e&&(_e=tt),j&=~et}if(j=_e,j=B()-j,j=(120>j?120:480>j?480:1080>j?1080:1920>j?1920:3e3>j?3e3:4320>j?4320:1960*mk(j/1960))-j,10<j){_.timeoutHandle=Ff(Qk.bind(null,_,uk,vk),j);break}Qk(_,uk,vk);break;case 5:Qk(_,uk,vk);break;default:throw Error(p$2(329))}}}return Ek(_,B()),_.callbackNode===$?Hk.bind(null,_):null}function Ok(_,a){var $=tk;return _.current.memoizedState.isDehydrated&&(Lk(_,a).flags|=256),_=Jk(_,a),_!==2&&(a=uk,uk=$,a!==null&&Gj(a)),_}function Gj(_){uk===null?uk=_:uk.push.apply(uk,_)}function Pk(_){for(var a=_;;){if(a.flags&16384){var $=a.updateQueue;if($!==null&&($=$.stores,$!==null))for(var j=0;j<$.length;j++){var _e=$[j],et=_e.getSnapshot;_e=_e.value;try{if(!He(et(),_e))return!1}catch{return!1}}}if($=a.child,a.subtreeFlags&16384&&$!==null)$.return=a,a=$;else{if(a===_)break;for(;a.sibling===null;){if(a.return===null||a.return===_)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Dk(_,a){for(a&=~sk,a&=~rk,_.suspendedLanes|=a,_.pingedLanes&=~a,_=_.expirationTimes;0<a;){var $=31-oc(a),j=1<<$;_[$]=-1,a&=~j}}function Fk(_){if((K$2&6)!==0)throw Error(p$2(327));Ik();var a=uc(_,0);if((a&1)===0)return Ek(_,B()),null;var $=Jk(_,a);if(_.tag!==0&&$===2){var j=xc(_);j!==0&&(a=j,$=Ok(_,j))}if($===1)throw $=qk,Lk(_,0),Dk(_,a),Ek(_,B()),$;if($===6)throw Error(p$2(345));return _.finishedWork=_.current.alternate,_.finishedLanes=a,Qk(_,uk,vk),Ek(_,B()),null}function Rk(_,a){var $=K$2;K$2|=1;try{return _(a)}finally{K$2=$,K$2===0&&(Hj=B()+500,fg&&jg())}}function Sk(_){xk!==null&&xk.tag===0&&(K$2&6)===0&&Ik();var a=K$2;K$2|=1;var $=pk.transition,j=C;try{if(pk.transition=null,C=1,_)return _()}finally{C=j,pk.transition=$,K$2=a,(K$2&6)===0&&jg()}}function Ij(){gj=fj.current,E(fj)}function Lk(_,a){_.finishedWork=null,_.finishedLanes=0;var $=_.timeoutHandle;if($!==-1&&(_.timeoutHandle=-1,Gf($)),Y!==null)for($=Y.return;$!==null;){var j=$;switch(wg(j),j.tag){case 1:j=j.type.childContextTypes,j!=null&&$f();break;case 3:Jh(),E(Wf),E(H),Oh();break;case 5:Lh(j);break;case 4:Jh();break;case 13:E(M);break;case 19:E(M);break;case 10:Rg(j.type._context);break;case 22:case 23:Ij()}$=$.return}if(R$1=_,Y=_=wh(_.current,null),Z=gj=a,T=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(a=0;a<Wg.length;a++)if($=Wg[a],j=$.interleaved,j!==null){$.interleaved=null;var _e=j.next,et=$.pending;if(et!==null){var tt=et.next;et.next=_e,j.next=tt}$.pending=j}Wg=null}return _}function Nk(_,a){do{var $=Y;try{if(Qg(),Ph.current=ai,Sh){for(var j=N.memoizedState;j!==null;){var _e=j.queue;_e!==null&&(_e.pending=null),j=j.next}Sh=!1}if(Rh=0,P=O=N=null,Th=!1,Uh=0,ok.current=null,$===null||$.return===null){T=1,qk=a,Y=null;break}e:{var et=_,tt=$.return,rt=$,nt=a;if(a=Z,rt.flags|=32768,nt!==null&&typeof nt=="object"&&typeof nt.then=="function"){var it=nt,st=rt,ot=st.tag;if((st.mode&1)===0&&(ot===0||ot===11||ot===15)){var at=st.alternate;at?(st.updateQueue=at.updateQueue,st.memoizedState=at.memoizedState,st.lanes=at.lanes):(st.updateQueue=null,st.memoizedState=null)}var lt=Vi(tt);if(lt!==null){lt.flags&=-257,Wi(lt,tt,rt,et,a),lt.mode&1&&Ti(et,it,a),a=lt,nt=it;var ct=a.updateQueue;if(ct===null){var ut=new Set;ut.add(nt),a.updateQueue=ut}else ct.add(nt);break e}else{if((a&1)===0){Ti(et,it,a),uj();break e}nt=Error(p$2(426))}}else if(I&&rt.mode&1){var dt=Vi(tt);if(dt!==null){(dt.flags&65536)===0&&(dt.flags|=256),Wi(dt,tt,rt,et,a),Jg(Ki(nt,rt));break e}}et=nt=Ki(nt,rt),T!==4&&(T=2),tk===null?tk=[et]:tk.push(et),et=tt;do{switch(et.tag){case 3:et.flags|=65536,a&=-a,et.lanes|=a;var ft=Oi(et,nt,a);fh(et,ft);break e;case 1:rt=nt;var pt=et.type,yt=et.stateNode;if((et.flags&128)===0&&(typeof pt.getDerivedStateFromError=="function"||yt!==null&&typeof yt.componentDidCatch=="function"&&(Si===null||!Si.has(yt)))){et.flags|=65536,a&=-a,et.lanes|=a;var mt=Ri(et,rt,a);fh(et,mt);break e}}et=et.return}while(et!==null)}Tk($)}catch(_t){a=_t,Y===$&&$!==null&&(Y=$=$.return);continue}break}while(1)}function Kk(){var _=nk.current;return nk.current=ai,_===null?ai:_}function uj(){(T===0||T===3||T===2)&&(T=4),R$1===null||(hh&268435455)===0&&(rk&268435455)===0||Dk(R$1,Z)}function Jk(_,a){var $=K$2;K$2|=2;var j=Kk();(R$1!==_||Z!==a)&&(vk=null,Lk(_,a));do try{Uk();break}catch(_e){Nk(_,_e)}while(1);if(Qg(),K$2=$,nk.current=j,Y!==null)throw Error(p$2(261));return R$1=null,Z=0,T}function Uk(){for(;Y!==null;)Vk(Y)}function Mk(){for(;Y!==null&&!cc();)Vk(Y)}function Vk(_){var a=Wk(_.alternate,_,gj);_.memoizedProps=_.pendingProps,a===null?Tk(_):Y=a,ok.current=null}function Tk(_){var a=_;do{var $=a.alternate;if(_=a.return,(a.flags&32768)===0){if($=Fj($,a,gj),$!==null){Y=$;return}}else{if($=Jj($,a),$!==null){$.flags&=32767,Y=$;return}if(_!==null)_.flags|=32768,_.subtreeFlags=0,_.deletions=null;else{T=6,Y=null;return}}if(a=a.sibling,a!==null){Y=a;return}Y=a=_}while(a!==null);T===0&&(T=5)}function Qk(_,a,$){var j=C,_e=pk.transition;try{pk.transition=null,C=1,Xk(_,a,$,j)}finally{pk.transition=_e,C=j}return null}function Xk(_,a,$,j){do Ik();while(xk!==null);if((K$2&6)!==0)throw Error(p$2(327));$=_.finishedWork;var _e=_.finishedLanes;if($===null)return null;if(_.finishedWork=null,_.finishedLanes=0,$===_.current)throw Error(p$2(177));_.callbackNode=null,_.callbackPriority=0;var et=$.lanes|$.childLanes;if(Bc(_,et),_===R$1&&(Y=R$1=null,Z=0),($.subtreeFlags&2064)===0&&($.flags&2064)===0||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),et=($.flags&15990)!==0,($.subtreeFlags&15990)!==0||et){et=pk.transition,pk.transition=null;var tt=C;C=1;var rt=K$2;K$2|=4,ok.current=null,Pj(_,$),ek($,_),Oe(Df),dd=!!Cf,Df=Cf=null,_.current=$,ik($),dc(),K$2=rt,C=tt,pk.transition=et}else _.current=$;if(wk&&(wk=!1,xk=_,yk=_e),et=_.pendingLanes,et===0&&(Si=null),mc($.stateNode),Ek(_,B()),a!==null)for(j=_.onRecoverableError,$=0;$<a.length;$++)_e=a[$],j(_e.value,{componentStack:_e.stack,digest:_e.digest});if(Pi)throw Pi=!1,_=Qi,Qi=null,_;return(yk&1)!==0&&_.tag!==0&&Ik(),et=_.pendingLanes,(et&1)!==0?_===Ak?zk++:(zk=0,Ak=_):zk=0,jg(),null}function Ik(){if(xk!==null){var _=Dc(yk),a=pk.transition,$=C;try{if(pk.transition=null,C=16>_?16:_,xk===null)var j=!1;else{if(_=xk,xk=null,yk=0,(K$2&6)!==0)throw Error(p$2(331));var _e=K$2;for(K$2|=4,V$1=_.current;V$1!==null;){var et=V$1,tt=et.child;if((V$1.flags&16)!==0){var rt=et.deletions;if(rt!==null){for(var nt=0;nt<rt.length;nt++){var it=rt[nt];for(V$1=it;V$1!==null;){var st=V$1;switch(st.tag){case 0:case 11:case 15:Qj(8,st,et)}var ot=st.child;if(ot!==null)ot.return=st,V$1=ot;else for(;V$1!==null;){st=V$1;var at=st.sibling,lt=st.return;if(Tj(st),st===it){V$1=null;break}if(at!==null){at.return=lt,V$1=at;break}V$1=lt}}}var ct=et.alternate;if(ct!==null){var ut=ct.child;if(ut!==null){ct.child=null;do{var dt=ut.sibling;ut.sibling=null,ut=dt}while(ut!==null)}}V$1=et}}if((et.subtreeFlags&2064)!==0&&tt!==null)tt.return=et,V$1=tt;else e:for(;V$1!==null;){if(et=V$1,(et.flags&2048)!==0)switch(et.tag){case 0:case 11:case 15:Qj(9,et,et.return)}var ft=et.sibling;if(ft!==null){ft.return=et.return,V$1=ft;break e}V$1=et.return}}var pt=_.current;for(V$1=pt;V$1!==null;){tt=V$1;var yt=tt.child;if((tt.subtreeFlags&2064)!==0&&yt!==null)yt.return=tt,V$1=yt;else e:for(tt=pt;V$1!==null;){if(rt=V$1,(rt.flags&2048)!==0)try{switch(rt.tag){case 0:case 11:case 15:Rj(9,rt)}}catch(_t){W(rt,rt.return,_t)}if(rt===tt){V$1=null;break e}var mt=rt.sibling;if(mt!==null){mt.return=rt.return,V$1=mt;break e}V$1=rt.return}}if(K$2=_e,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,_)}catch{}j=!0}return j}finally{C=$,pk.transition=a}}return!1}function Yk(_,a,$){a=Ki($,a),a=Oi(_,a,1),_=dh(_,a,1),a=L(),_!==null&&(Ac(_,1,a),Ek(_,a))}function W(_,a,$){if(_.tag===3)Yk(_,_,$);else for(;a!==null;){if(a.tag===3){Yk(a,_,$);break}else if(a.tag===1){var j=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof j.componentDidCatch=="function"&&(Si===null||!Si.has(j))){_=Ki($,_),_=Ri(a,_,1),a=dh(a,_,1),_=L(),a!==null&&(Ac(a,1,_),Ek(a,_));break}}a=a.return}}function Ui(_,a,$){var j=_.pingCache;j!==null&&j.delete(a),a=L(),_.pingedLanes|=_.suspendedLanes&$,R$1===_&&(Z&$)===$&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-gk?Lk(_,0):sk|=$),Ek(_,a)}function Zk(_,a){a===0&&((_.mode&1)===0?a=1:(a=sc,sc<<=1,(sc&130023424)===0&&(sc=4194304)));var $=L();_=Zg(_,a),_!==null&&(Ac(_,a,$),Ek(_,$))}function vj(_){var a=_.memoizedState,$=0;a!==null&&($=a.retryLane),Zk(_,$)}function ck(_,a){var $=0;switch(_.tag){case 13:var j=_.stateNode,_e=_.memoizedState;_e!==null&&($=_e.retryLane);break;case 19:j=_.stateNode;break;default:throw Error(p$2(314))}j!==null&&j.delete(a),Zk(_,$)}var Wk;Wk=function(_,a,$){if(_!==null)if(_.memoizedProps!==a.pendingProps||Wf.current)Ug=!0;else{if((_.lanes&$)===0&&(a.flags&128)===0)return Ug=!1,zj(_,a,$);Ug=(_.flags&131072)!==0}else Ug=!1,I&&(a.flags&1048576)!==0&&ug(a,ng,a.index);switch(a.lanes=0,a.tag){case 2:var j=a.type;jj(_,a),_=a.pendingProps;var _e=Yf(a,H.current);Tg(a,$),_e=Xh(null,a,j,_,_e,$);var et=bi();return a.flags|=1,typeof _e=="object"&&_e!==null&&typeof _e.render=="function"&&_e.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Zf(j)?(et=!0,cg(a)):et=!1,a.memoizedState=_e.state!==null&&_e.state!==void 0?_e.state:null,ah(a),_e.updater=nh,a.stateNode=_e,_e._reactInternals=a,rh$1(a,j,_,$),a=kj(null,a,j,!0,et,$)):(a.tag=0,I&&et&&vg(a),Yi(null,a,_e,$),a=a.child),a;case 16:j=a.elementType;e:{switch(jj(_,a),_=a.pendingProps,_e=j._init,j=_e(j._payload),a.type=j,_e=a.tag=$k(j),_=Lg(j,_),_e){case 0:a=dj(null,a,j,_,$);break e;case 1:a=ij(null,a,j,_,$);break e;case 11:a=Zi(null,a,j,_,$);break e;case 14:a=aj(null,a,j,Lg(j.type,_),$);break e}throw Error(p$2(306,j,""))}return a;case 0:return j=a.type,_e=a.pendingProps,_e=a.elementType===j?_e:Lg(j,_e),dj(_,a,j,_e,$);case 1:return j=a.type,_e=a.pendingProps,_e=a.elementType===j?_e:Lg(j,_e),ij(_,a,j,_e,$);case 3:e:{if(lj(a),_===null)throw Error(p$2(387));j=a.pendingProps,et=a.memoizedState,_e=et.element,bh(_,a),gh(a,j,null,$);var tt=a.memoizedState;if(j=tt.element,et.isDehydrated)if(et={element:j,isDehydrated:!1,cache:tt.cache,pendingSuspenseBoundaries:tt.pendingSuspenseBoundaries,transitions:tt.transitions},a.updateQueue.baseState=et,a.memoizedState=et,a.flags&256){_e=Ki(Error(p$2(423)),a),a=mj(_,a,j,$,_e);break e}else if(j!==_e){_e=Ki(Error(p$2(424)),a),a=mj(_,a,j,$,_e);break e}else for(yg=Lf(a.stateNode.containerInfo.firstChild),xg=a,I=!0,zg=null,$=Ch(a,null,j,$),a.child=$;$;)$.flags=$.flags&-3|4096,$=$.sibling;else{if(Ig(),j===_e){a=$i(_,a,$);break e}Yi(_,a,j,$)}a=a.child}return a;case 5:return Kh$1(a),_===null&&Eg(a),j=a.type,_e=a.pendingProps,et=_!==null?_.memoizedProps:null,tt=_e.children,Ef(j,_e)?tt=null:et!==null&&Ef(j,et)&&(a.flags|=32),hj(_,a),Yi(_,a,tt,$),a.child;case 6:return _===null&&Eg(a),null;case 13:return pj(_,a,$);case 4:return Ih(a,a.stateNode.containerInfo),j=a.pendingProps,_===null?a.child=Bh(a,null,j,$):Yi(_,a,j,$),a.child;case 11:return j=a.type,_e=a.pendingProps,_e=a.elementType===j?_e:Lg(j,_e),Zi(_,a,j,_e,$);case 7:return Yi(_,a,a.pendingProps,$),a.child;case 8:return Yi(_,a,a.pendingProps.children,$),a.child;case 12:return Yi(_,a,a.pendingProps.children,$),a.child;case 10:e:{if(j=a.type._context,_e=a.pendingProps,et=a.memoizedProps,tt=_e.value,G(Mg,j._currentValue),j._currentValue=tt,et!==null)if(He(et.value,tt)){if(et.children===_e.children&&!Wf.current){a=$i(_,a,$);break e}}else for(et=a.child,et!==null&&(et.return=a);et!==null;){var rt=et.dependencies;if(rt!==null){tt=et.child;for(var nt=rt.firstContext;nt!==null;){if(nt.context===j){if(et.tag===1){nt=ch(-1,$&-$),nt.tag=2;var it=et.updateQueue;if(it!==null){it=it.shared;var st=it.pending;st===null?nt.next=nt:(nt.next=st.next,st.next=nt),it.pending=nt}}et.lanes|=$,nt=et.alternate,nt!==null&&(nt.lanes|=$),Sg(et.return,$,a),rt.lanes|=$;break}nt=nt.next}}else if(et.tag===10)tt=et.type===a.type?null:et.child;else if(et.tag===18){if(tt=et.return,tt===null)throw Error(p$2(341));tt.lanes|=$,rt=tt.alternate,rt!==null&&(rt.lanes|=$),Sg(tt,$,a),tt=et.sibling}else tt=et.child;if(tt!==null)tt.return=et;else for(tt=et;tt!==null;){if(tt===a){tt=null;break}if(et=tt.sibling,et!==null){et.return=tt.return,tt=et;break}tt=tt.return}et=tt}Yi(_,a,_e.children,$),a=a.child}return a;case 9:return _e=a.type,j=a.pendingProps.children,Tg(a,$),_e=Vg(_e),j=j(_e),a.flags|=1,Yi(_,a,j,$),a.child;case 14:return j=a.type,_e=Lg(j,a.pendingProps),_e=Lg(j.type,_e),aj(_,a,j,_e,$);case 15:return cj(_,a,a.type,a.pendingProps,$);case 17:return j=a.type,_e=a.pendingProps,_e=a.elementType===j?_e:Lg(j,_e),jj(_,a),a.tag=1,Zf(j)?(_=!0,cg(a)):_=!1,Tg(a,$),ph(a,j,_e),rh$1(a,j,_e,$),kj(null,a,j,!0,_,$);case 19:return yj(_,a,$);case 22:return ej(_,a,$)}throw Error(p$2(156,a.tag))};function Gk(_,a){return ac(_,a)}function al(_,a,$,j){this.tag=_,this.key=$,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=j,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(_,a,$,j){return new al(_,a,$,j)}function bj(_){return _=_.prototype,!(!_||!_.isReactComponent)}function $k(_){if(typeof _=="function")return bj(_)?1:0;if(_!=null){if(_=_.$$typeof,_===Da)return 11;if(_===Ga)return 14}return 2}function wh(_,a){var $=_.alternate;return $===null?($=Bg(_.tag,a,_.key,_.mode),$.elementType=_.elementType,$.type=_.type,$.stateNode=_.stateNode,$.alternate=_,_.alternate=$):($.pendingProps=a,$.type=_.type,$.flags=0,$.subtreeFlags=0,$.deletions=null),$.flags=_.flags&14680064,$.childLanes=_.childLanes,$.lanes=_.lanes,$.child=_.child,$.memoizedProps=_.memoizedProps,$.memoizedState=_.memoizedState,$.updateQueue=_.updateQueue,a=_.dependencies,$.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},$.sibling=_.sibling,$.index=_.index,$.ref=_.ref,$}function yh(_,a,$,j,_e,et){var tt=2;if(j=_,typeof _=="function")bj(_)&&(tt=1);else if(typeof _=="string")tt=5;else e:switch(_){case ya:return Ah($.children,_e,et,a);case za:tt=8,_e|=8;break;case Aa:return _=Bg(12,$,a,_e|2),_.elementType=Aa,_.lanes=et,_;case Ea:return _=Bg(13,$,a,_e),_.elementType=Ea,_.lanes=et,_;case Fa:return _=Bg(19,$,a,_e),_.elementType=Fa,_.lanes=et,_;case Ia:return qj($,_e,et,a);default:if(typeof _=="object"&&_!==null)switch(_.$$typeof){case Ba:tt=10;break e;case Ca:tt=9;break e;case Da:tt=11;break e;case Ga:tt=14;break e;case Ha:tt=16,j=null;break e}throw Error(p$2(130,_==null?_:typeof _,""))}return a=Bg(tt,$,a,_e),a.elementType=_,a.type=j,a.lanes=et,a}function Ah(_,a,$,j){return _=Bg(7,_,j,a),_.lanes=$,_}function qj(_,a,$,j){return _=Bg(22,_,j,a),_.elementType=Ia,_.lanes=$,_.stateNode={isHidden:!1},_}function xh(_,a,$){return _=Bg(6,_,null,a),_.lanes=$,_}function zh(_,a,$){return a=Bg(4,_.children!==null?_.children:[],_.key,a),a.lanes=$,a.stateNode={containerInfo:_.containerInfo,pendingChildren:null,implementation:_.implementation},a}function bl(_,a,$,j,_e){this.tag=a,this.containerInfo=_,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=j,this.onRecoverableError=_e,this.mutableSourceEagerHydrationData=null}function cl(_,a,$,j,_e,et,tt,rt,nt){return _=new bl(_,a,$,rt,nt),a===1?(a=1,et===!0&&(a|=8)):a=0,et=Bg(3,null,null,a),_.current=et,et.stateNode=_,et.memoizedState={element:j,isDehydrated:$,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(et),_}function dl(_,a,$){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:j==null?null:""+j,children:_,containerInfo:a,implementation:$}}function el(_){if(!_)return Vf;_=_._reactInternals;e:{if(Vb(_)!==_||_.tag!==1)throw Error(p$2(170));var a=_;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Zf(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(p$2(171))}if(_.tag===1){var $=_.type;if(Zf($))return bg(_,$,a)}return a}function fl(_,a,$,j,_e,et,tt,rt,nt){return _=cl($,j,!0,_,_e,et,tt,rt,nt),_.context=el(null),$=_.current,j=L(),_e=lh($),et=ch(j,_e),et.callback=a??null,dh($,et,_e),_.current.lanes=_e,Ac(_,_e,j),Ek(_,j),_}function gl(_,a,$,j){var _e=a.current,et=L(),tt=lh(_e);return $=el($),a.context===null?a.context=$:a.pendingContext=$,a=ch(et,tt),a.payload={element:_},j=j===void 0?null:j,j!==null&&(a.callback=j),_=dh(_e,a,tt),_!==null&&(mh(_,_e,tt,et),eh(_,_e,tt)),tt}function hl(_){if(_=_.current,!_.child)return null;switch(_.child.tag){case 5:return _.child.stateNode;default:return _.child.stateNode}}function il(_,a){if(_=_.memoizedState,_!==null&&_.dehydrated!==null){var $=_.retryLane;_.retryLane=$!==0&&$<a?$:a}}function jl(_,a){il(_,a),(_=_.alternate)&&il(_,a)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(_){console.error(_)};function ml(_){this._internalRoot=_}nl.prototype.render=ml.prototype.render=function(_){var a=this._internalRoot;if(a===null)throw Error(p$2(409));gl(_,a,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var _=this._internalRoot;if(_!==null){this._internalRoot=null;var a=_.containerInfo;Sk(function(){gl(null,_,null,null)}),a[uf]=null}};function nl(_){this._internalRoot=_}nl.prototype.unstable_scheduleHydration=function(_){if(_){var a=Hc();_={blockedOn:null,target:_,priority:a};for(var $=0;$<Qc.length&&a!==0&&a<Qc[$].priority;$++);Qc.splice($,0,_),$===0&&Vc(_)}};function ol(_){return!(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11)}function pl(_){return!(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11&&(_.nodeType!==8||_.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(_,a,$,j,_e){if(_e){if(typeof j=="function"){var et=j;j=function(){var it=hl(tt);et.call(it)}}var tt=fl(a,j,_,0,null,!1,!1,"",ql);return _._reactRootContainer=tt,_[uf]=tt.current,sf(_.nodeType===8?_.parentNode:_),Sk(),tt}for(;_e=_.lastChild;)_.removeChild(_e);if(typeof j=="function"){var rt=j;j=function(){var it=hl(nt);rt.call(it)}}var nt=cl(_,0,!1,null,null,!1,!1,"",ql);return _._reactRootContainer=nt,_[uf]=nt.current,sf(_.nodeType===8?_.parentNode:_),Sk(function(){gl(a,nt,$,j)}),nt}function sl(_,a,$,j,_e){var et=$._reactRootContainer;if(et){var tt=et;if(typeof _e=="function"){var rt=_e;_e=function(){var nt=hl(tt);rt.call(nt)}}gl(a,tt,_,_e)}else tt=rl($,a,_,_e,j);return hl(tt)}Ec=function(_){switch(_.tag){case 3:var a=_.stateNode;if(a.current.memoizedState.isDehydrated){var $=tc(a.pendingLanes);$!==0&&(Cc(a,$|1),Ek(a,B()),(K$2&6)===0&&(Hj=B()+500,jg()))}break;case 13:Sk(function(){var j=Zg(_,1);if(j!==null){var _e=L();mh(j,_,1,_e)}}),jl(_,1)}};Fc=function(_){if(_.tag===13){var a=Zg(_,134217728);if(a!==null){var $=L();mh(a,_,134217728,$)}jl(_,134217728)}};Gc=function(_){if(_.tag===13){var a=lh(_),$=Zg(_,a);if($!==null){var j=L();mh($,_,a,j)}jl(_,a)}};Hc=function(){return C};Ic=function(_,a){var $=C;try{return C=_,a()}finally{C=$}};yb=function(_,a,$){switch(a){case"input":if(bb(_,$),a=$.name,$.type==="radio"&&a!=null){for($=_;$.parentNode;)$=$.parentNode;for($=$.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<$.length;a++){var j=$[a];if(j!==_&&j.form===_.form){var _e=Db(j);if(!_e)throw Error(p$2(90));Wa(j),bb(j,_e)}}}break;case"textarea":ib(_,$);break;case"select":a=$.value,a!=null&&fb(_,!!$.multiple,a,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(_){return _=Zb(_),_===null?null:_.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(_,a){var $=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(a))throw Error(p$2(200));return dl(_,a,null,$)};reactDom_production_min.createRoot=function(_,a){if(!ol(_))throw Error(p$2(299));var $=!1,j="",_e=ll;return a!=null&&(a.unstable_strictMode===!0&&($=!0),a.identifierPrefix!==void 0&&(j=a.identifierPrefix),a.onRecoverableError!==void 0&&(_e=a.onRecoverableError)),a=cl(_,1,!1,null,null,$,!1,j,_e),_[uf]=a.current,sf(_.nodeType===8?_.parentNode:_),new ml(a)};reactDom_production_min.findDOMNode=function(_){if(_==null)return null;if(_.nodeType===1)return _;var a=_._reactInternals;if(a===void 0)throw typeof _.render=="function"?Error(p$2(188)):(_=Object.keys(_).join(","),Error(p$2(268,_)));return _=Zb(a),_=_===null?null:_.stateNode,_};reactDom_production_min.flushSync=function(_){return Sk(_)};reactDom_production_min.hydrate=function(_,a,$){if(!pl(a))throw Error(p$2(200));return sl(null,_,a,!0,$)};reactDom_production_min.hydrateRoot=function(_,a,$){if(!ol(_))throw Error(p$2(405));var j=$!=null&&$.hydratedSources||null,_e=!1,et="",tt=ll;if($!=null&&($.unstable_strictMode===!0&&(_e=!0),$.identifierPrefix!==void 0&&(et=$.identifierPrefix),$.onRecoverableError!==void 0&&(tt=$.onRecoverableError)),a=fl(a,null,_,1,$??null,_e,!1,et,tt),_[uf]=a.current,sf(_),j)for(_=0;_<j.length;_++)$=j[_],_e=$._getVersion,_e=_e($._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[$,_e]:a.mutableSourceEagerHydrationData.push($,_e);return new nl(a)};reactDom_production_min.render=function(_,a,$){if(!pl(a))throw Error(p$2(200));return sl(null,_,a,!1,$)};reactDom_production_min.unmountComponentAtNode=function(_){if(!pl(_))throw Error(p$2(40));return _._reactRootContainer?(Sk(function(){sl(null,null,_,!1,function(){_._reactRootContainer=null,_[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(_,a,$,j){if(!pl($))throw Error(p$2(200));if(_==null||_._reactInternals===void 0)throw Error(p$2(38));return sl(_,a,$,!1,j)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";(function(_){function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch($){console.error($)}}a(),_.exports=reactDom_production_min})(reactDom);var m$3=reactDom.exports;client.createRoot=m$3.createRoot,client.hydrateRoot=m$3.hydrateRoot;function createPolymorphicComponent(_){return _}function findElementAncestor(_,a){let $=_;for(;($=$.parentElement)&&!$.matches(a););return $}function getPreviousIndex(_,a,$){for(let j=_-1;j>=0;j-=1)if(!a[j].disabled)return j;if($){for(let j=a.length-1;j>-1;j-=1)if(!a[j].disabled)return j}return _}function getNextIndex(_,a,$){for(let j=_+1;j<a.length;j+=1)if(!a[j].disabled)return j;if($){for(let j=0;j<a.length;j+=1)if(!a[j].disabled)return j}return _}function onSameLevel(_,a,$){return findElementAncestor(_,$)===findElementAncestor(a,$)}function createScopedKeydownHandler({parentSelector:_,siblingSelector:a,onKeyDown:$,loop:j=!0,activateOnFocus:_e=!1,dir:et="rtl",orientation:tt}){return rt=>{var nt;$?.(rt);const it=Array.from(((nt=findElementAncestor(rt.currentTarget,_))==null?void 0:nt.querySelectorAll(a))||[]).filter(ut=>onSameLevel(rt.currentTarget,ut,_)),st=it.findIndex(ut=>rt.currentTarget===ut),ot=getNextIndex(st,it,j),at=getPreviousIndex(st,it,j),lt=et==="rtl"?at:ot,ct=et==="rtl"?ot:at;switch(rt.key){case"ArrowRight":{tt==="horizontal"&&(rt.stopPropagation(),rt.preventDefault(),it[lt].focus(),_e&&it[lt].click());break}case"ArrowLeft":{tt==="horizontal"&&(rt.stopPropagation(),rt.preventDefault(),it[ct].focus(),_e&&it[ct].click());break}case"ArrowUp":{tt==="vertical"&&(rt.stopPropagation(),rt.preventDefault(),it[at].focus(),_e&&it[at].click());break}case"ArrowDown":{tt==="vertical"&&(rt.stopPropagation(),rt.preventDefault(),it[ot].focus(),_e&&it[ot].click());break}case"Home":{rt.stopPropagation(),rt.preventDefault(),!it[0].disabled&&it[0].focus();break}case"End":{rt.stopPropagation(),rt.preventDefault();const ut=it.length-1;!it[ut].disabled&&it[ut].focus();break}}}}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$2=react.exports,k$1=Symbol.for("react.element"),l$1=Symbol.for("react.fragment"),m$2=Object.prototype.hasOwnProperty,n$1=f$2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q$1(_,a,$){var j,_e={},et=null,tt=null;$!==void 0&&(et=""+$),a.key!==void 0&&(et=""+a.key),a.ref!==void 0&&(tt=a.ref);for(j in a)m$2.call(a,j)&&!p$1.hasOwnProperty(j)&&(_e[j]=a[j]);if(_&&_.defaultProps)for(j in a=_.defaultProps,a)_e[j]===void 0&&(_e[j]=a[j]);return{$$typeof:k$1,type:_,key:et,ref:tt,props:_e,_owner:n$1.current}}reactJsxRuntime_production_min.Fragment=l$1;reactJsxRuntime_production_min.jsx=q$1;reactJsxRuntime_production_min.jsxs=q$1;(function(_){_.exports=reactJsxRuntime_production_min})(jsxRuntime);const Fragment$1=jsxRuntime.exports.Fragment,jsx=jsxRuntime.exports.jsx,jsxs=jsxRuntime.exports.jsxs;function createSafeContext(_){const a=react.exports.createContext(null);return[({children:_e,value:et})=>jsx(a.Provider,{value:et,children:_e}),()=>{const _e=react.exports.useContext(a);if(_e===null)throw new Error(_);return _e}]}function packSx(_){return Array.isArray(_)?_:[_]}function getSafeId(_,a){return $=>{if(typeof $!="string"||$.trim().length===0)throw new Error(a);return`${_}-${$}`}}function isElement$2(_){return Array.isArray(_)||_===null?!1:typeof _=="object"?_.type!==React.Fragment:!1}function toVal(_){var a,$,j="";if(typeof _=="string"||typeof _=="number")j+=_;else if(typeof _=="object")if(Array.isArray(_))for(a=0;a<_.length;a++)_[a]&&($=toVal(_[a]))&&(j&&(j+=" "),j+=$);else for(a in _)_[a]&&(j&&(j+=" "),j+=a);return j}function clsx(){for(var _=0,a,$,j="";_<arguments.length;)(a=arguments[_++])&&($=toVal(a))&&(j&&(j+=" "),j+=$);return j}const DEFAULT_COLORS={dark:["#C1C2C5","#A6A7AB","#909296","#5c5f66","#373A40","#2C2E33","#25262b","#1A1B1E","#141517","#101113"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]};function fontStyles(_){return()=>({fontFamily:_.fontFamily||"sans-serif"})}function focusStyles(_){return a=>({WebkitTapHighlightColor:"transparent",[a||"&:focus"]:{outlineOffset:2,outline:_.focusRing==="always"||_.focusRing==="auto"?`2px solid ${_.colors[_.primaryColor][_.colorScheme==="dark"?7:5]}`:"none"},[a?a.replace(":focus",":focus:not(:focus-visible)"):"&:focus:not(:focus-visible)"]:{outline:_.focusRing==="auto"||_.focusRing==="never"?"none":void 0}})}function primaryShade(_){return a=>typeof _.primaryShade=="number"?_.primaryShade:_.primaryShade[a||_.colorScheme]}function themeColor(_){const a=primaryShade(_);return($,j,_e=!0,et=!0)=>{if(typeof $=="string"&&$.includes(".")){const[rt,nt]=$.split("."),it=parseInt(nt,10);if(rt in _.colors&&it>=0&&it<10)return _.colors[rt][typeof j=="number"&&!et?j:it]}const tt=typeof j=="number"?j:a();return $ in _.colors?_.colors[$][tt]:_e?_.colors[_.primaryColor][tt]:$}}function getGradientColorStops(_){let a="";for(let $=1;$<_.length-1;$+=1)a+=`${_[$]} ${$/(_.length-1)*100}%, `;return`${_[0]} 0%, ${a}${_[_.length-1]} 100%`}function linearGradient(_,...a){return`linear-gradient(${_}deg, ${getGradientColorStops(a)})`}function radialGradient(..._){return`radial-gradient(circle, ${getGradientColorStops(_)})`}function gradient(_){const a=themeColor(_),$=primaryShade(_);return j=>{const _e={from:j?.from||_.defaultGradient.from,to:j?.to||_.defaultGradient.to,deg:j?.deg||_.defaultGradient.deg};return`linear-gradient(${_e.deg}deg, ${a(_e.from,$(),!1)} 0%, ${a(_e.to,$(),!1)} 100%)`}}function size$1(_){if(typeof _.size=="number")return _.size;const a=_.sizes[_.size];return a!==void 0?a:_.size||_.sizes.md}function largerThan(_){return a=>`@media (min-width: ${size$1({size:a,sizes:_.breakpoints})}px)`}function smallerThan(_){return a=>`@media (max-width: ${size$1({size:a,sizes:_.breakpoints})-1}px)`}function isHexColor(_){return/^#?([0-9A-F]{3}){1,2}$/i.test(_)}function hexToRgba(_){let a=_.replace("#","");if(a.length===3){const tt=a.split("");a=[tt[0],tt[0],tt[1],tt[1],tt[2],tt[2]].join("")}const $=parseInt(a,16),j=$>>16&255,_e=$>>8&255,et=$&255;return{r:j,g:_e,b:et,a:1}}function rgbStringToRgba(_){const[a,$,j,_e]=_.replace(/[^0-9,.]/g,"").split(",").map(Number);return{r:a,g:$,b:j,a:_e||1}}function toRgba(_){return isHexColor(_)?hexToRgba(_):_.startsWith("rgb")?rgbStringToRgba(_):{r:0,g:0,b:0,a:1}}function rgba(_,a){if(typeof _!="string"||a>1||a<0)return"rgba(0, 0, 0, 1)";const{r:$,g:j,b:_e}=toRgba(_);return`rgba(${$}, ${j}, ${_e}, ${a})`}function cover(_=0){return{position:"absolute",top:_,right:_,left:_,bottom:_}}function darken(_,a){const{r:$,g:j,b:_e,a:et}=toRgba(_),tt=1-a,rt=nt=>Math.round(nt*tt);return`rgba(${rt($)}, ${rt(j)}, ${rt(_e)}, ${et})`}function lighten(_,a){const{r:$,g:j,b:_e,a:et}=toRgba(_),tt=rt=>Math.round(rt+(255-rt)*a);return`rgba(${tt($)}, ${tt(j)}, ${tt(_e)}, ${et})`}function radius(_){return a=>{if(typeof a=="number")return a;const $=typeof _.defaultRadius=="number"?_.defaultRadius:_.radius[_.defaultRadius]||_.defaultRadius;return _.radius[a]||a||$}}function getColorIndexInfo(_,a){if(typeof _=="string"&&_.includes(".")){const[$,j]=_.split("."),_e=parseInt(j,10);if($ in a.colors&&_e>=0&&_e<10)return{isSplittedColor:!0,key:$,shade:_e}}return{isSplittedColor:!1}}function variant(_){const a=themeColor(_),$=primaryShade(_),j=gradient(_);return({variant:_e,color:et,gradient:tt,primaryFallback:rt})=>{const nt=getColorIndexInfo(et,_);switch(_e){case"light":return{border:"transparent",background:rgba(a(et,_.colorScheme==="dark"?8:0,rt,!1),_.colorScheme==="dark"?.2:1),color:et==="dark"?_.colorScheme==="dark"?_.colors.dark[0]:_.colors.dark[9]:a(et,_.colorScheme==="dark"?2:$("light")),hover:rgba(a(et,_.colorScheme==="dark"?7:1,rt,!1),_.colorScheme==="dark"?.25:.65)};case"subtle":return{border:"transparent",background:"transparent",color:et==="dark"?_.colorScheme==="dark"?_.colors.dark[0]:_.colors.dark[9]:a(et,_.colorScheme==="dark"?2:$("light")),hover:rgba(a(et,_.colorScheme==="dark"?8:0,rt,!1),_.colorScheme==="dark"?.2:1)};case"outline":return{border:a(et,_.colorScheme==="dark"?5:$("light")),background:"transparent",color:a(et,_.colorScheme==="dark"?5:$("light")),hover:_.colorScheme==="dark"?rgba(a(et,5,rt,!1),.05):rgba(a(et,0,rt,!1),.35)};case"default":return{border:_.colorScheme==="dark"?_.colors.dark[4]:_.colors.gray[4],background:_.colorScheme==="dark"?_.colors.dark[6]:_.white,color:_.colorScheme==="dark"?_.white:_.black,hover:_.colorScheme==="dark"?_.colors.dark[5]:_.colors.gray[0]};case"white":return{border:"transparent",background:_.white,color:a(et,$()),hover:null};case"transparent":return{border:"transparent",color:et==="dark"?_.colorScheme==="dark"?_.colors.dark[0]:_.colors.dark[9]:a(et,_.colorScheme==="dark"?2:$("light")),background:"transparent",hover:null};case"gradient":return{background:j(tt),color:_.white,border:"transparent",hover:null};default:{const it=$(),st=nt.isSplittedColor?nt.shade:it,ot=nt.isSplittedColor?nt.key:et;return{border:"transparent",background:a(ot,st,rt),color:_.white,hover:a(ot,st===9?8:st+1)}}}}}function primaryColor(_){return a=>{const $=primaryShade(_)(a);return _.colors[_.primaryColor][$]}}function hover(_){return{"@media (hover: hover)":{"&:hover":_},"@media (hover: none)":{"&:active":_}}}const fns={fontStyles,themeColor,focusStyles,linearGradient,radialGradient,smallerThan,largerThan,rgba,size:size$1,cover,darken,lighten,radius,variant,primaryShade,hover,gradient,primaryColor};var __defProp$1n=Object.defineProperty,__defProps$F=Object.defineProperties,__getOwnPropDescs$F=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$1o=Object.getOwnPropertySymbols,__hasOwnProp$1o=Object.prototype.hasOwnProperty,__propIsEnum$1o=Object.prototype.propertyIsEnumerable,__defNormalProp$1n=(_,a,$)=>a in _?__defProp$1n(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1n=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1o.call(a,$)&&__defNormalProp$1n(_,$,a[$]);if(__getOwnPropSymbols$1o)for(var $ of __getOwnPropSymbols$1o(a))__propIsEnum$1o.call(a,$)&&__defNormalProp$1n(_,$,a[$]);return _},__spreadProps$F=(_,a)=>__defProps$F(_,__getOwnPropDescs$F(a));function attachFunctions(_){return __spreadProps$F(__spreadValues$1n({},_),{fn:{fontStyles:fns.fontStyles(_),themeColor:fns.themeColor(_),focusStyles:fns.focusStyles(_),largerThan:fns.largerThan(_),smallerThan:fns.smallerThan(_),radialGradient:fns.radialGradient,linearGradient:fns.linearGradient,gradient:fns.gradient(_),rgba:fns.rgba,size:fns.size,cover:fns.cover,lighten:fns.lighten,darken:fns.darken,primaryShade:fns.primaryShade(_),radius:fns.radius(_),variant:fns.variant(_),hover:fns.hover,primaryColor:fns.primaryColor(_)}})}Object.keys(DEFAULT_COLORS);const _DEFAULT_THEME={dir:"ltr",primaryShade:{light:6,dark:8},focusRing:"auto",loader:"oval",dateFormat:"MMMM D, YYYY",colorScheme:"light",white:"#fff",black:"#000",defaultRadius:"sm",transitionTimingFunction:"ease",colors:DEFAULT_COLORS,lineHeight:1.55,fontFamily:"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",primaryColor:"blue",respectReducedMotion:!0,cursorType:"default",defaultGradient:{from:"indigo",to:"cyan",deg:45},shadows:{xs:"0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.1)",sm:"0 1px 3px rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0px 10px 15px -5px, rgba(0, 0, 0, 0.04) 0px 7px 7px -5px",md:"0 1px 3px rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0px 20px 25px -5px, rgba(0, 0, 0, 0.04) 0px 10px 10px -5px",lg:"0 1px 3px rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0px 28px 23px -7px, rgba(0, 0, 0, 0.04) 0px 12px 12px -7px",xl:"0 1px 3px rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0px 36px 28px -7px, rgba(0, 0, 0, 0.04) 0px 17px 17px -7px"},fontSizes:{xs:12,sm:14,md:16,lg:18,xl:20},radius:{xs:2,sm:4,md:8,lg:16,xl:32},spacing:{xs:10,sm:12,md:16,lg:20,xl:24},breakpoints:{xs:576,sm:768,md:992,lg:1200,xl:1400},headings:{fontFamily:"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",fontWeight:700,sizes:{h1:{fontSize:34,lineHeight:1.3,fontWeight:void 0},h2:{fontSize:26,lineHeight:1.35,fontWeight:void 0},h3:{fontSize:22,lineHeight:1.4,fontWeight:void 0},h4:{fontSize:18,lineHeight:1.45,fontWeight:void 0},h5:{fontSize:16,lineHeight:1.5,fontWeight:void 0},h6:{fontSize:14,lineHeight:1.5,fontWeight:void 0}}},other:{},components:{},activeStyles:{transform:"translateY(1px)"},datesLocale:"en",globalStyles:void 0},DEFAULT_THEME=attachFunctions(_DEFAULT_THEME);function sheetForTag(_){if(_.sheet)return _.sheet;for(var a=0;a<document.styleSheets.length;a++)if(document.styleSheets[a].ownerNode===_)return document.styleSheets[a]}function createStyleElement(_){var a=document.createElement("style");return a.setAttribute("data-emotion",_.key),_.nonce!==void 0&&a.setAttribute("nonce",_.nonce),a.appendChild(document.createTextNode("")),a.setAttribute("data-s",""),a}var StyleSheet=function(){function _($){var j=this;this._insertTag=function(_e){var et;j.tags.length===0?j.insertionPoint?et=j.insertionPoint.nextSibling:j.prepend?et=j.container.firstChild:et=j.before:et=j.tags[j.tags.length-1].nextSibling,j.container.insertBefore(_e,et),j.tags.push(_e)},this.isSpeedy=$.speedy===void 0?!0:$.speedy,this.tags=[],this.ctr=0,this.nonce=$.nonce,this.key=$.key,this.container=$.container,this.prepend=$.prepend,this.insertionPoint=$.insertionPoint,this.before=null}var a=_.prototype;return a.hydrate=function(j){j.forEach(this._insertTag)},a.insert=function(j){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(createStyleElement(this));var _e=this.tags[this.tags.length-1];if(this.isSpeedy){var et=sheetForTag(_e);try{et.insertRule(j,et.cssRules.length)}catch{}}else _e.appendChild(document.createTextNode(j));this.ctr++},a.flush=function(){this.tags.forEach(function(j){return j.parentNode&&j.parentNode.removeChild(j)}),this.tags=[],this.ctr=0},_}(),MS="-ms-",MOZ="-moz-",WEBKIT="-webkit-",COMMENT$1="comm",RULESET="rule",DECLARATION="decl",IMPORT="@import",KEYFRAMES="@keyframes",abs=Math.abs,from$7=String.fromCharCode,assign$2=Object.assign;function hash$6(_,a){return charat(_,0)^45?(((a<<2^charat(_,0))<<2^charat(_,1))<<2^charat(_,2))<<2^charat(_,3):0}function trim(_){return _.trim()}function match(_,a){return(_=a.exec(_))?_[0]:_}function replace(_,a,$){return _.replace(a,$)}function indexof(_,a){return _.indexOf(a)}function charat(_,a){return _.charCodeAt(a)|0}function substr(_,a,$){return _.slice(a,$)}function strlen(_){return _.length}function sizeof(_){return _.length}function append(_,a){return a.push(_),_}function combine(_,a){return _.map(a).join("")}var line=1,column=1,length$8=0,position=0,character=0,characters="";function node$1(_,a,$,j,_e,et,tt){return{value:_,root:a,parent:$,type:j,props:_e,children:et,line,column,length:tt,return:""}}function copy(_,a){return assign$2(node$1("",null,null,"",null,null,0),_,{length:-_.length},a)}function char(){return character}function prev$1(){return character=position>0?charat(characters,--position):0,column--,character===10&&(column=1,line--),character}function next(){return character=position<length$8?charat(characters,position++):0,column++,character===10&&(column=1,line++),character}function peek(){return charat(characters,position)}function caret(){return position}function slice$1(_,a){return substr(characters,_,a)}function token(_){switch(_){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function alloc$2(_){return line=column=1,length$8=strlen(characters=_),position=0,[]}function dealloc(_){return characters="",_}function delimit(_){return trim(slice$1(position-1,delimiter(_===91?_+2:_===40?_+1:_)))}function whitespace(_){for(;(character=peek())&&character<33;)next();return token(_)>2||token(character)>3?"":" "}function escaping(_,a){for(;--a&&next()&&!(character<48||character>102||character>57&&character<65||character>70&&character<97););return slice$1(_,caret()+(a<6&&peek()==32&&next()==32))}function delimiter(_){for(;next();)switch(character){case _:return position;case 34:case 39:_!==34&&_!==39&&delimiter(character);break;case 40:_===41&&delimiter(_);break;case 92:next();break}return position}function commenter(_,a){for(;next()&&_+character!==47+10;)if(_+character===42+42&&peek()===47)break;return"/*"+slice$1(a,position-1)+"*"+from$7(_===47?_:next())}function identifier(_){for(;!token(peek());)next();return slice$1(_,position)}function compile(_){return dealloc(parse$5("",null,null,null,[""],_=alloc$2(_),0,[0],_))}function parse$5(_,a,$,j,_e,et,tt,rt,nt){for(var it=0,st=0,ot=tt,at=0,lt=0,ct=0,ut=1,dt=1,ft=1,pt=0,yt="",mt=_e,_t=et,vt=j,ht=yt;dt;)switch(ct=pt,pt=next()){case 40:if(ct!=108&&charat(ht,ot-1)==58){indexof(ht+=replace(delimit(pt),"&","&\f"),"&\f")!=-1&&(ft=-1);break}case 34:case 39:case 91:ht+=delimit(pt);break;case 9:case 10:case 13:case 32:ht+=whitespace(ct);break;case 92:ht+=escaping(caret()-1,7);continue;case 47:switch(peek()){case 42:case 47:append(comment(commenter(next(),caret()),a,$),nt);break;default:ht+="/"}break;case 123*ut:rt[it++]=strlen(ht)*ft;case 125*ut:case 59:case 0:switch(pt){case 0:case 125:dt=0;case 59+st:lt>0&&strlen(ht)-ot&&append(lt>32?declaration(ht+";",j,$,ot-1):declaration(replace(ht," ","")+";",j,$,ot-2),nt);break;case 59:ht+=";";default:if(append(vt=ruleset(ht,a,$,it,st,_e,rt,yt,mt=[],_t=[],ot),et),pt===123)if(st===0)parse$5(ht,a,vt,vt,mt,et,ot,rt,_t);else switch(at===99&&charat(ht,3)===110?100:at){case 100:case 109:case 115:parse$5(_,vt,vt,j&&append(ruleset(_,vt,vt,0,0,_e,rt,yt,_e,mt=[],ot),_t),_e,_t,ot,rt,j?mt:_t);break;default:parse$5(ht,vt,vt,vt,[""],_t,0,rt,_t)}}it=st=lt=0,ut=ft=1,yt=ht="",ot=tt;break;case 58:ot=1+strlen(ht),lt=ct;default:if(ut<1){if(pt==123)--ut;else if(pt==125&&ut++==0&&prev$1()==125)continue}switch(ht+=from$7(pt),pt*ut){case 38:ft=st>0?1:(ht+="\f",-1);break;case 44:rt[it++]=(strlen(ht)-1)*ft,ft=1;break;case 64:peek()===45&&(ht+=delimit(next())),at=peek(),st=ot=strlen(yt=ht+=identifier(caret())),pt++;break;case 45:ct===45&&strlen(ht)==2&&(ut=0)}}return et}function ruleset(_,a,$,j,_e,et,tt,rt,nt,it,st){for(var ot=_e-1,at=_e===0?et:[""],lt=sizeof(at),ct=0,ut=0,dt=0;ct<j;++ct)for(var ft=0,pt=substr(_,ot+1,ot=abs(ut=tt[ct])),yt=_;ft<lt;++ft)(yt=trim(ut>0?at[ft]+" "+pt:replace(pt,/&\f/g,at[ft])))&&(nt[dt++]=yt);return node$1(_,a,$,_e===0?RULESET:rt,nt,it,st)}function comment(_,a,$){return node$1(_,a,$,COMMENT$1,from$7(char()),substr(_,2,-2),0)}function declaration(_,a,$,j){return node$1(_,a,$,DECLARATION,substr(_,0,j),substr(_,j+1,-1),j)}function serialize(_,a){for(var $="",j=sizeof(_),_e=0;_e<j;_e++)$+=a(_[_e],_e,_,a)||"";return $}function stringify(_,a,$,j){switch(_.type){case IMPORT:case DECLARATION:return _.return=_.return||_.value;case COMMENT$1:return"";case KEYFRAMES:return _.return=_.value+"{"+serialize(_.children,j)+"}";case RULESET:_.value=_.props.join(",")}return strlen($=serialize(_.children,j))?_.return=_.value+"{"+$+"}":""}function middleware(_){var a=sizeof(_);return function($,j,_e,et){for(var tt="",rt=0;rt<a;rt++)tt+=_[rt]($,j,_e,et)||"";return tt}}function rulesheet(_){return function(a){a.root||(a=a.return)&&_(a)}}var weakMemoize=function(a){var $=new WeakMap;return function(j){if($.has(j))return $.get(j);var _e=a(j);return $.set(j,_e),_e}};function memoize(_){var a=Object.create(null);return function($){return a[$]===void 0&&(a[$]=_($)),a[$]}}var identifierWithPointTracking=function(a,$,j){for(var _e=0,et=0;_e=et,et=peek(),_e===38&&et===12&&($[j]=1),!token(et);)next();return slice$1(a,position)},toRules=function(a,$){var j=-1,_e=44;do switch(token(_e)){case 0:_e===38&&peek()===12&&($[j]=1),a[j]+=identifierWithPointTracking(position-1,$,j);break;case 2:a[j]+=delimit(_e);break;case 4:if(_e===44){a[++j]=peek()===58?"&\f":"",$[j]=a[j].length;break}default:a[j]+=from$7(_e)}while(_e=next());return a},getRules=function(a,$){return dealloc(toRules(alloc$2(a),$))},fixedElements=new WeakMap,compat=function(a){if(!(a.type!=="rule"||!a.parent||a.length<1)){for(var $=a.value,j=a.parent,_e=a.column===j.column&&a.line===j.line;j.type!=="rule";)if(j=j.parent,!j)return;if(!(a.props.length===1&&$.charCodeAt(0)!==58&&!fixedElements.get(j))&&!_e){fixedElements.set(a,!0);for(var et=[],tt=getRules($,et),rt=j.props,nt=0,it=0;nt<tt.length;nt++)for(var st=0;st<rt.length;st++,it++)a.props[it]=et[nt]?tt[nt].replace(/&\f/g,rt[st]):rt[st]+" "+tt[nt]}}},removeLabel=function(a){if(a.type==="decl"){var $=a.value;$.charCodeAt(0)===108&&$.charCodeAt(2)===98&&(a.return="",a.value="")}};function prefix(_,a){switch(hash$6(_,a)){case 5103:return WEBKIT+"print-"+_+_;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return WEBKIT+_+_;case 5349:case 4246:case 4810:case 6968:case 2756:return WEBKIT+_+MOZ+_+MS+_+_;case 6828:case 4268:return WEBKIT+_+MS+_+_;case 6165:return WEBKIT+_+MS+"flex-"+_+_;case 5187:return WEBKIT+_+replace(_,/(\w+).+(:[^]+)/,WEBKIT+"box-$1$2"+MS+"flex-$1$2")+_;case 5443:return WEBKIT+_+MS+"flex-item-"+replace(_,/flex-|-self/,"")+_;case 4675:return WEBKIT+_+MS+"flex-line-pack"+replace(_,/align-content|flex-|-self/,"")+_;case 5548:return WEBKIT+_+MS+replace(_,"shrink","negative")+_;case 5292:return WEBKIT+_+MS+replace(_,"basis","preferred-size")+_;case 6060:return WEBKIT+"box-"+replace(_,"-grow","")+WEBKIT+_+MS+replace(_,"grow","positive")+_;case 4554:return WEBKIT+replace(_,/([^-])(transform)/g,"$1"+WEBKIT+"$2")+_;case 6187:return replace(replace(replace(_,/(zoom-|grab)/,WEBKIT+"$1"),/(image-set)/,WEBKIT+"$1"),_,"")+_;case 5495:case 3959:return replace(_,/(image-set\([^]*)/,WEBKIT+"$1$`$1");case 4968:return replace(replace(_,/(.+:)(flex-)?(.*)/,WEBKIT+"box-pack:$3"+MS+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+WEBKIT+_+_;case 4095:case 3583:case 4068:case 2532:return replace(_,/(.+)-inline(.+)/,WEBKIT+"$1$2")+_;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(strlen(_)-1-a>6)switch(charat(_,a+1)){case 109:if(charat(_,a+4)!==45)break;case 102:return replace(_,/(.+:)(.+)-([^]+)/,"$1"+WEBKIT+"$2-$3$1"+MOZ+(charat(_,a+3)==108?"$3":"$2-$3"))+_;case 115:return~indexof(_,"stretch")?prefix(replace(_,"stretch","fill-available"),a)+_:_}break;case 4949:if(charat(_,a+1)!==115)break;case 6444:switch(charat(_,strlen(_)-3-(~indexof(_,"!important")&&10))){case 107:return replace(_,":",":"+WEBKIT)+_;case 101:return replace(_,/(.+:)([^;!]+)(;|!.+)?/,"$1"+WEBKIT+(charat(_,14)===45?"inline-":"")+"box$3$1"+WEBKIT+"$2$3$1"+MS+"$2box$3")+_}break;case 5936:switch(charat(_,a+11)){case 114:return WEBKIT+_+MS+replace(_,/[svh]\w+-[tblr]{2}/,"tb")+_;case 108:return WEBKIT+_+MS+replace(_,/[svh]\w+-[tblr]{2}/,"tb-rl")+_;case 45:return WEBKIT+_+MS+replace(_,/[svh]\w+-[tblr]{2}/,"lr")+_}return WEBKIT+_+MS+_+_}return _}var prefixer=function(a,$,j,_e){if(a.length>-1&&!a.return)switch(a.type){case DECLARATION:a.return=prefix(a.value,a.length);break;case KEYFRAMES:return serialize([copy(a,{value:replace(a.value,"@","@"+WEBKIT)})],_e);case RULESET:if(a.length)return combine(a.props,function(et){switch(match(et,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return serialize([copy(a,{props:[replace(et,/:(read-\w+)/,":"+MOZ+"$1")]})],_e);case"::placeholder":return serialize([copy(a,{props:[replace(et,/:(plac\w+)/,":"+WEBKIT+"input-$1")]}),copy(a,{props:[replace(et,/:(plac\w+)/,":"+MOZ+"$1")]}),copy(a,{props:[replace(et,/:(plac\w+)/,MS+"input-$1")]})],_e)}return""})}},defaultStylisPlugins=[prefixer],createCache=function(a){var $=a.key;if($==="css"){var j=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(j,function(ut){var dt=ut.getAttribute("data-emotion");dt.indexOf(" ")!==-1&&(document.head.appendChild(ut),ut.setAttribute("data-s",""))})}var _e=a.stylisPlugins||defaultStylisPlugins,et={},tt,rt=[];tt=a.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+$+' "]'),function(ut){for(var dt=ut.getAttribute("data-emotion").split(" "),ft=1;ft<dt.length;ft++)et[dt[ft]]=!0;rt.push(ut)});var nt,it=[compat,removeLabel];{var st,ot=[stringify,rulesheet(function(ut){st.insert(ut)})],at=middleware(it.concat(_e,ot)),lt=function(dt){return serialize(compile(dt),at)};nt=function(dt,ft,pt,yt){st=pt,lt(dt?dt+"{"+ft.styles+"}":ft.styles),yt&&(ct.inserted[ft.name]=!0)}}var ct={key:$,sheet:new StyleSheet({key:$,container:tt,nonce:a.nonce,speedy:a.speedy,prepend:a.prepend,insertionPoint:a.insertionPoint}),nonce:a.nonce,inserted:et,registered:{},insert:nt};return ct.sheet.hydrate(rt),ct};function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(_){for(var a=1;a<arguments.length;a++){var $=arguments[a];for(var j in $)Object.prototype.hasOwnProperty.call($,j)&&(_[j]=$[j])}return _},_extends$2.apply(this,arguments)}var reactIs$1={exports:{}},reactIs_production_min={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b$1=typeof Symbol=="function"&&Symbol.for,c=b$1?Symbol.for("react.element"):60103,d$1=b$1?Symbol.for("react.portal"):60106,e=b$1?Symbol.for("react.fragment"):60107,f$1=b$1?Symbol.for("react.strict_mode"):60108,g=b$1?Symbol.for("react.profiler"):60114,h$1=b$1?Symbol.for("react.provider"):60109,k=b$1?Symbol.for("react.context"):60110,l=b$1?Symbol.for("react.async_mode"):60111,m$1=b$1?Symbol.for("react.concurrent_mode"):60111,n=b$1?Symbol.for("react.forward_ref"):60112,p=b$1?Symbol.for("react.suspense"):60113,q=b$1?Symbol.for("react.suspense_list"):60120,r$2=b$1?Symbol.for("react.memo"):60115,t$1=b$1?Symbol.for("react.lazy"):60116,v=b$1?Symbol.for("react.block"):60121,w$1=b$1?Symbol.for("react.fundamental"):60117,x$1=b$1?Symbol.for("react.responder"):60118,y$1=b$1?Symbol.for("react.scope"):60119;function z$1(_){if(typeof _=="object"&&_!==null){var a=_.$$typeof;switch(a){case c:switch(_=_.type,_){case l:case m$1:case e:case g:case f$1:case p:return _;default:switch(_=_&&_.$$typeof,_){case k:case n:case t$1:case r$2:case h$1:return _;default:return a}}case d$1:return a}}}function A(_){return z$1(_)===m$1}reactIs_production_min.AsyncMode=l;reactIs_production_min.ConcurrentMode=m$1;reactIs_production_min.ContextConsumer=k;reactIs_production_min.ContextProvider=h$1;reactIs_production_min.Element=c;reactIs_production_min.ForwardRef=n;reactIs_production_min.Fragment=e;reactIs_production_min.Lazy=t$1;reactIs_production_min.Memo=r$2;reactIs_production_min.Portal=d$1;reactIs_production_min.Profiler=g;reactIs_production_min.StrictMode=f$1;reactIs_production_min.Suspense=p;reactIs_production_min.isAsyncMode=function(_){return A(_)||z$1(_)===l};reactIs_production_min.isConcurrentMode=A;reactIs_production_min.isContextConsumer=function(_){return z$1(_)===k};reactIs_production_min.isContextProvider=function(_){return z$1(_)===h$1};reactIs_production_min.isElement=function(_){return typeof _=="object"&&_!==null&&_.$$typeof===c};reactIs_production_min.isForwardRef=function(_){return z$1(_)===n};reactIs_production_min.isFragment=function(_){return z$1(_)===e};reactIs_production_min.isLazy=function(_){return z$1(_)===t$1};reactIs_production_min.isMemo=function(_){return z$1(_)===r$2};reactIs_production_min.isPortal=function(_){return z$1(_)===d$1};reactIs_production_min.isProfiler=function(_){return z$1(_)===g};reactIs_production_min.isStrictMode=function(_){return z$1(_)===f$1};reactIs_production_min.isSuspense=function(_){return z$1(_)===p};reactIs_production_min.isValidElementType=function(_){return typeof _=="string"||typeof _=="function"||_===e||_===m$1||_===g||_===f$1||_===p||_===q||typeof _=="object"&&_!==null&&(_.$$typeof===t$1||_.$$typeof===r$2||_.$$typeof===h$1||_.$$typeof===k||_.$$typeof===n||_.$$typeof===w$1||_.$$typeof===x$1||_.$$typeof===y$1||_.$$typeof===v)};reactIs_production_min.typeOf=z$1;(function(_){_.exports=reactIs_production_min})(reactIs$1);var reactIs=reactIs$1.exports,FORWARD_REF_STATICS={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},MEMO_STATICS={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},TYPE_STATICS={};TYPE_STATICS[reactIs.ForwardRef]=FORWARD_REF_STATICS;TYPE_STATICS[reactIs.Memo]=MEMO_STATICS;var isBrowser$2=!0;function getRegisteredStyles(_,a,$){var j="";return $.split(" ").forEach(function(_e){_[_e]!==void 0?a.push(_[_e]+";"):j+=_e+" "}),j}var registerStyles=function(a,$,j){var _e=a.key+"-"+$.name;(j===!1||isBrowser$2===!1)&&a.registered[_e]===void 0&&(a.registered[_e]=$.styles)},insertStyles=function(a,$,j){registerStyles(a,$,j);var _e=a.key+"-"+$.name;if(a.inserted[$.name]===void 0){var et=$;do a.insert($===et?"."+_e:"",et,a.sheet,!0),et=et.next;while(et!==void 0)}};function murmur2(_){for(var a=0,$,j=0,_e=_.length;_e>=4;++j,_e-=4)$=_.charCodeAt(j)&255|(_.charCodeAt(++j)&255)<<8|(_.charCodeAt(++j)&255)<<16|(_.charCodeAt(++j)&255)<<24,$=($&65535)*1540483477+(($>>>16)*59797<<16),$^=$>>>24,a=($&65535)*1540483477+(($>>>16)*59797<<16)^(a&65535)*1540483477+((a>>>16)*59797<<16);switch(_e){case 3:a^=(_.charCodeAt(j+2)&255)<<16;case 2:a^=(_.charCodeAt(j+1)&255)<<8;case 1:a^=_.charCodeAt(j)&255,a=(a&65535)*1540483477+((a>>>16)*59797<<16)}return a^=a>>>13,a=(a&65535)*1540483477+((a>>>16)*59797<<16),((a^a>>>15)>>>0).toString(36)}var unitlessKeys={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},hyphenateRegex=/[A-Z]|^ms/g,animationRegex=/_EMO_([^_]+?)_([^]*?)_EMO_/g,isCustomProperty=function(a){return a.charCodeAt(1)===45},isProcessableValue=function(a){return a!=null&&typeof a!="boolean"},processStyleName=memoize(function(_){return isCustomProperty(_)?_:_.replace(hyphenateRegex,"-$&").toLowerCase()}),processStyleValue=function(a,$){switch(a){case"animation":case"animationName":if(typeof $=="string")return $.replace(animationRegex,function(j,_e,et){return cursor={name:_e,styles:et,next:cursor},_e})}return unitlessKeys[a]!==1&&!isCustomProperty(a)&&typeof $=="number"&&$!==0?$+"px":$},noComponentSelectorMessage="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function handleInterpolation(_,a,$){if($==null)return"";if($.__emotion_styles!==void 0)return $;switch(typeof $){case"boolean":return"";case"object":{if($.anim===1)return cursor={name:$.name,styles:$.styles,next:cursor},$.name;if($.styles!==void 0){var j=$.next;if(j!==void 0)for(;j!==void 0;)cursor={name:j.name,styles:j.styles,next:cursor},j=j.next;var _e=$.styles+";";return _e}return createStringFromObject(_,a,$)}case"function":{if(_!==void 0){var et=cursor,tt=$(_);return cursor=et,handleInterpolation(_,a,tt)}break}}if(a==null)return $;var rt=a[$];return rt!==void 0?rt:$}function createStringFromObject(_,a,$){var j="";if(Array.isArray($))for(var _e=0;_e<$.length;_e++)j+=handleInterpolation(_,a,$[_e])+";";else for(var et in $){var tt=$[et];if(typeof tt!="object")a!=null&&a[tt]!==void 0?j+=et+"{"+a[tt]+"}":isProcessableValue(tt)&&(j+=processStyleName(et)+":"+processStyleValue(et,tt)+";");else if(Array.isArray(tt)&&typeof tt[0]=="string"&&(a==null||a[tt[0]]===void 0))for(var rt=0;rt<tt.length;rt++)isProcessableValue(tt[rt])&&(j+=processStyleName(et)+":"+processStyleValue(et,tt[rt])+";");else{var nt=handleInterpolation(_,a,tt);switch(et){case"animation":case"animationName":{j+=processStyleName(et)+":"+nt+";";break}default:j+=et+"{"+nt+"}"}}}return j}var labelPattern=/label:\s*([^\s;\n{]+)\s*(;|$)/g,cursor,serializeStyles=function(a,$,j){if(a.length===1&&typeof a[0]=="object"&&a[0]!==null&&a[0].styles!==void 0)return a[0];var _e=!0,et="";cursor=void 0;var tt=a[0];tt==null||tt.raw===void 0?(_e=!1,et+=handleInterpolation(j,$,tt)):et+=tt[0];for(var rt=1;rt<a.length;rt++)et+=handleInterpolation(j,$,a[rt]),_e&&(et+=tt[rt]);labelPattern.lastIndex=0;for(var nt="",it;(it=labelPattern.exec(et))!==null;)nt+="-"+it[1];var st=murmur2(et)+nt;return{name:st,styles:et,next:cursor}},useInsertionEffect$1=React$1["useInsertionEffect"]?React$1["useInsertionEffect"]:!1,useInsertionEffectWithLayoutFallback=useInsertionEffect$1||react.exports.useLayoutEffect,EmotionCacheContext=react.exports.createContext(typeof HTMLElement<"u"?createCache({key:"css"}):null);EmotionCacheContext.Provider;var withEmotionCache=function(a){return react.exports.forwardRef(function($,j){var _e=react.exports.useContext(EmotionCacheContext);return a($,_e,j)})},ThemeContext=react.exports.createContext({}),getTheme=function(a,$){if(typeof $=="function"){var j=$(a);return j}return _extends$2({},a,$)},createCacheWithTheme=weakMemoize(function(_){return weakMemoize(function(a){return getTheme(_,a)})}),ThemeProvider=function(a){var $=react.exports.useContext(ThemeContext);return a.theme!==$&&($=createCacheWithTheme($)(a.theme)),react.exports.createElement(ThemeContext.Provider,{value:$},a.children)},Global$1=withEmotionCache(function(_,a){var $=_.styles,j=serializeStyles([$],void 0,react.exports.useContext(ThemeContext)),_e=react.exports.useRef();return useInsertionEffectWithLayoutFallback(function(){var et=a.key+"-({})",tt=new a.sheet.constructor({key:et,nonce:a.sheet.nonce,container:a.sheet.container,speedy:a.sheet.isSpeedy}),rt=!1,nt=document.querySelector('style[data-emotion="'+et+" "+j.name+'"]');return a.sheet.tags.length&&(tt.before=a.sheet.tags[0]),nt!==null&&(rt=!0,nt.setAttribute("data-emotion",et),tt.hydrate([nt])),_e.current=[tt,rt],function(){tt.flush()}},[a]),useInsertionEffectWithLayoutFallback(function(){var et=_e.current,tt=et[0],rt=et[1];if(rt){et[1]=!1;return}if(j.next!==void 0&&insertStyles(a,j.next,!0),tt.tags.length){var nt=tt.tags[tt.tags.length-1].nextElementSibling;tt.before=nt,tt.flush()}a.insert("",j,tt,!1)},[a,j.name]),null});function css(){for(var _=arguments.length,a=new Array(_),$=0;$<_;$++)a[$]=arguments[$];return serializeStyles(a)}var keyframes=function(){var a=css.apply(void 0,arguments),$="animation-"+a.name;return{name:$,styles:"@keyframes "+$+"{"+a.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},__defProp$1m=Object.defineProperty,__defProps$E=Object.defineProperties,__getOwnPropDescs$E=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$1n=Object.getOwnPropertySymbols,__hasOwnProp$1n=Object.prototype.hasOwnProperty,__propIsEnum$1n=Object.prototype.propertyIsEnumerable,__defNormalProp$1m=(_,a,$)=>a in _?__defProp$1m(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1m=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1n.call(a,$)&&__defNormalProp$1m(_,$,a[$]);if(__getOwnPropSymbols$1n)for(var $ of __getOwnPropSymbols$1n(a))__propIsEnum$1n.call(a,$)&&__defNormalProp$1m(_,$,a[$]);return _},__spreadProps$E=(_,a)=>__defProps$E(_,__getOwnPropDescs$E(a));function GlobalStyles({theme:_}){return jsx(Global$1,{styles:{"*, *::before, *::after":{boxSizing:"border-box"},html:{colorScheme:_.colorScheme==="dark"?"dark":"light"},body:__spreadProps$E(__spreadValues$1m({},_.fn.fontStyles()),{backgroundColor:_.colorScheme==="dark"?_.colors.dark[7]:_.white,color:_.colorScheme==="dark"?_.colors.dark[0]:_.black,lineHeight:_.lineHeight,fontSize:_.fontSizes.md,WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"})}})}function assignSizeVariables(_,a,$){Object.keys(a).forEach(j=>{_[`--mantine-${$}-${j}`]=typeof a[j]=="number"?`${a[j]}px`:a[j]})}function MantineCssVariables({theme:_}){const a={"--mantine-color-white":_.white,"--mantine-color-black":_.black,"--mantine-transition-timing-function":_.transitionTimingFunction,"--mantine-line-height":`${_.lineHeight}`,"--mantine-font-family":_.fontFamily,"--mantine-font-family-monospace":_.fontFamilyMonospace,"--mantine-font-family-headings":_.headings.fontFamily,"--mantine-heading-font-weight":`${_.headings.fontWeight}`};assignSizeVariables(a,_.shadows,"shadow"),assignSizeVariables(a,_.fontSizes,"font-size"),assignSizeVariables(a,_.radius,"radius"),assignSizeVariables(a,_.spacing,"spacing"),Object.keys(_.colors).forEach(j=>{_.colors[j].forEach((_e,et)=>{a[`--mantine-color-${j}-${et}`]=_e})});const $=_.headings.sizes;return Object.keys($).forEach(j=>{a[`--mantine-${j}-font-size`]=`${$[j].fontSize}px`,a[`--mantine-${j}-line-height`]=`${$[j].lineHeight}`}),jsx(Global$1,{styles:{":root":a}})}var __defProp$1l=Object.defineProperty,__defProps$D=Object.defineProperties,__getOwnPropDescs$D=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$1m=Object.getOwnPropertySymbols,__hasOwnProp$1m=Object.prototype.hasOwnProperty,__propIsEnum$1m=Object.prototype.propertyIsEnumerable,__defNormalProp$1l=(_,a,$)=>a in _?__defProp$1l(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1l=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1m.call(a,$)&&__defNormalProp$1l(_,$,a[$]);if(__getOwnPropSymbols$1m)for(var $ of __getOwnPropSymbols$1m(a))__propIsEnum$1m.call(a,$)&&__defNormalProp$1l(_,$,a[$]);return _},__spreadProps$D=(_,a)=>__defProps$D(_,__getOwnPropDescs$D(a));function mergeTheme(_,a){return a?Object.keys(_).reduce(($,j)=>{if(j==="headings"&&a.headings){const _e=a.headings.sizes?Object.keys(_.headings.sizes).reduce((et,tt)=>(et[tt]=__spreadValues$1l(__spreadValues$1l({},_.headings.sizes[tt]),a.headings.sizes[tt]),et),{}):_.headings.sizes;return __spreadProps$D(__spreadValues$1l({},$),{headings:__spreadProps$D(__spreadValues$1l(__spreadValues$1l({},_.headings),a.headings),{sizes:_e})})}return $[j]=typeof a[j]=="object"?__spreadValues$1l(__spreadValues$1l({},_[j]),a[j]):typeof a[j]=="number"||typeof a[j]=="boolean"||typeof a[j]=="function"?a[j]:a[j]||_[j],$},{}):_}function mergeThemeWithFunctions(_,a){return attachFunctions(mergeTheme(_,a))}function filterProps(_){return Object.keys(_).reduce((a,$)=>(_[$]!==void 0&&(a[$]=_[$]),a),{})}const styles={html:{fontFamily:"sans-serif",lineHeight:"1.15",textSizeAdjust:"100%"},body:{margin:0},"article, aside, footer, header, nav, section, figcaption, figure, main":{display:"block"},h1:{fontSize:"2em"},hr:{boxSizing:"content-box",height:0,overflow:"visible"},pre:{fontFamily:"monospace, monospace",fontSize:"1em"},a:{background:"transparent",textDecorationSkip:"objects"},"a:active, a:hover":{outlineWidth:0},"abbr[title]":{borderBottom:"none",textDecoration:"underline"},"b, strong":{fontWeight:"bolder"},"code, kbp, samp":{fontFamily:"monospace, monospace",fontSize:"1em"},dfn:{fontStyle:"italic"},mark:{backgroundColor:"#ff0",color:"#000"},small:{fontSize:"80%"},"sub, sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sup:{top:"-0.5em"},sub:{bottom:"-0.25em"},"audio, video":{display:"inline-block"},"audio:not([controls])":{display:"none",height:0},img:{borderStyle:"none",verticalAlign:"middle"},"svg:not(:root)":{overflow:"hidden"},"button, input, optgroup, select, textarea":{fontFamily:"sans-serif",fontSize:"100%",lineHeight:"1.15",margin:0},"button, input":{overflow:"visible"},"button, select":{textTransform:"none"},"button, [type=reset], [type=submit]":{WebkitAppearance:"button"},"button::-moz-focus-inner, [type=button]::-moz-focus-inner, [type=reset]::-moz-focus-inner, [type=submit]::-moz-focus-inner":{borderStyle:"none",padding:0},"button:-moz-focusring, [type=button]:-moz-focusring, [type=reset]:-moz-focusring, [type=submit]:-moz-focusring":{outline:"1px dotted ButtonText"},legend:{boxSizing:"border-box",color:"inherit",display:"table",maxWidth:"100%",padding:0,whiteSpace:"normal"},progress:{display:"inline-block",verticalAlign:"baseline"},textarea:{overflow:"auto"},"[type=checkbox], [type=radio]":{boxSizing:"border-box",padding:0},"[type=number]::-webkit-inner-spin-button, [type=number]::-webkit-outer-spin-button":{height:"auto"},"[type=search]":{appearance:"none"},"[type=search]::-webkit-search-cancel-button, [type=search]::-webkit-search-decoration":{appearance:"none"},"::-webkit-file-upload-button":{appearance:"button",font:"inherit"},"details, menu":{display:"block"},summary:{display:"list-item"},canvas:{display:"inline-block"},template:{display:"none"},"[hidden]":{display:"none"}};function NormalizeCSS(){return jsx(Global$1,{styles})}var __defProp$1k=Object.defineProperty,__getOwnPropSymbols$1l=Object.getOwnPropertySymbols,__hasOwnProp$1l=Object.prototype.hasOwnProperty,__propIsEnum$1l=Object.prototype.propertyIsEnumerable,__defNormalProp$1k=(_,a,$)=>a in _?__defProp$1k(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1k=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1l.call(a,$)&&__defNormalProp$1k(_,$,a[$]);if(__getOwnPropSymbols$1l)for(var $ of __getOwnPropSymbols$1l(a))__propIsEnum$1l.call(a,$)&&__defNormalProp$1k(_,$,a[$]);return _};const MantineProviderContext=react.exports.createContext({theme:DEFAULT_THEME});function useMantineTheme(){var _;return((_=react.exports.useContext(MantineProviderContext))==null?void 0:_.theme)||DEFAULT_THEME}function useMantineProviderStyles(_){const a=useMantineTheme(),$=j=>{var _e,et;return{styles:((_e=a.components[j])==null?void 0:_e.styles)||{},classNames:((et=a.components[j])==null?void 0:et.classNames)||{}}};return Array.isArray(_)?_.map($):[$(_)]}function useMantineEmotionCache(){var _;return(_=react.exports.useContext(MantineProviderContext))==null?void 0:_.emotionCache}function useComponentDefaultProps(_,a,$){var j;const et=(j=useMantineTheme().components[_])==null?void 0:j.defaultProps;return __spreadValues$1k(__spreadValues$1k(__spreadValues$1k({},a),et),filterProps($))}function MantineProvider({theme:_,emotionCache:a,withNormalizeCSS:$=!1,withGlobalStyles:j=!1,withCSSVariables:_e=!1,inherit:et=!1,children:tt}){const rt=react.exports.useContext(MantineProviderContext),nt=mergeThemeWithFunctions(DEFAULT_THEME,et?__spreadValues$1k(__spreadValues$1k({},rt.theme),_):_);return jsx(ThemeProvider,{theme:nt,children:jsxs(MantineProviderContext.Provider,{value:{theme:nt,emotionCache:a},children:[$&&jsx(NormalizeCSS,{}),j&&jsx(GlobalStyles,{theme:nt}),_e&&jsx(MantineCssVariables,{theme:nt}),typeof nt.globalStyles=="function"&&jsx(Global$1,{styles:nt.globalStyles(nt)}),tt]})})}MantineProvider.displayName="@mantine/core/MantineProvider";const ColorSchemeContext=react.exports.createContext(null);function useMantineColorScheme(){const _=react.exports.useContext(ColorSchemeContext);if(!_)throw new Error("useMantineColorScheme hook was called outside of context, make sure your app is wrapped with ColorSchemeProvider component");return _}function ColorSchemeProvider({colorScheme:_,toggleColorScheme:a,children:$}){return jsx(ColorSchemeContext.Provider,{value:{colorScheme:_,toggleColorScheme:a},children:$})}ColorSchemeProvider.displayName="@mantine/core/ColorSchemeProvider";const StylesApiContext=react.exports.createContext({classNames:{},styles:{},unstyled:!1});function StylesApiProvider({children:_,classNames:a,unstyled:$,styles:j,staticSelector:_e}){return jsx(StylesApiContext.Provider,{value:{classNames:a,styles:j,unstyled:$,staticSelector:_e},children:_})}function useContextStylesApi(){return react.exports.useContext(StylesApiContext)}const elevations={app:100,modal:200,popover:300,overlay:400,max:9999};function getDefaultZIndex(_){return elevations[_]}var __getOwnPropSymbols$1k=Object.getOwnPropertySymbols,__hasOwnProp$1k=Object.prototype.hasOwnProperty,__propIsEnum$1k=Object.prototype.propertyIsEnumerable,__objRest$R=(_,a)=>{var $={};for(var j in _)__hasOwnProp$1k.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$1k)for(var j of __getOwnPropSymbols$1k(_))a.indexOf(j)<0&&__propIsEnum$1k.call(_,j)&&($[j]=_[j]);return $};function extractSystemStyles(_){const a=_,{m:$,mx:j,my:_e,mt:et,mb:tt,ml:rt,mr:nt,p:it,px:st,py:ot,pt:at,pb:lt,pl:ct,pr:ut}=a,dt=__objRest$R(a,["m","mx","my","mt","mb","ml","mr","p","px","py","pt","pb","pl","pr"]);return{systemStyles:filterProps({m:$,mx:j,my:_e,mt:et,mb:tt,ml:rt,mr:nt,p:it,px:st,py:ot,pt:at,pb:lt,pl:ct,pr:ut}),rest:dt}}function useGuaranteedMemo(_,a){const $=react.exports.useRef();return(!$.current||a.length!==$.current.prevDeps.length||$.current.prevDeps.map((j,_e)=>j===a[_e]).indexOf(!1)>=0)&&($.current={v:_(),prevDeps:[...a]}),$.current.v}const defaultMantineEmotionCache=createCache({key:"mantine",prepend:!0});function useEmotionCache(){return useMantineEmotionCache()||defaultMantineEmotionCache}var __defProp$1j=Object.defineProperty,__getOwnPropSymbols$1j=Object.getOwnPropertySymbols,__hasOwnProp$1j=Object.prototype.hasOwnProperty,__propIsEnum$1j=Object.prototype.propertyIsEnumerable,__defNormalProp$1j=(_,a,$)=>a in _?__defProp$1j(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1j=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1j.call(a,$)&&__defNormalProp$1j(_,$,a[$]);if(__getOwnPropSymbols$1j)for(var $ of __getOwnPropSymbols$1j(a))__propIsEnum$1j.call(a,$)&&__defNormalProp$1j(_,$,a[$]);return _};const refPropertyName="ref";function getRef(_){let a;if(_.length!==1)return{args:_,ref:a};const[$]=_;if(!($ instanceof Object))return{args:_,ref:a};if(!(refPropertyName in $))return{args:_,ref:a};a=$[refPropertyName];const j=__spreadValues$1j({},$);return delete j[refPropertyName],{args:[j],ref:a}}const{cssFactory}=(()=>{function _($,j,_e){const et=[],tt=getRegisteredStyles($,et,_e);return et.length<2?_e:tt+j(et)}function a($){const{cache:j}=$,_e=(...tt)=>{const{ref:rt,args:nt}=getRef(tt),it=serializeStyles(nt,j.registered);return insertStyles(j,it,!1),`${j.key}-${it.name}${rt===void 0?"":` ${rt}`}`};return{css:_e,cx:(...tt)=>_(j.registered,_e,clsx(tt))}}return{cssFactory:a}})();function useCss(){const _=useEmotionCache();return useGuaranteedMemo(()=>cssFactory({cache:_}),[_])}function mergeClassNames({cx:_,classes:a,context:$,classNames:j,name:_e,cache:et}){const tt=$.reduce((rt,nt)=>(Object.keys(nt.classNames).forEach(it=>{typeof rt[it]!="string"?rt[it]=`${nt.classNames[it]}`:rt[it]=`${rt[it]} ${nt.classNames[it]}`}),rt),{});return Object.keys(a).reduce((rt,nt)=>(rt[nt]=_(a[nt],tt[nt],j!=null&&j[nt],Array.isArray(_e)?_e.filter(Boolean).map(it=>`${et?.key||"mantine"}-${it}-${nt}`).join(" "):_e?`${et?.key||"mantine"}-${_e}-${nt}`:null),rt),{})}var __defProp$1i=Object.defineProperty,__getOwnPropSymbols$1i=Object.getOwnPropertySymbols,__hasOwnProp$1i=Object.prototype.hasOwnProperty,__propIsEnum$1i=Object.prototype.propertyIsEnumerable,__defNormalProp$1i=(_,a,$)=>a in _?__defProp$1i(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1i=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1i.call(a,$)&&__defNormalProp$1i(_,$,a[$]);if(__getOwnPropSymbols$1i)for(var $ of __getOwnPropSymbols$1i(a))__propIsEnum$1i.call(a,$)&&__defNormalProp$1i(_,$,a[$]);return _};function createRef(_){return`__mantine-ref-${_||""}`}function getStyles(_,a,$){const j=_e=>typeof _e=="function"?_e(a,$||{}):_e||{};return Array.isArray(_)?_.map(_e=>j(_e.styles)).reduce((_e,et)=>(Object.keys(et).forEach(tt=>{_e[tt]?_e[tt]=__spreadValues$1i(__spreadValues$1i({},_e[tt]),et[tt]):_e[tt]=__spreadValues$1i({},et[tt])}),_e),{}):j(_)}function createStyles(_){const a=typeof _=="function"?_:()=>_;function $(j,_e){const et=useMantineTheme(),tt=useMantineProviderStyles(_e?.name),rt=useMantineEmotionCache(),{css:nt,cx:it}=useCss(),st=a(et,j,createRef),ot=getStyles(_e?.styles,et,j),at=getStyles(tt,et,j),lt=Object.fromEntries(Object.keys(st).map(ct=>{const ut=it({[nt(st[ct])]:!_e?.unstyled},nt(at[ct]),nt(ot[ct]));return[ct,ut]}));return{classes:mergeClassNames({cx:it,classes:lt,context:tt,classNames:_e?.classNames,name:_e?.name,cache:rt}),cx:it,theme:et}}return $}function Global({styles:_}){const a=useMantineTheme();return jsx(Global$1,{styles:css(typeof _=="function"?_(a):_)})}var __defProp$1h=Object.defineProperty,__defProps$C=Object.defineProperties,__getOwnPropDescs$C=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$1h=Object.getOwnPropertySymbols,__hasOwnProp$1h=Object.prototype.hasOwnProperty,__propIsEnum$1h=Object.prototype.propertyIsEnumerable,__defNormalProp$1h=(_,a,$)=>a in _?__defProp$1h(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1h=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1h.call(a,$)&&__defNormalProp$1h(_,$,a[$]);if(__getOwnPropSymbols$1h)for(var $ of __getOwnPropSymbols$1h(a))__propIsEnum$1h.call(a,$)&&__defNormalProp$1h(_,$,a[$]);return _},__spreadProps$C=(_,a)=>__defProps$C(_,__getOwnPropDescs$C(a));const popIn={in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(.9) translateY(10px)"},transitionProperty:"transform, opacity"},transitions={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(-20px) skew(-10deg, -5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(20px) skew(-10deg, -5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(-5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:__spreadProps$C(__spreadValues$1h({},popIn),{common:{transformOrigin:"center center"}}),"pop-bottom-left":__spreadProps$C(__spreadValues$1h({},popIn),{common:{transformOrigin:"bottom left"}}),"pop-bottom-right":__spreadProps$C(__spreadValues$1h({},popIn),{common:{transformOrigin:"bottom right"}}),"pop-top-left":__spreadProps$C(__spreadValues$1h({},popIn),{common:{transformOrigin:"top left"}}),"pop-top-right":__spreadProps$C(__spreadValues$1h({},popIn),{common:{transformOrigin:"top right"}})};function attachMediaListener(_,a){try{return _.addEventListener("change",a),()=>_.removeEventListener("change",a)}catch{return _.addListener(a),()=>_.removeListener(a)}}function getInitialValue(_,a){return typeof a=="boolean"?a:typeof window<"u"&&"matchMedia"in window?window.matchMedia(_).matches:!1}function useMediaQuery(_,a,{getInitialValueInEffect:$}={getInitialValueInEffect:!0}){const[j,_e]=react.exports.useState($?!1:getInitialValue(_,a)),et=react.exports.useRef();return react.exports.useEffect(()=>{if("matchMedia"in window)return et.current=window.matchMedia(_),_e(et.current.matches),attachMediaListener(et.current,tt=>_e(tt.matches))},[_]),j}const useIsomorphicEffect=typeof document<"u"?react.exports.useLayoutEffect:react.exports.useEffect;function useDidUpdate(_,a){const $=react.exports.useRef(!1);react.exports.useEffect(()=>()=>{$.current=!1},[]),react.exports.useEffect(()=>{if($.current)return _();$.current=!0},a)}function useFocusReturn({opened:_,shouldReturnFocus:a=!0}){const $=react.exports.useRef(),j=()=>{var _e;$.current&&"focus"in $.current&&typeof $.current.focus=="function"&&((_e=$.current)==null||_e.focus({preventScroll:!0}))};return useDidUpdate(()=>{let _e=-1;const et=tt=>{tt.key==="Tab"&&window.clearTimeout(_e)};return document.addEventListener("keydown",et),_?$.current=document.activeElement:a&&(_e=window.setTimeout(j,10)),()=>{window.clearTimeout(_e),document.removeEventListener("keydown",et)}},[_,a]),j}const TABBABLE_NODES=/input|select|textarea|button|object/,FOCUS_SELECTOR="a, input, select, textarea, button, object, [tabindex]";function hidden(_){return _.style.display==="none"}function visible(_){if(_.getAttribute("aria-hidden")||_.getAttribute("hidden")||_.getAttribute("type")==="hidden")return!1;let $=_;for(;$&&$!==document.body;){if(hidden($))return!1;$=$.parentNode}return!0}function getElementTabIndex(_){let a=_.getAttribute("tabindex");return a===null&&(a=void 0),parseInt(a,10)}function focusable(_){const a=_.nodeName.toLowerCase(),$=!Number.isNaN(getElementTabIndex(_));return(TABBABLE_NODES.test(a)&&!_.disabled||_ instanceof HTMLAnchorElement&&_.href||$)&&visible(_)}function tabbable(_){const a=getElementTabIndex(_);return(Number.isNaN(a)||a>=0)&&focusable(_)}function findTabbableDescendants(_){return Array.from(_.querySelectorAll(FOCUS_SELECTOR)).filter(tabbable)}function scopeTab(_,a){const $=findTabbableDescendants(_);if(!$.length){a.preventDefault();return}if(!($[a.shiftKey?0:$.length-1]===document.activeElement||_===document.activeElement))return;a.preventDefault();const et=$[a.shiftKey?$.length-1:0];et&&et.focus()}function createAriaHider(_,a="body > :not(script)"){const $=Array.from(document.querySelectorAll(a)).map(j=>{if(j.contains(_))return;const _e=j.getAttribute("aria-hidden");return(_e===null||_e==="false")&&j.setAttribute("aria-hidden","true"),{node:j,ariaHidden:_e}});return()=>{$.forEach(j=>{!j||(j.ariaHidden===null?j.node.removeAttribute("aria-hidden"):j.node.setAttribute("aria-hidden",j.ariaHidden))})}}function useFocusTrap(_=!0){const a=react.exports.useRef(),$=react.exports.useRef(null),j=react.exports.useCallback(_e=>{if(!!_&&_e!==null&&($.current=createAriaHider(_e),a.current!==_e))if(_e){const et=()=>{let tt=_e.querySelector("[data-autofocus]");if(!tt){const rt=Array.from(_e.querySelectorAll(FOCUS_SELECTOR));tt=rt.find(tabbable)||rt.find(focusable)||null,!tt&&focusable(_e)&&(tt=_e)}tt&&tt.focus({preventScroll:!0})};setTimeout(()=>{_e.ownerDocument&&et()}),a.current=_e}else a.current=null},[_]);return react.exports.useEffect(()=>{if(!_)return;const _e=et=>{et.key==="Tab"&&a.current&&scopeTab(a.current,et)};return document.addEventListener("keydown",_e),()=>{document.removeEventListener("keydown",_e),$.current&&$.current()}},[_]),j}const randomId=()=>`mantine-${Math.random().toString(36).slice(2,11)}`,useReactId$1=React["useId".toString()]||(()=>{});function useClientId(){const[_,a]=react.exports.useState("");return useIsomorphicEffect(()=>{a(randomId())},[]),_}function getReactId(){const _=useReactId$1();return _?`mantine-${_.replace(/:/g,"")}`:""}function useId$1(_){return typeof _=="string"?_:getReactId()||useClientId()}function assignRef(_,a){typeof _=="function"?_(a):typeof _=="object"&&_!==null&&"current"in _&&(_.current=a)}function mergeRefs(..._){return a=>{_.forEach($=>assignRef($,a))}}function useMergedRef(..._){return react.exports.useCallback(mergeRefs(..._),_)}function useUncontrolled({value:_,defaultValue:a,finalValue:$,onChange:j=()=>{}}){const[_e,et]=react.exports.useState(a!==void 0?a:$),tt=rt=>{et(rt),j?.(rt)};return _!==void 0?[_,j,!0]:[_e,tt,!1]}function useReducedMotion(_,a){return useMediaQuery("(prefers-reduced-motion: reduce)",_,a)}function getScrollWidth(){if(typeof window>"u"||typeof document>"u")return 0;const _=parseInt(window.getComputedStyle(document.body).paddingRight,10),a=window.innerWidth-document.documentElement.clientWidth;return _+a}const getLockStyles=({disableBodyPadding:_})=>{const a=_?null:getScrollWidth();return`body {
        --removed-scroll-width: ${a}px;
        touch-action: none;
        overflow: hidden !important;
        position: relative !important;
        ${a?"padding-right: var(--removed-scroll-width) !important;":""}
        `};function injectStyles(_,a){_.styleSheet?_.styleSheet.cssText=a:_.appendChild(document.createTextNode(a))}function insertStyleTag(_){(document.head||document.getElementsByTagName("head")[0]).appendChild(_)}function makeStyleTag(){const _=document.createElement("style");return _.type="text/css",_.setAttribute("mantine-scroll-lock",""),_}function useScrollLock(_,a={disableBodyPadding:!1}){const[$,j]=react.exports.useState(_||!1),_e=react.exports.useRef(0),{disableBodyPadding:et}=a,tt=react.exports.useRef(null),rt=()=>{_e.current=window.scrollY;const it=getLockStyles({disableBodyPadding:et}),st=makeStyleTag();injectStyles(st,it),insertStyleTag(st),tt.current=st},nt=()=>{!tt?.current||(tt.current.parentNode.removeChild(tt.current),tt.current=null)};return react.exports.useEffect(()=>($?rt():nt(),nt),[$]),react.exports.useEffect(()=>{_!==void 0&&j(_)},[_]),react.exports.useEffect(()=>{_===void 0&&typeof window<"u"&&window.document.body.style.overflow==="hidden"&&j(!0)},[j]),[$,j]}function usePrevious$1(_){const a=react.exports.useRef();return react.exports.useEffect(()=>{a.current=_},[_]),a.current}const SYSTEM_PROPS={mt:"marginTop",mb:"marginBottom",ml:"marginLeft",mr:"marginRight",pt:"paddingTop",pb:"paddingBottom",pl:"paddingLeft",pr:"paddingRight"},NEGATIVE_VALUES=["-xs","-sm","-md","-lg","-xl"];function isValidSizeValue(_){return typeof _=="string"||typeof _=="number"}function getSizeValue(_,a){return NEGATIVE_VALUES.includes(_)?a.fn.size({size:_.replace("-",""),sizes:a.spacing})*-1:a.fn.size({size:_,sizes:a.spacing})}function getSystemStyles(_,a){const $={};if(isValidSizeValue(_.p)){const j=getSizeValue(_.p,a);$.padding=j}if(isValidSizeValue(_.m)){const j=getSizeValue(_.m,a);$.margin=j}if(isValidSizeValue(_.py)){const j=getSizeValue(_.py,a);$.paddingTop=j,$.paddingBottom=j}if(isValidSizeValue(_.px)){const j=getSizeValue(_.px,a);$.paddingLeft=j,$.paddingRight=j}if(isValidSizeValue(_.my)){const j=getSizeValue(_.my,a);$.marginTop=j,$.marginBottom=j}if(isValidSizeValue(_.mx)){const j=getSizeValue(_.mx,a);$.marginLeft=j,$.marginRight=j}return Object.keys(SYSTEM_PROPS).forEach(j=>{isValidSizeValue(_[j])&&($[SYSTEM_PROPS[j]]=a.fn.size({size:getSizeValue(_[j],a),sizes:a.spacing}))}),$}function extractSx(_,a){return typeof _=="function"?_(a):_}function useSx(_,a,$){const j=useMantineTheme(),{css:_e,cx:et}=useCss();return Array.isArray(_)?et($,_e(getSystemStyles(a,j)),_.map(tt=>_e(extractSx(tt,j)))):et($,_e(extractSx(_,j)),_e(getSystemStyles(a,j)))}var __defProp$1g=Object.defineProperty,__getOwnPropSymbols$1g=Object.getOwnPropertySymbols,__hasOwnProp$1g=Object.prototype.hasOwnProperty,__propIsEnum$1g=Object.prototype.propertyIsEnumerable,__defNormalProp$1g=(_,a,$)=>a in _?__defProp$1g(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1g=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1g.call(a,$)&&__defNormalProp$1g(_,$,a[$]);if(__getOwnPropSymbols$1g)for(var $ of __getOwnPropSymbols$1g(a))__propIsEnum$1g.call(a,$)&&__defNormalProp$1g(_,$,a[$]);return _},__objRest$Q=(_,a)=>{var $={};for(var j in _)__hasOwnProp$1g.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$1g)for(var j of __getOwnPropSymbols$1g(_))a.indexOf(j)<0&&__propIsEnum$1g.call(_,j)&&($[j]=_[j]);return $};const _Box=react.exports.forwardRef((_,a)=>{var $=_,{className:j,component:_e,style:et,sx:tt}=$,rt=__objRest$Q($,["className","component","style","sx"]);const{systemStyles:nt,rest:it}=extractSystemStyles(rt);return jsx(_e||"div",{...__spreadValues$1g({ref:a,className:useSx(tt,nt,j),style:et},it)})});_Box.displayName="@mantine/core/Box";const Box=_Box;var __defProp$1f=Object.defineProperty,__defProps$B=Object.defineProperties,__getOwnPropDescs$B=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$1f=Object.getOwnPropertySymbols,__hasOwnProp$1f=Object.prototype.hasOwnProperty,__propIsEnum$1f=Object.prototype.propertyIsEnumerable,__defNormalProp$1f=(_,a,$)=>a in _?__defProp$1f(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1f=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1f.call(a,$)&&__defNormalProp$1f(_,$,a[$]);if(__getOwnPropSymbols$1f)for(var $ of __getOwnPropSymbols$1f(a))__propIsEnum$1f.call(a,$)&&__defNormalProp$1f(_,$,a[$]);return _},__spreadProps$B=(_,a)=>__defProps$B(_,__getOwnPropDescs$B(a)),useStyles$1k=createStyles(_=>({root:__spreadProps$B(__spreadValues$1f(__spreadValues$1f({},_.fn.focusStyles()),_.fn.fontStyles()),{cursor:"pointer",border:0,padding:0,appearance:"none",fontSize:_.fontSizes.md,backgroundColor:"transparent",textAlign:"left",color:_.colorScheme==="dark"?_.colors.dark[0]:_.black,textDecoration:"none",boxSizing:"border-box"})}));const useStyles$1l=useStyles$1k;var __defProp$1e=Object.defineProperty,__getOwnPropSymbols$1e=Object.getOwnPropertySymbols,__hasOwnProp$1e=Object.prototype.hasOwnProperty,__propIsEnum$1e=Object.prototype.propertyIsEnumerable,__defNormalProp$1e=(_,a,$)=>a in _?__defProp$1e(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1e=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1e.call(a,$)&&__defNormalProp$1e(_,$,a[$]);if(__getOwnPropSymbols$1e)for(var $ of __getOwnPropSymbols$1e(a))__propIsEnum$1e.call(a,$)&&__defNormalProp$1e(_,$,a[$]);return _},__objRest$P=(_,a)=>{var $={};for(var j in _)__hasOwnProp$1e.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$1e)for(var j of __getOwnPropSymbols$1e(_))a.indexOf(j)<0&&__propIsEnum$1e.call(_,j)&&($[j]=_[j]);return $};const _UnstyledButton=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("UnstyledButton",{},_),{className:j,component:_e="button",unstyled:et}=$,tt=__objRest$P($,["className","component","unstyled"]),{classes:rt,cx:nt}=useStyles$1l(null,{name:"UnstyledButton",unstyled:et});return jsx(Box,{...__spreadValues$1e({component:_e,ref:a,className:nt(rt.root,j),type:_e==="button"?"button":void 0},tt)})});_UnstyledButton.displayName="@mantine/core/UnstyledButton";const UnstyledButton=_UnstyledButton;var __defProp$1d=Object.defineProperty,__defProps$A=Object.defineProperties,__getOwnPropDescs$A=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$1d=Object.getOwnPropertySymbols,__hasOwnProp$1d=Object.prototype.hasOwnProperty,__propIsEnum$1d=Object.prototype.propertyIsEnumerable,__defNormalProp$1d=(_,a,$)=>a in _?__defProp$1d(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1d=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1d.call(a,$)&&__defNormalProp$1d(_,$,a[$]);if(__getOwnPropSymbols$1d)for(var $ of __getOwnPropSymbols$1d(a))__propIsEnum$1d.call(a,$)&&__defNormalProp$1d(_,$,a[$]);return _},__spreadProps$A=(_,a)=>__defProps$A(_,__getOwnPropDescs$A(a));const sizes$7={xs:18,sm:22,md:28,lg:34,xl:44};function getVariantStyles$6({variant:_,theme:a,color:$,gradient:j}){const _e=a.fn.variant({color:$,variant:_,gradient:j});return _==="gradient"?{border:0,backgroundImage:_e.background,color:_e.color,"&:hover":a.fn.hover({backgroundSize:"200%"})}:__spreadValues$1d({border:`1px solid ${_e.border}`,backgroundColor:_e.background,color:_e.color},a.fn.hover({backgroundColor:_e.hover}))}var useStyles$1i=createStyles((_,{color:a,size:$,radius:j,variant:_e,gradient:et})=>({root:__spreadProps$A(__spreadValues$1d({},getVariantStyles$6({variant:_e,theme:_,color:a,gradient:et})),{position:"relative",height:_.fn.size({size:$,sizes:sizes$7}),minHeight:_.fn.size({size:$,sizes:sizes$7}),width:_.fn.size({size:$,sizes:sizes$7}),minWidth:_.fn.size({size:$,sizes:sizes$7}),borderRadius:_.fn.radius(j),padding:0,lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center","&:active":_.activeStyles,"&:disabled, &[data-disabled]":{color:_.colors.gray[_.colorScheme==="dark"?6:4],cursor:"not-allowed",backgroundColor:_e==="transparent"?void 0:_.fn.themeColor("gray",_.colorScheme==="dark"?8:1),borderColor:_e==="transparent"?void 0:_.fn.themeColor("gray",_.colorScheme==="dark"?8:1),backgroundImage:"none",pointerEvents:"none","&:active":{transform:"none"}},"&[data-loading]":{pointerEvents:"none","&::before":{content:'""',position:"absolute",top:-1,left:-1,right:-1,bottom:-1,backgroundColor:_.colorScheme==="dark"?_.fn.rgba(_.colors.dark[7],.5):"rgba(255, 255, 255, .5)",borderRadius:_.fn.radius(j),cursor:"not-allowed"}}})}));const useStyles$1j=useStyles$1i;var __defProp$1c=Object.defineProperty,__getOwnPropSymbols$1c=Object.getOwnPropertySymbols,__hasOwnProp$1c=Object.prototype.hasOwnProperty,__propIsEnum$1c=Object.prototype.propertyIsEnumerable,__defNormalProp$1c=(_,a,$)=>a in _?__defProp$1c(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1c=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1c.call(a,$)&&__defNormalProp$1c(_,$,a[$]);if(__getOwnPropSymbols$1c)for(var $ of __getOwnPropSymbols$1c(a))__propIsEnum$1c.call(a,$)&&__defNormalProp$1c(_,$,a[$]);return _},__objRest$O=(_,a)=>{var $={};for(var j in _)__hasOwnProp$1c.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$1c)for(var j of __getOwnPropSymbols$1c(_))a.indexOf(j)<0&&__propIsEnum$1c.call(_,j)&&($[j]=_[j]);return $};function Bars(_){var a=_,{size:$,color:j}=a,_e=__objRest$O(a,["size","color"]);return jsxs("svg",{...__spreadValues$1c({viewBox:"0 0 135 140",xmlns:"http://www.w3.org/2000/svg",fill:j,width:`${$}px`},_e),children:[jsxs("rect",{y:"10",width:"15",height:"120",rx:"6",children:[jsx("animate",{attributeName:"height",begin:"0.5s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),jsx("animate",{attributeName:"y",begin:"0.5s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})]}),jsxs("rect",{x:"30",y:"10",width:"15",height:"120",rx:"6",children:[jsx("animate",{attributeName:"height",begin:"0.25s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),jsx("animate",{attributeName:"y",begin:"0.25s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})]}),jsxs("rect",{x:"60",width:"15",height:"140",rx:"6",children:[jsx("animate",{attributeName:"height",begin:"0s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),jsx("animate",{attributeName:"y",begin:"0s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})]}),jsxs("rect",{x:"90",y:"10",width:"15",height:"120",rx:"6",children:[jsx("animate",{attributeName:"height",begin:"0.25s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),jsx("animate",{attributeName:"y",begin:"0.25s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})]}),jsxs("rect",{x:"120",y:"10",width:"15",height:"120",rx:"6",children:[jsx("animate",{attributeName:"height",begin:"0.5s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),jsx("animate",{attributeName:"y",begin:"0.5s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})]})]})}var __defProp$1b=Object.defineProperty,__getOwnPropSymbols$1b=Object.getOwnPropertySymbols,__hasOwnProp$1b=Object.prototype.hasOwnProperty,__propIsEnum$1b=Object.prototype.propertyIsEnumerable,__defNormalProp$1b=(_,a,$)=>a in _?__defProp$1b(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1b=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1b.call(a,$)&&__defNormalProp$1b(_,$,a[$]);if(__getOwnPropSymbols$1b)for(var $ of __getOwnPropSymbols$1b(a))__propIsEnum$1b.call(a,$)&&__defNormalProp$1b(_,$,a[$]);return _},__objRest$N=(_,a)=>{var $={};for(var j in _)__hasOwnProp$1b.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$1b)for(var j of __getOwnPropSymbols$1b(_))a.indexOf(j)<0&&__propIsEnum$1b.call(_,j)&&($[j]=_[j]);return $};function Oval(_){var a=_,{size:$,color:j}=a,_e=__objRest$N(a,["size","color"]);return jsx("svg",{...__spreadValues$1b({width:`${$}px`,height:`${$}px`,viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:j},_e),children:jsx("g",{fill:"none",fillRule:"evenodd",children:jsxs("g",{transform:"translate(2.5 2.5)",strokeWidth:"5",children:[jsx("circle",{strokeOpacity:".5",cx:"16",cy:"16",r:"16"}),jsx("path",{d:"M32 16c0-9.94-8.06-16-16-16",children:jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 16 16",to:"360 16 16",dur:"1s",repeatCount:"indefinite"})})]})})})}var __defProp$1a=Object.defineProperty,__getOwnPropSymbols$1a=Object.getOwnPropertySymbols,__hasOwnProp$1a=Object.prototype.hasOwnProperty,__propIsEnum$1a=Object.prototype.propertyIsEnumerable,__defNormalProp$1a=(_,a,$)=>a in _?__defProp$1a(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1a=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1a.call(a,$)&&__defNormalProp$1a(_,$,a[$]);if(__getOwnPropSymbols$1a)for(var $ of __getOwnPropSymbols$1a(a))__propIsEnum$1a.call(a,$)&&__defNormalProp$1a(_,$,a[$]);return _},__objRest$M=(_,a)=>{var $={};for(var j in _)__hasOwnProp$1a.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$1a)for(var j of __getOwnPropSymbols$1a(_))a.indexOf(j)<0&&__propIsEnum$1a.call(_,j)&&($[j]=_[j]);return $};function Dots(_){var a=_,{size:$,color:j}=a,_e=__objRest$M(a,["size","color"]);return jsxs("svg",{...__spreadValues$1a({width:`${$}px`,height:`${$/4}px`,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",fill:j},_e),children:[jsxs("circle",{cx:"15",cy:"15",r:"15",children:[jsx("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),jsx("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]}),jsxs("circle",{cx:"60",cy:"15",r:"9",fillOpacity:"0.3",children:[jsx("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),jsx("animate",{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})]}),jsxs("circle",{cx:"105",cy:"15",r:"15",children:[jsx("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),jsx("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]})]})}var __defProp$19=Object.defineProperty,__getOwnPropSymbols$19=Object.getOwnPropertySymbols,__hasOwnProp$19=Object.prototype.hasOwnProperty,__propIsEnum$19=Object.prototype.propertyIsEnumerable,__defNormalProp$19=(_,a,$)=>a in _?__defProp$19(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$19=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$19.call(a,$)&&__defNormalProp$19(_,$,a[$]);if(__getOwnPropSymbols$19)for(var $ of __getOwnPropSymbols$19(a))__propIsEnum$19.call(a,$)&&__defNormalProp$19(_,$,a[$]);return _},__objRest$L=(_,a)=>{var $={};for(var j in _)__hasOwnProp$19.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$19)for(var j of __getOwnPropSymbols$19(_))a.indexOf(j)<0&&__propIsEnum$19.call(_,j)&&($[j]=_[j]);return $};const LOADERS={bars:Bars,oval:Oval,dots:Dots},sizes$6={xs:18,sm:22,md:36,lg:44,xl:58},defaultProps$y={size:"md"};function Loader(_){const a=useComponentDefaultProps("Loader",defaultProps$y,_),{size:$,color:j,variant:_e}=a,et=__objRest$L(a,["size","color","variant"]),tt=useMantineTheme(),rt=_e in LOADERS?_e:tt.loader;return jsx(Box,{...__spreadValues$19({role:"presentation",component:LOADERS[rt]||LOADERS.bars,size:tt.fn.size({size:$,sizes:sizes$6}),color:tt.fn.variant({variant:"filled",primaryFallback:!1,color:j||tt.primaryColor}).background},et)})}Loader.displayName="@mantine/core/Loader";var __defProp$18=Object.defineProperty,__getOwnPropSymbols$18=Object.getOwnPropertySymbols,__hasOwnProp$18=Object.prototype.hasOwnProperty,__propIsEnum$18=Object.prototype.propertyIsEnumerable,__defNormalProp$18=(_,a,$)=>a in _?__defProp$18(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$18=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$18.call(a,$)&&__defNormalProp$18(_,$,a[$]);if(__getOwnPropSymbols$18)for(var $ of __getOwnPropSymbols$18(a))__propIsEnum$18.call(a,$)&&__defNormalProp$18(_,$,a[$]);return _},__objRest$K=(_,a)=>{var $={};for(var j in _)__hasOwnProp$18.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$18)for(var j of __getOwnPropSymbols$18(_))a.indexOf(j)<0&&__propIsEnum$18.call(_,j)&&($[j]=_[j]);return $};const defaultProps$x={color:"gray",size:"md",variant:"subtle",loading:!1},_ActionIcon=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("ActionIcon",defaultProps$x,_),{className:j,color:_e,children:et,radius:tt,size:rt,variant:nt,gradient:it,disabled:st,loaderProps:ot,loading:at,unstyled:lt}=$,ct=__objRest$K($,["className","color","children","radius","size","variant","gradient","disabled","loaderProps","loading","unstyled"]),{classes:ut,cx:dt,theme:ft}=useStyles$1j({size:rt,radius:tt,color:_e,variant:nt,gradient:it},{name:"ActionIcon",unstyled:lt}),pt=ft.fn.variant({color:_e,variant:nt}),yt=jsx(Loader,{...__spreadValues$18({color:pt.color,size:ft.fn.size({size:rt,sizes:sizes$7})-12},ot)});return jsx(UnstyledButton,{...__spreadValues$18({className:dt(ut.root,j),ref:a,disabled:st,"data-disabled":st||void 0,"data-loading":at||void 0,unstyled:lt},ct),children:at?yt:et})});_ActionIcon.displayName="@mantine/core/ActionIcon";const ActionIcon=_ActionIcon;function Portal(_){const{children:a,target:$,className:j}=useComponentDefaultProps("Portal",{},_),_e=useMantineTheme(),[et,tt]=react.exports.useState(!1),rt=react.exports.useRef();return useIsomorphicEffect(()=>(tt(!0),rt.current=$?typeof $=="string"?document.querySelector($):$:document.createElement("div"),$||document.body.appendChild(rt.current),()=>{!$&&document.body.removeChild(rt.current)}),[$]),et?reactDom.exports.createPortal(jsx("div",{className:j,dir:_e.dir,children:a}),rt.current):null}Portal.displayName="@mantine/core/Portal";var __defProp$17=Object.defineProperty,__getOwnPropSymbols$17=Object.getOwnPropertySymbols,__hasOwnProp$17=Object.prototype.hasOwnProperty,__propIsEnum$17=Object.prototype.propertyIsEnumerable,__defNormalProp$17=(_,a,$)=>a in _?__defProp$17(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$17=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$17.call(a,$)&&__defNormalProp$17(_,$,a[$]);if(__getOwnPropSymbols$17)for(var $ of __getOwnPropSymbols$17(a))__propIsEnum$17.call(a,$)&&__defNormalProp$17(_,$,a[$]);return _},__objRest$J=(_,a)=>{var $={};for(var j in _)__hasOwnProp$17.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$17)for(var j of __getOwnPropSymbols$17(_))a.indexOf(j)<0&&__propIsEnum$17.call(_,j)&&($[j]=_[j]);return $};function OptionalPortal(_){var a=_,{withinPortal:$=!0,children:j}=a,_e=__objRest$J(a,["withinPortal","children"]);return $?jsx(Portal,{...__spreadValues$17({},_e),children:j}):jsx(Fragment$1,{children:j})}OptionalPortal.displayName="@mantine/core/OptionalPortal";var __defProp$16=Object.defineProperty,__defProps$z=Object.defineProperties,__getOwnPropDescs$z=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$16=Object.getOwnPropertySymbols,__hasOwnProp$16=Object.prototype.hasOwnProperty,__propIsEnum$16=Object.prototype.propertyIsEnumerable,__defNormalProp$16=(_,a,$)=>a in _?__defProp$16(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$16=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$16.call(a,$)&&__defNormalProp$16(_,$,a[$]);if(__getOwnPropSymbols$16)for(var $ of __getOwnPropSymbols$16(a))__propIsEnum$16.call(a,$)&&__defNormalProp$16(_,$,a[$]);return _},__spreadProps$z=(_,a)=>__defProps$z(_,__getOwnPropDescs$z(a));function getVariantStyles$5({variant:_,color:a,theme:$}){if(_==="filled")return{backgroundColor:$.fn.variant({variant:"filled",color:a}).background,color:$.white};if(_==="outline"){const _e=$.fn.variant({variant:"outline",color:a});return{color:_e.color,borderColor:_e.border,backgroundColor:$.colorScheme==="dark"?$.colors.dark[6]:$.white}}const j=$.fn.variant({variant:"light",color:a});return{backgroundColor:j.background,color:j.color}}var useStyles$1g=createStyles((_,{color:a,radius:$,variant:j})=>({root:__spreadValues$16(__spreadProps$z(__spreadValues$16({},_.fn.fontStyles()),{position:"relative",overflow:"hidden",padding:`${_.spacing.sm}px ${_.spacing.md}px`,borderRadius:_.fn.radius($),border:"1px solid transparent"}),getVariantStyles$5({variant:j,color:a,theme:_})),wrapper:{display:"flex"},body:{flex:1},title:{boxSizing:"border-box",margin:0,marginBottom:7,display:"flex",alignItems:"center",justifyContent:"space-between",lineHeight:_.lineHeight,fontSize:_.fontSizes.sm,fontWeight:700,"&[data-with-close-button]":{paddingRight:_.spacing.md}},label:{display:"block",overflow:"hidden",textOverflow:"ellipsis"},icon:{lineHeight:1,width:20,height:20,display:"flex",alignItems:"center",justifyContent:"flex-start",marginRight:_.spacing.md,marginTop:1},message:__spreadProps$z(__spreadValues$16({},_.fn.fontStyles()),{lineHeight:_.lineHeight,textOverflow:"ellipsis",overflow:"hidden",fontSize:_.fontSizes.sm,color:j==="filled"?_.white:_.colorScheme==="dark"?j==="light"?_.white:_.colors.dark[0]:_.black}),closeButton:{position:"absolute",top:_.spacing.sm,right:_.spacing.sm,color:"inherit"}}));const useStyles$1h=useStyles$1g;var __defProp$15=Object.defineProperty,__getOwnPropSymbols$15=Object.getOwnPropertySymbols,__hasOwnProp$15=Object.prototype.hasOwnProperty,__propIsEnum$15=Object.prototype.propertyIsEnumerable,__defNormalProp$15=(_,a,$)=>a in _?__defProp$15(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$15=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$15.call(a,$)&&__defNormalProp$15(_,$,a[$]);if(__getOwnPropSymbols$15)for(var $ of __getOwnPropSymbols$15(a))__propIsEnum$15.call(a,$)&&__defNormalProp$15(_,$,a[$]);return _};function CloseIcon(_){return jsx("svg",{...__spreadValues$15({viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_),children:jsx("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}CloseIcon.displayName="@mantine/core/CloseIcon";var __defProp$14=Object.defineProperty,__getOwnPropSymbols$14=Object.getOwnPropertySymbols,__hasOwnProp$14=Object.prototype.hasOwnProperty,__propIsEnum$14=Object.prototype.propertyIsEnumerable,__defNormalProp$14=(_,a,$)=>a in _?__defProp$14(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$14=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$14.call(a,$)&&__defNormalProp$14(_,$,a[$]);if(__getOwnPropSymbols$14)for(var $ of __getOwnPropSymbols$14(a))__propIsEnum$14.call(a,$)&&__defNormalProp$14(_,$,a[$]);return _},__objRest$I=(_,a)=>{var $={};for(var j in _)__hasOwnProp$14.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$14)for(var j of __getOwnPropSymbols$14(_))a.indexOf(j)<0&&__propIsEnum$14.call(_,j)&&($[j]=_[j]);return $};const iconSizes={xs:12,sm:14,md:16,lg:20,xl:24},defaultProps$w={size:"md"},_CloseButton=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("CloseButton",defaultProps$w,_),{iconSize:j,size:_e="md"}=$,et=__objRest$I($,["iconSize","size"]),tt=useMantineTheme(),rt=j||tt.fn.size({size:_e,sizes:iconSizes});return jsx(ActionIcon,{...__spreadValues$14({size:_e,ref:a},et),children:jsx(CloseIcon,{width:rt,height:rt})})});_CloseButton.displayName="@mantine/core/CloseButton";const CloseButton=_CloseButton;var __defProp$13=Object.defineProperty,__getOwnPropSymbols$13=Object.getOwnPropertySymbols,__hasOwnProp$13=Object.prototype.hasOwnProperty,__propIsEnum$13=Object.prototype.propertyIsEnumerable,__defNormalProp$13=(_,a,$)=>a in _?__defProp$13(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$13=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$13.call(a,$)&&__defNormalProp$13(_,$,a[$]);if(__getOwnPropSymbols$13)for(var $ of __getOwnPropSymbols$13(a))__propIsEnum$13.call(a,$)&&__defNormalProp$13(_,$,a[$]);return _},__objRest$H=(_,a)=>{var $={};for(var j in _)__hasOwnProp$13.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$13)for(var j of __getOwnPropSymbols$13(_))a.indexOf(j)<0&&__propIsEnum$13.call(_,j)&&($[j]=_[j]);return $};const defaultProps$v={variant:"light"},Alert=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Alert",defaultProps$v,_),{id:j,className:_e,title:et,variant:tt,children:rt,color:nt,classNames:it,icon:st,styles:ot,onClose:at,radius:lt,withCloseButton:ct,closeButtonLabel:ut,unstyled:dt}=$,ft=__objRest$H($,["id","className","title","variant","children","color","classNames","icon","styles","onClose","radius","withCloseButton","closeButtonLabel","unstyled"]),{classes:pt,cx:yt}=useStyles$1h({color:nt,radius:lt,variant:tt},{classNames:it,styles:ot,unstyled:dt,name:"Alert"}),mt=useId$1(j),_t=et&&`${mt}-title`,vt=`${mt}-body`;return jsx(Box,{...__spreadValues$13({id:mt,role:"alert","aria-labelledby":_t,"aria-describedby":vt,className:yt(pt.root,pt[tt],_e),ref:a},ft),children:jsxs("div",{className:pt.wrapper,children:[st&&jsx("div",{className:pt.icon,children:st}),jsxs("div",{className:pt.body,children:[et&&jsx("div",{className:pt.title,"data-with-close-button":ct||void 0,children:jsx("span",{id:_t,className:pt.label,children:et})}),ct&&jsx(CloseButton,{className:pt.closeButton,onClick:at,variant:"transparent",size:16,iconSize:16,"aria-label":ut}),jsx("div",{id:vt,className:pt.message,children:rt})]})]})})});Alert.displayName="@mantine/core/Alert";var __defProp$12=Object.defineProperty,__defProps$y=Object.defineProperties,__getOwnPropDescs$y=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$12=Object.getOwnPropertySymbols,__hasOwnProp$12=Object.prototype.hasOwnProperty,__propIsEnum$12=Object.prototype.propertyIsEnumerable,__defNormalProp$12=(_,a,$)=>a in _?__defProp$12(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$12=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$12.call(a,$)&&__defNormalProp$12(_,$,a[$]);if(__getOwnPropSymbols$12)for(var $ of __getOwnPropSymbols$12(a))__propIsEnum$12.call(a,$)&&__defNormalProp$12(_,$,a[$]);return _},__spreadProps$y=(_,a)=>__defProps$y(_,__getOwnPropDescs$y(a));function getTextDecoration({underline:_,strikethrough:a}){const $=[];return _&&$.push("underline"),a&&$.push("line-through"),$.length>0?$.join(" "):"none"}function getTextColor({theme:_,color:a,variant:$}){return a==="dimmed"?_.colorScheme==="dark"?_.colors.dark[2]:_.colors.gray[6]:typeof a=="string"&&(a in _.colors||a.split(".")[0]in _.colors)?_.fn.variant({variant:"filled",color:a}).background:$==="link"?_.colors[_.primaryColor][_.colorScheme==="dark"?4:7]:a||"inherit"}function getLineClamp(_){return typeof _=="number"?{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:_,WebkitBoxOrient:"vertical"}:null}var useStyles$1e=createStyles((_,{color:a,variant:$,size:j,lineClamp:_e,inline:et,inherit:tt,underline:rt,gradient:nt,weight:it,transform:st,align:ot,strikethrough:at,italic:lt})=>{const ct=_.fn.variant({variant:"gradient",gradient:nt});return{root:__spreadValues$12(__spreadProps$y(__spreadValues$12(__spreadValues$12(__spreadValues$12({},_.fn.fontStyles()),_.fn.focusStyles()),getLineClamp(_e)),{color:getTextColor({color:a,theme:_,variant:$}),fontFamily:tt?"inherit":_.fontFamily,fontSize:tt||j===void 0?"inherit":_.fn.size({size:j,sizes:_.fontSizes}),lineHeight:tt?"inherit":et?1:_.lineHeight,textDecoration:getTextDecoration({underline:rt,strikethrough:at}),WebkitTapHighlightColor:"transparent",fontWeight:tt?"inherit":it,textTransform:st,textAlign:ot,fontStyle:lt?"italic":void 0}),_.fn.hover($==="link"&&rt===void 0?{textDecoration:"underline"}:void 0)),gradient:{backgroundImage:ct.background,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}}});const useStyles$1f=useStyles$1e;var __defProp$11=Object.defineProperty,__getOwnPropSymbols$11=Object.getOwnPropertySymbols,__hasOwnProp$11=Object.prototype.hasOwnProperty,__propIsEnum$11=Object.prototype.propertyIsEnumerable,__defNormalProp$11=(_,a,$)=>a in _?__defProp$11(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$11=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$11.call(a,$)&&__defNormalProp$11(_,$,a[$]);if(__getOwnPropSymbols$11)for(var $ of __getOwnPropSymbols$11(a))__propIsEnum$11.call(a,$)&&__defNormalProp$11(_,$,a[$]);return _},__objRest$G=(_,a)=>{var $={};for(var j in _)__hasOwnProp$11.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$11)for(var j of __getOwnPropSymbols$11(_))a.indexOf(j)<0&&__propIsEnum$11.call(_,j)&&($[j]=_[j]);return $};const defaultProps$u={variant:"text"},_Text=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Text",defaultProps$u,_),{className:j,size:_e,weight:et,transform:tt,color:rt,align:nt,variant:it,lineClamp:st,gradient:ot,inline:at,inherit:lt,underline:ct,strikethrough:ut,italic:dt,classNames:ft,styles:pt,unstyled:yt,span:mt}=$,_t=__objRest$G($,["className","size","weight","transform","color","align","variant","lineClamp","gradient","inline","inherit","underline","strikethrough","italic","classNames","styles","unstyled","span"]),{classes:vt,cx:ht}=useStyles$1f({variant:it,color:rt,size:_e,lineClamp:st,inline:at,inherit:lt,underline:ct,strikethrough:ut,italic:dt,weight:et,transform:tt,align:nt,gradient:ot},{unstyled:yt,name:"Text"});return jsx(Box,{...__spreadValues$11({ref:a,className:ht(vt.root,{[vt.gradient]:it==="gradient"},j),component:mt?"span":"div"},_t)})});_Text.displayName="@mantine/core/Text";const Text=_Text,AppShellContext=react.exports.createContext({}),AppShellProvider=AppShellContext.Provider;function useAppShellContext(){return react.exports.useContext(AppShellContext)}var __defProp$10=Object.defineProperty,__defProps$x=Object.defineProperties,__getOwnPropDescs$x=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$10=Object.getOwnPropertySymbols,__hasOwnProp$10=Object.prototype.hasOwnProperty,__propIsEnum$10=Object.prototype.propertyIsEnumerable,__defNormalProp$10=(_,a,$)=>a in _?__defProp$10(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$10=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$10.call(a,$)&&__defNormalProp$10(_,$,a[$]);if(__getOwnPropSymbols$10)for(var $ of __getOwnPropSymbols$10(a))__propIsEnum$10.call(a,$)&&__defNormalProp$10(_,$,a[$]);return _},__spreadProps$x=(_,a)=>__defProps$x(_,__getOwnPropDescs$x(a)),useStyles$1c=createStyles((_,{height:a,fixed:$,position:j,zIndex:_e,borderPosition:et})=>({root:__spreadProps$x(__spreadValues$10(__spreadValues$10({},_.fn.fontStyles()),j),{zIndex:_e,height:a,maxHeight:a,position:$?"fixed":"static",boxSizing:"border-box",backgroundColor:_.colorScheme==="dark"?_.colors.dark[7]:_.white,borderBottom:et==="bottom"?`1px solid ${_.colorScheme==="dark"?_.colors.dark[5]:_.colors.gray[2]}`:void 0,borderTop:et==="top"?`1px solid ${_.colorScheme==="dark"?_.colors.dark[5]:_.colors.gray[2]}`:void 0})}));const useStyles$1d=useStyles$1c;var __defProp$$=Object.defineProperty,__getOwnPropSymbols$$=Object.getOwnPropertySymbols,__hasOwnProp$$=Object.prototype.hasOwnProperty,__propIsEnum$$=Object.prototype.propertyIsEnumerable,__defNormalProp$$=(_,a,$)=>a in _?__defProp$$(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$$=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$$.call(a,$)&&__defNormalProp$$(_,$,a[$]);if(__getOwnPropSymbols$$)for(var $ of __getOwnPropSymbols$$(a))__propIsEnum$$.call(a,$)&&__defNormalProp$$(_,$,a[$]);return _},__objRest$F=(_,a)=>{var $={};for(var j in _)__hasOwnProp$$.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$$)for(var j of __getOwnPropSymbols$$(_))a.indexOf(j)<0&&__propIsEnum$$.call(_,j)&&($[j]=_[j]);return $};const VerticalSection=react.exports.forwardRef((_,a)=>{var $=_,{children:j,className:_e,classNames:et,styles:tt,height:rt,fixed:nt=!1,withBorder:it=!0,position:st,zIndex:ot=getDefaultZIndex("app"),section:at,unstyled:lt,__staticSelector:ct}=$,ut=__objRest$F($,["children","className","classNames","styles","height","fixed","withBorder","position","zIndex","section","unstyled","__staticSelector"]);const dt=useAppShellContext(),{classes:ft,cx:pt}=useStyles$1d({height:rt,fixed:dt.fixed||nt,position:st,zIndex:dt.zIndex||ot,borderPosition:it?at==="header"?"bottom":"top":"none"},{name:ct,classNames:et,styles:tt,unstyled:lt});return jsxs(Box,{...__spreadValues$$({component:at==="header"?"header":"footer",className:pt(ft.root,_e),ref:a},ut),children:[j,jsx(Global,{styles:()=>({":root":{[`--mantine-${at}-height`]:`${rt}px`}})})]})});VerticalSection.displayName="@mantine/core/VerticalSection";var __defProp$_=Object.defineProperty,__defProps$w=Object.defineProperties,__getOwnPropDescs$w=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$_=Object.getOwnPropertySymbols,__hasOwnProp$_=Object.prototype.hasOwnProperty,__propIsEnum$_=Object.prototype.propertyIsEnumerable,__defNormalProp$_=(_,a,$)=>a in _?__defProp$_(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$_=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$_.call(a,$)&&__defNormalProp$_(_,$,a[$]);if(__getOwnPropSymbols$_)for(var $ of __getOwnPropSymbols$_(a))__propIsEnum$_.call(a,$)&&__defNormalProp$_(_,$,a[$]);return _},__spreadProps$w=(_,a)=>__defProps$w(_,__getOwnPropDescs$w(a));const defaultProps$t={fixed:!1,position:{top:0,left:0,right:0},zIndex:getDefaultZIndex("app")},Header=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Header",defaultProps$t,_);return jsx(VerticalSection,{...__spreadProps$w(__spreadValues$_({section:"header",__staticSelector:"Header"},$),{ref:a})})});Header.displayName="@mantine/core/Header";var __defProp$Z=Object.defineProperty,__getOwnPropSymbols$Z=Object.getOwnPropertySymbols,__hasOwnProp$Z=Object.prototype.hasOwnProperty,__propIsEnum$Z=Object.prototype.propertyIsEnumerable,__defNormalProp$Z=(_,a,$)=>a in _?__defProp$Z(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$Z=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$Z.call(a,$)&&__defNormalProp$Z(_,$,a[$]);if(__getOwnPropSymbols$Z)for(var $ of __getOwnPropSymbols$Z(a))__propIsEnum$Z.call(a,$)&&__defNormalProp$Z(_,$,a[$]);return _};function getPositionStyles$1(_,a){const $=a.fn.size({size:_.padding,sizes:a.spacing}),j=_.navbarOffsetBreakpoint?a.fn.size({size:_.navbarOffsetBreakpoint,sizes:a.breakpoints}):null,_e=_.asideOffsetBreakpoint?a.fn.size({size:_.asideOffsetBreakpoint,sizes:a.breakpoints}):null;return _.fixed?{minHeight:"100vh",paddingTop:`calc(var(--mantine-header-height, 0px) + ${$}px)`,paddingBottom:`calc(var(--mantine-footer-height, 0px) + ${$}px)`,paddingLeft:`calc(var(--mantine-navbar-width, 0px) + ${$}px)`,paddingRight:`calc(var(--mantine-aside-width, 0px) + ${$}px)`,[`@media (max-width: ${j-1}px)`]:{paddingLeft:$},[`@media (max-width: ${_e-1}px)`]:{paddingRight:$}}:{padding:$}}var useStyles$1a=createStyles((_,a)=>({root:{boxSizing:"border-box"},body:{display:"flex",boxSizing:"border-box"},main:__spreadValues$Z({flex:1,width:"100vw",boxSizing:"border-box"},getPositionStyles$1(a,_))}));const useStyles$1b=useStyles$1a;var __defProp$Y=Object.defineProperty,__getOwnPropSymbols$Y=Object.getOwnPropertySymbols,__hasOwnProp$Y=Object.prototype.hasOwnProperty,__propIsEnum$Y=Object.prototype.propertyIsEnumerable,__defNormalProp$Y=(_,a,$)=>a in _?__defProp$Y(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$Y=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$Y.call(a,$)&&__defNormalProp$Y(_,$,a[$]);if(__getOwnPropSymbols$Y)for(var $ of __getOwnPropSymbols$Y(a))__propIsEnum$Y.call(a,$)&&__defNormalProp$Y(_,$,a[$]);return _},__objRest$E=(_,a)=>{var $={};for(var j in _)__hasOwnProp$Y.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$Y)for(var j of __getOwnPropSymbols$Y(_))a.indexOf(j)<0&&__propIsEnum$Y.call(_,j)&&($[j]=_[j]);return $};const defaultProps$s={fixed:!0,zIndex:getDefaultZIndex("app"),padding:"md"},AppShell=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("AppShell",defaultProps$s,_),{children:j,navbar:_e,header:et,footer:tt,aside:rt,fixed:nt,zIndex:it,padding:st,navbarOffsetBreakpoint:ot,asideOffsetBreakpoint:at,className:lt,styles:ct,classNames:ut,unstyled:dt,hidden:ft}=$,pt=__objRest$E($,["children","navbar","header","footer","aside","fixed","zIndex","padding","navbarOffsetBreakpoint","asideOffsetBreakpoint","className","styles","classNames","unstyled","hidden"]),{classes:yt,cx:mt}=useStyles$1b({padding:st,fixed:nt,navbarOffsetBreakpoint:ot,asideOffsetBreakpoint:at},{styles:ct,classNames:ut,unstyled:dt,name:"AppShell"});return ft?jsx(Fragment$1,{children:j}):jsx(AppShellProvider,{value:{fixed:nt,zIndex:it},children:jsxs(Box,{...__spreadValues$Y({className:mt(yt.root,lt),ref:a},pt),children:[et,jsxs("div",{className:yt.body,children:[_e,jsx("main",{className:yt.main,children:j}),rt]}),tt]})})});AppShell.displayName="@mantine/core/AppShell";function getSide(_){return _.split("-")[0]}function getAlignment(_){return _.split("-")[1]}function getMainAxisFromPlacement(_){return["top","bottom"].includes(getSide(_))?"x":"y"}function getLengthFromAxis(_){return _==="y"?"height":"width"}function computeCoordsFromPlacement(_,a,$){let{reference:j,floating:_e}=_;const et=j.x+j.width/2-_e.width/2,tt=j.y+j.height/2-_e.height/2,rt=getMainAxisFromPlacement(a),nt=getLengthFromAxis(rt),it=j[nt]/2-_e[nt]/2,st=getSide(a),ot=rt==="x";let at;switch(st){case"top":at={x:et,y:j.y-_e.height};break;case"bottom":at={x:et,y:j.y+j.height};break;case"right":at={x:j.x+j.width,y:tt};break;case"left":at={x:j.x-_e.width,y:tt};break;default:at={x:j.x,y:j.y}}switch(getAlignment(a)){case"start":at[rt]-=it*($&&ot?-1:1);break;case"end":at[rt]+=it*($&&ot?-1:1);break}return at}const computePosition$1=async(_,a,$)=>{const{placement:j="bottom",strategy:_e="absolute",middleware:et=[],platform:tt}=$,rt=await(tt.isRTL==null?void 0:tt.isRTL(a));let nt=await tt.getElementRects({reference:_,floating:a,strategy:_e}),{x:it,y:st}=computeCoordsFromPlacement(nt,j,rt),ot=j,at={},lt=0;for(let ct=0;ct<et.length;ct++){const{name:ut,fn:dt}=et[ct],{x:ft,y:pt,data:yt,reset:mt}=await dt({x:it,y:st,initialPlacement:j,placement:ot,strategy:_e,middlewareData:at,rects:nt,platform:tt,elements:{reference:_,floating:a}});if(it=ft??it,st=pt??st,at={...at,[ut]:{...at[ut],...yt}},mt&&lt<=50){lt++,typeof mt=="object"&&(mt.placement&&(ot=mt.placement),mt.rects&&(nt=mt.rects===!0?await tt.getElementRects({reference:_,floating:a,strategy:_e}):mt.rects),{x:it,y:st}=computeCoordsFromPlacement(nt,ot,rt)),ct=-1;continue}}return{x:it,y:st,placement:ot,strategy:_e,middlewareData:at}};function expandPaddingObject(_){return{top:0,right:0,bottom:0,left:0,..._}}function getSideObjectFromPadding(_){return typeof _!="number"?expandPaddingObject(_):{top:_,right:_,bottom:_,left:_}}function rectToClientRect(_){return{..._,top:_.y,left:_.x,right:_.x+_.width,bottom:_.y+_.height}}async function detectOverflow(_,a){var $;a===void 0&&(a={});const{x:j,y:_e,platform:et,rects:tt,elements:rt,strategy:nt}=_,{boundary:it="clippingAncestors",rootBoundary:st="viewport",elementContext:ot="floating",altBoundary:at=!1,padding:lt=0}=a,ct=getSideObjectFromPadding(lt),dt=rt[at?ot==="floating"?"reference":"floating":ot],ft=rectToClientRect(await et.getClippingRect({element:($=await(et.isElement==null?void 0:et.isElement(dt)))==null||$?dt:dt.contextElement||await(et.getDocumentElement==null?void 0:et.getDocumentElement(rt.floating)),boundary:it,rootBoundary:st,strategy:nt})),pt=rectToClientRect(et.convertOffsetParentRelativeRectToViewportRelativeRect?await et.convertOffsetParentRelativeRectToViewportRelativeRect({rect:ot==="floating"?{...tt.floating,x:j,y:_e}:tt.reference,offsetParent:await(et.getOffsetParent==null?void 0:et.getOffsetParent(rt.floating)),strategy:nt}):tt[ot]);return{top:ft.top-pt.top+ct.top,bottom:pt.bottom-ft.bottom+ct.bottom,left:ft.left-pt.left+ct.left,right:pt.right-ft.right+ct.right}}const min$1=Math.min,max$1=Math.max;function within(_,a,$){return max$1(_,min$1(a,$))}const arrow$1=_=>({name:"arrow",options:_,async fn(a){const{element:$,padding:j=0}=_??{},{x:_e,y:et,placement:tt,rects:rt,platform:nt}=a;if($==null)return{};const it=getSideObjectFromPadding(j),st={x:_e,y:et},ot=getMainAxisFromPlacement(tt),at=getAlignment(tt),lt=getLengthFromAxis(ot),ct=await nt.getDimensions($),ut=ot==="y"?"top":"left",dt=ot==="y"?"bottom":"right",ft=rt.reference[lt]+rt.reference[ot]-st[ot]-rt.floating[lt],pt=st[ot]-rt.reference[ot],yt=await(nt.getOffsetParent==null?void 0:nt.getOffsetParent($));let mt=yt?ot==="y"?yt.clientHeight||0:yt.clientWidth||0:0;mt===0&&(mt=rt.floating[lt]);const _t=ft/2-pt/2,vt=it[ut],ht=mt-ct[lt]-it[dt],St=mt/2-ct[lt]/2+_t,It=within(vt,St,ht),Kt=(at==="start"?it[ut]:it[dt])>0&&St!==It&&rt.reference[lt]<=rt.floating[lt]?St<vt?vt-St:ht-St:0;return{[ot]:st[ot]-Kt,data:{[ot]:It,centerOffset:St-It}}}}),hash$1$1={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(_){return _.replace(/left|right|bottom|top/g,a=>hash$1$1[a])}function getAlignmentSides(_,a,$){$===void 0&&($=!1);const j=getAlignment(_),_e=getMainAxisFromPlacement(_),et=getLengthFromAxis(_e);let tt=_e==="x"?j===($?"end":"start")?"right":"left":j==="start"?"bottom":"top";return a.reference[et]>a.floating[et]&&(tt=getOppositePlacement(tt)),{main:tt,cross:getOppositePlacement(tt)}}const hash$5={start:"end",end:"start"};function getOppositeAlignmentPlacement(_){return _.replace(/start|end/g,a=>hash$5[a])}function getExpandedPlacements(_){const a=getOppositePlacement(_);return[getOppositeAlignmentPlacement(_),a,getOppositeAlignmentPlacement(a)]}const flip=function(_){return _===void 0&&(_={}),{name:"flip",options:_,async fn(a){var $;const{placement:j,middlewareData:_e,rects:et,initialPlacement:tt,platform:rt,elements:nt}=a,{mainAxis:it=!0,crossAxis:st=!0,fallbackPlacements:ot,fallbackStrategy:at="bestFit",flipAlignment:lt=!0,...ct}=_,ut=getSide(j),ft=ot||(ut===tt||!lt?[getOppositePlacement(tt)]:getExpandedPlacements(tt)),pt=[tt,...ft],yt=await detectOverflow(a,ct),mt=[];let _t=(($=_e.flip)==null?void 0:$.overflows)||[];if(it&&mt.push(yt[ut]),st){const{main:It,cross:Lt}=getAlignmentSides(j,et,await(rt.isRTL==null?void 0:rt.isRTL(nt.floating)));mt.push(yt[It],yt[Lt])}if(_t=[..._t,{placement:j,overflows:mt}],!mt.every(It=>It<=0)){var vt,ht;const It=((vt=(ht=_e.flip)==null?void 0:ht.index)!=null?vt:0)+1,Lt=pt[It];if(Lt)return{data:{index:It,overflows:_t},reset:{placement:Lt}};let Mt="bottom";switch(at){case"bestFit":{var St;const Kt=(St=_t.map(kt=>[kt,kt.overflows.filter(gt=>gt>0).reduce((gt,Et)=>gt+Et,0)]).sort((kt,gt)=>kt[1]-gt[1])[0])==null?void 0:St[0].placement;Kt&&(Mt=Kt);break}case"initialPlacement":Mt=tt;break}if(j!==Mt)return{reset:{placement:Mt}}}return{}}}};async function convertValueToCoords(_,a){const{placement:$,platform:j,elements:_e}=_,et=await(j.isRTL==null?void 0:j.isRTL(_e.floating)),tt=getSide($),rt=getAlignment($),nt=getMainAxisFromPlacement($)==="x",it=["left","top"].includes(tt)?-1:1,st=et&&nt?-1:1,ot=typeof a=="function"?a(_):a;let{mainAxis:at,crossAxis:lt,alignmentAxis:ct}=typeof ot=="number"?{mainAxis:ot,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...ot};return rt&&typeof ct=="number"&&(lt=rt==="end"?ct*-1:ct),nt?{x:lt*st,y:at*it}:{x:at*it,y:lt*st}}const offset=function(_){return _===void 0&&(_=0),{name:"offset",options:_,async fn(a){const{x:$,y:j}=a,_e=await convertValueToCoords(a,_);return{x:$+_e.x,y:j+_e.y,data:_e}}}};function getCrossAxis(_){return _==="x"?"y":"x"}const shift=function(_){return _===void 0&&(_={}),{name:"shift",options:_,async fn(a){const{x:$,y:j,placement:_e}=a,{mainAxis:et=!0,crossAxis:tt=!1,limiter:rt={fn:dt=>{let{x:ft,y:pt}=dt;return{x:ft,y:pt}}},...nt}=_,it={x:$,y:j},st=await detectOverflow(a,nt),ot=getMainAxisFromPlacement(getSide(_e)),at=getCrossAxis(ot);let lt=it[ot],ct=it[at];if(et){const dt=ot==="y"?"top":"left",ft=ot==="y"?"bottom":"right",pt=lt+st[dt],yt=lt-st[ft];lt=within(pt,lt,yt)}if(tt){const dt=at==="y"?"top":"left",ft=at==="y"?"bottom":"right",pt=ct+st[dt],yt=ct-st[ft];ct=within(pt,ct,yt)}const ut=rt.fn({...a,[ot]:lt,[at]:ct});return{...ut,data:{x:ut.x-$,y:ut.y-j}}}}},inline=function(_){return _===void 0&&(_={}),{name:"inline",options:_,async fn(a){var $;const{placement:j,elements:_e,rects:et,platform:tt,strategy:rt}=a,{padding:nt=2,x:it,y:st}=_,ot=rectToClientRect(tt.convertOffsetParentRelativeRectToViewportRelativeRect?await tt.convertOffsetParentRelativeRectToViewportRelativeRect({rect:et.reference,offsetParent:await(tt.getOffsetParent==null?void 0:tt.getOffsetParent(_e.floating)),strategy:rt}):et.reference),at=($=await(tt.getClientRects==null?void 0:tt.getClientRects(_e.reference)))!=null?$:[],lt=getSideObjectFromPadding(nt);function ct(){if(at.length===2&&at[0].left>at[1].right&&it!=null&&st!=null){var dt;return(dt=at.find(ft=>it>ft.left-lt.left&&it<ft.right+lt.right&&st>ft.top-lt.top&&st<ft.bottom+lt.bottom))!=null?dt:ot}if(at.length>=2){if(getMainAxisFromPlacement(j)==="x"){const Mt=at[0],Kt=at[at.length-1],kt=getSide(j)==="top",gt=Mt.top,Et=Kt.bottom,xt=kt?Mt.left:Kt.left,Tt=kt?Mt.right:Kt.right,At=Tt-xt,Nt=Et-gt;return{top:gt,bottom:Et,left:xt,right:Tt,width:At,height:Nt,x:xt,y:gt}}const ft=getSide(j)==="left",pt=max$1(...at.map(Mt=>Mt.right)),yt=min$1(...at.map(Mt=>Mt.left)),mt=at.filter(Mt=>ft?Mt.left===yt:Mt.right===pt),_t=mt[0].top,vt=mt[mt.length-1].bottom,ht=yt,St=pt,It=St-ht,Lt=vt-_t;return{top:_t,bottom:vt,left:ht,right:St,width:It,height:Lt,x:ht,y:_t}}return ot}const ut=await tt.getElementRects({reference:{getBoundingClientRect:ct},floating:_e.floating,strategy:rt});return et.reference.x!==ut.reference.x||et.reference.y!==ut.reference.y||et.reference.width!==ut.reference.width||et.reference.height!==ut.reference.height?{reset:{rects:ut}}:{}}}};function isWindow(_){return _&&_.document&&_.location&&_.alert&&_.setInterval}function getWindow$1(_){if(_==null)return window;if(!isWindow(_)){const a=_.ownerDocument;return a&&a.defaultView||window}return _}function getComputedStyle(_){return getWindow$1(_).getComputedStyle(_)}function getNodeName(_){return isWindow(_)?"":_?(_.nodeName||"").toLowerCase():""}function getUAString(){const _=navigator.userAgentData;return _!=null&&_.brands?_.brands.map(a=>a.brand+"/"+a.version).join(" "):navigator.userAgent}function isHTMLElement$1(_){return _ instanceof getWindow$1(_).HTMLElement}function isElement$1(_){return _ instanceof getWindow$1(_).Element}function isNode$1(_){return _ instanceof getWindow$1(_).Node}function isShadowRoot(_){if(typeof ShadowRoot>"u")return!1;const a=getWindow$1(_).ShadowRoot;return _ instanceof a||_ instanceof ShadowRoot}function isOverflowElement(_){const{overflow:a,overflowX:$,overflowY:j,display:_e}=getComputedStyle(_);return/auto|scroll|overlay|hidden/.test(a+j+$)&&!["inline","contents"].includes(_e)}function isTableElement(_){return["table","td","th"].includes(getNodeName(_))}function isContainingBlock(_){const a=/firefox/i.test(getUAString()),$=getComputedStyle(_);return $.transform!=="none"||$.perspective!=="none"||a&&$.willChange==="filter"||a&&($.filter?$.filter!=="none":!1)||["transform","perspective"].some(j=>$.willChange.includes(j))||["paint","layout","strict","content"].some(j=>{const _e=$.contain;return _e!=null?_e.includes(j):!1})}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function isLastTraversableNode(_){return["html","body","#document"].includes(getNodeName(_))}const min=Math.min,max=Math.max,round=Math.round;function getBoundingClientRect(_,a,$){var j,_e,et,tt;a===void 0&&(a=!1),$===void 0&&($=!1);const rt=_.getBoundingClientRect();let nt=1,it=1;a&&isHTMLElement$1(_)&&(nt=_.offsetWidth>0&&round(rt.width)/_.offsetWidth||1,it=_.offsetHeight>0&&round(rt.height)/_.offsetHeight||1);const st=isElement$1(_)?getWindow$1(_):window,ot=!isLayoutViewport()&&$,at=(rt.left+(ot&&(j=(_e=st.visualViewport)==null?void 0:_e.offsetLeft)!=null?j:0))/nt,lt=(rt.top+(ot&&(et=(tt=st.visualViewport)==null?void 0:tt.offsetTop)!=null?et:0))/it,ct=rt.width/nt,ut=rt.height/it;return{width:ct,height:ut,top:lt,right:at+ct,bottom:lt+ut,left:at,x:at,y:lt}}function getDocumentElement(_){return((isNode$1(_)?_.ownerDocument:_.document)||window.document).documentElement}function getNodeScroll(_){return isElement$1(_)?{scrollLeft:_.scrollLeft,scrollTop:_.scrollTop}:{scrollLeft:_.pageXOffset,scrollTop:_.pageYOffset}}function getWindowScrollBarX(_){return getBoundingClientRect(getDocumentElement(_)).left+getNodeScroll(_).scrollLeft}function isScaled(_){const a=getBoundingClientRect(_);return round(a.width)!==_.offsetWidth||round(a.height)!==_.offsetHeight}function getRectRelativeToOffsetParent(_,a,$){const j=isHTMLElement$1(a),_e=getDocumentElement(a),et=getBoundingClientRect(_,j&&isScaled(a),$==="fixed");let tt={scrollLeft:0,scrollTop:0};const rt={x:0,y:0};if(j||!j&&$!=="fixed")if((getNodeName(a)!=="body"||isOverflowElement(_e))&&(tt=getNodeScroll(a)),isHTMLElement$1(a)){const nt=getBoundingClientRect(a,!0);rt.x=nt.x+a.clientLeft,rt.y=nt.y+a.clientTop}else _e&&(rt.x=getWindowScrollBarX(_e));return{x:et.left+tt.scrollLeft-rt.x,y:et.top+tt.scrollTop-rt.y,width:et.width,height:et.height}}function getParentNode(_){return getNodeName(_)==="html"?_:_.assignedSlot||_.parentNode||(isShadowRoot(_)?_.host:null)||getDocumentElement(_)}function getTrueOffsetParent(_){return!isHTMLElement$1(_)||getComputedStyle(_).position==="fixed"?null:_.offsetParent}function getContainingBlock(_){let a=getParentNode(_);for(isShadowRoot(a)&&(a=a.host);isHTMLElement$1(a)&&!isLastTraversableNode(a);){if(isContainingBlock(a))return a;{const $=a.parentNode;a=isShadowRoot($)?$.host:$}}return null}function getOffsetParent(_){const a=getWindow$1(_);let $=getTrueOffsetParent(_);for(;$&&isTableElement($)&&getComputedStyle($).position==="static";)$=getTrueOffsetParent($);return $&&(getNodeName($)==="html"||getNodeName($)==="body"&&getComputedStyle($).position==="static"&&!isContainingBlock($))?a:$||getContainingBlock(_)||a}function getDimensions(_){if(isHTMLElement$1(_))return{width:_.offsetWidth,height:_.offsetHeight};const a=getBoundingClientRect(_);return{width:a.width,height:a.height}}function convertOffsetParentRelativeRectToViewportRelativeRect(_){let{rect:a,offsetParent:$,strategy:j}=_;const _e=isHTMLElement$1($),et=getDocumentElement($);if($===et)return a;let tt={scrollLeft:0,scrollTop:0};const rt={x:0,y:0};if((_e||!_e&&j!=="fixed")&&((getNodeName($)!=="body"||isOverflowElement(et))&&(tt=getNodeScroll($)),isHTMLElement$1($))){const nt=getBoundingClientRect($,!0);rt.x=nt.x+$.clientLeft,rt.y=nt.y+$.clientTop}return{...a,x:a.x-tt.scrollLeft+rt.x,y:a.y-tt.scrollTop+rt.y}}function getViewportRect(_,a){const $=getWindow$1(_),j=getDocumentElement(_),_e=$.visualViewport;let et=j.clientWidth,tt=j.clientHeight,rt=0,nt=0;if(_e){et=_e.width,tt=_e.height;const it=isLayoutViewport();(it||!it&&a==="fixed")&&(rt=_e.offsetLeft,nt=_e.offsetTop)}return{width:et,height:tt,x:rt,y:nt}}function getDocumentRect(_){var a;const $=getDocumentElement(_),j=getNodeScroll(_),_e=(a=_.ownerDocument)==null?void 0:a.body,et=max($.scrollWidth,$.clientWidth,_e?_e.scrollWidth:0,_e?_e.clientWidth:0),tt=max($.scrollHeight,$.clientHeight,_e?_e.scrollHeight:0,_e?_e.clientHeight:0);let rt=-j.scrollLeft+getWindowScrollBarX(_);const nt=-j.scrollTop;return getComputedStyle(_e||$).direction==="rtl"&&(rt+=max($.clientWidth,_e?_e.clientWidth:0)-et),{width:et,height:tt,x:rt,y:nt}}function getNearestOverflowAncestor(_){const a=getParentNode(_);return isLastTraversableNode(a)?_.ownerDocument.body:isHTMLElement$1(a)&&isOverflowElement(a)?a:getNearestOverflowAncestor(a)}function getOverflowAncestors(_,a){var $;a===void 0&&(a=[]);const j=getNearestOverflowAncestor(_),_e=j===(($=_.ownerDocument)==null?void 0:$.body),et=getWindow$1(j),tt=_e?[et].concat(et.visualViewport||[],isOverflowElement(j)?j:[]):j,rt=a.concat(tt);return _e?rt:rt.concat(getOverflowAncestors(tt))}function contains(_,a){const $=a.getRootNode==null?void 0:a.getRootNode();if(_.contains(a))return!0;if($&&isShadowRoot($)){let j=a;do{if(j&&_===j)return!0;j=j.parentNode||j.host}while(j)}return!1}function getNearestParentCapableOfEscapingClipping(_,a){let $=_;for(;$&&!isLastTraversableNode($)&&!a.includes($)&&!(isElement$1($)&&["absolute","fixed"].includes(getComputedStyle($).position));){const j=getParentNode($);$=isShadowRoot(j)?j.host:j}return $}function getInnerBoundingClientRect(_,a){const $=getBoundingClientRect(_,!1,a==="fixed"),j=$.top+_.clientTop,_e=$.left+_.clientLeft;return{top:j,left:_e,x:_e,y:j,right:_e+_.clientWidth,bottom:j+_.clientHeight,width:_.clientWidth,height:_.clientHeight}}function getClientRectFromClippingAncestor(_,a,$){return a==="viewport"?rectToClientRect(getViewportRect(_,$)):isElement$1(a)?getInnerBoundingClientRect(a,$):rectToClientRect(getDocumentRect(getDocumentElement(_)))}function getClippingAncestors(_){const a=getOverflowAncestors(_),$=getNearestParentCapableOfEscapingClipping(_,a);let j=null;if($&&isHTMLElement$1($)){const _e=getOffsetParent($);isOverflowElement($)?j=$:isHTMLElement$1(_e)&&(j=_e)}return isElement$1(j)?a.filter(_e=>j&&isElement$1(_e)&&contains(_e,j)&&getNodeName(_e)!=="body"):[]}function getClippingRect(_){let{element:a,boundary:$,rootBoundary:j,strategy:_e}=_;const tt=[...$==="clippingAncestors"?getClippingAncestors(a):[].concat($),j],rt=tt[0],nt=tt.reduce((it,st)=>{const ot=getClientRectFromClippingAncestor(a,st,_e);return it.top=max(ot.top,it.top),it.right=min(ot.right,it.right),it.bottom=min(ot.bottom,it.bottom),it.left=max(ot.left,it.left),it},getClientRectFromClippingAncestor(a,rt,_e));return{width:nt.right-nt.left,height:nt.bottom-nt.top,x:nt.left,y:nt.top}}const platform={getClippingRect,convertOffsetParentRelativeRectToViewportRelativeRect,isElement:isElement$1,getDimensions,getOffsetParent,getDocumentElement,getElementRects:_=>{let{reference:a,floating:$,strategy:j}=_;return{reference:getRectRelativeToOffsetParent(a,getOffsetParent($),j),floating:{...getDimensions($),x:0,y:0}}},getClientRects:_=>Array.from(_.getClientRects()),isRTL:_=>getComputedStyle(_).direction==="rtl"};function autoUpdate(_,a,$,j){j===void 0&&(j={});const{ancestorScroll:_e=!0,ancestorResize:et=!0,elementResize:tt=!0,animationFrame:rt=!1}=j,nt=_e&&!rt,it=nt||et?[...isElement$1(_)?getOverflowAncestors(_):_.contextElement?getOverflowAncestors(_.contextElement):[],...getOverflowAncestors(a)]:[];it.forEach(ct=>{nt&&ct.addEventListener("scroll",$,{passive:!0}),et&&ct.addEventListener("resize",$)});let st=null;if(tt){let ct=!0;st=new ResizeObserver(()=>{ct||$(),ct=!1}),isElement$1(_)&&!rt&&st.observe(_),!isElement$1(_)&&_.contextElement&&!rt&&st.observe(_.contextElement),st.observe(a)}let ot,at=rt?getBoundingClientRect(_):null;rt&&lt();function lt(){const ct=getBoundingClientRect(_);at&&(ct.x!==at.x||ct.y!==at.y||ct.width!==at.width||ct.height!==at.height)&&$(),at=ct,ot=requestAnimationFrame(lt)}return $(),()=>{var ct;it.forEach(ut=>{nt&&ut.removeEventListener("scroll",$),et&&ut.removeEventListener("resize",$)}),(ct=st)==null||ct.disconnect(),st=null,rt&&cancelAnimationFrame(ot)}}const computePosition=(_,a,$)=>computePosition$1(_,a,{platform,...$});var index$2=typeof document<"u"?react.exports.useLayoutEffect:react.exports.useEffect;function deepEqual(_,a){if(_===a)return!0;if(typeof _!=typeof a)return!1;if(typeof _=="function"&&_.toString()===a.toString())return!0;let $,j,_e;if(_&&a&&typeof _=="object"){if(Array.isArray(_)){if($=_.length,$!=a.length)return!1;for(j=$;j--!==0;)if(!deepEqual(_[j],a[j]))return!1;return!0}if(_e=Object.keys(_),$=_e.length,$!==Object.keys(a).length)return!1;for(j=$;j--!==0;)if(!Object.prototype.hasOwnProperty.call(a,_e[j]))return!1;for(j=$;j--!==0;){const et=_e[j];if(!(et==="_owner"&&_.$$typeof)&&!deepEqual(_[et],a[et]))return!1}return!0}return _!==_&&a!==a}function useLatestRef$1(_){const a=react.exports.useRef(_);return index$2(()=>{a.current=_}),a}function useFloating$1(_){let{middleware:a,placement:$="bottom",strategy:j="absolute",whileElementsMounted:_e}=_===void 0?{}:_;const[et,tt]=react.exports.useState({x:null,y:null,strategy:j,placement:$,middlewareData:{}}),[rt,nt]=react.exports.useState(a);deepEqual(rt?.map(mt=>{let{name:_t,options:vt}=mt;return{name:_t,options:vt}}),a?.map(mt=>{let{name:_t,options:vt}=mt;return{name:_t,options:vt}}))||nt(a);const it=react.exports.useRef(null),st=react.exports.useRef(null),ot=react.exports.useRef(null),at=react.exports.useRef(et),lt=useLatestRef$1(_e),ct=react.exports.useCallback(()=>{!it.current||!st.current||computePosition(it.current,st.current,{middleware:rt,placement:$,strategy:j}).then(mt=>{ut.current&&!deepEqual(at.current,mt)&&(at.current=mt,reactDom.exports.flushSync(()=>{tt(mt)}))})},[rt,$,j]);index$2(()=>{ut.current&&ct()},[ct]);const ut=react.exports.useRef(!1);index$2(()=>(ut.current=!0,()=>{ut.current=!1}),[]);const dt=react.exports.useCallback(()=>{if(typeof ot.current=="function"&&(ot.current(),ot.current=null),it.current&&st.current)if(lt.current){const mt=lt.current(it.current,st.current,ct);ot.current=mt}else ct()},[ct,lt]),ft=react.exports.useCallback(mt=>{it.current=mt,dt()},[dt]),pt=react.exports.useCallback(mt=>{st.current=mt,dt()},[dt]),yt=react.exports.useMemo(()=>({reference:it,floating:st}),[]);return react.exports.useMemo(()=>({...et,update:ct,refs:yt,reference:ft,floating:pt}),[et,ct,yt,ft,pt])}const arrow=_=>{const{element:a,padding:$}=_;function j(_e){return Object.prototype.hasOwnProperty.call(_e,"current")}return{name:"arrow",options:_,fn(_e){return j(a)?a.current!=null?arrow$1({element:a.current,padding:$}).fn(_e):{}:a?arrow$1({element:a,padding:$}).fn(_e):{}}}};var index$1=typeof document<"u"?react.exports.useLayoutEffect:react.exports.useEffect;function createPubSub(){const _=new Map;return{emit(a,$){var j;(j=_.get(a))==null||j.forEach(_e=>_e($))},on(a,$){_.set(a,[..._.get(a)||[],$])},off(a,$){_.set(a,(_.get(a)||[]).filter(j=>j!==$))}}}let serverHandoffComplete=!1,count=0;const genId=()=>"floating-ui-"+count++;function useFloatingId(){const[_,a]=react.exports.useState(()=>serverHandoffComplete?genId():void 0);return index$1(()=>{_==null&&a(genId())},[]),react.exports.useEffect(()=>{serverHandoffComplete||(serverHandoffComplete=!0)},[]),_}const useReactId=React$1["useId".toString()],useId=useReactId??useFloatingId,FloatingNodeContext=react.exports.createContext(null),FloatingTreeContext=react.exports.createContext(null),useFloatingParentNodeId=()=>{var _,a;return(_=(a=react.exports.useContext(FloatingNodeContext))==null?void 0:a.id)!=null?_:null},useFloatingTree=()=>react.exports.useContext(FloatingTreeContext);function getDocument(_){var a;return(a=_?.ownerDocument)!=null?a:document}function getWindow(_){var a;return(a=getDocument(_).defaultView)!=null?a:window}function isElement(_){return _?_ instanceof getWindow(_).Element:!1}function isHTMLElement(_){return _?_ instanceof getWindow(_).HTMLElement:!1}const useInsertionEffect=React$1["useInsertionEffect".toString()];function useEvent(_){const a=react.exports.useRef(()=>{});return useInsertionEffect?useInsertionEffect(()=>{a.current=_}):a.current=_,react.exports.useCallback(function(){for(var $=arguments.length,j=new Array($),_e=0;_e<$;_e++)j[_e]=arguments[_e];return a.current==null?void 0:a.current(...j)},[])}function useFloating(_){let{open:a=!1,onOpenChange:$,whileElementsMounted:j,placement:_e,middleware:et,strategy:tt,nodeId:rt}=_===void 0?{}:_;const[nt,it]=react.exports.useState(null),st=useFloatingTree(),ot=react.exports.useRef(null),at=react.exports.useRef({}),lt=react.exports.useState(()=>createPubSub())[0],ct=useFloating$1({placement:_e,middleware:et,strategy:tt,whileElementsMounted:j}),ut=useEvent($),dt=react.exports.useMemo(()=>({...ct.refs,domReference:ot}),[ct.refs]),ft=react.exports.useMemo(()=>({...ct,refs:dt,dataRef:at,nodeId:rt,events:lt,open:a,onOpenChange:ut,_:{domReference:nt}}),[ct,rt,lt,a,ut,dt,nt]);index$1(()=>{const mt=st?.nodesRef.current.find(_t=>_t.id===rt);mt&&(mt.context=ft)});const{reference:pt}=ct,yt=react.exports.useCallback(mt=>{(isElement(mt)||mt===null)&&(ft.refs.domReference.current=mt,it(mt)),pt(mt)},[pt,ft.refs]);return react.exports.useMemo(()=>({...ct,context:ft,refs:dt,reference:yt}),[ct,dt,ft,yt])}function mergeProps(_,a,$){const j=new Map;return{...$==="floating"&&{tabIndex:-1},..._,...a.map(_e=>_e?_e[$]:null).concat(_).reduce((_e,et)=>(et&&Object.entries(et).forEach(tt=>{let[rt,nt]=tt;if(rt.indexOf("on")===0){if(j.has(rt)||j.set(rt,[]),typeof nt=="function"){var it;(it=j.get(rt))==null||it.push(nt),_e[rt]=function(){for(var st,ot=arguments.length,at=new Array(ot),lt=0;lt<ot;lt++)at[lt]=arguments[lt];(st=j.get(rt))==null||st.forEach(ct=>ct(...at))}}}else _e[rt]=nt}),_e),{})}}const useInteractions=function(_){_===void 0&&(_=[]);const a=_,$=react.exports.useCallback(et=>mergeProps(et,_,"reference"),a),j=react.exports.useCallback(et=>mergeProps(et,_,"floating"),a),_e=react.exports.useCallback(et=>mergeProps(et,_,"item"),a);return react.exports.useMemo(()=>({getReferenceProps:$,getFloatingProps:j,getItemProps:_e}),[$,j,_e])};function getChildren(_,a){var $;let j=($=_.filter(tt=>{var rt;return tt.parentId===a&&((rt=tt.context)==null?void 0:rt.open)}))!=null?$:[],_e=j;for(;_e.length;){var et;_e=(et=_.filter(tt=>{var rt;return(rt=_e)==null?void 0:rt.some(nt=>{var it;return tt.parentId===nt.id&&((it=tt.context)==null?void 0:it.open)})}))!=null?et:[],j=j.concat(_e)}return j}function getTarget(_){return"composedPath"in _?_.composedPath()[0]:_.target}function useLatestRef(_){const a=react.exports.useRef(_);return index$1(()=>{a.current=_}),a}function usePrevious(_){const a=react.exports.useRef();return index$1(()=>{a.current=_},[_]),a.current}function getDelay(_,a,$){return $&&$!=="mouse"?0:typeof _=="number"?_:_?.[a]}const useHover=function(_,a){let{enabled:$=!0,delay:j=0,handleClose:_e=null,mouseOnly:et=!1,restMs:tt=0,move:rt=!0}=a===void 0?{}:a;const{open:nt,onOpenChange:it,dataRef:st,events:ot,refs:at,_:lt}=_,ct=useFloatingTree(),ut=useFloatingParentNodeId(),dt=useLatestRef(_e),ft=useLatestRef(j),pt=usePrevious(nt),yt=react.exports.useRef(),mt=react.exports.useRef(),_t=react.exports.useRef(),vt=react.exports.useRef(),ht=react.exports.useRef(!0),St=react.exports.useRef(!1),It=react.exports.useCallback(()=>{var kt;const gt=(kt=st.current.openEvent)==null?void 0:kt.type;return gt?.includes("mouse")&&gt!=="mousedown"},[st]);react.exports.useEffect(()=>{if(!$)return;function kt(){clearTimeout(mt.current),clearTimeout(vt.current),ht.current=!0}return ot.on("dismiss",kt),()=>{ot.off("dismiss",kt)}},[$,ot,at]),react.exports.useEffect(()=>{if(!$||!dt.current)return;function kt(){It()&&it(!1)}const gt=getDocument(at.floating.current).documentElement;return gt.addEventListener("mouseleave",kt),()=>{gt.removeEventListener("mouseleave",kt)}},[at,it,$,dt,st,It]);const Lt=react.exports.useCallback(function(kt){kt===void 0&&(kt=!0);const gt=getDelay(ft.current,"close",yt.current);gt&&!_t.current?(clearTimeout(mt.current),mt.current=setTimeout(()=>it(!1),gt)):kt&&(clearTimeout(mt.current),it(!1))},[ft,it]),Mt=react.exports.useCallback(()=>{_t.current&&(getDocument(at.floating.current).removeEventListener("pointermove",_t.current),_t.current=void 0)},[at]),Kt=react.exports.useCallback(()=>{getDocument(at.floating.current).body.style.pointerEvents="",St.current=!1},[at]);return react.exports.useEffect(()=>{if(!$)return;function kt(){return st.current.openEvent?["click","mousedown"].includes(st.current.openEvent.type):!1}function gt(Nt){if(clearTimeout(mt.current),ht.current=!1,et&&yt.current!=="mouse"||tt>0&&getDelay(ft.current,"open")===0)return;st.current.openEvent=Nt;const Bt=getDelay(ft.current,"open",yt.current);Bt?mt.current=setTimeout(()=>{it(!0)},Bt):it(!0)}function Et(Nt){if(kt())return;const Bt=getDocument(at.floating.current);if(clearTimeout(vt.current),dt.current){clearTimeout(mt.current),_t.current&&Bt.removeEventListener("pointermove",_t.current),_t.current=dt.current({..._,tree:ct,x:Nt.clientX,y:Nt.clientY,onClose(){Kt(),Mt(),Lt()}}),Bt.addEventListener("pointermove",_t.current);return}Lt()}function xt(Nt){kt()||dt.current==null||dt.current({..._,tree:ct,x:Nt.clientX,y:Nt.clientY,leave:!0,onClose(){Kt(),Mt(),Lt()}})(Nt)}const Tt=at.floating.current,At=at.domReference.current;if(isElement(At))return nt&&At.addEventListener("mouseleave",xt),Tt?.addEventListener("mouseleave",xt),rt&&At.addEventListener("mousemove",gt,{once:!0}),At.addEventListener("mouseenter",gt),At.addEventListener("mouseleave",Et),()=>{nt&&At.removeEventListener("mouseleave",xt),Tt?.removeEventListener("mouseleave",xt),rt&&At.removeEventListener("mousemove",gt),At.removeEventListener("mouseenter",gt),At.removeEventListener("mouseleave",Et)}},[lt.domReference,$,_,et,tt,rt,Lt,Mt,Kt,it,nt,ct,at,ft,dt,st]),index$1(()=>{if(!!$&&nt&&dt.current&&dt.current.__options.blockPointerEvents&&It()){getDocument(at.floating.current).body.style.pointerEvents="none",St.current=!0;const Et=at.domReference.current,xt=at.floating.current;if(isElement(Et)&&xt){var kt,gt;const Tt=ct==null||(kt=ct.nodesRef.current.find(At=>At.id===ut))==null||(gt=kt.context)==null?void 0:gt.refs.floating.current;return Tt&&(Tt.style.pointerEvents=""),Et.style.pointerEvents="auto",xt.style.pointerEvents="auto",()=>{Et.style.pointerEvents="",xt.style.pointerEvents=""}}}},[$,nt,ut,at,ct,dt,st,It]),index$1(()=>{pt&&!nt&&(yt.current=void 0,Mt(),Kt())}),react.exports.useEffect(()=>()=>{Mt(),clearTimeout(mt.current),clearTimeout(vt.current),St.current&&Kt()},[$,Mt,Kt]),react.exports.useMemo(()=>{if(!$)return{};function kt(gt){yt.current=gt.pointerType}return{reference:{onPointerDown:kt,onPointerEnter:kt,onMouseMove(){nt||tt===0||(clearTimeout(vt.current),vt.current=setTimeout(()=>{ht.current||it(!0)},tt))}},floating:{onMouseEnter(){clearTimeout(mt.current)},onMouseLeave(){Lt(!1)}}}},[$,tt,nt,it,Lt])},FloatingDelayGroupContext=react.exports.createContext({delay:1e3,initialDelay:1e3,currentId:null,setCurrentId:()=>{},setState:()=>{}}),useDelayGroupContext=()=>react.exports.useContext(FloatingDelayGroupContext),FloatingDelayGroup=_=>{let{children:a,delay:$}=_;const[j,_e]=react.exports.useState({delay:$,initialDelay:$,currentId:null}),et=react.exports.useCallback(tt=>{_e(rt=>({...rt,currentId:tt}))},[]);return jsx(FloatingDelayGroupContext.Provider,{value:react.exports.useMemo(()=>({...j,setState:_e,setCurrentId:et}),[j,_e,et]),children:a})},useDelayGroup=(_,a)=>{let{open:$,onOpenChange:j}=_,{id:_e}=a;const{currentId:et,initialDelay:tt,setState:rt}=useDelayGroupContext();react.exports.useEffect(()=>{et&&(rt(nt=>({...nt,delay:{open:1,close:getDelay(tt,"close")}})),et!==_e&&j(!1))},[_e,j,rt,et,tt]),react.exports.useEffect(()=>{!$&&et===_e&&(j(!1),rt(nt=>({...nt,delay:tt,currentId:null})))},[$,rt,et,_e,j,tt])},useRole=function(_,a){let{open:$}=_,{enabled:j=!0,role:_e="dialog"}=a===void 0?{}:a;const et=useId(),tt=useId();return react.exports.useMemo(()=>{const rt={id:et,role:_e};return j?_e==="tooltip"?{reference:{"aria-describedby":$?et:void 0},floating:rt}:{reference:{"aria-expanded":$?"true":"false","aria-haspopup":_e==="alertdialog"?"dialog":_e,"aria-controls":$?et:void 0,..._e==="listbox"&&{role:"combobox"},..._e==="menu"&&{id:tt}},floating:{...rt,..._e==="menu"&&{"aria-labelledby":tt}}}:{}},[j,_e,$,et,tt])};function isEventTargetWithin(_,a){if(a==null)return!1;if("composedPath"in _)return _.composedPath().includes(a);const $=_;return $.target!=null&&a.contains($.target)}const bubbleHandlerKeys={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},captureHandlerKeys={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},useDismiss=function(_,a){let{open:$,onOpenChange:j,refs:_e,events:et,nodeId:tt}=_,{enabled:rt=!0,escapeKey:nt=!0,outsidePress:it=!0,outsidePressEvent:st="pointerdown",referencePress:ot=!1,referencePressEvent:at="pointerdown",ancestorScroll:lt=!1,bubbles:ct=!0}=a===void 0?{}:a;const ut=useFloatingTree(),dt=useFloatingParentNodeId()!=null,ft=react.exports.useRef(!1);return react.exports.useEffect(()=>{if(!$||!rt)return;function pt(ht){if(ht.key==="Escape"){if(!ct&&ut&&getChildren(ut.nodesRef.current,tt).length>0)return;et.emit("dismiss",{preventScroll:!1}),j(!1)}}function yt(ht){const St=ft.current;if(ft.current=!1,St)return;const It=getTarget(ht);if(isElement(It)&&_e.floating.current){var Lt;const Kt=(Lt=_e.floating.current.ownerDocument.defaultView)!=null?Lt:window,kt=It.scrollWidth>It.clientWidth,gt=It.scrollHeight>It.clientHeight;let Et=gt&&ht.offsetX>It.clientWidth;if(gt&&Kt.getComputedStyle(It).direction==="rtl"&&(Et=ht.offsetX<=It.offsetWidth-It.clientWidth),Et||kt&&ht.offsetY>It.clientHeight)return}const Mt=ut&&getChildren(ut.nodesRef.current,tt).some(Kt=>{var kt;return isEventTargetWithin(ht,(kt=Kt.context)==null?void 0:kt.refs.floating.current)});isEventTargetWithin(ht,_e.floating.current)||isEventTargetWithin(ht,_e.domReference.current)||Mt||!ct&&ut&&getChildren(ut.nodesRef.current,tt).length>0||(et.emit("dismiss",dt?{preventScroll:!0}:!1),j(!1))}function mt(){j(!1)}const _t=getDocument(_e.floating.current);nt&&_t.addEventListener("keydown",pt),it&&_t.addEventListener(st,yt);let vt=[];return lt&&(isElement(_e.domReference.current)&&(vt=getOverflowAncestors(_e.domReference.current)),isElement(_e.floating.current)&&(vt=vt.concat(getOverflowAncestors(_e.floating.current))),!isElement(_e.reference.current)&&_e.reference.current&&_e.reference.current.contextElement&&(vt=vt.concat(getOverflowAncestors(_e.reference.current.contextElement)))),vt=vt.filter(ht=>{var St;return ht!==((St=_t.defaultView)==null?void 0:St.visualViewport)}),vt.forEach(ht=>{ht.addEventListener("scroll",mt,{passive:!0})}),()=>{nt&&_t.removeEventListener("keydown",pt),it&&_t.removeEventListener(st,yt),vt.forEach(ht=>{ht.removeEventListener("scroll",mt)})}},[nt,it,st,et,ut,tt,$,j,lt,rt,ct,_e,dt]),react.exports.useEffect(()=>{ft.current=!1},[it,st]),react.exports.useMemo(()=>rt?{reference:{[bubbleHandlerKeys[at]]:()=>{ot&&(et.emit("dismiss"),j(!1))}},floating:{[captureHandlerKeys[st]]:()=>{ft.current=!0}}}:{},[rt,et,ot,st,at,j])},useFocus=function(_,a){let{open:$,onOpenChange:j,dataRef:_e,refs:et,events:tt}=_,{enabled:rt=!0,keyboardOnly:nt=!0}=a===void 0?{}:a;const it=react.exports.useRef(""),st=react.exports.useRef(!1),ot=react.exports.useRef();return react.exports.useEffect(()=>{var at;if(!rt)return;const ct=(at=getDocument(et.floating.current).defaultView)!=null?at:window;function ut(){!$&&isHTMLElement(et.domReference.current)&&et.domReference.current.blur()}return ct.addEventListener("blur",ut),()=>{ct.removeEventListener("blur",ut)}},[et,$,rt]),react.exports.useEffect(()=>{if(!rt)return;function at(){st.current=!0}return tt.on("dismiss",at),()=>{tt.off("dismiss",at)}},[tt,rt]),react.exports.useEffect(()=>()=>{clearTimeout(ot.current)},[]),react.exports.useMemo(()=>rt?{reference:{onPointerDown(at){let{pointerType:lt}=at;it.current=lt,st.current=!!(lt&&nt)},onPointerLeave(){st.current=!1},onFocus(at){var lt,ct,ut;st.current||at.type==="focus"&&((lt=_e.current.openEvent)==null?void 0:lt.type)==="mousedown"&&(ct=et.domReference.current)!=null&&ct.contains((ut=_e.current.openEvent)==null?void 0:ut.target)||(_e.current.openEvent=at.nativeEvent,j(!0))},onBlur(at){const lt=at.relatedTarget;ot.current=setTimeout(()=>{var ct,ut;(ct=et.floating.current)!=null&&ct.contains(lt)||(ut=et.domReference.current)!=null&&ut.contains(lt)||(st.current=!1,j(!1))})}}}:{},[rt,nt,et,_e,j])};function useFloatingAutoUpdate({opened:_,floating:a,positionDependencies:$}){const[j,_e]=react.exports.useState(0);react.exports.useEffect(()=>{if(a.refs.reference.current&&a.refs.floating.current)return autoUpdate(a.refs.reference.current,a.refs.floating.current,a.update)},[a.refs.reference,a.refs.floating,_,j]),useDidUpdate(()=>{a.update()},$),useDidUpdate(()=>{_e(et=>et+1)},[_])}var __defProp$X=Object.defineProperty,__getOwnPropSymbols$X=Object.getOwnPropertySymbols,__hasOwnProp$X=Object.prototype.hasOwnProperty,__propIsEnum$X=Object.prototype.propertyIsEnumerable,__defNormalProp$X=(_,a,$)=>a in _?__defProp$X(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$X=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$X.call(a,$)&&__defNormalProp$X(_,$,a[$]);if(__getOwnPropSymbols$X)for(var $ of __getOwnPropSymbols$X(a))__propIsEnum$X.call(a,$)&&__defNormalProp$X(_,$,a[$]);return _};const transitionStatuses={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function getTransitionStyles({transition:_,state:a,duration:$,timingFunction:j}){const _e={transitionDuration:`${$}ms`,transitionTimingFunction:j};return typeof _=="string"?_ in transitions?__spreadValues$X(__spreadValues$X(__spreadValues$X({transitionProperty:transitions[_].transitionProperty},_e),transitions[_].common),transitions[_][transitionStatuses[a]]):null:__spreadValues$X(__spreadValues$X(__spreadValues$X({transitionProperty:_.transitionProperty},_e),_.common),_[transitionStatuses[a]])}function useTransition({duration:_,exitDuration:a,timingFunction:$,mounted:j,onEnter:_e,onExit:et,onEntered:tt,onExited:rt}){const nt=useMantineTheme(),it=useReducedMotion(),st=nt.respectReducedMotion?it:!1,[ot,at]=react.exports.useState(j?"entered":"exited");let lt=st?0:_;const ct=react.exports.useRef(-1),ut=dt=>{const ft=dt?_e:et,pt=dt?tt:rt;if(at(dt?"pre-entering":"pre-exiting"),window.clearTimeout(ct.current),lt=st?0:dt?_:a,lt===0)typeof ft=="function"&&ft(),typeof pt=="function"&&pt(),at(dt?"entered":"exited");else{const yt=window.setTimeout(()=>{typeof ft=="function"&&ft(),at(dt?"entering":"exiting")},10);ct.current=window.setTimeout(()=>{window.clearTimeout(yt),typeof pt=="function"&&pt(),at(dt?"entered":"exited")},lt)}};return useDidUpdate(()=>{ut(j)},[j]),react.exports.useEffect(()=>()=>window.clearTimeout(ct.current),[]),{transitionDuration:lt,transitionStatus:ot,transitionTimingFunction:$||nt.transitionTimingFunction}}function Transition({transition:_,duration:a=250,exitDuration:$=a,mounted:j,children:_e,timingFunction:et,onExit:tt,onEntered:rt,onEnter:nt,onExited:it}){const{transitionDuration:st,transitionStatus:ot,transitionTimingFunction:at}=useTransition({mounted:j,exitDuration:$,duration:a,timingFunction:et,onExit:tt,onEntered:rt,onEnter:nt,onExited:it});return st===0?j?jsx(Fragment$1,{children:_e({})}):null:ot==="exited"?null:jsx(Fragment$1,{children:_e(getTransitionStyles({transition:_,duration:st,state:ot,timingFunction:at}))})}Transition.displayName="@mantine/core/Transition";var __defProp$W=Object.defineProperty,__defProps$v=Object.defineProperties,__getOwnPropDescs$v=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$W=Object.getOwnPropertySymbols,__hasOwnProp$W=Object.prototype.hasOwnProperty,__propIsEnum$W=Object.prototype.propertyIsEnumerable,__defNormalProp$W=(_,a,$)=>a in _?__defProp$W(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$W=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$W.call(a,$)&&__defNormalProp$W(_,$,a[$]);if(__getOwnPropSymbols$W)for(var $ of __getOwnPropSymbols$W(a))__propIsEnum$W.call(a,$)&&__defNormalProp$W(_,$,a[$]);return _},__spreadProps$v=(_,a)=>__defProps$v(_,__getOwnPropDescs$v(a));function horizontalSide(_,a,$){return _==="center"?{top:a}:_==="end"?{bottom:$}:_==="start"?{top:$}:{}}function verticalSide(_,a,$,j){return _==="center"?{[j==="ltr"?"left":"right"]:a}:_==="end"?{[j==="ltr"?"right":"left"]:$}:_==="start"?{[j==="ltr"?"left":"right"]:$}:{}}const radiusByFloatingSide={bottom:"borderTopLeftRadius",left:"borderTopRightRadius",right:"borderBottomLeftRadius",top:"borderBottomRightRadius"};function getArrowPositionStyles({position:_,withBorder:a,arrowSize:$,arrowOffset:j,arrowRadius:_e,arrowX:et,arrowY:tt,dir:rt}){const[nt,it="center"]=_.split("-"),st={width:$,height:$,transform:"rotate(45deg)",position:"absolute",[radiusByFloatingSide[nt]]:_e},ot=a?-$/2-1:-$/2;return nt==="left"?__spreadProps$v(__spreadValues$W(__spreadValues$W({},st),horizontalSide(it,tt,j)),{right:ot,borderLeft:0,borderBottom:0}):nt==="right"?__spreadProps$v(__spreadValues$W(__spreadValues$W({},st),horizontalSide(it,tt,j)),{left:ot,borderRight:0,borderTop:0}):nt==="top"?__spreadProps$v(__spreadValues$W(__spreadValues$W({},st),verticalSide(it,et,j,rt)),{bottom:ot,borderTop:0,[rt==="ltr"?"borderLeft":"borderRight"]:0}):nt==="bottom"?__spreadProps$v(__spreadValues$W(__spreadValues$W({},st),verticalSide(it,et,j,rt)),{top:ot,borderBottom:0,[rt==="ltr"?"borderRight":"borderLeft"]:0}):{}}var __defProp$V=Object.defineProperty,__defProps$u=Object.defineProperties,__getOwnPropDescs$u=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$V=Object.getOwnPropertySymbols,__hasOwnProp$V=Object.prototype.hasOwnProperty,__propIsEnum$V=Object.prototype.propertyIsEnumerable,__defNormalProp$V=(_,a,$)=>a in _?__defProp$V(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$V=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$V.call(a,$)&&__defNormalProp$V(_,$,a[$]);if(__getOwnPropSymbols$V)for(var $ of __getOwnPropSymbols$V(a))__propIsEnum$V.call(a,$)&&__defNormalProp$V(_,$,a[$]);return _},__spreadProps$u=(_,a)=>__defProps$u(_,__getOwnPropDescs$u(a)),__objRest$D=(_,a)=>{var $={};for(var j in _)__hasOwnProp$V.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$V)for(var j of __getOwnPropSymbols$V(_))a.indexOf(j)<0&&__propIsEnum$V.call(_,j)&&($[j]=_[j]);return $};const FloatingArrow=react.exports.forwardRef((_,a)=>{var $=_,{withBorder:j,position:_e,arrowSize:et,arrowOffset:tt,arrowRadius:rt,visible:nt,arrowX:it,arrowY:st}=$,ot=__objRest$D($,["withBorder","position","arrowSize","arrowOffset","arrowRadius","visible","arrowX","arrowY"]);const at=useMantineTheme();return nt?jsx("div",{...__spreadProps$u(__spreadValues$V({},ot),{ref:a,style:getArrowPositionStyles({withBorder:j,position:_e,arrowSize:et,arrowOffset:tt,arrowRadius:rt,dir:at.dir,arrowX:it,arrowY:st})})}):null});FloatingArrow.displayName="@mantine/core/FloatingArrow";function getFloatingPosition(_,a){if(_==="rtl"&&(a.includes("right")||a.includes("left"))){const[$,j]=a.split("-"),_e=$==="right"?"left":"right";return j===void 0?_e:`${_e}-${j}`}return a}var __defProp$U=Object.defineProperty,__defProps$t=Object.defineProperties,__getOwnPropDescs$t=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$U=Object.getOwnPropertySymbols,__hasOwnProp$U=Object.prototype.hasOwnProperty,__propIsEnum$U=Object.prototype.propertyIsEnumerable,__defNormalProp$U=(_,a,$)=>a in _?__defProp$U(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$U=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$U.call(a,$)&&__defNormalProp$U(_,$,a[$]);if(__getOwnPropSymbols$U)for(var $ of __getOwnPropSymbols$U(a))__propIsEnum$U.call(a,$)&&__defNormalProp$U(_,$,a[$]);return _},__spreadProps$t=(_,a)=>__defProps$t(_,__getOwnPropDescs$t(a)),__objRest$C=(_,a)=>{var $={};for(var j in _)__hasOwnProp$U.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$U)for(var j of __getOwnPropSymbols$U(_))a.indexOf(j)<0&&__propIsEnum$U.call(_,j)&&($[j]=_[j]);return $};function useInputProps(_,a,$){const j=useComponentDefaultProps(_,a,$),{label:_e,description:et,error:tt,required:rt,classNames:nt,styles:it,className:st,unstyled:ot,__staticSelector:at,sx:lt,errorProps:ct,labelProps:ut,descriptionProps:dt,wrapperProps:ft,id:pt,size:yt,style:mt,inputContainer:_t,inputWrapperOrder:vt,withAsterisk:ht}=j,St=__objRest$C(j,["label","description","error","required","classNames","styles","className","unstyled","__staticSelector","sx","errorProps","labelProps","descriptionProps","wrapperProps","id","size","style","inputContainer","inputWrapperOrder","withAsterisk"]),It=useId$1(pt),{systemStyles:Lt,rest:Mt}=extractSystemStyles(St);return __spreadProps$t(__spreadValues$U({},Mt),{classNames:nt,styles:it,unstyled:ot,wrapperProps:__spreadValues$U(__spreadValues$U({label:_e,description:et,error:tt,required:rt,classNames:nt,className:st,__staticSelector:at,sx:lt,errorProps:ct,labelProps:ut,descriptionProps:dt,unstyled:ot,styles:it,id:It,size:yt,style:mt,inputContainer:_t,inputWrapperOrder:vt,withAsterisk:ht},ft),Lt),inputProps:{required:rt,classNames:nt,styles:it,unstyled:ot,id:It,size:yt,__staticSelector:at,invalid:!!tt}})}var useStyles$18=createStyles((_,{size:a})=>({label:{display:"inline-block",fontSize:_.fn.size({size:a,sizes:_.fontSizes}),fontWeight:500,color:_.colorScheme==="dark"?_.colors.dark[0]:_.colors.gray[9],wordBreak:"break-word",cursor:"default",WebkitTapHighlightColor:"transparent"},required:{color:_.fn.variant({variant:"filled",color:"red"}).background}}));const useStyles$19=useStyles$18;var __defProp$T=Object.defineProperty,__getOwnPropSymbols$T=Object.getOwnPropertySymbols,__hasOwnProp$T=Object.prototype.hasOwnProperty,__propIsEnum$T=Object.prototype.propertyIsEnumerable,__defNormalProp$T=(_,a,$)=>a in _?__defProp$T(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$T=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$T.call(a,$)&&__defNormalProp$T(_,$,a[$]);if(__getOwnPropSymbols$T)for(var $ of __getOwnPropSymbols$T(a))__propIsEnum$T.call(a,$)&&__defNormalProp$T(_,$,a[$]);return _},__objRest$B=(_,a)=>{var $={};for(var j in _)__hasOwnProp$T.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$T)for(var j of __getOwnPropSymbols$T(_))a.indexOf(j)<0&&__propIsEnum$T.call(_,j)&&($[j]=_[j]);return $};const InputLabel=react.exports.forwardRef((_,a)=>{var $=_,{labelElement:j="label",children:_e,required:et,size:tt="sm",classNames:rt,styles:nt,unstyled:it,className:st,htmlFor:ot,__staticSelector:at}=$,lt=__objRest$B($,["labelElement","children","required","size","classNames","styles","unstyled","className","htmlFor","__staticSelector"]);const{classes:ct,cx:ut}=useStyles$19({size:tt},{name:["InputWrapper",at],classNames:rt,styles:nt,unstyled:it});return jsxs(Box,{...__spreadValues$T({component:j,ref:a,className:ut(ct.label,st),htmlFor:j==="label"?ot:void 0},lt),children:[_e,et&&jsx("span",{className:ct.required,"aria-hidden":!0,children:" *"})]})});InputLabel.displayName="@mantine/core/InputLabel";var useStyles$16=createStyles((_,{size:a})=>({error:{wordBreak:"break-word",color:_.fn.variant({variant:"filled",color:"red"}).background,fontSize:_.fn.size({size:a,sizes:_.fontSizes})-2,lineHeight:1.2,display:"block"}}));const useStyles$17=useStyles$16;var __defProp$S=Object.defineProperty,__getOwnPropSymbols$S=Object.getOwnPropertySymbols,__hasOwnProp$S=Object.prototype.hasOwnProperty,__propIsEnum$S=Object.prototype.propertyIsEnumerable,__defNormalProp$S=(_,a,$)=>a in _?__defProp$S(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$S=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$S.call(a,$)&&__defNormalProp$S(_,$,a[$]);if(__getOwnPropSymbols$S)for(var $ of __getOwnPropSymbols$S(a))__propIsEnum$S.call(a,$)&&__defNormalProp$S(_,$,a[$]);return _},__objRest$A=(_,a)=>{var $={};for(var j in _)__hasOwnProp$S.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$S)for(var j of __getOwnPropSymbols$S(_))a.indexOf(j)<0&&__propIsEnum$S.call(_,j)&&($[j]=_[j]);return $};const InputError=react.exports.forwardRef((_,a)=>{var $=_,{children:j,className:_e,classNames:et,styles:tt,unstyled:rt,size:nt="sm",__staticSelector:it}=$,st=__objRest$A($,["children","className","classNames","styles","unstyled","size","__staticSelector"]);const{classes:ot,cx:at}=useStyles$17({size:nt},{name:["InputWrapper",it],classNames:et,styles:tt,unstyled:rt});return jsx(Text,{...__spreadValues$S({className:at(ot.error,_e),ref:a,role:"alert"},st),children:j})});InputError.displayName="@mantine/core/InputError";var useStyles$14=createStyles((_,{size:a})=>({description:{wordBreak:"break-word",color:_.colorScheme==="dark"?_.colors.dark[2]:_.colors.gray[6],fontSize:_.fn.size({size:a,sizes:_.fontSizes})-2,lineHeight:1.2,display:"block"}}));const useStyles$15=useStyles$14;var __defProp$R=Object.defineProperty,__getOwnPropSymbols$R=Object.getOwnPropertySymbols,__hasOwnProp$R=Object.prototype.hasOwnProperty,__propIsEnum$R=Object.prototype.propertyIsEnumerable,__defNormalProp$R=(_,a,$)=>a in _?__defProp$R(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$R=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$R.call(a,$)&&__defNormalProp$R(_,$,a[$]);if(__getOwnPropSymbols$R)for(var $ of __getOwnPropSymbols$R(a))__propIsEnum$R.call(a,$)&&__defNormalProp$R(_,$,a[$]);return _},__objRest$z=(_,a)=>{var $={};for(var j in _)__hasOwnProp$R.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$R)for(var j of __getOwnPropSymbols$R(_))a.indexOf(j)<0&&__propIsEnum$R.call(_,j)&&($[j]=_[j]);return $};const InputDescription=react.exports.forwardRef((_,a)=>{var $=_,{children:j,className:_e,classNames:et,styles:tt,unstyled:rt,size:nt="sm",__staticSelector:it}=$,st=__objRest$z($,["children","className","classNames","styles","unstyled","size","__staticSelector"]);const{classes:ot,cx:at}=useStyles$15({size:nt},{name:["InputWrapper",it],classNames:et,styles:tt,unstyled:rt});return jsx(Text,{...__spreadValues$R({color:"dimmed",className:at(ot.description,_e),ref:a,unstyled:rt},st),children:j})});InputDescription.displayName="@mantine/core/InputDescription";const InputWrapperContext=react.exports.createContext({offsetBottom:!1,offsetTop:!1}),InputWrapperProvider=InputWrapperContext.Provider,useInputWrapperContext=()=>react.exports.useContext(InputWrapperContext);function getInputOffsets(_,{hasDescription:a,hasError:$}){const j=_.findIndex(nt=>nt==="input"),_e=_[j-1],et=_[j+1];return{offsetBottom:a&&et==="description"||$&&et==="error",offsetTop:a&&_e==="description"||$&&_e==="error"}}var __defProp$Q=Object.defineProperty,__defProps$s=Object.defineProperties,__getOwnPropDescs$s=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$Q=Object.getOwnPropertySymbols,__hasOwnProp$Q=Object.prototype.hasOwnProperty,__propIsEnum$Q=Object.prototype.propertyIsEnumerable,__defNormalProp$Q=(_,a,$)=>a in _?__defProp$Q(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$Q=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$Q.call(a,$)&&__defNormalProp$Q(_,$,a[$]);if(__getOwnPropSymbols$Q)for(var $ of __getOwnPropSymbols$Q(a))__propIsEnum$Q.call(a,$)&&__defNormalProp$Q(_,$,a[$]);return _},__spreadProps$s=(_,a)=>__defProps$s(_,__getOwnPropDescs$s(a)),useStyles$12=createStyles(_=>({root:__spreadProps$s(__spreadValues$Q({},_.fn.fontStyles()),{lineHeight:_.lineHeight})}));const useStyles$13=useStyles$12;var __defProp$P=Object.defineProperty,__defProps$r=Object.defineProperties,__getOwnPropDescs$r=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$P=Object.getOwnPropertySymbols,__hasOwnProp$P=Object.prototype.hasOwnProperty,__propIsEnum$P=Object.prototype.propertyIsEnumerable,__defNormalProp$P=(_,a,$)=>a in _?__defProp$P(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$P=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$P.call(a,$)&&__defNormalProp$P(_,$,a[$]);if(__getOwnPropSymbols$P)for(var $ of __getOwnPropSymbols$P(a))__propIsEnum$P.call(a,$)&&__defNormalProp$P(_,$,a[$]);return _},__spreadProps$r=(_,a)=>__defProps$r(_,__getOwnPropDescs$r(a)),__objRest$y=(_,a)=>{var $={};for(var j in _)__hasOwnProp$P.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$P)for(var j of __getOwnPropSymbols$P(_))a.indexOf(j)<0&&__propIsEnum$P.call(_,j)&&($[j]=_[j]);return $};const defaultProps$r={labelElement:"label",size:"sm",inputContainer:_=>_,inputWrapperOrder:["label","description","input","error"]},InputWrapper=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("InputWrapper",defaultProps$r,_),{className:j,label:_e,children:et,required:tt,id:rt,error:nt,description:it,labelElement:st,labelProps:ot,descriptionProps:at,errorProps:lt,classNames:ct,styles:ut,size:dt,inputContainer:ft,__staticSelector:pt,unstyled:yt,inputWrapperOrder:mt,withAsterisk:_t}=$,vt=__objRest$y($,["className","label","children","required","id","error","description","labelElement","labelProps","descriptionProps","errorProps","classNames","styles","size","inputContainer","__staticSelector","unstyled","inputWrapperOrder","withAsterisk"]),{classes:ht,cx:St}=useStyles$13(null,{classNames:ct,styles:ut,name:["InputWrapper",pt],unstyled:yt}),It={classNames:ct,styles:ut,unstyled:yt,size:dt,__staticSelector:pt},Lt=typeof _t=="boolean"?_t:tt,Mt=_e&&jsx(InputLabel,{...__spreadValues$P(__spreadValues$P({key:"label",labelElement:st,id:rt?`${rt}-label`:void 0,htmlFor:rt,required:Lt},It),ot),children:_e}),Kt=it&&jsx(InputDescription,{...__spreadProps$r(__spreadValues$P(__spreadValues$P({key:"description"},at),It),{size:at?.size||It.size}),children:it}),kt=jsx(react.exports.Fragment,{children:ft(et)},"input"),gt=typeof nt!="boolean"&&nt&&jsx(InputError,{...__spreadProps$r(__spreadValues$P(__spreadValues$P({},lt),It),{size:lt?.size||It.size,key:"error"}),children:nt}),Et=mt.map(xt=>{switch(xt){case"label":return Mt;case"input":return kt;case"description":return Kt;case"error":return gt;default:return null}});return jsx(InputWrapperProvider,{value:getInputOffsets(mt,{hasDescription:!!Kt,hasError:!!gt}),children:jsx(Box,{...__spreadValues$P({className:St(ht.root,j),ref:a},vt),children:Et})})});InputWrapper.displayName="@mantine/core/InputWrapper";var __defProp$O=Object.defineProperty,__defProps$q=Object.defineProperties,__getOwnPropDescs$q=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$O=Object.getOwnPropertySymbols,__hasOwnProp$O=Object.prototype.hasOwnProperty,__propIsEnum$O=Object.prototype.propertyIsEnumerable,__defNormalProp$O=(_,a,$)=>a in _?__defProp$O(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$O=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$O.call(a,$)&&__defNormalProp$O(_,$,a[$]);if(__getOwnPropSymbols$O)for(var $ of __getOwnPropSymbols$O(a))__propIsEnum$O.call(a,$)&&__defNormalProp$O(_,$,a[$]);return _},__spreadProps$q=(_,a)=>__defProps$q(_,__getOwnPropDescs$q(a));const sizes$5={xs:30,sm:36,md:42,lg:50,xl:60};function getVariantStyles$4({theme:_,variant:a}){return a==="default"?{border:`1px solid ${_.colorScheme==="dark"?_.colors.dark[4]:_.colors.gray[4]}`,backgroundColor:_.colorScheme==="dark"?_.colors.dark[6]:_.white,transition:"border-color 100ms ease","&:focus, &:focus-within":{outline:"none",borderColor:_.colors[_.primaryColor][_.fn.primaryShade()]}}:a==="filled"?{border:"1px solid transparent",backgroundColor:_.colorScheme==="dark"?_.colors.dark[5]:_.colors.gray[1],"&:focus, &:focus-within":{outline:"none",borderColor:`${_.colors[_.primaryColor][_.fn.primaryShade()]} !important`}}:{borderWidth:0,color:_.colorScheme==="dark"?_.colors.dark[0]:_.black,backgroundColor:"transparent",minHeight:28,outline:0,"&:focus, &:focus-within":{outline:"none",borderColor:"transparent"},"&:disabled":{backgroundColor:"transparent","&:focus, &:focus-within":{outline:"none",borderColor:"transparent"}}}}var useStyles$11=createStyles((_,{size:a,multiline:$,radius:j,variant:_e,invalid:et,rightSectionWidth:tt,withRightSection:rt,iconWidth:nt,offsetBottom:it,offsetTop:st,pointer:ot})=>{const at=_.fn.variant({variant:"filled",color:"red"}).background,lt=_e==="default"||_e==="filled"?{minHeight:_.fn.size({size:a,sizes:sizes$5}),paddingLeft:_.fn.size({size:a,sizes:sizes$5})/3,paddingRight:rt?tt:_.fn.size({size:a,sizes:sizes$5})/3,borderRadius:_.fn.radius(j)}:null;return{wrapper:{position:"relative",marginTop:st?`calc(${_.spacing.xs}px / 2)`:void 0,marginBottom:it?`calc(${_.spacing.xs}px / 2)`:void 0},input:__spreadValues$O(__spreadProps$q(__spreadValues$O(__spreadProps$q(__spreadValues$O({},_.fn.fontStyles()),{height:$?_e==="unstyled"?void 0:"auto":_.fn.size({size:a,sizes:sizes$5}),WebkitTapHighlightColor:"transparent",lineHeight:$?_.lineHeight:`${_.fn.size({size:a,sizes:sizes$5})-2}px`,appearance:"none",resize:"none",boxSizing:"border-box",fontSize:_.fn.size({size:a,sizes:_.fontSizes}),width:"100%",color:_.colorScheme==="dark"?_.colors.dark[0]:_.black,display:"block",textAlign:"left",cursor:ot?"pointer":void 0}),lt),{"&:disabled":{backgroundColor:_.colorScheme==="dark"?_.colors.dark[6]:_.colors.gray[1],color:_.colors.dark[2],opacity:.6,cursor:"not-allowed","&::placeholder":{color:_.colors.dark[2]}},"&::placeholder":{opacity:1,userSelect:"none",color:_.colorScheme==="dark"?_.colors.dark[3]:_.colors.gray[5]},"&::-webkit-inner-spin-button, &::-webkit-outer-spin-button, &::-webkit-search-decoration, &::-webkit-search-cancel-button, &::-webkit-search-results-button, &::-webkit-search-results-decoration":{appearance:"none"},"&[type=number]":{MozAppearance:"textfield"}}),getVariantStyles$4({theme:_,variant:_e})),withIcon:{paddingLeft:typeof nt=="number"?nt:_.fn.size({size:a,sizes:sizes$5})},invalid:{color:at,borderColor:at,"&::placeholder":{opacity:1,color:at}},disabled:{backgroundColor:_.colorScheme==="dark"?_.colors.dark[6]:_.colors.gray[1],color:_.colors.dark[2],opacity:.6,cursor:"not-allowed","&::placeholder":{color:_.colors.dark[2]}},icon:{pointerEvents:"none",position:"absolute",zIndex:1,left:0,top:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",width:typeof nt=="number"?nt:_.fn.size({size:a,sizes:sizes$5}),color:et?_.colors.red[_.colorScheme==="dark"?6:7]:_.colorScheme==="dark"?_.colors.dark[2]:_.colors.gray[5]},rightSection:{position:"absolute",top:0,bottom:0,right:0,display:"flex",alignItems:"center",justifyContent:"center",width:tt}}}),__defProp$N=Object.defineProperty,__defProps$p=Object.defineProperties,__getOwnPropDescs$p=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$N=Object.getOwnPropertySymbols,__hasOwnProp$N=Object.prototype.hasOwnProperty,__propIsEnum$N=Object.prototype.propertyIsEnumerable,__defNormalProp$N=(_,a,$)=>a in _?__defProp$N(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$N=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$N.call(a,$)&&__defNormalProp$N(_,$,a[$]);if(__getOwnPropSymbols$N)for(var $ of __getOwnPropSymbols$N(a))__propIsEnum$N.call(a,$)&&__defNormalProp$N(_,$,a[$]);return _},__spreadProps$p=(_,a)=>__defProps$p(_,__getOwnPropDescs$p(a)),__objRest$x=(_,a)=>{var $={};for(var j in _)__hasOwnProp$N.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$N)for(var j of __getOwnPropSymbols$N(_))a.indexOf(j)<0&&__propIsEnum$N.call(_,j)&&($[j]=_[j]);return $};const defaultProps$q={rightSectionWidth:36,size:"sm",variant:"default"},_Input=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Input",defaultProps$q,_),{className:j,invalid:_e,required:et,disabled:tt,variant:rt,icon:nt,style:it,rightSectionWidth:st,iconWidth:ot,rightSection:at,rightSectionProps:lt,radius:ct,size:ut,wrapperProps:dt,classNames:ft,styles:pt,__staticSelector:yt,multiline:mt,sx:_t,unstyled:vt,pointer:ht}=$,St=__objRest$x($,["className","invalid","required","disabled","variant","icon","style","rightSectionWidth","iconWidth","rightSection","rightSectionProps","radius","size","wrapperProps","classNames","styles","__staticSelector","multiline","sx","unstyled","pointer"]),{offsetBottom:It,offsetTop:Lt}=useInputWrapperContext(),{classes:Mt,cx:Kt}=useStyles$11({radius:ct,size:ut,multiline:mt,variant:rt,invalid:_e,rightSectionWidth:st,iconWidth:ot,withRightSection:!!at,offsetBottom:It,offsetTop:Lt,pointer:ht},{classNames:ft,styles:pt,name:["Input",yt],unstyled:vt}),{systemStyles:kt,rest:gt}=extractSystemStyles(St);return jsxs(Box,{...__spreadValues$N(__spreadValues$N({className:Kt(Mt.wrapper,j),sx:_t,style:it},kt),dt),children:[nt&&jsx("div",{className:Mt.icon,children:nt}),jsx(Box,{...__spreadProps$p(__spreadValues$N({component:"input"},gt),{ref:a,required:et,"aria-invalid":_e,disabled:tt,className:Kt(Mt[`${rt}Variant`],Mt.input,{[Mt.withIcon]:nt,[Mt.invalid]:_e,[Mt.disabled]:tt})})}),at&&jsx("div",{...__spreadProps$p(__spreadValues$N({},lt),{className:Mt.rightSection}),children:at})]})});_Input.displayName="@mantine/core/Input";_Input.Wrapper=InputWrapper;_Input.Label=InputLabel;_Input.Description=InputDescription;_Input.Error=InputError;const Input=_Input;var __defProp$M=Object.defineProperty,__defProps$o=Object.defineProperties,__getOwnPropDescs$o=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$M=Object.getOwnPropertySymbols,__hasOwnProp$M=Object.prototype.hasOwnProperty,__propIsEnum$M=Object.prototype.propertyIsEnumerable,__defNormalProp$M=(_,a,$)=>a in _?__defProp$M(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$M=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$M.call(a,$)&&__defNormalProp$M(_,$,a[$]);if(__getOwnPropSymbols$M)for(var $ of __getOwnPropSymbols$M(a))__propIsEnum$M.call(a,$)&&__defNormalProp$M(_,$,a[$]);return _},__spreadProps$o=(_,a)=>__defProps$o(_,__getOwnPropDescs$o(a));function AvatarPlaceholderIcon(_){return jsx("svg",{...__spreadProps$o(__spreadValues$M({},_),{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"}),children:jsx("path",{d:"M0.877014 7.49988C0.877014 3.84219 3.84216 0.877045 7.49985 0.877045C11.1575 0.877045 14.1227 3.84219 14.1227 7.49988C14.1227 11.1575 11.1575 14.1227 7.49985 14.1227C3.84216 14.1227 0.877014 11.1575 0.877014 7.49988ZM7.49985 1.82704C4.36683 1.82704 1.82701 4.36686 1.82701 7.49988C1.82701 8.97196 2.38774 10.3131 3.30727 11.3213C4.19074 9.94119 5.73818 9.02499 7.50023 9.02499C9.26206 9.02499 10.8093 9.94097 11.6929 11.3208C12.6121 10.3127 13.1727 8.97172 13.1727 7.49988C13.1727 4.36686 10.6328 1.82704 7.49985 1.82704ZM10.9818 11.9787C10.2839 10.7795 8.9857 9.97499 7.50023 9.97499C6.01458 9.97499 4.71624 10.7797 4.01845 11.9791C4.97952 12.7272 6.18765 13.1727 7.49985 13.1727C8.81227 13.1727 10.0206 12.727 10.9818 11.9787ZM5.14999 6.50487C5.14999 5.207 6.20212 4.15487 7.49999 4.15487C8.79786 4.15487 9.84999 5.207 9.84999 6.50487C9.84999 7.80274 8.79786 8.85487 7.49999 8.85487C6.20212 8.85487 5.14999 7.80274 5.14999 6.50487ZM7.49999 5.10487C6.72679 5.10487 6.09999 5.73167 6.09999 6.50487C6.09999 7.27807 6.72679 7.90487 7.49999 7.90487C8.27319 7.90487 8.89999 7.27807 8.89999 6.50487C8.89999 5.73167 8.27319 5.10487 7.49999 5.10487Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}var __defProp$L=Object.defineProperty,__defProps$n=Object.defineProperties,__getOwnPropDescs$n=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$L=Object.getOwnPropertySymbols,__hasOwnProp$L=Object.prototype.hasOwnProperty,__propIsEnum$L=Object.prototype.propertyIsEnumerable,__defNormalProp$L=(_,a,$)=>a in _?__defProp$L(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$L=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$L.call(a,$)&&__defNormalProp$L(_,$,a[$]);if(__getOwnPropSymbols$L)for(var $ of __getOwnPropSymbols$L(a))__propIsEnum$L.call(a,$)&&__defNormalProp$L(_,$,a[$]);return _},__spreadProps$n=(_,a)=>__defProps$n(_,__getOwnPropDescs$n(a));const AvatarGroupContext=react.exports.createContext(null);function AvatarGroupProvider({spacing:_,children:a}){return jsx(AvatarGroupContext.Provider,{value:{spacing:_},children:a})}function useAvatarGroupContext(){const _=react.exports.useContext(AvatarGroupContext);return _?__spreadProps$n(__spreadValues$L({},_),{withinGroup:!0}):{spacing:null,withinGroup:!1}}var useStyles$$=createStyles((_,{spacing:a})=>({root:{display:"flex",paddingLeft:_.fn.size({size:a,sizes:_.spacing})}}));const useStyles$10=useStyles$$;var __defProp$K=Object.defineProperty,__getOwnPropSymbols$K=Object.getOwnPropertySymbols,__hasOwnProp$K=Object.prototype.hasOwnProperty,__propIsEnum$K=Object.prototype.propertyIsEnumerable,__defNormalProp$K=(_,a,$)=>a in _?__defProp$K(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$K=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$K.call(a,$)&&__defNormalProp$K(_,$,a[$]);if(__getOwnPropSymbols$K)for(var $ of __getOwnPropSymbols$K(a))__propIsEnum$K.call(a,$)&&__defNormalProp$K(_,$,a[$]);return _},__objRest$w=(_,a)=>{var $={};for(var j in _)__hasOwnProp$K.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$K)for(var j of __getOwnPropSymbols$K(_))a.indexOf(j)<0&&__propIsEnum$K.call(_,j)&&($[j]=_[j]);return $};const defaultProps$p={},AvatarGroup=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("AvatarGroup",defaultProps$p,_),{children:j,spacing:_e="sm",unstyled:et,className:tt}=$,rt=__objRest$w($,["children","spacing","unstyled","className"]),{classes:nt,cx:it}=useStyles$10({spacing:_e},{name:"AvatarGroup",unstyled:et});return jsx(AvatarGroupProvider,{spacing:_e,children:jsx(Box,{...__spreadValues$K({ref:a,className:it(nt.root,tt)},rt),children:j})})});AvatarGroup.displayName="@mantine/core/AvatarGroup";var __defProp$J=Object.defineProperty,__defProps$m=Object.defineProperties,__getOwnPropDescs$m=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$J=Object.getOwnPropertySymbols,__hasOwnProp$J=Object.prototype.hasOwnProperty,__propIsEnum$J=Object.prototype.propertyIsEnumerable,__defNormalProp$J=(_,a,$)=>a in _?__defProp$J(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$J=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$J.call(a,$)&&__defNormalProp$J(_,$,a[$]);if(__getOwnPropSymbols$J)for(var $ of __getOwnPropSymbols$J(a))__propIsEnum$J.call(a,$)&&__defNormalProp$J(_,$,a[$]);return _},__spreadProps$m=(_,a)=>__defProps$m(_,__getOwnPropDescs$m(a));const sizes$4={xs:16,sm:26,md:38,lg:56,xl:84};function getGroupStyles({withinGroup:_,spacing:a,theme:$}){return _?{marginLeft:-$.fn.size({size:a,sizes:$.spacing}),backgroundColor:`${$.colorScheme==="dark"?$.colors.dark[7]:$.white}`,border:`2px solid ${$.colorScheme==="dark"?$.colors.dark[7]:$.white}`}:null}var useStyles$Z=createStyles((_,{size:a,radius:$,color:j,withinGroup:_e,spacing:et,variant:tt,gradient:rt})=>{const nt=_.fn.variant({variant:tt,color:j,gradient:rt});return{root:__spreadValues$J(__spreadProps$m(__spreadValues$J({},_.fn.focusStyles()),{WebkitTapHighlightColor:"transparent",boxSizing:"border-box",position:"relative",display:"block",userSelect:"none",overflow:"hidden",width:_.fn.size({size:a,sizes:sizes$4}),minWidth:_.fn.size({size:a,sizes:sizes$4}),height:_.fn.size({size:a,sizes:sizes$4}),borderRadius:_.fn.radius($),textDecoration:"none",border:0,backgroundColor:"transparent",padding:0}),getGroupStyles({withinGroup:_e,spacing:et,theme:_})),image:{objectFit:"cover",width:"100%",height:"100%",display:"block"},placeholder:__spreadProps$m(__spreadValues$J({},_.fn.fontStyles()),{fontSize:_.fn.size({size:a,sizes:sizes$4})/2.5,color:nt.color,fontWeight:700,backgroundColor:nt.background,display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",userSelect:"none",backgroundImage:tt==="gradient"?nt.background:void 0,border:`${tt==="gradient"?0:1}px solid ${nt.border}`,borderRadius:_.fn.radius($)}),placeholderIcon:{width:"70%",height:"70%",color:nt.color}}});const useStyles$_=useStyles$Z;var __defProp$I=Object.defineProperty,__defProps$l=Object.defineProperties,__getOwnPropDescs$l=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$I=Object.getOwnPropertySymbols,__hasOwnProp$I=Object.prototype.hasOwnProperty,__propIsEnum$I=Object.prototype.propertyIsEnumerable,__defNormalProp$I=(_,a,$)=>a in _?__defProp$I(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$I=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$I.call(a,$)&&__defNormalProp$I(_,$,a[$]);if(__getOwnPropSymbols$I)for(var $ of __getOwnPropSymbols$I(a))__propIsEnum$I.call(a,$)&&__defNormalProp$I(_,$,a[$]);return _},__spreadProps$l=(_,a)=>__defProps$l(_,__getOwnPropDescs$l(a)),__objRest$v=(_,a)=>{var $={};for(var j in _)__hasOwnProp$I.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$I)for(var j of __getOwnPropSymbols$I(_))a.indexOf(j)<0&&__propIsEnum$I.call(_,j)&&($[j]=_[j]);return $};const defaultProps$o={size:"md",color:"gray",variant:"light"},_Avatar=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Avatar",defaultProps$o,_),{className:j,size:_e,src:et,alt:tt,radius:rt,children:nt,color:it,variant:st,gradient:ot,classNames:at,styles:lt,imageProps:ct,unstyled:ut}=$,dt=__objRest$v($,["className","size","src","alt","radius","children","color","variant","gradient","classNames","styles","imageProps","unstyled"]),ft=useAvatarGroupContext(),[pt,yt]=react.exports.useState(!et),{classes:mt,cx:_t}=useStyles$_({color:it,radius:rt,size:_e,withinGroup:ft.withinGroup,spacing:ft.spacing,variant:st,gradient:ot},{classNames:at,styles:lt,unstyled:ut,name:"Avatar"});return react.exports.useEffect(()=>{yt(!et)},[et]),jsx(Box,{...__spreadValues$I({component:"div",className:_t(mt.root,j),ref:a},dt),children:pt?jsx("div",{className:mt.placeholder,title:tt,children:nt||jsx(AvatarPlaceholderIcon,{className:mt.placeholderIcon})}):jsx("img",{...__spreadProps$l(__spreadValues$I({},ct),{className:mt.image,src:et,alt:tt,onError:()=>yt(!0)})})})});_Avatar.displayName="@mantine/core/Avatar";_Avatar.Group=AvatarGroup;const Avatar=_Avatar;var __defProp$H=Object.defineProperty,__defProps$k=Object.defineProperties,__getOwnPropDescs$k=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$H=Object.getOwnPropertySymbols,__hasOwnProp$H=Object.prototype.hasOwnProperty,__propIsEnum$H=Object.prototype.propertyIsEnumerable,__defNormalProp$H=(_,a,$)=>a in _?__defProp$H(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$H=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$H.call(a,$)&&__defNormalProp$H(_,$,a[$]);if(__getOwnPropSymbols$H)for(var $ of __getOwnPropSymbols$H(a))__propIsEnum$H.call(a,$)&&__defNormalProp$H(_,$,a[$]);return _},__spreadProps$k=(_,a)=>__defProps$k(_,__getOwnPropDescs$k(a));const sizes$3={xs:{fontSize:9,height:16},sm:{fontSize:10,height:18},md:{fontSize:11,height:20},lg:{fontSize:13,height:26},xl:{fontSize:16,height:32}},dotSizes={xs:4,sm:4,md:6,lg:8,xl:10};function getVariantStyles$3({theme:_,variant:a,color:$,size:j,gradient:_e}){if(a==="dot"){const tt=_.fn.size({size:j,sizes:dotSizes});return{backgroundColor:"transparent",color:_.colorScheme==="dark"?_.colors.dark[0]:_.colors.gray[7],border:`1px solid ${_.colorScheme==="dark"?_.colors.dark[3]:_.colors.gray[3]}`,paddingLeft:_.fn.size({size:j,sizes:_.spacing})/1.5-tt/2,"&::before":{content:'""',display:"block",width:tt,height:tt,borderRadius:tt,backgroundColor:_.fn.themeColor($,_.colorScheme==="dark"?4:_.fn.primaryShade("light"),!0),marginRight:tt}}}const et=_.fn.variant({color:$,variant:a,gradient:_e});return{background:et.background,color:et.color,border:`${a==="gradient"?0:1}px solid ${et.border}`}}var useStyles$X=createStyles((_,{color:a,size:$,radius:j,gradient:_e,fullWidth:et,variant:tt})=>{const{fontSize:rt,height:nt}=$ in sizes$3?sizes$3[$]:sizes$3.md;return{leftSection:{marginRight:`calc(${_.spacing.xs}px / 2)`},rightSection:{marginLeft:`calc(${_.spacing.xs}px / 2)`},inner:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},root:__spreadValues$H(__spreadProps$k(__spreadValues$H(__spreadValues$H({},_.fn.focusStyles()),_.fn.fontStyles()),{fontSize:rt,height:nt,WebkitTapHighlightColor:"transparent",lineHeight:`${nt-2}px`,textDecoration:"none",padding:`0 ${_.fn.size({size:$,sizes:_.spacing})/1.5}px`,boxSizing:"border-box",display:et?"flex":"inline-flex",alignItems:"center",justifyContent:"center",width:et?"100%":"auto",textTransform:"uppercase",borderRadius:_.fn.radius(j),fontWeight:700,letterSpacing:.25,cursor:"inherit",textOverflow:"ellipsis",overflow:"hidden"}),getVariantStyles$3({theme:_,variant:tt,color:a,size:$,gradient:_e}))}});const useStyles$Y=useStyles$X;var __defProp$G=Object.defineProperty,__getOwnPropSymbols$G=Object.getOwnPropertySymbols,__hasOwnProp$G=Object.prototype.hasOwnProperty,__propIsEnum$G=Object.prototype.propertyIsEnumerable,__defNormalProp$G=(_,a,$)=>a in _?__defProp$G(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$G=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$G.call(a,$)&&__defNormalProp$G(_,$,a[$]);if(__getOwnPropSymbols$G)for(var $ of __getOwnPropSymbols$G(a))__propIsEnum$G.call(a,$)&&__defNormalProp$G(_,$,a[$]);return _},__objRest$u=(_,a)=>{var $={};for(var j in _)__hasOwnProp$G.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$G)for(var j of __getOwnPropSymbols$G(_))a.indexOf(j)<0&&__propIsEnum$G.call(_,j)&&($[j]=_[j]);return $};const defaultProps$n={variant:"light",size:"md",radius:"xl"},_Badge=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Badge",defaultProps$n,_),{className:j,color:_e,variant:et,fullWidth:tt,children:rt,size:nt,leftSection:it,rightSection:st,radius:ot,gradient:at,classNames:lt,styles:ct,unstyled:ut}=$,dt=__objRest$u($,["className","color","variant","fullWidth","children","size","leftSection","rightSection","radius","gradient","classNames","styles","unstyled"]),{classes:ft,cx:pt}=useStyles$Y({size:nt,fullWidth:tt,color:_e,radius:ot,variant:et,gradient:at},{classNames:lt,styles:ct,name:"Badge",unstyled:ut});return jsxs(Box,{...__spreadValues$G({className:pt(ft.root,j),ref:a},dt),children:[it&&jsx("span",{className:ft.leftSection,children:it}),jsx("span",{className:ft.inner,children:rt}),st&&jsx("span",{className:ft.rightSection,children:st})]})});_Badge.displayName="@mantine/core/Badge";const Badge=_Badge;var useStyles$V=createStyles((_,{orientation:a,buttonBorderWidth:$})=>({root:{display:"flex",flexDirection:a==="vertical"?"column":"row","& [data-button]":{"&:first-of-type":{borderBottomRightRadius:0,[a==="vertical"?"borderBottomLeftRadius":"borderTopRightRadius"]:0,[a==="vertical"?"borderBottomWidth":"borderRightWidth"]:$/2},"&:last-of-type":{borderTopLeftRadius:0,[a==="vertical"?"borderTopRightRadius":"borderBottomLeftRadius"]:0,[a==="vertical"?"borderTopWidth":"borderLeftWidth"]:$/2},"&:not(:first-of-type):not(:last-of-type)":{borderRadius:0,[a==="vertical"?"borderTopWidth":"borderLeftWidth"]:$/2,[a==="vertical"?"borderBottomWidth":"borderRightWidth"]:$/2},"& + [data-button]":{[a==="vertical"?"marginTop":"marginLeft"]:-$,"@media (min-resolution: 192dpi)":{[a==="vertical"?"marginTop":"marginLeft"]:0}}}}}));const useStyles$W=useStyles$V;var __defProp$F=Object.defineProperty,__getOwnPropSymbols$F=Object.getOwnPropertySymbols,__hasOwnProp$F=Object.prototype.hasOwnProperty,__propIsEnum$F=Object.prototype.propertyIsEnumerable,__defNormalProp$F=(_,a,$)=>a in _?__defProp$F(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$F=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$F.call(a,$)&&__defNormalProp$F(_,$,a[$]);if(__getOwnPropSymbols$F)for(var $ of __getOwnPropSymbols$F(a))__propIsEnum$F.call(a,$)&&__defNormalProp$F(_,$,a[$]);return _},__objRest$t=(_,a)=>{var $={};for(var j in _)__hasOwnProp$F.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$F)for(var j of __getOwnPropSymbols$F(_))a.indexOf(j)<0&&__propIsEnum$F.call(_,j)&&($[j]=_[j]);return $};const defaultProps$m={orientation:"horizontal",buttonBorderWidth:1},ButtonGroup=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("ButtonGroup",defaultProps$m,_),{className:j,orientation:_e,buttonBorderWidth:et,unstyled:tt}=$,rt=__objRest$t($,["className","orientation","buttonBorderWidth","unstyled"]),{classes:nt,cx:it}=useStyles$W({orientation:_e,buttonBorderWidth:et},{name:"ButtonGroup",unstyled:tt});return jsx(Box,{...__spreadValues$F({className:it(nt.root,j),ref:a},rt)})});ButtonGroup.displayName="@mantine/core/ButtonGroup";var __defProp$E=Object.defineProperty,__defProps$j=Object.defineProperties,__getOwnPropDescs$j=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$E=Object.getOwnPropertySymbols,__hasOwnProp$E=Object.prototype.hasOwnProperty,__propIsEnum$E=Object.prototype.propertyIsEnumerable,__defNormalProp$E=(_,a,$)=>a in _?__defProp$E(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$E=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$E.call(a,$)&&__defNormalProp$E(_,$,a[$]);if(__getOwnPropSymbols$E)for(var $ of __getOwnPropSymbols$E(a))__propIsEnum$E.call(a,$)&&__defNormalProp$E(_,$,a[$]);return _},__spreadProps$j=(_,a)=>__defProps$j(_,__getOwnPropDescs$j(a));const sizes$2={xs:{height:sizes$5.xs,paddingLeft:14,paddingRight:14},sm:{height:sizes$5.sm,paddingLeft:18,paddingRight:18},md:{height:sizes$5.md,paddingLeft:22,paddingRight:22},lg:{height:sizes$5.lg,paddingLeft:26,paddingRight:26},xl:{height:sizes$5.xl,paddingLeft:32,paddingRight:32},"compact-xs":{height:22,paddingLeft:7,paddingRight:7},"compact-sm":{height:26,paddingLeft:8,paddingRight:8},"compact-md":{height:30,paddingLeft:10,paddingRight:10},"compact-lg":{height:34,paddingLeft:12,paddingRight:12},"compact-xl":{height:40,paddingLeft:14,paddingRight:14}};function getSizeStyles({compact:_,size:a,withLeftIcon:$,withRightIcon:j}){if(_)return sizes$2[`compact-${a}`];const _e=sizes$2[a];return __spreadProps$j(__spreadValues$E({},_e),{paddingLeft:$?_e.paddingLeft/1.5:_e.paddingLeft,paddingRight:j?_e.paddingRight/1.5:_e.paddingRight})}const getWidthStyles=_=>({display:_?"block":"inline-block",width:_?"100%":"auto"});function getVariantStyles$2({variant:_,theme:a,color:$,gradient:j}){const _e=a.fn.variant({color:$,variant:_,gradient:j});return _==="gradient"?{border:0,backgroundImage:_e.background,color:_e.color,"&:hover":a.fn.hover({backgroundSize:"200%"})}:__spreadValues$E({border:`1px solid ${_e.border}`,backgroundColor:_e.background,color:_e.color},a.fn.hover({backgroundColor:_e.hover}))}var useStyles$T=createStyles((_,{color:a,size:$,radius:j,fullWidth:_e,compact:et,gradient:tt,variant:rt,withLeftIcon:nt,withRightIcon:it})=>({root:__spreadProps$j(__spreadValues$E(__spreadProps$j(__spreadValues$E(__spreadValues$E(__spreadValues$E(__spreadValues$E({},getSizeStyles({compact:et,size:$,withLeftIcon:nt,withRightIcon:it})),_.fn.fontStyles()),_.fn.focusStyles()),getWidthStyles(_e)),{borderRadius:_.fn.radius(j),fontWeight:600,position:"relative",lineHeight:1,fontSize:_.fn.size({size:$,sizes:_.fontSizes}),userSelect:"none",cursor:"pointer"}),getVariantStyles$2({variant:rt,theme:_,color:a,gradient:tt})),{"&:active":_.activeStyles,"&:disabled, &[data-disabled]":{borderColor:"transparent",backgroundColor:_.colorScheme==="dark"?_.colors.dark[4]:_.colors.gray[2],color:_.colorScheme==="dark"?_.colors.dark[6]:_.colors.gray[5],cursor:"not-allowed",backgroundImage:"none",pointerEvents:"none","&:active":{transform:"none"}},"&[data-loading]":{pointerEvents:"none","&::before":{content:'""',position:"absolute",top:-1,left:-1,right:-1,bottom:-1,backgroundColor:_.colorScheme==="dark"?_.fn.rgba(_.colors.dark[7],.5):"rgba(255, 255, 255, .5)",borderRadius:_.fn.radius(j),cursor:"not-allowed"}}}),icon:{display:"flex",alignItems:"center"},leftIcon:{marginRight:10},rightIcon:{marginLeft:10},inner:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",overflow:"visible"},label:{whiteSpace:"nowrap",height:"100%",overflow:"hidden",display:"flex",alignItems:"center"}}));const useStyles$U=useStyles$T;var __defProp$D=Object.defineProperty,__getOwnPropSymbols$D=Object.getOwnPropertySymbols,__hasOwnProp$D=Object.prototype.hasOwnProperty,__propIsEnum$D=Object.prototype.propertyIsEnumerable,__defNormalProp$D=(_,a,$)=>a in _?__defProp$D(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$D=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$D.call(a,$)&&__defNormalProp$D(_,$,a[$]);if(__getOwnPropSymbols$D)for(var $ of __getOwnPropSymbols$D(a))__propIsEnum$D.call(a,$)&&__defNormalProp$D(_,$,a[$]);return _},__objRest$s=(_,a)=>{var $={};for(var j in _)__hasOwnProp$D.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$D)for(var j of __getOwnPropSymbols$D(_))a.indexOf(j)<0&&__propIsEnum$D.call(_,j)&&($[j]=_[j]);return $};const defaultProps$l={size:"sm",type:"button",variant:"filled",loaderPosition:"left"},_Button=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Button",defaultProps$l,_),{className:j,size:_e,color:et,type:tt,disabled:rt,children:nt,leftIcon:it,rightIcon:st,fullWidth:ot,variant:at,radius:lt,uppercase:ct,compact:ut,loading:dt,loaderPosition:ft,loaderProps:pt,gradient:yt,classNames:mt,styles:_t,unstyled:vt}=$,ht=__objRest$s($,["className","size","color","type","disabled","children","leftIcon","rightIcon","fullWidth","variant","radius","uppercase","compact","loading","loaderPosition","loaderProps","gradient","classNames","styles","unstyled"]),{classes:St,cx:It,theme:Lt}=useStyles$U({radius:lt,color:et,size:_e,fullWidth:ot,compact:ut,gradient:yt,variant:at,withLeftIcon:!!it,withRightIcon:!!st},{name:"Button",unstyled:vt,classNames:mt,styles:_t}),Mt=Lt.fn.variant({color:et,variant:at}),Kt=jsx(Loader,{...__spreadValues$D({color:Mt.color,size:Lt.fn.size({size:_e,sizes:sizes$2}).height/2},pt)});return jsx(UnstyledButton,{...__spreadValues$D({className:It(St.root,j),type:tt,disabled:rt,"data-button":!0,"data-disabled":rt||void 0,"data-loading":dt||void 0,ref:a,unstyled:vt},ht),children:jsxs("div",{className:St.inner,children:[(it||dt&&ft==="left")&&jsx("span",{className:It(St.icon,St.leftIcon),children:dt&&ft==="left"?Kt:it}),jsx("span",{className:St.label,style:{textTransform:ct?"uppercase":void 0},children:nt}),(st||dt&&ft==="right")&&jsx("span",{className:It(St.icon,St.rightIcon),children:dt&&ft==="right"?Kt:st})]})})});_Button.displayName="@mantine/core/Button";_Button.Group=ButtonGroup;const Button=_Button;var useStyles$R=createStyles((_,{radius:a,shadow:$,withBorder:j})=>({root:{outline:0,WebkitTapHighlightColor:"transparent",display:"block",textDecoration:"none",color:_.colorScheme==="dark"?_.colors.dark[0]:_.black,backgroundColor:_.colorScheme==="dark"?_.colors.dark[7]:_.white,boxSizing:"border-box",borderRadius:_.fn.radius(a),boxShadow:_.shadows[$]||$||"none",border:j?`1px solid ${_.colorScheme==="dark"?_.colors.dark[4]:_.colors.gray[3]}`:void 0}}));const useStyles$S=useStyles$R;var __defProp$C=Object.defineProperty,__getOwnPropSymbols$C=Object.getOwnPropertySymbols,__hasOwnProp$C=Object.prototype.hasOwnProperty,__propIsEnum$C=Object.prototype.propertyIsEnumerable,__defNormalProp$C=(_,a,$)=>a in _?__defProp$C(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$C=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$C.call(a,$)&&__defNormalProp$C(_,$,a[$]);if(__getOwnPropSymbols$C)for(var $ of __getOwnPropSymbols$C(a))__propIsEnum$C.call(a,$)&&__defNormalProp$C(_,$,a[$]);return _},__objRest$r=(_,a)=>{var $={};for(var j in _)__hasOwnProp$C.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$C)for(var j of __getOwnPropSymbols$C(_))a.indexOf(j)<0&&__propIsEnum$C.call(_,j)&&($[j]=_[j]);return $};const defaultProps$k={},_Paper=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Paper",defaultProps$k,_),{className:j,children:_e,radius:et,withBorder:tt,shadow:rt,unstyled:nt}=$,it=__objRest$r($,["className","children","radius","withBorder","shadow","unstyled"]),{classes:st,cx:ot}=useStyles$S({radius:et,shadow:rt,withBorder:tt},{name:"Paper",unstyled:nt});return jsx(Box,{...__spreadValues$C({className:ot(st.root,j),ref:a},it),children:_e})});_Paper.displayName="@mantine/core/Paper";const Paper=_Paper,CardContext=react.exports.createContext({padding:0}),CardProvider=CardContext.Provider,useCardPadding=()=>react.exports.useContext(CardContext).padding;var useStyles$P=createStyles((_,{padding:a,withBorder:$,inheritPadding:j})=>{const _e=_.fn.size({size:a,sizes:_.spacing}),et=-1*_e,tt=_.colorScheme==="dark"?_.colors.dark[4]:_.colors.gray[3];return{cardSection:{display:"block",marginLeft:et,marginRight:et,paddingLeft:j?_e:void 0,paddingRight:j?_e:void 0,borderTop:$&&`1px solid ${tt}`,borderBottom:$&&`1px solid ${tt}`,"& + &":{borderTop:0},"&[data-first]":{marginTop:et,borderTop:0,borderBottom:$&&`1px solid ${tt}`},"&[data-last]":{marginBottom:et,borderBottom:0}}}});const useStyles$Q=useStyles$P;var __defProp$B=Object.defineProperty,__getOwnPropSymbols$B=Object.getOwnPropertySymbols,__hasOwnProp$B=Object.prototype.hasOwnProperty,__propIsEnum$B=Object.prototype.propertyIsEnumerable,__defNormalProp$B=(_,a,$)=>a in _?__defProp$B(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$B=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$B.call(a,$)&&__defNormalProp$B(_,$,a[$]);if(__getOwnPropSymbols$B)for(var $ of __getOwnPropSymbols$B(a))__propIsEnum$B.call(a,$)&&__defNormalProp$B(_,$,a[$]);return _},__objRest$q=(_,a)=>{var $={};for(var j in _)__hasOwnProp$B.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$B)for(var j of __getOwnPropSymbols$B(_))a.indexOf(j)<0&&__propIsEnum$B.call(_,j)&&($[j]=_[j]);return $};const _CardSection=react.exports.forwardRef((_,a)=>{var $=_,{className:j,withBorder:_e=!1,inheritPadding:et=!1,unstyled:tt}=$,rt=__objRest$q($,["className","withBorder","inheritPadding","unstyled"]);const{classes:nt,cx:it}=useStyles$Q({padding:useCardPadding(),withBorder:_e,inheritPadding:et},{name:"Card",unstyled:tt});return jsx(Box,{...__spreadValues$B({className:it(nt.cardSection,j),ref:a},rt)})});_CardSection.displayName="@mantine/core/CardSection";const CardSection=_CardSection;var useStyles$N=createStyles(_=>({root:{position:"relative",overflow:"hidden",backgroundColor:_.colorScheme==="dark"?_.colors.dark[6]:_.white}}));const useStyles$O=useStyles$N;var __defProp$A=Object.defineProperty,__getOwnPropSymbols$A=Object.getOwnPropertySymbols,__hasOwnProp$A=Object.prototype.hasOwnProperty,__propIsEnum$A=Object.prototype.propertyIsEnumerable,__defNormalProp$A=(_,a,$)=>a in _?__defProp$A(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$A=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$A.call(a,$)&&__defNormalProp$A(_,$,a[$]);if(__getOwnPropSymbols$A)for(var $ of __getOwnPropSymbols$A(a))__propIsEnum$A.call(a,$)&&__defNormalProp$A(_,$,a[$]);return _},__objRest$p=(_,a)=>{var $={};for(var j in _)__hasOwnProp$A.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$A)for(var j of __getOwnPropSymbols$A(_))a.indexOf(j)<0&&__propIsEnum$A.call(_,j)&&($[j]=_[j]);return $};const defaultProps$j={p:"md"},_Card=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Card",defaultProps$j,_),{className:j,p:_e,radius:et,children:tt,unstyled:rt}=$,nt=__objRest$p($,["className","p","radius","children","unstyled"]),{classes:it,cx:st}=useStyles$O(null,{name:"Card",unstyled:rt}),ot=react.exports.Children.toArray(tt),at=ot.map((lt,ct)=>typeof lt=="object"&&lt&&"type"in lt&&lt.type===CardSection?react.exports.cloneElement(lt,{padding:_e,"data-first":ct===0||void 0,"data-last":ct===ot.length-1||void 0}):lt);return jsx(CardProvider,{value:{padding:_e},children:jsx(Paper,{...__spreadValues$A({className:st(it.root,j),radius:et,p:_e,ref:a},nt),children:at})})});_Card.Section=CardSection;_Card.displayName="@mantine/core/Card";const Card=_Card;var __defProp$z=Object.defineProperty,__getOwnPropSymbols$z=Object.getOwnPropertySymbols,__hasOwnProp$z=Object.prototype.hasOwnProperty,__propIsEnum$z=Object.prototype.propertyIsEnumerable,__defNormalProp$z=(_,a,$)=>a in _?__defProp$z(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$z=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$z.call(a,$)&&__defNormalProp$z(_,$,a[$]);if(__getOwnPropSymbols$z)for(var $ of __getOwnPropSymbols$z(a))__propIsEnum$z.call(a,$)&&__defNormalProp$z(_,$,a[$]);return _},__objRest$o=(_,a)=>{var $={};for(var j in _)__hasOwnProp$z.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$z)for(var j of __getOwnPropSymbols$z(_))a.indexOf(j)<0&&__propIsEnum$z.call(_,j)&&($[j]=_[j]);return $};const _Center=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Center",{},_),{inline:j,sx:_e}=$,et=__objRest$o($,["inline","sx"]);return jsx(Box,{...__spreadValues$z({ref:a,sx:[{display:j?"inline-flex":"flex",alignItems:"center",justifyContent:"center"},...packSx(_e)]},et)})});_Center.displayName="@mantine/core/Center";const Center=_Center;function filterFalsyChildren(_){return react.exports.Children.toArray(_).filter(Boolean)}const GROUP_POSITIONS={left:"flex-start",center:"center",right:"flex-end",apart:"space-between"};var useStyles$L=createStyles((_,{spacing:a,position:$,noWrap:j,grow:_e,align:et,count:tt})=>({root:{boxSizing:"border-box",display:"flex",flexDirection:"row",alignItems:et||"center",flexWrap:j?"nowrap":"wrap",justifyContent:GROUP_POSITIONS[$],gap:_.fn.size({size:a,sizes:_.spacing}),"& > *":{boxSizing:"border-box",maxWidth:_e?`calc(${100/tt}% - ${_.fn.size({size:a,sizes:_.spacing})-_.fn.size({size:a,sizes:_.spacing})/tt}px)`:void 0,flexGrow:_e?1:0}}}));const useStyles$M=useStyles$L;var __defProp$y=Object.defineProperty,__getOwnPropSymbols$y=Object.getOwnPropertySymbols,__hasOwnProp$y=Object.prototype.hasOwnProperty,__propIsEnum$y=Object.prototype.propertyIsEnumerable,__defNormalProp$y=(_,a,$)=>a in _?__defProp$y(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$y=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$y.call(a,$)&&__defNormalProp$y(_,$,a[$]);if(__getOwnPropSymbols$y)for(var $ of __getOwnPropSymbols$y(a))__propIsEnum$y.call(a,$)&&__defNormalProp$y(_,$,a[$]);return _},__objRest$n=(_,a)=>{var $={};for(var j in _)__hasOwnProp$y.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$y)for(var j of __getOwnPropSymbols$y(_))a.indexOf(j)<0&&__propIsEnum$y.call(_,j)&&($[j]=_[j]);return $};const defaultProps$i={position:"left",spacing:"md"},Group=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Group",defaultProps$i,_),{className:j,position:_e,align:et,children:tt,noWrap:rt,grow:nt,spacing:it,unstyled:st}=$,ot=__objRest$n($,["className","position","align","children","noWrap","grow","spacing","unstyled"]),at=filterFalsyChildren(tt),{classes:lt,cx:ct}=useStyles$M({align:et,grow:nt,noWrap:rt,spacing:it,position:_e,count:at.length},{unstyled:st,name:"Group"});return jsx(Box,{...__spreadValues$y({className:ct(lt.root,j),ref:a},ot),children:at})});Group.displayName="@mantine/core/Group";var useStyles$J=createStyles((_,{spacing:a,align:$,justify:j})=>({root:{display:"flex",flexDirection:"column",alignItems:$,justifyContent:j,gap:_.fn.size({size:a,sizes:_.spacing})}}));const useStyles$K=useStyles$J;var __defProp$x=Object.defineProperty,__getOwnPropSymbols$x=Object.getOwnPropertySymbols,__hasOwnProp$x=Object.prototype.hasOwnProperty,__propIsEnum$x=Object.prototype.propertyIsEnumerable,__defNormalProp$x=(_,a,$)=>a in _?__defProp$x(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$x=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$x.call(a,$)&&__defNormalProp$x(_,$,a[$]);if(__getOwnPropSymbols$x)for(var $ of __getOwnPropSymbols$x(a))__propIsEnum$x.call(a,$)&&__defNormalProp$x(_,$,a[$]);return _},__objRest$m=(_,a)=>{var $={};for(var j in _)__hasOwnProp$x.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$x)for(var j of __getOwnPropSymbols$x(_))a.indexOf(j)<0&&__propIsEnum$x.call(_,j)&&($[j]=_[j]);return $};const defaultProps$h={spacing:"md",align:"stretch",justify:"top"},Stack=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Stack",defaultProps$h,_),{spacing:j,className:_e,align:et,justify:tt,unstyled:rt}=$,nt=__objRest$m($,["spacing","className","align","justify","unstyled"]),{classes:it,cx:st}=useStyles$K({spacing:j,align:et,justify:tt},{name:"Stack",unstyled:rt});return jsx(Box,{...__spreadValues$x({className:st(it.root,_e),ref:a},nt)})});Stack.displayName="@mantine/core/Stack";function InputsGroup({spacing:_,offset:a,orientation:$,children:j,role:_e,unstyled:et}){return $==="horizontal"?jsx(Group,{pt:a,spacing:_,role:_e,unstyled:et,children:j}):jsx(Stack,{pt:a,spacing:_,role:_e,unstyled:et,children:j})}var __defProp$w=Object.defineProperty,__defProps$i=Object.defineProperties,__getOwnPropDescs$i=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$w=Object.getOwnPropertySymbols,__hasOwnProp$w=Object.prototype.hasOwnProperty,__propIsEnum$w=Object.prototype.propertyIsEnumerable,__defNormalProp$w=(_,a,$)=>a in _?__defProp$w(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$w=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$w.call(a,$)&&__defNormalProp$w(_,$,a[$]);if(__getOwnPropSymbols$w)for(var $ of __getOwnPropSymbols$w(a))__propIsEnum$w.call(a,$)&&__defNormalProp$w(_,$,a[$]);return _},__spreadProps$i=(_,a)=>__defProps$i(_,__getOwnPropDescs$i(a));const sizes$1={xs:16,sm:20,md:24,lg:30,xl:36};var useStyles$H=createStyles((_,{labelPosition:a,size:$})=>({root:{},body:{display:"inline-flex"},labelWrapper:__spreadProps$i(__spreadValues$w({},_.fn.fontStyles()),{WebkitTapHighlightColor:"transparent",fontSize:_.fn.size({size:$,sizes:_.fontSizes}),lineHeight:`${_.fn.size({size:$,sizes:sizes$1})}px`,color:_.colorScheme==="dark"?_.colors.dark[0]:_.black,cursor:_.cursorType,order:a==="left"?1:2}),description:{marginTop:`calc(${_.spacing.xs}px / 2)`,[a==="left"?"paddingRight":"paddingLeft"]:_.spacing.sm},error:{marginTop:`calc(${_.spacing.xs}px / 2)`,[a==="left"?"paddingRight":"paddingLeft"]:_.spacing.sm},label:{cursor:_.cursorType,[a==="left"?"paddingRight":"paddingLeft"]:_.spacing.sm,"&[data-disabled]":{color:_.colorScheme==="dark"?_.colors.dark[3]:_.colors.gray[5]}}}));const useStyles$I=useStyles$H;var __defProp$v=Object.defineProperty,__getOwnPropSymbols$v=Object.getOwnPropertySymbols,__hasOwnProp$v=Object.prototype.hasOwnProperty,__propIsEnum$v=Object.prototype.propertyIsEnumerable,__defNormalProp$v=(_,a,$)=>a in _?__defProp$v(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$v=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$v.call(a,$)&&__defNormalProp$v(_,$,a[$]);if(__getOwnPropSymbols$v)for(var $ of __getOwnPropSymbols$v(a))__propIsEnum$v.call(a,$)&&__defNormalProp$v(_,$,a[$]);return _},__objRest$l=(_,a)=>{var $={};for(var j in _)__hasOwnProp$v.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$v)for(var j of __getOwnPropSymbols$v(_))a.indexOf(j)<0&&__propIsEnum$v.call(_,j)&&($[j]=_[j]);return $};function InlineInput(_){var a=_,{__staticSelector:$,className:j,classNames:_e,styles:et,unstyled:tt,children:rt,label:nt,description:it,id:st,disabled:ot,error:at,size:lt,labelPosition:ct}=a,ut=__objRest$l(a,["__staticSelector","className","classNames","styles","unstyled","children","label","description","id","disabled","error","size","labelPosition"]);const{classes:dt,cx:ft}=useStyles$I({size:lt,labelPosition:ct},{name:$,styles:et,classNames:_e,unstyled:tt});return jsx(Box,{...__spreadValues$v({className:ft(dt.root,j)},ut),children:jsxs("div",{className:ft(dt.body),children:[rt,jsxs("div",{className:dt.labelWrapper,children:[nt&&jsx("label",{className:dt.label,"data-disabled":ot||void 0,htmlFor:st,children:nt}),it&&jsx(Input.Description,{className:dt.description,children:it}),at&&at!=="boolean"&&jsx(Input.Error,{className:dt.error,children:at})]})]})})}InlineInput.displayName="@mantine/core/InlineInput";var useStyles$F=createStyles((_,{fluid:a,size:$,sizes:j})=>({root:{paddingLeft:_.spacing.md,paddingRight:_.spacing.md,maxWidth:a?"100%":_.fn.size({size:$,sizes:j}),marginLeft:"auto",marginRight:"auto"}}));const useStyles$G=useStyles$F;var __defProp$u=Object.defineProperty,__getOwnPropSymbols$u=Object.getOwnPropertySymbols,__hasOwnProp$u=Object.prototype.hasOwnProperty,__propIsEnum$u=Object.prototype.propertyIsEnumerable,__defNormalProp$u=(_,a,$)=>a in _?__defProp$u(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$u=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$u.call(a,$)&&__defNormalProp$u(_,$,a[$]);if(__getOwnPropSymbols$u)for(var $ of __getOwnPropSymbols$u(a))__propIsEnum$u.call(a,$)&&__defNormalProp$u(_,$,a[$]);return _},__objRest$k=(_,a)=>{var $={};for(var j in _)__hasOwnProp$u.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$u)for(var j of __getOwnPropSymbols$u(_))a.indexOf(j)<0&&__propIsEnum$u.call(_,j)&&($[j]=_[j]);return $};const defaultProps$g={sizes:{xs:540,sm:720,md:960,lg:1140,xl:1320}},Container=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Container",defaultProps$g,_),{className:j,fluid:_e,size:et,unstyled:tt,sizes:rt}=$,nt=__objRest$k($,["className","fluid","size","unstyled","sizes"]),{classes:it,cx:st}=useStyles$G({fluid:_e,size:et,sizes:rt},{unstyled:tt,name:"Container"});return jsx(Box,{...__spreadValues$u({className:st(it.root,j),ref:a},nt)})});Container.displayName="@mantine/core/Container";function GroupedTransition({transitions:_,duration:a=250,exitDuration:$=a,mounted:j,children:_e,timingFunction:et,onExit:tt,onEntered:rt,onEnter:nt,onExited:it}){const{transitionDuration:st,transitionStatus:ot,transitionTimingFunction:at}=useTransition({mounted:j,duration:a,exitDuration:$,timingFunction:et,onExit:tt,onEntered:rt,onEnter:nt,onExited:it});if(st===0)return j?jsx(Fragment$1,{children:_e({})}):null;if(ot==="exited")return null;const lt=Object.keys(_).reduce((ct,ut)=>(ct[ut]=getTransitionStyles({duration:_[ut].duration,transition:_[ut].transition,timingFunction:_[ut].timingFunction||at,state:ot}),ct),{});return jsx(Fragment$1,{children:_e(lt)})}GroupedTransition.displayName="@mantine/core/GroupedTransition";var useStyles$D=createStyles((_,{zIndex:a})=>({root:{position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:a}}));const useStyles$E=useStyles$D;var __defProp$t=Object.defineProperty,__defProps$h=Object.defineProperties,__getOwnPropDescs$h=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$t=Object.getOwnPropertySymbols,__hasOwnProp$t=Object.prototype.hasOwnProperty,__propIsEnum$t=Object.prototype.propertyIsEnumerable,__defNormalProp$t=(_,a,$)=>a in _?__defProp$t(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$t=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$t.call(a,$)&&__defNormalProp$t(_,$,a[$]);if(__getOwnPropSymbols$t)for(var $ of __getOwnPropSymbols$t(a))__propIsEnum$t.call(a,$)&&__defNormalProp$t(_,$,a[$]);return _},__spreadProps$h=(_,a)=>__defProps$h(_,__getOwnPropDescs$h(a)),__objRest$j=(_,a)=>{var $={};for(var j in _)__hasOwnProp$t.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$t)for(var j of __getOwnPropSymbols$t(_))a.indexOf(j)<0&&__propIsEnum$t.call(_,j)&&($[j]=_[j]);return $};const defaultProps$f={opacity:.6,color:"#fff",zIndex:getDefaultZIndex("modal"),radius:0,blur:0},_Overlay=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Overlay",defaultProps$f,_),{opacity:j,blur:_e,color:et,gradient:tt,zIndex:rt,radius:nt,sx:it,unstyled:st,className:ot}=$,at=__objRest$j($,["opacity","blur","color","gradient","zIndex","radius","sx","unstyled","className"]),{classes:lt,cx:ct}=useStyles$E({zIndex:rt},{name:"Overlay",unstyled:st}),ut=tt?{backgroundImage:tt}:{backgroundColor:et},dt=ft=>jsx(Box,{...__spreadValues$t({ref:a,className:ct(lt.root,ot),sx:[pt=>__spreadProps$h(__spreadValues$t({},ut),{opacity:j,borderRadius:pt.fn.size({size:nt,sizes:pt.radius})}),...packSx(it)]},ft)});return _e?jsx(Box,{...__spreadValues$t({className:ct(lt.root,ot),sx:[{backdropFilter:`blur(${_e}px)`},...packSx(it)]},at),children:dt()}):dt(at)});_Overlay.displayName="@mantine/core/Overlay";const Overlay=_Overlay;var __defProp$s=Object.defineProperty,__getOwnPropSymbols$s=Object.getOwnPropertySymbols,__hasOwnProp$s=Object.prototype.hasOwnProperty,__propIsEnum$s=Object.prototype.propertyIsEnumerable,__defNormalProp$s=(_,a,$)=>a in _?__defProp$s(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$s=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$s.call(a,$)&&__defNormalProp$s(_,$,a[$]);if(__getOwnPropSymbols$s)for(var $ of __getOwnPropSymbols$s(a))__propIsEnum$s.call(a,$)&&__defNormalProp$s(_,$,a[$]);return _},__objRest$i=(_,a)=>{var $={};for(var j in _)__hasOwnProp$s.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$s)for(var j of __getOwnPropSymbols$s(_))a.indexOf(j)<0&&__propIsEnum$s.call(_,j)&&($[j]=_[j]);return $};const defaultProps$e={multiple:!1},FileButton=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("FileButton",defaultProps$e,_),{onChange:j,children:_e,multiple:et,accept:tt,name:rt,form:nt,resetRef:it,disabled:st}=$,ot=__objRest$i($,["onChange","children","multiple","accept","name","form","resetRef","disabled"]),at=react.exports.useRef(),lt=()=>{!st&&at.current.click()},ct=dt=>{j(et?Array.from(dt.currentTarget.files):dt.currentTarget.files[0]||null)};return assignRef(it,()=>{at.current.value=""}),jsxs(Fragment$1,{children:[_e(__spreadValues$s({onClick:lt},ot)),jsx("input",{style:{display:"none"},type:"file",accept:tt,multiple:et,onChange:ct,ref:useMergedRef(a,at),name:rt,form:nt})]})});FileButton.displayName="@mantine/core/FileButton";var useStyles$B=createStyles(_=>({placeholder:{color:_.colorScheme==="dark"?_.colors.dark[3]:_.colors.gray[5]},input:{cursor:"pointer"}}));const useStyles$C=useStyles$B;var __defProp$r=Object.defineProperty,__defProps$g=Object.defineProperties,__getOwnPropDescs$g=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$r=Object.getOwnPropertySymbols,__hasOwnProp$r=Object.prototype.hasOwnProperty,__propIsEnum$r=Object.prototype.propertyIsEnumerable,__defNormalProp$r=(_,a,$)=>a in _?__defProp$r(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$r=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$r.call(a,$)&&__defNormalProp$r(_,$,a[$]);if(__getOwnPropSymbols$r)for(var $ of __getOwnPropSymbols$r(a))__propIsEnum$r.call(a,$)&&__defNormalProp$r(_,$,a[$]);return _},__spreadProps$g=(_,a)=>__defProps$g(_,__getOwnPropDescs$g(a)),__objRest$h=(_,a)=>{var $={};for(var j in _)__hasOwnProp$r.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$r)for(var j of __getOwnPropSymbols$r(_))a.indexOf(j)<0&&__propIsEnum$r.call(_,j)&&($[j]=_[j]);return $};const DefaultValue=({value:_})=>jsx("span",{children:Array.isArray(_)?_.map(a=>a.name).join(", "):_?.name}),defaultProps$d={size:"sm",valueComponent:DefaultValue,clearButtonTabIndex:0},RIGHT_SECTION_WIDTH={xs:24,sm:30,md:34,lg:40,xl:44},_FileInput=react.exports.forwardRef((_,a)=>{const $=useInputProps("FileInput",defaultProps$d,_),{inputProps:j,wrapperProps:_e,placeholder:et,value:tt,defaultValue:rt,onChange:nt,multiple:it,accept:st,name:ot,form:at,classNames:lt,styles:ct,unstyled:ut,valueComponent:dt,rightSection:ft,rightSectionWidth:pt,clearable:yt,clearButtonLabel:mt,clearButtonTabIndex:_t,readOnly:vt}=$,ht=__objRest$h($,["inputProps","wrapperProps","placeholder","value","defaultValue","onChange","multiple","accept","name","form","classNames","styles","unstyled","valueComponent","rightSection","rightSectionWidth","clearable","clearButtonLabel","clearButtonTabIndex","readOnly"]),St=react.exports.useRef(),{classes:It,theme:Lt,cx:Mt}=useStyles$C(null,{name:"FileInput",classNames:lt,styles:ct,unstyled:ut}),[Kt,kt]=useUncontrolled({value:tt,defaultValue:rt,onChange:nt,finalValue:it?[]:null}),gt=Array.isArray(Kt)?Kt.length!==0:Kt!==null,Et=ft||(yt&&gt&&!vt?jsx(CloseButton,{variant:"transparent","aria-label":mt,onClick:()=>kt(it?[]:null),size:j.size,tabIndex:_t,unstyled:ut}):null);return react.exports.useEffect(()=>{(Array.isArray(Kt)&&Kt.length===0||Kt===null)&&St.current()},[Kt]),jsx(Input.Wrapper,{...__spreadProps$g(__spreadValues$r({},_e),{__staticSelector:"FileInput"}),children:jsx(FileButton,{onChange:kt,multiple:it,accept:st,name:ot,form:at,resetRef:St,disabled:vt,children:xt=>jsx(Input,{...__spreadProps$g(__spreadValues$r(__spreadValues$r(__spreadValues$r({multiline:!0},xt),j),ht),{component:"button",type:"button",ref:a,__staticSelector:"FileInput",rightSection:Et,rightSectionWidth:pt||Lt.fn.size({size:j.size,sizes:RIGHT_SECTION_WIDTH}),classNames:__spreadProps$g(__spreadValues$r({},lt),{input:Mt(It.input,lt?.input)})}),children:gt?jsx(dt,{value:Kt}):jsx("span",{className:It.placeholder,children:et})})})})});_FileInput.displayName="@mantine/core/FileInput";const FileInput=_FileInput;var __defProp$q=Object.defineProperty,__getOwnPropSymbols$q=Object.getOwnPropertySymbols,__hasOwnProp$q=Object.prototype.hasOwnProperty,__propIsEnum$q=Object.prototype.propertyIsEnumerable,__defNormalProp$q=(_,a,$)=>a in _?__defProp$q(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$q=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$q.call(a,$)&&__defNormalProp$q(_,$,a[$]);if(__getOwnPropSymbols$q)for(var $ of __getOwnPropSymbols$q(a))__propIsEnum$q.call(a,$)&&__defNormalProp$q(_,$,a[$]);return _};function ImageIcon(_){return jsx("svg",{...__spreadValues$q({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_),children:jsx("path",{d:"M2.5 1H12.5C13.3284 1 14 1.67157 14 2.5V12.5C14 13.3284 13.3284 14 12.5 14H2.5C1.67157 14 1 13.3284 1 12.5V2.5C1 1.67157 1.67157 1 2.5 1ZM2.5 2C2.22386 2 2 2.22386 2 2.5V8.3636L3.6818 6.6818C3.76809 6.59551 3.88572 6.54797 4.00774 6.55007C4.12975 6.55216 4.24568 6.60372 4.32895 6.69293L7.87355 10.4901L10.6818 7.6818C10.8575 7.50607 11.1425 7.50607 11.3182 7.6818L13 9.3636V2.5C13 2.22386 12.7761 2 12.5 2H2.5ZM2 12.5V9.6364L3.98887 7.64753L7.5311 11.4421L8.94113 13H2.5C2.22386 13 2 12.7761 2 12.5ZM12.5 13H10.155L8.48336 11.153L11 8.6364L13 10.6364V12.5C13 12.7761 12.7761 13 12.5 13ZM6.64922 5.5C6.64922 5.03013 7.03013 4.64922 7.5 4.64922C7.96987 4.64922 8.35078 5.03013 8.35078 5.5C8.35078 5.96987 7.96987 6.35078 7.5 6.35078C7.03013 6.35078 6.64922 5.96987 6.64922 5.5ZM7.5 3.74922C6.53307 3.74922 5.74922 4.53307 5.74922 5.5C5.74922 6.46693 6.53307 7.25078 7.5 7.25078C8.46693 7.25078 9.25078 6.46693 9.25078 5.5C9.25078 4.53307 8.46693 3.74922 7.5 3.74922Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}var __defProp$p=Object.defineProperty,__defProps$f=Object.defineProperties,__getOwnPropDescs$f=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$p=Object.getOwnPropertySymbols,__hasOwnProp$p=Object.prototype.hasOwnProperty,__propIsEnum$p=Object.prototype.propertyIsEnumerable,__defNormalProp$p=(_,a,$)=>a in _?__defProp$p(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$p=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$p.call(a,$)&&__defNormalProp$p(_,$,a[$]);if(__getOwnPropSymbols$p)for(var $ of __getOwnPropSymbols$p(a))__propIsEnum$p.call(a,$)&&__defNormalProp$p(_,$,a[$]);return _},__spreadProps$f=(_,a)=>__defProps$f(_,__getOwnPropDescs$f(a)),useStyles$z=createStyles((_,{radius:a})=>({root:{},imageWrapper:{position:"relative"},figure:{margin:0},image:__spreadProps$f(__spreadValues$p({},_.fn.fontStyles()),{display:"block",width:"100%",height:"100%",border:0,borderRadius:_.fn.size({size:a,sizes:_.radius})}),caption:{color:_.colorScheme==="dark"?_.colors.dark[2]:_.colors.gray[7],marginTop:_.spacing.xs},placeholder:__spreadProps$f(__spreadValues$p({},_.fn.cover()),{display:"flex",alignItems:"center",justifyContent:"center",color:_.colorScheme==="dark"?_.colors.dark[2]:_.colors.gray[6],backgroundColor:_.colorScheme==="dark"?_.colors.dark[8]:_.colors.gray[0],borderRadius:_.fn.size({size:a,sizes:_.radius})})}));const useStyles$A=useStyles$z;var __defProp$o=Object.defineProperty,__getOwnPropSymbols$o=Object.getOwnPropertySymbols,__hasOwnProp$o=Object.prototype.hasOwnProperty,__propIsEnum$o=Object.prototype.propertyIsEnumerable,__defNormalProp$o=(_,a,$)=>a in _?__defProp$o(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$o=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$o.call(a,$)&&__defNormalProp$o(_,$,a[$]);if(__getOwnPropSymbols$o)for(var $ of __getOwnPropSymbols$o(a))__propIsEnum$o.call(a,$)&&__defNormalProp$o(_,$,a[$]);return _},__objRest$g=(_,a)=>{var $={};for(var j in _)__hasOwnProp$o.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$o)for(var j of __getOwnPropSymbols$o(_))a.indexOf(j)<0&&__propIsEnum$o.call(_,j)&&($[j]=_[j]);return $};const defaultProps$c={fit:"cover",width:"100%",height:"auto",radius:0},Image=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Image",defaultProps$c,_),{className:j,alt:_e,src:et,fit:tt,width:rt,height:nt,radius:it,imageProps:st,withPlaceholder:ot,placeholder:at,imageRef:lt,classNames:ct,styles:ut,caption:dt,unstyled:ft,style:pt}=$,yt=__objRest$g($,["className","alt","src","fit","width","height","radius","imageProps","withPlaceholder","placeholder","imageRef","classNames","styles","caption","unstyled","style"]),{classes:mt,cx:_t}=useStyles$A({radius:it},{classNames:ct,styles:ut,unstyled:ft,name:"Image"}),[vt,ht]=react.exports.useState(!!et),[St,It]=react.exports.useState(!et),Lt=ot&&(!vt||St);return useDidUpdate(()=>{ht(!1),It(!1)},[et]),jsx(Box,{...__spreadValues$o({className:_t(mt.root,j),ref:a,style:__spreadValues$o({width:rt},pt)},yt),children:jsxs("figure",{className:mt.figure,children:[jsxs("div",{className:mt.imageWrapper,children:[jsx("img",{...__spreadValues$o({className:mt.image,src:et,alt:_e,style:{objectFit:tt,width:rt,height:nt},ref:lt,onLoad:Mt=>{ht(!0),typeof st?.onLoad=="function"&&st.onLoad(Mt)},onError:Mt=>{It(!0),typeof st?.onError=="function"&&st.onError(Mt)}},st)}),Lt&&jsx("div",{className:mt.placeholder,title:_e,children:at||jsx("div",{children:jsx(ImageIcon,{style:{width:40,height:40}})})})]}),!!dt&&jsx(Text,{component:"figcaption",size:"sm",align:"center",className:mt.caption,children:dt})]})})});Image.displayName="@mantine/core/Image";var __defProp$n=Object.defineProperty,__defProps$e=Object.defineProperties,__getOwnPropDescs$e=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$n=Object.getOwnPropertySymbols,__hasOwnProp$n=Object.prototype.hasOwnProperty,__propIsEnum$n=Object.prototype.propertyIsEnumerable,__defNormalProp$n=(_,a,$)=>a in _?__defProp$n(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$n=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$n.call(a,$)&&__defNormalProp$n(_,$,a[$]);if(__getOwnPropSymbols$n)for(var $ of __getOwnPropSymbols$n(a))__propIsEnum$n.call(a,$)&&__defNormalProp$n(_,$,a[$]);return _},__spreadProps$e=(_,a)=>__defProps$e(_,__getOwnPropDescs$e(a));const processingAnimation=_=>keyframes({from:{boxShadow:`0 0 0.5px 0 ${_}`,opacity:.6},to:{boxShadow:`0 0 0.5px 4.4px ${_}`,opacity:0}});function getPositionStyles(_,a=0){const $={},[j,_e]=_.split("-");let et="",tt="";return j==="top"&&($.top=a,tt="-50%"),j==="middle"&&($.top="50%",tt="-50%"),j==="bottom"&&($.bottom=a,tt="50%"),_e==="start"&&($.left=a,et="-50%"),_e==="center"&&($.left="50%",et="-50%"),_e==="end"&&($.right=a,et="50%"),$.transform=`translate(${et}, ${tt})`,$}var useStyles$x=createStyles((_,{radius:a,size:$,color:j,position:_e,offset:et,inline:tt,withBorder:rt,withLabel:nt,zIndex:it})=>{const{background:st}=_.fn.variant({variant:"filled",primaryFallback:!1,color:j||_.primaryColor});return{root:{position:"relative",display:tt?"inline-block":"block"},indicator:__spreadProps$e(__spreadValues$n({},getPositionStyles(_e,et)),{zIndex:it,position:"absolute",[nt?"minWidth":"width"]:$,height:$,display:"flex",justifyContent:"center",alignItems:"center",fontSize:_.fontSizes.xs,paddingLeft:nt?`calc(${_.spacing.xs}px / 2)`:0,paddingRight:nt?`calc(${_.spacing.xs}px / 2)`:0,borderRadius:_.fn.size({size:a,sizes:_.radius}),backgroundColor:_.fn.variant({variant:"filled",primaryFallback:!1,color:j||_.primaryColor}).background,border:rt?`2px solid ${_.colorScheme==="dark"?_.colors.dark[7]:_.white}`:void 0,color:_.white,whiteSpace:"nowrap"}),processing:{animation:`${processingAnimation(st)} 1000ms linear infinite`},common:__spreadProps$e(__spreadValues$n({},getPositionStyles(_e,et)),{position:"absolute",[nt?"minWidth":"width"]:$,height:$,borderRadius:_.fn.size({size:a,sizes:_.radius})})}});const useStyles$y=useStyles$x,currentScrollDownKeyframes=keyframes({from:{transform:"translateY(-60%)",opacity:0},to:{transform:"translateY(0%)",opacity:1}}),currentScrollUpKeyframes=keyframes({from:{transform:"translateY(60%)",opacity:0},to:{transform:"translateY(0%)",opacity:1}}),oldNumberScrollUpKeyframes=keyframes({from:{transform:"translateY(0%)",opacity:1},to:{transform:"translateY(-60%)",opacity:0}}),oldNumberScrollDownKeyframes=keyframes({from:{transform:"translateY(0%)",opacity:1},to:{transform:"translateY(60%)",opacity:0}});var useStyles$v=createStyles(()=>({baseNumber:{height:18,width:"0.6em",maxWidth:"0.6em",position:"relative",display:"inline-block"},oldNumberTop:{transform:"translateY(-100%);"},oldNumberBottom:{transform:"translateY(100%);"},oldNumber:{display:"inline-block",opacity:0,position:"absolute",left:0,right:0},currentNumberTop:{transform:"translateY(0%);"},currentNumber:{display:"inline-block",opacity:1,position:"absolute",top:0,bottom:0,left:0,right:0},currentNumberScrollDown:{animation:`${currentScrollDownKeyframes} .2s cubic-bezier(0,0,.2, 1)`,animationIterationCount:1},currentNumberScrollUp:{animation:`${currentScrollUpKeyframes} .2s cubic-bezier(0,0,.2, 1)`,animationIterationCount:1},oldNumberScrollUp:{animation:`${oldNumberScrollUpKeyframes} .2s cubic-bezier(0,0,.2, 1)`,animationIterationCount:1},oldNumberScrollDown:{animation:`${oldNumberScrollDownKeyframes} .2s cubic-bezier(0,0,.2, 1)`,animationIterationCount:1}}));const useStyles$w=useStyles$v,MachineNumber=react.exports.forwardRef((_,a)=>{const[$,j]=react.exports.useState(_.value),[_e,et]=react.exports.useState(_.value),[tt,rt]=react.exports.useState("up"),[nt,it]=react.exports.useState(!1),st=usePrevious$1(_.value),ot=ft=>{it(!0),rt(ft),setTimeout(()=>{it(!1)},180)},at=()=>{const{newOriginalNumber:ft,oldOriginalNumber:pt}=_;ft==null||pt==null||(ft>pt?ot("up"):ft<pt&&ot("down"))};react.exports.useEffect(()=>{j(st),et(_.value),at()},[_.value,st]);const{classes:lt,cx:ct}=useStyles$w(null,{name:"MachineNumber"}),ut=react.exports.useMemo(()=>nt?tt==="up"?lt.currentNumberScrollUp:lt.currentNumberScrollDown:null,[nt,tt]),dt=react.exports.useMemo(()=>nt?tt==="up"?lt.oldNumberScrollUp:lt.oldNumberScrollDown:null,[nt,tt]);return jsxs("span",{ref:a,className:lt.baseNumber,children:[$&&jsx("span",{className:ct(lt.oldNumber,lt.currentNumberTop,dt),children:$})||null,jsx("span",{children:jsx("span",{className:ct(lt.currentNumber,ut),children:_e})}),$&&jsx("span",{className:ct(lt.oldNumber,lt.oldNumberBottom,dt),children:$})||null]})});var useStyles$t=createStyles(()=>({base:{display:"flex",alignItems:"center",overflow:"hidden"}}));const useStyles$u=useStyles$t,Machine=react.exports.forwardRef(({value:_=0,max:a},$)=>{const[j,_e]=react.exports.useState(),[et,tt]=react.exports.useState(),rt=usePrevious$1(_);react.exports.useEffect(()=>{typeof _=="string"?(_e(void 0),tt(void 0)):typeof rt=="string"?(_e(void 0),tt(_)):(_e(rt),tt(_))},[_,rt]);const nt=react.exports.useMemo(()=>{if(typeof _=="string")return[];if(_<1)return[0];const st=[];let ot=_;for(typeof a=="number"&&(ot=Math.min(a,ot));ot>=1;)st.push(ot%10),ot/=10,ot=Math.floor(ot);return st.reverse(),st},[_,a]),{classes:it}=useStyles$u(null,{name:"machine"});return typeof _=="string"?jsx("span",{ref:$,children:_}):jsxs("span",{ref:$,className:it.base,children:[nt.map((st,ot)=>jsx(MachineNumber,{value:st,oldOriginalNumber:j,newOriginalNumber:et},nt.length-ot-1)),typeof a=="number"&&_>a&&jsx("span",{children:"+"})]})});var __defProp$m=Object.defineProperty,__getOwnPropSymbols$m=Object.getOwnPropertySymbols,__hasOwnProp$m=Object.prototype.hasOwnProperty,__propIsEnum$m=Object.prototype.propertyIsEnumerable,__defNormalProp$m=(_,a,$)=>a in _?__defProp$m(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$m=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$m.call(a,$)&&__defNormalProp$m(_,$,a[$]);if(__getOwnPropSymbols$m)for(var $ of __getOwnPropSymbols$m(a))__propIsEnum$m.call(a,$)&&__defNormalProp$m(_,$,a[$]);return _},__objRest$f=(_,a)=>{var $={};for(var j in _)__hasOwnProp$m.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$m)for(var j of __getOwnPropSymbols$m(_))a.indexOf(j)<0&&__propIsEnum$m.call(_,j)&&($[j]=_[j]);return $};const defaultProps$b={position:"top-end",offset:0,inline:!1,withBorder:!1,disabled:!1,showZero:!0,processing:!1,dot:!0,size:10,overflowCount:99,radius:1e3,zIndex:getDefaultZIndex("app")},Indicator=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Indicator",defaultProps$b,_),{children:j,position:_e,offset:et,size:tt,radius:rt,inline:nt,withBorder:it,className:st,color:ot,dot:at,styles:lt,label:ct,overflowCount:ut,showZero:dt,classNames:ft,disabled:pt,zIndex:yt,unstyled:mt,processing:_t}=$,vt=__objRest$f($,["children","position","offset","size","radius","inline","withBorder","className","color","dot","styles","label","overflowCount","showZero","classNames","disabled","zIndex","unstyled","processing"]),{classes:ht,cx:St}=useStyles$y({position:_e,offset:et,size:tt,radius:rt,inline:nt,color:ot,withBorder:it,zIndex:yt,withLabel:!!ct},{name:"Indicator",classNames:ft,styles:lt,unstyled:mt}),It=react.exports.useMemo(()=>typeof ct=="number"?jsx(Machine,{value:ct,max:ut}):ct,[ct,ut]),Lt=react.exports.useMemo(()=>!pt&&(at||ct!=null&&!(ct<=0&&!dt)),[pt,ct,dt]);return jsxs(Box,{...__spreadValues$m({ref:a,className:St(ht.root,st)},vt),children:[Lt&&jsxs(Fragment$1,{children:[jsx("div",{className:St(ht.indicator,ht.common),children:It}),_t&&jsx("div",{className:St(ht.processing,ht.common)})]}),j]})});Indicator.displayName="@mantine/core/Indicator";var useStyles$r=createStyles({root:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"}});const useStyles$s=useStyles$r;var __defProp$l=Object.defineProperty,__defProps$d=Object.defineProperties,__getOwnPropDescs$d=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$l=Object.getOwnPropertySymbols,__hasOwnProp$l=Object.prototype.hasOwnProperty,__propIsEnum$l=Object.prototype.propertyIsEnumerable,__defNormalProp$l=(_,a,$)=>a in _?__defProp$l(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$l=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$l.call(a,$)&&__defNormalProp$l(_,$,a[$]);if(__getOwnPropSymbols$l)for(var $ of __getOwnPropSymbols$l(a))__propIsEnum$l.call(a,$)&&__defNormalProp$l(_,$,a[$]);return _},__spreadProps$d=(_,a)=>__defProps$d(_,__getOwnPropDescs$d(a)),__objRest$e=(_,a)=>{var $={};for(var j in _)__hasOwnProp$l.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$l)for(var j of __getOwnPropSymbols$l(_))a.indexOf(j)<0&&__propIsEnum$l.call(_,j)&&($[j]=_[j]);return $};const defaultProps$a={overlayOpacity:.75,transitionDuration:0,zIndex:getDefaultZIndex("overlay")},LoadingOverlay=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("LoadingOverlay",defaultProps$a,_),{className:j,visible:_e,loaderProps:et,overlayOpacity:tt,overlayColor:rt,transitionDuration:nt,exitTransitionDuration:it,zIndex:st,style:ot,loader:at,radius:lt,overlayBlur:ct,unstyled:ut}=$,dt=__objRest$e($,["className","visible","loaderProps","overlayOpacity","overlayColor","transitionDuration","exitTransitionDuration","zIndex","style","loader","radius","overlayBlur","unstyled"]),{classes:ft,cx:pt,theme:yt}=useStyles$s(null,{name:"LoadingOverlay",unstyled:ut}),mt=`calc(${st} + 1)`;return jsx(Transition,{duration:nt,exitDuration:it,mounted:_e,transition:"fade",children:_t=>jsxs(Box,{...__spreadValues$l({className:pt(ft.root,j),style:__spreadProps$d(__spreadValues$l(__spreadValues$l({},_t),ot),{zIndex:st}),ref:a},dt),children:[at?jsx("div",{style:{zIndex:mt},children:at}):jsx(Loader,{...__spreadValues$l({style:{zIndex:mt}},et)}),jsx(Overlay,{opacity:tt,zIndex:st,radius:lt,blur:ct,unstyled:ut,color:rt||(yt.colorScheme==="dark"?yt.colors.dark[5]:yt.white)})]})})});LoadingOverlay.displayName="@mantine/core/LoadingOverlay";var __defProp$k=Object.defineProperty,__getOwnPropSymbols$k=Object.getOwnPropertySymbols,__hasOwnProp$k=Object.prototype.hasOwnProperty,__propIsEnum$k=Object.prototype.propertyIsEnumerable,__defNormalProp$k=(_,a,$)=>a in _?__defProp$k(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$k=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$k.call(a,$)&&__defNormalProp$k(_,$,a[$]);if(__getOwnPropSymbols$k)for(var $ of __getOwnPropSymbols$k(a))__propIsEnum$k.call(a,$)&&__defNormalProp$k(_,$,a[$]);return _};const sizes={xs:320,sm:380,md:440,lg:620,xl:780};function getFullScreenStyles(_){return _?{position:"absolute",top:0,left:0,right:0,bottom:0,maxHeight:"100vh",overflowY:"auto"}:{}}var useStyles$p=createStyles((_,{overflow:a,size:$,centered:j,zIndex:_e,fullScreen:et})=>({close:{},overlay:{display:et?"none":void 0},root:{position:"fixed",zIndex:_e,top:0,left:0,right:0,bottom:0},inner:{position:"absolute",top:0,left:0,right:0,bottom:0,overflowY:"auto",padding:et?0:`${_.spacing.xl*2}px ${_.spacing.md}px`,display:"flex",justifyContent:"center",alignItems:j?"center":"flex-start"},title:{marginRight:_.spacing.md,textOverflow:"ellipsis",display:"block",wordBreak:"break-word"},modal:__spreadValues$k({position:"relative",width:et?"100vw":_.fn.size({sizes,size:$}),borderRadius:et?0:void 0,outline:0,backgroundColor:_.colorScheme==="dark"?_.colors.dark[7]:_.white,marginTop:j?"auto":void 0,marginBottom:j?"auto":void 0,zIndex:1},getFullScreenStyles(et)),header:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:_.spacing.md,marginRight:-9},body:{maxHeight:a==="inside"?"calc(100vh - 185px)":null,overflowY:a==="inside"?"auto":null,wordBreak:"break-word"}}));const useStyles$q=useStyles$p;var __defProp$j=Object.defineProperty,__getOwnPropSymbols$j=Object.getOwnPropertySymbols,__hasOwnProp$j=Object.prototype.hasOwnProperty,__propIsEnum$j=Object.prototype.propertyIsEnumerable,__defNormalProp$j=(_,a,$)=>a in _?__defProp$j(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$j=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$j.call(a,$)&&__defNormalProp$j(_,$,a[$]);if(__getOwnPropSymbols$j)for(var $ of __getOwnPropSymbols$j(a))__propIsEnum$j.call(a,$)&&__defNormalProp$j(_,$,a[$]);return _},__objRest$d=(_,a)=>{var $={};for(var j in _)__hasOwnProp$j.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$j)for(var j of __getOwnPropSymbols$j(_))a.indexOf(j)<0&&__propIsEnum$j.call(_,j)&&($[j]=_[j]);return $};const defaultProps$9={size:"md",transitionDuration:250,overflow:"outside",padding:"lg",shadow:"lg",closeOnClickOutside:!0,closeOnEscape:!0,trapFocus:!0,withCloseButton:!0,withinPortal:!0,lockScroll:!0,withFocusReturn:!0,overlayBlur:0,zIndex:getDefaultZIndex("modal"),exitTransitionDuration:0};function Modal(_){const a=useComponentDefaultProps("Modal",defaultProps$9,_),{className:$,opened:j,title:_e,onClose:et,children:tt,withCloseButton:rt,overlayOpacity:nt,size:it,transitionDuration:st,exitTransitionDuration:ot,closeButtonLabel:at,overlayColor:lt,overflow:ct,transition:ut,padding:dt,shadow:ft,radius:pt,id:yt,classNames:mt,styles:_t,closeOnClickOutside:vt,trapFocus:ht,closeOnEscape:St,centered:It,target:Lt,withinPortal:Mt,zIndex:Kt,overlayBlur:kt,transitionTimingFunction:gt,fullScreen:Et,unstyled:xt,lockScroll:Tt,withFocusReturn:At}=a,Nt=__objRest$d(a,["className","opened","title","onClose","children","withCloseButton","overlayOpacity","size","transitionDuration","exitTransitionDuration","closeButtonLabel","overlayColor","overflow","transition","padding","shadow","radius","id","classNames","styles","closeOnClickOutside","trapFocus","closeOnEscape","centered","target","withinPortal","zIndex","overlayBlur","transitionTimingFunction","fullScreen","unstyled","lockScroll","withFocusReturn"]),Bt=useId$1(yt),Ot=`${Bt}-title`,bt=`${Bt}-body`,{classes:Rt,cx:Gt,theme:Pt}=useStyles$q({size:it,overflow:ct,centered:It,zIndex:Kt,fullScreen:Et},{unstyled:xt,classNames:mt,styles:_t,name:"Modal"}),Ft=useFocusTrap(ht&&j),jt=typeof nt=="number"?nt:Pt.colorScheme==="dark"?.85:.75;useScrollLock(Tt&&j);const Vt=Wt=>{!ht&&Wt.key==="Escape"&&St&&et()};return react.exports.useEffect(()=>{if(!ht)return window.addEventListener("keydown",Vt),()=>window.removeEventListener("keydown",Vt)},[ht]),useFocusReturn({opened:j,shouldReturnFocus:ht&&At}),jsx(OptionalPortal,{withinPortal:Mt,target:Lt,children:jsx(GroupedTransition,{mounted:j,duration:st,exitDuration:ot,timingFunction:gt,transitions:{modal:{duration:st,transition:ut||(Et?"fade":"pop")},overlay:{duration:st/2,transition:"fade",timingFunction:"ease"}},children:Wt=>jsx(Fragment$1,{children:jsxs(Box,{...__spreadValues$j({id:Bt,className:Gt(Rt.root,$)},Nt),children:[jsx("div",{style:Wt.overlay,children:jsx(Overlay,{className:Rt.overlay,sx:{position:"fixed"},zIndex:0,blur:kt,color:lt||(Pt.colorScheme==="dark"?Pt.colors.dark[9]:Pt.black),opacity:jt,unstyled:xt})}),jsx("div",{role:"presentation",className:Rt.inner,onClick:()=>vt&&et(),onKeyDown:Qt=>{var qt;((qt=Qt.target)==null?void 0:qt.getAttribute("data-mantine-stop-propagation"))!=="true"&&Qt.key==="Escape"&&St&&et()},ref:Ft,children:jsxs(Paper,{className:Rt.modal,shadow:ft,p:dt,radius:pt,role:"dialog","aria-labelledby":Ot,"aria-describedby":bt,"aria-modal":!0,tabIndex:-1,style:Wt.modal,unstyled:xt,onClick:Qt=>Qt.stopPropagation(),children:[(_e||rt)&&jsxs("div",{className:Rt.header,children:[jsx(Text,{id:Ot,className:Rt.title,children:_e}),rt&&jsx(CloseButton,{iconSize:16,onClick:et,"aria-label":at,className:Rt.close})]}),jsx("div",{id:bt,className:Rt.body,children:tt})]})})]})})})})}Modal.displayName="@mantine/core/Modal";var useStyles$n=createStyles((_,{color:a,radius:$,withTitle:j},_e)=>{const et=_.fn.radius($),tt=Math.min(Math.max(et/1.2,4),30),rt=_.fn.variant({variant:"filled",color:a});return{closeButton:_.fn.hover({backgroundColor:_.colorScheme==="dark"?_.colors.dark[8]:_.colors.gray[0]}),icon:{ref:_e("icon"),boxSizing:"border-box",marginRight:_.spacing.md,width:28,height:28,borderRadius:28,display:"flex",flex:"none",alignItems:"center",justifyContent:"center",color:_.white},withIcon:{paddingLeft:_.spacing.xs,"&::before":{display:"none"}},root:{boxSizing:"border-box",position:"relative",display:"flex",alignItems:"center",paddingLeft:22,paddingRight:5,paddingTop:_.spacing.xs,paddingBottom:_.spacing.xs,borderRadius:et,backgroundColor:_.colorScheme==="dark"?_.colors.dark[6]:_.white,boxShadow:_.shadows.lg,border:`1px solid ${_.colorScheme==="dark"?_.colors.dark[6]:_.colors.gray[2]}`,"&::before":{content:'""',display:"block",position:"absolute",width:6,top:tt,bottom:tt,left:4,borderRadius:et,backgroundColor:rt.background},[`& .${_e("icon")}`]:{backgroundColor:rt.background,color:_.white}},body:{flex:1,overflow:"hidden",marginRight:10},loader:{marginRight:_.spacing.md},title:{lineHeight:1.4,marginBottom:2,overflow:"hidden",textOverflow:"ellipsis",color:_.colorScheme==="dark"?_.white:_.colors.gray[9]},description:{color:j?_.colorScheme==="dark"?_.colors.dark[2]:_.colors.gray[6]:_.colorScheme==="dark"?_.colors.dark[0]:_.black,lineHeight:1.4,overflow:"hidden",textOverflow:"ellipsis"}}});const useStyles$o=useStyles$n;var __defProp$i=Object.defineProperty,__defProps$c=Object.defineProperties,__getOwnPropDescs$c=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$i=Object.getOwnPropertySymbols,__hasOwnProp$i=Object.prototype.hasOwnProperty,__propIsEnum$i=Object.prototype.propertyIsEnumerable,__defNormalProp$i=(_,a,$)=>a in _?__defProp$i(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$i=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$i.call(a,$)&&__defNormalProp$i(_,$,a[$]);if(__getOwnPropSymbols$i)for(var $ of __getOwnPropSymbols$i(a))__propIsEnum$i.call(a,$)&&__defNormalProp$i(_,$,a[$]);return _},__spreadProps$c=(_,a)=>__defProps$c(_,__getOwnPropDescs$c(a)),__objRest$c=(_,a)=>{var $={};for(var j in _)__hasOwnProp$i.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$i)for(var j of __getOwnPropSymbols$i(_))a.indexOf(j)<0&&__propIsEnum$i.call(_,j)&&($[j]=_[j]);return $};const Notification=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Notification",{},_),{className:j,color:_e,radius:et,loading:tt,disallowClose:rt,title:nt,icon:it,children:st,onClose:ot,closeButtonProps:at,classNames:lt,styles:ct,unstyled:ut}=$,dt=__objRest$c($,["className","color","radius","loading","disallowClose","title","icon","children","onClose","closeButtonProps","classNames","styles","unstyled"]),{classes:ft,cx:pt}=useStyles$o({color:_e,radius:et,withTitle:!!nt},{classNames:lt,styles:ct,unstyled:ut,name:"Notification"}),yt=it||tt;return jsxs(Box,{...__spreadValues$i({className:pt(ft.root,{[ft.withIcon]:yt},j),role:"alert",ref:a},dt),children:[it&&!tt&&jsx("div",{className:ft.icon,children:it}),tt&&jsx(Loader,{size:28,color:_e,className:ft.loader}),jsxs("div",{className:ft.body,children:[nt&&jsx(Text,{className:ft.title,size:"sm",weight:500,children:nt}),jsx(Text,{color:"dimmed",className:ft.description,size:"sm",children:st})]}),!rt&&jsx(CloseButton,{...__spreadProps$c(__spreadValues$i({iconSize:16,color:"gray"},at),{onClick:ot,className:ft.closeButton})})]})});Notification.displayName="@mantine/core/Notification";var __defProp$h=Object.defineProperty,__defProps$b=Object.defineProperties,__getOwnPropDescs$b=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$h=Object.getOwnPropertySymbols,__hasOwnProp$h=Object.prototype.hasOwnProperty,__propIsEnum$h=Object.prototype.propertyIsEnumerable,__defNormalProp$h=(_,a,$)=>a in _?__defProp$h(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$h=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$h.call(a,$)&&__defNormalProp$h(_,$,a[$]);if(__getOwnPropSymbols$h)for(var $ of __getOwnPropSymbols$h(a))__propIsEnum$h.call(a,$)&&__defNormalProp$h(_,$,a[$]);return _},__spreadProps$b=(_,a)=>__defProps$b(_,__getOwnPropDescs$b(a)),__objRest$b=(_,a)=>{var $={};for(var j in _)__hasOwnProp$h.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$h)for(var j of __getOwnPropSymbols$h(_))a.indexOf(j)<0&&__propIsEnum$h.call(_,j)&&($[j]=_[j]);return $};const defaultProps$8={type:"text",size:"sm",__staticSelector:"TextInput"},TextInput=react.exports.forwardRef((_,a)=>{const $=useInputProps("TextInput",defaultProps$8,_),{inputProps:j,wrapperProps:_e}=$,et=__objRest$b($,["inputProps","wrapperProps"]);return jsx(Input.Wrapper,{...__spreadValues$h({},_e),children:jsx(Input,{...__spreadProps$b(__spreadValues$h(__spreadValues$h({},j),et),{ref:a})})})});TextInput.displayName="@mantine/core/TextInput";const TooltipGroupContext=react.exports.createContext(!1),TooltipGroupProvider=TooltipGroupContext.Provider,useTooltipGroupContext=()=>react.exports.useContext(TooltipGroupContext);function TooltipGroup({children:_,openDelay:a=0,closeDelay:$=0}){return jsx(TooltipGroupProvider,{value:!0,children:jsx(FloatingDelayGroup,{delay:{open:a,close:$},children:_})})}TooltipGroup.displayName="@mantine/core/TooltipGroup";var __defProp$g=Object.defineProperty,__defProps$a=Object.defineProperties,__getOwnPropDescs$a=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$g=Object.getOwnPropertySymbols,__hasOwnProp$g=Object.prototype.hasOwnProperty,__propIsEnum$g=Object.prototype.propertyIsEnumerable,__defNormalProp$g=(_,a,$)=>a in _?__defProp$g(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$g=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$g.call(a,$)&&__defNormalProp$g(_,$,a[$]);if(__getOwnPropSymbols$g)for(var $ of __getOwnPropSymbols$g(a))__propIsEnum$g.call(a,$)&&__defNormalProp$g(_,$,a[$]);return _},__spreadProps$a=(_,a)=>__defProps$a(_,__getOwnPropDescs$a(a));function getColors(_,a){if(!a)return{backgroundColor:_.colorScheme==="dark"?_.colors.dark[6]:_.colors.gray[9],color:_.white};const $=_.fn.variant({variant:"filled",color:a,primaryFallback:!1});return{backgroundColor:$.background,color:$.color}}var useStyles$l=createStyles((_,{color:a,radius:$,width:j,multiline:_e})=>({tooltip:__spreadProps$a(__spreadValues$g(__spreadValues$g({},_.fn.fontStyles()),getColors(_,a)),{lineHeight:_.lineHeight,fontSize:_.fontSizes.sm,borderRadius:_.fn.radius($),padding:`calc(${_.spacing.xs}px / 2) ${_.spacing.xs}px`,position:"absolute",whiteSpace:_e?"unset":"nowrap",pointerEvents:"none",width:j}),arrow:{backgroundColor:"inherit",border:0,zIndex:1}}));const useStyles$m=useStyles$l,TOOLTIP_ERRORS={children:"Tooltip component children should be an element or a component that accepts ref, fragments, strings, numbers and other primitive values are not supported"};function useFloatingTooltip({offset:_,position:a}){const[$,j]=react.exports.useState(!1),_e=react.exports.useRef(),{x:et,y:tt,reference:rt,floating:nt,refs:it,update:st,placement:ot}=useFloating({placement:a,middleware:[shift({crossAxis:!0,padding:5,rootBoundary:"document"})]}),at=ot.includes("right")?_:a.includes("left")?_*-1:0,lt=ot.includes("bottom")?_:a.includes("top")?_*-1:0,ct=react.exports.useCallback(({clientX:ut,clientY:dt})=>{rt({getBoundingClientRect(){return{width:0,height:0,x:ut,y:dt,left:ut+at,top:dt+lt,right:ut,bottom:dt}}})},[rt]);return react.exports.useEffect(()=>{if(it.floating.current){const ut=_e.current;ut.addEventListener("mousemove",ct);const dt=getOverflowAncestors(it.floating.current);return dt.forEach(ft=>{ft.addEventListener("scroll",st)}),()=>{ut.removeEventListener("mousemove",ct),dt.forEach(ft=>{ft.removeEventListener("scroll",st)})}}},[rt,it.floating,st,ct,$]),{handleMouseMove:ct,x:et,y:tt,opened:$,setOpened:j,boundaryRef:_e,floating:nt}}var __defProp$f=Object.defineProperty,__defProps$9=Object.defineProperties,__getOwnPropDescs$9=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$f=Object.getOwnPropertySymbols,__hasOwnProp$f=Object.prototype.hasOwnProperty,__propIsEnum$f=Object.prototype.propertyIsEnumerable,__defNormalProp$f=(_,a,$)=>a in _?__defProp$f(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$f=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$f.call(a,$)&&__defNormalProp$f(_,$,a[$]);if(__getOwnPropSymbols$f)for(var $ of __getOwnPropSymbols$f(a))__propIsEnum$f.call(a,$)&&__defNormalProp$f(_,$,a[$]);return _},__spreadProps$9=(_,a)=>__defProps$9(_,__getOwnPropDescs$9(a)),__objRest$a=(_,a)=>{var $={};for(var j in _)__hasOwnProp$f.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$f)for(var j of __getOwnPropSymbols$f(_))a.indexOf(j)<0&&__propIsEnum$f.call(_,j)&&($[j]=_[j]);return $};const defaultProps$7={refProp:"ref",withinPortal:!0,offset:10,position:"right",zIndex:getDefaultZIndex("popover")};function TooltipFloating(_){var a;const $=useComponentDefaultProps("TooltipFloating",defaultProps$7,_),{children:j,refProp:_e,withinPortal:et,style:tt,className:rt,classNames:nt,styles:it,unstyled:st,radius:ot,color:at,label:lt,offset:ct,position:ut,multiline:dt,width:ft,zIndex:pt,disabled:yt}=$,mt=__objRest$a($,["children","refProp","withinPortal","style","className","classNames","styles","unstyled","radius","color","label","offset","position","multiline","width","zIndex","disabled"]),{handleMouseMove:_t,x:vt,y:ht,opened:St,boundaryRef:It,floating:Lt,setOpened:Mt}=useFloatingTooltip({offset:ct,position:ut}),{classes:Kt,cx:kt}=useStyles$m({radius:ot,color:at,multiline:dt,width:ft},{name:"Tooltip",classNames:nt,styles:it,unstyled:st});if(!isElement$2(j))throw new Error(TOOLTIP_ERRORS.children);const gt=useMergedRef(It,j.ref),Et=Tt=>{var At,Nt;(Nt=(At=j.props).onMouseEnter)==null||Nt.call(At,Tt),_t(Tt),Mt(!0)},xt=Tt=>{var At,Nt;(Nt=(At=j.props).onMouseLeave)==null||Nt.call(At,Tt),Mt(!1)};return yt?jsx(Fragment$1,{children:j}):jsxs(Fragment$1,{children:[jsx(OptionalPortal,{withinPortal:et,children:jsx(Box,{...__spreadProps$9(__spreadValues$f({},mt),{ref:Lt,className:kt(Kt.tooltip,rt),style:__spreadProps$9(__spreadValues$f({},tt),{zIndex:pt,display:St?"block":"none",top:ht??"",left:(a=Math.round(vt))!=null?a:""})}),children:lt})}),react.exports.cloneElement(j,__spreadProps$9(__spreadValues$f({},j.props),{[_e]:gt,onMouseEnter:Et,onMouseLeave:xt}))]})}TooltipFloating.displayName="@mantine/core/TooltipFloating";function useTooltip(_){const[a,$]=react.exports.useState(!1),_e=typeof _.opened=="boolean"?_.opened:a,et=useTooltipGroupContext(),tt=useId$1(),{delay:rt,currentId:nt,setCurrentId:it}=useDelayGroupContext(),st=react.exports.useCallback(St=>{$(St),St&&it(tt)},[it,tt]),{x:ot,y:at,reference:lt,floating:ct,context:ut,refs:dt,update:ft,placement:pt,middlewareData:{arrow:{x:yt,y:mt}={}}}=useFloating({placement:_.position,open:_e,onOpenChange:st,middleware:[offset(_.offset),shift({padding:8}),flip(),arrow({element:_.arrowRef}),..._.inline?[inline()]:[]]}),{getReferenceProps:_t,getFloatingProps:vt}=useInteractions([useHover(ut,{enabled:_.events.hover,delay:et?rt:{open:_.openDelay,close:_.closeDelay},mouseOnly:!_.events.touch}),useFocus(ut,{enabled:_.events.focus,keyboardOnly:!0}),useRole(ut,{role:"tooltip"}),useDismiss(ut,{enabled:typeof _.opened===void 0}),useDelayGroup(ut,{id:tt})]);return useFloatingAutoUpdate({opened:_e,positionDependencies:_.positionDependencies,floating:{refs:dt,update:ft}}),useDidUpdate(()=>{var St;(St=_.onPositionChange)==null||St.call(_,pt)},[pt]),{x:ot,y:at,arrowX:yt,arrowY:mt,reference:lt,floating:ct,getFloatingProps:vt,getReferenceProps:_t,isGroupPhase:_e&&nt&&nt!==tt,opened:_e,placement:pt}}var __defProp$e=Object.defineProperty,__defProps$8=Object.defineProperties,__getOwnPropDescs$8=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$e=Object.getOwnPropertySymbols,__hasOwnProp$e=Object.prototype.hasOwnProperty,__propIsEnum$e=Object.prototype.propertyIsEnumerable,__defNormalProp$e=(_,a,$)=>a in _?__defProp$e(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$e=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$e.call(a,$)&&__defNormalProp$e(_,$,a[$]);if(__getOwnPropSymbols$e)for(var $ of __getOwnPropSymbols$e(a))__propIsEnum$e.call(a,$)&&__defNormalProp$e(_,$,a[$]);return _},__spreadProps$8=(_,a)=>__defProps$8(_,__getOwnPropDescs$8(a)),__objRest$9=(_,a)=>{var $={};for(var j in _)__hasOwnProp$e.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$e)for(var j of __getOwnPropSymbols$e(_))a.indexOf(j)<0&&__propIsEnum$e.call(_,j)&&($[j]=_[j]);return $};const defaultProps$6={position:"top",refProp:"ref",withinPortal:!1,inline:!1,arrowSize:4,arrowOffset:5,arrowRadius:0,offset:5,transition:"fade",transitionDuration:100,width:"auto",events:{hover:!0,focus:!1,touch:!1},zIndex:getDefaultZIndex("popover"),positionDependencies:[]},_Tooltip=react.exports.forwardRef((_,a)=>{const $=react.exports.useRef(null),j=useComponentDefaultProps("Tooltip",defaultProps$6,_),{children:_e,position:et,refProp:tt,label:rt,openDelay:nt,closeDelay:it,onPositionChange:st,opened:ot,withinPortal:at,radius:lt,color:ct,classNames:ut,styles:dt,unstyled:ft,style:pt,className:yt,withArrow:mt,arrowSize:_t,arrowOffset:vt,arrowRadius:ht,offset:St,transition:It,transitionDuration:Lt,multiline:Mt,width:Kt,events:kt,zIndex:gt,disabled:Et,positionDependencies:xt,onClick:Tt,onMouseEnter:At,onMouseLeave:Nt,inline:Bt}=j,Ot=__objRest$9(j,["children","position","refProp","label","openDelay","closeDelay","onPositionChange","opened","withinPortal","radius","color","classNames","styles","unstyled","style","className","withArrow","arrowSize","arrowOffset","arrowRadius","offset","transition","transitionDuration","multiline","width","events","zIndex","disabled","positionDependencies","onClick","onMouseEnter","onMouseLeave","inline"]),{classes:bt,cx:Rt,theme:Gt}=useStyles$m({radius:lt,color:ct,width:Kt,multiline:Mt},{name:"Tooltip",classNames:ut,styles:dt,unstyled:ft}),Pt=useTooltip({position:getFloatingPosition(Gt.dir,et),closeDelay:it,openDelay:nt,onPositionChange:st,opened:ot,events:kt,arrowRef:$,offset:St+(mt?_t/2:0),positionDependencies:[...xt,_e],inline:Bt});if(!isElement$2(_e))throw new Error(TOOLTIP_ERRORS.children);const Ft=useMergedRef(Pt.reference,_e.ref,a);return jsxs(Fragment$1,{children:[jsx(OptionalPortal,{withinPortal:at,children:jsx(Transition,{mounted:!Et&&Pt.opened,transition:It,duration:Pt.isGroupPhase?10:Lt,children:jt=>{var Vt,Wt;return jsxs(Box,{...__spreadValues$e(__spreadValues$e({},Ot),Pt.getFloatingProps({ref:Pt.floating,className:bt.tooltip,style:__spreadProps$8(__spreadValues$e(__spreadValues$e({},pt),jt),{zIndex:gt,top:(Vt=Pt.y)!=null?Vt:0,left:(Wt=Pt.x)!=null?Wt:0})})),children:[rt,jsx(FloatingArrow,{ref:$,arrowX:Pt.arrowX,arrowY:Pt.arrowY,visible:mt,withBorder:!1,position:Pt.placement,arrowSize:_t,arrowOffset:vt,arrowRadius:ht,className:bt.arrow})]})}})}),react.exports.cloneElement(_e,Pt.getReferenceProps(__spreadValues$e({onClick:Tt,onMouseEnter:At,onMouseLeave:Nt,onMouseMove:_.onMouseMove,onPointerDown:_.onPointerDown,onPointerEnter:_.onPointerEnter,[tt]:Ft,className:Rt(yt,_e.props.className)},_e.props)))]})});_Tooltip.Group=TooltipGroup;_Tooltip.Floating=TooltipFloating;_Tooltip.displayName="@mantine/core/Tooltip";const Tooltip=_Tooltip;function getSortedBreakpoints(_,a){if(a.length===0)return a;const $="maxWidth"in a[0]?"maxWidth":"minWidth",j=[...a].sort((_e,et)=>_.fn.size({size:et[$],sizes:_.breakpoints})-_.fn.size({size:_e[$],sizes:_.breakpoints}));return $==="minWidth"?j.reverse():j}var __defProp$d=Object.defineProperty,__getOwnPropSymbols$d=Object.getOwnPropertySymbols,__hasOwnProp$d=Object.prototype.hasOwnProperty,__propIsEnum$d=Object.prototype.propertyIsEnumerable,__defNormalProp$d=(_,a,$)=>a in _?__defProp$d(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$d=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$d.call(a,$)&&__defNormalProp$d(_,$,a[$]);if(__getOwnPropSymbols$d)for(var $ of __getOwnPropSymbols$d(a))__propIsEnum$d.call(a,$)&&__defNormalProp$d(_,$,a[$]);return _},useStyles$j=createStyles((_,{spacing:a,breakpoints:$,cols:j,verticalSpacing:_e})=>{const et=_e!=null,tt=getSortedBreakpoints(_,$).reduce((rt,nt)=>{const it="maxWidth"in nt?"max-width":"min-width",st=_.fn.size({size:it==="max-width"?nt.maxWidth:nt.minWidth,sizes:_.breakpoints});return rt[`@media (${it}: ${st-(it==="max-width"?1:0)}px)`]={gridTemplateColumns:`repeat(${nt.cols}, minmax(0, 1fr))`,gap:`${_.fn.size({size:nt.verticalSpacing||(et?_e:a),sizes:_.spacing})}px ${_.fn.size({size:nt.spacing||a,sizes:_.spacing})}px`},rt},{});return{root:__spreadValues$d({boxSizing:"border-box",display:"grid",gridTemplateColumns:`repeat(${j}, minmax(0, 1fr))`,gap:`${_.fn.size({size:et?_e:a,sizes:_.spacing})}px ${_.fn.size({size:a,sizes:_.spacing})}px`},tt)}});const useStyles$k=useStyles$j;var __defProp$c=Object.defineProperty,__getOwnPropSymbols$c=Object.getOwnPropertySymbols,__hasOwnProp$c=Object.prototype.hasOwnProperty,__propIsEnum$c=Object.prototype.propertyIsEnumerable,__defNormalProp$c=(_,a,$)=>a in _?__defProp$c(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$c=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$c.call(a,$)&&__defNormalProp$c(_,$,a[$]);if(__getOwnPropSymbols$c)for(var $ of __getOwnPropSymbols$c(a))__propIsEnum$c.call(a,$)&&__defNormalProp$c(_,$,a[$]);return _},__objRest$8=(_,a)=>{var $={};for(var j in _)__hasOwnProp$c.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$c)for(var j of __getOwnPropSymbols$c(_))a.indexOf(j)<0&&__propIsEnum$c.call(_,j)&&($[j]=_[j]);return $};const defaultProps$5={breakpoints:[],cols:1,spacing:"md"},SimpleGrid=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("SimpleGrid",defaultProps$5,_),{className:j,breakpoints:_e,cols:et,spacing:tt,verticalSpacing:rt,children:nt,unstyled:it}=$,st=__objRest$8($,["className","breakpoints","cols","spacing","verticalSpacing","children","unstyled"]),{classes:ot,cx:at}=useStyles$k({breakpoints:_e,cols:et,spacing:tt,verticalSpacing:rt},{unstyled:it,name:"SimpleGrid"});return jsx(Box,{...__spreadValues$c({className:at(ot.root,j),ref:a},st),children:nt})});SimpleGrid.displayName="@mantine/core/SimpleGrid";const fade=keyframes({"from, to":{opacity:.4},"50%":{opacity:1}});var useStyles$h=createStyles((_,{height:a,width:$,radius:j,circle:_e,animate:et})=>({root:{height:a,width:_e?a:$,borderRadius:_e?a:_.fn.radius(j),position:"relative",overflow:"hidden",WebkitTransform:"translateZ(0)"},visible:{"&::before":{content:'""',position:"absolute",background:_.colorScheme==="dark"?_.colors.dark[7]:_.white,top:0,bottom:0,left:0,right:0,zIndex:10},"&::after":{content:'""',position:"absolute",background:_.colorScheme==="dark"?_.colors.dark[4]:_.colors.gray[3],top:0,bottom:0,left:0,right:0,animation:et?`${fade} 1500ms linear infinite`:"none",zIndex:11}}}));const useStyles$i=useStyles$h;var __defProp$b=Object.defineProperty,__getOwnPropSymbols$b=Object.getOwnPropertySymbols,__hasOwnProp$b=Object.prototype.hasOwnProperty,__propIsEnum$b=Object.prototype.propertyIsEnumerable,__defNormalProp$b=(_,a,$)=>a in _?__defProp$b(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$b=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$b.call(a,$)&&__defNormalProp$b(_,$,a[$]);if(__getOwnPropSymbols$b)for(var $ of __getOwnPropSymbols$b(a))__propIsEnum$b.call(a,$)&&__defNormalProp$b(_,$,a[$]);return _},__objRest$7=(_,a)=>{var $={};for(var j in _)__hasOwnProp$b.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$b)for(var j of __getOwnPropSymbols$b(_))a.indexOf(j)<0&&__propIsEnum$b.call(_,j)&&($[j]=_[j]);return $};const defaultProps$4={height:"auto",width:"100%",visible:!0,animate:!0},Skeleton=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Skeleton",defaultProps$4,_),{height:j,width:_e,visible:et,animate:tt,className:rt,circle:nt,radius:it,unstyled:st}=$,ot=__objRest$7($,["height","width","visible","animate","className","circle","radius","unstyled"]),{classes:at,cx:lt}=useStyles$i({height:j,width:_e,circle:nt,radius:it,animate:tt},{unstyled:st,name:"Skeleton"});return jsx(Box,{...__spreadValues$b({className:lt(at.root,{[at.visible]:et},rt),ref:a},ot)})});Skeleton.displayName="@mantine/core/Skeleton";const SwitchGroupContext=react.exports.createContext(null),SwitchGroupProvider=SwitchGroupContext.Provider,useSwitchGroupContext=()=>react.exports.useContext(SwitchGroupContext);var __defProp$a=Object.defineProperty,__getOwnPropSymbols$a=Object.getOwnPropertySymbols,__hasOwnProp$a=Object.prototype.hasOwnProperty,__propIsEnum$a=Object.prototype.propertyIsEnumerable,__defNormalProp$a=(_,a,$)=>a in _?__defProp$a(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$a=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$a.call(a,$)&&__defNormalProp$a(_,$,a[$]);if(__getOwnPropSymbols$a)for(var $ of __getOwnPropSymbols$a(a))__propIsEnum$a.call(a,$)&&__defNormalProp$a(_,$,a[$]);return _},__objRest$6=(_,a)=>{var $={};for(var j in _)__hasOwnProp$a.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$a)for(var j of __getOwnPropSymbols$a(_))a.indexOf(j)<0&&__propIsEnum$a.call(_,j)&&($[j]=_[j]);return $};const defaultProps$3={orientation:"horizontal",spacing:"lg",size:"sm",offset:"xs"},SwitchGroup=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("SwitchGroup",defaultProps$3,_),{children:j,value:_e,defaultValue:et,onChange:tt,orientation:rt,spacing:nt,size:it,wrapperProps:st,offset:ot}=$,at=__objRest$6($,["children","value","defaultValue","onChange","orientation","spacing","size","wrapperProps","offset"]),[lt,ct]=useUncontrolled({value:_e,defaultValue:et,finalValue:[],onChange:tt});return jsx(SwitchGroupProvider,{value:{value:lt,onChange:dt=>{const ft=dt.currentTarget.value;ct(lt.includes(ft)?lt.filter(pt=>pt!==ft):[...lt,ft])},size:it},children:jsx(Input.Wrapper,{...__spreadValues$a(__spreadValues$a({labelElement:"div",size:it,__staticSelector:"SwitchGroup",ref:a},st),at),children:jsx(InputsGroup,{spacing:nt,orientation:rt,offset:ot,children:j})})})});SwitchGroup.displayName="@mantine/core/SwitchGroup";var __defProp$9=Object.defineProperty,__defProps$7=Object.defineProperties,__getOwnPropDescs$7=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$9=Object.getOwnPropertySymbols,__hasOwnProp$9=Object.prototype.hasOwnProperty,__propIsEnum$9=Object.prototype.propertyIsEnumerable,__defNormalProp$9=(_,a,$)=>a in _?__defProp$9(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$9=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$9.call(a,$)&&__defNormalProp$9(_,$,a[$]);if(__getOwnPropSymbols$9)for(var $ of __getOwnPropSymbols$9(a))__propIsEnum$9.call(a,$)&&__defNormalProp$9(_,$,a[$]);return _},__spreadProps$7=(_,a)=>__defProps$7(_,__getOwnPropDescs$7(a));const switchHeight={xs:16,sm:20,md:24,lg:30,xl:36},switchWidth={xs:32,sm:38,md:46,lg:56,xl:72},handleSizes={xs:12,sm:14,md:18,lg:22,xl:28},labelFontSizes={xs:5,sm:6,md:7,lg:9,xl:11},trackLabelPaddings={xs:4,sm:5,md:6,lg:8,xl:10};var useStyles$f=createStyles((_,{size:a,radius:$,color:j,labelPosition:_e,error:et})=>{const tt=_.fn.size({size:a,sizes:handleSizes}),rt=_.fn.size({size:$,sizes:_.radius}),nt=_.fn.variant({variant:"filled",color:j}),it=_.fn.size({size:a,sizes:switchWidth}),st=a==="xs"?1:2,ot=_.fn.variant({variant:"filled",color:"red"}).background;return{input:{clip:"rect(1px, 1px, 1px, 1px)",height:"1px",overflow:"hidden",width:"1px",whiteSpace:"nowrap",padding:"0",WebkitClipPath:"inset(50%)",clipPath:"inset(50%)"},track:__spreadProps$7(__spreadValues$9({},_.fn.focusStyles("input:focus + &")),{cursor:_.cursorType,overflow:"hidden",WebkitTapHighlightColor:"transparent",position:"relative",borderRadius:rt,backgroundColor:_.colorScheme==="dark"?_.colors.dark[6]:_.colors.gray[2],border:`1px solid ${et?ot:_.colorScheme==="dark"?_.colors.dark[4]:_.colors.gray[3]}`,height:_.fn.size({size:a,sizes:switchHeight}),minWidth:it,margin:0,transitionProperty:"background-color, border-color",transitionTimingFunction:_.transitionTimingFunction,transitionDuration:"150ms",boxSizing:"border-box",appearance:"none",display:"flex",alignItems:"center",fontSize:_.fn.size({size:a,sizes:labelFontSizes}),fontWeight:600,order:_e==="left"?2:1,userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none",zIndex:0,lineHeight:0,color:_.colorScheme==="dark"?_.colors.dark[1]:_.colors.gray[6],transition:`color 150ms ${_.transitionTimingFunction}`,"input:checked + &":{backgroundColor:nt.background,borderColor:nt.background,color:_.white,transition:`color 150ms ${_.transitionTimingFunction}`},"input:disabled + &":{backgroundColor:_.colorScheme==="dark"?_.colors.dark[4]:_.colors.gray[2],borderColor:_.colorScheme==="dark"?_.colors.dark[4]:_.colors.gray[2],cursor:"not-allowed"}}),thumb:{position:"absolute",zIndex:1,borderRadius:rt,boxSizing:"border-box",display:"flex",backgroundColor:_.white,height:tt,width:tt,border:`1px solid ${_.colorScheme==="dark"?_.white:_.colors.gray[3]}`,left:`${st}px`,transition:`left 150ms ${_.transitionTimingFunction}`,"& > *":{margin:"auto"},"@media (prefers-reduced-motion)":{transitionDuration:_.respectReducedMotion?"0ms":""},"input:checked + * > &":{left:`calc(100% - ${tt}px - ${st}px)`,borderColor:_.white},"input:disabled + * > &":{borderColor:_.colorScheme==="dark"?_.colors.dark[4]:_.colors.gray[2],backgroundColor:_.colorScheme==="dark"?_.colors.dark[3]:_.colors.gray[0]}},trackLabel:{height:"100%",display:"grid",placeContent:"center",minWidth:it-tt,paddingInline:_.fn.size({size:a,sizes:trackLabelPaddings}),margin:`0 0 0 ${tt+st}px`,transition:`margin 150ms ${_.transitionTimingFunction}`,"input:checked + * > &":{margin:`0 ${tt+st}px 0 0`}}}});const useStyles$g=useStyles$f;var __defProp$8=Object.defineProperty,__defProps$6=Object.defineProperties,__getOwnPropDescs$6=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$8=Object.getOwnPropertySymbols,__hasOwnProp$8=Object.prototype.hasOwnProperty,__propIsEnum$8=Object.prototype.propertyIsEnumerable,__defNormalProp$8=(_,a,$)=>a in _?__defProp$8(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$8=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$8.call(a,$)&&__defNormalProp$8(_,$,a[$]);if(__getOwnPropSymbols$8)for(var $ of __getOwnPropSymbols$8(a))__propIsEnum$8.call(a,$)&&__defNormalProp$8(_,$,a[$]);return _},__spreadProps$6=(_,a)=>__defProps$6(_,__getOwnPropDescs$6(a)),__objRest$5=(_,a)=>{var $={};for(var j in _)__hasOwnProp$8.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$8)for(var j of __getOwnPropSymbols$8(_))a.indexOf(j)<0&&__propIsEnum$8.call(_,j)&&($[j]=_[j]);return $};const defaultProps$2={offLabel:"",onLabel:"",size:"sm",radius:"xl",error:!1},Switch=react.exports.forwardRef((_,a)=>{var $;const j=useComponentDefaultProps("Switch",defaultProps$2,_),{className:_e,color:et,label:tt,offLabel:rt,onLabel:nt,id:it,style:st,size:ot,radius:at,wrapperProps:lt,children:ct,unstyled:ut,styles:dt,classNames:ft,thumbIcon:pt,sx:yt,checked:mt,defaultChecked:_t,onChange:vt,labelPosition:ht,description:St,error:It,disabled:Lt}=j,Mt=__objRest$5(j,["className","color","label","offLabel","onLabel","id","style","size","radius","wrapperProps","children","unstyled","styles","classNames","thumbIcon","sx","checked","defaultChecked","onChange","labelPosition","description","error","disabled"]),Kt=useSwitchGroupContext(),{classes:kt}=useStyles$g({size:Kt?.size||ot,color:et,radius:at,labelPosition:ht,error:!!It},{unstyled:ut,styles:dt,classNames:ft,name:"Switch"}),{systemStyles:gt,rest:Et}=extractSystemStyles(Mt),xt=useId$1(it),Tt=Kt?{checked:Kt.value.includes(Et.value),onChange:Kt.onChange}:{},[At,Nt]=useUncontrolled({value:($=Tt.checked)!=null?$:mt,defaultValue:_t,finalValue:!1});return jsxs(InlineInput,{...__spreadValues$8(__spreadValues$8({className:_e,sx:yt,style:st,id:xt,size:Kt?.size||ot,labelPosition:ht,label:tt,description:St,error:It,disabled:Lt,__staticSelector:"Switch",classNames:ft,styles:dt,unstyled:ut,"data-checked":Tt.checked||void 0},gt),lt),children:[jsx("input",{...__spreadProps$6(__spreadValues$8({},Et),{disabled:Lt,checked:At,onChange:Bt=>{Kt?Tt.onChange(Bt):vt?.(Bt),Nt(Bt.currentTarget.checked)},id:xt,ref:a,type:"checkbox",className:kt.input})}),jsxs("label",{htmlFor:xt,className:kt.track,children:[jsx("div",{className:kt.thumb,children:pt}),jsx("div",{className:kt.trackLabel,children:At?nt:rt})]})]})});Switch.displayName="@mantine/core/Switch";Switch.Group=SwitchGroup;const TABS_ERRORS={context:"Tabs component was not found in the tree",value:"Tabs.Tab or Tabs.Panel component was rendered with invalid value or without value"},[TabsContextProvider,useTabsContext]=createSafeContext(TABS_ERRORS.context);var __defProp$7=Object.defineProperty,__getOwnPropSymbols$7=Object.getOwnPropertySymbols,__hasOwnProp$7=Object.prototype.hasOwnProperty,__propIsEnum$7=Object.prototype.propertyIsEnumerable,__defNormalProp$7=(_,a,$)=>a in _?__defProp$7(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$7=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$7.call(a,$)&&__defNormalProp$7(_,$,a[$]);if(__getOwnPropSymbols$7)for(var $ of __getOwnPropSymbols$7(a))__propIsEnum$7.call(a,$)&&__defNormalProp$7(_,$,a[$]);return _};function getVariantStyles$1({variant:_,orientation:a,inverted:$,placement:j},_e){const et=a==="vertical";return _==="default"?{[et?j==="left"?"borderRight":"borderLeft":$?"borderTop":"borderBottom"]:`2px solid ${_e.colorScheme==="dark"?_e.colors.dark[4]:_e.colors.gray[3]}`}:_==="outline"?{[et?j==="left"?"borderRight":"borderLeft":$?"borderTop":"borderBottom"]:`1px solid ${_e.colorScheme==="dark"?_e.colors.dark[4]:_e.colors.gray[3]}`}:_==="pills"?{gap:`calc(${_e.spacing.sm}px / 2)`}:{}}var useStyles$d=createStyles((_,a)=>{const $=a.orientation==="vertical";return{tabsList:__spreadValues$7({display:"flex",flexWrap:"wrap",flexDirection:$?"column":"row",justifyContent:GROUP_POSITIONS[a.position],'& [role="tab"]':{flex:a.grow?1:void 0}},getVariantStyles$1(a,_))}});const useStyles$e=useStyles$d;var __defProp$6=Object.defineProperty,__defProps$5=Object.defineProperties,__getOwnPropDescs$5=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$6=Object.getOwnPropertySymbols,__hasOwnProp$6=Object.prototype.hasOwnProperty,__propIsEnum$6=Object.prototype.propertyIsEnumerable,__defNormalProp$6=(_,a,$)=>a in _?__defProp$6(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$6=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$6.call(a,$)&&__defNormalProp$6(_,$,a[$]);if(__getOwnPropSymbols$6)for(var $ of __getOwnPropSymbols$6(a))__propIsEnum$6.call(a,$)&&__defNormalProp$6(_,$,a[$]);return _},__spreadProps$5=(_,a)=>__defProps$5(_,__getOwnPropDescs$5(a)),__objRest$4=(_,a)=>{var $={};for(var j in _)__hasOwnProp$6.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$6)for(var j of __getOwnPropSymbols$6(_))a.indexOf(j)<0&&__propIsEnum$6.call(_,j)&&($[j]=_[j]);return $};const TabsList=react.exports.forwardRef((_,a)=>{var $=_,{children:j,className:_e,grow:et=!1,position:tt="left"}=$,rt=__objRest$4($,["children","className","grow","position"]);const{orientation:nt,variant:it,color:st,radius:ot,inverted:at,placement:lt}=useTabsContext(),{classNames:ct,styles:ut,unstyled:dt}=useContextStylesApi(),{classes:ft,cx:pt}=useStyles$e({orientation:nt,grow:et,variant:it,color:st,position:tt,radius:ot,inverted:at,placement:lt},{name:"Tabs",unstyled:dt,classNames:ct,styles:ut});return jsx(Box,{...__spreadProps$5(__spreadValues$6({},rt),{className:pt(ft.tabsList,_e),ref:a,role:"tablist","aria-orientation":nt}),children:j})});TabsList.displayName="@mantine/core/TabsList";var useStyles$b=createStyles((_,{orientation:a})=>({panel:{flex:a==="vertical"?1:void 0}}));const useStyles$c=useStyles$b;var __defProp$5=Object.defineProperty,__defProps$4=Object.defineProperties,__getOwnPropDescs$4=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$5=Object.getOwnPropertySymbols,__hasOwnProp$5=Object.prototype.hasOwnProperty,__propIsEnum$5=Object.prototype.propertyIsEnumerable,__defNormalProp$5=(_,a,$)=>a in _?__defProp$5(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$5=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$5.call(a,$)&&__defNormalProp$5(_,$,a[$]);if(__getOwnPropSymbols$5)for(var $ of __getOwnPropSymbols$5(a))__propIsEnum$5.call(a,$)&&__defNormalProp$5(_,$,a[$]);return _},__spreadProps$4=(_,a)=>__defProps$4(_,__getOwnPropDescs$4(a)),__objRest$3=(_,a)=>{var $={};for(var j in _)__hasOwnProp$5.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$5)for(var j of __getOwnPropSymbols$5(_))a.indexOf(j)<0&&__propIsEnum$5.call(_,j)&&($[j]=_[j]);return $};const TabsPanel=react.exports.forwardRef((_,a)=>{var $=_,{value:j,children:_e,sx:et,className:tt}=$,rt=__objRest$3($,["value","children","sx","className"]);const nt=useTabsContext(),{classNames:it,styles:st,unstyled:ot}=useContextStylesApi(),{classes:at,cx:lt}=useStyles$c({orientation:nt.orientation,variant:nt.variant,color:nt.color,radius:nt.radius,inverted:nt.inverted,placement:nt.placement},{name:"Tabs",unstyled:ot,classNames:it,styles:st}),ct=nt.value===j,ut=nt.keepMounted||ct?_e:null;return jsx(Box,{...__spreadProps$4(__spreadValues$5({},rt),{ref:a,sx:[{display:ct?void 0:"none"},...packSx(et)],className:lt(at.panel,tt),role:"tabpanel",id:nt.getPanelId(j),"aria-labelledby":nt.getTabId(j)}),children:ut})});TabsPanel.displayName="@mantine/core/TabsPanel";var __defProp$4=Object.defineProperty,__defProps$3=Object.defineProperties,__getOwnPropDescs$3=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$4=Object.getOwnPropertySymbols,__hasOwnProp$4=Object.prototype.hasOwnProperty,__propIsEnum$4=Object.prototype.propertyIsEnumerable,__defNormalProp$4=(_,a,$)=>a in _?__defProp$4(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$4=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$4.call(a,$)&&__defNormalProp$4(_,$,a[$]);if(__getOwnPropSymbols$4)for(var $ of __getOwnPropSymbols$4(a))__propIsEnum$4.call(a,$)&&__defNormalProp$4(_,$,a[$]);return _},__spreadProps$3=(_,a)=>__defProps$3(_,__getOwnPropDescs$3(a));function getVariantStyles(_,{variant:a,orientation:$,color:j,radius:_e,inverted:et,placement:tt}){const rt=$==="vertical",nt=_.fn.variant({color:j,variant:"filled"}),it=_.fn.radius(_e),st=$==="vertical"?tt==="left"?`${it}px 0 0 ${it}px`:` 0 ${it}px ${it}px 0`:et?`0 0 ${it}px ${it}px`:`${it}px ${it}px 0 0`;return a==="default"?__spreadProps$3(__spreadValues$4({[rt?tt==="left"?"borderRight":"borderLeft":et?"borderTop":"borderBottom"]:"2px solid transparent",[rt?tt==="left"?"marginRight":"marginLeft":et?"marginTop":"marginBottom"]:-2,borderRadius:st},_.fn.hover({backgroundColor:_.colorScheme==="dark"?_.colors.dark[6]:_.colors.gray[0],borderColor:_.colorScheme==="dark"?_.colors.dark[4]:_.colors.gray[3]})),{"&[data-active]":__spreadValues$4({borderColor:nt.background,color:_.colorScheme==="dark"?_.white:_.black},_.fn.hover({borderColor:nt.background}))}):a==="outline"?{borderRadius:st,border:"1px solid transparent",[rt?tt==="left"?"borderRight":"borderLeft":et?"borderTop":"borderBottom"]:"none","&[data-active]":{borderColor:_.colorScheme==="dark"?_.colors.dark[4]:_.colors.gray[3],"&::before":{content:'""',backgroundColor:_.colorScheme==="dark"?_.colors.dark[7]:_.white,position:"absolute",bottom:rt?0:et?"unset":-1,top:rt?0:et?-1:"unset",[rt?"width":"height"]:1,right:rt?tt==="left"?-1:"unset":0,left:rt?tt==="left"?"unset":-1:0}}}:a==="pills"?__spreadProps$3(__spreadValues$4({borderRadius:_.fn.radius(_e)},_.fn.hover({backgroundColor:_.colorScheme==="dark"?_.colors.dark[6]:_.colors.gray[0]})),{"&[data-active]":__spreadValues$4({backgroundColor:nt.background,color:_.white},_.fn.hover({backgroundColor:nt.background}))}):{}}var useStyles$9=createStyles((_,a)=>({tabLabel:{},tab:__spreadValues$4({position:"relative",padding:`${_.spacing.xs}px ${_.spacing.md}px`,paddingLeft:a.withIcon?_.spacing.xs:void 0,paddingRight:a.withRightSection?_.spacing.xs:void 0,fontSize:_.fontSizes.sm,whiteSpace:"nowrap",zIndex:0,display:"flex",alignItems:"center",justifyContent:a.orientation==="horizontal"?"center":void 0,lineHeight:1,"&:disabled":__spreadValues$4({opacity:.5,cursor:"not-allowed"},_.fn.hover({backgroundColor:"transparent"})),"&:focus":{zIndex:1}},getVariantStyles(_,a)),tabRightSection:{display:"flex",justifyContent:"center",alignItems:"center","&:not(:only-child)":{marginLeft:7}},tabIcon:{display:"flex",justifyContent:"center",alignItems:"center","&:not(:only-child)":{marginRight:7}}}));const useStyles$a=useStyles$9;var __defProp$3=Object.defineProperty,__defProps$2=Object.defineProperties,__getOwnPropDescs$2=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$3=Object.getOwnPropertySymbols,__hasOwnProp$3=Object.prototype.hasOwnProperty,__propIsEnum$3=Object.prototype.propertyIsEnumerable,__defNormalProp$3=(_,a,$)=>a in _?__defProp$3(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$3=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$3.call(a,$)&&__defNormalProp$3(_,$,a[$]);if(__getOwnPropSymbols$3)for(var $ of __getOwnPropSymbols$3(a))__propIsEnum$3.call(a,$)&&__defNormalProp$3(_,$,a[$]);return _},__spreadProps$2=(_,a)=>__defProps$2(_,__getOwnPropDescs$2(a)),__objRest$2=(_,a)=>{var $={};for(var j in _)__hasOwnProp$3.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$3)for(var j of __getOwnPropSymbols$3(_))a.indexOf(j)<0&&__propIsEnum$3.call(_,j)&&($[j]=_[j]);return $};const Tab=react.exports.forwardRef((_,a)=>{var $=_,{value:j,children:_e,onKeyDown:et,onClick:tt,className:rt,icon:nt,rightSection:it,color:st}=$,ot=__objRest$2($,["value","children","onKeyDown","onClick","className","icon","rightSection","color"]);const at=useTabsContext(),{classNames:lt,styles:ct,unstyled:ut}=useContextStylesApi(),dt=!!nt,ft=!!it,{theme:pt,classes:yt,cx:mt}=useStyles$a({withIcon:dt||ft&&!_e,withRightSection:ft||dt&&!_e,orientation:at.orientation,color:st||at.color,variant:at.variant,radius:at.radius,inverted:at.inverted,placement:at.placement},{name:"Tabs",unstyled:ut,classNames:lt,styles:ct}),_t=j===at.value,vt=ht=>{at.onTabChange(at.allowTabDeactivation&&j===at.value?null:j),tt?.(ht)};return jsxs(UnstyledButton,{...__spreadProps$2(__spreadValues$3({},ot),{unstyled:ut,className:mt(yt.tab,rt),"data-active":_t||void 0,ref:a,type:"button",role:"tab",id:at.getTabId(j),"aria-selected":_t,tabIndex:_t||at.value===null?0:-1,"aria-controls":at.getPanelId(j),onClick:vt,onKeyDown:createScopedKeydownHandler({siblingSelector:'[role="tab"]',parentSelector:'[role="tablist"]',activateOnFocus:at.activateTabWithKeyboard,loop:at.loop,dir:pt.dir,orientation:at.orientation,onKeyDown:et})}),children:[nt&&jsx("div",{className:yt.tabIcon,children:nt}),_e&&jsx("div",{className:yt.tabLabel,children:_e}),it&&jsx("div",{className:yt.tabRightSection,children:it})]})});Tab.displayName="@mantine/core/Tab";function TabsProvider({defaultValue:_,value:a,onTabChange:$,orientation:j,children:_e,loop:et,id:tt,activateTabWithKeyboard:rt,allowTabDeactivation:nt,variant:it,color:st,radius:ot,inverted:at,placement:lt,keepMounted:ct=!0}){const ut=useId$1(tt),[dt,ft]=useUncontrolled({value:a,defaultValue:_,finalValue:null,onChange:$});return jsx(TabsContextProvider,{value:{placement:lt,value:dt,orientation:j,id:ut,loop:et,activateTabWithKeyboard:rt,getTabId:getSafeId(`${ut}-tab`,TABS_ERRORS.value),getPanelId:getSafeId(`${ut}-panel`,TABS_ERRORS.value),onTabChange:ft,allowTabDeactivation:nt,variant:it,color:st,radius:ot,inverted:at,keepMounted:ct},children:_e})}TabsProvider.displayName="@mantine/core/TabsProvider";var useStyles$7=createStyles((_,{orientation:a,placement:$})=>({root:{display:a==="vertical"?"flex":void 0,flexDirection:$==="right"?"row-reverse":"row"}}));const useStyles$8=useStyles$7;var __defProp$2=Object.defineProperty,__defProps$1=Object.defineProperties,__getOwnPropDescs$1=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$2=Object.getOwnPropertySymbols,__hasOwnProp$2=Object.prototype.hasOwnProperty,__propIsEnum$2=Object.prototype.propertyIsEnumerable,__defNormalProp$2=(_,a,$)=>a in _?__defProp$2(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$2=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$2.call(a,$)&&__defNormalProp$2(_,$,a[$]);if(__getOwnPropSymbols$2)for(var $ of __getOwnPropSymbols$2(a))__propIsEnum$2.call(a,$)&&__defNormalProp$2(_,$,a[$]);return _},__spreadProps$1=(_,a)=>__defProps$1(_,__getOwnPropDescs$1(a)),__objRest$1=(_,a)=>{var $={};for(var j in _)__hasOwnProp$2.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols$2)for(var j of __getOwnPropSymbols$2(_))a.indexOf(j)<0&&__propIsEnum$2.call(_,j)&&($[j]=_[j]);return $};const defaultProps$1={orientation:"horizontal",loop:!0,activateTabWithKeyboard:!0,allowTabDeactivation:!1,unstyled:!1,inverted:!1,variant:"default",placement:"left"},Tabs=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Tabs",defaultProps$1,_),{defaultValue:j,value:_e,orientation:et,loop:tt,activateTabWithKeyboard:rt,allowTabDeactivation:nt,children:it,id:st,onTabChange:ot,variant:at,color:lt,className:ct,unstyled:ut,classNames:dt,styles:ft,radius:pt,inverted:yt,keepMounted:mt,placement:_t}=$,vt=__objRest$1($,["defaultValue","value","orientation","loop","activateTabWithKeyboard","allowTabDeactivation","children","id","onTabChange","variant","color","className","unstyled","classNames","styles","radius","inverted","keepMounted","placement"]),{classes:ht,cx:St}=useStyles$8({orientation:et,color:lt,variant:at,radius:pt,inverted:yt,placement:_t},{unstyled:ut,name:"Tabs",classNames:dt,styles:ft});return jsx(StylesApiProvider,{classNames:dt,styles:ft,unstyled:ut,children:jsx(TabsProvider,{activateTabWithKeyboard:rt,defaultValue:j,orientation:et,onTabChange:ot,value:_e,id:st,loop:tt,allowTabDeactivation:nt,color:lt,variant:at,radius:pt,inverted:yt,keepMounted:mt,placement:_t,children:jsx(Box,{...__spreadProps$1(__spreadValues$2({},vt),{className:St(ht.root,ct),id:st,ref:a}),children:it})})})});Tabs.List=TabsList;Tabs.Tab=Tab;Tabs.Panel=TabsPanel;Tabs.displayName="@mantine/core/Tabs";var __defProp$1=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$1=Object.getOwnPropertySymbols,__hasOwnProp$1=Object.prototype.hasOwnProperty,__propIsEnum$1=Object.prototype.propertyIsEnumerable,__defNormalProp$1=(_,a,$)=>a in _?__defProp$1(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues$1=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp$1.call(a,$)&&__defNormalProp$1(_,$,a[$]);if(__getOwnPropSymbols$1)for(var $ of __getOwnPropSymbols$1(a))__propIsEnum$1.call(a,$)&&__defNormalProp$1(_,$,a[$]);return _},__spreadProps=(_,a)=>__defProps(_,__getOwnPropDescs(a));function getFontSize(_,a,$){return typeof _<"u"?_ in $.headings.sizes?$.headings.sizes[_].fontSize:_:$.headings.sizes[a].fontSize}function getLineHeight(_,a,$){return typeof _<"u"&&_ in $.headings.sizes?$.headings.sizes[_].lineHeight:$.headings.sizes[a].lineHeight}var useStyles$5=createStyles((_,{element:a,weight:$,size:j,inline:_e})=>({root:__spreadProps(__spreadValues$1({},_.fn.fontStyles()),{fontFamily:_.headings.fontFamily,fontWeight:$||_.headings.sizes[a].fontWeight||_.headings.fontWeight,fontSize:getFontSize(j,a,_),lineHeight:_e?1:getLineHeight(j,a,_),margin:0})}));const useStyles$6=useStyles$5;var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(_,a,$)=>a in _?__defProp(_,a,{enumerable:!0,configurable:!0,writable:!0,value:$}):_[a]=$,__spreadValues=(_,a)=>{for(var $ in a||(a={}))__hasOwnProp.call(a,$)&&__defNormalProp(_,$,a[$]);if(__getOwnPropSymbols)for(var $ of __getOwnPropSymbols(a))__propIsEnum.call(a,$)&&__defNormalProp(_,$,a[$]);return _},__objRest=(_,a)=>{var $={};for(var j in _)__hasOwnProp.call(_,j)&&a.indexOf(j)<0&&($[j]=_[j]);if(_!=null&&__getOwnPropSymbols)for(var j of __getOwnPropSymbols(_))a.indexOf(j)<0&&__propIsEnum.call(_,j)&&($[j]=_[j]);return $};const defaultProps={order:1},Title=react.exports.forwardRef((_,a)=>{const $=useComponentDefaultProps("Title",defaultProps,_),{className:j,order:_e,children:et,unstyled:tt,size:rt,weight:nt,inline:it}=$,st=__objRest($,["className","order","children","unstyled","size","weight","inline"]),{classes:ot,cx:at}=useStyles$6({element:`h${_e}`,weight:nt,size:rt,inline:it},{name:"Title",unstyled:tt});return[1,2,3,4,5,6].includes(_e)?jsx(Text,{...__spreadValues({component:`h${_e}`,ref:a,className:at(ot.root,j)},st),children:et}):null});Title.displayName="@mantine/core/Title";/**
 * @remix-run/router v1.0.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(_){for(var a=1;a<arguments.length;a++){var $=arguments[a];for(var j in $)Object.prototype.hasOwnProperty.call($,j)&&(_[j]=$[j])}return _},_extends$1.apply(this,arguments)}var Action;(function(_){_.Pop="POP",_.Push="PUSH",_.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(_){_===void 0&&(_={});function a(j,_e){let{pathname:et,search:tt,hash:rt}=j.location;return createLocation("",{pathname:et,search:tt,hash:rt},_e.state&&_e.state.usr||null,_e.state&&_e.state.key||"default")}function $(j,_e){return typeof _e=="string"?_e:createPath(_e)}return getUrlBasedHistory(a,$,null,_)}function createKey$1(){return Math.random().toString(36).substr(2,8)}function getHistoryState(_){return{usr:_.state,key:_.key}}function createLocation(_,a,$,j){return $===void 0&&($=null),_extends$1({pathname:typeof _=="string"?_:_.pathname,search:"",hash:""},typeof a=="string"?parsePath(a):a,{state:$,key:a&&a.key||j||createKey$1()})}function createPath(_){let{pathname:a="/",search:$="",hash:j=""}=_;return $&&$!=="?"&&(a+=$.charAt(0)==="?"?$:"?"+$),j&&j!=="#"&&(a+=j.charAt(0)==="#"?j:"#"+j),a}function parsePath(_){let a={};if(_){let $=_.indexOf("#");$>=0&&(a.hash=_.substr($),_=_.substr(0,$));let j=_.indexOf("?");j>=0&&(a.search=_.substr(j),_=_.substr(0,j)),_&&(a.pathname=_)}return a}function createURL(_){let a=typeof window<"u"&&typeof window.location<"u"&&window.location.origin!=="null"?window.location.origin:"unknown://unknown",$=typeof _=="string"?_:createPath(_);return new URL($,a)}function getUrlBasedHistory(_,a,$,j){j===void 0&&(j={});let{window:_e=document.defaultView,v5Compat:et=!1}=j,tt=_e.history,rt=Action.Pop,nt=null;function it(){rt=Action.Pop,nt&&nt({action:rt,location:at.location})}function st(lt,ct){rt=Action.Push;let ut=createLocation(at.location,lt,ct);$&&$(ut,lt);let dt=getHistoryState(ut),ft=at.createHref(ut);try{tt.pushState(dt,"",ft)}catch{_e.location.assign(ft)}et&&nt&&nt({action:rt,location:at.location})}function ot(lt,ct){rt=Action.Replace;let ut=createLocation(at.location,lt,ct);$&&$(ut,lt);let dt=getHistoryState(ut),ft=at.createHref(ut);tt.replaceState(dt,"",ft),et&&nt&&nt({action:rt,location:at.location})}let at={get action(){return rt},get location(){return _(_e,tt)},listen(lt){if(nt)throw new Error("A history only accepts one active listener");return _e.addEventListener(PopStateEventType,it),nt=lt,()=>{_e.removeEventListener(PopStateEventType,it),nt=null}},createHref(lt){return a(_e,lt)},encodeLocation(lt){let ct=createURL(createPath(lt));return _extends$1({},lt,{pathname:ct.pathname,search:ct.search,hash:ct.hash})},push:st,replace:ot,go(lt){return tt.go(lt)}};return at}var ResultType;(function(_){_.data="data",_.deferred="deferred",_.redirect="redirect",_.error="error"})(ResultType||(ResultType={}));function matchRoutes(_,a,$){$===void 0&&($="/");let j=typeof a=="string"?parsePath(a):a,_e=stripBasename(j.pathname||"/",$);if(_e==null)return null;let et=flattenRoutes(_);rankRouteBranches(et);let tt=null;for(let rt=0;tt==null&&rt<et.length;++rt)tt=matchRouteBranch(et[rt],safelyDecodeURI(_e));return tt}function flattenRoutes(_,a,$,j){return a===void 0&&(a=[]),$===void 0&&($=[]),j===void 0&&(j=""),_.forEach((_e,et)=>{let tt={relativePath:_e.path||"",caseSensitive:_e.caseSensitive===!0,childrenIndex:et,route:_e};tt.relativePath.startsWith("/")&&(invariant(tt.relativePath.startsWith(j),'Absolute route path "'+tt.relativePath+'" nested under path '+('"'+j+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),tt.relativePath=tt.relativePath.slice(j.length));let rt=joinPaths([j,tt.relativePath]),nt=$.concat(tt);_e.children&&_e.children.length>0&&(invariant(_e.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+rt+'".')),flattenRoutes(_e.children,a,nt,rt)),!(_e.path==null&&!_e.index)&&a.push({path:rt,score:computeScore$1(rt,_e.index),routesMeta:nt})}),a}function rankRouteBranches(_){_.sort((a,$)=>a.score!==$.score?$.score-a.score:compareIndexes(a.routesMeta.map(j=>j.childrenIndex),$.routesMeta.map(j=>j.childrenIndex)))}const paramRe=/^:\w+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=_=>_==="*";function computeScore$1(_,a){let $=_.split("/"),j=$.length;return $.some(isSplat)&&(j+=splatPenalty),a&&(j+=indexRouteValue),$.filter(_e=>!isSplat(_e)).reduce((_e,et)=>_e+(paramRe.test(et)?dynamicSegmentValue:et===""?emptySegmentValue:staticSegmentValue),j)}function compareIndexes(_,a){return _.length===a.length&&_.slice(0,-1).every((j,_e)=>j===a[_e])?_[_.length-1]-a[a.length-1]:0}function matchRouteBranch(_,a){let{routesMeta:$}=_,j={},_e="/",et=[];for(let tt=0;tt<$.length;++tt){let rt=$[tt],nt=tt===$.length-1,it=_e==="/"?a:a.slice(_e.length)||"/",st=matchPath({path:rt.relativePath,caseSensitive:rt.caseSensitive,end:nt},it);if(!st)return null;Object.assign(j,st.params);let ot=rt.route;et.push({params:j,pathname:joinPaths([_e,st.pathname]),pathnameBase:normalizePathname(joinPaths([_e,st.pathnameBase])),route:ot}),st.pathnameBase!=="/"&&(_e=joinPaths([_e,st.pathnameBase]))}return et}function matchPath(_,a){typeof _=="string"&&(_={path:_,caseSensitive:!1,end:!0});let[$,j]=compilePath(_.path,_.caseSensitive,_.end),_e=a.match($);if(!_e)return null;let et=_e[0],tt=et.replace(/(.)\/+$/,"$1"),rt=_e.slice(1);return{params:j.reduce((it,st,ot)=>{if(st==="*"){let at=rt[ot]||"";tt=et.slice(0,et.length-at.length).replace(/(.)\/+$/,"$1")}return it[st]=safelyDecodeURIComponent(rt[ot]||"",st),it},{}),pathname:et,pathnameBase:tt,pattern:_}}function compilePath(_,a,$){a===void 0&&(a=!1),$===void 0&&($=!0),warning(_==="*"||!_.endsWith("*")||_.endsWith("/*"),'Route path "'+_+'" will be treated as if it were '+('"'+_.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+_.replace(/\*$/,"/*")+'".'));let j=[],_e="^"+_.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,(tt,rt)=>(j.push(rt),"([^\\/]+)"));return _.endsWith("*")?(j.push("*"),_e+=_==="*"||_==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):$?_e+="\\/*$":_!==""&&_!=="/"&&(_e+="(?:(?=\\/|$))"),[new RegExp(_e,a?void 0:"i"),j]}function safelyDecodeURI(_){try{return decodeURI(_)}catch(a){return warning(!1,'The URL path "'+_+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+a+").")),_}}function safelyDecodeURIComponent(_,a){try{return decodeURIComponent(_)}catch($){return warning(!1,'The value for the URL param "'+a+'" will not be decoded because'+(' the string "'+_+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+$+").")),_}}function stripBasename(_,a){if(a==="/")return _;if(!_.toLowerCase().startsWith(a.toLowerCase()))return null;let $=a.endsWith("/")?a.length-1:a.length,j=_.charAt($);return j&&j!=="/"?null:_.slice($)||"/"}function invariant(_,a){if(_===!1||_===null||typeof _>"u")throw new Error(a)}function warning(_,a){if(!_){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function resolvePath$2(_,a){a===void 0&&(a="/");let{pathname:$,search:j="",hash:_e=""}=typeof _=="string"?parsePath(_):_;return{pathname:$?$.startsWith("/")?$:resolvePathname($,a):a,search:normalizeSearch(j),hash:normalizeHash(_e)}}function resolvePathname(_,a){let $=a.replace(/\/+$/,"").split("/");return _.split("/").forEach(_e=>{_e===".."?$.length>1&&$.pop():_e!=="."&&$.push(_e)}),$.length>1?$.join("/"):"/"}function getInvalidPathError(_,a,$,j){return"Cannot include a '"+_+"' character in a manually specified "+("`to."+a+"` field ["+JSON.stringify(j)+"].  Please separate it out to the ")+("`to."+$+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(_){return _.filter((a,$)=>$===0||a.route.path&&a.route.path.length>0)}function resolveTo(_,a,$,j){j===void 0&&(j=!1);let _e;typeof _=="string"?_e=parsePath(_):(_e=_extends$1({},_),invariant(!_e.pathname||!_e.pathname.includes("?"),getInvalidPathError("?","pathname","search",_e)),invariant(!_e.pathname||!_e.pathname.includes("#"),getInvalidPathError("#","pathname","hash",_e)),invariant(!_e.search||!_e.search.includes("#"),getInvalidPathError("#","search","hash",_e)));let et=_===""||_e.pathname==="",tt=et?"/":_e.pathname,rt;if(j||tt==null)rt=$;else{let ot=a.length-1;if(tt.startsWith("..")){let at=tt.split("/");for(;at[0]==="..";)at.shift(),ot-=1;_e.pathname=at.join("/")}rt=ot>=0?a[ot]:"/"}let nt=resolvePath$2(_e,rt),it=tt&&tt!=="/"&&tt.endsWith("/"),st=(et||tt===".")&&$.endsWith("/");return!nt.pathname.endsWith("/")&&(it||st)&&(nt.pathname+="/"),nt}const joinPaths=_=>_.join("/").replace(/\/\/+/g,"/"),normalizePathname=_=>_.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=_=>!_||_==="?"?"":_.startsWith("?")?_:"?"+_,normalizeHash=_=>!_||_==="#"?"":_.startsWith("#")?_:"#"+_;class ErrorResponse{constructor(a,$,j){this.status=a,this.statusText=$||"",this.data=j}}function isRouteErrorResponse(_){return _ instanceof ErrorResponse}const validActionMethods=new Set(["POST","PUT","PATCH","DELETE"]);[...validActionMethods];/**
 * React Router v6.4.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(_){for(var a=1;a<arguments.length;a++){var $=arguments[a];for(var j in $)Object.prototype.hasOwnProperty.call($,j)&&(_[j]=$[j])}return _},_extends.apply(this,arguments)}function isPolyfill(_,a){return _===a&&(_!==0||1/_===1/a)||_!==_&&a!==a}const is$1=typeof Object.is=="function"?Object.is:isPolyfill,{useState,useEffect,useLayoutEffect,useDebugValue}=React$1;function useSyncExternalStore$2(_,a,$){const j=a(),[{inst:_e},et]=useState({inst:{value:j,getSnapshot:a}});return useLayoutEffect(()=>{_e.value=j,_e.getSnapshot=a,checkIfSnapshotChanged(_e)&&et({inst:_e})},[_,j,a]),useEffect(()=>(checkIfSnapshotChanged(_e)&&et({inst:_e}),_(()=>{checkIfSnapshotChanged(_e)&&et({inst:_e})})),[_]),useDebugValue(j),j}function checkIfSnapshotChanged(_){const a=_.getSnapshot,$=_.value;try{const j=a();return!is$1($,j)}catch{return!0}}function useSyncExternalStore$1(_,a,$){return a()}const canUseDOM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",isServerEnvironment=!canUseDOM,shim=isServerEnvironment?useSyncExternalStore$1:useSyncExternalStore$2;"useSyncExternalStore"in React$1&&(_=>_.useSyncExternalStore)(React$1);const DataStaticRouterContext=react.exports.createContext(null),DataRouterContext=react.exports.createContext(null),DataRouterStateContext=react.exports.createContext(null),NavigationContext=react.exports.createContext(null),LocationContext=react.exports.createContext(null),RouteContext=react.exports.createContext({outlet:null,matches:[]}),RouteErrorContext=react.exports.createContext(null);function useHref(_,a){let{relative:$}=a===void 0?{}:a;useInRouterContext()||invariant(!1);let{basename:j,navigator:_e}=react.exports.useContext(NavigationContext),{hash:et,pathname:tt,search:rt}=useResolvedPath(_,{relative:$}),nt=tt;return j!=="/"&&(nt=tt==="/"?j:joinPaths([j,tt])),_e.createHref({pathname:nt,search:rt,hash:et})}function useInRouterContext(){return react.exports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),react.exports.useContext(LocationContext).location}function useNavigate(){useInRouterContext()||invariant(!1);let{basename:_,navigator:a}=react.exports.useContext(NavigationContext),{matches:$}=react.exports.useContext(RouteContext),{pathname:j}=useLocation(),_e=JSON.stringify(getPathContributingMatches($).map(rt=>rt.pathnameBase)),et=react.exports.useRef(!1);return react.exports.useEffect(()=>{et.current=!0}),react.exports.useCallback(function(rt,nt){if(nt===void 0&&(nt={}),!et.current)return;if(typeof rt=="number"){a.go(rt);return}let it=resolveTo(rt,JSON.parse(_e),j,nt.relative==="path");_!=="/"&&(it.pathname=it.pathname==="/"?_:joinPaths([_,it.pathname])),(nt.replace?a.replace:a.push)(it,nt.state,nt)},[_,a,_e,j])}function useResolvedPath(_,a){let{relative:$}=a===void 0?{}:a,{matches:j}=react.exports.useContext(RouteContext),{pathname:_e}=useLocation(),et=JSON.stringify(getPathContributingMatches(j).map(tt=>tt.pathnameBase));return react.exports.useMemo(()=>resolveTo(_,JSON.parse(et),_e,$==="path"),[_,et,_e,$])}function useRoutes(_,a){useInRouterContext()||invariant(!1);let $=react.exports.useContext(DataRouterStateContext),{matches:j}=react.exports.useContext(RouteContext),_e=j[j.length-1],et=_e?_e.params:{};_e&&_e.pathname;let tt=_e?_e.pathnameBase:"/";_e&&_e.route;let rt=useLocation(),nt;if(a){var it;let ct=typeof a=="string"?parsePath(a):a;tt==="/"||((it=ct.pathname)==null?void 0:it.startsWith(tt))||invariant(!1),nt=ct}else nt=rt;let st=nt.pathname||"/",ot=tt==="/"?st:st.slice(tt.length)||"/",at=matchRoutes(_,{pathname:ot}),lt=_renderMatches(at&&at.map(ct=>Object.assign({},ct,{params:Object.assign({},et,ct.params),pathname:joinPaths([tt,ct.pathname]),pathnameBase:ct.pathnameBase==="/"?tt:joinPaths([tt,ct.pathnameBase])})),j,$||void 0);return a&&lt?jsx(LocationContext.Provider,{value:{location:_extends({pathname:"/",search:"",hash:"",state:null,key:"default"},nt),navigationType:Action.Pop},children:lt}):lt}function DefaultErrorElement(){let _=useRouteError(),a=isRouteErrorResponse(_)?_.status+" "+_.statusText:_ instanceof Error?_.message:JSON.stringify(_),$=_ instanceof Error?_.stack:null,j="rgba(200,200,200, 0.5)",_e={padding:"0.5rem",backgroundColor:j},et={padding:"2px 4px",backgroundColor:j};return jsxs(Fragment$1,{children:[jsx("h2",{children:"Unhandled Thrown Error!"}),jsx("h3",{style:{fontStyle:"italic"},children:a}),$?jsx("pre",{style:_e,children:$}):null,jsx("p",{children:"\u{1F4BF} Hey developer \u{1F44B}"}),jsxs("p",{children:["You can provide a way better UX than this when your app throws errors by providing your own\xA0",jsx("code",{style:et,children:"errorElement"})," props on\xA0",jsx("code",{style:et,children:"<Route>"})]})]})}class RenderErrorBoundary extends react.exports.Component{constructor(a){super(a),this.state={location:a.location,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,$){return $.location!==a.location?{error:a.error,location:a.location}:{error:a.error||$.error,location:$.location}}componentDidCatch(a,$){console.error("React Router caught the following error during render",a,$)}render(){return this.state.error?jsx(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component}):this.props.children}}function RenderedRoute(_){let{routeContext:a,match:$,children:j}=_,_e=react.exports.useContext(DataStaticRouterContext);return _e&&$.route.errorElement&&(_e._deepestRenderedBoundaryId=$.route.id),jsx(RouteContext.Provider,{value:a,children:j})}function _renderMatches(_,a,$){if(a===void 0&&(a=[]),_==null)if($!=null&&$.errors)_=$.matches;else return null;let j=_,_e=$?.errors;if(_e!=null){let et=j.findIndex(tt=>tt.route.id&&_e?.[tt.route.id]);et>=0||invariant(!1),j=j.slice(0,Math.min(j.length,et+1))}return j.reduceRight((et,tt,rt)=>{let nt=tt.route.id?_e?.[tt.route.id]:null,it=$?tt.route.errorElement||jsx(DefaultErrorElement,{}):null,st=()=>jsx(RenderedRoute,{match:tt,routeContext:{outlet:et,matches:a.concat(j.slice(0,rt+1))},children:nt?it:tt.route.element!==void 0?tt.route.element:et});return $&&(tt.route.errorElement||rt===0)?jsx(RenderErrorBoundary,{location:$.location,component:it,error:nt,children:st()}):st()},null)}var DataRouterHook$1;(function(_){_.UseRevalidator="useRevalidator"})(DataRouterHook$1||(DataRouterHook$1={}));var DataRouterStateHook$1;(function(_){_.UseLoaderData="useLoaderData",_.UseActionData="useActionData",_.UseRouteError="useRouteError",_.UseNavigation="useNavigation",_.UseRouteLoaderData="useRouteLoaderData",_.UseMatches="useMatches",_.UseRevalidator="useRevalidator"})(DataRouterStateHook$1||(DataRouterStateHook$1={}));function useDataRouterState(_){let a=react.exports.useContext(DataRouterStateContext);return a||invariant(!1),a}function useRouteError(){var _;let a=react.exports.useContext(RouteErrorContext),$=useDataRouterState(DataRouterStateHook$1.UseRouteError),j=react.exports.useContext(RouteContext),_e=j.matches[j.matches.length-1];return a||(j||invariant(!1),_e.route.id||invariant(!1),(_=$.errors)==null?void 0:_[_e.route.id])}function Route(_){invariant(!1)}function Router(_){let{basename:a="/",children:$=null,location:j,navigationType:_e=Action.Pop,navigator:et,static:tt=!1}=_;useInRouterContext()&&invariant(!1);let rt=a.replace(/^\/*/,"/"),nt=react.exports.useMemo(()=>({basename:rt,navigator:et,static:tt}),[rt,et,tt]);typeof j=="string"&&(j=parsePath(j));let{pathname:it="/",search:st="",hash:ot="",state:at=null,key:lt="default"}=j,ct=react.exports.useMemo(()=>{let ut=stripBasename(it,rt);return ut==null?null:{pathname:ut,search:st,hash:ot,state:at,key:lt}},[rt,it,st,ot,at,lt]);return ct==null?null:jsx(NavigationContext.Provider,{value:nt,children:jsx(LocationContext.Provider,{children:$,value:{location:ct,navigationType:_e}})})}function Routes(_){let{children:a,location:$}=_,j=react.exports.useContext(DataRouterContext),_e=j&&!a?j.router.routes:createRoutesFromChildren(a);return useRoutes(_e,$)}var AwaitRenderStatus;(function(_){_[_.pending=0]="pending",_[_.success=1]="success",_[_.error=2]="error"})(AwaitRenderStatus||(AwaitRenderStatus={}));new Promise(()=>{});function createRoutesFromChildren(_,a){a===void 0&&(a=[]);let $=[];return react.exports.Children.forEach(_,(j,_e)=>{if(!react.exports.isValidElement(j))return;if(j.type===react.exports.Fragment){$.push.apply($,createRoutesFromChildren(j.props.children,a));return}j.type!==Route&&invariant(!1),!j.props.index||!j.props.children||invariant(!1);let et=[...a,_e],tt={id:j.props.id||et.join("-"),caseSensitive:j.props.caseSensitive,element:j.props.element,index:j.props.index,path:j.props.path,loader:j.props.loader,action:j.props.action,errorElement:j.props.errorElement,hasErrorBoundary:j.props.errorElement!=null,shouldRevalidate:j.props.shouldRevalidate,handle:j.props.handle};j.props.children&&(tt.children=createRoutesFromChildren(j.props.children,et)),$.push(tt)}),$}/**
 * React Router DOM v6.4.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _objectWithoutPropertiesLoose(_,a){if(_==null)return{};var $={},j=Object.keys(_),_e,et;for(et=0;et<j.length;et++)_e=j[et],!(a.indexOf(_e)>=0)&&($[_e]=_[_e]);return $}function isModifiedEvent(_){return!!(_.metaKey||_.altKey||_.ctrlKey||_.shiftKey)}function shouldProcessLinkClick(_,a){return _.button===0&&(!a||a==="_self")&&!isModifiedEvent(_)}const _excluded=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function BrowserRouter(_){let{basename:a,children:$,window:j}=_,_e=react.exports.useRef();_e.current==null&&(_e.current=createBrowserHistory({window:j,v5Compat:!0}));let et=_e.current,[tt,rt]=react.exports.useState({action:et.action,location:et.location});return react.exports.useLayoutEffect(()=>et.listen(rt),[et]),jsx(Router,{basename:a,children:$,location:tt.location,navigationType:tt.action,navigator:et})}const Link=react.exports.forwardRef(function(a,$){let{onClick:j,relative:_e,reloadDocument:et,replace:tt,state:rt,target:nt,to:it,preventScrollReset:st}=a,ot=_objectWithoutPropertiesLoose(a,_excluded),at=useHref(it,{relative:_e}),lt=useLinkClickHandler(it,{replace:tt,state:rt,target:nt,preventScrollReset:st,relative:_e});function ct(ut){j&&j(ut),ut.defaultPrevented||lt(ut)}return jsx("a",{...ot,href:at,onClick:et?j:ct,ref:$,target:nt})});var DataRouterHook;(function(_){_.UseScrollRestoration="useScrollRestoration",_.UseSubmitImpl="useSubmitImpl",_.UseFetcher="useFetcher"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(_){_.UseFetchers="useFetchers",_.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(_,a){let{target:$,replace:j,state:_e,preventScrollReset:et,relative:tt}=a===void 0?{}:a,rt=useNavigate(),nt=useLocation(),it=useResolvedPath(_,{relative:tt});return react.exports.useCallback(st=>{if(shouldProcessLinkClick(st,$)){st.preventDefault();let ot=j!==void 0?j:createPath(nt)===createPath(it);rt(_,{replace:ot,state:_e,preventScrollReset:et,relative:tt})}},[nt,rt,it,j,_e,$,_,et,tt])}function t(){return t=Object.assign?Object.assign.bind():function(_){for(var a=1;a<arguments.length;a++){var $=arguments[a];for(var j in $)Object.prototype.hasOwnProperty.call($,j)&&(_[j]=$[j])}return _},t.apply(this,arguments)}function o(_,a){if(_==null)return{};var $,j,_e=function(tt,rt){if(tt==null)return{};var nt,it,st={},ot=Object.keys(tt);for(it=0;it<ot.length;it++)nt=ot[it],rt.indexOf(nt)>=0||(st[nt]=tt[nt]);return st}(_,a);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(_);for(j=0;j<et.length;j++)$=et[j],a.indexOf($)>=0||Object.prototype.propertyIsEnumerable.call(_,$)&&(_e[$]=_[$])}return _e}var xe=["size","color","stroke"];function fe(_){var a=_.size,$=a===void 0?24:a,j=_.color,_e=j===void 0?"currentColor":j,et=_.stroke,tt=et===void 0?2:et,rt=o(_,xe);return react.exports.createElement("svg",t({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-alert-circle",width:$,height:$,viewBox:"0 0 24 24",strokeWidth:tt,stroke:_e,fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},rt),react.exports.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),react.exports.createElement("circle",{cx:12,cy:12,r:9}),react.exports.createElement("line",{x1:12,y1:8,x2:12,y2:12}),react.exports.createElement("line",{x1:12,y1:16,x2:12.01,y2:16}))}var Jb=["size","color","stroke"];function Kb(_){var a=_.size,$=a===void 0?24:a,j=_.color,_e=j===void 0?"currentColor":j,et=_.stroke,tt=et===void 0?2:et,rt=o(_,Jb);return react.exports.createElement("svg",t({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-bucket",width:$,height:$,viewBox:"0 0 24 24",strokeWidth:tt,stroke:_e,fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},rt),react.exports.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),react.exports.createElement("path",{d:"M19 9l-2 9a2 2.5 0 0 1 -2 2h-6a2 2.5 0 0 1 -2 -2l-2 -9z"}),react.exports.createElement("path",{d:"M7 9a5 5 0 0 1 10 0"}))}var QD=["size","color","stroke"];function RD(_){var a=_.size,$=a===void 0?24:a,j=_.color,_e=j===void 0?"currentColor":j,et=_.stroke,tt=et===void 0?2:et,rt=o(_,QD);return react.exports.createElement("svg",t({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-currency-dollar",width:$,height:$,viewBox:"0 0 24 24",strokeWidth:tt,stroke:_e,fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},rt),react.exports.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),react.exports.createElement("path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2"}),react.exports.createElement("path",{d:"M12 3v3m0 12v3"}))}var QQ=["size","color","stroke"];function RQ(_){var a=_.size,$=a===void 0?24:a,j=_.color,_e=j===void 0?"currentColor":j,et=_.stroke,tt=et===void 0?2:et,rt=o(_,QQ);return react.exports.createElement("svg",t({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-disc",width:$,height:$,viewBox:"0 0 24 24",strokeWidth:tt,stroke:_e,fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},rt),react.exports.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),react.exports.createElement("circle",{cx:12,cy:12,r:9}),react.exports.createElement("circle",{cx:12,cy:12,r:1}),react.exports.createElement("path",{d:"M7 12a5 5 0 0 1 5 -5"}),react.exports.createElement("path",{d:"M12 17a5 5 0 0 0 5 -5"}))}var Hse=["size","color","stroke"];function Nse(_){var a=_.size,$=a===void 0?24:a,j=_.color,_e=j===void 0?"currentColor":j,et=_.stroke,tt=et===void 0?2:et,rt=o(_,Hse);return react.exports.createElement("svg",t({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-moon-stars",width:$,height:$,viewBox:"0 0 24 24",strokeWidth:tt,stroke:_e,fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},rt),react.exports.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),react.exports.createElement("path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"}),react.exports.createElement("path",{d:"M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"}),react.exports.createElement("path",{d:"M19 11h2m-1 -1v2"}))}var uhe=["size","color","stroke"];function ghe(_){var a=_.size,$=a===void 0?24:a,j=_.color,_e=j===void 0?"currentColor":j,et=_.stroke,tt=et===void 0?2:et,rt=o(_,uhe);return react.exports.createElement("svg",t({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-music",width:$,height:$,viewBox:"0 0 24 24",strokeWidth:tt,stroke:_e,fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},rt),react.exports.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),react.exports.createElement("circle",{cx:6,cy:17,r:3}),react.exports.createElement("circle",{cx:16,cy:17,r:3}),react.exports.createElement("polyline",{points:"9 17 9 4 19 4 19 17"}),react.exports.createElement("line",{x1:9,y1:8,x2:19,y2:8}))}var fze=["size","color","stroke"];function zze(_){var a=_.size,$=a===void 0?24:a,j=_.color,_e=j===void 0?"currentColor":j,et=_.stroke,tt=et===void 0?2:et,rt=o(_,fze);return react.exports.createElement("svg",t({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-seeding",width:$,height:$,viewBox:"0 0 24 24",strokeWidth:tt,stroke:_e,fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},rt),react.exports.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),react.exports.createElement("path",{d:"M12 10a6 6 0 0 0 -6 -6h-3v2a6 6 0 0 0 6 6h3"}),react.exports.createElement("path",{d:"M12 14a6 6 0 0 1 6 -6h3v1a6 6 0 0 1 -6 6h-3"}),react.exports.createElement("line",{x1:12,y1:20,x2:12,y2:10}))}var jNe=["size","color","stroke"];function BNe(_){var a=_.size,$=a===void 0?24:a,j=_.color,_e=j===void 0?"currentColor":j,et=_.stroke,tt=et===void 0?2:et,rt=o(_,jNe);return react.exports.createElement("svg",t({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-sun",width:$,height:$,viewBox:"0 0 24 24",strokeWidth:tt,stroke:_e,fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},rt),react.exports.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),react.exports.createElement("circle",{cx:12,cy:12,r:4}),react.exports.createElement("path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7"}))}var hIe=["size","color","stroke"];function dIe(_){var a=_.size,$=a===void 0?24:a,j=_.color,_e=j===void 0?"currentColor":j,et=_.stroke,tt=et===void 0?2:et,rt=o(_,hIe);return react.exports.createElement("svg",t({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-upload",width:$,height:$,viewBox:"0 0 24 24",strokeWidth:tt,stroke:_e,fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},rt),react.exports.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),react.exports.createElement("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),react.exports.createElement("polyline",{points:"7 9 12 4 17 9"}),react.exports.createElement("line",{x1:12,y1:4,x2:12,y2:16}))}var WIe=["size","color","stroke"];function qIe(_){var a=_.size,$=a===void 0?24:a,j=_.color,_e=j===void 0?"currentColor":j,et=_.stroke,tt=et===void 0?2:et,rt=o(_,WIe);return react.exports.createElement("svg",t({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-user",width:$,height:$,viewBox:"0 0 24 24",strokeWidth:tt,stroke:_e,fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},rt),react.exports.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),react.exports.createElement("circle",{cx:12,cy:7,r:4}),react.exports.createElement("path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"}))}var TGe=["size","color","stroke"];function UGe(_){var a=_.size,$=a===void 0?24:a,j=_.color,_e=j===void 0?"currentColor":j,et=_.stroke,tt=et===void 0?2:et,rt=o(_,TGe);return react.exports.createElement("svg",t({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-world",width:$,height:$,viewBox:"0 0 24 24",strokeWidth:tt,stroke:_e,fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},rt),react.exports.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),react.exports.createElement("circle",{cx:12,cy:12,r:9}),react.exports.createElement("line",{x1:3.6,y1:9,x2:20.4,y2:9}),react.exports.createElement("line",{x1:3.6,y1:15,x2:20.4,y2:15}),react.exports.createElement("path",{d:"M11.5 3a17 17 0 0 0 0 18"}),react.exports.createElement("path",{d:"M12.5 3a17 17 0 0 1 0 18"}))}function SwitchThemeToggle(){const{colorScheme:_,toggleColorScheme:a}=useMantineColorScheme(),$=useMantineTheme();return jsx(Switch,{checked:_==="dark",onChange:()=>a(),size:"md",mb:15,onLabel:jsx(BNe,{color:$.white,size:20,stroke:1.5}),offLabel:jsx(Nse,{color:$.colors.gray[6],size:20,stroke:1.5})})}const logo="/assets/logo.c219e1d9.svg";var bn={exports:{}};const globSourceImport={},nodeCrypto=Object.freeze(Object.defineProperty({__proto__:null,default:globSourceImport},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(nodeCrypto);(function(_){(function(a,$){function j(kt,gt){if(!kt)throw new Error(gt||"Assertion failed")}function _e(kt,gt){kt.super_=gt;var Et=function(){};Et.prototype=gt.prototype,kt.prototype=new Et,kt.prototype.constructor=kt}function et(kt,gt,Et){if(et.isBN(kt))return kt;this.negative=0,this.words=null,this.length=0,this.red=null,kt!==null&&((gt==="le"||gt==="be")&&(Et=gt,gt=10),this._init(kt||0,gt||10,Et||"be"))}typeof a=="object"?a.exports=et:$.BN=et,et.BN=et,et.wordSize=26;var tt;try{typeof window<"u"&&typeof window.Buffer<"u"?tt=window.Buffer:tt=require$$1.Buffer}catch{}et.isBN=function(gt){return gt instanceof et?!0:gt!==null&&typeof gt=="object"&&gt.constructor.wordSize===et.wordSize&&Array.isArray(gt.words)},et.max=function(gt,Et){return gt.cmp(Et)>0?gt:Et},et.min=function(gt,Et){return gt.cmp(Et)<0?gt:Et},et.prototype._init=function(gt,Et,xt){if(typeof gt=="number")return this._initNumber(gt,Et,xt);if(typeof gt=="object")return this._initArray(gt,Et,xt);Et==="hex"&&(Et=16),j(Et===(Et|0)&&Et>=2&&Et<=36),gt=gt.toString().replace(/\s+/g,"");var Tt=0;gt[0]==="-"&&(Tt++,this.negative=1),Tt<gt.length&&(Et===16?this._parseHex(gt,Tt,xt):(this._parseBase(gt,Et,Tt),xt==="le"&&this._initArray(this.toArray(),Et,xt)))},et.prototype._initNumber=function(gt,Et,xt){gt<0&&(this.negative=1,gt=-gt),gt<67108864?(this.words=[gt&67108863],this.length=1):gt<4503599627370496?(this.words=[gt&67108863,gt/67108864&67108863],this.length=2):(j(gt<9007199254740992),this.words=[gt&67108863,gt/67108864&67108863,1],this.length=3),xt==="le"&&this._initArray(this.toArray(),Et,xt)},et.prototype._initArray=function(gt,Et,xt){if(j(typeof gt.length=="number"),gt.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(gt.length/3),this.words=new Array(this.length);for(var Tt=0;Tt<this.length;Tt++)this.words[Tt]=0;var At,Nt,Bt=0;if(xt==="be")for(Tt=gt.length-1,At=0;Tt>=0;Tt-=3)Nt=gt[Tt]|gt[Tt-1]<<8|gt[Tt-2]<<16,this.words[At]|=Nt<<Bt&67108863,this.words[At+1]=Nt>>>26-Bt&67108863,Bt+=24,Bt>=26&&(Bt-=26,At++);else if(xt==="le")for(Tt=0,At=0;Tt<gt.length;Tt+=3)Nt=gt[Tt]|gt[Tt+1]<<8|gt[Tt+2]<<16,this.words[At]|=Nt<<Bt&67108863,this.words[At+1]=Nt>>>26-Bt&67108863,Bt+=24,Bt>=26&&(Bt-=26,At++);return this._strip()};function rt(kt,gt){var Et=kt.charCodeAt(gt);if(Et>=48&&Et<=57)return Et-48;if(Et>=65&&Et<=70)return Et-55;if(Et>=97&&Et<=102)return Et-87;j(!1,"Invalid character in "+kt)}function nt(kt,gt,Et){var xt=rt(kt,Et);return Et-1>=gt&&(xt|=rt(kt,Et-1)<<4),xt}et.prototype._parseHex=function(gt,Et,xt){this.length=Math.ceil((gt.length-Et)/6),this.words=new Array(this.length);for(var Tt=0;Tt<this.length;Tt++)this.words[Tt]=0;var At=0,Nt=0,Bt;if(xt==="be")for(Tt=gt.length-1;Tt>=Et;Tt-=2)Bt=nt(gt,Et,Tt)<<At,this.words[Nt]|=Bt&67108863,At>=18?(At-=18,Nt+=1,this.words[Nt]|=Bt>>>26):At+=8;else{var Ot=gt.length-Et;for(Tt=Ot%2===0?Et+1:Et;Tt<gt.length;Tt+=2)Bt=nt(gt,Et,Tt)<<At,this.words[Nt]|=Bt&67108863,At>=18?(At-=18,Nt+=1,this.words[Nt]|=Bt>>>26):At+=8}this._strip()};function it(kt,gt,Et,xt){for(var Tt=0,At=0,Nt=Math.min(kt.length,Et),Bt=gt;Bt<Nt;Bt++){var Ot=kt.charCodeAt(Bt)-48;Tt*=xt,Ot>=49?At=Ot-49+10:Ot>=17?At=Ot-17+10:At=Ot,j(Ot>=0&&At<xt,"Invalid character"),Tt+=At}return Tt}et.prototype._parseBase=function(gt,Et,xt){this.words=[0],this.length=1;for(var Tt=0,At=1;At<=67108863;At*=Et)Tt++;Tt--,At=At/Et|0;for(var Nt=gt.length-xt,Bt=Nt%Tt,Ot=Math.min(Nt,Nt-Bt)+xt,bt=0,Rt=xt;Rt<Ot;Rt+=Tt)bt=it(gt,Rt,Rt+Tt,Et),this.imuln(At),this.words[0]+bt<67108864?this.words[0]+=bt:this._iaddn(bt);if(Bt!==0){var Gt=1;for(bt=it(gt,Rt,gt.length,Et),Rt=0;Rt<Bt;Rt++)Gt*=Et;this.imuln(Gt),this.words[0]+bt<67108864?this.words[0]+=bt:this._iaddn(bt)}this._strip()},et.prototype.copy=function(gt){gt.words=new Array(this.length);for(var Et=0;Et<this.length;Et++)gt.words[Et]=this.words[Et];gt.length=this.length,gt.negative=this.negative,gt.red=this.red};function st(kt,gt){kt.words=gt.words,kt.length=gt.length,kt.negative=gt.negative,kt.red=gt.red}if(et.prototype._move=function(gt){st(gt,this)},et.prototype.clone=function(){var gt=new et(null);return this.copy(gt),gt},et.prototype._expand=function(gt){for(;this.length<gt;)this.words[this.length++]=0;return this},et.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},et.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{et.prototype[Symbol.for("nodejs.util.inspect.custom")]=ot}catch{et.prototype.inspect=ot}else et.prototype.inspect=ot;function ot(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var at=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],lt=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],ct=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];et.prototype.toString=function(gt,Et){gt=gt||10,Et=Et|0||1;var xt;if(gt===16||gt==="hex"){xt="";for(var Tt=0,At=0,Nt=0;Nt<this.length;Nt++){var Bt=this.words[Nt],Ot=((Bt<<Tt|At)&16777215).toString(16);At=Bt>>>24-Tt&16777215,Tt+=2,Tt>=26&&(Tt-=26,Nt--),At!==0||Nt!==this.length-1?xt=at[6-Ot.length]+Ot+xt:xt=Ot+xt}for(At!==0&&(xt=At.toString(16)+xt);xt.length%Et!==0;)xt="0"+xt;return this.negative!==0&&(xt="-"+xt),xt}if(gt===(gt|0)&&gt>=2&&gt<=36){var bt=lt[gt],Rt=ct[gt];xt="";var Gt=this.clone();for(Gt.negative=0;!Gt.isZero();){var Pt=Gt.modrn(Rt).toString(gt);Gt=Gt.idivn(Rt),Gt.isZero()?xt=Pt+xt:xt=at[bt-Pt.length]+Pt+xt}for(this.isZero()&&(xt="0"+xt);xt.length%Et!==0;)xt="0"+xt;return this.negative!==0&&(xt="-"+xt),xt}j(!1,"Base should be between 2 and 36")},et.prototype.toNumber=function(){var gt=this.words[0];return this.length===2?gt+=this.words[1]*67108864:this.length===3&&this.words[2]===1?gt+=4503599627370496+this.words[1]*67108864:this.length>2&&j(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-gt:gt},et.prototype.toJSON=function(){return this.toString(16,2)},tt&&(et.prototype.toBuffer=function(gt,Et){return this.toArrayLike(tt,gt,Et)}),et.prototype.toArray=function(gt,Et){return this.toArrayLike(Array,gt,Et)};var ut=function(gt,Et){return gt.allocUnsafe?gt.allocUnsafe(Et):new gt(Et)};et.prototype.toArrayLike=function(gt,Et,xt){this._strip();var Tt=this.byteLength(),At=xt||Math.max(1,Tt);j(Tt<=At,"byte array longer than desired length"),j(At>0,"Requested array length <= 0");var Nt=ut(gt,At),Bt=Et==="le"?"LE":"BE";return this["_toArrayLike"+Bt](Nt,Tt),Nt},et.prototype._toArrayLikeLE=function(gt,Et){for(var xt=0,Tt=0,At=0,Nt=0;At<this.length;At++){var Bt=this.words[At]<<Nt|Tt;gt[xt++]=Bt&255,xt<gt.length&&(gt[xt++]=Bt>>8&255),xt<gt.length&&(gt[xt++]=Bt>>16&255),Nt===6?(xt<gt.length&&(gt[xt++]=Bt>>24&255),Tt=0,Nt=0):(Tt=Bt>>>24,Nt+=2)}if(xt<gt.length)for(gt[xt++]=Tt;xt<gt.length;)gt[xt++]=0},et.prototype._toArrayLikeBE=function(gt,Et){for(var xt=gt.length-1,Tt=0,At=0,Nt=0;At<this.length;At++){var Bt=this.words[At]<<Nt|Tt;gt[xt--]=Bt&255,xt>=0&&(gt[xt--]=Bt>>8&255),xt>=0&&(gt[xt--]=Bt>>16&255),Nt===6?(xt>=0&&(gt[xt--]=Bt>>24&255),Tt=0,Nt=0):(Tt=Bt>>>24,Nt+=2)}if(xt>=0)for(gt[xt--]=Tt;xt>=0;)gt[xt--]=0},Math.clz32?et.prototype._countBits=function(gt){return 32-Math.clz32(gt)}:et.prototype._countBits=function(gt){var Et=gt,xt=0;return Et>=4096&&(xt+=13,Et>>>=13),Et>=64&&(xt+=7,Et>>>=7),Et>=8&&(xt+=4,Et>>>=4),Et>=2&&(xt+=2,Et>>>=2),xt+Et},et.prototype._zeroBits=function(gt){if(gt===0)return 26;var Et=gt,xt=0;return(Et&8191)===0&&(xt+=13,Et>>>=13),(Et&127)===0&&(xt+=7,Et>>>=7),(Et&15)===0&&(xt+=4,Et>>>=4),(Et&3)===0&&(xt+=2,Et>>>=2),(Et&1)===0&&xt++,xt},et.prototype.bitLength=function(){var gt=this.words[this.length-1],Et=this._countBits(gt);return(this.length-1)*26+Et};function dt(kt){for(var gt=new Array(kt.bitLength()),Et=0;Et<gt.length;Et++){var xt=Et/26|0,Tt=Et%26;gt[Et]=kt.words[xt]>>>Tt&1}return gt}et.prototype.zeroBits=function(){if(this.isZero())return 0;for(var gt=0,Et=0;Et<this.length;Et++){var xt=this._zeroBits(this.words[Et]);if(gt+=xt,xt!==26)break}return gt},et.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},et.prototype.toTwos=function(gt){return this.negative!==0?this.abs().inotn(gt).iaddn(1):this.clone()},et.prototype.fromTwos=function(gt){return this.testn(gt-1)?this.notn(gt).iaddn(1).ineg():this.clone()},et.prototype.isNeg=function(){return this.negative!==0},et.prototype.neg=function(){return this.clone().ineg()},et.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},et.prototype.iuor=function(gt){for(;this.length<gt.length;)this.words[this.length++]=0;for(var Et=0;Et<gt.length;Et++)this.words[Et]=this.words[Et]|gt.words[Et];return this._strip()},et.prototype.ior=function(gt){return j((this.negative|gt.negative)===0),this.iuor(gt)},et.prototype.or=function(gt){return this.length>gt.length?this.clone().ior(gt):gt.clone().ior(this)},et.prototype.uor=function(gt){return this.length>gt.length?this.clone().iuor(gt):gt.clone().iuor(this)},et.prototype.iuand=function(gt){var Et;this.length>gt.length?Et=gt:Et=this;for(var xt=0;xt<Et.length;xt++)this.words[xt]=this.words[xt]&gt.words[xt];return this.length=Et.length,this._strip()},et.prototype.iand=function(gt){return j((this.negative|gt.negative)===0),this.iuand(gt)},et.prototype.and=function(gt){return this.length>gt.length?this.clone().iand(gt):gt.clone().iand(this)},et.prototype.uand=function(gt){return this.length>gt.length?this.clone().iuand(gt):gt.clone().iuand(this)},et.prototype.iuxor=function(gt){var Et,xt;this.length>gt.length?(Et=this,xt=gt):(Et=gt,xt=this);for(var Tt=0;Tt<xt.length;Tt++)this.words[Tt]=Et.words[Tt]^xt.words[Tt];if(this!==Et)for(;Tt<Et.length;Tt++)this.words[Tt]=Et.words[Tt];return this.length=Et.length,this._strip()},et.prototype.ixor=function(gt){return j((this.negative|gt.negative)===0),this.iuxor(gt)},et.prototype.xor=function(gt){return this.length>gt.length?this.clone().ixor(gt):gt.clone().ixor(this)},et.prototype.uxor=function(gt){return this.length>gt.length?this.clone().iuxor(gt):gt.clone().iuxor(this)},et.prototype.inotn=function(gt){j(typeof gt=="number"&&gt>=0);var Et=Math.ceil(gt/26)|0,xt=gt%26;this._expand(Et),xt>0&&Et--;for(var Tt=0;Tt<Et;Tt++)this.words[Tt]=~this.words[Tt]&67108863;return xt>0&&(this.words[Tt]=~this.words[Tt]&67108863>>26-xt),this._strip()},et.prototype.notn=function(gt){return this.clone().inotn(gt)},et.prototype.setn=function(gt,Et){j(typeof gt=="number"&&gt>=0);var xt=gt/26|0,Tt=gt%26;return this._expand(xt+1),Et?this.words[xt]=this.words[xt]|1<<Tt:this.words[xt]=this.words[xt]&~(1<<Tt),this._strip()},et.prototype.iadd=function(gt){var Et;if(this.negative!==0&&gt.negative===0)return this.negative=0,Et=this.isub(gt),this.negative^=1,this._normSign();if(this.negative===0&&gt.negative!==0)return gt.negative=0,Et=this.isub(gt),gt.negative=1,Et._normSign();var xt,Tt;this.length>gt.length?(xt=this,Tt=gt):(xt=gt,Tt=this);for(var At=0,Nt=0;Nt<Tt.length;Nt++)Et=(xt.words[Nt]|0)+(Tt.words[Nt]|0)+At,this.words[Nt]=Et&67108863,At=Et>>>26;for(;At!==0&&Nt<xt.length;Nt++)Et=(xt.words[Nt]|0)+At,this.words[Nt]=Et&67108863,At=Et>>>26;if(this.length=xt.length,At!==0)this.words[this.length]=At,this.length++;else if(xt!==this)for(;Nt<xt.length;Nt++)this.words[Nt]=xt.words[Nt];return this},et.prototype.add=function(gt){var Et;return gt.negative!==0&&this.negative===0?(gt.negative=0,Et=this.sub(gt),gt.negative^=1,Et):gt.negative===0&&this.negative!==0?(this.negative=0,Et=gt.sub(this),this.negative=1,Et):this.length>gt.length?this.clone().iadd(gt):gt.clone().iadd(this)},et.prototype.isub=function(gt){if(gt.negative!==0){gt.negative=0;var Et=this.iadd(gt);return gt.negative=1,Et._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(gt),this.negative=1,this._normSign();var xt=this.cmp(gt);if(xt===0)return this.negative=0,this.length=1,this.words[0]=0,this;var Tt,At;xt>0?(Tt=this,At=gt):(Tt=gt,At=this);for(var Nt=0,Bt=0;Bt<At.length;Bt++)Et=(Tt.words[Bt]|0)-(At.words[Bt]|0)+Nt,Nt=Et>>26,this.words[Bt]=Et&67108863;for(;Nt!==0&&Bt<Tt.length;Bt++)Et=(Tt.words[Bt]|0)+Nt,Nt=Et>>26,this.words[Bt]=Et&67108863;if(Nt===0&&Bt<Tt.length&&Tt!==this)for(;Bt<Tt.length;Bt++)this.words[Bt]=Tt.words[Bt];return this.length=Math.max(this.length,Bt),Tt!==this&&(this.negative=1),this._strip()},et.prototype.sub=function(gt){return this.clone().isub(gt)};function ft(kt,gt,Et){Et.negative=gt.negative^kt.negative;var xt=kt.length+gt.length|0;Et.length=xt,xt=xt-1|0;var Tt=kt.words[0]|0,At=gt.words[0]|0,Nt=Tt*At,Bt=Nt&67108863,Ot=Nt/67108864|0;Et.words[0]=Bt;for(var bt=1;bt<xt;bt++){for(var Rt=Ot>>>26,Gt=Ot&67108863,Pt=Math.min(bt,gt.length-1),Ft=Math.max(0,bt-kt.length+1);Ft<=Pt;Ft++){var jt=bt-Ft|0;Tt=kt.words[jt]|0,At=gt.words[Ft]|0,Nt=Tt*At+Gt,Rt+=Nt/67108864|0,Gt=Nt&67108863}Et.words[bt]=Gt|0,Ot=Rt|0}return Ot!==0?Et.words[bt]=Ot|0:Et.length--,Et._strip()}var pt=function(gt,Et,xt){var Tt=gt.words,At=Et.words,Nt=xt.words,Bt=0,Ot,bt,Rt,Gt=Tt[0]|0,Pt=Gt&8191,Ft=Gt>>>13,jt=Tt[1]|0,Vt=jt&8191,Wt=jt>>>13,Qt=Tt[2]|0,qt=Qt&8191,Yt=Qt>>>13,Xt=Tt[3]|0,Zt=Xt&8191,tr=Xt>>>13,Dr=Tt[4]|0,fr=Dr&8191,hr=Dr>>>13,Or=Tt[5]|0,lr=Or&8191,ir=Or>>>13,dr=Tt[6]|0,ar=dr&8191,cr=dr>>>13,pr=Tt[7]|0,ur=pr&8191,Ct=pr>>>13,wt=Tt[8]|0,$t=wt&8191,Dt=wt>>>13,Ut=Tt[9]|0,zt=Ut&8191,Ht=Ut>>>13,er=At[0]|0,Jt=er&8191,sr=er>>>13,gr=At[1]|0,nr=gr&8191,yr=gr>>>13,jr=At[2]|0,mr=jr&8191,_r=jr>>>13,Kr=At[3]|0,wr=Kr&8191,vr=Kr>>>13,Hr=At[4]|0,br=Hr&8191,Er=Hr>>>13,Gr=At[5]|0,$r=Gr&8191,Sr=Gr>>>13,Wr=At[6]|0,Pr=Wr&8191,xr=Wr>>>13,qr=At[7]|0,Tr=qr&8191,Cr=qr>>>13,Yr=At[8]|0,Ar=Yr&8191,Rr=Yr>>>13,Qr=At[9]|0,Ir=Qr&8191,kr=Qr>>>13;xt.negative=gt.negative^Et.negative,xt.length=19,Ot=Math.imul(Pt,Jt),bt=Math.imul(Pt,sr),bt=bt+Math.imul(Ft,Jt)|0,Rt=Math.imul(Ft,sr);var Br=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(Br>>>26)|0,Br&=67108863,Ot=Math.imul(Vt,Jt),bt=Math.imul(Vt,sr),bt=bt+Math.imul(Wt,Jt)|0,Rt=Math.imul(Wt,sr),Ot=Ot+Math.imul(Pt,nr)|0,bt=bt+Math.imul(Pt,yr)|0,bt=bt+Math.imul(Ft,nr)|0,Rt=Rt+Math.imul(Ft,yr)|0;var Mr=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(Mr>>>26)|0,Mr&=67108863,Ot=Math.imul(qt,Jt),bt=Math.imul(qt,sr),bt=bt+Math.imul(Yt,Jt)|0,Rt=Math.imul(Yt,sr),Ot=Ot+Math.imul(Vt,nr)|0,bt=bt+Math.imul(Vt,yr)|0,bt=bt+Math.imul(Wt,nr)|0,Rt=Rt+Math.imul(Wt,yr)|0,Ot=Ot+Math.imul(Pt,mr)|0,bt=bt+Math.imul(Pt,_r)|0,bt=bt+Math.imul(Ft,mr)|0,Rt=Rt+Math.imul(Ft,_r)|0;var Fr=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(Fr>>>26)|0,Fr&=67108863,Ot=Math.imul(Zt,Jt),bt=Math.imul(Zt,sr),bt=bt+Math.imul(tr,Jt)|0,Rt=Math.imul(tr,sr),Ot=Ot+Math.imul(qt,nr)|0,bt=bt+Math.imul(qt,yr)|0,bt=bt+Math.imul(Yt,nr)|0,Rt=Rt+Math.imul(Yt,yr)|0,Ot=Ot+Math.imul(Vt,mr)|0,bt=bt+Math.imul(Vt,_r)|0,bt=bt+Math.imul(Wt,mr)|0,Rt=Rt+Math.imul(Wt,_r)|0,Ot=Ot+Math.imul(Pt,wr)|0,bt=bt+Math.imul(Pt,vr)|0,bt=bt+Math.imul(Ft,wr)|0,Rt=Rt+Math.imul(Ft,vr)|0;var Ur=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(Ur>>>26)|0,Ur&=67108863,Ot=Math.imul(fr,Jt),bt=Math.imul(fr,sr),bt=bt+Math.imul(hr,Jt)|0,Rt=Math.imul(hr,sr),Ot=Ot+Math.imul(Zt,nr)|0,bt=bt+Math.imul(Zt,yr)|0,bt=bt+Math.imul(tr,nr)|0,Rt=Rt+Math.imul(tr,yr)|0,Ot=Ot+Math.imul(qt,mr)|0,bt=bt+Math.imul(qt,_r)|0,bt=bt+Math.imul(Yt,mr)|0,Rt=Rt+Math.imul(Yt,_r)|0,Ot=Ot+Math.imul(Vt,wr)|0,bt=bt+Math.imul(Vt,vr)|0,bt=bt+Math.imul(Wt,wr)|0,Rt=Rt+Math.imul(Wt,vr)|0,Ot=Ot+Math.imul(Pt,br)|0,bt=bt+Math.imul(Pt,Er)|0,bt=bt+Math.imul(Ft,br)|0,Rt=Rt+Math.imul(Ft,Er)|0;var zr=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(zr>>>26)|0,zr&=67108863,Ot=Math.imul(lr,Jt),bt=Math.imul(lr,sr),bt=bt+Math.imul(ir,Jt)|0,Rt=Math.imul(ir,sr),Ot=Ot+Math.imul(fr,nr)|0,bt=bt+Math.imul(fr,yr)|0,bt=bt+Math.imul(hr,nr)|0,Rt=Rt+Math.imul(hr,yr)|0,Ot=Ot+Math.imul(Zt,mr)|0,bt=bt+Math.imul(Zt,_r)|0,bt=bt+Math.imul(tr,mr)|0,Rt=Rt+Math.imul(tr,_r)|0,Ot=Ot+Math.imul(qt,wr)|0,bt=bt+Math.imul(qt,vr)|0,bt=bt+Math.imul(Yt,wr)|0,Rt=Rt+Math.imul(Yt,vr)|0,Ot=Ot+Math.imul(Vt,br)|0,bt=bt+Math.imul(Vt,Er)|0,bt=bt+Math.imul(Wt,br)|0,Rt=Rt+Math.imul(Wt,Er)|0,Ot=Ot+Math.imul(Pt,$r)|0,bt=bt+Math.imul(Pt,Sr)|0,bt=bt+Math.imul(Ft,$r)|0,Rt=Rt+Math.imul(Ft,Sr)|0;var rn=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(rn>>>26)|0,rn&=67108863,Ot=Math.imul(ar,Jt),bt=Math.imul(ar,sr),bt=bt+Math.imul(cr,Jt)|0,Rt=Math.imul(cr,sr),Ot=Ot+Math.imul(lr,nr)|0,bt=bt+Math.imul(lr,yr)|0,bt=bt+Math.imul(ir,nr)|0,Rt=Rt+Math.imul(ir,yr)|0,Ot=Ot+Math.imul(fr,mr)|0,bt=bt+Math.imul(fr,_r)|0,bt=bt+Math.imul(hr,mr)|0,Rt=Rt+Math.imul(hr,_r)|0,Ot=Ot+Math.imul(Zt,wr)|0,bt=bt+Math.imul(Zt,vr)|0,bt=bt+Math.imul(tr,wr)|0,Rt=Rt+Math.imul(tr,vr)|0,Ot=Ot+Math.imul(qt,br)|0,bt=bt+Math.imul(qt,Er)|0,bt=bt+Math.imul(Yt,br)|0,Rt=Rt+Math.imul(Yt,Er)|0,Ot=Ot+Math.imul(Vt,$r)|0,bt=bt+Math.imul(Vt,Sr)|0,bt=bt+Math.imul(Wt,$r)|0,Rt=Rt+Math.imul(Wt,Sr)|0,Ot=Ot+Math.imul(Pt,Pr)|0,bt=bt+Math.imul(Pt,xr)|0,bt=bt+Math.imul(Ft,Pr)|0,Rt=Rt+Math.imul(Ft,xr)|0;var nn=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(nn>>>26)|0,nn&=67108863,Ot=Math.imul(ur,Jt),bt=Math.imul(ur,sr),bt=bt+Math.imul(Ct,Jt)|0,Rt=Math.imul(Ct,sr),Ot=Ot+Math.imul(ar,nr)|0,bt=bt+Math.imul(ar,yr)|0,bt=bt+Math.imul(cr,nr)|0,Rt=Rt+Math.imul(cr,yr)|0,Ot=Ot+Math.imul(lr,mr)|0,bt=bt+Math.imul(lr,_r)|0,bt=bt+Math.imul(ir,mr)|0,Rt=Rt+Math.imul(ir,_r)|0,Ot=Ot+Math.imul(fr,wr)|0,bt=bt+Math.imul(fr,vr)|0,bt=bt+Math.imul(hr,wr)|0,Rt=Rt+Math.imul(hr,vr)|0,Ot=Ot+Math.imul(Zt,br)|0,bt=bt+Math.imul(Zt,Er)|0,bt=bt+Math.imul(tr,br)|0,Rt=Rt+Math.imul(tr,Er)|0,Ot=Ot+Math.imul(qt,$r)|0,bt=bt+Math.imul(qt,Sr)|0,bt=bt+Math.imul(Yt,$r)|0,Rt=Rt+Math.imul(Yt,Sr)|0,Ot=Ot+Math.imul(Vt,Pr)|0,bt=bt+Math.imul(Vt,xr)|0,bt=bt+Math.imul(Wt,Pr)|0,Rt=Rt+Math.imul(Wt,xr)|0,Ot=Ot+Math.imul(Pt,Tr)|0,bt=bt+Math.imul(Pt,Cr)|0,bt=bt+Math.imul(Ft,Tr)|0,Rt=Rt+Math.imul(Ft,Cr)|0;var sn=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(sn>>>26)|0,sn&=67108863,Ot=Math.imul($t,Jt),bt=Math.imul($t,sr),bt=bt+Math.imul(Dt,Jt)|0,Rt=Math.imul(Dt,sr),Ot=Ot+Math.imul(ur,nr)|0,bt=bt+Math.imul(ur,yr)|0,bt=bt+Math.imul(Ct,nr)|0,Rt=Rt+Math.imul(Ct,yr)|0,Ot=Ot+Math.imul(ar,mr)|0,bt=bt+Math.imul(ar,_r)|0,bt=bt+Math.imul(cr,mr)|0,Rt=Rt+Math.imul(cr,_r)|0,Ot=Ot+Math.imul(lr,wr)|0,bt=bt+Math.imul(lr,vr)|0,bt=bt+Math.imul(ir,wr)|0,Rt=Rt+Math.imul(ir,vr)|0,Ot=Ot+Math.imul(fr,br)|0,bt=bt+Math.imul(fr,Er)|0,bt=bt+Math.imul(hr,br)|0,Rt=Rt+Math.imul(hr,Er)|0,Ot=Ot+Math.imul(Zt,$r)|0,bt=bt+Math.imul(Zt,Sr)|0,bt=bt+Math.imul(tr,$r)|0,Rt=Rt+Math.imul(tr,Sr)|0,Ot=Ot+Math.imul(qt,Pr)|0,bt=bt+Math.imul(qt,xr)|0,bt=bt+Math.imul(Yt,Pr)|0,Rt=Rt+Math.imul(Yt,xr)|0,Ot=Ot+Math.imul(Vt,Tr)|0,bt=bt+Math.imul(Vt,Cr)|0,bt=bt+Math.imul(Wt,Tr)|0,Rt=Rt+Math.imul(Wt,Cr)|0,Ot=Ot+Math.imul(Pt,Ar)|0,bt=bt+Math.imul(Pt,Rr)|0,bt=bt+Math.imul(Ft,Ar)|0,Rt=Rt+Math.imul(Ft,Rr)|0;var an=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(an>>>26)|0,an&=67108863,Ot=Math.imul(zt,Jt),bt=Math.imul(zt,sr),bt=bt+Math.imul(Ht,Jt)|0,Rt=Math.imul(Ht,sr),Ot=Ot+Math.imul($t,nr)|0,bt=bt+Math.imul($t,yr)|0,bt=bt+Math.imul(Dt,nr)|0,Rt=Rt+Math.imul(Dt,yr)|0,Ot=Ot+Math.imul(ur,mr)|0,bt=bt+Math.imul(ur,_r)|0,bt=bt+Math.imul(Ct,mr)|0,Rt=Rt+Math.imul(Ct,_r)|0,Ot=Ot+Math.imul(ar,wr)|0,bt=bt+Math.imul(ar,vr)|0,bt=bt+Math.imul(cr,wr)|0,Rt=Rt+Math.imul(cr,vr)|0,Ot=Ot+Math.imul(lr,br)|0,bt=bt+Math.imul(lr,Er)|0,bt=bt+Math.imul(ir,br)|0,Rt=Rt+Math.imul(ir,Er)|0,Ot=Ot+Math.imul(fr,$r)|0,bt=bt+Math.imul(fr,Sr)|0,bt=bt+Math.imul(hr,$r)|0,Rt=Rt+Math.imul(hr,Sr)|0,Ot=Ot+Math.imul(Zt,Pr)|0,bt=bt+Math.imul(Zt,xr)|0,bt=bt+Math.imul(tr,Pr)|0,Rt=Rt+Math.imul(tr,xr)|0,Ot=Ot+Math.imul(qt,Tr)|0,bt=bt+Math.imul(qt,Cr)|0,bt=bt+Math.imul(Yt,Tr)|0,Rt=Rt+Math.imul(Yt,Cr)|0,Ot=Ot+Math.imul(Vt,Ar)|0,bt=bt+Math.imul(Vt,Rr)|0,bt=bt+Math.imul(Wt,Ar)|0,Rt=Rt+Math.imul(Wt,Rr)|0,Ot=Ot+Math.imul(Pt,Ir)|0,bt=bt+Math.imul(Pt,kr)|0,bt=bt+Math.imul(Ft,Ir)|0,Rt=Rt+Math.imul(Ft,kr)|0;var ln=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(ln>>>26)|0,ln&=67108863,Ot=Math.imul(zt,nr),bt=Math.imul(zt,yr),bt=bt+Math.imul(Ht,nr)|0,Rt=Math.imul(Ht,yr),Ot=Ot+Math.imul($t,mr)|0,bt=bt+Math.imul($t,_r)|0,bt=bt+Math.imul(Dt,mr)|0,Rt=Rt+Math.imul(Dt,_r)|0,Ot=Ot+Math.imul(ur,wr)|0,bt=bt+Math.imul(ur,vr)|0,bt=bt+Math.imul(Ct,wr)|0,Rt=Rt+Math.imul(Ct,vr)|0,Ot=Ot+Math.imul(ar,br)|0,bt=bt+Math.imul(ar,Er)|0,bt=bt+Math.imul(cr,br)|0,Rt=Rt+Math.imul(cr,Er)|0,Ot=Ot+Math.imul(lr,$r)|0,bt=bt+Math.imul(lr,Sr)|0,bt=bt+Math.imul(ir,$r)|0,Rt=Rt+Math.imul(ir,Sr)|0,Ot=Ot+Math.imul(fr,Pr)|0,bt=bt+Math.imul(fr,xr)|0,bt=bt+Math.imul(hr,Pr)|0,Rt=Rt+Math.imul(hr,xr)|0,Ot=Ot+Math.imul(Zt,Tr)|0,bt=bt+Math.imul(Zt,Cr)|0,bt=bt+Math.imul(tr,Tr)|0,Rt=Rt+Math.imul(tr,Cr)|0,Ot=Ot+Math.imul(qt,Ar)|0,bt=bt+Math.imul(qt,Rr)|0,bt=bt+Math.imul(Yt,Ar)|0,Rt=Rt+Math.imul(Yt,Rr)|0,Ot=Ot+Math.imul(Vt,Ir)|0,bt=bt+Math.imul(Vt,kr)|0,bt=bt+Math.imul(Wt,Ir)|0,Rt=Rt+Math.imul(Wt,kr)|0;var cn=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(cn>>>26)|0,cn&=67108863,Ot=Math.imul(zt,mr),bt=Math.imul(zt,_r),bt=bt+Math.imul(Ht,mr)|0,Rt=Math.imul(Ht,_r),Ot=Ot+Math.imul($t,wr)|0,bt=bt+Math.imul($t,vr)|0,bt=bt+Math.imul(Dt,wr)|0,Rt=Rt+Math.imul(Dt,vr)|0,Ot=Ot+Math.imul(ur,br)|0,bt=bt+Math.imul(ur,Er)|0,bt=bt+Math.imul(Ct,br)|0,Rt=Rt+Math.imul(Ct,Er)|0,Ot=Ot+Math.imul(ar,$r)|0,bt=bt+Math.imul(ar,Sr)|0,bt=bt+Math.imul(cr,$r)|0,Rt=Rt+Math.imul(cr,Sr)|0,Ot=Ot+Math.imul(lr,Pr)|0,bt=bt+Math.imul(lr,xr)|0,bt=bt+Math.imul(ir,Pr)|0,Rt=Rt+Math.imul(ir,xr)|0,Ot=Ot+Math.imul(fr,Tr)|0,bt=bt+Math.imul(fr,Cr)|0,bt=bt+Math.imul(hr,Tr)|0,Rt=Rt+Math.imul(hr,Cr)|0,Ot=Ot+Math.imul(Zt,Ar)|0,bt=bt+Math.imul(Zt,Rr)|0,bt=bt+Math.imul(tr,Ar)|0,Rt=Rt+Math.imul(tr,Rr)|0,Ot=Ot+Math.imul(qt,Ir)|0,bt=bt+Math.imul(qt,kr)|0,bt=bt+Math.imul(Yt,Ir)|0,Rt=Rt+Math.imul(Yt,kr)|0;var un=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(un>>>26)|0,un&=67108863,Ot=Math.imul(zt,wr),bt=Math.imul(zt,vr),bt=bt+Math.imul(Ht,wr)|0,Rt=Math.imul(Ht,vr),Ot=Ot+Math.imul($t,br)|0,bt=bt+Math.imul($t,Er)|0,bt=bt+Math.imul(Dt,br)|0,Rt=Rt+Math.imul(Dt,Er)|0,Ot=Ot+Math.imul(ur,$r)|0,bt=bt+Math.imul(ur,Sr)|0,bt=bt+Math.imul(Ct,$r)|0,Rt=Rt+Math.imul(Ct,Sr)|0,Ot=Ot+Math.imul(ar,Pr)|0,bt=bt+Math.imul(ar,xr)|0,bt=bt+Math.imul(cr,Pr)|0,Rt=Rt+Math.imul(cr,xr)|0,Ot=Ot+Math.imul(lr,Tr)|0,bt=bt+Math.imul(lr,Cr)|0,bt=bt+Math.imul(ir,Tr)|0,Rt=Rt+Math.imul(ir,Cr)|0,Ot=Ot+Math.imul(fr,Ar)|0,bt=bt+Math.imul(fr,Rr)|0,bt=bt+Math.imul(hr,Ar)|0,Rt=Rt+Math.imul(hr,Rr)|0,Ot=Ot+Math.imul(Zt,Ir)|0,bt=bt+Math.imul(Zt,kr)|0,bt=bt+Math.imul(tr,Ir)|0,Rt=Rt+Math.imul(tr,kr)|0;var fn=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(fn>>>26)|0,fn&=67108863,Ot=Math.imul(zt,br),bt=Math.imul(zt,Er),bt=bt+Math.imul(Ht,br)|0,Rt=Math.imul(Ht,Er),Ot=Ot+Math.imul($t,$r)|0,bt=bt+Math.imul($t,Sr)|0,bt=bt+Math.imul(Dt,$r)|0,Rt=Rt+Math.imul(Dt,Sr)|0,Ot=Ot+Math.imul(ur,Pr)|0,bt=bt+Math.imul(ur,xr)|0,bt=bt+Math.imul(Ct,Pr)|0,Rt=Rt+Math.imul(Ct,xr)|0,Ot=Ot+Math.imul(ar,Tr)|0,bt=bt+Math.imul(ar,Cr)|0,bt=bt+Math.imul(cr,Tr)|0,Rt=Rt+Math.imul(cr,Cr)|0,Ot=Ot+Math.imul(lr,Ar)|0,bt=bt+Math.imul(lr,Rr)|0,bt=bt+Math.imul(ir,Ar)|0,Rt=Rt+Math.imul(ir,Rr)|0,Ot=Ot+Math.imul(fr,Ir)|0,bt=bt+Math.imul(fr,kr)|0,bt=bt+Math.imul(hr,Ir)|0,Rt=Rt+Math.imul(hr,kr)|0;var dn=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(dn>>>26)|0,dn&=67108863,Ot=Math.imul(zt,$r),bt=Math.imul(zt,Sr),bt=bt+Math.imul(Ht,$r)|0,Rt=Math.imul(Ht,Sr),Ot=Ot+Math.imul($t,Pr)|0,bt=bt+Math.imul($t,xr)|0,bt=bt+Math.imul(Dt,Pr)|0,Rt=Rt+Math.imul(Dt,xr)|0,Ot=Ot+Math.imul(ur,Tr)|0,bt=bt+Math.imul(ur,Cr)|0,bt=bt+Math.imul(Ct,Tr)|0,Rt=Rt+Math.imul(Ct,Cr)|0,Ot=Ot+Math.imul(ar,Ar)|0,bt=bt+Math.imul(ar,Rr)|0,bt=bt+Math.imul(cr,Ar)|0,Rt=Rt+Math.imul(cr,Rr)|0,Ot=Ot+Math.imul(lr,Ir)|0,bt=bt+Math.imul(lr,kr)|0,bt=bt+Math.imul(ir,Ir)|0,Rt=Rt+Math.imul(ir,kr)|0;var hn=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(hn>>>26)|0,hn&=67108863,Ot=Math.imul(zt,Pr),bt=Math.imul(zt,xr),bt=bt+Math.imul(Ht,Pr)|0,Rt=Math.imul(Ht,xr),Ot=Ot+Math.imul($t,Tr)|0,bt=bt+Math.imul($t,Cr)|0,bt=bt+Math.imul(Dt,Tr)|0,Rt=Rt+Math.imul(Dt,Cr)|0,Ot=Ot+Math.imul(ur,Ar)|0,bt=bt+Math.imul(ur,Rr)|0,bt=bt+Math.imul(Ct,Ar)|0,Rt=Rt+Math.imul(Ct,Rr)|0,Ot=Ot+Math.imul(ar,Ir)|0,bt=bt+Math.imul(ar,kr)|0,bt=bt+Math.imul(cr,Ir)|0,Rt=Rt+Math.imul(cr,kr)|0;var pn=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(pn>>>26)|0,pn&=67108863,Ot=Math.imul(zt,Tr),bt=Math.imul(zt,Cr),bt=bt+Math.imul(Ht,Tr)|0,Rt=Math.imul(Ht,Cr),Ot=Ot+Math.imul($t,Ar)|0,bt=bt+Math.imul($t,Rr)|0,bt=bt+Math.imul(Dt,Ar)|0,Rt=Rt+Math.imul(Dt,Rr)|0,Ot=Ot+Math.imul(ur,Ir)|0,bt=bt+Math.imul(ur,kr)|0,bt=bt+Math.imul(Ct,Ir)|0,Rt=Rt+Math.imul(Ct,kr)|0;var gn=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(gn>>>26)|0,gn&=67108863,Ot=Math.imul(zt,Ar),bt=Math.imul(zt,Rr),bt=bt+Math.imul(Ht,Ar)|0,Rt=Math.imul(Ht,Rr),Ot=Ot+Math.imul($t,Ir)|0,bt=bt+Math.imul($t,kr)|0,bt=bt+Math.imul(Dt,Ir)|0,Rt=Rt+Math.imul(Dt,kr)|0;var yn=(Bt+Ot|0)+((bt&8191)<<13)|0;Bt=(Rt+(bt>>>13)|0)+(yn>>>26)|0,yn&=67108863,Ot=Math.imul(zt,Ir),bt=Math.imul(zt,kr),bt=bt+Math.imul(Ht,Ir)|0,Rt=Math.imul(Ht,kr);var mn=(Bt+Ot|0)+((bt&8191)<<13)|0;return Bt=(Rt+(bt>>>13)|0)+(mn>>>26)|0,mn&=67108863,Nt[0]=Br,Nt[1]=Mr,Nt[2]=Fr,Nt[3]=Ur,Nt[4]=zr,Nt[5]=rn,Nt[6]=nn,Nt[7]=sn,Nt[8]=an,Nt[9]=ln,Nt[10]=cn,Nt[11]=un,Nt[12]=fn,Nt[13]=dn,Nt[14]=hn,Nt[15]=pn,Nt[16]=gn,Nt[17]=yn,Nt[18]=mn,Bt!==0&&(Nt[19]=Bt,xt.length++),xt};Math.imul||(pt=ft);function yt(kt,gt,Et){Et.negative=gt.negative^kt.negative,Et.length=kt.length+gt.length;for(var xt=0,Tt=0,At=0;At<Et.length-1;At++){var Nt=Tt;Tt=0;for(var Bt=xt&67108863,Ot=Math.min(At,gt.length-1),bt=Math.max(0,At-kt.length+1);bt<=Ot;bt++){var Rt=At-bt,Gt=kt.words[Rt]|0,Pt=gt.words[bt]|0,Ft=Gt*Pt,jt=Ft&67108863;Nt=Nt+(Ft/67108864|0)|0,jt=jt+Bt|0,Bt=jt&67108863,Nt=Nt+(jt>>>26)|0,Tt+=Nt>>>26,Nt&=67108863}Et.words[At]=Bt,xt=Nt,Nt=Tt}return xt!==0?Et.words[At]=xt:Et.length--,Et._strip()}function mt(kt,gt,Et){return yt(kt,gt,Et)}et.prototype.mulTo=function(gt,Et){var xt,Tt=this.length+gt.length;return this.length===10&&gt.length===10?xt=pt(this,gt,Et):Tt<63?xt=ft(this,gt,Et):Tt<1024?xt=yt(this,gt,Et):xt=mt(this,gt,Et),xt},et.prototype.mul=function(gt){var Et=new et(null);return Et.words=new Array(this.length+gt.length),this.mulTo(gt,Et)},et.prototype.mulf=function(gt){var Et=new et(null);return Et.words=new Array(this.length+gt.length),mt(this,gt,Et)},et.prototype.imul=function(gt){return this.clone().mulTo(gt,this)},et.prototype.imuln=function(gt){var Et=gt<0;Et&&(gt=-gt),j(typeof gt=="number"),j(gt<67108864);for(var xt=0,Tt=0;Tt<this.length;Tt++){var At=(this.words[Tt]|0)*gt,Nt=(At&67108863)+(xt&67108863);xt>>=26,xt+=At/67108864|0,xt+=Nt>>>26,this.words[Tt]=Nt&67108863}return xt!==0&&(this.words[Tt]=xt,this.length++),Et?this.ineg():this},et.prototype.muln=function(gt){return this.clone().imuln(gt)},et.prototype.sqr=function(){return this.mul(this)},et.prototype.isqr=function(){return this.imul(this.clone())},et.prototype.pow=function(gt){var Et=dt(gt);if(Et.length===0)return new et(1);for(var xt=this,Tt=0;Tt<Et.length&&Et[Tt]===0;Tt++,xt=xt.sqr());if(++Tt<Et.length)for(var At=xt.sqr();Tt<Et.length;Tt++,At=At.sqr())Et[Tt]!==0&&(xt=xt.mul(At));return xt},et.prototype.iushln=function(gt){j(typeof gt=="number"&&gt>=0);var Et=gt%26,xt=(gt-Et)/26,Tt=67108863>>>26-Et<<26-Et,At;if(Et!==0){var Nt=0;for(At=0;At<this.length;At++){var Bt=this.words[At]&Tt,Ot=(this.words[At]|0)-Bt<<Et;this.words[At]=Ot|Nt,Nt=Bt>>>26-Et}Nt&&(this.words[At]=Nt,this.length++)}if(xt!==0){for(At=this.length-1;At>=0;At--)this.words[At+xt]=this.words[At];for(At=0;At<xt;At++)this.words[At]=0;this.length+=xt}return this._strip()},et.prototype.ishln=function(gt){return j(this.negative===0),this.iushln(gt)},et.prototype.iushrn=function(gt,Et,xt){j(typeof gt=="number"&&gt>=0);var Tt;Et?Tt=(Et-Et%26)/26:Tt=0;var At=gt%26,Nt=Math.min((gt-At)/26,this.length),Bt=67108863^67108863>>>At<<At,Ot=xt;if(Tt-=Nt,Tt=Math.max(0,Tt),Ot){for(var bt=0;bt<Nt;bt++)Ot.words[bt]=this.words[bt];Ot.length=Nt}if(Nt!==0)if(this.length>Nt)for(this.length-=Nt,bt=0;bt<this.length;bt++)this.words[bt]=this.words[bt+Nt];else this.words[0]=0,this.length=1;var Rt=0;for(bt=this.length-1;bt>=0&&(Rt!==0||bt>=Tt);bt--){var Gt=this.words[bt]|0;this.words[bt]=Rt<<26-At|Gt>>>At,Rt=Gt&Bt}return Ot&&Rt!==0&&(Ot.words[Ot.length++]=Rt),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},et.prototype.ishrn=function(gt,Et,xt){return j(this.negative===0),this.iushrn(gt,Et,xt)},et.prototype.shln=function(gt){return this.clone().ishln(gt)},et.prototype.ushln=function(gt){return this.clone().iushln(gt)},et.prototype.shrn=function(gt){return this.clone().ishrn(gt)},et.prototype.ushrn=function(gt){return this.clone().iushrn(gt)},et.prototype.testn=function(gt){j(typeof gt=="number"&&gt>=0);var Et=gt%26,xt=(gt-Et)/26,Tt=1<<Et;if(this.length<=xt)return!1;var At=this.words[xt];return!!(At&Tt)},et.prototype.imaskn=function(gt){j(typeof gt=="number"&&gt>=0);var Et=gt%26,xt=(gt-Et)/26;if(j(this.negative===0,"imaskn works only with positive numbers"),this.length<=xt)return this;if(Et!==0&&xt++,this.length=Math.min(xt,this.length),Et!==0){var Tt=67108863^67108863>>>Et<<Et;this.words[this.length-1]&=Tt}return this._strip()},et.prototype.maskn=function(gt){return this.clone().imaskn(gt)},et.prototype.iaddn=function(gt){return j(typeof gt=="number"),j(gt<67108864),gt<0?this.isubn(-gt):this.negative!==0?this.length===1&&(this.words[0]|0)<=gt?(this.words[0]=gt-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(gt),this.negative=1,this):this._iaddn(gt)},et.prototype._iaddn=function(gt){this.words[0]+=gt;for(var Et=0;Et<this.length&&this.words[Et]>=67108864;Et++)this.words[Et]-=67108864,Et===this.length-1?this.words[Et+1]=1:this.words[Et+1]++;return this.length=Math.max(this.length,Et+1),this},et.prototype.isubn=function(gt){if(j(typeof gt=="number"),j(gt<67108864),gt<0)return this.iaddn(-gt);if(this.negative!==0)return this.negative=0,this.iaddn(gt),this.negative=1,this;if(this.words[0]-=gt,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var Et=0;Et<this.length&&this.words[Et]<0;Et++)this.words[Et]+=67108864,this.words[Et+1]-=1;return this._strip()},et.prototype.addn=function(gt){return this.clone().iaddn(gt)},et.prototype.subn=function(gt){return this.clone().isubn(gt)},et.prototype.iabs=function(){return this.negative=0,this},et.prototype.abs=function(){return this.clone().iabs()},et.prototype._ishlnsubmul=function(gt,Et,xt){var Tt=gt.length+xt,At;this._expand(Tt);var Nt,Bt=0;for(At=0;At<gt.length;At++){Nt=(this.words[At+xt]|0)+Bt;var Ot=(gt.words[At]|0)*Et;Nt-=Ot&67108863,Bt=(Nt>>26)-(Ot/67108864|0),this.words[At+xt]=Nt&67108863}for(;At<this.length-xt;At++)Nt=(this.words[At+xt]|0)+Bt,Bt=Nt>>26,this.words[At+xt]=Nt&67108863;if(Bt===0)return this._strip();for(j(Bt===-1),Bt=0,At=0;At<this.length;At++)Nt=-(this.words[At]|0)+Bt,Bt=Nt>>26,this.words[At]=Nt&67108863;return this.negative=1,this._strip()},et.prototype._wordDiv=function(gt,Et){var xt=this.length-gt.length,Tt=this.clone(),At=gt,Nt=At.words[At.length-1]|0,Bt=this._countBits(Nt);xt=26-Bt,xt!==0&&(At=At.ushln(xt),Tt.iushln(xt),Nt=At.words[At.length-1]|0);var Ot=Tt.length-At.length,bt;if(Et!=="mod"){bt=new et(null),bt.length=Ot+1,bt.words=new Array(bt.length);for(var Rt=0;Rt<bt.length;Rt++)bt.words[Rt]=0}var Gt=Tt.clone()._ishlnsubmul(At,1,Ot);Gt.negative===0&&(Tt=Gt,bt&&(bt.words[Ot]=1));for(var Pt=Ot-1;Pt>=0;Pt--){var Ft=(Tt.words[At.length+Pt]|0)*67108864+(Tt.words[At.length+Pt-1]|0);for(Ft=Math.min(Ft/Nt|0,67108863),Tt._ishlnsubmul(At,Ft,Pt);Tt.negative!==0;)Ft--,Tt.negative=0,Tt._ishlnsubmul(At,1,Pt),Tt.isZero()||(Tt.negative^=1);bt&&(bt.words[Pt]=Ft)}return bt&&bt._strip(),Tt._strip(),Et!=="div"&&xt!==0&&Tt.iushrn(xt),{div:bt||null,mod:Tt}},et.prototype.divmod=function(gt,Et,xt){if(j(!gt.isZero()),this.isZero())return{div:new et(0),mod:new et(0)};var Tt,At,Nt;return this.negative!==0&&gt.negative===0?(Nt=this.neg().divmod(gt,Et),Et!=="mod"&&(Tt=Nt.div.neg()),Et!=="div"&&(At=Nt.mod.neg(),xt&&At.negative!==0&&At.iadd(gt)),{div:Tt,mod:At}):this.negative===0&&gt.negative!==0?(Nt=this.divmod(gt.neg(),Et),Et!=="mod"&&(Tt=Nt.div.neg()),{div:Tt,mod:Nt.mod}):(this.negative&gt.negative)!==0?(Nt=this.neg().divmod(gt.neg(),Et),Et!=="div"&&(At=Nt.mod.neg(),xt&&At.negative!==0&&At.isub(gt)),{div:Nt.div,mod:At}):gt.length>this.length||this.cmp(gt)<0?{div:new et(0),mod:this}:gt.length===1?Et==="div"?{div:this.divn(gt.words[0]),mod:null}:Et==="mod"?{div:null,mod:new et(this.modrn(gt.words[0]))}:{div:this.divn(gt.words[0]),mod:new et(this.modrn(gt.words[0]))}:this._wordDiv(gt,Et)},et.prototype.div=function(gt){return this.divmod(gt,"div",!1).div},et.prototype.mod=function(gt){return this.divmod(gt,"mod",!1).mod},et.prototype.umod=function(gt){return this.divmod(gt,"mod",!0).mod},et.prototype.divRound=function(gt){var Et=this.divmod(gt);if(Et.mod.isZero())return Et.div;var xt=Et.div.negative!==0?Et.mod.isub(gt):Et.mod,Tt=gt.ushrn(1),At=gt.andln(1),Nt=xt.cmp(Tt);return Nt<0||At===1&&Nt===0?Et.div:Et.div.negative!==0?Et.div.isubn(1):Et.div.iaddn(1)},et.prototype.modrn=function(gt){var Et=gt<0;Et&&(gt=-gt),j(gt<=67108863);for(var xt=(1<<26)%gt,Tt=0,At=this.length-1;At>=0;At--)Tt=(xt*Tt+(this.words[At]|0))%gt;return Et?-Tt:Tt},et.prototype.modn=function(gt){return this.modrn(gt)},et.prototype.idivn=function(gt){var Et=gt<0;Et&&(gt=-gt),j(gt<=67108863);for(var xt=0,Tt=this.length-1;Tt>=0;Tt--){var At=(this.words[Tt]|0)+xt*67108864;this.words[Tt]=At/gt|0,xt=At%gt}return this._strip(),Et?this.ineg():this},et.prototype.divn=function(gt){return this.clone().idivn(gt)},et.prototype.egcd=function(gt){j(gt.negative===0),j(!gt.isZero());var Et=this,xt=gt.clone();Et.negative!==0?Et=Et.umod(gt):Et=Et.clone();for(var Tt=new et(1),At=new et(0),Nt=new et(0),Bt=new et(1),Ot=0;Et.isEven()&&xt.isEven();)Et.iushrn(1),xt.iushrn(1),++Ot;for(var bt=xt.clone(),Rt=Et.clone();!Et.isZero();){for(var Gt=0,Pt=1;(Et.words[0]&Pt)===0&&Gt<26;++Gt,Pt<<=1);if(Gt>0)for(Et.iushrn(Gt);Gt-- >0;)(Tt.isOdd()||At.isOdd())&&(Tt.iadd(bt),At.isub(Rt)),Tt.iushrn(1),At.iushrn(1);for(var Ft=0,jt=1;(xt.words[0]&jt)===0&&Ft<26;++Ft,jt<<=1);if(Ft>0)for(xt.iushrn(Ft);Ft-- >0;)(Nt.isOdd()||Bt.isOdd())&&(Nt.iadd(bt),Bt.isub(Rt)),Nt.iushrn(1),Bt.iushrn(1);Et.cmp(xt)>=0?(Et.isub(xt),Tt.isub(Nt),At.isub(Bt)):(xt.isub(Et),Nt.isub(Tt),Bt.isub(At))}return{a:Nt,b:Bt,gcd:xt.iushln(Ot)}},et.prototype._invmp=function(gt){j(gt.negative===0),j(!gt.isZero());var Et=this,xt=gt.clone();Et.negative!==0?Et=Et.umod(gt):Et=Et.clone();for(var Tt=new et(1),At=new et(0),Nt=xt.clone();Et.cmpn(1)>0&&xt.cmpn(1)>0;){for(var Bt=0,Ot=1;(Et.words[0]&Ot)===0&&Bt<26;++Bt,Ot<<=1);if(Bt>0)for(Et.iushrn(Bt);Bt-- >0;)Tt.isOdd()&&Tt.iadd(Nt),Tt.iushrn(1);for(var bt=0,Rt=1;(xt.words[0]&Rt)===0&&bt<26;++bt,Rt<<=1);if(bt>0)for(xt.iushrn(bt);bt-- >0;)At.isOdd()&&At.iadd(Nt),At.iushrn(1);Et.cmp(xt)>=0?(Et.isub(xt),Tt.isub(At)):(xt.isub(Et),At.isub(Tt))}var Gt;return Et.cmpn(1)===0?Gt=Tt:Gt=At,Gt.cmpn(0)<0&&Gt.iadd(gt),Gt},et.prototype.gcd=function(gt){if(this.isZero())return gt.abs();if(gt.isZero())return this.abs();var Et=this.clone(),xt=gt.clone();Et.negative=0,xt.negative=0;for(var Tt=0;Et.isEven()&&xt.isEven();Tt++)Et.iushrn(1),xt.iushrn(1);do{for(;Et.isEven();)Et.iushrn(1);for(;xt.isEven();)xt.iushrn(1);var At=Et.cmp(xt);if(At<0){var Nt=Et;Et=xt,xt=Nt}else if(At===0||xt.cmpn(1)===0)break;Et.isub(xt)}while(!0);return xt.iushln(Tt)},et.prototype.invm=function(gt){return this.egcd(gt).a.umod(gt)},et.prototype.isEven=function(){return(this.words[0]&1)===0},et.prototype.isOdd=function(){return(this.words[0]&1)===1},et.prototype.andln=function(gt){return this.words[0]&gt},et.prototype.bincn=function(gt){j(typeof gt=="number");var Et=gt%26,xt=(gt-Et)/26,Tt=1<<Et;if(this.length<=xt)return this._expand(xt+1),this.words[xt]|=Tt,this;for(var At=Tt,Nt=xt;At!==0&&Nt<this.length;Nt++){var Bt=this.words[Nt]|0;Bt+=At,At=Bt>>>26,Bt&=67108863,this.words[Nt]=Bt}return At!==0&&(this.words[Nt]=At,this.length++),this},et.prototype.isZero=function(){return this.length===1&&this.words[0]===0},et.prototype.cmpn=function(gt){var Et=gt<0;if(this.negative!==0&&!Et)return-1;if(this.negative===0&&Et)return 1;this._strip();var xt;if(this.length>1)xt=1;else{Et&&(gt=-gt),j(gt<=67108863,"Number is too big");var Tt=this.words[0]|0;xt=Tt===gt?0:Tt<gt?-1:1}return this.negative!==0?-xt|0:xt},et.prototype.cmp=function(gt){if(this.negative!==0&&gt.negative===0)return-1;if(this.negative===0&&gt.negative!==0)return 1;var Et=this.ucmp(gt);return this.negative!==0?-Et|0:Et},et.prototype.ucmp=function(gt){if(this.length>gt.length)return 1;if(this.length<gt.length)return-1;for(var Et=0,xt=this.length-1;xt>=0;xt--){var Tt=this.words[xt]|0,At=gt.words[xt]|0;if(Tt!==At){Tt<At?Et=-1:Tt>At&&(Et=1);break}}return Et},et.prototype.gtn=function(gt){return this.cmpn(gt)===1},et.prototype.gt=function(gt){return this.cmp(gt)===1},et.prototype.gten=function(gt){return this.cmpn(gt)>=0},et.prototype.gte=function(gt){return this.cmp(gt)>=0},et.prototype.ltn=function(gt){return this.cmpn(gt)===-1},et.prototype.lt=function(gt){return this.cmp(gt)===-1},et.prototype.lten=function(gt){return this.cmpn(gt)<=0},et.prototype.lte=function(gt){return this.cmp(gt)<=0},et.prototype.eqn=function(gt){return this.cmpn(gt)===0},et.prototype.eq=function(gt){return this.cmp(gt)===0},et.red=function(gt){return new Mt(gt)},et.prototype.toRed=function(gt){return j(!this.red,"Already a number in reduction context"),j(this.negative===0,"red works only with positives"),gt.convertTo(this)._forceRed(gt)},et.prototype.fromRed=function(){return j(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},et.prototype._forceRed=function(gt){return this.red=gt,this},et.prototype.forceRed=function(gt){return j(!this.red,"Already a number in reduction context"),this._forceRed(gt)},et.prototype.redAdd=function(gt){return j(this.red,"redAdd works only with red numbers"),this.red.add(this,gt)},et.prototype.redIAdd=function(gt){return j(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,gt)},et.prototype.redSub=function(gt){return j(this.red,"redSub works only with red numbers"),this.red.sub(this,gt)},et.prototype.redISub=function(gt){return j(this.red,"redISub works only with red numbers"),this.red.isub(this,gt)},et.prototype.redShl=function(gt){return j(this.red,"redShl works only with red numbers"),this.red.shl(this,gt)},et.prototype.redMul=function(gt){return j(this.red,"redMul works only with red numbers"),this.red._verify2(this,gt),this.red.mul(this,gt)},et.prototype.redIMul=function(gt){return j(this.red,"redMul works only with red numbers"),this.red._verify2(this,gt),this.red.imul(this,gt)},et.prototype.redSqr=function(){return j(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},et.prototype.redISqr=function(){return j(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},et.prototype.redSqrt=function(){return j(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},et.prototype.redInvm=function(){return j(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},et.prototype.redNeg=function(){return j(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},et.prototype.redPow=function(gt){return j(this.red&&!gt.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,gt)};var _t={k256:null,p224:null,p192:null,p25519:null};function vt(kt,gt){this.name=kt,this.p=new et(gt,16),this.n=this.p.bitLength(),this.k=new et(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}vt.prototype._tmp=function(){var gt=new et(null);return gt.words=new Array(Math.ceil(this.n/13)),gt},vt.prototype.ireduce=function(gt){var Et=gt,xt;do this.split(Et,this.tmp),Et=this.imulK(Et),Et=Et.iadd(this.tmp),xt=Et.bitLength();while(xt>this.n);var Tt=xt<this.n?-1:Et.ucmp(this.p);return Tt===0?(Et.words[0]=0,Et.length=1):Tt>0?Et.isub(this.p):Et.strip!==void 0?Et.strip():Et._strip(),Et},vt.prototype.split=function(gt,Et){gt.iushrn(this.n,0,Et)},vt.prototype.imulK=function(gt){return gt.imul(this.k)};function ht(){vt.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}_e(ht,vt),ht.prototype.split=function(gt,Et){for(var xt=4194303,Tt=Math.min(gt.length,9),At=0;At<Tt;At++)Et.words[At]=gt.words[At];if(Et.length=Tt,gt.length<=9){gt.words[0]=0,gt.length=1;return}var Nt=gt.words[9];for(Et.words[Et.length++]=Nt&xt,At=10;At<gt.length;At++){var Bt=gt.words[At]|0;gt.words[At-10]=(Bt&xt)<<4|Nt>>>22,Nt=Bt}Nt>>>=22,gt.words[At-10]=Nt,Nt===0&&gt.length>10?gt.length-=10:gt.length-=9},ht.prototype.imulK=function(gt){gt.words[gt.length]=0,gt.words[gt.length+1]=0,gt.length+=2;for(var Et=0,xt=0;xt<gt.length;xt++){var Tt=gt.words[xt]|0;Et+=Tt*977,gt.words[xt]=Et&67108863,Et=Tt*64+(Et/67108864|0)}return gt.words[gt.length-1]===0&&(gt.length--,gt.words[gt.length-1]===0&&gt.length--),gt};function St(){vt.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}_e(St,vt);function It(){vt.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}_e(It,vt);function Lt(){vt.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}_e(Lt,vt),Lt.prototype.imulK=function(gt){for(var Et=0,xt=0;xt<gt.length;xt++){var Tt=(gt.words[xt]|0)*19+Et,At=Tt&67108863;Tt>>>=26,gt.words[xt]=At,Et=Tt}return Et!==0&&(gt.words[gt.length++]=Et),gt},et._prime=function(gt){if(_t[gt])return _t[gt];var Et;if(gt==="k256")Et=new ht;else if(gt==="p224")Et=new St;else if(gt==="p192")Et=new It;else if(gt==="p25519")Et=new Lt;else throw new Error("Unknown prime "+gt);return _t[gt]=Et,Et};function Mt(kt){if(typeof kt=="string"){var gt=et._prime(kt);this.m=gt.p,this.prime=gt}else j(kt.gtn(1),"modulus must be greater than 1"),this.m=kt,this.prime=null}Mt.prototype._verify1=function(gt){j(gt.negative===0,"red works only with positives"),j(gt.red,"red works only with red numbers")},Mt.prototype._verify2=function(gt,Et){j((gt.negative|Et.negative)===0,"red works only with positives"),j(gt.red&&gt.red===Et.red,"red works only with red numbers")},Mt.prototype.imod=function(gt){return this.prime?this.prime.ireduce(gt)._forceRed(this):(st(gt,gt.umod(this.m)._forceRed(this)),gt)},Mt.prototype.neg=function(gt){return gt.isZero()?gt.clone():this.m.sub(gt)._forceRed(this)},Mt.prototype.add=function(gt,Et){this._verify2(gt,Et);var xt=gt.add(Et);return xt.cmp(this.m)>=0&&xt.isub(this.m),xt._forceRed(this)},Mt.prototype.iadd=function(gt,Et){this._verify2(gt,Et);var xt=gt.iadd(Et);return xt.cmp(this.m)>=0&&xt.isub(this.m),xt},Mt.prototype.sub=function(gt,Et){this._verify2(gt,Et);var xt=gt.sub(Et);return xt.cmpn(0)<0&&xt.iadd(this.m),xt._forceRed(this)},Mt.prototype.isub=function(gt,Et){this._verify2(gt,Et);var xt=gt.isub(Et);return xt.cmpn(0)<0&&xt.iadd(this.m),xt},Mt.prototype.shl=function(gt,Et){return this._verify1(gt),this.imod(gt.ushln(Et))},Mt.prototype.imul=function(gt,Et){return this._verify2(gt,Et),this.imod(gt.imul(Et))},Mt.prototype.mul=function(gt,Et){return this._verify2(gt,Et),this.imod(gt.mul(Et))},Mt.prototype.isqr=function(gt){return this.imul(gt,gt.clone())},Mt.prototype.sqr=function(gt){return this.mul(gt,gt)},Mt.prototype.sqrt=function(gt){if(gt.isZero())return gt.clone();var Et=this.m.andln(3);if(j(Et%2===1),Et===3){var xt=this.m.add(new et(1)).iushrn(2);return this.pow(gt,xt)}for(var Tt=this.m.subn(1),At=0;!Tt.isZero()&&Tt.andln(1)===0;)At++,Tt.iushrn(1);j(!Tt.isZero());var Nt=new et(1).toRed(this),Bt=Nt.redNeg(),Ot=this.m.subn(1).iushrn(1),bt=this.m.bitLength();for(bt=new et(2*bt*bt).toRed(this);this.pow(bt,Ot).cmp(Bt)!==0;)bt.redIAdd(Bt);for(var Rt=this.pow(bt,Tt),Gt=this.pow(gt,Tt.addn(1).iushrn(1)),Pt=this.pow(gt,Tt),Ft=At;Pt.cmp(Nt)!==0;){for(var jt=Pt,Vt=0;jt.cmp(Nt)!==0;Vt++)jt=jt.redSqr();j(Vt<Ft);var Wt=this.pow(Rt,new et(1).iushln(Ft-Vt-1));Gt=Gt.redMul(Wt),Rt=Wt.redSqr(),Pt=Pt.redMul(Rt),Ft=Vt}return Gt},Mt.prototype.invm=function(gt){var Et=gt._invmp(this.m);return Et.negative!==0?(Et.negative=0,this.imod(Et).redNeg()):this.imod(Et)},Mt.prototype.pow=function(gt,Et){if(Et.isZero())return new et(1).toRed(this);if(Et.cmpn(1)===0)return gt.clone();var xt=4,Tt=new Array(1<<xt);Tt[0]=new et(1).toRed(this),Tt[1]=gt;for(var At=2;At<Tt.length;At++)Tt[At]=this.mul(Tt[At-1],gt);var Nt=Tt[0],Bt=0,Ot=0,bt=Et.bitLength()%26;for(bt===0&&(bt=26),At=Et.length-1;At>=0;At--){for(var Rt=Et.words[At],Gt=bt-1;Gt>=0;Gt--){var Pt=Rt>>Gt&1;if(Nt!==Tt[0]&&(Nt=this.sqr(Nt)),Pt===0&&Bt===0){Ot=0;continue}Bt<<=1,Bt|=Pt,Ot++,!(Ot!==xt&&(At!==0||Gt!==0))&&(Nt=this.mul(Nt,Tt[Bt]),Ot=0,Bt=0)}bt=26}return Nt},Mt.prototype.convertTo=function(gt){var Et=gt.umod(this.m);return Et===gt?Et.clone():Et},Mt.prototype.convertFrom=function(gt){var Et=gt.clone();return Et.red=null,Et},et.mont=function(gt){return new Kt(gt)};function Kt(kt){Mt.call(this,kt),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new et(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_e(Kt,Mt),Kt.prototype.convertTo=function(gt){return this.imod(gt.ushln(this.shift))},Kt.prototype.convertFrom=function(gt){var Et=this.imod(gt.mul(this.rinv));return Et.red=null,Et},Kt.prototype.imul=function(gt,Et){if(gt.isZero()||Et.isZero())return gt.words[0]=0,gt.length=1,gt;var xt=gt.imul(Et),Tt=xt.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),At=xt.isub(Tt).iushrn(this.shift),Nt=At;return At.cmp(this.m)>=0?Nt=At.isub(this.m):At.cmpn(0)<0&&(Nt=At.iadd(this.m)),Nt._forceRed(this)},Kt.prototype.mul=function(gt,Et){if(gt.isZero()||Et.isZero())return new et(0)._forceRed(this);var xt=gt.mul(Et),Tt=xt.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),At=xt.isub(Tt).iushrn(this.shift),Nt=At;return At.cmp(this.m)>=0?Nt=At.isub(this.m):At.cmpn(0)<0&&(Nt=At.iadd(this.m)),Nt._forceRed(this)},Kt.prototype.invm=function(gt){var Et=this.imod(gt._invmp(this.m).mul(this.r2));return Et._forceRed(this)}})(_,commonjsGlobal)})(bn);const BN$1=bn.exports,version$k="logger/5.7.0";let _permanentCensorErrors=!1,_censorErrors=!1;const LogLevels={debug:1,default:2,info:2,warning:3,error:4,off:5};let _logLevel=LogLevels.default,_globalLogger=null;function _checkNormalize(){try{const _=[];if(["NFD","NFC","NFKD","NFKC"].forEach(a=>{try{if("test".normalize(a)!=="test")throw new Error("bad normalize")}catch{_.push(a)}}),_.length)throw new Error("missing "+_.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(_){return _.message}return null}const _normalizeError=_checkNormalize();var LogLevel;(function(_){_.DEBUG="DEBUG",_.INFO="INFO",_.WARNING="WARNING",_.ERROR="ERROR",_.OFF="OFF"})(LogLevel||(LogLevel={}));var ErrorCode;(function(_){_.UNKNOWN_ERROR="UNKNOWN_ERROR",_.NOT_IMPLEMENTED="NOT_IMPLEMENTED",_.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",_.NETWORK_ERROR="NETWORK_ERROR",_.SERVER_ERROR="SERVER_ERROR",_.TIMEOUT="TIMEOUT",_.BUFFER_OVERRUN="BUFFER_OVERRUN",_.NUMERIC_FAULT="NUMERIC_FAULT",_.MISSING_NEW="MISSING_NEW",_.INVALID_ARGUMENT="INVALID_ARGUMENT",_.MISSING_ARGUMENT="MISSING_ARGUMENT",_.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",_.CALL_EXCEPTION="CALL_EXCEPTION",_.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",_.NONCE_EXPIRED="NONCE_EXPIRED",_.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",_.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",_.TRANSACTION_REPLACED="TRANSACTION_REPLACED",_.ACTION_REJECTED="ACTION_REJECTED"})(ErrorCode||(ErrorCode={}));const HEX="0123456789abcdef";class Logger{constructor(a){Object.defineProperty(this,"version",{enumerable:!0,value:a,writable:!1})}_log(a,$){const j=a.toLowerCase();LogLevels[j]==null&&this.throwArgumentError("invalid log level name","logLevel",a),!(_logLevel>LogLevels[j])&&console.log.apply(console,$)}debug(...a){this._log(Logger.levels.DEBUG,a)}info(...a){this._log(Logger.levels.INFO,a)}warn(...a){this._log(Logger.levels.WARNING,a)}makeError(a,$,j){if(_censorErrors)return this.makeError("censored error",$,{});$||($=Logger.errors.UNKNOWN_ERROR),j||(j={});const _e=[];Object.keys(j).forEach(nt=>{const it=j[nt];try{if(it instanceof Uint8Array){let st="";for(let ot=0;ot<it.length;ot++)st+=HEX[it[ot]>>4],st+=HEX[it[ot]&15];_e.push(nt+"=Uint8Array(0x"+st+")")}else _e.push(nt+"="+JSON.stringify(it))}catch{_e.push(nt+"="+JSON.stringify(j[nt].toString()))}}),_e.push(`code=${$}`),_e.push(`version=${this.version}`);const et=a;let tt="";switch($){case ErrorCode.NUMERIC_FAULT:{tt="NUMERIC_FAULT";const nt=a;switch(nt){case"overflow":case"underflow":case"division-by-zero":tt+="-"+nt;break;case"negative-power":case"negative-width":tt+="-unsupported";break;case"unbound-bitwise-result":tt+="-unbound-result";break}break}case ErrorCode.CALL_EXCEPTION:case ErrorCode.INSUFFICIENT_FUNDS:case ErrorCode.MISSING_NEW:case ErrorCode.NONCE_EXPIRED:case ErrorCode.REPLACEMENT_UNDERPRICED:case ErrorCode.TRANSACTION_REPLACED:case ErrorCode.UNPREDICTABLE_GAS_LIMIT:tt=$;break}tt&&(a+=" [ See: https://links.ethers.org/v5-errors-"+tt+" ]"),_e.length&&(a+=" ("+_e.join(", ")+")");const rt=new Error(a);return rt.reason=et,rt.code=$,Object.keys(j).forEach(function(nt){rt[nt]=j[nt]}),rt}throwError(a,$,j){throw this.makeError(a,$,j)}throwArgumentError(a,$,j){return this.throwError(a,Logger.errors.INVALID_ARGUMENT,{argument:$,value:j})}assert(a,$,j,_e){a||this.throwError($,j,_e)}assertArgument(a,$,j,_e){a||this.throwArgumentError($,j,_e)}checkNormalize(a){_normalizeError&&this.throwError("platform missing String.prototype.normalize",Logger.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:_normalizeError})}checkSafeUint53(a,$){typeof a=="number"&&($==null&&($="value not safe"),(a<0||a>=9007199254740991)&&this.throwError($,Logger.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:a}),a%1&&this.throwError($,Logger.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:a}))}checkArgumentCount(a,$,j){j?j=": "+j:j="",a<$&&this.throwError("missing argument"+j,Logger.errors.MISSING_ARGUMENT,{count:a,expectedCount:$}),a>$&&this.throwError("too many arguments"+j,Logger.errors.UNEXPECTED_ARGUMENT,{count:a,expectedCount:$})}checkNew(a,$){(a===Object||a==null)&&this.throwError("missing new",Logger.errors.MISSING_NEW,{name:$.name})}checkAbstract(a,$){a===$?this.throwError("cannot instantiate abstract class "+JSON.stringify($.name)+" directly; use a sub-class",Logger.errors.UNSUPPORTED_OPERATION,{name:a.name,operation:"new"}):(a===Object||a==null)&&this.throwError("missing new",Logger.errors.MISSING_NEW,{name:$.name})}static globalLogger(){return _globalLogger||(_globalLogger=new Logger(version$k)),_globalLogger}static setCensorship(a,$){if(!a&&$&&this.globalLogger().throwError("cannot permanently disable censorship",Logger.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),_permanentCensorErrors){if(!a)return;this.globalLogger().throwError("error censorship permanent",Logger.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}_censorErrors=!!a,_permanentCensorErrors=!!$}static setLogLevel(a){const $=LogLevels[a.toLowerCase()];if($==null){Logger.globalLogger().warn("invalid log level - "+a);return}_logLevel=$}static from(a){return new Logger(a)}}Logger.errors=ErrorCode;Logger.levels=LogLevel;const version$j="bytes/5.7.0",logger$r=new Logger(version$j);function isHexable(_){return!!_.toHexString}function addSlice(_){return _.slice||(_.slice=function(){const a=Array.prototype.slice.call(arguments);return addSlice(new Uint8Array(Array.prototype.slice.apply(_,a)))}),_}function isBytesLike(_){return isHexString(_)&&!(_.length%2)||isBytes$1(_)}function isInteger(_){return typeof _=="number"&&_==_&&_%1===0}function isBytes$1(_){if(_==null)return!1;if(_.constructor===Uint8Array)return!0;if(typeof _=="string"||!isInteger(_.length)||_.length<0)return!1;for(let a=0;a<_.length;a++){const $=_[a];if(!isInteger($)||$<0||$>=256)return!1}return!0}function arrayify(_,a){if(a||(a={}),typeof _=="number"){logger$r.checkSafeUint53(_,"invalid arrayify value");const $=[];for(;_;)$.unshift(_&255),_=parseInt(String(_/256));return $.length===0&&$.push(0),addSlice(new Uint8Array($))}if(a.allowMissingPrefix&&typeof _=="string"&&_.substring(0,2)!=="0x"&&(_="0x"+_),isHexable(_)&&(_=_.toHexString()),isHexString(_)){let $=_.substring(2);$.length%2&&(a.hexPad==="left"?$="0"+$:a.hexPad==="right"?$+="0":logger$r.throwArgumentError("hex data is odd-length","value",_));const j=[];for(let _e=0;_e<$.length;_e+=2)j.push(parseInt($.substring(_e,_e+2),16));return addSlice(new Uint8Array(j))}return isBytes$1(_)?addSlice(new Uint8Array(_)):logger$r.throwArgumentError("invalid arrayify value","value",_)}function concat$3(_){const a=_.map(_e=>arrayify(_e)),$=a.reduce((_e,et)=>_e+et.length,0),j=new Uint8Array($);return a.reduce((_e,et)=>(j.set(et,_e),_e+et.length),0),addSlice(j)}function stripZeros(_){let a=arrayify(_);if(a.length===0)return a;let $=0;for(;$<a.length&&a[$]===0;)$++;return $&&(a=a.slice($)),a}function zeroPad(_,a){_=arrayify(_),_.length>a&&logger$r.throwArgumentError("value out of range","value",arguments[0]);const $=new Uint8Array(a);return $.set(_,a-_.length),addSlice($)}function isHexString(_,a){return!(typeof _!="string"||!_.match(/^0x[0-9A-Fa-f]*$/)||a&&_.length!==2+2*a)}const HexCharacters="0123456789abcdef";function hexlify(_,a){if(a||(a={}),typeof _=="number"){logger$r.checkSafeUint53(_,"invalid hexlify value");let $="";for(;_;)$=HexCharacters[_&15]+$,_=Math.floor(_/16);return $.length?($.length%2&&($="0"+$),"0x"+$):"0x00"}if(typeof _=="bigint")return _=_.toString(16),_.length%2?"0x0"+_:"0x"+_;if(a.allowMissingPrefix&&typeof _=="string"&&_.substring(0,2)!=="0x"&&(_="0x"+_),isHexable(_))return _.toHexString();if(isHexString(_))return _.length%2&&(a.hexPad==="left"?_="0x0"+_.substring(2):a.hexPad==="right"?_+="0":logger$r.throwArgumentError("hex data is odd-length","value",_)),_.toLowerCase();if(isBytes$1(_)){let $="0x";for(let j=0;j<_.length;j++){let _e=_[j];$+=HexCharacters[(_e&240)>>4]+HexCharacters[_e&15]}return $}return logger$r.throwArgumentError("invalid hexlify value","value",_)}function hexDataLength(_){if(typeof _!="string")_=hexlify(_);else if(!isHexString(_)||_.length%2)return null;return(_.length-2)/2}function hexDataSlice(_,a,$){return typeof _!="string"?_=hexlify(_):(!isHexString(_)||_.length%2)&&logger$r.throwArgumentError("invalid hexData","value",_),a=2+2*a,$!=null?"0x"+_.substring(a,2+2*$):"0x"+_.substring(a)}function hexConcat(_){let a="0x";return _.forEach($=>{a+=hexlify($).substring(2)}),a}function hexValue(_){const a=hexStripZeros(hexlify(_,{hexPad:"left"}));return a==="0x"?"0x0":a}function hexStripZeros(_){typeof _!="string"&&(_=hexlify(_)),isHexString(_)||logger$r.throwArgumentError("invalid hex string","value",_),_=_.substring(2);let a=0;for(;a<_.length&&_[a]==="0";)a++;return"0x"+_.substring(a)}function hexZeroPad(_,a){for(typeof _!="string"?_=hexlify(_):isHexString(_)||logger$r.throwArgumentError("invalid hex string","value",_),_.length>2*a+2&&logger$r.throwArgumentError("value out of range","value",arguments[1]);_.length<2*a+2;)_="0x0"+_.substring(2);return _}function splitSignature(_){const a={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(isBytesLike(_)){let $=arrayify(_);$.length===64?(a.v=27+($[32]>>7),$[32]&=127,a.r=hexlify($.slice(0,32)),a.s=hexlify($.slice(32,64))):$.length===65?(a.r=hexlify($.slice(0,32)),a.s=hexlify($.slice(32,64)),a.v=$[64]):logger$r.throwArgumentError("invalid signature string","signature",_),a.v<27&&(a.v===0||a.v===1?a.v+=27:logger$r.throwArgumentError("signature invalid v byte","signature",_)),a.recoveryParam=1-a.v%2,a.recoveryParam&&($[32]|=128),a._vs=hexlify($.slice(32,64))}else{if(a.r=_.r,a.s=_.s,a.v=_.v,a.recoveryParam=_.recoveryParam,a._vs=_._vs,a._vs!=null){const _e=zeroPad(arrayify(a._vs),32);a._vs=hexlify(_e);const et=_e[0]>=128?1:0;a.recoveryParam==null?a.recoveryParam=et:a.recoveryParam!==et&&logger$r.throwArgumentError("signature recoveryParam mismatch _vs","signature",_),_e[0]&=127;const tt=hexlify(_e);a.s==null?a.s=tt:a.s!==tt&&logger$r.throwArgumentError("signature v mismatch _vs","signature",_)}if(a.recoveryParam==null)a.v==null?logger$r.throwArgumentError("signature missing v and recoveryParam","signature",_):a.v===0||a.v===1?a.recoveryParam=a.v:a.recoveryParam=1-a.v%2;else if(a.v==null)a.v=27+a.recoveryParam;else{const _e=a.v===0||a.v===1?a.v:1-a.v%2;a.recoveryParam!==_e&&logger$r.throwArgumentError("signature recoveryParam mismatch v","signature",_)}a.r==null||!isHexString(a.r)?logger$r.throwArgumentError("signature missing or invalid r","signature",_):a.r=hexZeroPad(a.r,32),a.s==null||!isHexString(a.s)?logger$r.throwArgumentError("signature missing or invalid s","signature",_):a.s=hexZeroPad(a.s,32);const $=arrayify(a.s);$[0]>=128&&logger$r.throwArgumentError("signature s out of range","signature",_),a.recoveryParam&&($[0]|=128);const j=hexlify($);a._vs&&(isHexString(a._vs)||logger$r.throwArgumentError("signature invalid _vs","signature",_),a._vs=hexZeroPad(a._vs,32)),a._vs==null?a._vs=j:a._vs!==j&&logger$r.throwArgumentError("signature _vs mismatch v and s","signature",_)}return a.yParityAndS=a._vs,a.compact=a.r+a.yParityAndS.substring(2),a}const version$i="bignumber/5.7.0";var BN=BN$1.BN;const logger$q=new Logger(version$i),_constructorGuard$3={},MAX_SAFE=9007199254740991;function isBigNumberish(_){return _!=null&&(BigNumber.isBigNumber(_)||typeof _=="number"&&_%1===0||typeof _=="string"&&!!_.match(/^-?[0-9]+$/)||isHexString(_)||typeof _=="bigint"||isBytes$1(_))}let _warnedToStringRadix=!1;class BigNumber{constructor(a,$){a!==_constructorGuard$3&&logger$q.throwError("cannot call constructor directly; use BigNumber.from",Logger.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=$,this._isBigNumber=!0,Object.freeze(this)}fromTwos(a){return toBigNumber(toBN(this).fromTwos(a))}toTwos(a){return toBigNumber(toBN(this).toTwos(a))}abs(){return this._hex[0]==="-"?BigNumber.from(this._hex.substring(1)):this}add(a){return toBigNumber(toBN(this).add(toBN(a)))}sub(a){return toBigNumber(toBN(this).sub(toBN(a)))}div(a){return BigNumber.from(a).isZero()&&throwFault$1("division-by-zero","div"),toBigNumber(toBN(this).div(toBN(a)))}mul(a){return toBigNumber(toBN(this).mul(toBN(a)))}mod(a){const $=toBN(a);return $.isNeg()&&throwFault$1("division-by-zero","mod"),toBigNumber(toBN(this).umod($))}pow(a){const $=toBN(a);return $.isNeg()&&throwFault$1("negative-power","pow"),toBigNumber(toBN(this).pow($))}and(a){const $=toBN(a);return(this.isNegative()||$.isNeg())&&throwFault$1("unbound-bitwise-result","and"),toBigNumber(toBN(this).and($))}or(a){const $=toBN(a);return(this.isNegative()||$.isNeg())&&throwFault$1("unbound-bitwise-result","or"),toBigNumber(toBN(this).or($))}xor(a){const $=toBN(a);return(this.isNegative()||$.isNeg())&&throwFault$1("unbound-bitwise-result","xor"),toBigNumber(toBN(this).xor($))}mask(a){return(this.isNegative()||a<0)&&throwFault$1("negative-width","mask"),toBigNumber(toBN(this).maskn(a))}shl(a){return(this.isNegative()||a<0)&&throwFault$1("negative-width","shl"),toBigNumber(toBN(this).shln(a))}shr(a){return(this.isNegative()||a<0)&&throwFault$1("negative-width","shr"),toBigNumber(toBN(this).shrn(a))}eq(a){return toBN(this).eq(toBN(a))}lt(a){return toBN(this).lt(toBN(a))}lte(a){return toBN(this).lte(toBN(a))}gt(a){return toBN(this).gt(toBN(a))}gte(a){return toBN(this).gte(toBN(a))}isNegative(){return this._hex[0]==="-"}isZero(){return toBN(this).isZero()}toNumber(){try{return toBN(this).toNumber()}catch{throwFault$1("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch{}return logger$q.throwError("this platform does not support BigInt",Logger.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(arguments[0]===10?_warnedToStringRadix||(_warnedToStringRadix=!0,logger$q.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):arguments[0]===16?logger$q.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",Logger.errors.UNEXPECTED_ARGUMENT,{}):logger$q.throwError("BigNumber.toString does not accept parameters",Logger.errors.UNEXPECTED_ARGUMENT,{})),toBN(this).toString(10)}toHexString(){return this._hex}toJSON(a){return{type:"BigNumber",hex:this.toHexString()}}static from(a){if(a instanceof BigNumber)return a;if(typeof a=="string")return a.match(/^-?0x[0-9a-f]+$/i)?new BigNumber(_constructorGuard$3,toHex$1(a)):a.match(/^-?[0-9]+$/)?new BigNumber(_constructorGuard$3,toHex$1(new BN(a))):logger$q.throwArgumentError("invalid BigNumber string","value",a);if(typeof a=="number")return a%1&&throwFault$1("underflow","BigNumber.from",a),(a>=MAX_SAFE||a<=-MAX_SAFE)&&throwFault$1("overflow","BigNumber.from",a),BigNumber.from(String(a));const $=a;if(typeof $=="bigint")return BigNumber.from($.toString());if(isBytes$1($))return BigNumber.from(hexlify($));if($)if($.toHexString){const j=$.toHexString();if(typeof j=="string")return BigNumber.from(j)}else{let j=$._hex;if(j==null&&$.type==="BigNumber"&&(j=$.hex),typeof j=="string"&&(isHexString(j)||j[0]==="-"&&isHexString(j.substring(1))))return BigNumber.from(j)}return logger$q.throwArgumentError("invalid BigNumber value","value",a)}static isBigNumber(a){return!!(a&&a._isBigNumber)}}function toHex$1(_){if(typeof _!="string")return toHex$1(_.toString(16));if(_[0]==="-")return _=_.substring(1),_[0]==="-"&&logger$q.throwArgumentError("invalid hex","value",_),_=toHex$1(_),_==="0x00"?_:"-"+_;if(_.substring(0,2)!=="0x"&&(_="0x"+_),_==="0x")return"0x00";for(_.length%2&&(_="0x0"+_.substring(2));_.length>4&&_.substring(0,4)==="0x00";)_="0x"+_.substring(4);return _}function toBigNumber(_){return BigNumber.from(toHex$1(_))}function toBN(_){const a=BigNumber.from(_).toHexString();return a[0]==="-"?new BN("-"+a.substring(3),16):new BN(a.substring(2),16)}function throwFault$1(_,a,$){const j={fault:_,operation:a};return $!=null&&(j.value=$),logger$q.throwError(_,Logger.errors.NUMERIC_FAULT,j)}function _base36To16(_){return new BN(_,36).toString(16)}const logger$p=new Logger(version$i),_constructorGuard$2={},Zero$2=BigNumber.from(0),NegativeOne$2=BigNumber.from(-1);function throwFault(_,a,$,j){const _e={fault:a,operation:$};return j!==void 0&&(_e.value=j),logger$p.throwError(_,Logger.errors.NUMERIC_FAULT,_e)}let zeros="0";for(;zeros.length<256;)zeros+=zeros;function getMultiplier(_){if(typeof _!="number")try{_=BigNumber.from(_).toNumber()}catch{}return typeof _=="number"&&_>=0&&_<=256&&!(_%1)?"1"+zeros.substring(0,_):logger$p.throwArgumentError("invalid decimal size","decimals",_)}function formatFixed(_,a){a==null&&(a=0);const $=getMultiplier(a);_=BigNumber.from(_);const j=_.lt(Zero$2);j&&(_=_.mul(NegativeOne$2));let _e=_.mod($).toString();for(;_e.length<$.length-1;)_e="0"+_e;_e=_e.match(/^([0-9]*[1-9]|0)(0*)/)[1];const et=_.div($).toString();return $.length===1?_=et:_=et+"."+_e,j&&(_="-"+_),_}function parseFixed(_,a){a==null&&(a=0);const $=getMultiplier(a);(typeof _!="string"||!_.match(/^-?[0-9.]+$/))&&logger$p.throwArgumentError("invalid decimal value","value",_);const j=_.substring(0,1)==="-";j&&(_=_.substring(1)),_==="."&&logger$p.throwArgumentError("missing value","value",_);const _e=_.split(".");_e.length>2&&logger$p.throwArgumentError("too many decimal points","value",_);let et=_e[0],tt=_e[1];for(et||(et="0"),tt||(tt="0");tt[tt.length-1]==="0";)tt=tt.substring(0,tt.length-1);for(tt.length>$.length-1&&throwFault("fractional component exceeds decimals","underflow","parseFixed"),tt===""&&(tt="0");tt.length<$.length-1;)tt+="0";const rt=BigNumber.from(et),nt=BigNumber.from(tt);let it=rt.mul($).add(nt);return j&&(it=it.mul(NegativeOne$2)),it}class FixedFormat{constructor(a,$,j,_e){a!==_constructorGuard$2&&logger$p.throwError("cannot use FixedFormat constructor; use FixedFormat.from",Logger.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.signed=$,this.width=j,this.decimals=_e,this.name=($?"":"u")+"fixed"+String(j)+"x"+String(_e),this._multiplier=getMultiplier(_e),Object.freeze(this)}static from(a){if(a instanceof FixedFormat)return a;typeof a=="number"&&(a=`fixed128x${a}`);let $=!0,j=128,_e=18;if(typeof a=="string"){if(a!=="fixed")if(a==="ufixed")$=!1;else{const et=a.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);et||logger$p.throwArgumentError("invalid fixed format","format",a),$=et[1]!=="u",j=parseInt(et[2]),_e=parseInt(et[3])}}else if(a){const et=(tt,rt,nt)=>a[tt]==null?nt:(typeof a[tt]!==rt&&logger$p.throwArgumentError("invalid fixed format ("+tt+" not "+rt+")","format."+tt,a[tt]),a[tt]);$=et("signed","boolean",$),j=et("width","number",j),_e=et("decimals","number",_e)}return j%8&&logger$p.throwArgumentError("invalid fixed format width (not byte aligned)","format.width",j),_e>80&&logger$p.throwArgumentError("invalid fixed format (decimals too large)","format.decimals",_e),new FixedFormat(_constructorGuard$2,$,j,_e)}}class FixedNumber{constructor(a,$,j,_e){a!==_constructorGuard$2&&logger$p.throwError("cannot use FixedNumber constructor; use FixedNumber.from",Logger.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.format=_e,this._hex=$,this._value=j,this._isFixedNumber=!0,Object.freeze(this)}_checkFormat(a){this.format.name!==a.format.name&&logger$p.throwArgumentError("incompatible format; use fixedNumber.toFormat","other",a)}addUnsafe(a){this._checkFormat(a);const $=parseFixed(this._value,this.format.decimals),j=parseFixed(a._value,a.format.decimals);return FixedNumber.fromValue($.add(j),this.format.decimals,this.format)}subUnsafe(a){this._checkFormat(a);const $=parseFixed(this._value,this.format.decimals),j=parseFixed(a._value,a.format.decimals);return FixedNumber.fromValue($.sub(j),this.format.decimals,this.format)}mulUnsafe(a){this._checkFormat(a);const $=parseFixed(this._value,this.format.decimals),j=parseFixed(a._value,a.format.decimals);return FixedNumber.fromValue($.mul(j).div(this.format._multiplier),this.format.decimals,this.format)}divUnsafe(a){this._checkFormat(a);const $=parseFixed(this._value,this.format.decimals),j=parseFixed(a._value,a.format.decimals);return FixedNumber.fromValue($.mul(this.format._multiplier).div(j),this.format.decimals,this.format)}floor(){const a=this.toString().split(".");a.length===1&&a.push("0");let $=FixedNumber.from(a[0],this.format);const j=!a[1].match(/^(0*)$/);return this.isNegative()&&j&&($=$.subUnsafe(ONE.toFormat($.format))),$}ceiling(){const a=this.toString().split(".");a.length===1&&a.push("0");let $=FixedNumber.from(a[0],this.format);const j=!a[1].match(/^(0*)$/);return!this.isNegative()&&j&&($=$.addUnsafe(ONE.toFormat($.format))),$}round(a){a==null&&(a=0);const $=this.toString().split(".");if($.length===1&&$.push("0"),(a<0||a>80||a%1)&&logger$p.throwArgumentError("invalid decimal count","decimals",a),$[1].length<=a)return this;const j=FixedNumber.from("1"+zeros.substring(0,a),this.format),_e=BUMP.toFormat(this.format);return this.mulUnsafe(j).addUnsafe(_e).floor().divUnsafe(j)}isZero(){return this._value==="0.0"||this._value==="0"}isNegative(){return this._value[0]==="-"}toString(){return this._value}toHexString(a){if(a==null)return this._hex;a%8&&logger$p.throwArgumentError("invalid byte width","width",a);const $=BigNumber.from(this._hex).fromTwos(this.format.width).toTwos(a).toHexString();return hexZeroPad($,a/8)}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(a){return FixedNumber.fromString(this._value,a)}static fromValue(a,$,j){return j==null&&$!=null&&!isBigNumberish($)&&(j=$,$=null),$==null&&($=0),j==null&&(j="fixed"),FixedNumber.fromString(formatFixed(a,$),FixedFormat.from(j))}static fromString(a,$){$==null&&($="fixed");const j=FixedFormat.from($),_e=parseFixed(a,j.decimals);!j.signed&&_e.lt(Zero$2)&&throwFault("unsigned value cannot be negative","overflow","value",a);let et=null;j.signed?et=_e.toTwos(j.width).toHexString():(et=_e.toHexString(),et=hexZeroPad(et,j.width/8));const tt=formatFixed(_e,j.decimals);return new FixedNumber(_constructorGuard$2,et,tt,j)}static fromBytes(a,$){$==null&&($="fixed");const j=FixedFormat.from($);if(arrayify(a).length>j.width/8)throw new Error("overflow");let _e=BigNumber.from(a);j.signed&&(_e=_e.fromTwos(j.width));const et=_e.toTwos((j.signed?0:1)+j.width).toHexString(),tt=formatFixed(_e,j.decimals);return new FixedNumber(_constructorGuard$2,et,tt,j)}static from(a,$){if(typeof a=="string")return FixedNumber.fromString(a,$);if(isBytes$1(a))return FixedNumber.fromBytes(a,$);try{return FixedNumber.fromValue(a,0,$)}catch(j){if(j.code!==Logger.errors.INVALID_ARGUMENT)throw j}return logger$p.throwArgumentError("invalid FixedNumber value","value",a)}static isFixedNumber(a){return!!(a&&a._isFixedNumber)}}const ONE=FixedNumber.from(1),BUMP=FixedNumber.from("0.5"),version$h="properties/5.7.0";var __awaiter$8=globalThis&&globalThis.__awaiter||function(_,a,$,j){function _e(et){return et instanceof $?et:new $(function(tt){tt(et)})}return new($||($=Promise))(function(et,tt){function rt(st){try{it(j.next(st))}catch(ot){tt(ot)}}function nt(st){try{it(j.throw(st))}catch(ot){tt(ot)}}function it(st){st.done?et(st.value):_e(st.value).then(rt,nt)}it((j=j.apply(_,a||[])).next())})};const logger$o=new Logger(version$h);function defineReadOnly(_,a,$){Object.defineProperty(_,a,{enumerable:!0,value:$,writable:!1})}function getStatic(_,a){for(let $=0;$<32;$++){if(_[a])return _[a];if(!_.prototype||typeof _.prototype!="object")break;_=Object.getPrototypeOf(_.prototype).constructor}return null}function resolveProperties(_){return __awaiter$8(this,void 0,void 0,function*(){const a=Object.keys(_).map(j=>{const _e=_[j];return Promise.resolve(_e).then(et=>({key:j,value:et}))});return(yield Promise.all(a)).reduce((j,_e)=>(j[_e.key]=_e.value,j),{})})}function checkProperties(_,a){(!_||typeof _!="object")&&logger$o.throwArgumentError("invalid object","object",_),Object.keys(_).forEach($=>{a[$]||logger$o.throwArgumentError("invalid object key - "+$,"transaction:"+$,_)})}function shallowCopy(_){const a={};for(const $ in _)a[$]=_[$];return a}const opaque={bigint:!0,boolean:!0,function:!0,number:!0,string:!0};function _isFrozen(_){if(_==null||opaque[typeof _])return!0;if(Array.isArray(_)||typeof _=="object"){if(!Object.isFrozen(_))return!1;const a=Object.keys(_);for(let $=0;$<a.length;$++){let j=null;try{j=_[a[$]]}catch{continue}if(!_isFrozen(j))return!1}return!0}return logger$o.throwArgumentError(`Cannot deepCopy ${typeof _}`,"object",_)}function _deepCopy(_){if(_isFrozen(_))return _;if(Array.isArray(_))return Object.freeze(_.map(a=>deepCopy(a)));if(typeof _=="object"){const a={};for(const $ in _){const j=_[$];j!==void 0&&defineReadOnly(a,$,deepCopy(j))}return a}return logger$o.throwArgumentError(`Cannot deepCopy ${typeof _}`,"object",_)}function deepCopy(_){return _deepCopy(_)}class Description{constructor(a){for(const $ in a)this[$]=deepCopy(a[$])}}const version$g="abi/5.7.0",logger$n=new Logger(version$g),_constructorGuard$1={};let ModifiersBytes={calldata:!0,memory:!0,storage:!0},ModifiersNest={calldata:!0,memory:!0};function checkModifier(_,a){if(_==="bytes"||_==="string"){if(ModifiersBytes[a])return!0}else if(_==="address"){if(a==="payable")return!0}else if((_.indexOf("[")>=0||_==="tuple")&&ModifiersNest[a])return!0;return(ModifiersBytes[a]||a==="payable")&&logger$n.throwArgumentError("invalid modifier","name",a),!1}function parseParamType(_,a){let $=_;function j(rt){logger$n.throwArgumentError(`unexpected character at position ${rt}`,"param",_)}_=_.replace(/\s/g," ");function _e(rt){let nt={type:"",name:"",parent:rt,state:{allowType:!0}};return a&&(nt.indexed=!1),nt}let et={type:"",name:"",state:{allowType:!0}},tt=et;for(let rt=0;rt<_.length;rt++){let nt=_[rt];switch(nt){case"(":tt.state.allowType&&tt.type===""?tt.type="tuple":tt.state.allowParams||j(rt),tt.state.allowType=!1,tt.type=verifyType(tt.type),tt.components=[_e(tt)],tt=tt.components[0];break;case")":delete tt.state,tt.name==="indexed"&&(a||j(rt),tt.indexed=!0,tt.name=""),checkModifier(tt.type,tt.name)&&(tt.name=""),tt.type=verifyType(tt.type);let it=tt;tt=tt.parent,tt||j(rt),delete it.parent,tt.state.allowParams=!1,tt.state.allowName=!0,tt.state.allowArray=!0;break;case",":delete tt.state,tt.name==="indexed"&&(a||j(rt),tt.indexed=!0,tt.name=""),checkModifier(tt.type,tt.name)&&(tt.name=""),tt.type=verifyType(tt.type);let st=_e(tt.parent);tt.parent.components.push(st),delete tt.parent,tt=st;break;case" ":tt.state.allowType&&tt.type!==""&&(tt.type=verifyType(tt.type),delete tt.state.allowType,tt.state.allowName=!0,tt.state.allowParams=!0),tt.state.allowName&&tt.name!==""&&(tt.name==="indexed"?(a||j(rt),tt.indexed&&j(rt),tt.indexed=!0,tt.name=""):checkModifier(tt.type,tt.name)?tt.name="":tt.state.allowName=!1);break;case"[":tt.state.allowArray||j(rt),tt.type+=nt,tt.state.allowArray=!1,tt.state.allowName=!1,tt.state.readArray=!0;break;case"]":tt.state.readArray||j(rt),tt.type+=nt,tt.state.readArray=!1,tt.state.allowArray=!0,tt.state.allowName=!0;break;default:tt.state.allowType?(tt.type+=nt,tt.state.allowParams=!0,tt.state.allowArray=!0):tt.state.allowName?(tt.name+=nt,delete tt.state.allowArray):tt.state.readArray?tt.type+=nt:j(rt)}}return tt.parent&&logger$n.throwArgumentError("unexpected eof","param",_),delete et.state,tt.name==="indexed"?(a||j($.length-7),tt.indexed&&j($.length-7),tt.indexed=!0,tt.name=""):checkModifier(tt.type,tt.name)&&(tt.name=""),et.type=verifyType(et.type),et}function populate(_,a){for(let $ in a)defineReadOnly(_,$,a[$])}const FormatTypes=Object.freeze({sighash:"sighash",minimal:"minimal",full:"full",json:"json"}),paramTypeArray=new RegExp(/^(.*)\[([0-9]*)\]$/);class ParamType{constructor(a,$){a!==_constructorGuard$1&&logger$n.throwError("use fromString",Logger.errors.UNSUPPORTED_OPERATION,{operation:"new ParamType()"}),populate(this,$);let j=this.type.match(paramTypeArray);j?populate(this,{arrayLength:parseInt(j[2]||"-1"),arrayChildren:ParamType.fromObject({type:j[1],components:this.components}),baseType:"array"}):populate(this,{arrayLength:null,arrayChildren:null,baseType:this.components!=null?"tuple":this.type}),this._isParamType=!0,Object.freeze(this)}format(a){if(a||(a=FormatTypes.sighash),FormatTypes[a]||logger$n.throwArgumentError("invalid format type","format",a),a===FormatTypes.json){let j={type:this.baseType==="tuple"?"tuple":this.type,name:this.name||void 0};return typeof this.indexed=="boolean"&&(j.indexed=this.indexed),this.components&&(j.components=this.components.map(_e=>JSON.parse(_e.format(a)))),JSON.stringify(j)}let $="";return this.baseType==="array"?($+=this.arrayChildren.format(a),$+="["+(this.arrayLength<0?"":String(this.arrayLength))+"]"):this.baseType==="tuple"?(a!==FormatTypes.sighash&&($+=this.type),$+="("+this.components.map(j=>j.format(a)).join(a===FormatTypes.full?", ":",")+")"):$+=this.type,a!==FormatTypes.sighash&&(this.indexed===!0&&($+=" indexed"),a===FormatTypes.full&&this.name&&($+=" "+this.name)),$}static from(a,$){return typeof a=="string"?ParamType.fromString(a,$):ParamType.fromObject(a)}static fromObject(a){return ParamType.isParamType(a)?a:new ParamType(_constructorGuard$1,{name:a.name||null,type:verifyType(a.type),indexed:a.indexed==null?null:!!a.indexed,components:a.components?a.components.map(ParamType.fromObject):null})}static fromString(a,$){function j(_e){return ParamType.fromObject({name:_e.name,type:_e.type,indexed:_e.indexed,components:_e.components})}return j(parseParamType(a,!!$))}static isParamType(a){return!!(a!=null&&a._isParamType)}}function parseParams(_,a){return splitNesting(_).map($=>ParamType.fromString($,a))}class Fragment{constructor(a,$){a!==_constructorGuard$1&&logger$n.throwError("use a static from method",Logger.errors.UNSUPPORTED_OPERATION,{operation:"new Fragment()"}),populate(this,$),this._isFragment=!0,Object.freeze(this)}static from(a){return Fragment.isFragment(a)?a:typeof a=="string"?Fragment.fromString(a):Fragment.fromObject(a)}static fromObject(a){if(Fragment.isFragment(a))return a;switch(a.type){case"function":return FunctionFragment.fromObject(a);case"event":return EventFragment.fromObject(a);case"constructor":return ConstructorFragment.fromObject(a);case"error":return ErrorFragment.fromObject(a);case"fallback":case"receive":return null}return logger$n.throwArgumentError("invalid fragment object","value",a)}static fromString(a){return a=a.replace(/\s/g," "),a=a.replace(/\(/g," (").replace(/\)/g,") ").replace(/\s+/g," "),a=a.trim(),a.split(" ")[0]==="event"?EventFragment.fromString(a.substring(5).trim()):a.split(" ")[0]==="function"?FunctionFragment.fromString(a.substring(8).trim()):a.split("(")[0].trim()==="constructor"?ConstructorFragment.fromString(a.trim()):a.split(" ")[0]==="error"?ErrorFragment.fromString(a.substring(5).trim()):logger$n.throwArgumentError("unsupported fragment","value",a)}static isFragment(a){return!!(a&&a._isFragment)}}class EventFragment extends Fragment{format(a){if(a||(a=FormatTypes.sighash),FormatTypes[a]||logger$n.throwArgumentError("invalid format type","format",a),a===FormatTypes.json)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(j=>JSON.parse(j.format(a)))});let $="";return a!==FormatTypes.sighash&&($+="event "),$+=this.name+"("+this.inputs.map(j=>j.format(a)).join(a===FormatTypes.full?", ":",")+") ",a!==FormatTypes.sighash&&this.anonymous&&($+="anonymous "),$.trim()}static from(a){return typeof a=="string"?EventFragment.fromString(a):EventFragment.fromObject(a)}static fromObject(a){if(EventFragment.isEventFragment(a))return a;a.type!=="event"&&logger$n.throwArgumentError("invalid event object","value",a);const $={name:verifyIdentifier(a.name),anonymous:a.anonymous,inputs:a.inputs?a.inputs.map(ParamType.fromObject):[],type:"event"};return new EventFragment(_constructorGuard$1,$)}static fromString(a){let $=a.match(regexParen);$||logger$n.throwArgumentError("invalid event string","value",a);let j=!1;return $[3].split(" ").forEach(_e=>{switch(_e.trim()){case"anonymous":j=!0;break;case"":break;default:logger$n.warn("unknown modifier: "+_e)}}),EventFragment.fromObject({name:$[1].trim(),anonymous:j,inputs:parseParams($[2],!0),type:"event"})}static isEventFragment(a){return a&&a._isFragment&&a.type==="event"}}function parseGas(_,a){a.gas=null;let $=_.split("@");return $.length!==1?($.length>2&&logger$n.throwArgumentError("invalid human-readable ABI signature","value",_),$[1].match(/^[0-9]+$/)||logger$n.throwArgumentError("invalid human-readable ABI signature gas","value",_),a.gas=BigNumber.from($[1]),$[0]):_}function parseModifiers(_,a){a.constant=!1,a.payable=!1,a.stateMutability="nonpayable",_.split(" ").forEach($=>{switch($.trim()){case"constant":a.constant=!0;break;case"payable":a.payable=!0,a.stateMutability="payable";break;case"nonpayable":a.payable=!1,a.stateMutability="nonpayable";break;case"pure":a.constant=!0,a.stateMutability="pure";break;case"view":a.constant=!0,a.stateMutability="view";break;case"external":case"public":case"":break;default:console.log("unknown modifier: "+$)}})}function verifyState(_){let a={constant:!1,payable:!0,stateMutability:"payable"};return _.stateMutability!=null?(a.stateMutability=_.stateMutability,a.constant=a.stateMutability==="view"||a.stateMutability==="pure",_.constant!=null&&!!_.constant!==a.constant&&logger$n.throwArgumentError("cannot have constant function with mutability "+a.stateMutability,"value",_),a.payable=a.stateMutability==="payable",_.payable!=null&&!!_.payable!==a.payable&&logger$n.throwArgumentError("cannot have payable function with mutability "+a.stateMutability,"value",_)):_.payable!=null?(a.payable=!!_.payable,_.constant==null&&!a.payable&&_.type!=="constructor"&&logger$n.throwArgumentError("unable to determine stateMutability","value",_),a.constant=!!_.constant,a.constant?a.stateMutability="view":a.stateMutability=a.payable?"payable":"nonpayable",a.payable&&a.constant&&logger$n.throwArgumentError("cannot have constant payable function","value",_)):_.constant!=null?(a.constant=!!_.constant,a.payable=!a.constant,a.stateMutability=a.constant?"view":"payable"):_.type!=="constructor"&&logger$n.throwArgumentError("unable to determine stateMutability","value",_),a}class ConstructorFragment extends Fragment{format(a){if(a||(a=FormatTypes.sighash),FormatTypes[a]||logger$n.throwArgumentError("invalid format type","format",a),a===FormatTypes.json)return JSON.stringify({type:"constructor",stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map(j=>JSON.parse(j.format(a)))});a===FormatTypes.sighash&&logger$n.throwError("cannot format a constructor for sighash",Logger.errors.UNSUPPORTED_OPERATION,{operation:"format(sighash)"});let $="constructor("+this.inputs.map(j=>j.format(a)).join(a===FormatTypes.full?", ":",")+") ";return this.stateMutability&&this.stateMutability!=="nonpayable"&&($+=this.stateMutability+" "),$.trim()}static from(a){return typeof a=="string"?ConstructorFragment.fromString(a):ConstructorFragment.fromObject(a)}static fromObject(a){if(ConstructorFragment.isConstructorFragment(a))return a;a.type!=="constructor"&&logger$n.throwArgumentError("invalid constructor object","value",a);let $=verifyState(a);$.constant&&logger$n.throwArgumentError("constructor cannot be constant","value",a);const j={name:null,type:a.type,inputs:a.inputs?a.inputs.map(ParamType.fromObject):[],payable:$.payable,stateMutability:$.stateMutability,gas:a.gas?BigNumber.from(a.gas):null};return new ConstructorFragment(_constructorGuard$1,j)}static fromString(a){let $={type:"constructor"};a=parseGas(a,$);let j=a.match(regexParen);return(!j||j[1].trim()!=="constructor")&&logger$n.throwArgumentError("invalid constructor string","value",a),$.inputs=parseParams(j[2].trim(),!1),parseModifiers(j[3].trim(),$),ConstructorFragment.fromObject($)}static isConstructorFragment(a){return a&&a._isFragment&&a.type==="constructor"}}class FunctionFragment extends ConstructorFragment{format(a){if(a||(a=FormatTypes.sighash),FormatTypes[a]||logger$n.throwArgumentError("invalid format type","format",a),a===FormatTypes.json)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map(j=>JSON.parse(j.format(a))),outputs:this.outputs.map(j=>JSON.parse(j.format(a)))});let $="";return a!==FormatTypes.sighash&&($+="function "),$+=this.name+"("+this.inputs.map(j=>j.format(a)).join(a===FormatTypes.full?", ":",")+") ",a!==FormatTypes.sighash&&(this.stateMutability?this.stateMutability!=="nonpayable"&&($+=this.stateMutability+" "):this.constant&&($+="view "),this.outputs&&this.outputs.length&&($+="returns ("+this.outputs.map(j=>j.format(a)).join(", ")+") "),this.gas!=null&&($+="@"+this.gas.toString()+" ")),$.trim()}static from(a){return typeof a=="string"?FunctionFragment.fromString(a):FunctionFragment.fromObject(a)}static fromObject(a){if(FunctionFragment.isFunctionFragment(a))return a;a.type!=="function"&&logger$n.throwArgumentError("invalid function object","value",a);let $=verifyState(a);const j={type:a.type,name:verifyIdentifier(a.name),constant:$.constant,inputs:a.inputs?a.inputs.map(ParamType.fromObject):[],outputs:a.outputs?a.outputs.map(ParamType.fromObject):[],payable:$.payable,stateMutability:$.stateMutability,gas:a.gas?BigNumber.from(a.gas):null};return new FunctionFragment(_constructorGuard$1,j)}static fromString(a){let $={type:"function"};a=parseGas(a,$);let j=a.split(" returns ");j.length>2&&logger$n.throwArgumentError("invalid function string","value",a);let _e=j[0].match(regexParen);if(_e||logger$n.throwArgumentError("invalid function signature","value",a),$.name=_e[1].trim(),$.name&&verifyIdentifier($.name),$.inputs=parseParams(_e[2],!1),parseModifiers(_e[3].trim(),$),j.length>1){let et=j[1].match(regexParen);(et[1].trim()!=""||et[3].trim()!="")&&logger$n.throwArgumentError("unexpected tokens","value",a),$.outputs=parseParams(et[2],!1)}else $.outputs=[];return FunctionFragment.fromObject($)}static isFunctionFragment(a){return a&&a._isFragment&&a.type==="function"}}function checkForbidden(_){const a=_.format();return(a==="Error(string)"||a==="Panic(uint256)")&&logger$n.throwArgumentError(`cannot specify user defined ${a} error`,"fragment",_),_}class ErrorFragment extends Fragment{format(a){if(a||(a=FormatTypes.sighash),FormatTypes[a]||logger$n.throwArgumentError("invalid format type","format",a),a===FormatTypes.json)return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(j=>JSON.parse(j.format(a)))});let $="";return a!==FormatTypes.sighash&&($+="error "),$+=this.name+"("+this.inputs.map(j=>j.format(a)).join(a===FormatTypes.full?", ":",")+") ",$.trim()}static from(a){return typeof a=="string"?ErrorFragment.fromString(a):ErrorFragment.fromObject(a)}static fromObject(a){if(ErrorFragment.isErrorFragment(a))return a;a.type!=="error"&&logger$n.throwArgumentError("invalid error object","value",a);const $={type:a.type,name:verifyIdentifier(a.name),inputs:a.inputs?a.inputs.map(ParamType.fromObject):[]};return checkForbidden(new ErrorFragment(_constructorGuard$1,$))}static fromString(a){let $={type:"error"},j=a.match(regexParen);return j||logger$n.throwArgumentError("invalid error signature","value",a),$.name=j[1].trim(),$.name&&verifyIdentifier($.name),$.inputs=parseParams(j[2],!1),checkForbidden(ErrorFragment.fromObject($))}static isErrorFragment(a){return a&&a._isFragment&&a.type==="error"}}function verifyType(_){return _.match(/^uint($|[^1-9])/)?_="uint256"+_.substring(4):_.match(/^int($|[^1-9])/)&&(_="int256"+_.substring(3)),_}const regexIdentifier=new RegExp("^[a-zA-Z$_][a-zA-Z0-9$_]*$");function verifyIdentifier(_){return(!_||!_.match(regexIdentifier))&&logger$n.throwArgumentError(`invalid identifier "${_}"`,"value",_),_}const regexParen=new RegExp("^([^)(]*)\\((.*)\\)([^)(]*)$");function splitNesting(_){_=_.trim();let a=[],$="",j=0;for(let _e=0;_e<_.length;_e++){let et=_[_e];et===","&&j===0?(a.push($),$=""):($+=et,et==="("?j++:et===")"&&(j--,j===-1&&logger$n.throwArgumentError("unbalanced parenthesis","value",_)))}return $&&a.push($),a}const logger$m=new Logger(version$g);function checkResultErrors(_){const a=[],$=function(j,_e){if(!!Array.isArray(_e))for(let et in _e){const tt=j.slice();tt.push(et);try{$(tt,_e[et])}catch(rt){a.push({path:tt,error:rt})}}};return $([],_),a}class Coder{constructor(a,$,j,_e){this.name=a,this.type=$,this.localName=j,this.dynamic=_e}_throwError(a,$){logger$m.throwArgumentError(a,this.localName,$)}}class Writer$2{constructor(a){defineReadOnly(this,"wordSize",a||32),this._data=[],this._dataLength=0,this._padding=new Uint8Array(a)}get data(){return hexConcat(this._data)}get length(){return this._dataLength}_writeData(a){return this._data.push(a),this._dataLength+=a.length,a.length}appendWriter(a){return this._writeData(concat$3(a._data))}writeBytes(a){let $=arrayify(a);const j=$.length%this.wordSize;return j&&($=concat$3([$,this._padding.slice(j)])),this._writeData($)}_getValue(a){let $=arrayify(BigNumber.from(a));return $.length>this.wordSize&&logger$m.throwError("value out-of-bounds",Logger.errors.BUFFER_OVERRUN,{length:this.wordSize,offset:$.length}),$.length%this.wordSize&&($=concat$3([this._padding.slice($.length%this.wordSize),$])),$}writeValue(a){return this._writeData(this._getValue(a))}writeUpdatableValue(){const a=this._data.length;return this._data.push(this._padding),this._dataLength+=this.wordSize,$=>{this._data[a]=this._getValue($)}}}class Reader$2{constructor(a,$,j,_e){defineReadOnly(this,"_data",arrayify(a)),defineReadOnly(this,"wordSize",$||32),defineReadOnly(this,"_coerceFunc",j),defineReadOnly(this,"allowLoose",_e),this._offset=0}get data(){return hexlify(this._data)}get consumed(){return this._offset}static coerce(a,$){let j=a.match("^u?int([0-9]+)$");return j&&parseInt(j[1])<=48&&($=$.toNumber()),$}coerce(a,$){return this._coerceFunc?this._coerceFunc(a,$):Reader$2.coerce(a,$)}_peekBytes(a,$,j){let _e=Math.ceil($/this.wordSize)*this.wordSize;return this._offset+_e>this._data.length&&(this.allowLoose&&j&&this._offset+$<=this._data.length?_e=$:logger$m.throwError("data out-of-bounds",Logger.errors.BUFFER_OVERRUN,{length:this._data.length,offset:this._offset+_e})),this._data.slice(this._offset,this._offset+_e)}subReader(a){return new Reader$2(this._data.slice(this._offset+a),this.wordSize,this._coerceFunc,this.allowLoose)}readBytes(a,$){let j=this._peekBytes(0,a,!!$);return this._offset+=j.length,j.slice(0,a)}readValue(){return BigNumber.from(this.readBytes(this.wordSize))}}var sha3$1={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */(function(_){(function(){var a="input is invalid type",$="finalize already called",j=typeof window=="object",_e=j?window:{};_e.JS_SHA3_NO_WINDOW&&(j=!1);var et=!j&&typeof self=="object",tt=!_e.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;tt?_e={}:et&&(_e=self);var rt=!_e.JS_SHA3_NO_COMMON_JS&&!0&&_.exports,nt=!_e.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",it="0123456789abcdef".split(""),st=[31,7936,2031616,520093696],ot=[4,1024,262144,67108864],at=[1,256,65536,16777216],lt=[6,1536,393216,100663296],ct=[0,8,16,24],ut=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],dt=[224,256,384,512],ft=[128,256],pt=["hex","buffer","arrayBuffer","array","digest"],yt={128:168,256:136};(_e.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(Pt){return Object.prototype.toString.call(Pt)==="[object Array]"}),nt&&(_e.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(Pt){return typeof Pt=="object"&&Pt.buffer&&Pt.buffer.constructor===ArrayBuffer});for(var mt=function(Pt,Ft,jt){return function(Vt){return new bt(Pt,Ft,Pt).update(Vt)[jt]()}},_t=function(Pt,Ft,jt){return function(Vt,Wt){return new bt(Pt,Ft,Wt).update(Vt)[jt]()}},vt=function(Pt,Ft,jt){return function(Vt,Wt,Qt,qt){return gt["cshake"+Pt].update(Vt,Wt,Qt,qt)[jt]()}},ht=function(Pt,Ft,jt){return function(Vt,Wt,Qt,qt){return gt["kmac"+Pt].update(Vt,Wt,Qt,qt)[jt]()}},St=function(Pt,Ft,jt,Vt){for(var Wt=0;Wt<pt.length;++Wt){var Qt=pt[Wt];Pt[Qt]=Ft(jt,Vt,Qt)}return Pt},It=function(Pt,Ft){var jt=mt(Pt,Ft,"hex");return jt.create=function(){return new bt(Pt,Ft,Pt)},jt.update=function(Vt){return jt.create().update(Vt)},St(jt,mt,Pt,Ft)},Lt=function(Pt,Ft){var jt=_t(Pt,Ft,"hex");return jt.create=function(Vt){return new bt(Pt,Ft,Vt)},jt.update=function(Vt,Wt){return jt.create(Wt).update(Vt)},St(jt,_t,Pt,Ft)},Mt=function(Pt,Ft){var jt=yt[Pt],Vt=vt(Pt,Ft,"hex");return Vt.create=function(Wt,Qt,qt){return!Qt&&!qt?gt["shake"+Pt].create(Wt):new bt(Pt,Ft,Wt).bytepad([Qt,qt],jt)},Vt.update=function(Wt,Qt,qt,Yt){return Vt.create(Qt,qt,Yt).update(Wt)},St(Vt,vt,Pt,Ft)},Kt=function(Pt,Ft){var jt=yt[Pt],Vt=ht(Pt,Ft,"hex");return Vt.create=function(Wt,Qt,qt){return new Rt(Pt,Ft,Qt).bytepad(["KMAC",qt],jt).bytepad([Wt],jt)},Vt.update=function(Wt,Qt,qt,Yt){return Vt.create(Wt,qt,Yt).update(Qt)},St(Vt,ht,Pt,Ft)},kt=[{name:"keccak",padding:at,bits:dt,createMethod:It},{name:"sha3",padding:lt,bits:dt,createMethod:It},{name:"shake",padding:st,bits:ft,createMethod:Lt},{name:"cshake",padding:ot,bits:ft,createMethod:Mt},{name:"kmac",padding:ot,bits:ft,createMethod:Kt}],gt={},Et=[],xt=0;xt<kt.length;++xt)for(var Tt=kt[xt],At=Tt.bits,Nt=0;Nt<At.length;++Nt){var Bt=Tt.name+"_"+At[Nt];if(Et.push(Bt),gt[Bt]=Tt.createMethod(At[Nt],Tt.padding),Tt.name!=="sha3"){var Ot=Tt.name+At[Nt];Et.push(Ot),gt[Ot]=gt[Bt]}}function bt(Pt,Ft,jt){this.blocks=[],this.s=[],this.padding=Ft,this.outputBits=jt,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(Pt<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=jt>>5,this.extraBytes=(jt&31)>>3;for(var Vt=0;Vt<50;++Vt)this.s[Vt]=0}bt.prototype.update=function(Pt){if(this.finalized)throw new Error($);var Ft,jt=typeof Pt;if(jt!=="string"){if(jt==="object"){if(Pt===null)throw new Error(a);if(nt&&Pt.constructor===ArrayBuffer)Pt=new Uint8Array(Pt);else if(!Array.isArray(Pt)&&(!nt||!ArrayBuffer.isView(Pt)))throw new Error(a)}else throw new Error(a);Ft=!0}for(var Vt=this.blocks,Wt=this.byteCount,Qt=Pt.length,qt=this.blockCount,Yt=0,Xt=this.s,Zt,tr;Yt<Qt;){if(this.reset)for(this.reset=!1,Vt[0]=this.block,Zt=1;Zt<qt+1;++Zt)Vt[Zt]=0;if(Ft)for(Zt=this.start;Yt<Qt&&Zt<Wt;++Yt)Vt[Zt>>2]|=Pt[Yt]<<ct[Zt++&3];else for(Zt=this.start;Yt<Qt&&Zt<Wt;++Yt)tr=Pt.charCodeAt(Yt),tr<128?Vt[Zt>>2]|=tr<<ct[Zt++&3]:tr<2048?(Vt[Zt>>2]|=(192|tr>>6)<<ct[Zt++&3],Vt[Zt>>2]|=(128|tr&63)<<ct[Zt++&3]):tr<55296||tr>=57344?(Vt[Zt>>2]|=(224|tr>>12)<<ct[Zt++&3],Vt[Zt>>2]|=(128|tr>>6&63)<<ct[Zt++&3],Vt[Zt>>2]|=(128|tr&63)<<ct[Zt++&3]):(tr=65536+((tr&1023)<<10|Pt.charCodeAt(++Yt)&1023),Vt[Zt>>2]|=(240|tr>>18)<<ct[Zt++&3],Vt[Zt>>2]|=(128|tr>>12&63)<<ct[Zt++&3],Vt[Zt>>2]|=(128|tr>>6&63)<<ct[Zt++&3],Vt[Zt>>2]|=(128|tr&63)<<ct[Zt++&3]);if(this.lastByteIndex=Zt,Zt>=Wt){for(this.start=Zt-Wt,this.block=Vt[qt],Zt=0;Zt<qt;++Zt)Xt[Zt]^=Vt[Zt];Gt(Xt),this.reset=!0}else this.start=Zt}return this},bt.prototype.encode=function(Pt,Ft){var jt=Pt&255,Vt=1,Wt=[jt];for(Pt=Pt>>8,jt=Pt&255;jt>0;)Wt.unshift(jt),Pt=Pt>>8,jt=Pt&255,++Vt;return Ft?Wt.push(Vt):Wt.unshift(Vt),this.update(Wt),Wt.length},bt.prototype.encodeString=function(Pt){var Ft,jt=typeof Pt;if(jt!=="string"){if(jt==="object"){if(Pt===null)throw new Error(a);if(nt&&Pt.constructor===ArrayBuffer)Pt=new Uint8Array(Pt);else if(!Array.isArray(Pt)&&(!nt||!ArrayBuffer.isView(Pt)))throw new Error(a)}else throw new Error(a);Ft=!0}var Vt=0,Wt=Pt.length;if(Ft)Vt=Wt;else for(var Qt=0;Qt<Pt.length;++Qt){var qt=Pt.charCodeAt(Qt);qt<128?Vt+=1:qt<2048?Vt+=2:qt<55296||qt>=57344?Vt+=3:(qt=65536+((qt&1023)<<10|Pt.charCodeAt(++Qt)&1023),Vt+=4)}return Vt+=this.encode(Vt*8),this.update(Pt),Vt},bt.prototype.bytepad=function(Pt,Ft){for(var jt=this.encode(Ft),Vt=0;Vt<Pt.length;++Vt)jt+=this.encodeString(Pt[Vt]);var Wt=Ft-jt%Ft,Qt=[];return Qt.length=Wt,this.update(Qt),this},bt.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var Pt=this.blocks,Ft=this.lastByteIndex,jt=this.blockCount,Vt=this.s;if(Pt[Ft>>2]|=this.padding[Ft&3],this.lastByteIndex===this.byteCount)for(Pt[0]=Pt[jt],Ft=1;Ft<jt+1;++Ft)Pt[Ft]=0;for(Pt[jt-1]|=2147483648,Ft=0;Ft<jt;++Ft)Vt[Ft]^=Pt[Ft];Gt(Vt)}},bt.prototype.toString=bt.prototype.hex=function(){this.finalize();for(var Pt=this.blockCount,Ft=this.s,jt=this.outputBlocks,Vt=this.extraBytes,Wt=0,Qt=0,qt="",Yt;Qt<jt;){for(Wt=0;Wt<Pt&&Qt<jt;++Wt,++Qt)Yt=Ft[Wt],qt+=it[Yt>>4&15]+it[Yt&15]+it[Yt>>12&15]+it[Yt>>8&15]+it[Yt>>20&15]+it[Yt>>16&15]+it[Yt>>28&15]+it[Yt>>24&15];Qt%Pt===0&&(Gt(Ft),Wt=0)}return Vt&&(Yt=Ft[Wt],qt+=it[Yt>>4&15]+it[Yt&15],Vt>1&&(qt+=it[Yt>>12&15]+it[Yt>>8&15]),Vt>2&&(qt+=it[Yt>>20&15]+it[Yt>>16&15])),qt},bt.prototype.arrayBuffer=function(){this.finalize();var Pt=this.blockCount,Ft=this.s,jt=this.outputBlocks,Vt=this.extraBytes,Wt=0,Qt=0,qt=this.outputBits>>3,Yt;Vt?Yt=new ArrayBuffer(jt+1<<2):Yt=new ArrayBuffer(qt);for(var Xt=new Uint32Array(Yt);Qt<jt;){for(Wt=0;Wt<Pt&&Qt<jt;++Wt,++Qt)Xt[Qt]=Ft[Wt];Qt%Pt===0&&Gt(Ft)}return Vt&&(Xt[Wt]=Ft[Wt],Yt=Yt.slice(0,qt)),Yt},bt.prototype.buffer=bt.prototype.arrayBuffer,bt.prototype.digest=bt.prototype.array=function(){this.finalize();for(var Pt=this.blockCount,Ft=this.s,jt=this.outputBlocks,Vt=this.extraBytes,Wt=0,Qt=0,qt=[],Yt,Xt;Qt<jt;){for(Wt=0;Wt<Pt&&Qt<jt;++Wt,++Qt)Yt=Qt<<2,Xt=Ft[Wt],qt[Yt]=Xt&255,qt[Yt+1]=Xt>>8&255,qt[Yt+2]=Xt>>16&255,qt[Yt+3]=Xt>>24&255;Qt%Pt===0&&Gt(Ft)}return Vt&&(Yt=Qt<<2,Xt=Ft[Wt],qt[Yt]=Xt&255,Vt>1&&(qt[Yt+1]=Xt>>8&255),Vt>2&&(qt[Yt+2]=Xt>>16&255)),qt};function Rt(Pt,Ft,jt){bt.call(this,Pt,Ft,jt)}Rt.prototype=new bt,Rt.prototype.finalize=function(){return this.encode(this.outputBits,!0),bt.prototype.finalize.call(this)};var Gt=function(Pt){var Ft,jt,Vt,Wt,Qt,qt,Yt,Xt,Zt,tr,Dr,fr,hr,Or,lr,ir,dr,ar,cr,pr,ur,Ct,wt,$t,Dt,Ut,zt,Ht,er,Jt,sr,gr,nr,yr,jr,mr,_r,Kr,wr,vr,Hr,br,Er,Gr,$r,Sr,Wr,Pr,xr,qr,Tr,Cr,Yr,Ar,Rr,Qr,Ir,kr,Br,Mr,Fr,Ur,zr;for(Vt=0;Vt<48;Vt+=2)Wt=Pt[0]^Pt[10]^Pt[20]^Pt[30]^Pt[40],Qt=Pt[1]^Pt[11]^Pt[21]^Pt[31]^Pt[41],qt=Pt[2]^Pt[12]^Pt[22]^Pt[32]^Pt[42],Yt=Pt[3]^Pt[13]^Pt[23]^Pt[33]^Pt[43],Xt=Pt[4]^Pt[14]^Pt[24]^Pt[34]^Pt[44],Zt=Pt[5]^Pt[15]^Pt[25]^Pt[35]^Pt[45],tr=Pt[6]^Pt[16]^Pt[26]^Pt[36]^Pt[46],Dr=Pt[7]^Pt[17]^Pt[27]^Pt[37]^Pt[47],fr=Pt[8]^Pt[18]^Pt[28]^Pt[38]^Pt[48],hr=Pt[9]^Pt[19]^Pt[29]^Pt[39]^Pt[49],Ft=fr^(qt<<1|Yt>>>31),jt=hr^(Yt<<1|qt>>>31),Pt[0]^=Ft,Pt[1]^=jt,Pt[10]^=Ft,Pt[11]^=jt,Pt[20]^=Ft,Pt[21]^=jt,Pt[30]^=Ft,Pt[31]^=jt,Pt[40]^=Ft,Pt[41]^=jt,Ft=Wt^(Xt<<1|Zt>>>31),jt=Qt^(Zt<<1|Xt>>>31),Pt[2]^=Ft,Pt[3]^=jt,Pt[12]^=Ft,Pt[13]^=jt,Pt[22]^=Ft,Pt[23]^=jt,Pt[32]^=Ft,Pt[33]^=jt,Pt[42]^=Ft,Pt[43]^=jt,Ft=qt^(tr<<1|Dr>>>31),jt=Yt^(Dr<<1|tr>>>31),Pt[4]^=Ft,Pt[5]^=jt,Pt[14]^=Ft,Pt[15]^=jt,Pt[24]^=Ft,Pt[25]^=jt,Pt[34]^=Ft,Pt[35]^=jt,Pt[44]^=Ft,Pt[45]^=jt,Ft=Xt^(fr<<1|hr>>>31),jt=Zt^(hr<<1|fr>>>31),Pt[6]^=Ft,Pt[7]^=jt,Pt[16]^=Ft,Pt[17]^=jt,Pt[26]^=Ft,Pt[27]^=jt,Pt[36]^=Ft,Pt[37]^=jt,Pt[46]^=Ft,Pt[47]^=jt,Ft=tr^(Wt<<1|Qt>>>31),jt=Dr^(Qt<<1|Wt>>>31),Pt[8]^=Ft,Pt[9]^=jt,Pt[18]^=Ft,Pt[19]^=jt,Pt[28]^=Ft,Pt[29]^=jt,Pt[38]^=Ft,Pt[39]^=jt,Pt[48]^=Ft,Pt[49]^=jt,Or=Pt[0],lr=Pt[1],Sr=Pt[11]<<4|Pt[10]>>>28,Wr=Pt[10]<<4|Pt[11]>>>28,Ht=Pt[20]<<3|Pt[21]>>>29,er=Pt[21]<<3|Pt[20]>>>29,Mr=Pt[31]<<9|Pt[30]>>>23,Fr=Pt[30]<<9|Pt[31]>>>23,br=Pt[40]<<18|Pt[41]>>>14,Er=Pt[41]<<18|Pt[40]>>>14,yr=Pt[2]<<1|Pt[3]>>>31,jr=Pt[3]<<1|Pt[2]>>>31,ir=Pt[13]<<12|Pt[12]>>>20,dr=Pt[12]<<12|Pt[13]>>>20,Pr=Pt[22]<<10|Pt[23]>>>22,xr=Pt[23]<<10|Pt[22]>>>22,Jt=Pt[33]<<13|Pt[32]>>>19,sr=Pt[32]<<13|Pt[33]>>>19,Ur=Pt[42]<<2|Pt[43]>>>30,zr=Pt[43]<<2|Pt[42]>>>30,Ar=Pt[5]<<30|Pt[4]>>>2,Rr=Pt[4]<<30|Pt[5]>>>2,mr=Pt[14]<<6|Pt[15]>>>26,_r=Pt[15]<<6|Pt[14]>>>26,ar=Pt[25]<<11|Pt[24]>>>21,cr=Pt[24]<<11|Pt[25]>>>21,qr=Pt[34]<<15|Pt[35]>>>17,Tr=Pt[35]<<15|Pt[34]>>>17,gr=Pt[45]<<29|Pt[44]>>>3,nr=Pt[44]<<29|Pt[45]>>>3,$t=Pt[6]<<28|Pt[7]>>>4,Dt=Pt[7]<<28|Pt[6]>>>4,Qr=Pt[17]<<23|Pt[16]>>>9,Ir=Pt[16]<<23|Pt[17]>>>9,Kr=Pt[26]<<25|Pt[27]>>>7,wr=Pt[27]<<25|Pt[26]>>>7,pr=Pt[36]<<21|Pt[37]>>>11,ur=Pt[37]<<21|Pt[36]>>>11,Cr=Pt[47]<<24|Pt[46]>>>8,Yr=Pt[46]<<24|Pt[47]>>>8,Gr=Pt[8]<<27|Pt[9]>>>5,$r=Pt[9]<<27|Pt[8]>>>5,Ut=Pt[18]<<20|Pt[19]>>>12,zt=Pt[19]<<20|Pt[18]>>>12,kr=Pt[29]<<7|Pt[28]>>>25,Br=Pt[28]<<7|Pt[29]>>>25,vr=Pt[38]<<8|Pt[39]>>>24,Hr=Pt[39]<<8|Pt[38]>>>24,Ct=Pt[48]<<14|Pt[49]>>>18,wt=Pt[49]<<14|Pt[48]>>>18,Pt[0]=Or^~ir&ar,Pt[1]=lr^~dr&cr,Pt[10]=$t^~Ut&Ht,Pt[11]=Dt^~zt&er,Pt[20]=yr^~mr&Kr,Pt[21]=jr^~_r&wr,Pt[30]=Gr^~Sr&Pr,Pt[31]=$r^~Wr&xr,Pt[40]=Ar^~Qr&kr,Pt[41]=Rr^~Ir&Br,Pt[2]=ir^~ar&pr,Pt[3]=dr^~cr&ur,Pt[12]=Ut^~Ht&Jt,Pt[13]=zt^~er&sr,Pt[22]=mr^~Kr&vr,Pt[23]=_r^~wr&Hr,Pt[32]=Sr^~Pr&qr,Pt[33]=Wr^~xr&Tr,Pt[42]=Qr^~kr&Mr,Pt[43]=Ir^~Br&Fr,Pt[4]=ar^~pr&Ct,Pt[5]=cr^~ur&wt,Pt[14]=Ht^~Jt&gr,Pt[15]=er^~sr&nr,Pt[24]=Kr^~vr&br,Pt[25]=wr^~Hr&Er,Pt[34]=Pr^~qr&Cr,Pt[35]=xr^~Tr&Yr,Pt[44]=kr^~Mr&Ur,Pt[45]=Br^~Fr&zr,Pt[6]=pr^~Ct&Or,Pt[7]=ur^~wt&lr,Pt[16]=Jt^~gr&$t,Pt[17]=sr^~nr&Dt,Pt[26]=vr^~br&yr,Pt[27]=Hr^~Er&jr,Pt[36]=qr^~Cr&Gr,Pt[37]=Tr^~Yr&$r,Pt[46]=Mr^~Ur&Ar,Pt[47]=Fr^~zr&Rr,Pt[8]=Ct^~Or&ir,Pt[9]=wt^~lr&dr,Pt[18]=gr^~$t&Ut,Pt[19]=nr^~Dt&zt,Pt[28]=br^~yr&mr,Pt[29]=Er^~jr&_r,Pt[38]=Cr^~Gr&Sr,Pt[39]=Yr^~$r&Wr,Pt[48]=Ur^~Ar&Qr,Pt[49]=zr^~Rr&Ir,Pt[0]^=ut[Vt],Pt[1]^=ut[Vt+1]};if(rt)_.exports=gt;else for(xt=0;xt<Et.length;++xt)_e[Et[xt]]=gt[Et[xt]]})()})(sha3$1);const sha3=sha3$1.exports;function keccak256(_){return"0x"+sha3.keccak_256(arrayify(_))}const version$f="rlp/5.7.0",logger$l=new Logger(version$f);function arrayifyInteger(_){const a=[];for(;_;)a.unshift(_&255),_>>=8;return a}function unarrayifyInteger(_,a,$){let j=0;for(let _e=0;_e<$;_e++)j=j*256+_[a+_e];return j}function _encode(_){if(Array.isArray(_)){let j=[];if(_.forEach(function(et){j=j.concat(_encode(et))}),j.length<=55)return j.unshift(192+j.length),j;const _e=arrayifyInteger(j.length);return _e.unshift(247+_e.length),_e.concat(j)}isBytesLike(_)||logger$l.throwArgumentError("RLP object must be BytesLike","object",_);const a=Array.prototype.slice.call(arrayify(_));if(a.length===1&&a[0]<=127)return a;if(a.length<=55)return a.unshift(128+a.length),a;const $=arrayifyInteger(a.length);return $.unshift(183+$.length),$.concat(a)}function encode$x(_){return hexlify(_encode(_))}function _decodeChildren(_,a,$,j){const _e=[];for(;$<a+1+j;){const et=_decode(_,$);_e.push(et.result),$+=et.consumed,$>a+1+j&&logger$l.throwError("child data too short",Logger.errors.BUFFER_OVERRUN,{})}return{consumed:1+j,result:_e}}function _decode(_,a){if(_.length===0&&logger$l.throwError("data too short",Logger.errors.BUFFER_OVERRUN,{}),_[a]>=248){const $=_[a]-247;a+1+$>_.length&&logger$l.throwError("data short segment too short",Logger.errors.BUFFER_OVERRUN,{});const j=unarrayifyInteger(_,a+1,$);return a+1+$+j>_.length&&logger$l.throwError("data long segment too short",Logger.errors.BUFFER_OVERRUN,{}),_decodeChildren(_,a,a+1+$,$+j)}else if(_[a]>=192){const $=_[a]-192;return a+1+$>_.length&&logger$l.throwError("data array too short",Logger.errors.BUFFER_OVERRUN,{}),_decodeChildren(_,a,a+1,$)}else if(_[a]>=184){const $=_[a]-183;a+1+$>_.length&&logger$l.throwError("data array too short",Logger.errors.BUFFER_OVERRUN,{});const j=unarrayifyInteger(_,a+1,$);a+1+$+j>_.length&&logger$l.throwError("data array too short",Logger.errors.BUFFER_OVERRUN,{});const _e=hexlify(_.slice(a+1+$,a+1+$+j));return{consumed:1+$+j,result:_e}}else if(_[a]>=128){const $=_[a]-128;a+1+$>_.length&&logger$l.throwError("data too short",Logger.errors.BUFFER_OVERRUN,{});const j=hexlify(_.slice(a+1,a+1+$));return{consumed:1+$,result:j}}return{consumed:1,result:hexlify(_[a])}}function decode$t(_){const a=arrayify(_),$=_decode(a,0);return $.consumed!==a.length&&logger$l.throwArgumentError("invalid rlp data","data",_),$.result}const version$e="address/5.7.0",logger$k=new Logger(version$e);function getChecksumAddress(_){isHexString(_,20)||logger$k.throwArgumentError("invalid address","address",_),_=_.toLowerCase();const a=_.substring(2).split(""),$=new Uint8Array(40);for(let _e=0;_e<40;_e++)$[_e]=a[_e].charCodeAt(0);const j=arrayify(keccak256($));for(let _e=0;_e<40;_e+=2)j[_e>>1]>>4>=8&&(a[_e]=a[_e].toUpperCase()),(j[_e>>1]&15)>=8&&(a[_e+1]=a[_e+1].toUpperCase());return"0x"+a.join("")}const MAX_SAFE_INTEGER=9007199254740991;function log10(_){return Math.log10?Math.log10(_):Math.log(_)/Math.LN10}const ibanLookup={};for(let _=0;_<10;_++)ibanLookup[String(_)]=String(_);for(let _=0;_<26;_++)ibanLookup[String.fromCharCode(65+_)]=String(10+_);const safeDigits=Math.floor(log10(MAX_SAFE_INTEGER));function ibanChecksum(_){_=_.toUpperCase(),_=_.substring(4)+_.substring(0,2)+"00";let a=_.split("").map(j=>ibanLookup[j]).join("");for(;a.length>=safeDigits;){let j=a.substring(0,safeDigits);a=parseInt(j,10)%97+a.substring(j.length)}let $=String(98-parseInt(a,10)%97);for(;$.length<2;)$="0"+$;return $}function getAddress(_){let a=null;if(typeof _!="string"&&logger$k.throwArgumentError("invalid address","address",_),_.match(/^(0x)?[0-9a-fA-F]{40}$/))_.substring(0,2)!=="0x"&&(_="0x"+_),a=getChecksumAddress(_),_.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&a!==_&&logger$k.throwArgumentError("bad address checksum","address",_);else if(_.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(_.substring(2,4)!==ibanChecksum(_)&&logger$k.throwArgumentError("bad icap checksum","address",_),a=_base36To16(_.substring(4));a.length<40;)a="0"+a;a=getChecksumAddress("0x"+a)}else logger$k.throwArgumentError("invalid address","address",_);return a}function getContractAddress(_){let a=null;try{a=getAddress(_.from)}catch{logger$k.throwArgumentError("missing from address","transaction",_)}const $=stripZeros(arrayify(BigNumber.from(_.nonce).toHexString()));return getAddress(hexDataSlice(keccak256(encode$x([a,$])),12))}class AddressCoder extends Coder{constructor(a){super("address","address",a,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(a,$){try{$=getAddress($)}catch(j){this._throwError(j.message,$)}return a.writeValue($)}decode(a){return getAddress(hexZeroPad(a.readValue().toHexString(),20))}}class AnonymousCoder extends Coder{constructor(a){super(a.name,a.type,void 0,a.dynamic),this.coder=a}defaultValue(){return this.coder.defaultValue()}encode(a,$){return this.coder.encode(a,$)}decode(a){return this.coder.decode(a)}}const logger$j=new Logger(version$g);function pack$1(_,a,$){let j=null;if(Array.isArray($))j=$;else if($&&typeof $=="object"){let nt={};j=a.map(it=>{const st=it.localName;return st||logger$j.throwError("cannot encode object for signature with missing names",Logger.errors.INVALID_ARGUMENT,{argument:"values",coder:it,value:$}),nt[st]&&logger$j.throwError("cannot encode object for signature with duplicate names",Logger.errors.INVALID_ARGUMENT,{argument:"values",coder:it,value:$}),nt[st]=!0,$[st]})}else logger$j.throwArgumentError("invalid tuple value","tuple",$);a.length!==j.length&&logger$j.throwArgumentError("types/value length mismatch","tuple",$);let _e=new Writer$2(_.wordSize),et=new Writer$2(_.wordSize),tt=[];a.forEach((nt,it)=>{let st=j[it];if(nt.dynamic){let ot=et.length;nt.encode(et,st);let at=_e.writeUpdatableValue();tt.push(lt=>{at(lt+ot)})}else nt.encode(_e,st)}),tt.forEach(nt=>{nt(_e.length)});let rt=_.appendWriter(_e);return rt+=_.appendWriter(et),rt}function unpack(_,a){let $=[],j=_.subReader(0);a.forEach(et=>{let tt=null;if(et.dynamic){let rt=_.readValue(),nt=j.subReader(rt.toNumber());try{tt=et.decode(nt)}catch(it){if(it.code===Logger.errors.BUFFER_OVERRUN)throw it;tt=it,tt.baseType=et.name,tt.name=et.localName,tt.type=et.type}}else try{tt=et.decode(_)}catch(rt){if(rt.code===Logger.errors.BUFFER_OVERRUN)throw rt;tt=rt,tt.baseType=et.name,tt.name=et.localName,tt.type=et.type}tt!=null&&$.push(tt)});const _e=a.reduce((et,tt)=>{const rt=tt.localName;return rt&&(et[rt]||(et[rt]=0),et[rt]++),et},{});a.forEach((et,tt)=>{let rt=et.localName;if(!rt||_e[rt]!==1||(rt==="length"&&(rt="_length"),$[rt]!=null))return;const nt=$[tt];nt instanceof Error?Object.defineProperty($,rt,{enumerable:!0,get:()=>{throw nt}}):$[rt]=nt});for(let et=0;et<$.length;et++){const tt=$[et];tt instanceof Error&&Object.defineProperty($,et,{enumerable:!0,get:()=>{throw tt}})}return Object.freeze($)}class ArrayCoder extends Coder{constructor(a,$,j){const _e=a.type+"["+($>=0?$:"")+"]",et=$===-1||a.dynamic;super("array",_e,j,et),this.coder=a,this.length=$}defaultValue(){const a=this.coder.defaultValue(),$=[];for(let j=0;j<this.length;j++)$.push(a);return $}encode(a,$){Array.isArray($)||this._throwError("expected array value",$);let j=this.length;j===-1&&(j=$.length,a.writeValue($.length)),logger$j.checkArgumentCount($.length,j,"coder array"+(this.localName?" "+this.localName:""));let _e=[];for(let et=0;et<$.length;et++)_e.push(this.coder);return pack$1(a,_e,$)}decode(a){let $=this.length;$===-1&&($=a.readValue().toNumber(),$*32>a._data.length&&logger$j.throwError("insufficient data length",Logger.errors.BUFFER_OVERRUN,{length:a._data.length,count:$}));let j=[];for(let _e=0;_e<$;_e++)j.push(new AnonymousCoder(this.coder));return a.coerce(this.name,unpack(a,j))}}class BooleanCoder extends Coder{constructor(a){super("bool","bool",a,!1)}defaultValue(){return!1}encode(a,$){return a.writeValue($?1:0)}decode(a){return a.coerce(this.type,!a.readValue().isZero())}}class DynamicBytesCoder extends Coder{constructor(a,$){super(a,a,$,!0)}defaultValue(){return"0x"}encode(a,$){$=arrayify($);let j=a.writeValue($.length);return j+=a.writeBytes($),j}decode(a){return a.readBytes(a.readValue().toNumber(),!0)}}class BytesCoder extends DynamicBytesCoder{constructor(a){super("bytes",a)}decode(a){return a.coerce(this.name,hexlify(super.decode(a)))}}class FixedBytesCoder extends Coder{constructor(a,$){let j="bytes"+String(a);super(j,j,$,!1),this.size=a}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(a,$){let j=arrayify($);return j.length!==this.size&&this._throwError("incorrect data length",$),a.writeBytes(j)}decode(a){return a.coerce(this.name,hexlify(a.readBytes(this.size)))}}class NullCoder extends Coder{constructor(a){super("null","",a,!1)}defaultValue(){return null}encode(a,$){return $!=null&&this._throwError("not null",$),a.writeBytes([])}decode(a){return a.readBytes(0),a.coerce(this.name,null)}}const AddressZero="0x0000000000000000000000000000000000000000",NegativeOne$1=BigNumber.from(-1),Zero$1=BigNumber.from(0),One$1=BigNumber.from(1),MaxUint256$1=BigNumber.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),HashZero="0x0000000000000000000000000000000000000000000000000000000000000000";class NumberCoder extends Coder{constructor(a,$,j){const _e=($?"int":"uint")+a*8;super(_e,_e,j,!1),this.size=a,this.signed=$}defaultValue(){return 0}encode(a,$){let j=BigNumber.from($),_e=MaxUint256$1.mask(a.wordSize*8);if(this.signed){let et=_e.mask(this.size*8-1);(j.gt(et)||j.lt(et.add(One$1).mul(NegativeOne$1)))&&this._throwError("value out-of-bounds",$)}else(j.lt(Zero$1)||j.gt(_e.mask(this.size*8)))&&this._throwError("value out-of-bounds",$);return j=j.toTwos(this.size*8).mask(this.size*8),this.signed&&(j=j.fromTwos(this.size*8).toTwos(8*a.wordSize)),a.writeValue(j)}decode(a){let $=a.readValue().mask(this.size*8);return this.signed&&($=$.fromTwos(this.size*8)),a.coerce(this.name,$)}}const version$d="strings/5.7.0",logger$i=new Logger(version$d);var UnicodeNormalizationForm;(function(_){_.current="",_.NFC="NFC",_.NFD="NFD",_.NFKC="NFKC",_.NFKD="NFKD"})(UnicodeNormalizationForm||(UnicodeNormalizationForm={}));var Utf8ErrorReason;(function(_){_.UNEXPECTED_CONTINUE="unexpected continuation byte",_.BAD_PREFIX="bad codepoint prefix",_.OVERRUN="string overrun",_.MISSING_CONTINUE="missing continuation byte",_.OUT_OF_RANGE="out of UTF-8 range",_.UTF16_SURROGATE="UTF-16 surrogate",_.OVERLONG="overlong representation"})(Utf8ErrorReason||(Utf8ErrorReason={}));function errorFunc(_,a,$,j,_e){return logger$i.throwArgumentError(`invalid codepoint at offset ${a}; ${_}`,"bytes",$)}function ignoreFunc(_,a,$,j,_e){if(_===Utf8ErrorReason.BAD_PREFIX||_===Utf8ErrorReason.UNEXPECTED_CONTINUE){let et=0;for(let tt=a+1;tt<$.length&&$[tt]>>6===2;tt++)et++;return et}return _===Utf8ErrorReason.OVERRUN?$.length-a-1:0}function replaceFunc(_,a,$,j,_e){return _===Utf8ErrorReason.OVERLONG?(j.push(_e),0):(j.push(65533),ignoreFunc(_,a,$))}const Utf8ErrorFuncs=Object.freeze({error:errorFunc,ignore:ignoreFunc,replace:replaceFunc});function getUtf8CodePoints(_,a){a==null&&(a=Utf8ErrorFuncs.error),_=arrayify(_);const $=[];let j=0;for(;j<_.length;){const _e=_[j++];if(_e>>7===0){$.push(_e);continue}let et=null,tt=null;if((_e&224)===192)et=1,tt=127;else if((_e&240)===224)et=2,tt=2047;else if((_e&248)===240)et=3,tt=65535;else{(_e&192)===128?j+=a(Utf8ErrorReason.UNEXPECTED_CONTINUE,j-1,_,$):j+=a(Utf8ErrorReason.BAD_PREFIX,j-1,_,$);continue}if(j-1+et>=_.length){j+=a(Utf8ErrorReason.OVERRUN,j-1,_,$);continue}let rt=_e&(1<<8-et-1)-1;for(let nt=0;nt<et;nt++){let it=_[j];if((it&192)!=128){j+=a(Utf8ErrorReason.MISSING_CONTINUE,j,_,$),rt=null;break}rt=rt<<6|it&63,j++}if(rt!==null){if(rt>1114111){j+=a(Utf8ErrorReason.OUT_OF_RANGE,j-1-et,_,$,rt);continue}if(rt>=55296&&rt<=57343){j+=a(Utf8ErrorReason.UTF16_SURROGATE,j-1-et,_,$,rt);continue}if(rt<=tt){j+=a(Utf8ErrorReason.OVERLONG,j-1-et,_,$,rt);continue}$.push(rt)}}return $}function toUtf8Bytes(_,a=UnicodeNormalizationForm.current){a!=UnicodeNormalizationForm.current&&(logger$i.checkNormalize(),_=_.normalize(a));let $=[];for(let j=0;j<_.length;j++){const _e=_.charCodeAt(j);if(_e<128)$.push(_e);else if(_e<2048)$.push(_e>>6|192),$.push(_e&63|128);else if((_e&64512)==55296){j++;const et=_.charCodeAt(j);if(j>=_.length||(et&64512)!==56320)throw new Error("invalid utf-8 string");const tt=65536+((_e&1023)<<10)+(et&1023);$.push(tt>>18|240),$.push(tt>>12&63|128),$.push(tt>>6&63|128),$.push(tt&63|128)}else $.push(_e>>12|224),$.push(_e>>6&63|128),$.push(_e&63|128)}return arrayify($)}function _toUtf8String(_){return _.map(a=>a<=65535?String.fromCharCode(a):(a-=65536,String.fromCharCode((a>>10&1023)+55296,(a&1023)+56320))).join("")}function toUtf8String(_,a){return _toUtf8String(getUtf8CodePoints(_,a))}function toUtf8CodePoints(_,a=UnicodeNormalizationForm.current){return getUtf8CodePoints(toUtf8Bytes(_,a))}class StringCoder extends DynamicBytesCoder{constructor(a){super("string",a)}defaultValue(){return""}encode(a,$){return super.encode(a,toUtf8Bytes($))}decode(a){return toUtf8String(super.decode(a))}}class TupleCoder extends Coder{constructor(a,$){let j=!1;const _e=[];a.forEach(tt=>{tt.dynamic&&(j=!0),_e.push(tt.type)});const et="tuple("+_e.join(",")+")";super("tuple",et,$,j),this.coders=a}defaultValue(){const a=[];this.coders.forEach(j=>{a.push(j.defaultValue())});const $=this.coders.reduce((j,_e)=>{const et=_e.localName;return et&&(j[et]||(j[et]=0),j[et]++),j},{});return this.coders.forEach((j,_e)=>{let et=j.localName;!et||$[et]!==1||(et==="length"&&(et="_length"),a[et]==null&&(a[et]=a[_e]))}),Object.freeze(a)}encode(a,$){return pack$1(a,this.coders,$)}decode(a){return a.coerce(this.name,unpack(a,this.coders))}}const logger$h=new Logger(version$g),paramTypeBytes=new RegExp(/^bytes([0-9]*)$/),paramTypeNumber=new RegExp(/^(u?int)([0-9]*)$/);class AbiCoder{constructor(a){defineReadOnly(this,"coerceFunc",a||null)}_getCoder(a){switch(a.baseType){case"address":return new AddressCoder(a.name);case"bool":return new BooleanCoder(a.name);case"string":return new StringCoder(a.name);case"bytes":return new BytesCoder(a.name);case"array":return new ArrayCoder(this._getCoder(a.arrayChildren),a.arrayLength,a.name);case"tuple":return new TupleCoder((a.components||[]).map(j=>this._getCoder(j)),a.name);case"":return new NullCoder(a.name)}let $=a.type.match(paramTypeNumber);if($){let j=parseInt($[2]||"256");return(j===0||j>256||j%8!==0)&&logger$h.throwArgumentError("invalid "+$[1]+" bit length","param",a),new NumberCoder(j/8,$[1]==="int",a.name)}if($=a.type.match(paramTypeBytes),$){let j=parseInt($[1]);return(j===0||j>32)&&logger$h.throwArgumentError("invalid bytes length","param",a),new FixedBytesCoder(j,a.name)}return logger$h.throwArgumentError("invalid type","type",a.type)}_getWordSize(){return 32}_getReader(a,$){return new Reader$2(a,this._getWordSize(),this.coerceFunc,$)}_getWriter(){return new Writer$2(this._getWordSize())}getDefaultValue(a){const $=a.map(_e=>this._getCoder(ParamType.from(_e)));return new TupleCoder($,"_").defaultValue()}encode(a,$){a.length!==$.length&&logger$h.throwError("types/values length mismatch",Logger.errors.INVALID_ARGUMENT,{count:{types:a.length,values:$.length},value:{types:a,values:$}});const j=a.map(tt=>this._getCoder(ParamType.from(tt))),_e=new TupleCoder(j,"_"),et=this._getWriter();return _e.encode(et,$),et.data}decode(a,$,j){const _e=a.map(tt=>this._getCoder(ParamType.from(tt)));return new TupleCoder(_e,"_").decode(this._getReader(arrayify($),j))}}const defaultAbiCoder=new AbiCoder;function id(_){return keccak256(toUtf8Bytes(_))}const version$c="hash/5.7.0";function decode$s(_){_=atob(_);const a=[];for(let $=0;$<_.length;$++)a.push(_.charCodeAt($));return arrayify(a)}function encode$w(_){_=arrayify(_);let a="";for(let $=0;$<_.length;$++)a+=String.fromCharCode(_[$]);return btoa(a)}function flat$1(_,a){a==null&&(a=1);const $=[],j=$.forEach,_e=function(et,tt){j.call(et,function(rt){tt>0&&Array.isArray(rt)?_e(rt,tt-1):$.push(rt)})};return _e(_,a),$}function fromEntries(_){const a={};for(let $=0;$<_.length;$++){const j=_[$];a[j[0]]=j[1]}return a}function decode_arithmetic(_){let a=0;function $(){return _[a++]<<8|_[a++]}let j=$(),_e=1,et=[0,1];for(let _t=1;_t<j;_t++)et.push(_e+=$());let tt=$(),rt=a;a+=tt;let nt=0,it=0;function st(){return nt==0&&(it=it<<8|_[a++],nt=8),it>>--nt&1}const ot=31,at=Math.pow(2,ot),lt=at>>>1,ct=lt>>1,ut=at-1;let dt=0;for(let _t=0;_t<ot;_t++)dt=dt<<1|st();let ft=[],pt=0,yt=at;for(;;){let _t=Math.floor(((dt-pt+1)*_e-1)/yt),vt=0,ht=j;for(;ht-vt>1;){let Lt=vt+ht>>>1;_t<et[Lt]?ht=Lt:vt=Lt}if(vt==0)break;ft.push(vt);let St=pt+Math.floor(yt*et[vt]/_e),It=pt+Math.floor(yt*et[vt+1]/_e)-1;for(;((St^It)&lt)==0;)dt=dt<<1&ut|st(),St=St<<1&ut,It=It<<1&ut|1;for(;St&~It&ct;)dt=dt&lt|dt<<1&ut>>>1|st(),St=St<<1^lt,It=(It^lt)<<1|lt|1;pt=St,yt=1+It-St}let mt=j-4;return ft.map(_t=>{switch(_t-mt){case 3:return mt+65792+(_[rt++]<<16|_[rt++]<<8|_[rt++]);case 2:return mt+256+(_[rt++]<<8|_[rt++]);case 1:return mt+_[rt++];default:return _t-1}})}function read_payload(_){let a=0;return()=>_[a++]}function read_compressed_payload(_){return read_payload(decode_arithmetic(_))}function signed(_){return _&1?~_>>1:_>>1}function read_counts(_,a){let $=Array(_);for(let j=0;j<_;j++)$[j]=1+a();return $}function read_ascending(_,a){let $=Array(_);for(let j=0,_e=-1;j<_;j++)$[j]=_e+=1+a();return $}function read_deltas(_,a){let $=Array(_);for(let j=0,_e=0;j<_;j++)$[j]=_e+=signed(a());return $}function read_member_array(_,a){let $=read_ascending(_(),_),j=_(),_e=read_ascending(j,_),et=read_counts(j,_);for(let tt=0;tt<j;tt++)for(let rt=0;rt<et[tt];rt++)$.push(_e[tt]+rt);return a?$.map(tt=>a[tt]):$}function read_mapped_map(_){let a=[];for(;;){let $=_();if($==0)break;a.push(read_linear_table($,_))}for(;;){let $=_()-1;if($<0)break;a.push(read_replacement_table($,_))}return fromEntries(flat$1(a))}function read_zero_terminated_array(_){let a=[];for(;;){let $=_();if($==0)break;a.push($)}return a}function read_transposed(_,a,$){let j=Array(_).fill(void 0).map(()=>[]);for(let _e=0;_e<a;_e++)read_deltas(_,$).forEach((et,tt)=>j[tt].push(et));return j}function read_linear_table(_,a){let $=1+a(),j=a(),_e=read_zero_terminated_array(a),et=read_transposed(_e.length,1+_,a);return flat$1(et.map((tt,rt)=>{const nt=tt[0],it=tt.slice(1);return Array(_e[rt]).fill(void 0).map((st,ot)=>{let at=ot*j;return[nt+ot*$,it.map(lt=>lt+at)]})}))}function read_replacement_table(_,a){let $=1+a();return read_transposed($,1+_,a).map(_e=>[_e[0],_e.slice(1)])}function read_emoji_trie(_){let a=read_member_array(_).sort((j,_e)=>j-_e);return $();function $(){let j=[];for(;;){let it=read_member_array(_,a);if(it.length==0)break;j.push({set:new Set(it),node:$()})}j.sort((it,st)=>st.set.size-it.set.size);let _e=_(),et=_e%3;_e=_e/3|0;let tt=!!(_e&1);_e>>=1;let rt=_e==1,nt=_e==2;return{branches:j,valid:et,fe0f:tt,save:rt,check:nt}}}function getData(){return read_compressed_payload(decode$s("AEQF2AO2DEsA2wIrAGsBRABxAN8AZwCcAEwAqgA0AGwAUgByADcATAAVAFYAIQAyACEAKAAYAFgAGwAjABQAMAAmADIAFAAfABQAKwATACoADgAbAA8AHQAYABoAGQAxADgALAAoADwAEwA9ABMAGgARAA4ADwAWABMAFgAIAA8AHgQXBYMA5BHJAS8JtAYoAe4AExozi0UAH21tAaMnBT8CrnIyhrMDhRgDygIBUAEHcoFHUPe8AXBjAewCjgDQR8IICIcEcQLwATXCDgzvHwBmBoHNAqsBdBcUAykgDhAMShskMgo8AY8jqAQfAUAfHw8BDw87MioGlCIPBwZCa4ELatMAAMspJVgsDl8AIhckSg8XAHdvTwBcIQEiDT4OPhUqbyECAEoAS34Aej8Ybx83JgT/Xw8gHxZ/7w8RICxPHA9vBw+Pfw8PHwAPFv+fAsAvCc8vEr8ivwD/EQ8Bol8OEBa/A78hrwAPCU8vESNvvwWfHwNfAVoDHr+ZAAED34YaAdJPAK7PLwSEgDLHAGo1Pz8Pvx9fUwMrpb8O/58VTzAPIBoXIyQJNF8hpwIVAT8YGAUADDNBaX3RAMomJCg9EhUeA29MABsZBTMNJipjOhc19gcIDR8bBwQHEggCWi6DIgLuAQYA+BAFCha3A5XiAEsqM7UFFgFLhAMjFTMYE1Klnw74nRVBG/ASCm0BYRN/BrsU3VoWy+S0vV8LQx+vN8gF2AC2AK5EAWwApgYDKmAAroQ0NDQ0AT+OCg7wAAIHRAbpNgVcBV0APTA5BfbPFgMLzcYL/QqqA82eBALKCjQCjqYCht0/k2+OAsXQAoP3ASTKDgDw6ACKAUYCMpIKJpRaAE4A5womABzZvs0REEKiACIQAd5QdAECAj4Ywg/wGqY2AVgAYADYvAoCGAEubA0gvAY2ALAAbpbvqpyEAGAEpgQAJgAG7gAgAEACmghUFwCqAMpAINQIwC4DthRAAPcycKgApoIdABwBfCisABoATwBqASIAvhnSBP8aH/ECeAKXAq40NjgDBTwFYQU6AXs3oABgAD4XNgmcCY1eCl5tIFZeUqGgyoNHABgAEQAaABNwWQAmABMATPMa3T34ADldyprmM1M2XociUQgLzvwAXT3xABgAEQAaABNwIGFAnADD8AAgAD4BBJWzaCcIAIEBFMAWwKoAAdq9BWAF5wLQpALEtQAKUSGkahR4GnJM+gsAwCgeFAiUAECQ0BQuL8AAIAAAADKeIheclvFqQAAETr4iAMxIARMgAMIoHhQIAn0E0pDQFC4HhznoAAAAIAI2C0/4lvFqQAAETgBJJwYCAy4ABgYAFAA8MBKYEH4eRhTkAjYeFcgACAYAeABsOqyQ5gRwDayqugEgaIIAtgoACgDmEABmBAWGme5OBJJA2m4cDeoAmITWAXwrMgOgAGwBCh6CBXYF1Tzg1wKAAFdiuABRAFwAXQBsAG8AdgBrAHYAbwCEAHEwfxQBVE5TEQADVFhTBwBDANILAqcCzgLTApQCrQL6vAAMAL8APLhNBKkE6glGKTAU4Dr4N2EYEwBCkABKk8rHAbYBmwIoAiU4Ajf/Aq4CowCAANIChzgaNBsCsTgeODcFXrgClQKdAqQBiQGYAqsCsjTsNHsfNPA0ixsAWTWiOAMFPDQSNCk2BDZHNow2TTZUNhk28Jk9VzI3QkEoAoICoQKwAqcAQAAxBV4FXbS9BW47YkIXP1ciUqs05DS/FwABUwJW11e6nHuYZmSh/RAYA8oMKvZ8KASoUAJYWAJ6ILAsAZSoqjpgA0ocBIhmDgDWAAawRDQoAAcuAj5iAHABZiR2AIgiHgCaAU68ACxuHAG0ygM8MiZIAlgBdF4GagJqAPZOHAMuBgoATkYAsABiAHgAMLoGDPj0HpKEBAAOJgAuALggTAHWAeAMEDbd20Uege0ADwAWADkAQgA9OHd+2MUQZBBhBgNNDkxxPxUQArEPqwvqERoM1irQ090ANK4H8ANYB/ADWANYB/AH8ANYB/ADWANYA1gDWBwP8B/YxRBkD00EcgWTBZAE2wiIJk4RhgctCNdUEnQjHEwDSgEBIypJITuYMxAlR0wRTQgIATZHbKx9PQNMMbBU+pCnA9AyVDlxBgMedhKlAC8PeCE1uk6DekxxpQpQT7NX9wBFBgASqwAS5gBJDSgAUCwGPQBI4zTYABNGAE2bAE3KAExdGABKaAbgAFBXAFCOAFBJABI2SWdObALDOq0//QomCZhvwHdTBkIQHCemEPgMNAG2ATwN7kvZBPIGPATKH34ZGg/OlZ0Ipi3eDO4m5C6igFsj9iqEBe5L9TzeC05RaQ9aC2YJ5DpkgU8DIgEOIowK3g06CG4Q9ArKbA3mEUYHOgPWSZsApgcCCxIdNhW2JhFirQsKOXgG/Br3C5AmsBMqev0F1BoiBk4BKhsAANAu6IWxWjJcHU9gBgQLJiPIFKlQIQ0mQLh4SRocBxYlqgKSQ3FKiFE3HpQh9zw+DWcuFFF9B/Y8BhlQC4I8n0asRQ8R0z6OPUkiSkwtBDaALDAnjAnQD4YMunxzAVoJIgmyDHITMhEYN8YIOgcaLpclJxYIIkaWYJsE+KAD9BPSAwwFQAlCBxQDthwuEy8VKgUOgSXYAvQ21i60ApBWgQEYBcwPJh/gEFFH4Q7qCJwCZgOEJewALhUiABginAhEZABgj9lTBi7MCMhqbSN1A2gU6GIRdAeSDlgHqBw0FcAc4nDJXgyGCSiksAlcAXYJmgFgBOQICjVcjKEgQmdUi1kYnCBiQUBd/QIyDGYVoES+h3kCjA9sEhwBNgF0BzoNAgJ4Ee4RbBCWCOyGBTW2M/k6JgRQIYQgEgooA1BszwsoJvoM+WoBpBJjAw00PnfvZ6xgtyUX/gcaMsZBYSHyC5NPzgydGsIYQ1QvGeUHwAP0GvQn60FYBgADpAQUOk4z7wS+C2oIjAlAAEoOpBgH2BhrCnKM0QEyjAG4mgNYkoQCcJAGOAcMAGgMiAV65gAeAqgIpAAGANADWAA6Aq4HngAaAIZCAT4DKDABIuYCkAOUCDLMAZYwAfQqBBzEDBYA+DhuSwLDsgKAa2ajBd5ZAo8CSjYBTiYEBk9IUgOwcuIA3ABMBhTgSAEWrEvMG+REAeBwLADIAPwABjYHBkIBzgH0bgC4AWALMgmjtLYBTuoqAIQAFmwB2AKKAN4ANgCA8gFUAE4FWvoF1AJQSgESMhksWGIBvAMgATQBDgB6BsyOpsoIIARuB9QCEBwV4gLvLwe2AgMi4BPOQsYCvd9WADIXUu5eZwqoCqdeaAC0YTQHMnM9UQAPH6k+yAdy/BZIiQImSwBQ5gBQQzSaNTFWSTYBpwGqKQK38AFtqwBI/wK37gK3rQK3sAK6280C0gK33AK3zxAAUEIAUD9SklKDArekArw5AEQAzAHCO147WTteO1k7XjtZO147WTteO1kDmChYI03AVU0oJqkKbV9GYewMpw3VRMk6ShPcYFJgMxPJLbgUwhXPJVcZPhq9JwYl5VUKDwUt1GYxCC00dhe9AEApaYNCY4ceMQpMHOhTklT5LRwAskujM7ANrRsWREEFSHXuYisWDwojAmSCAmJDXE6wXDchAqH4AmiZAmYKAp+FOBwMAmY8AmYnBG8EgAN/FAN+kzkHOXgYOYM6JCQCbB4CMjc4CwJtyAJtr/CLADRoRiwBaADfAOIASwYHmQyOAP8MwwAOtgJ3MAJ2o0ACeUxEAni7Hl3cRa9G9AJ8QAJ6yQJ9CgJ88UgBSH5kJQAsFklZSlwWGErNAtECAtDNSygDiFADh+dExpEzAvKiXQQDA69Lz0wuJgTQTU1NsAKLQAKK2cIcCB5EaAa4Ao44Ao5dQZiCAo7aAo5deVG1UzYLUtVUhgKT/AKTDQDqAB1VH1WwVdEHLBwplocy4nhnRTw6ApegAu+zWCKpAFomApaQApZ9nQCqWa1aCoJOADwClrYClk9cRVzSApnMApllXMtdCBoCnJw5wzqeApwXAp+cAp65iwAeEDIrEAKd8gKekwC2PmE1YfACntQCoG8BqgKeoCACnk+mY8lkKCYsAiewAiZ/AqD8AqBN2AKmMAKlzwKoAAB+AqfzaH1osgAESmodatICrOQCrK8CrWgCrQMCVx4CVd0CseLYAx9PbJgCsr4OArLpGGzhbWRtSWADJc4Ctl08QG6RAylGArhfArlIFgK5K3hwN3DiAr0aAy2zAzISAr6JcgMDM3ICvhtzI3NQAsPMAsMFc4N0TDZGdOEDPKgDPJsDPcACxX0CxkgCxhGKAshqUgLIRQLJUALJLwJkngLd03h6YniveSZL0QMYpGcDAmH1GfSVJXsMXpNevBICz2wCz20wTFTT9BSgAMeuAs90ASrrA04TfkwGAtwoAtuLAtJQA1JdA1NgAQIDVY2AikABzBfuYUZ2AILPg44C2sgC2d+EEYRKpz0DhqYAMANkD4ZyWvoAVgLfZgLeuXR4AuIw7RUB8zEoAfScAfLTiALr9ALpcXoAAur6AurlAPpIAboC7ooC652Wq5cEAu5AA4XhmHpw4XGiAvMEAGoDjheZlAL3FAORbwOSiAL3mQL52gL4Z5odmqy8OJsfA52EAv77ARwAOp8dn7QDBY4DpmsDptoA0sYDBmuhiaIGCgMMSgFgASACtgNGAJwEgLpoBgC8BGzAEowcggCEDC6kdjoAJAM0C5IKRoABZCgiAIzw3AYBLACkfng9ogigkgNmWAN6AEQCvrkEVqTGAwCsBRbAA+4iQkMCHR072jI2PTbUNsk2RjY5NvA23TZKNiU3EDcZN5I+RTxDRTBCJkK5VBYKFhZfwQCWygU3AJBRHpu+OytgNxa61A40GMsYjsn7BVwFXQVcBV0FaAVdBVwFXQVcBV0FXAVdBVwFXUsaCNyKAK4AAQUHBwKU7oICoW1e7jAEzgPxA+YDwgCkBFDAwADABKzAAOxFLhitA1UFTDeyPkM+bj51QkRCuwTQWWQ8X+0AWBYzsACNA8xwzAGm7EZ/QisoCTAbLDs6fnLfb8H2GccsbgFw13M1HAVkBW/Jxsm9CNRO8E8FDD0FBQw9FkcClOYCoMFegpDfADgcMiA2AJQACB8AsigKAIzIEAJKeBIApY5yPZQIAKQiHb4fvj5BKSRPQrZCOz0oXyxgOywfKAnGbgMClQaCAkILXgdeCD9IIGUgQj5fPoY+dT52Ao5CM0dAX9BTVG9SDzFwWTQAbxBzJF/lOEIQQglCCkKJIAls5AcClQICoKPMODEFxhi6KSAbiyfIRrMjtCgdWCAkPlFBIitCsEJRzAbMAV/OEyQzDg0OAQQEJ36i328/Mk9AybDJsQlq3tDRApUKAkFzXf1d/j9uALYP6hCoFgCTGD8kPsFKQiobrm0+zj0KSD8kPnVCRBwMDyJRTHFgMTJa5rwXQiQ2YfI/JD7BMEJEHGINTw4TOFlIRzwJO0icMQpyPyQ+wzJCRBv6DVgnKB01NgUKj2bwYzMqCoBkznBgEF+zYDIocwRIX+NgHj4HICNfh2C4CwdwFWpTG/lgUhYGAwRfv2Ts8mAaXzVgml/XYIJfuWC4HI1gUF9pYJZgMR6ilQHMAOwLAlDRefC0in4AXAEJA6PjCwc0IamOANMMCAECRQDFNRTZBgd+CwQlRA+r6+gLBDEFBnwUBXgKATIArwAGRAAHA3cDdAN2A3kDdwN9A3oDdQN7A30DfAN4A3oDfQAYEAAlAtYASwMAUAFsAHcKAHcAmgB3AHUAdQB2AHVu8UgAygDAAHcAdQB1AHYAdQALCgB3AAsAmgB3AAsCOwB3AAtu8UgAygDAAHgKAJoAdwB3AHUAdQB2AHUAeAB1AHUAdgB1bvFIAMoAwAALCgCaAHcACwB3AAsCOwB3AAtu8UgAygDAAH4ACwGgALcBpwC6AahdAu0COwLtbvFIAMoAwAALCgCaAu0ACwLtAAsCOwLtAAtu8UgAygDAA24ACwNvAAu0VsQAAzsAABCkjUIpAAsAUIusOggWcgMeBxVsGwL67U/2HlzmWOEeOgALASvuAAseAfpKUpnpGgYJDCIZM6YyARUE9ThqAD5iXQgnAJYJPnOzw0ZAEZxEKsIAkA4DhAHnTAIDxxUDK0lxCQlPYgIvIQVYJQBVqE1GakUAKGYiDToSBA1EtAYAXQJYAIF8GgMHRyAAIAjOe9YncekRAA0KACUrjwE7Ayc6AAYWAqaiKG4McEcqANoN3+Mg9TwCBhIkuCny+JwUQ29L008JluRxu3K+oAdqiHOqFH0AG5SUIfUJ5SxCGfxdipRzqTmT4V5Zb+r1Uo4Vm+NqSSEl2mNvR2JhIa8SpYO6ntdwFXHCWTCK8f2+Hxo7uiG3drDycAuKIMP5bhi06ACnqArH1rz4Rqg//lm6SgJGEVbF9xJHISaR6HxqxSnkw6shDnelHKNEfGUXSJRJ1GcsmtJw25xrZMDK9gXSm1/YMkdX4/6NKYOdtk/NQ3/NnDASjTc3fPjIjW/5sVfVObX2oTDWkr1dF9f3kxBsD3/3aQO8hPfRz+e0uEiJqt1161griu7gz8hDDwtpy+F+BWtefnKHZPAxcZoWbnznhJpy0e842j36bcNzGnIEusgGX0a8ZxsnjcSsPDZ09yZ36fCQbriHeQ72JRMILNl6ePPf2HWoVwgWAm1fb3V2sAY0+B6rAXqSwPBgseVmoqsBTSrm91+XasMYYySI8eeRxH3ZvHkMz3BQ5aJ3iUVbYPNM3/7emRtjlsMgv/9VyTsyt/mK+8fgWeT6SoFaclXqn42dAIsvAarF5vNNWHzKSkKQ/8Hfk5ZWK7r9yliOsooyBjRhfkHP4Q2DkWXQi6FG/9r/IwbmkV5T7JSopHKn1pJwm9tb5Ot0oyN1Z2mPpKXHTxx2nlK08fKk1hEYA8WgVVWL5lgx0iTv+KdojJeU23ZDjmiubXOxVXJKKi2Wjuh2HLZOFLiSC7Tls5SMh4f+Pj6xUSrNjFqLGehRNB8lC0QSLNmkJJx/wSG3MnjE9T1CkPwJI0wH2lfzwETIiVqUxg0dfu5q39Gt+hwdcxkhhNvQ4TyrBceof3Mhs/IxFci1HmHr4FMZgXEEczPiGCx0HRwzAqDq2j9AVm1kwN0mRVLWLylgtoPNapF5cY4Y1wJh/e0BBwZj44YgZrDNqvD/9Hv7GFYdUQeDJuQ3EWI4HaKqavU1XjC/n41kT4L79kqGq0kLhdTZvgP3TA3fS0ozVz+5piZsoOtIvBUFoMKbNcmBL6YxxaUAusHB38XrS8dQMnQwJfUUkpRoGr5AUeWicvBTzyK9g77+yCkf5PAysL7r/JjcZgrbvRpMW9iyaxZvKO6ceZN2EwIxKwVFPuvFuiEPGCoagbMo+SpydLrXqBzNCDGFCrO/rkcwa2xhokQZ5CdZ0AsU3JfSqJ6n5I14YA+P/uAgfhPU84Tlw7cEFfp7AEE8ey4sP12PTt4Cods1GRgDOB5xvyiR5m+Bx8O5nBCNctU8BevfV5A08x6RHd5jcwPTMDSZJOedIZ1cGQ704lxbAzqZOP05ZxaOghzSdvFBHYqomATARyAADK4elP8Ly3IrUZKfWh23Xy20uBUmLS4Pfagu9+oyVa2iPgqRP3F2CTUsvJ7+RYnN8fFZbU/HVvxvcFFDKkiTqV5UBZ3Gz54JAKByi9hkKMZJvuGgcSYXFmw08UyoQyVdfTD1/dMkCHXcTGAKeROgArsvmRrQTLUOXioOHGK2QkjHuoYFgXciZoTJd6Fs5q1QX1G+p/e26hYsEf7QZD1nnIyl/SFkNtYYmmBhpBrxl9WbY0YpHWRuw2Ll/tj9mD8P4snVzJl4F9J+1arVeTb9E5r2ILH04qStjxQNwn3m4YNqxmaNbLAqW2TN6LidwuJRqS+NXbtqxoeDXpxeGWmxzSkWxjkyCkX4NQRme6q5SAcC+M7+9ETfA/EwrzQajKakCwYyeunP6ZFlxU2oMEn1Pz31zeStW74G406ZJFCl1wAXIoUKkWotYEpOuXB1uVNxJ63dpJEqfxBeptwIHNrPz8BllZoIcBoXwgfJ+8VAUnVPvRvexnw0Ma/WiGYuJO5y8QTvEYBigFmhUxY5RqzE8OcywN/8m4UYrlaniJO75XQ6KSo9+tWHlu+hMi0UVdiKQp7NelnoZUzNaIyBPVeOwK6GNp+FfHuPOoyhaWuNvTYFkvxscMQWDh+zeFCFkgwbXftiV23ywJ4+uwRqmg9k3KzwIQpzppt8DBBOMbrqwQM5Gb05sEwdKzMiAqOloaA/lr0KA+1pr0/+HiWoiIjHA/wir2nIuS3PeU/ji3O6ZwoxcR1SZ9FhtLC5S0FIzFhbBWcGVP/KpxOPSiUoAdWUpqKH++6Scz507iCcxYI6rdMBICPJZea7OcmeFw5mObJSiqpjg2UoWNIs+cFhyDSt6geV5qgi3FunmwwDoGSMgerFOZGX1m0dMCYo5XOruxO063dwENK9DbnVM9wYFREzh4vyU1WYYJ/LRRp6oxgjqP/X5a8/4Af6p6NWkQferzBmXme0zY/4nwMJm/wd1tIqSwGz+E3xPEAOoZlJit3XddD7/BT1pllzOx+8bmQtANQ/S6fZexc6qi3W+Q2xcmXTUhuS5mpHQRvcxZUN0S5+PL9lXWUAaRZhEH8hTdAcuNMMCuVNKTEGtSUKNi3O6KhSaTzck8csZ2vWRZ+d7mW8c4IKwXIYd25S/zIftPkwPzufjEvOHWVD1m+FjpDVUTV0DGDuHj6QnaEwLu/dEgdLQOg9E1Sro9XHJ8ykLAwtPu+pxqKDuFexqON1sKQm7rwbE1E68UCfA/erovrTCG+DBSNg0l4goDQvZN6uNlbyLpcZAwj2UclycvLpIZMgv4yRlpb3YuMftozorbcGVHt/VeDV3+Fdf1TP0iuaCsPi2G4XeGhsyF1ubVDxkoJhmniQ0/jSg/eYML9KLfnCFgISWkp91eauR3IQvED0nAPXK+6hPCYs+n3+hCZbiskmVMG2da+0EsZPonUeIY8EbfusQXjsK/eFDaosbPjEfQS0RKG7yj5GG69M7MeO1HmiUYocgygJHL6M1qzUDDwUSmr99V7Sdr2F3JjQAJY+F0yH33Iv3+C9M38eML7gTgmNu/r2bUMiPvpYbZ6v1/IaESirBHNa7mPKn4dEmYg7v/+HQgPN1G79jBQ1+soydfDC2r+h2Bl/KIc5KjMK7OH6nb1jLsNf0EHVe2KBiE51ox636uyG6Lho0t3J34L5QY/ilE3mikaF4HKXG1mG1rCevT1Vv6GavltxoQe/bMrpZvRggnBxSEPEeEzkEdOxTnPXHVjUYdw8JYvjB/o7Eegc3Ma+NUxLLnsK0kJlinPmUHzHGtrk5+CAbVzFOBqpyy3QVUnzTDfC/0XD94/okH+OB+i7g9lolhWIjSnfIb+Eq43ZXOWmwvjyV/qqD+t0e+7mTEM74qP/Ozt8nmC7mRpyu63OB4KnUzFc074SqoyPUAgM+/TJGFo6T44EHnQU4X4z6qannVqgw/U7zCpwcmXV1AubIrvOmkKHazJAR55ePjp5tLBsN8vAqs3NAHdcEHOR2xQ0lsNAFzSUuxFQCFYvXLZJdOj9p4fNq6p0HBGUik2YzaI4xySy91KzhQ0+q1hjxvImRwPRf76tChlRkhRCi74NXZ9qUNeIwP+s5p+3m5nwPdNOHgSLD79n7O9m1n1uDHiMntq4nkYwV5OZ1ENbXxFd4PgrlvavZsyUO4MqYlqqn1O8W/I1dEZq5dXhrbETLaZIbC2Kj/Aa/QM+fqUOHdf0tXAQ1huZ3cmWECWSXy/43j35+Mvq9xws7JKseriZ1pEWKc8qlzNrGPUGcVgOa9cPJYIJsGnJTAUsEcDOEVULO5x0rXBijc1lgXEzQQKhROf8zIV82w8eswc78YX11KYLWQRcgHNJElBxfXr72lS2RBSl07qTKorO2uUDZr3sFhYsvnhLZn0A94KRzJ/7DEGIAhW5ZWFpL8gEwu1aLA9MuWZzNwl8Oze9Y+bX+v9gywRVnoB5I/8kXTXU3141yRLYrIOOz6SOnyHNy4SieqzkBXharjfjqq1q6tklaEbA8Qfm2DaIPs7OTq/nvJBjKfO2H9bH2cCMh1+5gspfycu8f/cuuRmtDjyqZ7uCIMyjdV3a+p3fqmXsRx4C8lujezIFHnQiVTXLXuI1XrwN3+siYYj2HHTvESUx8DlOTXpak9qFRK+L3mgJ1WsD7F4cu1aJoFoYQnu+wGDMOjJM3kiBQWHCcvhJ/HRdxodOQp45YZaOTA22Nb4XKCVxqkbwMYFhzYQYIAnCW8FW14uf98jhUG2zrKhQQ0q0CEq0t5nXyvUyvR8DvD69LU+g3i+HFWQMQ8PqZuHD+sNKAV0+M6EJC0szq7rEr7B5bQ8BcNHzvDMc9eqB5ZCQdTf80Obn4uzjwpYU7SISdtV0QGa9D3Wrh2BDQtpBKxaNFV+/Cy2P/Sv+8s7Ud0Fd74X4+o/TNztWgETUapy+majNQ68Lq3ee0ZO48VEbTZYiH1Co4OlfWef82RWeyUXo7woM03PyapGfikTnQinoNq5z5veLpeMV3HCAMTaZmA1oGLAn7XS3XYsz+XK7VMQsc4XKrmDXOLU/pSXVNUq8dIqTba///3x6LiLS6xs1xuCAYSfcQ3+rQgmu7uvf3THKt5Ooo97TqcbRqxx7EASizaQCBQllG/rYxVapMLgtLbZS64w1MDBMXX+PQpBKNwqUKOf2DDRDUXQf9EhOS0Qj4nTmlA8dzSLz/G1d+Ud8MTy/6ghhdiLpeerGY/UlDOfiuqFsMUU5/UYlP+BAmgRLuNpvrUaLlVkrqDievNVEAwF+4CoM1MZTmjxjJMsKJq+u8Zd7tNCUFy6LiyYXRJQ4VyvEQFFaCGKsxIwQkk7EzZ6LTJq2hUuPhvAW+gQnSG6J+MszC+7QCRHcnqDdyNRJ6T9xyS87A6MDutbzKGvGktpbXqtzWtXb9HsfK2cBMomjN9a4y+TaJLnXxAeX/HWzmf4cR4vALt/P4w4qgKY04ml4ZdLOinFYS6cup3G/1ie4+t1eOnpBNlqGqs75ilzkT4+DsZQxNvaSKJ//6zIbbk/M7LOhFmRc/1R+kBtz7JFGdZm/COotIdvQoXpTqP/1uqEUmCb/QWoGLMwO5ANcHzxdY48IGP5+J+zKOTBFZ4Pid+GTM+Wq12MV/H86xEJptBa6T+p3kgpwLedManBHC2GgNrFpoN2xnrMz9WFWX/8/ygSBkavq2Uv7FdCsLEYLu9LLIvAU0bNRDtzYl+/vXmjpIvuJFYjmI0im6QEYqnIeMsNjXG4vIutIGHijeAG/9EDBozKV5cldkHbLxHh25vT+ZEzbhXlqvpzKJwcEgfNwLAKFeo0/pvEE10XDB+EXRTXtSzJozQKFFAJhMxYkVaCW+E9AL7tMeU8acxidHqzb6lX4691UsDpy/LLRmT+epgW56+5Cw8tB4kMUv6s9lh3eRKbyGs+H/4mQMaYzPTf2OOdokEn+zzgvoD3FqNKk8QqGAXVsqcGdXrT62fSPkR2vROFi68A6se86UxRUk4cajfPyCC4G5wDhD+zNq4jodQ4u4n/m37Lr36n4LIAAsVr02dFi9AiwA81MYs2rm4eDlDNmdMRvEKRHfBwW5DdMNp0jPFZMeARqF/wL4XBfd+EMLBfMzpH5GH6NaW+1vrvMdg+VxDzatk3MXgO3ro3P/DpcC6+Mo4MySJhKJhSR01SGGGp5hPWmrrUgrv3lDnP+HhcI3nt3YqBoVAVTBAQT5iuhTg8nvPtd8ZeYj6w1x6RqGUBrSku7+N1+BaasZvjTk64RoIDlL8brpEcJx3OmY7jLoZsswdtmhfC/G21llXhITOwmvRDDeTTPbyASOa16cF5/A1fZAidJpqju3wYAy9avPR1ya6eNp9K8XYrrtuxlqi+bDKwlfrYdR0RRiKRVTLOH85+ZY7XSmzRpfZBJjaTa81VDcJHpZnZnSQLASGYW9l51ZV/h7eVzTi3Hv6hUsgc/51AqJRTkpbFVLXXszoBL8nBX0u/0jBLT8nH+fJePbrwURT58OY+UieRjd1vs04w0VG5VN2U6MoGZkQzKN/ptz0Q366dxoTGmj7i1NQGHi9GgnquXFYdrCfZBmeb7s0T6yrdlZH5cZuwHFyIJ/kAtGsTg0xH5taAAq44BAk1CPk9KVVbqQzrCUiFdF/6gtlPQ8bHHc1G1W92MXGZ5HEHftyLYs8mbD/9xYRUWkHmlM0zC2ilJlnNgV4bfALpQghxOUoZL7VTqtCHIaQSXm+YUMnpkXybnV+A6xlm2CVy8fn0Xlm2XRa0+zzOa21JWWmixfiPMSCZ7qA4rS93VN3pkpF1s5TonQjisHf7iU9ZGvUPOAKZcR1pbeVf/Ul7OhepGCaId9wOtqo7pJ7yLcBZ0pFkOF28y4zEI/kcUNmutBHaQpBdNM8vjCS6HZRokkeo88TBAjGyG7SR+6vUgTcyK9Imalj0kuxz0wmK+byQU11AiJFk/ya5dNduRClcnU64yGu/ieWSeOos1t3ep+RPIWQ2pyTYVbZltTbsb7NiwSi3AV+8KLWk7LxCnfZUetEM8ThnsSoGH38/nyAwFguJp8FjvlHtcWZuU4hPva0rHfr0UhOOJ/F6vS62FW7KzkmRll2HEc7oUq4fyi5T70Vl7YVIfsPHUCdHesf9Lk7WNVWO75JDkYbMI8TOW8JKVtLY9d6UJRITO8oKo0xS+o99Yy04iniGHAaGj88kEWgwv0OrHdY/nr76DOGNS59hXCGXzTKUvDl9iKpLSWYN1lxIeyywdNpTkhay74w2jFT6NS8qkjo5CxA1yfSYwp6AJIZNKIeEK5PJAW7ORgWgwp0VgzYpqovMrWxbu+DGZ6Lhie1RAqpzm8VUzKJOH3mCzWuTOLsN3VT/dv2eeYe9UjbR8YTBsLz7q60VN1sU51k+um1f8JxD5pPhbhSC8rRaB454tmh6YUWrJI3+GWY0qeWioj/tbkYITOkJaeuGt4JrJvHA+l0Gu7kY7XOaa05alMnRWVCXqFgLIwSY4uF59Ue5SU4QKuc/HamDxbr0x6csCetXGoP7Qn1Bk/J9DsynO/UD6iZ1Hyrz+jit0hDCwi/E9OjgKTbB3ZQKQ/0ZOvevfNHG0NK4Aj3Cp7NpRk07RT1i/S0EL93Ag8GRgKI9CfpajKyK6+Jj/PI1KO5/85VAwz2AwzP8FTBb075IxCXv6T9RVvWT2tUaqxDS92zrGUbWzUYk9mSs82pECH+fkqsDt93VW++4YsR/dHCYcQSYTO/KaBMDj9LSD/J/+z20Kq8XvZUAIHtm9hRPP3ItbuAu2Hm5lkPs92pd7kCxgRs0xOVBnZ13ccdA0aunrwv9SdqElJRC3g+oCu+nXyCgmXUs9yMjTMAIHfxZV+aPKcZeUBWt057Xo85Ks1Ir5gzEHCWqZEhrLZMuF11ziGtFQUds/EESajhagzcKsxamcSZxGth4UII+adPhQkUnx2WyN+4YWR+r3f8MnkyGFuR4zjzxJS8WsQYR5PTyRaD9ixa6Mh741nBHbzfjXHskGDq179xaRNrCIB1z1xRfWfjqw2pHc1zk9xlPpL8sQWAIuETZZhbnmL54rceXVNRvUiKrrqIkeogsl0XXb17ylNb0f4GA9Wd44vffEG8FSZGHEL2fbaTGRcSiCeA8PmA/f6Hz8HCS76fXUHwgwkzSwlI71ekZ7Fapmlk/KC+Hs8hUcw3N2LN5LhkVYyizYFl/uPeVP5lsoJHhhfWvvSWruCUW1ZcJOeuTbrDgywJ/qG07gZJplnTvLcYdNaH0KMYOYMGX+rB4NGPFmQsNaIwlWrfCezxre8zXBrsMT+edVLbLqN1BqB76JH4BvZTqUIMfGwPGEn+EnmTV86fPBaYbFL3DFEhjB45CewkXEAtJxk4/Ms2pPXnaRqdky0HOYdcUcE2zcXq4vaIvW2/v0nHFJH2XXe22ueDmq/18XGtELSq85j9X8q0tcNSSKJIX8FTuJF/Pf8j5PhqG2u+osvsLxYrvvfeVJL+4tkcXcr9JV7v0ERmj/X6fM3NC4j6dS1+9Umr2oPavqiAydTZPLMNRGY23LO9zAVDly7jD+70G5TPPLdhRIl4WxcYjLnM+SNcJ26FOrkrISUtPObIz5Zb3AG612krnpy15RMW+1cQjlnWFI6538qky9axd2oJmHIHP08KyP0ubGO+TQNOYuv2uh17yCIvR8VcStw7o1g0NM60sk+8Tq7YfIBJrtp53GkvzXH7OA0p8/n/u1satf/VJhtR1l8Wa6Gmaug7haSpaCaYQax6ta0mkutlb+eAOSG1aobM81D9A4iS1RRlzBBoVX6tU1S6WE2N9ORY6DfeLRC4l9Rvr5h95XDWB2mR1d4WFudpsgVYwiTwT31ljskD8ZyDOlm5DkGh9N/UB/0AI5Xvb8ZBmai2hQ4BWMqFwYnzxwB26YHSOv9WgY3JXnvoN+2R4rqGVh/LLDMtpFP+SpMGJNWvbIl5SOodbCczW2RKleksPoUeGEzrjtKHVdtZA+kfqO+rVx/iclCqwoopepvJpSTDjT+b9GWylGRF8EDbGlw6eUzmJM95Ovoz+kwLX3c2fTjFeYEsE7vUZm3mqdGJuKh2w9/QGSaqRHs99aScGOdDqkFcACoqdbBoQqqjamhH6Q9ng39JCg3lrGJwd50Qk9ovnqBTr8MME7Ps2wiVfygUmPoUBJJfJWX5Nda0nuncbFkA=="))}const r$1=getData(),VALID=new Set(read_member_array(r$1)),IGNORED=new Set(read_member_array(r$1)),MAPPED=read_mapped_map(r$1),EMOJI_ROOT=read_emoji_trie(r$1),HYPHEN=45,UNDERSCORE=95;function explode_cp(_){return toUtf8CodePoints(_)}function filter_fe0f(_){return _.filter(a=>a!=65039)}function ens_normalize_post_check(_){for(let a of _.split(".")){let $=explode_cp(a);try{for(let j=$.lastIndexOf(UNDERSCORE)-1;j>=0;j--)if($[j]!==UNDERSCORE)throw new Error("underscore only allowed at start");if($.length>=4&&$.every(j=>j<128)&&$[2]===HYPHEN&&$[3]===HYPHEN)throw new Error("invalid label extension")}catch(j){throw new Error(`Invalid label "${a}": ${j.message}`)}}return _}function ens_normalize(_){return ens_normalize_post_check(normalize(_,filter_fe0f))}function normalize(_,a){let $=explode_cp(_).reverse(),j=[];for(;$.length;){let _e=consume_emoji_reversed($);if(_e){j.push(...a(_e));continue}let et=$.pop();if(VALID.has(et)){j.push(et);continue}if(IGNORED.has(et))continue;let tt=MAPPED[et];if(tt){j.push(...tt);continue}throw new Error(`Disallowed codepoint: 0x${et.toString(16).toUpperCase()}`)}return ens_normalize_post_check(nfc(String.fromCodePoint(...j)))}function nfc(_){return _.normalize("NFC")}function consume_emoji_reversed(_,a){var $;let j=EMOJI_ROOT,_e,et,tt=[],rt=_.length;for(a&&(a.length=0);rt;){let nt=_[--rt];if(j=($=j.branches.find(it=>it.set.has(nt)))===null||$===void 0?void 0:$.node,!j)break;if(j.save)et=nt;else if(j.check&&nt===et)break;tt.push(nt),j.fe0f&&(tt.push(65039),rt>0&&_[rt-1]==65039&&rt--),j.valid&&(_e=tt.slice(),j.valid==2&&_e.splice(1,1),a&&a.push(..._.slice(rt).reverse()),_.length=rt)}return _e}const logger$g=new Logger(version$c),Zeros=new Uint8Array(32);Zeros.fill(0);function checkComponent(_){if(_.length===0)throw new Error("invalid ENS name; empty component");return _}function ensNameSplit(_){const a=toUtf8Bytes(ens_normalize(_)),$=[];if(_.length===0)return $;let j=0;for(let _e=0;_e<a.length;_e++)a[_e]===46&&($.push(checkComponent(a.slice(j,_e))),j=_e+1);if(j>=a.length)throw new Error("invalid ENS name; empty component");return $.push(checkComponent(a.slice(j))),$}function namehash(_){typeof _!="string"&&logger$g.throwArgumentError("invalid ENS name; not a string","name",_);let a=Zeros;const $=ensNameSplit(_);for(;$.length;)a=keccak256(concat$3([a,keccak256($.pop())]));return hexlify(a)}function dnsEncode(_){return hexlify(concat$3(ensNameSplit(_).map(a=>{if(a.length>63)throw new Error("invalid DNS encoded entry; length exceeds 63 bytes");const $=new Uint8Array(a.length+1);return $.set(a,1),$[0]=$.length-1,$})))+"00"}var __awaiter$7=globalThis&&globalThis.__awaiter||function(_,a,$,j){function _e(et){return et instanceof $?et:new $(function(tt){tt(et)})}return new($||($=Promise))(function(et,tt){function rt(st){try{it(j.next(st))}catch(ot){tt(ot)}}function nt(st){try{it(j.throw(st))}catch(ot){tt(ot)}}function it(st){st.done?et(st.value):_e(st.value).then(rt,nt)}it((j=j.apply(_,a||[])).next())})};const logger$f=new Logger(version$c),padding=new Uint8Array(32);padding.fill(0);const NegativeOne=BigNumber.from(-1),Zero=BigNumber.from(0),One=BigNumber.from(1),MaxUint256=BigNumber.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function hexPadRight(_){const a=arrayify(_),$=a.length%32;return $?hexConcat([a,padding.slice($)]):hexlify(a)}const hexTrue=hexZeroPad(One.toHexString(),32),hexFalse=hexZeroPad(Zero.toHexString(),32),domainFieldTypes={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},domainFieldNames=["name","version","chainId","verifyingContract","salt"];function checkString(_){return function(a){return typeof a!="string"&&logger$f.throwArgumentError(`invalid domain value for ${JSON.stringify(_)}`,`domain.${_}`,a),a}}const domainChecks={name:checkString("name"),version:checkString("version"),chainId:function(_){try{return BigNumber.from(_).toString()}catch{}return logger$f.throwArgumentError('invalid domain value for "chainId"',"domain.chainId",_)},verifyingContract:function(_){try{return getAddress(_).toLowerCase()}catch{}return logger$f.throwArgumentError('invalid domain value "verifyingContract"',"domain.verifyingContract",_)},salt:function(_){try{const a=arrayify(_);if(a.length!==32)throw new Error("bad length");return hexlify(a)}catch{}return logger$f.throwArgumentError('invalid domain value "salt"',"domain.salt",_)}};function getBaseEncoder(_){{const a=_.match(/^(u?)int(\d*)$/);if(a){const $=a[1]==="",j=parseInt(a[2]||"256");(j%8!==0||j>256||a[2]&&a[2]!==String(j))&&logger$f.throwArgumentError("invalid numeric width","type",_);const _e=MaxUint256.mask($?j-1:j),et=$?_e.add(One).mul(NegativeOne):Zero;return function(tt){const rt=BigNumber.from(tt);return(rt.lt(et)||rt.gt(_e))&&logger$f.throwArgumentError(`value out-of-bounds for ${_}`,"value",tt),hexZeroPad(rt.toTwos(256).toHexString(),32)}}}{const a=_.match(/^bytes(\d+)$/);if(a){const $=parseInt(a[1]);return($===0||$>32||a[1]!==String($))&&logger$f.throwArgumentError("invalid bytes width","type",_),function(j){return arrayify(j).length!==$&&logger$f.throwArgumentError(`invalid length for ${_}`,"value",j),hexPadRight(j)}}}switch(_){case"address":return function(a){return hexZeroPad(getAddress(a),32)};case"bool":return function(a){return a?hexTrue:hexFalse};case"bytes":return function(a){return keccak256(a)};case"string":return function(a){return id(a)}}return null}function encodeType(_,a){return`${_}(${a.map(({name:$,type:j})=>j+" "+$).join(",")})`}class TypedDataEncoder{constructor(a){defineReadOnly(this,"types",Object.freeze(deepCopy(a))),defineReadOnly(this,"_encoderCache",{}),defineReadOnly(this,"_types",{});const $={},j={},_e={};Object.keys(a).forEach(rt=>{$[rt]={},j[rt]=[],_e[rt]={}});for(const rt in a){const nt={};a[rt].forEach(it=>{nt[it.name]&&logger$f.throwArgumentError(`duplicate variable name ${JSON.stringify(it.name)} in ${JSON.stringify(rt)}`,"types",a),nt[it.name]=!0;const st=it.type.match(/^([^\x5b]*)(\x5b|$)/)[1];st===rt&&logger$f.throwArgumentError(`circular type reference to ${JSON.stringify(st)}`,"types",a),!getBaseEncoder(st)&&(j[st]||logger$f.throwArgumentError(`unknown type ${JSON.stringify(st)}`,"types",a),j[st].push(rt),$[rt][st]=!0)})}const et=Object.keys(j).filter(rt=>j[rt].length===0);et.length===0?logger$f.throwArgumentError("missing primary type","types",a):et.length>1&&logger$f.throwArgumentError(`ambiguous primary types or unused types: ${et.map(rt=>JSON.stringify(rt)).join(", ")}`,"types",a),defineReadOnly(this,"primaryType",et[0]);function tt(rt,nt){nt[rt]&&logger$f.throwArgumentError(`circular type reference to ${JSON.stringify(rt)}`,"types",a),nt[rt]=!0,Object.keys($[rt]).forEach(it=>{!j[it]||(tt(it,nt),Object.keys(nt).forEach(st=>{_e[st][it]=!0}))}),delete nt[rt]}tt(this.primaryType,{});for(const rt in _e){const nt=Object.keys(_e[rt]);nt.sort(),this._types[rt]=encodeType(rt,a[rt])+nt.map(it=>encodeType(it,a[it])).join("")}}getEncoder(a){let $=this._encoderCache[a];return $||($=this._encoderCache[a]=this._getEncoder(a)),$}_getEncoder(a){{const _e=getBaseEncoder(a);if(_e)return _e}const $=a.match(/^(.*)(\x5b(\d*)\x5d)$/);if($){const _e=$[1],et=this.getEncoder(_e),tt=parseInt($[3]);return rt=>{tt>=0&&rt.length!==tt&&logger$f.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",rt);let nt=rt.map(et);return this._types[_e]&&(nt=nt.map(keccak256)),keccak256(hexConcat(nt))}}const j=this.types[a];if(j){const _e=id(this._types[a]);return et=>{const tt=j.map(({name:rt,type:nt})=>{const it=this.getEncoder(nt)(et[rt]);return this._types[nt]?keccak256(it):it});return tt.unshift(_e),hexConcat(tt)}}return logger$f.throwArgumentError(`unknown type: ${a}`,"type",a)}encodeType(a){const $=this._types[a];return $||logger$f.throwArgumentError(`unknown type: ${JSON.stringify(a)}`,"name",a),$}encodeData(a,$){return this.getEncoder(a)($)}hashStruct(a,$){return keccak256(this.encodeData(a,$))}encode(a){return this.encodeData(this.primaryType,a)}hash(a){return this.hashStruct(this.primaryType,a)}_visit(a,$,j){if(getBaseEncoder(a))return j(a,$);const _e=a.match(/^(.*)(\x5b(\d*)\x5d)$/);if(_e){const tt=_e[1],rt=parseInt(_e[3]);return rt>=0&&$.length!==rt&&logger$f.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",$),$.map(nt=>this._visit(tt,nt,j))}const et=this.types[a];return et?et.reduce((tt,{name:rt,type:nt})=>(tt[rt]=this._visit(nt,$[rt],j),tt),{}):logger$f.throwArgumentError(`unknown type: ${a}`,"type",a)}visit(a,$){return this._visit(this.primaryType,a,$)}static from(a){return new TypedDataEncoder(a)}static getPrimaryType(a){return TypedDataEncoder.from(a).primaryType}static hashStruct(a,$,j){return TypedDataEncoder.from($).hashStruct(a,j)}static hashDomain(a){const $=[];for(const j in a){const _e=domainFieldTypes[j];_e||logger$f.throwArgumentError(`invalid typed-data domain key: ${JSON.stringify(j)}`,"domain",a),$.push({name:j,type:_e})}return $.sort((j,_e)=>domainFieldNames.indexOf(j.name)-domainFieldNames.indexOf(_e.name)),TypedDataEncoder.hashStruct("EIP712Domain",{EIP712Domain:$},a)}static encode(a,$,j){return hexConcat(["0x1901",TypedDataEncoder.hashDomain(a),TypedDataEncoder.from($).hash(j)])}static hash(a,$,j){return keccak256(TypedDataEncoder.encode(a,$,j))}static resolveNames(a,$,j,_e){return __awaiter$7(this,void 0,void 0,function*(){a=shallowCopy(a);const et={};a.verifyingContract&&!isHexString(a.verifyingContract,20)&&(et[a.verifyingContract]="0x");const tt=TypedDataEncoder.from($);tt.visit(j,(rt,nt)=>(rt==="address"&&!isHexString(nt,20)&&(et[nt]="0x"),nt));for(const rt in et)et[rt]=yield _e(rt);return a.verifyingContract&&et[a.verifyingContract]&&(a.verifyingContract=et[a.verifyingContract]),j=tt.visit(j,(rt,nt)=>rt==="address"&&et[nt]?et[nt]:nt),{domain:a,value:j}})}static getPayload(a,$,j){TypedDataEncoder.hashDomain(a);const _e={},et=[];domainFieldNames.forEach(nt=>{const it=a[nt];it!=null&&(_e[nt]=domainChecks[nt](it),et.push({name:nt,type:domainFieldTypes[nt]}))});const tt=TypedDataEncoder.from($),rt=shallowCopy($);return rt.EIP712Domain?logger$f.throwArgumentError("types must not contain EIP712Domain type","types.EIP712Domain",$):rt.EIP712Domain=et,tt.encode(j),{types:rt,domain:_e,primaryType:tt.primaryType,message:tt.visit(j,(nt,it)=>{if(nt.match(/^bytes(\d*)/))return hexlify(arrayify(it));if(nt.match(/^u?int/))return BigNumber.from(it).toString();switch(nt){case"address":return it.toLowerCase();case"bool":return!!it;case"string":return typeof it!="string"&&logger$f.throwArgumentError("invalid string","value",it),it}return logger$f.throwArgumentError("unsupported type","type",nt)})}}}const logger$e=new Logger(version$g);class LogDescription extends Description{}class TransactionDescription extends Description{}class ErrorDescription extends Description{}class Indexed extends Description{static isIndexed(a){return!!(a&&a._isIndexed)}}const BuiltinErrors={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:!0},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"]}};function wrapAccessError(_,a){const $=new Error(`deferred error during ABI decoding triggered accessing ${_}`);return $.error=a,$}class Interface{constructor(a){let $=[];typeof a=="string"?$=JSON.parse(a):$=a,defineReadOnly(this,"fragments",$.map(j=>Fragment.from(j)).filter(j=>j!=null)),defineReadOnly(this,"_abiCoder",getStatic(new.target,"getAbiCoder")()),defineReadOnly(this,"functions",{}),defineReadOnly(this,"errors",{}),defineReadOnly(this,"events",{}),defineReadOnly(this,"structs",{}),this.fragments.forEach(j=>{let _e=null;switch(j.type){case"constructor":if(this.deploy){logger$e.warn("duplicate definition - constructor");return}defineReadOnly(this,"deploy",j);return;case"function":_e=this.functions;break;case"event":_e=this.events;break;case"error":_e=this.errors;break;default:return}let et=j.format();if(_e[et]){logger$e.warn("duplicate definition - "+et);return}_e[et]=j}),this.deploy||defineReadOnly(this,"deploy",ConstructorFragment.from({payable:!1,type:"constructor"})),defineReadOnly(this,"_isInterface",!0)}format(a){a||(a=FormatTypes.full),a===FormatTypes.sighash&&logger$e.throwArgumentError("interface does not support formatting sighash","format",a);const $=this.fragments.map(j=>j.format(a));return a===FormatTypes.json?JSON.stringify($.map(j=>JSON.parse(j))):$}static getAbiCoder(){return defaultAbiCoder}static getAddress(a){return getAddress(a)}static getSighash(a){return hexDataSlice(id(a.format()),0,4)}static getEventTopic(a){return id(a.format())}getFunction(a){if(isHexString(a)){for(const j in this.functions)if(a===this.getSighash(j))return this.functions[j];logger$e.throwArgumentError("no matching function","sighash",a)}if(a.indexOf("(")===-1){const j=a.trim(),_e=Object.keys(this.functions).filter(et=>et.split("(")[0]===j);return _e.length===0?logger$e.throwArgumentError("no matching function","name",j):_e.length>1&&logger$e.throwArgumentError("multiple matching functions","name",j),this.functions[_e[0]]}const $=this.functions[FunctionFragment.fromString(a).format()];return $||logger$e.throwArgumentError("no matching function","signature",a),$}getEvent(a){if(isHexString(a)){const j=a.toLowerCase();for(const _e in this.events)if(j===this.getEventTopic(_e))return this.events[_e];logger$e.throwArgumentError("no matching event","topichash",j)}if(a.indexOf("(")===-1){const j=a.trim(),_e=Object.keys(this.events).filter(et=>et.split("(")[0]===j);return _e.length===0?logger$e.throwArgumentError("no matching event","name",j):_e.length>1&&logger$e.throwArgumentError("multiple matching events","name",j),this.events[_e[0]]}const $=this.events[EventFragment.fromString(a).format()];return $||logger$e.throwArgumentError("no matching event","signature",a),$}getError(a){if(isHexString(a)){const j=getStatic(this.constructor,"getSighash");for(const _e in this.errors){const et=this.errors[_e];if(a===j(et))return this.errors[_e]}logger$e.throwArgumentError("no matching error","sighash",a)}if(a.indexOf("(")===-1){const j=a.trim(),_e=Object.keys(this.errors).filter(et=>et.split("(")[0]===j);return _e.length===0?logger$e.throwArgumentError("no matching error","name",j):_e.length>1&&logger$e.throwArgumentError("multiple matching errors","name",j),this.errors[_e[0]]}const $=this.errors[FunctionFragment.fromString(a).format()];return $||logger$e.throwArgumentError("no matching error","signature",a),$}getSighash(a){if(typeof a=="string")try{a=this.getFunction(a)}catch($){try{a=this.getError(a)}catch{throw $}}return getStatic(this.constructor,"getSighash")(a)}getEventTopic(a){return typeof a=="string"&&(a=this.getEvent(a)),getStatic(this.constructor,"getEventTopic")(a)}_decodeParams(a,$){return this._abiCoder.decode(a,$)}_encodeParams(a,$){return this._abiCoder.encode(a,$)}encodeDeploy(a){return this._encodeParams(this.deploy.inputs,a||[])}decodeErrorResult(a,$){typeof a=="string"&&(a=this.getError(a));const j=arrayify($);return hexlify(j.slice(0,4))!==this.getSighash(a)&&logger$e.throwArgumentError(`data signature does not match error ${a.name}.`,"data",hexlify(j)),this._decodeParams(a.inputs,j.slice(4))}encodeErrorResult(a,$){return typeof a=="string"&&(a=this.getError(a)),hexlify(concat$3([this.getSighash(a),this._encodeParams(a.inputs,$||[])]))}decodeFunctionData(a,$){typeof a=="string"&&(a=this.getFunction(a));const j=arrayify($);return hexlify(j.slice(0,4))!==this.getSighash(a)&&logger$e.throwArgumentError(`data signature does not match function ${a.name}.`,"data",hexlify(j)),this._decodeParams(a.inputs,j.slice(4))}encodeFunctionData(a,$){return typeof a=="string"&&(a=this.getFunction(a)),hexlify(concat$3([this.getSighash(a),this._encodeParams(a.inputs,$||[])]))}decodeFunctionResult(a,$){typeof a=="string"&&(a=this.getFunction(a));let j=arrayify($),_e=null,et="",tt=null,rt=null,nt=null;switch(j.length%this._abiCoder._getWordSize()){case 0:try{return this._abiCoder.decode(a.outputs,j)}catch{}break;case 4:{const it=hexlify(j.slice(0,4)),st=BuiltinErrors[it];if(st)tt=this._abiCoder.decode(st.inputs,j.slice(4)),rt=st.name,nt=st.signature,st.reason&&(_e=tt[0]),rt==="Error"?et=`; VM Exception while processing transaction: reverted with reason string ${JSON.stringify(tt[0])}`:rt==="Panic"&&(et=`; VM Exception while processing transaction: reverted with panic code ${tt[0]}`);else try{const ot=this.getError(it);tt=this._abiCoder.decode(ot.inputs,j.slice(4)),rt=ot.name,nt=ot.format()}catch{}break}}return logger$e.throwError("call revert exception"+et,Logger.errors.CALL_EXCEPTION,{method:a.format(),data:hexlify($),errorArgs:tt,errorName:rt,errorSignature:nt,reason:_e})}encodeFunctionResult(a,$){return typeof a=="string"&&(a=this.getFunction(a)),hexlify(this._abiCoder.encode(a.outputs,$||[]))}encodeFilterTopics(a,$){typeof a=="string"&&(a=this.getEvent(a)),$.length>a.inputs.length&&logger$e.throwError("too many arguments for "+a.format(),Logger.errors.UNEXPECTED_ARGUMENT,{argument:"values",value:$});let j=[];a.anonymous||j.push(this.getEventTopic(a));const _e=(et,tt)=>et.type==="string"?id(tt):et.type==="bytes"?keccak256(hexlify(tt)):(et.type==="bool"&&typeof tt=="boolean"&&(tt=tt?"0x01":"0x00"),et.type.match(/^u?int/)&&(tt=BigNumber.from(tt).toHexString()),et.type==="address"&&this._abiCoder.encode(["address"],[tt]),hexZeroPad(hexlify(tt),32));for($.forEach((et,tt)=>{let rt=a.inputs[tt];if(!rt.indexed){et!=null&&logger$e.throwArgumentError("cannot filter non-indexed parameters; must be null","contract."+rt.name,et);return}et==null?j.push(null):rt.baseType==="array"||rt.baseType==="tuple"?logger$e.throwArgumentError("filtering with tuples or arrays not supported","contract."+rt.name,et):Array.isArray(et)?j.push(et.map(nt=>_e(rt,nt))):j.push(_e(rt,et))});j.length&&j[j.length-1]===null;)j.pop();return j}encodeEventLog(a,$){typeof a=="string"&&(a=this.getEvent(a));const j=[],_e=[],et=[];return a.anonymous||j.push(this.getEventTopic(a)),$.length!==a.inputs.length&&logger$e.throwArgumentError("event arguments/values mismatch","values",$),a.inputs.forEach((tt,rt)=>{const nt=$[rt];if(tt.indexed)if(tt.type==="string")j.push(id(nt));else if(tt.type==="bytes")j.push(keccak256(nt));else{if(tt.baseType==="tuple"||tt.baseType==="array")throw new Error("not implemented");j.push(this._abiCoder.encode([tt.type],[nt]))}else _e.push(tt),et.push(nt)}),{data:this._abiCoder.encode(_e,et),topics:j}}decodeEventLog(a,$,j){if(typeof a=="string"&&(a=this.getEvent(a)),j!=null&&!a.anonymous){let at=this.getEventTopic(a);(!isHexString(j[0],32)||j[0].toLowerCase()!==at)&&logger$e.throwError("fragment/topic mismatch",Logger.errors.INVALID_ARGUMENT,{argument:"topics[0]",expected:at,value:j[0]}),j=j.slice(1)}let _e=[],et=[],tt=[];a.inputs.forEach((at,lt)=>{at.indexed?at.type==="string"||at.type==="bytes"||at.baseType==="tuple"||at.baseType==="array"?(_e.push(ParamType.fromObject({type:"bytes32",name:at.name})),tt.push(!0)):(_e.push(at),tt.push(!1)):(et.push(at),tt.push(!1))});let rt=j!=null?this._abiCoder.decode(_e,concat$3(j)):null,nt=this._abiCoder.decode(et,$,!0),it=[],st=0,ot=0;a.inputs.forEach((at,lt)=>{if(at.indexed)if(rt==null)it[lt]=new Indexed({_isIndexed:!0,hash:null});else if(tt[lt])it[lt]=new Indexed({_isIndexed:!0,hash:rt[ot++]});else try{it[lt]=rt[ot++]}catch(ct){it[lt]=ct}else try{it[lt]=nt[st++]}catch(ct){it[lt]=ct}if(at.name&&it[at.name]==null){const ct=it[lt];ct instanceof Error?Object.defineProperty(it,at.name,{enumerable:!0,get:()=>{throw wrapAccessError(`property ${JSON.stringify(at.name)}`,ct)}}):it[at.name]=ct}});for(let at=0;at<it.length;at++){const lt=it[at];lt instanceof Error&&Object.defineProperty(it,at,{enumerable:!0,get:()=>{throw wrapAccessError(`index ${at}`,lt)}})}return Object.freeze(it)}parseTransaction(a){let $=this.getFunction(a.data.substring(0,10).toLowerCase());return $?new TransactionDescription({args:this._abiCoder.decode($.inputs,"0x"+a.data.substring(10)),functionFragment:$,name:$.name,signature:$.format(),sighash:this.getSighash($),value:BigNumber.from(a.value||"0")}):null}parseLog(a){let $=this.getEvent(a.topics[0]);return!$||$.anonymous?null:new LogDescription({eventFragment:$,name:$.name,signature:$.format(),topic:this.getEventTopic($),args:this.decodeEventLog($,a.data,a.topics)})}parseError(a){const $=hexlify(a);let j=this.getError($.substring(0,10).toLowerCase());return j?new ErrorDescription({args:this._abiCoder.decode(j.inputs,"0x"+$.substring(10)),errorFragment:j,name:j.name,signature:j.format(),sighash:this.getSighash(j)}):null}static isInterface(a){return!!(a&&a._isInterface)}}const version$b="abstract-provider/5.7.0";var __awaiter$6=globalThis&&globalThis.__awaiter||function(_,a,$,j){function _e(et){return et instanceof $?et:new $(function(tt){tt(et)})}return new($||($=Promise))(function(et,tt){function rt(st){try{it(j.next(st))}catch(ot){tt(ot)}}function nt(st){try{it(j.throw(st))}catch(ot){tt(ot)}}function it(st){st.done?et(st.value):_e(st.value).then(rt,nt)}it((j=j.apply(_,a||[])).next())})};const logger$d=new Logger(version$b);class ForkEvent extends Description{static isForkEvent(a){return!!(a&&a._isForkEvent)}}class Provider$1{constructor(){logger$d.checkAbstract(new.target,Provider$1),defineReadOnly(this,"_isProvider",!0)}getFeeData(){return __awaiter$6(this,void 0,void 0,function*(){const{block:a,gasPrice:$}=yield resolveProperties({block:this.getBlock("latest"),gasPrice:this.getGasPrice().catch(tt=>null)});let j=null,_e=null,et=null;return a&&a.baseFeePerGas&&(j=a.baseFeePerGas,et=BigNumber.from("1500000000"),_e=a.baseFeePerGas.mul(2).add(et)),{lastBaseFeePerGas:j,maxFeePerGas:_e,maxPriorityFeePerGas:et,gasPrice:$}})}addListener(a,$){return this.on(a,$)}removeListener(a,$){return this.off(a,$)}static isProvider(a){return!!(a&&a._isProvider)}}const version$a="abstract-signer/5.7.0";var __awaiter$5=globalThis&&globalThis.__awaiter||function(_,a,$,j){function _e(et){return et instanceof $?et:new $(function(tt){tt(et)})}return new($||($=Promise))(function(et,tt){function rt(st){try{it(j.next(st))}catch(ot){tt(ot)}}function nt(st){try{it(j.throw(st))}catch(ot){tt(ot)}}function it(st){st.done?et(st.value):_e(st.value).then(rt,nt)}it((j=j.apply(_,a||[])).next())})};const logger$c=new Logger(version$a),allowedTransactionKeys$1=["accessList","ccipReadEnabled","chainId","customData","data","from","gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","nonce","to","type","value"],forwardErrors=[Logger.errors.INSUFFICIENT_FUNDS,Logger.errors.NONCE_EXPIRED,Logger.errors.REPLACEMENT_UNDERPRICED];class Signer{constructor(){logger$c.checkAbstract(new.target,Signer),defineReadOnly(this,"_isSigner",!0)}getBalance(a){return __awaiter$5(this,void 0,void 0,function*(){return this._checkProvider("getBalance"),yield this.provider.getBalance(this.getAddress(),a)})}getTransactionCount(a){return __awaiter$5(this,void 0,void 0,function*(){return this._checkProvider("getTransactionCount"),yield this.provider.getTransactionCount(this.getAddress(),a)})}estimateGas(a){return __awaiter$5(this,void 0,void 0,function*(){this._checkProvider("estimateGas");const $=yield resolveProperties(this.checkTransaction(a));return yield this.provider.estimateGas($)})}call(a,$){return __awaiter$5(this,void 0,void 0,function*(){this._checkProvider("call");const j=yield resolveProperties(this.checkTransaction(a));return yield this.provider.call(j,$)})}sendTransaction(a){return __awaiter$5(this,void 0,void 0,function*(){this._checkProvider("sendTransaction");const $=yield this.populateTransaction(a),j=yield this.signTransaction($);return yield this.provider.sendTransaction(j)})}getChainId(){return __awaiter$5(this,void 0,void 0,function*(){return this._checkProvider("getChainId"),(yield this.provider.getNetwork()).chainId})}getGasPrice(){return __awaiter$5(this,void 0,void 0,function*(){return this._checkProvider("getGasPrice"),yield this.provider.getGasPrice()})}getFeeData(){return __awaiter$5(this,void 0,void 0,function*(){return this._checkProvider("getFeeData"),yield this.provider.getFeeData()})}resolveName(a){return __awaiter$5(this,void 0,void 0,function*(){return this._checkProvider("resolveName"),yield this.provider.resolveName(a)})}checkTransaction(a){for(const j in a)allowedTransactionKeys$1.indexOf(j)===-1&&logger$c.throwArgumentError("invalid transaction key: "+j,"transaction",a);const $=shallowCopy(a);return $.from==null?$.from=this.getAddress():$.from=Promise.all([Promise.resolve($.from),this.getAddress()]).then(j=>(j[0].toLowerCase()!==j[1].toLowerCase()&&logger$c.throwArgumentError("from address mismatch","transaction",a),j[0])),$}populateTransaction(a){return __awaiter$5(this,void 0,void 0,function*(){const $=yield resolveProperties(this.checkTransaction(a));$.to!=null&&($.to=Promise.resolve($.to).then(_e=>__awaiter$5(this,void 0,void 0,function*(){if(_e==null)return null;const et=yield this.resolveName(_e);return et==null&&logger$c.throwArgumentError("provided ENS name resolves to null","tx.to",_e),et})),$.to.catch(_e=>{}));const j=$.maxFeePerGas!=null||$.maxPriorityFeePerGas!=null;if($.gasPrice!=null&&($.type===2||j)?logger$c.throwArgumentError("eip-1559 transaction do not support gasPrice","transaction",a):($.type===0||$.type===1)&&j&&logger$c.throwArgumentError("pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","transaction",a),($.type===2||$.type==null)&&$.maxFeePerGas!=null&&$.maxPriorityFeePerGas!=null)$.type=2;else if($.type===0||$.type===1)$.gasPrice==null&&($.gasPrice=this.getGasPrice());else{const _e=yield this.getFeeData();if($.type==null)if(_e.maxFeePerGas!=null&&_e.maxPriorityFeePerGas!=null)if($.type=2,$.gasPrice!=null){const et=$.gasPrice;delete $.gasPrice,$.maxFeePerGas=et,$.maxPriorityFeePerGas=et}else $.maxFeePerGas==null&&($.maxFeePerGas=_e.maxFeePerGas),$.maxPriorityFeePerGas==null&&($.maxPriorityFeePerGas=_e.maxPriorityFeePerGas);else _e.gasPrice!=null?(j&&logger$c.throwError("network does not support EIP-1559",Logger.errors.UNSUPPORTED_OPERATION,{operation:"populateTransaction"}),$.gasPrice==null&&($.gasPrice=_e.gasPrice),$.type=0):logger$c.throwError("failed to get consistent fee data",Logger.errors.UNSUPPORTED_OPERATION,{operation:"signer.getFeeData"});else $.type===2&&($.maxFeePerGas==null&&($.maxFeePerGas=_e.maxFeePerGas),$.maxPriorityFeePerGas==null&&($.maxPriorityFeePerGas=_e.maxPriorityFeePerGas))}return $.nonce==null&&($.nonce=this.getTransactionCount("pending")),$.gasLimit==null&&($.gasLimit=this.estimateGas($).catch(_e=>{if(forwardErrors.indexOf(_e.code)>=0)throw _e;return logger$c.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",Logger.errors.UNPREDICTABLE_GAS_LIMIT,{error:_e,tx:$})})),$.chainId==null?$.chainId=this.getChainId():$.chainId=Promise.all([Promise.resolve($.chainId),this.getChainId()]).then(_e=>(_e[1]!==0&&_e[0]!==_e[1]&&logger$c.throwArgumentError("chainId address mismatch","transaction",a),_e[0])),yield resolveProperties($)})}_checkProvider(a){this.provider||logger$c.throwError("missing provider",Logger.errors.UNSUPPORTED_OPERATION,{operation:a||"_checkProvider"})}static isSigner(a){return!!(a&&a._isSigner)}}class VoidSigner extends Signer{constructor(a,$){super(),defineReadOnly(this,"address",a),defineReadOnly(this,"provider",$||null)}getAddress(){return Promise.resolve(this.address)}_fail(a,$){return Promise.resolve().then(()=>{logger$c.throwError(a,Logger.errors.UNSUPPORTED_OPERATION,{operation:$})})}signMessage(a){return this._fail("VoidSigner cannot sign messages","signMessage")}signTransaction(a){return this._fail("VoidSigner cannot sign transactions","signTransaction")}_signTypedData(a,$,j){return this._fail("VoidSigner cannot sign typed data","signTypedData")}connect(a){return new VoidSigner(this.address,a)}}var hash$4={},utils$b={},minimalisticAssert$1=assert$b;function assert$b(_,a){if(!_)throw new Error(a||"Assertion failed")}assert$b.equal=function(a,$,j){if(a!=$)throw new Error(j||"Assertion failed: "+a+" != "+$)};var inherits_browser$1={exports:{}};typeof Object.create=="function"?inherits_browser$1.exports=function(a,$){$&&(a.super_=$,a.prototype=Object.create($.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser$1.exports=function(a,$){if($){a.super_=$;var j=function(){};j.prototype=$.prototype,a.prototype=new j,a.prototype.constructor=a}};var assert$a=minimalisticAssert$1,inherits=inherits_browser$1.exports;utils$b.inherits=inherits;function isSurrogatePair(_,a){return(_.charCodeAt(a)&64512)!==55296||a<0||a+1>=_.length?!1:(_.charCodeAt(a+1)&64512)===56320}function toArray(_,a){if(Array.isArray(_))return _.slice();if(!_)return[];var $=[];if(typeof _=="string")if(a){if(a==="hex")for(_=_.replace(/[^a-z0-9]+/ig,""),_.length%2!==0&&(_="0"+_),_e=0;_e<_.length;_e+=2)$.push(parseInt(_[_e]+_[_e+1],16))}else for(var j=0,_e=0;_e<_.length;_e++){var et=_.charCodeAt(_e);et<128?$[j++]=et:et<2048?($[j++]=et>>6|192,$[j++]=et&63|128):isSurrogatePair(_,_e)?(et=65536+((et&1023)<<10)+(_.charCodeAt(++_e)&1023),$[j++]=et>>18|240,$[j++]=et>>12&63|128,$[j++]=et>>6&63|128,$[j++]=et&63|128):($[j++]=et>>12|224,$[j++]=et>>6&63|128,$[j++]=et&63|128)}else for(_e=0;_e<_.length;_e++)$[_e]=_[_e]|0;return $}utils$b.toArray=toArray;function toHex(_){for(var a="",$=0;$<_.length;$++)a+=zero2(_[$].toString(16));return a}utils$b.toHex=toHex;function htonl(_){var a=_>>>24|_>>>8&65280|_<<8&16711680|(_&255)<<24;return a>>>0}utils$b.htonl=htonl;function toHex32(_,a){for(var $="",j=0;j<_.length;j++){var _e=_[j];a==="little"&&(_e=htonl(_e)),$+=zero8(_e.toString(16))}return $}utils$b.toHex32=toHex32;function zero2(_){return _.length===1?"0"+_:_}utils$b.zero2=zero2;function zero8(_){return _.length===7?"0"+_:_.length===6?"00"+_:_.length===5?"000"+_:_.length===4?"0000"+_:_.length===3?"00000"+_:_.length===2?"000000"+_:_.length===1?"0000000"+_:_}utils$b.zero8=zero8;function join32(_,a,$,j){var _e=$-a;assert$a(_e%4===0);for(var et=new Array(_e/4),tt=0,rt=a;tt<et.length;tt++,rt+=4){var nt;j==="big"?nt=_[rt]<<24|_[rt+1]<<16|_[rt+2]<<8|_[rt+3]:nt=_[rt+3]<<24|_[rt+2]<<16|_[rt+1]<<8|_[rt],et[tt]=nt>>>0}return et}utils$b.join32=join32;function split32(_,a){for(var $=new Array(_.length*4),j=0,_e=0;j<_.length;j++,_e+=4){var et=_[j];a==="big"?($[_e]=et>>>24,$[_e+1]=et>>>16&255,$[_e+2]=et>>>8&255,$[_e+3]=et&255):($[_e+3]=et>>>24,$[_e+2]=et>>>16&255,$[_e+1]=et>>>8&255,$[_e]=et&255)}return $}utils$b.split32=split32;function rotr32$1(_,a){return _>>>a|_<<32-a}utils$b.rotr32=rotr32$1;function rotl32$2(_,a){return _<<a|_>>>32-a}utils$b.rotl32=rotl32$2;function sum32$3(_,a){return _+a>>>0}utils$b.sum32=sum32$3;function sum32_3$1(_,a,$){return _+a+$>>>0}utils$b.sum32_3=sum32_3$1;function sum32_4$2(_,a,$,j){return _+a+$+j>>>0}utils$b.sum32_4=sum32_4$2;function sum32_5$2(_,a,$,j,_e){return _+a+$+j+_e>>>0}utils$b.sum32_5=sum32_5$2;function sum64$1(_,a,$,j){var _e=_[a],et=_[a+1],tt=j+et>>>0,rt=(tt<j?1:0)+$+_e;_[a]=rt>>>0,_[a+1]=tt}utils$b.sum64=sum64$1;function sum64_hi$1(_,a,$,j){var _e=a+j>>>0,et=(_e<a?1:0)+_+$;return et>>>0}utils$b.sum64_hi=sum64_hi$1;function sum64_lo$1(_,a,$,j){var _e=a+j;return _e>>>0}utils$b.sum64_lo=sum64_lo$1;function sum64_4_hi$1(_,a,$,j,_e,et,tt,rt){var nt=0,it=a;it=it+j>>>0,nt+=it<a?1:0,it=it+et>>>0,nt+=it<et?1:0,it=it+rt>>>0,nt+=it<rt?1:0;var st=_+$+_e+tt+nt;return st>>>0}utils$b.sum64_4_hi=sum64_4_hi$1;function sum64_4_lo$1(_,a,$,j,_e,et,tt,rt){var nt=a+j+et+rt;return nt>>>0}utils$b.sum64_4_lo=sum64_4_lo$1;function sum64_5_hi$1(_,a,$,j,_e,et,tt,rt,nt,it){var st=0,ot=a;ot=ot+j>>>0,st+=ot<a?1:0,ot=ot+et>>>0,st+=ot<et?1:0,ot=ot+rt>>>0,st+=ot<rt?1:0,ot=ot+it>>>0,st+=ot<it?1:0;var at=_+$+_e+tt+nt+st;return at>>>0}utils$b.sum64_5_hi=sum64_5_hi$1;function sum64_5_lo$1(_,a,$,j,_e,et,tt,rt,nt,it){var st=a+j+et+rt+it;return st>>>0}utils$b.sum64_5_lo=sum64_5_lo$1;function rotr64_hi$1(_,a,$){var j=a<<32-$|_>>>$;return j>>>0}utils$b.rotr64_hi=rotr64_hi$1;function rotr64_lo$1(_,a,$){var j=_<<32-$|a>>>$;return j>>>0}utils$b.rotr64_lo=rotr64_lo$1;function shr64_hi$1(_,a,$){return _>>>$}utils$b.shr64_hi=shr64_hi$1;function shr64_lo$1(_,a,$){var j=_<<32-$|a>>>$;return j>>>0}utils$b.shr64_lo=shr64_lo$1;var common$8={},utils$a=utils$b,assert$9=minimalisticAssert$1;function BlockHash$4(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}common$8.BlockHash=BlockHash$4;BlockHash$4.prototype.update=function(a,$){if(a=utils$a.toArray(a,$),this.pending?this.pending=this.pending.concat(a):this.pending=a,this.pendingTotal+=a.length,this.pending.length>=this._delta8){a=this.pending;var j=a.length%this._delta8;this.pending=a.slice(a.length-j,a.length),this.pending.length===0&&(this.pending=null),a=utils$a.join32(a,0,a.length-j,this.endian);for(var _e=0;_e<a.length;_e+=this._delta32)this._update(a,_e,_e+this._delta32)}return this};BlockHash$4.prototype.digest=function(a){return this.update(this._pad()),assert$9(this.pending===null),this._digest(a)};BlockHash$4.prototype._pad=function(){var a=this.pendingTotal,$=this._delta8,j=$-(a+this.padLength)%$,_e=new Array(j+this.padLength);_e[0]=128;for(var et=1;et<j;et++)_e[et]=0;if(a<<=3,this.endian==="big"){for(var tt=8;tt<this.padLength;tt++)_e[et++]=0;_e[et++]=0,_e[et++]=0,_e[et++]=0,_e[et++]=0,_e[et++]=a>>>24&255,_e[et++]=a>>>16&255,_e[et++]=a>>>8&255,_e[et++]=a&255}else for(_e[et++]=a&255,_e[et++]=a>>>8&255,_e[et++]=a>>>16&255,_e[et++]=a>>>24&255,_e[et++]=0,_e[et++]=0,_e[et++]=0,_e[et++]=0,tt=8;tt<this.padLength;tt++)_e[et++]=0;return _e};var sha$3={},common$7={},utils$9=utils$b,rotr32=utils$9.rotr32;function ft_1$1(_,a,$,j){if(_===0)return ch32$1(a,$,j);if(_===1||_===3)return p32(a,$,j);if(_===2)return maj32$1(a,$,j)}common$7.ft_1=ft_1$1;function ch32$1(_,a,$){return _&a^~_&$}common$7.ch32=ch32$1;function maj32$1(_,a,$){return _&a^_&$^a&$}common$7.maj32=maj32$1;function p32(_,a,$){return _^a^$}common$7.p32=p32;function s0_256$1(_){return rotr32(_,2)^rotr32(_,13)^rotr32(_,22)}common$7.s0_256=s0_256$1;function s1_256$1(_){return rotr32(_,6)^rotr32(_,11)^rotr32(_,25)}common$7.s1_256=s1_256$1;function g0_256$1(_){return rotr32(_,7)^rotr32(_,18)^_>>>3}common$7.g0_256=g0_256$1;function g1_256$1(_){return rotr32(_,17)^rotr32(_,19)^_>>>10}common$7.g1_256=g1_256$1;var utils$8=utils$b,common$6=common$8,shaCommon$1=common$7,rotl32$1=utils$8.rotl32,sum32$2=utils$8.sum32,sum32_5$1=utils$8.sum32_5,ft_1=shaCommon$1.ft_1,BlockHash$3=common$6.BlockHash,sha1_K=[1518500249,1859775393,2400959708,3395469782];function SHA1(){if(!(this instanceof SHA1))return new SHA1;BlockHash$3.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}utils$8.inherits(SHA1,BlockHash$3);var _1=SHA1;SHA1.blockSize=512;SHA1.outSize=160;SHA1.hmacStrength=80;SHA1.padLength=64;SHA1.prototype._update=function(a,$){for(var j=this.W,_e=0;_e<16;_e++)j[_e]=a[$+_e];for(;_e<j.length;_e++)j[_e]=rotl32$1(j[_e-3]^j[_e-8]^j[_e-14]^j[_e-16],1);var et=this.h[0],tt=this.h[1],rt=this.h[2],nt=this.h[3],it=this.h[4];for(_e=0;_e<j.length;_e++){var st=~~(_e/20),ot=sum32_5$1(rotl32$1(et,5),ft_1(st,tt,rt,nt),it,j[_e],sha1_K[st]);it=nt,nt=rt,rt=rotl32$1(tt,30),tt=et,et=ot}this.h[0]=sum32$2(this.h[0],et),this.h[1]=sum32$2(this.h[1],tt),this.h[2]=sum32$2(this.h[2],rt),this.h[3]=sum32$2(this.h[3],nt),this.h[4]=sum32$2(this.h[4],it)};SHA1.prototype._digest=function(a){return a==="hex"?utils$8.toHex32(this.h,"big"):utils$8.split32(this.h,"big")};var utils$7=utils$b,common$5=common$8,shaCommon=common$7,assert$8=minimalisticAssert$1,sum32$1=utils$7.sum32,sum32_4$1=utils$7.sum32_4,sum32_5=utils$7.sum32_5,ch32=shaCommon.ch32,maj32=shaCommon.maj32,s0_256=shaCommon.s0_256,s1_256=shaCommon.s1_256,g0_256=shaCommon.g0_256,g1_256=shaCommon.g1_256,BlockHash$2=common$5.BlockHash,sha256_K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function SHA256$1(){if(!(this instanceof SHA256$1))return new SHA256$1;BlockHash$2.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=sha256_K,this.W=new Array(64)}utils$7.inherits(SHA256$1,BlockHash$2);var _256=SHA256$1;SHA256$1.blockSize=512;SHA256$1.outSize=256;SHA256$1.hmacStrength=192;SHA256$1.padLength=64;SHA256$1.prototype._update=function(a,$){for(var j=this.W,_e=0;_e<16;_e++)j[_e]=a[$+_e];for(;_e<j.length;_e++)j[_e]=sum32_4$1(g1_256(j[_e-2]),j[_e-7],g0_256(j[_e-15]),j[_e-16]);var et=this.h[0],tt=this.h[1],rt=this.h[2],nt=this.h[3],it=this.h[4],st=this.h[5],ot=this.h[6],at=this.h[7];for(assert$8(this.k.length===j.length),_e=0;_e<j.length;_e++){var lt=sum32_5(at,s1_256(it),ch32(it,st,ot),this.k[_e],j[_e]),ct=sum32$1(s0_256(et),maj32(et,tt,rt));at=ot,ot=st,st=it,it=sum32$1(nt,lt),nt=rt,rt=tt,tt=et,et=sum32$1(lt,ct)}this.h[0]=sum32$1(this.h[0],et),this.h[1]=sum32$1(this.h[1],tt),this.h[2]=sum32$1(this.h[2],rt),this.h[3]=sum32$1(this.h[3],nt),this.h[4]=sum32$1(this.h[4],it),this.h[5]=sum32$1(this.h[5],st),this.h[6]=sum32$1(this.h[6],ot),this.h[7]=sum32$1(this.h[7],at)};SHA256$1.prototype._digest=function(a){return a==="hex"?utils$7.toHex32(this.h,"big"):utils$7.split32(this.h,"big")};var utils$6=utils$b,SHA256=_256;function SHA224(){if(!(this instanceof SHA224))return new SHA224;SHA256.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}utils$6.inherits(SHA224,SHA256);var _224=SHA224;SHA224.blockSize=512;SHA224.outSize=224;SHA224.hmacStrength=192;SHA224.padLength=64;SHA224.prototype._digest=function(a){return a==="hex"?utils$6.toHex32(this.h.slice(0,7),"big"):utils$6.split32(this.h.slice(0,7),"big")};var utils$5=utils$b,common$4=common$8,assert$7=minimalisticAssert$1,rotr64_hi=utils$5.rotr64_hi,rotr64_lo=utils$5.rotr64_lo,shr64_hi=utils$5.shr64_hi,shr64_lo=utils$5.shr64_lo,sum64=utils$5.sum64,sum64_hi=utils$5.sum64_hi,sum64_lo=utils$5.sum64_lo,sum64_4_hi=utils$5.sum64_4_hi,sum64_4_lo=utils$5.sum64_4_lo,sum64_5_hi=utils$5.sum64_5_hi,sum64_5_lo=utils$5.sum64_5_lo,BlockHash$1=common$4.BlockHash,sha512_K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function SHA512$1(){if(!(this instanceof SHA512$1))return new SHA512$1;BlockHash$1.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=sha512_K,this.W=new Array(160)}utils$5.inherits(SHA512$1,BlockHash$1);var _512=SHA512$1;SHA512$1.blockSize=1024;SHA512$1.outSize=512;SHA512$1.hmacStrength=192;SHA512$1.padLength=128;SHA512$1.prototype._prepareBlock=function(a,$){for(var j=this.W,_e=0;_e<32;_e++)j[_e]=a[$+_e];for(;_e<j.length;_e+=2){var et=g1_512_hi(j[_e-4],j[_e-3]),tt=g1_512_lo(j[_e-4],j[_e-3]),rt=j[_e-14],nt=j[_e-13],it=g0_512_hi(j[_e-30],j[_e-29]),st=g0_512_lo(j[_e-30],j[_e-29]),ot=j[_e-32],at=j[_e-31];j[_e]=sum64_4_hi(et,tt,rt,nt,it,st,ot,at),j[_e+1]=sum64_4_lo(et,tt,rt,nt,it,st,ot,at)}};SHA512$1.prototype._update=function(a,$){this._prepareBlock(a,$);var j=this.W,_e=this.h[0],et=this.h[1],tt=this.h[2],rt=this.h[3],nt=this.h[4],it=this.h[5],st=this.h[6],ot=this.h[7],at=this.h[8],lt=this.h[9],ct=this.h[10],ut=this.h[11],dt=this.h[12],ft=this.h[13],pt=this.h[14],yt=this.h[15];assert$7(this.k.length===j.length);for(var mt=0;mt<j.length;mt+=2){var _t=pt,vt=yt,ht=s1_512_hi(at,lt),St=s1_512_lo(at,lt),It=ch64_hi(at,lt,ct,ut,dt),Lt=ch64_lo(at,lt,ct,ut,dt,ft),Mt=this.k[mt],Kt=this.k[mt+1],kt=j[mt],gt=j[mt+1],Et=sum64_5_hi(_t,vt,ht,St,It,Lt,Mt,Kt,kt,gt),xt=sum64_5_lo(_t,vt,ht,St,It,Lt,Mt,Kt,kt,gt);_t=s0_512_hi(_e,et),vt=s0_512_lo(_e,et),ht=maj64_hi(_e,et,tt,rt,nt),St=maj64_lo(_e,et,tt,rt,nt,it);var Tt=sum64_hi(_t,vt,ht,St),At=sum64_lo(_t,vt,ht,St);pt=dt,yt=ft,dt=ct,ft=ut,ct=at,ut=lt,at=sum64_hi(st,ot,Et,xt),lt=sum64_lo(ot,ot,Et,xt),st=nt,ot=it,nt=tt,it=rt,tt=_e,rt=et,_e=sum64_hi(Et,xt,Tt,At),et=sum64_lo(Et,xt,Tt,At)}sum64(this.h,0,_e,et),sum64(this.h,2,tt,rt),sum64(this.h,4,nt,it),sum64(this.h,6,st,ot),sum64(this.h,8,at,lt),sum64(this.h,10,ct,ut),sum64(this.h,12,dt,ft),sum64(this.h,14,pt,yt)};SHA512$1.prototype._digest=function(a){return a==="hex"?utils$5.toHex32(this.h,"big"):utils$5.split32(this.h,"big")};function ch64_hi(_,a,$,j,_e){var et=_&$^~_&_e;return et<0&&(et+=4294967296),et}function ch64_lo(_,a,$,j,_e,et){var tt=a&j^~a&et;return tt<0&&(tt+=4294967296),tt}function maj64_hi(_,a,$,j,_e){var et=_&$^_&_e^$&_e;return et<0&&(et+=4294967296),et}function maj64_lo(_,a,$,j,_e,et){var tt=a&j^a&et^j&et;return tt<0&&(tt+=4294967296),tt}function s0_512_hi(_,a){var $=rotr64_hi(_,a,28),j=rotr64_hi(a,_,2),_e=rotr64_hi(a,_,7),et=$^j^_e;return et<0&&(et+=4294967296),et}function s0_512_lo(_,a){var $=rotr64_lo(_,a,28),j=rotr64_lo(a,_,2),_e=rotr64_lo(a,_,7),et=$^j^_e;return et<0&&(et+=4294967296),et}function s1_512_hi(_,a){var $=rotr64_hi(_,a,14),j=rotr64_hi(_,a,18),_e=rotr64_hi(a,_,9),et=$^j^_e;return et<0&&(et+=4294967296),et}function s1_512_lo(_,a){var $=rotr64_lo(_,a,14),j=rotr64_lo(_,a,18),_e=rotr64_lo(a,_,9),et=$^j^_e;return et<0&&(et+=4294967296),et}function g0_512_hi(_,a){var $=rotr64_hi(_,a,1),j=rotr64_hi(_,a,8),_e=shr64_hi(_,a,7),et=$^j^_e;return et<0&&(et+=4294967296),et}function g0_512_lo(_,a){var $=rotr64_lo(_,a,1),j=rotr64_lo(_,a,8),_e=shr64_lo(_,a,7),et=$^j^_e;return et<0&&(et+=4294967296),et}function g1_512_hi(_,a){var $=rotr64_hi(_,a,19),j=rotr64_hi(a,_,29),_e=shr64_hi(_,a,6),et=$^j^_e;return et<0&&(et+=4294967296),et}function g1_512_lo(_,a){var $=rotr64_lo(_,a,19),j=rotr64_lo(a,_,29),_e=shr64_lo(_,a,6),et=$^j^_e;return et<0&&(et+=4294967296),et}var utils$4=utils$b,SHA512=_512;function SHA384(){if(!(this instanceof SHA384))return new SHA384;SHA512.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}utils$4.inherits(SHA384,SHA512);var _384=SHA384;SHA384.blockSize=1024;SHA384.outSize=384;SHA384.hmacStrength=192;SHA384.padLength=128;SHA384.prototype._digest=function(a){return a==="hex"?utils$4.toHex32(this.h.slice(0,12),"big"):utils$4.split32(this.h.slice(0,12),"big")};sha$3.sha1=_1;sha$3.sha224=_224;sha$3.sha256=_256;sha$3.sha384=_384;sha$3.sha512=_512;var ripemd={},utils$3=utils$b,common$3=common$8,rotl32=utils$3.rotl32,sum32=utils$3.sum32,sum32_3=utils$3.sum32_3,sum32_4=utils$3.sum32_4,BlockHash=common$3.BlockHash;function RIPEMD160(){if(!(this instanceof RIPEMD160))return new RIPEMD160;BlockHash.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}utils$3.inherits(RIPEMD160,BlockHash);ripemd.ripemd160=RIPEMD160;RIPEMD160.blockSize=512;RIPEMD160.outSize=160;RIPEMD160.hmacStrength=192;RIPEMD160.padLength=64;RIPEMD160.prototype._update=function(a,$){for(var j=this.h[0],_e=this.h[1],et=this.h[2],tt=this.h[3],rt=this.h[4],nt=j,it=_e,st=et,ot=tt,at=rt,lt=0;lt<80;lt++){var ct=sum32(rotl32(sum32_4(j,f(lt,_e,et,tt),a[r[lt]+$],K$1(lt)),s$2[lt]),rt);j=rt,rt=tt,tt=rotl32(et,10),et=_e,_e=ct,ct=sum32(rotl32(sum32_4(nt,f(79-lt,it,st,ot),a[rh[lt]+$],Kh(lt)),sh[lt]),at),nt=at,at=ot,ot=rotl32(st,10),st=it,it=ct}ct=sum32_3(this.h[1],et,ot),this.h[1]=sum32_3(this.h[2],tt,at),this.h[2]=sum32_3(this.h[3],rt,nt),this.h[3]=sum32_3(this.h[4],j,it),this.h[4]=sum32_3(this.h[0],_e,st),this.h[0]=ct};RIPEMD160.prototype._digest=function(a){return a==="hex"?utils$3.toHex32(this.h,"little"):utils$3.split32(this.h,"little")};function f(_,a,$,j){return _<=15?a^$^j:_<=31?a&$|~a&j:_<=47?(a|~$)^j:_<=63?a&j|$&~j:a^($|~j)}function K$1(_){return _<=15?0:_<=31?1518500249:_<=47?1859775393:_<=63?2400959708:2840853838}function Kh(_){return _<=15?1352829926:_<=31?1548603684:_<=47?1836072691:_<=63?2053994217:0}var r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],rh=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],s$2=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sh=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],utils$2=utils$b,assert$6=minimalisticAssert$1;function Hmac(_,a,$){if(!(this instanceof Hmac))return new Hmac(_,a,$);this.Hash=_,this.blockSize=_.blockSize/8,this.outSize=_.outSize/8,this.inner=null,this.outer=null,this._init(utils$2.toArray(a,$))}var hmac$3=Hmac;Hmac.prototype._init=function(a){a.length>this.blockSize&&(a=new this.Hash().update(a).digest()),assert$6(a.length<=this.blockSize);for(var $=a.length;$<this.blockSize;$++)a.push(0);for($=0;$<a.length;$++)a[$]^=54;for(this.inner=new this.Hash().update(a),$=0;$<a.length;$++)a[$]^=106;this.outer=new this.Hash().update(a)};Hmac.prototype.update=function(a,$){return this.inner.update(a,$),this};Hmac.prototype.digest=function(a){return this.outer.update(this.inner.digest()),this.outer.digest(a)};(function(_){var a=_;a.utils=utils$b,a.common=common$8,a.sha=sha$3,a.ripemd=ripemd,a.hmac=hmac$3,a.sha1=a.sha.sha1,a.sha256=a.sha.sha256,a.sha224=a.sha.sha224,a.sha384=a.sha.sha384,a.sha512=a.sha.sha512,a.ripemd160=a.ripemd.ripemd160})(hash$4);const hash$3=hash$4;function createCommonjsModule(_,a,$){return $={path:a,exports:{},require:function(j,_e){return commonjsRequire$1(j,_e??$.path)}},_($,$.exports),$.exports}function commonjsRequire$1(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var minimalisticAssert=assert;function assert(_,a){if(!_)throw new Error(a||"Assertion failed")}assert.equal=function(a,$,j){if(a!=$)throw new Error(j||"Assertion failed: "+a+" != "+$)};var utils_1=createCommonjsModule(function(_,a){var $=a;function j(tt,rt){if(Array.isArray(tt))return tt.slice();if(!tt)return[];var nt=[];if(typeof tt!="string"){for(var it=0;it<tt.length;it++)nt[it]=tt[it]|0;return nt}if(rt==="hex"){tt=tt.replace(/[^a-z0-9]+/ig,""),tt.length%2!==0&&(tt="0"+tt);for(var it=0;it<tt.length;it+=2)nt.push(parseInt(tt[it]+tt[it+1],16))}else for(var it=0;it<tt.length;it++){var st=tt.charCodeAt(it),ot=st>>8,at=st&255;ot?nt.push(ot,at):nt.push(at)}return nt}$.toArray=j;function _e(tt){return tt.length===1?"0"+tt:tt}$.zero2=_e;function et(tt){for(var rt="",nt=0;nt<tt.length;nt++)rt+=_e(tt[nt].toString(16));return rt}$.toHex=et,$.encode=function(rt,nt){return nt==="hex"?et(rt):rt}}),utils_1$1=createCommonjsModule(function(_,a){var $=a;$.assert=minimalisticAssert,$.toArray=utils_1.toArray,$.zero2=utils_1.zero2,$.toHex=utils_1.toHex,$.encode=utils_1.encode;function j(nt,it,st){var ot=new Array(Math.max(nt.bitLength(),st)+1);ot.fill(0);for(var at=1<<it+1,lt=nt.clone(),ct=0;ct<ot.length;ct++){var ut,dt=lt.andln(at-1);lt.isOdd()?(dt>(at>>1)-1?ut=(at>>1)-dt:ut=dt,lt.isubn(ut)):ut=0,ot[ct]=ut,lt.iushrn(1)}return ot}$.getNAF=j;function _e(nt,it){var st=[[],[]];nt=nt.clone(),it=it.clone();for(var ot=0,at=0,lt;nt.cmpn(-ot)>0||it.cmpn(-at)>0;){var ct=nt.andln(3)+ot&3,ut=it.andln(3)+at&3;ct===3&&(ct=-1),ut===3&&(ut=-1);var dt;(ct&1)===0?dt=0:(lt=nt.andln(7)+ot&7,(lt===3||lt===5)&&ut===2?dt=-ct:dt=ct),st[0].push(dt);var ft;(ut&1)===0?ft=0:(lt=it.andln(7)+at&7,(lt===3||lt===5)&&ct===2?ft=-ut:ft=ut),st[1].push(ft),2*ot===dt+1&&(ot=1-ot),2*at===ft+1&&(at=1-at),nt.iushrn(1),it.iushrn(1)}return st}$.getJSF=_e;function et(nt,it,st){var ot="_"+it;nt.prototype[it]=function(){return this[ot]!==void 0?this[ot]:this[ot]=st.call(this)}}$.cachedProperty=et;function tt(nt){return typeof nt=="string"?$.toArray(nt,"hex"):nt}$.parseBytes=tt;function rt(nt){return new BN$1(nt,"hex","le")}$.intFromLE=rt}),getNAF=utils_1$1.getNAF,getJSF=utils_1$1.getJSF,assert$1=utils_1$1.assert;function BaseCurve(_,a){this.type=_,this.p=new BN$1(a.p,16),this.red=a.prime?BN$1.red(a.prime):BN$1.mont(this.p),this.zero=new BN$1(0).toRed(this.red),this.one=new BN$1(1).toRed(this.red),this.two=new BN$1(2).toRed(this.red),this.n=a.n&&new BN$1(a.n,16),this.g=a.g&&this.pointFromJSON(a.g,a.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var $=this.n&&this.p.div(this.n);!$||$.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var base$4=BaseCurve;BaseCurve.prototype.point=function(){throw new Error("Not implemented")};BaseCurve.prototype.validate=function(){throw new Error("Not implemented")};BaseCurve.prototype._fixedNafMul=function(a,$){assert$1(a.precomputed);var j=a._getDoubles(),_e=getNAF($,1,this._bitLength),et=(1<<j.step+1)-(j.step%2===0?2:1);et/=3;var tt=[],rt,nt;for(rt=0;rt<_e.length;rt+=j.step){nt=0;for(var it=rt+j.step-1;it>=rt;it--)nt=(nt<<1)+_e[it];tt.push(nt)}for(var st=this.jpoint(null,null,null),ot=this.jpoint(null,null,null),at=et;at>0;at--){for(rt=0;rt<tt.length;rt++)nt=tt[rt],nt===at?ot=ot.mixedAdd(j.points[rt]):nt===-at&&(ot=ot.mixedAdd(j.points[rt].neg()));st=st.add(ot)}return st.toP()};BaseCurve.prototype._wnafMul=function(a,$){var j=4,_e=a._getNAFPoints(j);j=_e.wnd;for(var et=_e.points,tt=getNAF($,j,this._bitLength),rt=this.jpoint(null,null,null),nt=tt.length-1;nt>=0;nt--){for(var it=0;nt>=0&&tt[nt]===0;nt--)it++;if(nt>=0&&it++,rt=rt.dblp(it),nt<0)break;var st=tt[nt];assert$1(st!==0),a.type==="affine"?st>0?rt=rt.mixedAdd(et[st-1>>1]):rt=rt.mixedAdd(et[-st-1>>1].neg()):st>0?rt=rt.add(et[st-1>>1]):rt=rt.add(et[-st-1>>1].neg())}return a.type==="affine"?rt.toP():rt};BaseCurve.prototype._wnafMulAdd=function(a,$,j,_e,et){var tt=this._wnafT1,rt=this._wnafT2,nt=this._wnafT3,it=0,st,ot,at;for(st=0;st<_e;st++){at=$[st];var lt=at._getNAFPoints(a);tt[st]=lt.wnd,rt[st]=lt.points}for(st=_e-1;st>=1;st-=2){var ct=st-1,ut=st;if(tt[ct]!==1||tt[ut]!==1){nt[ct]=getNAF(j[ct],tt[ct],this._bitLength),nt[ut]=getNAF(j[ut],tt[ut],this._bitLength),it=Math.max(nt[ct].length,it),it=Math.max(nt[ut].length,it);continue}var dt=[$[ct],null,null,$[ut]];$[ct].y.cmp($[ut].y)===0?(dt[1]=$[ct].add($[ut]),dt[2]=$[ct].toJ().mixedAdd($[ut].neg())):$[ct].y.cmp($[ut].y.redNeg())===0?(dt[1]=$[ct].toJ().mixedAdd($[ut]),dt[2]=$[ct].add($[ut].neg())):(dt[1]=$[ct].toJ().mixedAdd($[ut]),dt[2]=$[ct].toJ().mixedAdd($[ut].neg()));var ft=[-3,-1,-5,-7,0,7,5,1,3],pt=getJSF(j[ct],j[ut]);for(it=Math.max(pt[0].length,it),nt[ct]=new Array(it),nt[ut]=new Array(it),ot=0;ot<it;ot++){var yt=pt[0][ot]|0,mt=pt[1][ot]|0;nt[ct][ot]=ft[(yt+1)*3+(mt+1)],nt[ut][ot]=0,rt[ct]=dt}}var _t=this.jpoint(null,null,null),vt=this._wnafT4;for(st=it;st>=0;st--){for(var ht=0;st>=0;){var St=!0;for(ot=0;ot<_e;ot++)vt[ot]=nt[ot][st]|0,vt[ot]!==0&&(St=!1);if(!St)break;ht++,st--}if(st>=0&&ht++,_t=_t.dblp(ht),st<0)break;for(ot=0;ot<_e;ot++){var It=vt[ot];It!==0&&(It>0?at=rt[ot][It-1>>1]:It<0&&(at=rt[ot][-It-1>>1].neg()),at.type==="affine"?_t=_t.mixedAdd(at):_t=_t.add(at))}}for(st=0;st<_e;st++)rt[st]=null;return et?_t:_t.toP()};function BasePoint(_,a){this.curve=_,this.type=a,this.precomputed=null}BaseCurve.BasePoint=BasePoint;BasePoint.prototype.eq=function(){throw new Error("Not implemented")};BasePoint.prototype.validate=function(){return this.curve.validate(this)};BaseCurve.prototype.decodePoint=function(a,$){a=utils_1$1.toArray(a,$);var j=this.p.byteLength();if((a[0]===4||a[0]===6||a[0]===7)&&a.length-1===2*j){a[0]===6?assert$1(a[a.length-1]%2===0):a[0]===7&&assert$1(a[a.length-1]%2===1);var _e=this.point(a.slice(1,1+j),a.slice(1+j,1+2*j));return _e}else if((a[0]===2||a[0]===3)&&a.length-1===j)return this.pointFromX(a.slice(1,1+j),a[0]===3);throw new Error("Unknown point format")};BasePoint.prototype.encodeCompressed=function(a){return this.encode(a,!0)};BasePoint.prototype._encode=function(a){var $=this.curve.p.byteLength(),j=this.getX().toArray("be",$);return a?[this.getY().isEven()?2:3].concat(j):[4].concat(j,this.getY().toArray("be",$))};BasePoint.prototype.encode=function(a,$){return utils_1$1.encode(this._encode($),a)};BasePoint.prototype.precompute=function(a){if(this.precomputed)return this;var $={doubles:null,naf:null,beta:null};return $.naf=this._getNAFPoints(8),$.doubles=this._getDoubles(4,a),$.beta=this._getBeta(),this.precomputed=$,this};BasePoint.prototype._hasDoubles=function(a){if(!this.precomputed)return!1;var $=this.precomputed.doubles;return $?$.points.length>=Math.ceil((a.bitLength()+1)/$.step):!1};BasePoint.prototype._getDoubles=function(a,$){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var j=[this],_e=this,et=0;et<$;et+=a){for(var tt=0;tt<a;tt++)_e=_e.dbl();j.push(_e)}return{step:a,points:j}};BasePoint.prototype._getNAFPoints=function(a){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var $=[this],j=(1<<a)-1,_e=j===1?null:this.dbl(),et=1;et<j;et++)$[et]=$[et-1].add(_e);return{wnd:a,points:$}};BasePoint.prototype._getBeta=function(){return null};BasePoint.prototype.dblp=function(a){for(var $=this,j=0;j<a;j++)$=$.dbl();return $};var inherits_browser=createCommonjsModule(function(_){typeof Object.create=="function"?_.exports=function($,j){j&&($.super_=j,$.prototype=Object.create(j.prototype,{constructor:{value:$,enumerable:!1,writable:!0,configurable:!0}}))}:_.exports=function($,j){if(j){$.super_=j;var _e=function(){};_e.prototype=j.prototype,$.prototype=new _e,$.prototype.constructor=$}}}),assert$2=utils_1$1.assert;function ShortCurve(_){base$4.call(this,"short",_),this.a=new BN$1(_.a,16).toRed(this.red),this.b=new BN$1(_.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(_),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}inherits_browser(ShortCurve,base$4);var short_1=ShortCurve;ShortCurve.prototype._getEndomorphism=function(a){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var $,j;if(a.beta)$=new BN$1(a.beta,16).toRed(this.red);else{var _e=this._getEndoRoots(this.p);$=_e[0].cmp(_e[1])<0?_e[0]:_e[1],$=$.toRed(this.red)}if(a.lambda)j=new BN$1(a.lambda,16);else{var et=this._getEndoRoots(this.n);this.g.mul(et[0]).x.cmp(this.g.x.redMul($))===0?j=et[0]:(j=et[1],assert$2(this.g.mul(j).x.cmp(this.g.x.redMul($))===0))}var tt;return a.basis?tt=a.basis.map(function(rt){return{a:new BN$1(rt.a,16),b:new BN$1(rt.b,16)}}):tt=this._getEndoBasis(j),{beta:$,lambda:j,basis:tt}}};ShortCurve.prototype._getEndoRoots=function(a){var $=a===this.p?this.red:BN$1.mont(a),j=new BN$1(2).toRed($).redInvm(),_e=j.redNeg(),et=new BN$1(3).toRed($).redNeg().redSqrt().redMul(j),tt=_e.redAdd(et).fromRed(),rt=_e.redSub(et).fromRed();return[tt,rt]};ShortCurve.prototype._getEndoBasis=function(a){for(var $=this.n.ushrn(Math.floor(this.n.bitLength()/2)),j=a,_e=this.n.clone(),et=new BN$1(1),tt=new BN$1(0),rt=new BN$1(0),nt=new BN$1(1),it,st,ot,at,lt,ct,ut,dt=0,ft,pt;j.cmpn(0)!==0;){var yt=_e.div(j);ft=_e.sub(yt.mul(j)),pt=rt.sub(yt.mul(et));var mt=nt.sub(yt.mul(tt));if(!ot&&ft.cmp($)<0)it=ut.neg(),st=et,ot=ft.neg(),at=pt;else if(ot&&++dt===2)break;ut=ft,_e=j,j=ft,rt=et,et=pt,nt=tt,tt=mt}lt=ft.neg(),ct=pt;var _t=ot.sqr().add(at.sqr()),vt=lt.sqr().add(ct.sqr());return vt.cmp(_t)>=0&&(lt=it,ct=st),ot.negative&&(ot=ot.neg(),at=at.neg()),lt.negative&&(lt=lt.neg(),ct=ct.neg()),[{a:ot,b:at},{a:lt,b:ct}]};ShortCurve.prototype._endoSplit=function(a){var $=this.endo.basis,j=$[0],_e=$[1],et=_e.b.mul(a).divRound(this.n),tt=j.b.neg().mul(a).divRound(this.n),rt=et.mul(j.a),nt=tt.mul(_e.a),it=et.mul(j.b),st=tt.mul(_e.b),ot=a.sub(rt).sub(nt),at=it.add(st).neg();return{k1:ot,k2:at}};ShortCurve.prototype.pointFromX=function(a,$){a=new BN$1(a,16),a.red||(a=a.toRed(this.red));var j=a.redSqr().redMul(a).redIAdd(a.redMul(this.a)).redIAdd(this.b),_e=j.redSqrt();if(_e.redSqr().redSub(j).cmp(this.zero)!==0)throw new Error("invalid point");var et=_e.fromRed().isOdd();return($&&!et||!$&&et)&&(_e=_e.redNeg()),this.point(a,_e)};ShortCurve.prototype.validate=function(a){if(a.inf)return!0;var $=a.x,j=a.y,_e=this.a.redMul($),et=$.redSqr().redMul($).redIAdd(_e).redIAdd(this.b);return j.redSqr().redISub(et).cmpn(0)===0};ShortCurve.prototype._endoWnafMulAdd=function(a,$,j){for(var _e=this._endoWnafT1,et=this._endoWnafT2,tt=0;tt<a.length;tt++){var rt=this._endoSplit($[tt]),nt=a[tt],it=nt._getBeta();rt.k1.negative&&(rt.k1.ineg(),nt=nt.neg(!0)),rt.k2.negative&&(rt.k2.ineg(),it=it.neg(!0)),_e[tt*2]=nt,_e[tt*2+1]=it,et[tt*2]=rt.k1,et[tt*2+1]=rt.k2}for(var st=this._wnafMulAdd(1,_e,et,tt*2,j),ot=0;ot<tt*2;ot++)_e[ot]=null,et[ot]=null;return st};function Point$2(_,a,$,j){base$4.BasePoint.call(this,_,"affine"),a===null&&$===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new BN$1(a,16),this.y=new BN$1($,16),j&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}inherits_browser(Point$2,base$4.BasePoint);ShortCurve.prototype.point=function(a,$,j){return new Point$2(this,a,$,j)};ShortCurve.prototype.pointFromJSON=function(a,$){return Point$2.fromJSON(this,a,$)};Point$2.prototype._getBeta=function(){if(!!this.curve.endo){var a=this.precomputed;if(a&&a.beta)return a.beta;var $=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(a){var j=this.curve,_e=function(et){return j.point(et.x.redMul(j.endo.beta),et.y)};a.beta=$,$.precomputed={beta:null,naf:a.naf&&{wnd:a.naf.wnd,points:a.naf.points.map(_e)},doubles:a.doubles&&{step:a.doubles.step,points:a.doubles.points.map(_e)}}}return $}};Point$2.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Point$2.fromJSON=function(a,$,j){typeof $=="string"&&($=JSON.parse($));var _e=a.point($[0],$[1],j);if(!$[2])return _e;function et(rt){return a.point(rt[0],rt[1],j)}var tt=$[2];return _e.precomputed={beta:null,doubles:tt.doubles&&{step:tt.doubles.step,points:[_e].concat(tt.doubles.points.map(et))},naf:tt.naf&&{wnd:tt.naf.wnd,points:[_e].concat(tt.naf.points.map(et))}},_e};Point$2.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Point$2.prototype.isInfinity=function(){return this.inf};Point$2.prototype.add=function(a){if(this.inf)return a;if(a.inf)return this;if(this.eq(a))return this.dbl();if(this.neg().eq(a))return this.curve.point(null,null);if(this.x.cmp(a.x)===0)return this.curve.point(null,null);var $=this.y.redSub(a.y);$.cmpn(0)!==0&&($=$.redMul(this.x.redSub(a.x).redInvm()));var j=$.redSqr().redISub(this.x).redISub(a.x),_e=$.redMul(this.x.redSub(j)).redISub(this.y);return this.curve.point(j,_e)};Point$2.prototype.dbl=function(){if(this.inf)return this;var a=this.y.redAdd(this.y);if(a.cmpn(0)===0)return this.curve.point(null,null);var $=this.curve.a,j=this.x.redSqr(),_e=a.redInvm(),et=j.redAdd(j).redIAdd(j).redIAdd($).redMul(_e),tt=et.redSqr().redISub(this.x.redAdd(this.x)),rt=et.redMul(this.x.redSub(tt)).redISub(this.y);return this.curve.point(tt,rt)};Point$2.prototype.getX=function(){return this.x.fromRed()};Point$2.prototype.getY=function(){return this.y.fromRed()};Point$2.prototype.mul=function(a){return a=new BN$1(a,16),this.isInfinity()?this:this._hasDoubles(a)?this.curve._fixedNafMul(this,a):this.curve.endo?this.curve._endoWnafMulAdd([this],[a]):this.curve._wnafMul(this,a)};Point$2.prototype.mulAdd=function(a,$,j){var _e=[this,$],et=[a,j];return this.curve.endo?this.curve._endoWnafMulAdd(_e,et):this.curve._wnafMulAdd(1,_e,et,2)};Point$2.prototype.jmulAdd=function(a,$,j){var _e=[this,$],et=[a,j];return this.curve.endo?this.curve._endoWnafMulAdd(_e,et,!0):this.curve._wnafMulAdd(1,_e,et,2,!0)};Point$2.prototype.eq=function(a){return this===a||this.inf===a.inf&&(this.inf||this.x.cmp(a.x)===0&&this.y.cmp(a.y)===0)};Point$2.prototype.neg=function(a){if(this.inf)return this;var $=this.curve.point(this.x,this.y.redNeg());if(a&&this.precomputed){var j=this.precomputed,_e=function(et){return et.neg()};$.precomputed={naf:j.naf&&{wnd:j.naf.wnd,points:j.naf.points.map(_e)},doubles:j.doubles&&{step:j.doubles.step,points:j.doubles.points.map(_e)}}}return $};Point$2.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var a=this.curve.jpoint(this.x,this.y,this.curve.one);return a};function JPoint(_,a,$,j){base$4.BasePoint.call(this,_,"jacobian"),a===null&&$===null&&j===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new BN$1(0)):(this.x=new BN$1(a,16),this.y=new BN$1($,16),this.z=new BN$1(j,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}inherits_browser(JPoint,base$4.BasePoint);ShortCurve.prototype.jpoint=function(a,$,j){return new JPoint(this,a,$,j)};JPoint.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var a=this.z.redInvm(),$=a.redSqr(),j=this.x.redMul($),_e=this.y.redMul($).redMul(a);return this.curve.point(j,_e)};JPoint.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};JPoint.prototype.add=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;var $=a.z.redSqr(),j=this.z.redSqr(),_e=this.x.redMul($),et=a.x.redMul(j),tt=this.y.redMul($.redMul(a.z)),rt=a.y.redMul(j.redMul(this.z)),nt=_e.redSub(et),it=tt.redSub(rt);if(nt.cmpn(0)===0)return it.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var st=nt.redSqr(),ot=st.redMul(nt),at=_e.redMul(st),lt=it.redSqr().redIAdd(ot).redISub(at).redISub(at),ct=it.redMul(at.redISub(lt)).redISub(tt.redMul(ot)),ut=this.z.redMul(a.z).redMul(nt);return this.curve.jpoint(lt,ct,ut)};JPoint.prototype.mixedAdd=function(a){if(this.isInfinity())return a.toJ();if(a.isInfinity())return this;var $=this.z.redSqr(),j=this.x,_e=a.x.redMul($),et=this.y,tt=a.y.redMul($).redMul(this.z),rt=j.redSub(_e),nt=et.redSub(tt);if(rt.cmpn(0)===0)return nt.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var it=rt.redSqr(),st=it.redMul(rt),ot=j.redMul(it),at=nt.redSqr().redIAdd(st).redISub(ot).redISub(ot),lt=nt.redMul(ot.redISub(at)).redISub(et.redMul(st)),ct=this.z.redMul(rt);return this.curve.jpoint(at,lt,ct)};JPoint.prototype.dblp=function(a){if(a===0)return this;if(this.isInfinity())return this;if(!a)return this.dbl();var $;if(this.curve.zeroA||this.curve.threeA){var j=this;for($=0;$<a;$++)j=j.dbl();return j}var _e=this.curve.a,et=this.curve.tinv,tt=this.x,rt=this.y,nt=this.z,it=nt.redSqr().redSqr(),st=rt.redAdd(rt);for($=0;$<a;$++){var ot=tt.redSqr(),at=st.redSqr(),lt=at.redSqr(),ct=ot.redAdd(ot).redIAdd(ot).redIAdd(_e.redMul(it)),ut=tt.redMul(at),dt=ct.redSqr().redISub(ut.redAdd(ut)),ft=ut.redISub(dt),pt=ct.redMul(ft);pt=pt.redIAdd(pt).redISub(lt);var yt=st.redMul(nt);$+1<a&&(it=it.redMul(lt)),tt=dt,nt=yt,st=pt}return this.curve.jpoint(tt,st.redMul(et),nt)};JPoint.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};JPoint.prototype._zeroDbl=function(){var a,$,j;if(this.zOne){var _e=this.x.redSqr(),et=this.y.redSqr(),tt=et.redSqr(),rt=this.x.redAdd(et).redSqr().redISub(_e).redISub(tt);rt=rt.redIAdd(rt);var nt=_e.redAdd(_e).redIAdd(_e),it=nt.redSqr().redISub(rt).redISub(rt),st=tt.redIAdd(tt);st=st.redIAdd(st),st=st.redIAdd(st),a=it,$=nt.redMul(rt.redISub(it)).redISub(st),j=this.y.redAdd(this.y)}else{var ot=this.x.redSqr(),at=this.y.redSqr(),lt=at.redSqr(),ct=this.x.redAdd(at).redSqr().redISub(ot).redISub(lt);ct=ct.redIAdd(ct);var ut=ot.redAdd(ot).redIAdd(ot),dt=ut.redSqr(),ft=lt.redIAdd(lt);ft=ft.redIAdd(ft),ft=ft.redIAdd(ft),a=dt.redISub(ct).redISub(ct),$=ut.redMul(ct.redISub(a)).redISub(ft),j=this.y.redMul(this.z),j=j.redIAdd(j)}return this.curve.jpoint(a,$,j)};JPoint.prototype._threeDbl=function(){var a,$,j;if(this.zOne){var _e=this.x.redSqr(),et=this.y.redSqr(),tt=et.redSqr(),rt=this.x.redAdd(et).redSqr().redISub(_e).redISub(tt);rt=rt.redIAdd(rt);var nt=_e.redAdd(_e).redIAdd(_e).redIAdd(this.curve.a),it=nt.redSqr().redISub(rt).redISub(rt);a=it;var st=tt.redIAdd(tt);st=st.redIAdd(st),st=st.redIAdd(st),$=nt.redMul(rt.redISub(it)).redISub(st),j=this.y.redAdd(this.y)}else{var ot=this.z.redSqr(),at=this.y.redSqr(),lt=this.x.redMul(at),ct=this.x.redSub(ot).redMul(this.x.redAdd(ot));ct=ct.redAdd(ct).redIAdd(ct);var ut=lt.redIAdd(lt);ut=ut.redIAdd(ut);var dt=ut.redAdd(ut);a=ct.redSqr().redISub(dt),j=this.y.redAdd(this.z).redSqr().redISub(at).redISub(ot);var ft=at.redSqr();ft=ft.redIAdd(ft),ft=ft.redIAdd(ft),ft=ft.redIAdd(ft),$=ct.redMul(ut.redISub(a)).redISub(ft)}return this.curve.jpoint(a,$,j)};JPoint.prototype._dbl=function(){var a=this.curve.a,$=this.x,j=this.y,_e=this.z,et=_e.redSqr().redSqr(),tt=$.redSqr(),rt=j.redSqr(),nt=tt.redAdd(tt).redIAdd(tt).redIAdd(a.redMul(et)),it=$.redAdd($);it=it.redIAdd(it);var st=it.redMul(rt),ot=nt.redSqr().redISub(st.redAdd(st)),at=st.redISub(ot),lt=rt.redSqr();lt=lt.redIAdd(lt),lt=lt.redIAdd(lt),lt=lt.redIAdd(lt);var ct=nt.redMul(at).redISub(lt),ut=j.redAdd(j).redMul(_e);return this.curve.jpoint(ot,ct,ut)};JPoint.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var a=this.x.redSqr(),$=this.y.redSqr(),j=this.z.redSqr(),_e=$.redSqr(),et=a.redAdd(a).redIAdd(a),tt=et.redSqr(),rt=this.x.redAdd($).redSqr().redISub(a).redISub(_e);rt=rt.redIAdd(rt),rt=rt.redAdd(rt).redIAdd(rt),rt=rt.redISub(tt);var nt=rt.redSqr(),it=_e.redIAdd(_e);it=it.redIAdd(it),it=it.redIAdd(it),it=it.redIAdd(it);var st=et.redIAdd(rt).redSqr().redISub(tt).redISub(nt).redISub(it),ot=$.redMul(st);ot=ot.redIAdd(ot),ot=ot.redIAdd(ot);var at=this.x.redMul(nt).redISub(ot);at=at.redIAdd(at),at=at.redIAdd(at);var lt=this.y.redMul(st.redMul(it.redISub(st)).redISub(rt.redMul(nt)));lt=lt.redIAdd(lt),lt=lt.redIAdd(lt),lt=lt.redIAdd(lt);var ct=this.z.redAdd(rt).redSqr().redISub(j).redISub(nt);return this.curve.jpoint(at,lt,ct)};JPoint.prototype.mul=function(a,$){return a=new BN$1(a,$),this.curve._wnafMul(this,a)};JPoint.prototype.eq=function(a){if(a.type==="affine")return this.eq(a.toJ());if(this===a)return!0;var $=this.z.redSqr(),j=a.z.redSqr();if(this.x.redMul(j).redISub(a.x.redMul($)).cmpn(0)!==0)return!1;var _e=$.redMul(this.z),et=j.redMul(a.z);return this.y.redMul(et).redISub(a.y.redMul(_e)).cmpn(0)===0};JPoint.prototype.eqXToP=function(a){var $=this.z.redSqr(),j=a.toRed(this.curve.red).redMul($);if(this.x.cmp(j)===0)return!0;for(var _e=a.clone(),et=this.curve.redN.redMul($);;){if(_e.iadd(this.curve.n),_e.cmp(this.curve.p)>=0)return!1;if(j.redIAdd(et),this.x.cmp(j)===0)return!0}};JPoint.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};JPoint.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var curve_1=createCommonjsModule(function(_,a){var $=a;$.base=base$4,$.short=short_1,$.mont=null,$.edwards=null}),curves_1=createCommonjsModule(function(_,a){var $=a,j=utils_1$1.assert;function _e(rt){rt.type==="short"?this.curve=new curve_1.short(rt):rt.type==="edwards"?this.curve=new curve_1.edwards(rt):this.curve=new curve_1.mont(rt),this.g=this.curve.g,this.n=this.curve.n,this.hash=rt.hash,j(this.g.validate(),"Invalid curve"),j(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}$.PresetCurve=_e;function et(rt,nt){Object.defineProperty($,rt,{configurable:!0,enumerable:!0,get:function(){var it=new _e(nt);return Object.defineProperty($,rt,{configurable:!0,enumerable:!0,value:it}),it}})}et("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:hash$3.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),et("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:hash$3.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),et("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:hash$3.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),et("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:hash$3.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),et("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:hash$3.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),et("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:hash$3.sha256,gRed:!1,g:["9"]}),et("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:hash$3.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var tt;try{tt=null.crash()}catch{tt=void 0}et("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:hash$3.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",tt]})});function HmacDRBG(_){if(!(this instanceof HmacDRBG))return new HmacDRBG(_);this.hash=_.hash,this.predResist=!!_.predResist,this.outLen=this.hash.outSize,this.minEntropy=_.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var a=utils_1.toArray(_.entropy,_.entropyEnc||"hex"),$=utils_1.toArray(_.nonce,_.nonceEnc||"hex"),j=utils_1.toArray(_.pers,_.persEnc||"hex");minimalisticAssert(a.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(a,$,j)}var hmacDrbg=HmacDRBG;HmacDRBG.prototype._init=function(a,$,j){var _e=a.concat($).concat(j);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var et=0;et<this.V.length;et++)this.K[et]=0,this.V[et]=1;this._update(_e),this._reseed=1,this.reseedInterval=281474976710656};HmacDRBG.prototype._hmac=function(){return new hash$3.hmac(this.hash,this.K)};HmacDRBG.prototype._update=function(a){var $=this._hmac().update(this.V).update([0]);a&&($=$.update(a)),this.K=$.digest(),this.V=this._hmac().update(this.V).digest(),a&&(this.K=this._hmac().update(this.V).update([1]).update(a).digest(),this.V=this._hmac().update(this.V).digest())};HmacDRBG.prototype.reseed=function(a,$,j,_e){typeof $!="string"&&(_e=j,j=$,$=null),a=utils_1.toArray(a,$),j=utils_1.toArray(j,_e),minimalisticAssert(a.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(a.concat(j||[])),this._reseed=1};HmacDRBG.prototype.generate=function(a,$,j,_e){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof $!="string"&&(_e=j,j=$,$=null),j&&(j=utils_1.toArray(j,_e||"hex"),this._update(j));for(var et=[];et.length<a;)this.V=this._hmac().update(this.V).digest(),et=et.concat(this.V);var tt=et.slice(0,a);return this._update(j),this._reseed++,utils_1.encode(tt,$)};var assert$3=utils_1$1.assert;function KeyPair(_,a){this.ec=_,this.priv=null,this.pub=null,a.priv&&this._importPrivate(a.priv,a.privEnc),a.pub&&this._importPublic(a.pub,a.pubEnc)}var key=KeyPair;KeyPair.fromPublic=function(a,$,j){return $ instanceof KeyPair?$:new KeyPair(a,{pub:$,pubEnc:j})};KeyPair.fromPrivate=function(a,$,j){return $ instanceof KeyPair?$:new KeyPair(a,{priv:$,privEnc:j})};KeyPair.prototype.validate=function(){var a=this.getPublic();return a.isInfinity()?{result:!1,reason:"Invalid public key"}:a.validate()?a.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};KeyPair.prototype.getPublic=function(a,$){return typeof a=="string"&&($=a,a=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),$?this.pub.encode($,a):this.pub};KeyPair.prototype.getPrivate=function(a){return a==="hex"?this.priv.toString(16,2):this.priv};KeyPair.prototype._importPrivate=function(a,$){this.priv=new BN$1(a,$||16),this.priv=this.priv.umod(this.ec.curve.n)};KeyPair.prototype._importPublic=function(a,$){if(a.x||a.y){this.ec.curve.type==="mont"?assert$3(a.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&assert$3(a.x&&a.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(a.x,a.y);return}this.pub=this.ec.curve.decodePoint(a,$)};KeyPair.prototype.derive=function(a){return a.validate()||assert$3(a.validate(),"public point not validated"),a.mul(this.priv).getX()};KeyPair.prototype.sign=function(a,$,j){return this.ec.sign(a,this,$,j)};KeyPair.prototype.verify=function(a,$){return this.ec.verify(a,$,this)};KeyPair.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var assert$4=utils_1$1.assert;function Signature$2(_,a){if(_ instanceof Signature$2)return _;this._importDER(_,a)||(assert$4(_.r&&_.s,"Signature without r or s"),this.r=new BN$1(_.r,16),this.s=new BN$1(_.s,16),_.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=_.recoveryParam)}var signature=Signature$2;function Position(){this.place=0}function getLength$1(_,a){var $=_[a.place++];if(!($&128))return $;var j=$&15;if(j===0||j>4)return!1;for(var _e=0,et=0,tt=a.place;et<j;et++,tt++)_e<<=8,_e|=_[tt],_e>>>=0;return _e<=127?!1:(a.place=tt,_e)}function rmPadding(_){for(var a=0,$=_.length-1;!_[a]&&!(_[a+1]&128)&&a<$;)a++;return a===0?_:_.slice(a)}Signature$2.prototype._importDER=function(a,$){a=utils_1$1.toArray(a,$);var j=new Position;if(a[j.place++]!==48)return!1;var _e=getLength$1(a,j);if(_e===!1||_e+j.place!==a.length||a[j.place++]!==2)return!1;var et=getLength$1(a,j);if(et===!1)return!1;var tt=a.slice(j.place,et+j.place);if(j.place+=et,a[j.place++]!==2)return!1;var rt=getLength$1(a,j);if(rt===!1||a.length!==rt+j.place)return!1;var nt=a.slice(j.place,rt+j.place);if(tt[0]===0)if(tt[1]&128)tt=tt.slice(1);else return!1;if(nt[0]===0)if(nt[1]&128)nt=nt.slice(1);else return!1;return this.r=new BN$1(tt),this.s=new BN$1(nt),this.recoveryParam=null,!0};function constructLength(_,a){if(a<128){_.push(a);return}var $=1+(Math.log(a)/Math.LN2>>>3);for(_.push($|128);--$;)_.push(a>>>($<<3)&255);_.push(a)}Signature$2.prototype.toDER=function(a){var $=this.r.toArray(),j=this.s.toArray();for($[0]&128&&($=[0].concat($)),j[0]&128&&(j=[0].concat(j)),$=rmPadding($),j=rmPadding(j);!j[0]&&!(j[1]&128);)j=j.slice(1);var _e=[2];constructLength(_e,$.length),_e=_e.concat($),_e.push(2),constructLength(_e,j.length);var et=_e.concat(j),tt=[48];return constructLength(tt,et.length),tt=tt.concat(et),utils_1$1.encode(tt,a)};var rand=function(){throw new Error("unsupported")},assert$5=utils_1$1.assert;function EC(_){if(!(this instanceof EC))return new EC(_);typeof _=="string"&&(assert$5(Object.prototype.hasOwnProperty.call(curves_1,_),"Unknown curve "+_),_=curves_1[_]),_ instanceof curves_1.PresetCurve&&(_={curve:_}),this.curve=_.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=_.curve.g,this.g.precompute(_.curve.n.bitLength()+1),this.hash=_.hash||_.curve.hash}var ec=EC;EC.prototype.keyPair=function(a){return new key(this,a)};EC.prototype.keyFromPrivate=function(a,$){return key.fromPrivate(this,a,$)};EC.prototype.keyFromPublic=function(a,$){return key.fromPublic(this,a,$)};EC.prototype.genKeyPair=function(a){a||(a={});for(var $=new hmacDrbg({hash:this.hash,pers:a.pers,persEnc:a.persEnc||"utf8",entropy:a.entropy||rand(this.hash.hmacStrength),entropyEnc:a.entropy&&a.entropyEnc||"utf8",nonce:this.n.toArray()}),j=this.n.byteLength(),_e=this.n.sub(new BN$1(2));;){var et=new BN$1($.generate(j));if(!(et.cmp(_e)>0))return et.iaddn(1),this.keyFromPrivate(et)}};EC.prototype._truncateToN=function(a,$){var j=a.byteLength()*8-this.n.bitLength();return j>0&&(a=a.ushrn(j)),!$&&a.cmp(this.n)>=0?a.sub(this.n):a};EC.prototype.sign=function(a,$,j,_e){typeof j=="object"&&(_e=j,j=null),_e||(_e={}),$=this.keyFromPrivate($,j),a=this._truncateToN(new BN$1(a,16));for(var et=this.n.byteLength(),tt=$.getPrivate().toArray("be",et),rt=a.toArray("be",et),nt=new hmacDrbg({hash:this.hash,entropy:tt,nonce:rt,pers:_e.pers,persEnc:_e.persEnc||"utf8"}),it=this.n.sub(new BN$1(1)),st=0;;st++){var ot=_e.k?_e.k(st):new BN$1(nt.generate(this.n.byteLength()));if(ot=this._truncateToN(ot,!0),!(ot.cmpn(1)<=0||ot.cmp(it)>=0)){var at=this.g.mul(ot);if(!at.isInfinity()){var lt=at.getX(),ct=lt.umod(this.n);if(ct.cmpn(0)!==0){var ut=ot.invm(this.n).mul(ct.mul($.getPrivate()).iadd(a));if(ut=ut.umod(this.n),ut.cmpn(0)!==0){var dt=(at.getY().isOdd()?1:0)|(lt.cmp(ct)!==0?2:0);return _e.canonical&&ut.cmp(this.nh)>0&&(ut=this.n.sub(ut),dt^=1),new signature({r:ct,s:ut,recoveryParam:dt})}}}}}};EC.prototype.verify=function(a,$,j,_e){a=this._truncateToN(new BN$1(a,16)),j=this.keyFromPublic(j,_e),$=new signature($,"hex");var et=$.r,tt=$.s;if(et.cmpn(1)<0||et.cmp(this.n)>=0||tt.cmpn(1)<0||tt.cmp(this.n)>=0)return!1;var rt=tt.invm(this.n),nt=rt.mul(a).umod(this.n),it=rt.mul(et).umod(this.n),st;return this.curve._maxwellTrick?(st=this.g.jmulAdd(nt,j.getPublic(),it),st.isInfinity()?!1:st.eqXToP(et)):(st=this.g.mulAdd(nt,j.getPublic(),it),st.isInfinity()?!1:st.getX().umod(this.n).cmp(et)===0)};EC.prototype.recoverPubKey=function(_,a,$,j){assert$5((3&$)===$,"The recovery param is more than two bits"),a=new signature(a,j);var _e=this.n,et=new BN$1(_),tt=a.r,rt=a.s,nt=$&1,it=$>>1;if(tt.cmp(this.curve.p.umod(this.curve.n))>=0&&it)throw new Error("Unable to find sencond key candinate");it?tt=this.curve.pointFromX(tt.add(this.curve.n),nt):tt=this.curve.pointFromX(tt,nt);var st=a.r.invm(_e),ot=_e.sub(et).mul(st).umod(_e),at=rt.mul(st).umod(_e);return this.g.mulAdd(ot,tt,at)};EC.prototype.getKeyRecoveryParam=function(_,a,$,j){if(a=new signature(a,j),a.recoveryParam!==null)return a.recoveryParam;for(var _e=0;_e<4;_e++){var et;try{et=this.recoverPubKey(_,a,_e)}catch{continue}if(et.eq($))return _e}throw new Error("Unable to find valid recovery factor")};var elliptic_1=createCommonjsModule(function(_,a){var $=a;$.version="6.5.4",$.utils=utils_1$1,$.rand=function(){throw new Error("unsupported")},$.curve=curve_1,$.curves=curves_1,$.ec=ec,$.eddsa=null}),EC$1=elliptic_1.ec;const version$9="signing-key/5.7.0",logger$b=new Logger(version$9);let _curve=null;function getCurve(){return _curve||(_curve=new EC$1("secp256k1")),_curve}class SigningKey{constructor(a){defineReadOnly(this,"curve","secp256k1"),defineReadOnly(this,"privateKey",hexlify(a)),hexDataLength(this.privateKey)!==32&&logger$b.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const $=getCurve().keyFromPrivate(arrayify(this.privateKey));defineReadOnly(this,"publicKey","0x"+$.getPublic(!1,"hex")),defineReadOnly(this,"compressedPublicKey","0x"+$.getPublic(!0,"hex")),defineReadOnly(this,"_isSigningKey",!0)}_addPoint(a){const $=getCurve().keyFromPublic(arrayify(this.publicKey)),j=getCurve().keyFromPublic(arrayify(a));return"0x"+$.pub.add(j.pub).encodeCompressed("hex")}signDigest(a){const $=getCurve().keyFromPrivate(arrayify(this.privateKey)),j=arrayify(a);j.length!==32&&logger$b.throwArgumentError("bad digest length","digest",a);const _e=$.sign(j,{canonical:!0});return splitSignature({recoveryParam:_e.recoveryParam,r:hexZeroPad("0x"+_e.r.toString(16),32),s:hexZeroPad("0x"+_e.s.toString(16),32)})}computeSharedSecret(a){const $=getCurve().keyFromPrivate(arrayify(this.privateKey)),j=getCurve().keyFromPublic(arrayify(computePublicKey$1(a)));return hexZeroPad("0x"+$.derive(j.getPublic()).toString(16),32)}static isSigningKey(a){return!!(a&&a._isSigningKey)}}function recoverPublicKey(_,a){const $=splitSignature(a),j={r:arrayify($.r),s:arrayify($.s)};return"0x"+getCurve().recoverPubKey(arrayify(_),j,$.recoveryParam).encode("hex",!1)}function computePublicKey$1(_,a){const $=arrayify(_);if($.length===32){const j=new SigningKey($);return a?"0x"+getCurve().keyFromPrivate($).getPublic(!0,"hex"):j.publicKey}else{if($.length===33)return a?hexlify($):"0x"+getCurve().keyFromPublic($).getPublic(!1,"hex");if($.length===65)return a?"0x"+getCurve().keyFromPublic($).getPublic(!0,"hex"):hexlify($)}return logger$b.throwArgumentError("invalid public or private key","key","[REDACTED]")}const version$8="transactions/5.7.0",logger$a=new Logger(version$8);var TransactionTypes;(function(_){_[_.legacy=0]="legacy",_[_.eip2930=1]="eip2930",_[_.eip1559=2]="eip1559"})(TransactionTypes||(TransactionTypes={}));function handleAddress(_){return _==="0x"?null:getAddress(_)}function handleNumber(_){return _==="0x"?Zero$1:BigNumber.from(_)}function computeAddress(_){const a=computePublicKey$1(_);return getAddress(hexDataSlice(keccak256(hexDataSlice(a,1)),12))}function recoverAddress(_,a){return computeAddress(recoverPublicKey(arrayify(_),a))}function formatNumber(_,a){const $=stripZeros(BigNumber.from(_).toHexString());return $.length>32&&logger$a.throwArgumentError("invalid length for "+a,"transaction:"+a,_),$}function accessSetify(_,a){return{address:getAddress(_),storageKeys:(a||[]).map(($,j)=>(hexDataLength($)!==32&&logger$a.throwArgumentError("invalid access list storageKey",`accessList[${_}:${j}]`,$),$.toLowerCase()))}}function accessListify(_){if(Array.isArray(_))return _.map(($,j)=>Array.isArray($)?($.length>2&&logger$a.throwArgumentError("access list expected to be [ address, storageKeys[] ]",`value[${j}]`,$),accessSetify($[0],$[1])):accessSetify($.address,$.storageKeys));const a=Object.keys(_).map($=>{const j=_[$].reduce((_e,et)=>(_e[et]=!0,_e),{});return accessSetify($,Object.keys(j).sort())});return a.sort(($,j)=>$.address.localeCompare(j.address)),a}function formatAccessList(_){return accessListify(_).map(a=>[a.address,a.storageKeys])}function _serializeEip1559(_,a){if(_.gasPrice!=null){const j=BigNumber.from(_.gasPrice),_e=BigNumber.from(_.maxFeePerGas||0);j.eq(_e)||logger$a.throwArgumentError("mismatch EIP-1559 gasPrice != maxFeePerGas","tx",{gasPrice:j,maxFeePerGas:_e})}const $=[formatNumber(_.chainId||0,"chainId"),formatNumber(_.nonce||0,"nonce"),formatNumber(_.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),formatNumber(_.maxFeePerGas||0,"maxFeePerGas"),formatNumber(_.gasLimit||0,"gasLimit"),_.to!=null?getAddress(_.to):"0x",formatNumber(_.value||0,"value"),_.data||"0x",formatAccessList(_.accessList||[])];if(a){const j=splitSignature(a);$.push(formatNumber(j.recoveryParam,"recoveryParam")),$.push(stripZeros(j.r)),$.push(stripZeros(j.s))}return hexConcat(["0x02",encode$x($)])}function _serializeEip2930(_,a){const $=[formatNumber(_.chainId||0,"chainId"),formatNumber(_.nonce||0,"nonce"),formatNumber(_.gasPrice||0,"gasPrice"),formatNumber(_.gasLimit||0,"gasLimit"),_.to!=null?getAddress(_.to):"0x",formatNumber(_.value||0,"value"),_.data||"0x",formatAccessList(_.accessList||[])];if(a){const j=splitSignature(a);$.push(formatNumber(j.recoveryParam,"recoveryParam")),$.push(stripZeros(j.r)),$.push(stripZeros(j.s))}return hexConcat(["0x01",encode$x($)])}function _parseEipSignature(_,a,$){try{const j=handleNumber(a[0]).toNumber();if(j!==0&&j!==1)throw new Error("bad recid");_.v=j}catch{logger$a.throwArgumentError("invalid v for transaction type: 1","v",a[0])}_.r=hexZeroPad(a[1],32),_.s=hexZeroPad(a[2],32);try{const j=keccak256($(_));_.from=recoverAddress(j,{r:_.r,s:_.s,recoveryParam:_.v})}catch{}}function _parseEip1559(_){const a=decode$t(_.slice(1));a.length!==9&&a.length!==12&&logger$a.throwArgumentError("invalid component count for transaction type: 2","payload",hexlify(_));const $=handleNumber(a[2]),j=handleNumber(a[3]),_e={type:2,chainId:handleNumber(a[0]).toNumber(),nonce:handleNumber(a[1]).toNumber(),maxPriorityFeePerGas:$,maxFeePerGas:j,gasPrice:null,gasLimit:handleNumber(a[4]),to:handleAddress(a[5]),value:handleNumber(a[6]),data:a[7],accessList:accessListify(a[8])};return a.length===9||(_e.hash=keccak256(_),_parseEipSignature(_e,a.slice(9),_serializeEip1559)),_e}function _parseEip2930(_){const a=decode$t(_.slice(1));a.length!==8&&a.length!==11&&logger$a.throwArgumentError("invalid component count for transaction type: 1","payload",hexlify(_));const $={type:1,chainId:handleNumber(a[0]).toNumber(),nonce:handleNumber(a[1]).toNumber(),gasPrice:handleNumber(a[2]),gasLimit:handleNumber(a[3]),to:handleAddress(a[4]),value:handleNumber(a[5]),data:a[6],accessList:accessListify(a[7])};return a.length===8||($.hash=keccak256(_),_parseEipSignature($,a.slice(8),_serializeEip2930)),$}function _parse(_){const a=decode$t(_);a.length!==9&&a.length!==6&&logger$a.throwArgumentError("invalid raw transaction","rawTransaction",_);const $={nonce:handleNumber(a[0]).toNumber(),gasPrice:handleNumber(a[1]),gasLimit:handleNumber(a[2]),to:handleAddress(a[3]),value:handleNumber(a[4]),data:a[5],chainId:0};if(a.length===6)return $;try{$.v=BigNumber.from(a[6]).toNumber()}catch{return $}if($.r=hexZeroPad(a[7],32),$.s=hexZeroPad(a[8],32),BigNumber.from($.r).isZero()&&BigNumber.from($.s).isZero())$.chainId=$.v,$.v=0;else{$.chainId=Math.floor(($.v-35)/2),$.chainId<0&&($.chainId=0);let j=$.v-27;const _e=a.slice(0,6);$.chainId!==0&&(_e.push(hexlify($.chainId)),_e.push("0x"),_e.push("0x"),j-=$.chainId*2+8);const et=keccak256(encode$x(_e));try{$.from=recoverAddress(et,{r:hexlify($.r),s:hexlify($.s),recoveryParam:j})}catch{}$.hash=keccak256(_)}return $.type=null,$}function parse$4(_){const a=arrayify(_);if(a[0]>127)return _parse(a);switch(a[0]){case 1:return _parseEip2930(a);case 2:return _parseEip1559(a)}return logger$a.throwError(`unsupported transaction type: ${a[0]}`,Logger.errors.UNSUPPORTED_OPERATION,{operation:"parseTransaction",transactionType:a[0]})}const version$7="contracts/5.7.0";var __awaiter$4=globalThis&&globalThis.__awaiter||function(_,a,$,j){function _e(et){return et instanceof $?et:new $(function(tt){tt(et)})}return new($||($=Promise))(function(et,tt){function rt(st){try{it(j.next(st))}catch(ot){tt(ot)}}function nt(st){try{it(j.throw(st))}catch(ot){tt(ot)}}function it(st){st.done?et(st.value):_e(st.value).then(rt,nt)}it((j=j.apply(_,a||[])).next())})};const logger$9=new Logger(version$7);function resolveName(_,a){return __awaiter$4(this,void 0,void 0,function*(){const $=yield a;typeof $!="string"&&logger$9.throwArgumentError("invalid address or ENS name","name",$);try{return getAddress($)}catch{}_||logger$9.throwError("a provider or signer is needed to resolve ENS names",Logger.errors.UNSUPPORTED_OPERATION,{operation:"resolveName"});const j=yield _.resolveName($);return j==null&&logger$9.throwArgumentError("resolver or addr is not configured for ENS name","name",$),j})}function resolveAddresses(_,a,$){return __awaiter$4(this,void 0,void 0,function*(){return Array.isArray($)?yield Promise.all($.map((j,_e)=>resolveAddresses(_,Array.isArray(a)?a[_e]:a[j.name],j))):$.type==="address"?yield resolveName(_,a):$.type==="tuple"?yield resolveAddresses(_,a,$.components):$.baseType==="array"?Array.isArray(a)?yield Promise.all(a.map(j=>resolveAddresses(_,j,$.arrayChildren))):Promise.reject(logger$9.makeError("invalid value for array",Logger.errors.INVALID_ARGUMENT,{argument:"value",value:a})):a})}function populateTransaction(_,a,$){return __awaiter$4(this,void 0,void 0,function*(){let j={};$.length===a.inputs.length+1&&typeof $[$.length-1]=="object"&&(j=shallowCopy($.pop())),logger$9.checkArgumentCount($.length,a.inputs.length,"passed to contract"),_.signer?j.from?j.from=resolveProperties({override:resolveName(_.signer,j.from),signer:_.signer.getAddress()}).then(it=>__awaiter$4(this,void 0,void 0,function*(){return getAddress(it.signer)!==it.override&&logger$9.throwError("Contract with a Signer cannot override from",Logger.errors.UNSUPPORTED_OPERATION,{operation:"overrides.from"}),it.override})):j.from=_.signer.getAddress():j.from&&(j.from=resolveName(_.provider,j.from));const _e=yield resolveProperties({args:resolveAddresses(_.signer||_.provider,$,a.inputs),address:_.resolvedAddress,overrides:resolveProperties(j)||{}}),et=_.interface.encodeFunctionData(a,_e.args),tt={data:et,to:_e.address},rt=_e.overrides;if(rt.nonce!=null&&(tt.nonce=BigNumber.from(rt.nonce).toNumber()),rt.gasLimit!=null&&(tt.gasLimit=BigNumber.from(rt.gasLimit)),rt.gasPrice!=null&&(tt.gasPrice=BigNumber.from(rt.gasPrice)),rt.maxFeePerGas!=null&&(tt.maxFeePerGas=BigNumber.from(rt.maxFeePerGas)),rt.maxPriorityFeePerGas!=null&&(tt.maxPriorityFeePerGas=BigNumber.from(rt.maxPriorityFeePerGas)),rt.from!=null&&(tt.from=rt.from),rt.type!=null&&(tt.type=rt.type),rt.accessList!=null&&(tt.accessList=accessListify(rt.accessList)),tt.gasLimit==null&&a.gas!=null){let it=21e3;const st=arrayify(et);for(let ot=0;ot<st.length;ot++)it+=4,st[ot]&&(it+=64);tt.gasLimit=BigNumber.from(a.gas).add(it)}if(rt.value){const it=BigNumber.from(rt.value);!it.isZero()&&!a.payable&&logger$9.throwError("non-payable method cannot override value",Logger.errors.UNSUPPORTED_OPERATION,{operation:"overrides.value",value:j.value}),tt.value=it}rt.customData&&(tt.customData=shallowCopy(rt.customData)),rt.ccipReadEnabled&&(tt.ccipReadEnabled=!!rt.ccipReadEnabled),delete j.nonce,delete j.gasLimit,delete j.gasPrice,delete j.from,delete j.value,delete j.type,delete j.accessList,delete j.maxFeePerGas,delete j.maxPriorityFeePerGas,delete j.customData,delete j.ccipReadEnabled;const nt=Object.keys(j).filter(it=>j[it]!=null);return nt.length&&logger$9.throwError(`cannot override ${nt.map(it=>JSON.stringify(it)).join(",")}`,Logger.errors.UNSUPPORTED_OPERATION,{operation:"overrides",overrides:nt}),tt})}function buildPopulate(_,a){return function(...$){return populateTransaction(_,a,$)}}function buildEstimate(_,a){const $=_.signer||_.provider;return function(...j){return __awaiter$4(this,void 0,void 0,function*(){$||logger$9.throwError("estimate require a provider or signer",Logger.errors.UNSUPPORTED_OPERATION,{operation:"estimateGas"});const _e=yield populateTransaction(_,a,j);return yield $.estimateGas(_e)})}}function addContractWait(_,a){const $=a.wait.bind(a);a.wait=j=>$(j).then(_e=>(_e.events=_e.logs.map(et=>{let tt=deepCopy(et),rt=null;try{rt=_.interface.parseLog(et)}catch{}return rt&&(tt.args=rt.args,tt.decode=(nt,it)=>_.interface.decodeEventLog(rt.eventFragment,nt,it),tt.event=rt.name,tt.eventSignature=rt.signature),tt.removeListener=()=>_.provider,tt.getBlock=()=>_.provider.getBlock(_e.blockHash),tt.getTransaction=()=>_.provider.getTransaction(_e.transactionHash),tt.getTransactionReceipt=()=>Promise.resolve(_e),tt}),_e))}function buildCall(_,a,$){const j=_.signer||_.provider;return function(..._e){return __awaiter$4(this,void 0,void 0,function*(){let et;if(_e.length===a.inputs.length+1&&typeof _e[_e.length-1]=="object"){const nt=shallowCopy(_e.pop());nt.blockTag!=null&&(et=yield nt.blockTag),delete nt.blockTag,_e.push(nt)}_.deployTransaction!=null&&(yield _._deployed(et));const tt=yield populateTransaction(_,a,_e),rt=yield j.call(tt,et);try{let nt=_.interface.decodeFunctionResult(a,rt);return $&&a.outputs.length===1&&(nt=nt[0]),nt}catch(nt){throw nt.code===Logger.errors.CALL_EXCEPTION&&(nt.address=_.address,nt.args=_e,nt.transaction=tt),nt}})}}function buildSend(_,a){return function(...$){return __awaiter$4(this,void 0,void 0,function*(){_.signer||logger$9.throwError("sending a transaction requires a signer",Logger.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction"}),_.deployTransaction!=null&&(yield _._deployed());const j=yield populateTransaction(_,a,$),_e=yield _.signer.sendTransaction(j);return addContractWait(_,_e),_e})}}function buildDefault(_,a,$){return a.constant?buildCall(_,a,$):buildSend(_,a)}function getEventTag$1(_){return _.address&&(_.topics==null||_.topics.length===0)?"*":(_.address||"*")+"@"+(_.topics?_.topics.map(a=>Array.isArray(a)?a.join("|"):a).join(":"):"")}class RunningEvent{constructor(a,$){defineReadOnly(this,"tag",a),defineReadOnly(this,"filter",$),this._listeners=[]}addListener(a,$){this._listeners.push({listener:a,once:$})}removeListener(a){let $=!1;this._listeners=this._listeners.filter(j=>$||j.listener!==a?!0:($=!0,!1))}removeAllListeners(){this._listeners=[]}listeners(){return this._listeners.map(a=>a.listener)}listenerCount(){return this._listeners.length}run(a){const $=this.listenerCount();return this._listeners=this._listeners.filter(j=>{const _e=a.slice();return setTimeout(()=>{j.listener.apply(this,_e)},0),!j.once}),$}prepareEvent(a){}getEmit(a){return[a]}}class ErrorRunningEvent extends RunningEvent{constructor(){super("error",null)}}class FragmentRunningEvent extends RunningEvent{constructor(a,$,j,_e){const et={address:a};let tt=$.getEventTopic(j);_e?(tt!==_e[0]&&logger$9.throwArgumentError("topic mismatch","topics",_e),et.topics=_e.slice()):et.topics=[tt],super(getEventTag$1(et),et),defineReadOnly(this,"address",a),defineReadOnly(this,"interface",$),defineReadOnly(this,"fragment",j)}prepareEvent(a){super.prepareEvent(a),a.event=this.fragment.name,a.eventSignature=this.fragment.format(),a.decode=($,j)=>this.interface.decodeEventLog(this.fragment,$,j);try{a.args=this.interface.decodeEventLog(this.fragment,a.data,a.topics)}catch($){a.args=null,a.decodeError=$}}getEmit(a){const $=checkResultErrors(a.args);if($.length)throw $[0].error;const j=(a.args||[]).slice();return j.push(a),j}}class WildcardRunningEvent extends RunningEvent{constructor(a,$){super("*",{address:a}),defineReadOnly(this,"address",a),defineReadOnly(this,"interface",$)}prepareEvent(a){super.prepareEvent(a);try{const $=this.interface.parseLog(a);a.event=$.name,a.eventSignature=$.signature,a.decode=(j,_e)=>this.interface.decodeEventLog($.eventFragment,j,_e),a.args=$.args}catch{}}}class BaseContract{constructor(a,$,j){defineReadOnly(this,"interface",getStatic(new.target,"getInterface")($)),j==null?(defineReadOnly(this,"provider",null),defineReadOnly(this,"signer",null)):Signer.isSigner(j)?(defineReadOnly(this,"provider",j.provider||null),defineReadOnly(this,"signer",j)):Provider$1.isProvider(j)?(defineReadOnly(this,"provider",j),defineReadOnly(this,"signer",null)):logger$9.throwArgumentError("invalid signer or provider","signerOrProvider",j),defineReadOnly(this,"callStatic",{}),defineReadOnly(this,"estimateGas",{}),defineReadOnly(this,"functions",{}),defineReadOnly(this,"populateTransaction",{}),defineReadOnly(this,"filters",{});{const tt={};Object.keys(this.interface.events).forEach(rt=>{const nt=this.interface.events[rt];defineReadOnly(this.filters,rt,(...it)=>({address:this.address,topics:this.interface.encodeFilterTopics(nt,it)})),tt[nt.name]||(tt[nt.name]=[]),tt[nt.name].push(rt)}),Object.keys(tt).forEach(rt=>{const nt=tt[rt];nt.length===1?defineReadOnly(this.filters,rt,this.filters[nt[0]]):logger$9.warn(`Duplicate definition of ${rt} (${nt.join(", ")})`)})}if(defineReadOnly(this,"_runningEvents",{}),defineReadOnly(this,"_wrappedEmits",{}),a==null&&logger$9.throwArgumentError("invalid contract address or ENS name","addressOrName",a),defineReadOnly(this,"address",a),this.provider)defineReadOnly(this,"resolvedAddress",resolveName(this.provider,a));else try{defineReadOnly(this,"resolvedAddress",Promise.resolve(getAddress(a)))}catch{logger$9.throwError("provider is required to use ENS name as contract address",Logger.errors.UNSUPPORTED_OPERATION,{operation:"new Contract"})}this.resolvedAddress.catch(tt=>{});const _e={},et={};Object.keys(this.interface.functions).forEach(tt=>{const rt=this.interface.functions[tt];if(et[tt]){logger$9.warn(`Duplicate ABI entry for ${JSON.stringify(tt)}`);return}et[tt]=!0;{const nt=rt.name;_e[`%${nt}`]||(_e[`%${nt}`]=[]),_e[`%${nt}`].push(tt)}this[tt]==null&&defineReadOnly(this,tt,buildDefault(this,rt,!0)),this.functions[tt]==null&&defineReadOnly(this.functions,tt,buildDefault(this,rt,!1)),this.callStatic[tt]==null&&defineReadOnly(this.callStatic,tt,buildCall(this,rt,!0)),this.populateTransaction[tt]==null&&defineReadOnly(this.populateTransaction,tt,buildPopulate(this,rt)),this.estimateGas[tt]==null&&defineReadOnly(this.estimateGas,tt,buildEstimate(this,rt))}),Object.keys(_e).forEach(tt=>{const rt=_e[tt];if(rt.length>1)return;tt=tt.substring(1);const nt=rt[0];try{this[tt]==null&&defineReadOnly(this,tt,this[nt])}catch{}this.functions[tt]==null&&defineReadOnly(this.functions,tt,this.functions[nt]),this.callStatic[tt]==null&&defineReadOnly(this.callStatic,tt,this.callStatic[nt]),this.populateTransaction[tt]==null&&defineReadOnly(this.populateTransaction,tt,this.populateTransaction[nt]),this.estimateGas[tt]==null&&defineReadOnly(this.estimateGas,tt,this.estimateGas[nt])})}static getContractAddress(a){return getContractAddress(a)}static getInterface(a){return Interface.isInterface(a)?a:new Interface(a)}deployed(){return this._deployed()}_deployed(a){return this._deployedPromise||(this.deployTransaction?this._deployedPromise=this.deployTransaction.wait().then(()=>this):this._deployedPromise=this.provider.getCode(this.address,a).then($=>($==="0x"&&logger$9.throwError("contract not deployed",Logger.errors.UNSUPPORTED_OPERATION,{contractAddress:this.address,operation:"getDeployed"}),this))),this._deployedPromise}fallback(a){this.signer||logger$9.throwError("sending a transactions require a signer",Logger.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction(fallback)"});const $=shallowCopy(a||{});return["from","to"].forEach(function(j){$[j]!=null&&logger$9.throwError("cannot override "+j,Logger.errors.UNSUPPORTED_OPERATION,{operation:j})}),$.to=this.resolvedAddress,this.deployed().then(()=>this.signer.sendTransaction($))}connect(a){typeof a=="string"&&(a=new VoidSigner(a,this.provider));const $=new this.constructor(this.address,this.interface,a);return this.deployTransaction&&defineReadOnly($,"deployTransaction",this.deployTransaction),$}attach(a){return new this.constructor(a,this.interface,this.signer||this.provider)}static isIndexed(a){return Indexed.isIndexed(a)}_normalizeRunningEvent(a){return this._runningEvents[a.tag]?this._runningEvents[a.tag]:a}_getRunningEvent(a){if(typeof a=="string"){if(a==="error")return this._normalizeRunningEvent(new ErrorRunningEvent);if(a==="event")return this._normalizeRunningEvent(new RunningEvent("event",null));if(a==="*")return this._normalizeRunningEvent(new WildcardRunningEvent(this.address,this.interface));const $=this.interface.getEvent(a);return this._normalizeRunningEvent(new FragmentRunningEvent(this.address,this.interface,$))}if(a.topics&&a.topics.length>0){try{const j=a.topics[0];if(typeof j!="string")throw new Error("invalid topic");const _e=this.interface.getEvent(j);return this._normalizeRunningEvent(new FragmentRunningEvent(this.address,this.interface,_e,a.topics))}catch{}const $={address:this.address,topics:a.topics};return this._normalizeRunningEvent(new RunningEvent(getEventTag$1($),$))}return this._normalizeRunningEvent(new WildcardRunningEvent(this.address,this.interface))}_checkRunningEvents(a){if(a.listenerCount()===0){delete this._runningEvents[a.tag];const $=this._wrappedEmits[a.tag];$&&a.filter&&(this.provider.off(a.filter,$),delete this._wrappedEmits[a.tag])}}_wrapEvent(a,$,j){const _e=deepCopy($);return _e.removeListener=()=>{!j||(a.removeListener(j),this._checkRunningEvents(a))},_e.getBlock=()=>this.provider.getBlock($.blockHash),_e.getTransaction=()=>this.provider.getTransaction($.transactionHash),_e.getTransactionReceipt=()=>this.provider.getTransactionReceipt($.transactionHash),a.prepareEvent(_e),_e}_addEventListener(a,$,j){if(this.provider||logger$9.throwError("events require a provider or a signer with a provider",Logger.errors.UNSUPPORTED_OPERATION,{operation:"once"}),a.addListener($,j),this._runningEvents[a.tag]=a,!this._wrappedEmits[a.tag]){const _e=et=>{let tt=this._wrapEvent(a,et,$);if(tt.decodeError==null)try{const rt=a.getEmit(tt);this.emit(a.filter,...rt)}catch(rt){tt.decodeError=rt.error}a.filter!=null&&this.emit("event",tt),tt.decodeError!=null&&this.emit("error",tt.decodeError,tt)};this._wrappedEmits[a.tag]=_e,a.filter!=null&&this.provider.on(a.filter,_e)}}queryFilter(a,$,j){const _e=this._getRunningEvent(a),et=shallowCopy(_e.filter);return typeof $=="string"&&isHexString($,32)?(j!=null&&logger$9.throwArgumentError("cannot specify toBlock with blockhash","toBlock",j),et.blockHash=$):(et.fromBlock=$??0,et.toBlock=j??"latest"),this.provider.getLogs(et).then(tt=>tt.map(rt=>this._wrapEvent(_e,rt,null)))}on(a,$){return this._addEventListener(this._getRunningEvent(a),$,!1),this}once(a,$){return this._addEventListener(this._getRunningEvent(a),$,!0),this}emit(a,...$){if(!this.provider)return!1;const j=this._getRunningEvent(a),_e=j.run($)>0;return this._checkRunningEvents(j),_e}listenerCount(a){return this.provider?a==null?Object.keys(this._runningEvents).reduce(($,j)=>$+this._runningEvents[j].listenerCount(),0):this._getRunningEvent(a).listenerCount():0}listeners(a){if(!this.provider)return[];if(a==null){const $=[];for(let j in this._runningEvents)this._runningEvents[j].listeners().forEach(_e=>{$.push(_e)});return $}return this._getRunningEvent(a).listeners()}removeAllListeners(a){if(!this.provider)return this;if(a==null){for(const j in this._runningEvents){const _e=this._runningEvents[j];_e.removeAllListeners(),this._checkRunningEvents(_e)}return this}const $=this._getRunningEvent(a);return $.removeAllListeners(),this._checkRunningEvents($),this}off(a,$){if(!this.provider)return this;const j=this._getRunningEvent(a);return j.removeListener($),this._checkRunningEvents(j),this}removeListener(a,$){return this.off(a,$)}}class Contract extends BaseContract{}class BaseX{constructor(a){defineReadOnly(this,"alphabet",a),defineReadOnly(this,"base",a.length),defineReadOnly(this,"_alphabetMap",{}),defineReadOnly(this,"_leader",a.charAt(0));for(let $=0;$<a.length;$++)this._alphabetMap[a.charAt($)]=$}encode(a){let $=arrayify(a);if($.length===0)return"";let j=[0];for(let et=0;et<$.length;++et){let tt=$[et];for(let rt=0;rt<j.length;++rt)tt+=j[rt]<<8,j[rt]=tt%this.base,tt=tt/this.base|0;for(;tt>0;)j.push(tt%this.base),tt=tt/this.base|0}let _e="";for(let et=0;$[et]===0&&et<$.length-1;++et)_e+=this._leader;for(let et=j.length-1;et>=0;--et)_e+=this.alphabet[j[et]];return _e}decode(a){if(typeof a!="string")throw new TypeError("Expected String");let $=[];if(a.length===0)return new Uint8Array($);$.push(0);for(let j=0;j<a.length;j++){let _e=this._alphabetMap[a[j]];if(_e===void 0)throw new Error("Non-base"+this.base+" character");let et=_e;for(let tt=0;tt<$.length;++tt)et+=$[tt]*this.base,$[tt]=et&255,et>>=8;for(;et>0;)$.push(et&255),et>>=8}for(let j=0;a[j]===this._leader&&j<a.length-1;++j)$.push(0);return arrayify(new Uint8Array($.reverse()))}}new BaseX("abcdefghijklmnopqrstuvwxyz234567");const Base58=new BaseX("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),version$6="sha2/5.7.0";new Logger(version$6);function sha256$5(_){return"0x"+hash$3.sha256().update(arrayify(_)).digest("hex")}const version$5="networks/5.7.1",logger$8=new Logger(version$5);function isRenetworkable(_){return _&&typeof _.renetwork=="function"}function ethDefaultProvider(_){const a=function($,j){j==null&&(j={});const _e=[];if($.InfuraProvider&&j.infura!=="-")try{_e.push(new $.InfuraProvider(_,j.infura))}catch{}if($.EtherscanProvider&&j.etherscan!=="-")try{_e.push(new $.EtherscanProvider(_,j.etherscan))}catch{}if($.AlchemyProvider&&j.alchemy!=="-")try{_e.push(new $.AlchemyProvider(_,j.alchemy))}catch{}if($.PocketProvider&&j.pocket!=="-"){const et=["goerli","ropsten","rinkeby","sepolia"];try{const tt=new $.PocketProvider(_,j.pocket);tt.network&&et.indexOf(tt.network.name)===-1&&_e.push(tt)}catch{}}if($.CloudflareProvider&&j.cloudflare!=="-")try{_e.push(new $.CloudflareProvider(_))}catch{}if($.AnkrProvider&&j.ankr!=="-")try{const et=["ropsten"],tt=new $.AnkrProvider(_,j.ankr);tt.network&&et.indexOf(tt.network.name)===-1&&_e.push(tt)}catch{}if(_e.length===0)return null;if($.FallbackProvider){let et=1;return j.quorum!=null?et=j.quorum:_==="homestead"&&(et=2),new $.FallbackProvider(_e,et)}return _e[0]};return a.renetwork=function($){return ethDefaultProvider($)},a}function etcDefaultProvider(_,a){const $=function(j,_e){return j.JsonRpcProvider?new j.JsonRpcProvider(_,a):null};return $.renetwork=function(j){return etcDefaultProvider(_,j)},$}const homestead={chainId:1,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"homestead",_defaultProvider:ethDefaultProvider("homestead")},ropsten={chainId:3,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"ropsten",_defaultProvider:ethDefaultProvider("ropsten")},classicMordor={chainId:63,name:"classicMordor",_defaultProvider:etcDefaultProvider("https://www.ethercluster.com/mordor","classicMordor")},networks={unspecified:{chainId:0,name:"unspecified"},homestead,mainnet:homestead,morden:{chainId:2,name:"morden"},ropsten,testnet:ropsten,rinkeby:{chainId:4,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"rinkeby",_defaultProvider:ethDefaultProvider("rinkeby")},kovan:{chainId:42,name:"kovan",_defaultProvider:ethDefaultProvider("kovan")},goerli:{chainId:5,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"goerli",_defaultProvider:ethDefaultProvider("goerli")},kintsugi:{chainId:1337702,name:"kintsugi"},sepolia:{chainId:11155111,name:"sepolia",_defaultProvider:ethDefaultProvider("sepolia")},classic:{chainId:61,name:"classic",_defaultProvider:etcDefaultProvider("https://www.ethercluster.com/etc","classic")},classicMorden:{chainId:62,name:"classicMorden"},classicMordor,classicTestnet:classicMordor,classicKotti:{chainId:6,name:"classicKotti",_defaultProvider:etcDefaultProvider("https://www.ethercluster.com/kotti","classicKotti")},xdai:{chainId:100,name:"xdai"},matic:{chainId:137,name:"matic",_defaultProvider:ethDefaultProvider("matic")},maticmum:{chainId:80001,name:"maticmum"},optimism:{chainId:10,name:"optimism",_defaultProvider:ethDefaultProvider("optimism")},"optimism-kovan":{chainId:69,name:"optimism-kovan"},"optimism-goerli":{chainId:420,name:"optimism-goerli"},arbitrum:{chainId:42161,name:"arbitrum"},"arbitrum-rinkeby":{chainId:421611,name:"arbitrum-rinkeby"},"arbitrum-goerli":{chainId:421613,name:"arbitrum-goerli"},bnb:{chainId:56,name:"bnb"},bnbt:{chainId:97,name:"bnbt"}};function getNetwork(_){if(_==null)return null;if(typeof _=="number"){for(const j in networks){const _e=networks[j];if(_e.chainId===_)return{name:_e.name,chainId:_e.chainId,ensAddress:_e.ensAddress||null,_defaultProvider:_e._defaultProvider||null}}return{chainId:_,name:"unknown"}}if(typeof _=="string"){const j=networks[_];return j==null?null:{name:j.name,chainId:j.chainId,ensAddress:j.ensAddress,_defaultProvider:j._defaultProvider||null}}const a=networks[_.name];if(!a)return typeof _.chainId!="number"&&logger$8.throwArgumentError("invalid network chainId","network",_),_;_.chainId!==0&&_.chainId!==a.chainId&&logger$8.throwArgumentError("network chainId mismatch","network",_);let $=_._defaultProvider||null;return $==null&&a._defaultProvider&&(isRenetworkable(a._defaultProvider)?$=a._defaultProvider.renetwork(_):$=a._defaultProvider),{name:_.name,chainId:a.chainId,ensAddress:_.ensAddress||a.ensAddress||null,_defaultProvider:$}}const version$4="web/5.7.1";var __awaiter$3=globalThis&&globalThis.__awaiter||function(_,a,$,j){function _e(et){return et instanceof $?et:new $(function(tt){tt(et)})}return new($||($=Promise))(function(et,tt){function rt(st){try{it(j.next(st))}catch(ot){tt(ot)}}function nt(st){try{it(j.throw(st))}catch(ot){tt(ot)}}function it(st){st.done?et(st.value):_e(st.value).then(rt,nt)}it((j=j.apply(_,a||[])).next())})};function getUrl(_,a){return __awaiter$3(this,void 0,void 0,function*(){a==null&&(a={});const $={method:a.method||"GET",headers:a.headers||{},body:a.body||void 0};if(a.skipFetchSetup!==!0&&($.mode="cors",$.cache="no-cache",$.credentials="same-origin",$.redirect="follow",$.referrer="client"),a.fetchOptions!=null){const tt=a.fetchOptions;tt.mode&&($.mode=tt.mode),tt.cache&&($.cache=tt.cache),tt.credentials&&($.credentials=tt.credentials),tt.redirect&&($.redirect=tt.redirect),tt.referrer&&($.referrer=tt.referrer)}const j=yield fetch(_,$),_e=yield j.arrayBuffer(),et={};return j.headers.forEach?j.headers.forEach((tt,rt)=>{et[rt.toLowerCase()]=tt}):j.headers.keys().forEach(tt=>{et[tt.toLowerCase()]=j.headers.get(tt)}),{headers:et,statusCode:j.status,statusMessage:j.statusText,body:arrayify(new Uint8Array(_e))}})}var __awaiter$2=globalThis&&globalThis.__awaiter||function(_,a,$,j){function _e(et){return et instanceof $?et:new $(function(tt){tt(et)})}return new($||($=Promise))(function(et,tt){function rt(st){try{it(j.next(st))}catch(ot){tt(ot)}}function nt(st){try{it(j.throw(st))}catch(ot){tt(ot)}}function it(st){st.done?et(st.value):_e(st.value).then(rt,nt)}it((j=j.apply(_,a||[])).next())})};const logger$7=new Logger(version$4);function staller(_){return new Promise(a=>{setTimeout(a,_)})}function bodyify(_,a){if(_==null)return null;if(typeof _=="string")return _;if(isBytesLike(_)){if(a&&(a.split("/")[0]==="text"||a.split(";")[0].trim()==="application/json"))try{return toUtf8String(_)}catch{}return hexlify(_)}return _}function unpercent(_){return toUtf8Bytes(_.replace(/%([0-9a-f][0-9a-f])/gi,(a,$)=>String.fromCharCode(parseInt($,16))))}function _fetchData(_,a,$){const j=typeof _=="object"&&_.throttleLimit!=null?_.throttleLimit:12;logger$7.assertArgument(j>0&&j%1===0,"invalid connection throttle limit","connection.throttleLimit",j);const _e=typeof _=="object"?_.throttleCallback:null,et=typeof _=="object"&&typeof _.throttleSlotInterval=="number"?_.throttleSlotInterval:100;logger$7.assertArgument(et>0&&et%1===0,"invalid connection throttle slot interval","connection.throttleSlotInterval",et);const tt=typeof _=="object"?!!_.errorPassThrough:!1,rt={};let nt=null;const it={method:"GET"};let st=!1,ot=2*60*1e3;if(typeof _=="string")nt=_;else if(typeof _=="object"){if((_==null||_.url==null)&&logger$7.throwArgumentError("missing URL","connection.url",_),nt=_.url,typeof _.timeout=="number"&&_.timeout>0&&(ot=_.timeout),_.headers)for(const ft in _.headers)rt[ft.toLowerCase()]={key:ft,value:String(_.headers[ft])},["if-none-match","if-modified-since"].indexOf(ft.toLowerCase())>=0&&(st=!0);if(it.allowGzip=!!_.allowGzip,_.user!=null&&_.password!=null){nt.substring(0,6)!=="https:"&&_.allowInsecureAuthentication!==!0&&logger$7.throwError("basic authentication requires a secure https url",Logger.errors.INVALID_ARGUMENT,{argument:"url",url:nt,user:_.user,password:"[REDACTED]"});const ft=_.user+":"+_.password;rt.authorization={key:"Authorization",value:"Basic "+encode$w(toUtf8Bytes(ft))}}_.skipFetchSetup!=null&&(it.skipFetchSetup=!!_.skipFetchSetup),_.fetchOptions!=null&&(it.fetchOptions=shallowCopy(_.fetchOptions))}const at=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),lt=nt?nt.match(at):null;if(lt)try{const ft={statusCode:200,statusMessage:"OK",headers:{"content-type":lt[1]||"text/plain"},body:lt[2]?decode$s(lt[3]):unpercent(lt[3])};let pt=ft.body;return $&&(pt=$(ft.body,ft)),Promise.resolve(pt)}catch(ft){logger$7.throwError("processing response error",Logger.errors.SERVER_ERROR,{body:bodyify(lt[1],lt[2]),error:ft,requestBody:null,requestMethod:"GET",url:nt})}a&&(it.method="POST",it.body=a,rt["content-type"]==null&&(rt["content-type"]={key:"Content-Type",value:"application/octet-stream"}),rt["content-length"]==null&&(rt["content-length"]={key:"Content-Length",value:String(a.length)}));const ct={};Object.keys(rt).forEach(ft=>{const pt=rt[ft];ct[pt.key]=pt.value}),it.headers=ct;const ut=function(){let ft=null;return{promise:new Promise(function(mt,_t){ot&&(ft=setTimeout(()=>{ft!=null&&(ft=null,_t(logger$7.makeError("timeout",Logger.errors.TIMEOUT,{requestBody:bodyify(it.body,ct["content-type"]),requestMethod:it.method,timeout:ot,url:nt})))},ot))}),cancel:function(){ft!=null&&(clearTimeout(ft),ft=null)}}}(),dt=function(){return __awaiter$2(this,void 0,void 0,function*(){for(let ft=0;ft<j;ft++){let pt=null;try{if(pt=yield getUrl(nt,it),ft<j){if(pt.statusCode===301||pt.statusCode===302){const mt=pt.headers.location||"";if(it.method==="GET"&&mt.match(/^https:/)){nt=pt.headers.location;continue}}else if(pt.statusCode===429){let mt=!0;if(_e&&(mt=yield _e(ft,nt)),mt){let _t=0;const vt=pt.headers["retry-after"];typeof vt=="string"&&vt.match(/^[1-9][0-9]*$/)?_t=parseInt(vt)*1e3:_t=et*parseInt(String(Math.random()*Math.pow(2,ft))),yield staller(_t);continue}}}}catch(mt){pt=mt.response,pt==null&&(ut.cancel(),logger$7.throwError("missing response",Logger.errors.SERVER_ERROR,{requestBody:bodyify(it.body,ct["content-type"]),requestMethod:it.method,serverError:mt,url:nt}))}let yt=pt.body;if(st&&pt.statusCode===304?yt=null:!tt&&(pt.statusCode<200||pt.statusCode>=300)&&(ut.cancel(),logger$7.throwError("bad response",Logger.errors.SERVER_ERROR,{status:pt.statusCode,headers:pt.headers,body:bodyify(yt,pt.headers?pt.headers["content-type"]:null),requestBody:bodyify(it.body,ct["content-type"]),requestMethod:it.method,url:nt})),$)try{const mt=yield $(yt,pt);return ut.cancel(),mt}catch(mt){if(mt.throttleRetry&&ft<j){let _t=!0;if(_e&&(_t=yield _e(ft,nt)),_t){const vt=et*parseInt(String(Math.random()*Math.pow(2,ft)));yield staller(vt);continue}}ut.cancel(),logger$7.throwError("processing response error",Logger.errors.SERVER_ERROR,{body:bodyify(yt,pt.headers?pt.headers["content-type"]:null),error:mt,requestBody:bodyify(it.body,ct["content-type"]),requestMethod:it.method,url:nt})}return ut.cancel(),yt}return logger$7.throwError("failed response",Logger.errors.SERVER_ERROR,{requestBody:bodyify(it.body,ct["content-type"]),requestMethod:it.method,url:nt})})}();return Promise.race([ut.promise,dt])}function fetchJson(_,a,$){let j=(et,tt)=>{let rt=null;if(et!=null)try{rt=JSON.parse(toUtf8String(et))}catch(nt){logger$7.throwError("invalid JSON",Logger.errors.SERVER_ERROR,{body:et,error:nt})}return $&&(rt=$(rt,tt)),rt},_e=null;if(a!=null){_e=toUtf8Bytes(a);const et=typeof _=="string"?{url:_}:shallowCopy(_);et.headers?Object.keys(et.headers).filter(rt=>rt.toLowerCase()==="content-type").length!==0||(et.headers=shallowCopy(et.headers),et.headers["content-type"]="application/json"):et.headers={"content-type":"application/json"},_=et}return _fetchData(_,_e,j)}function poll(_,a){return a||(a={}),a=shallowCopy(a),a.floor==null&&(a.floor=0),a.ceiling==null&&(a.ceiling=1e4),a.interval==null&&(a.interval=250),new Promise(function($,j){let _e=null,et=!1;const tt=()=>et?!1:(et=!0,_e&&clearTimeout(_e),!0);a.timeout&&(_e=setTimeout(()=>{tt()&&j(new Error("timeout"))},a.timeout));const rt=a.retryLimit;let nt=0;function it(){return _().then(function(st){if(st!==void 0)tt()&&$(st);else if(a.oncePoll)a.oncePoll.once("poll",it);else if(a.onceBlock)a.onceBlock.once("block",it);else if(!et){if(nt++,nt>rt){tt()&&j(new Error("retry limit reached"));return}let ot=a.interval*parseInt(String(Math.random()*Math.pow(2,nt)));ot<a.floor&&(ot=a.floor),ot>a.ceiling&&(ot=a.ceiling),setTimeout(it,ot)}return null},function(st){tt()&&j(st)})}it()})}var ALPHABET="qpzry9x8gf2tvdw0s3jn54khce6mua7l",ALPHABET_MAP={};for(var z=0;z<ALPHABET.length;z++){var x=ALPHABET.charAt(z);if(ALPHABET_MAP[x]!==void 0)throw new TypeError(x+" is ambiguous");ALPHABET_MAP[x]=z}function polymodStep(_){var a=_>>25;return(_&33554431)<<5^-(a>>0&1)&996825010^-(a>>1&1)&642813549^-(a>>2&1)&513874426^-(a>>3&1)&1027748829^-(a>>4&1)&705979059}function prefixChk(_){for(var a=1,$=0;$<_.length;++$){var j=_.charCodeAt($);if(j<33||j>126)return"Invalid prefix ("+_+")";a=polymodStep(a)^j>>5}for(a=polymodStep(a),$=0;$<_.length;++$){var _e=_.charCodeAt($);a=polymodStep(a)^_e&31}return a}function encode$v(_,a,$){if($=$||90,_.length+7+a.length>$)throw new TypeError("Exceeds length limit");_=_.toLowerCase();var j=prefixChk(_);if(typeof j=="string")throw new Error(j);for(var _e=_+"1",et=0;et<a.length;++et){var tt=a[et];if(tt>>5!==0)throw new Error("Non 5-bit word");j=polymodStep(j)^tt,_e+=ALPHABET.charAt(tt)}for(et=0;et<6;++et)j=polymodStep(j);for(j^=1,et=0;et<6;++et){var rt=j>>(5-et)*5&31;_e+=ALPHABET.charAt(rt)}return _e}function __decode(_,a){if(a=a||90,_.length<8)return _+" too short";if(_.length>a)return"Exceeds length limit";var $=_.toLowerCase(),j=_.toUpperCase();if(_!==$&&_!==j)return"Mixed-case string "+_;_=$;var _e=_.lastIndexOf("1");if(_e===-1)return"No separator character for "+_;if(_e===0)return"Missing prefix for "+_;var et=_.slice(0,_e),tt=_.slice(_e+1);if(tt.length<6)return"Data too short";var rt=prefixChk(et);if(typeof rt=="string")return rt;for(var nt=[],it=0;it<tt.length;++it){var st=tt.charAt(it),ot=ALPHABET_MAP[st];if(ot===void 0)return"Unknown character "+st;rt=polymodStep(rt)^ot,!(it+6>=tt.length)&&nt.push(ot)}return rt!==1?"Invalid checksum for "+_:{prefix:et,words:nt}}function decodeUnsafe(){var _=__decode.apply(null,arguments);if(typeof _=="object")return _}function decode$r(_){var a=__decode.apply(null,arguments);if(typeof a=="object")return a;throw new Error(a)}function convert$1(_,a,$,j){for(var _e=0,et=0,tt=(1<<$)-1,rt=[],nt=0;nt<_.length;++nt)for(_e=_e<<a|_[nt],et+=a;et>=$;)et-=$,rt.push(_e>>et&tt);if(j)et>0&&rt.push(_e<<$-et&tt);else{if(et>=a)return"Excess padding";if(_e<<$-et&tt)return"Non-zero padding"}return rt}function toWordsUnsafe(_){var a=convert$1(_,8,5,!0);if(Array.isArray(a))return a}function toWords(_){var a=convert$1(_,8,5,!0);if(Array.isArray(a))return a;throw new Error(a)}function fromWordsUnsafe(_){var a=convert$1(_,5,8,!1);if(Array.isArray(a))return a}function fromWords(_){var a=convert$1(_,5,8,!1);if(Array.isArray(a))return a;throw new Error(a)}var bech32={decodeUnsafe,decode:decode$r,encode:encode$v,toWordsUnsafe,toWords,fromWordsUnsafe,fromWords};const version$3="providers/5.7.2",logger$6=new Logger(version$3);class Formatter{constructor(){this.formats=this.getDefaultFormats()}getDefaultFormats(){const a={},$=this.address.bind(this),j=this.bigNumber.bind(this),_e=this.blockTag.bind(this),et=this.data.bind(this),tt=this.hash.bind(this),rt=this.hex.bind(this),nt=this.number.bind(this),it=this.type.bind(this),st=ot=>this.data(ot,!0);return a.transaction={hash:tt,type:it,accessList:Formatter.allowNull(this.accessList.bind(this),null),blockHash:Formatter.allowNull(tt,null),blockNumber:Formatter.allowNull(nt,null),transactionIndex:Formatter.allowNull(nt,null),confirmations:Formatter.allowNull(nt,null),from:$,gasPrice:Formatter.allowNull(j),maxPriorityFeePerGas:Formatter.allowNull(j),maxFeePerGas:Formatter.allowNull(j),gasLimit:j,to:Formatter.allowNull($,null),value:j,nonce:nt,data:et,r:Formatter.allowNull(this.uint256),s:Formatter.allowNull(this.uint256),v:Formatter.allowNull(nt),creates:Formatter.allowNull($,null),raw:Formatter.allowNull(et)},a.transactionRequest={from:Formatter.allowNull($),nonce:Formatter.allowNull(nt),gasLimit:Formatter.allowNull(j),gasPrice:Formatter.allowNull(j),maxPriorityFeePerGas:Formatter.allowNull(j),maxFeePerGas:Formatter.allowNull(j),to:Formatter.allowNull($),value:Formatter.allowNull(j),data:Formatter.allowNull(st),type:Formatter.allowNull(nt),accessList:Formatter.allowNull(this.accessList.bind(this),null)},a.receiptLog={transactionIndex:nt,blockNumber:nt,transactionHash:tt,address:$,topics:Formatter.arrayOf(tt),data:et,logIndex:nt,blockHash:tt},a.receipt={to:Formatter.allowNull(this.address,null),from:Formatter.allowNull(this.address,null),contractAddress:Formatter.allowNull($,null),transactionIndex:nt,root:Formatter.allowNull(rt),gasUsed:j,logsBloom:Formatter.allowNull(et),blockHash:tt,transactionHash:tt,logs:Formatter.arrayOf(this.receiptLog.bind(this)),blockNumber:nt,confirmations:Formatter.allowNull(nt,null),cumulativeGasUsed:j,effectiveGasPrice:Formatter.allowNull(j),status:Formatter.allowNull(nt),type:it},a.block={hash:Formatter.allowNull(tt),parentHash:tt,number:nt,timestamp:nt,nonce:Formatter.allowNull(rt),difficulty:this.difficulty.bind(this),gasLimit:j,gasUsed:j,miner:Formatter.allowNull($),extraData:et,transactions:Formatter.allowNull(Formatter.arrayOf(tt)),baseFeePerGas:Formatter.allowNull(j)},a.blockWithTransactions=shallowCopy(a.block),a.blockWithTransactions.transactions=Formatter.allowNull(Formatter.arrayOf(this.transactionResponse.bind(this))),a.filter={fromBlock:Formatter.allowNull(_e,void 0),toBlock:Formatter.allowNull(_e,void 0),blockHash:Formatter.allowNull(tt,void 0),address:Formatter.allowNull($,void 0),topics:Formatter.allowNull(this.topics.bind(this),void 0)},a.filterLog={blockNumber:Formatter.allowNull(nt),blockHash:Formatter.allowNull(tt),transactionIndex:nt,removed:Formatter.allowNull(this.boolean.bind(this)),address:$,data:Formatter.allowFalsish(et,"0x"),topics:Formatter.arrayOf(tt),transactionHash:tt,logIndex:nt},a}accessList(a){return accessListify(a||[])}number(a){return a==="0x"?0:BigNumber.from(a).toNumber()}type(a){return a==="0x"||a==null?0:BigNumber.from(a).toNumber()}bigNumber(a){return BigNumber.from(a)}boolean(a){if(typeof a=="boolean")return a;if(typeof a=="string"){if(a=a.toLowerCase(),a==="true")return!0;if(a==="false")return!1}throw new Error("invalid boolean - "+a)}hex(a,$){return typeof a=="string"&&(!$&&a.substring(0,2)!=="0x"&&(a="0x"+a),isHexString(a))?a.toLowerCase():logger$6.throwArgumentError("invalid hash","value",a)}data(a,$){const j=this.hex(a,$);if(j.length%2!==0)throw new Error("invalid data; odd-length - "+a);return j}address(a){return getAddress(a)}callAddress(a){if(!isHexString(a,32))return null;const $=getAddress(hexDataSlice(a,12));return $===AddressZero?null:$}contractAddress(a){return getContractAddress(a)}blockTag(a){if(a==null)return"latest";if(a==="earliest")return"0x0";switch(a){case"earliest":return"0x0";case"latest":case"pending":case"safe":case"finalized":return a}if(typeof a=="number"||isHexString(a))return hexValue(a);throw new Error("invalid blockTag")}hash(a,$){const j=this.hex(a,$);return hexDataLength(j)!==32?logger$6.throwArgumentError("invalid hash","value",a):j}difficulty(a){if(a==null)return null;const $=BigNumber.from(a);try{return $.toNumber()}catch{}return null}uint256(a){if(!isHexString(a))throw new Error("invalid uint256");return hexZeroPad(a,32)}_block(a,$){a.author!=null&&a.miner==null&&(a.miner=a.author);const j=a._difficulty!=null?a._difficulty:a.difficulty,_e=Formatter.check($,a);return _e._difficulty=j==null?null:BigNumber.from(j),_e}block(a){return this._block(a,this.formats.block)}blockWithTransactions(a){return this._block(a,this.formats.blockWithTransactions)}transactionRequest(a){return Formatter.check(this.formats.transactionRequest,a)}transactionResponse(a){a.gas!=null&&a.gasLimit==null&&(a.gasLimit=a.gas),a.to&&BigNumber.from(a.to).isZero()&&(a.to="0x0000000000000000000000000000000000000000"),a.input!=null&&a.data==null&&(a.data=a.input),a.to==null&&a.creates==null&&(a.creates=this.contractAddress(a)),(a.type===1||a.type===2)&&a.accessList==null&&(a.accessList=[]);const $=Formatter.check(this.formats.transaction,a);if(a.chainId!=null){let j=a.chainId;isHexString(j)&&(j=BigNumber.from(j).toNumber()),$.chainId=j}else{let j=a.networkId;j==null&&$.v==null&&(j=a.chainId),isHexString(j)&&(j=BigNumber.from(j).toNumber()),typeof j!="number"&&$.v!=null&&(j=($.v-35)/2,j<0&&(j=0),j=parseInt(j)),typeof j!="number"&&(j=0),$.chainId=j}return $.blockHash&&$.blockHash.replace(/0/g,"")==="x"&&($.blockHash=null),$}transaction(a){return parse$4(a)}receiptLog(a){return Formatter.check(this.formats.receiptLog,a)}receipt(a){const $=Formatter.check(this.formats.receipt,a);if($.root!=null)if($.root.length<=4){const j=BigNumber.from($.root).toNumber();j===0||j===1?($.status!=null&&$.status!==j&&logger$6.throwArgumentError("alt-root-status/status mismatch","value",{root:$.root,status:$.status}),$.status=j,delete $.root):logger$6.throwArgumentError("invalid alt-root-status","value.root",$.root)}else $.root.length!==66&&logger$6.throwArgumentError("invalid root hash","value.root",$.root);return $.status!=null&&($.byzantium=!0),$}topics(a){return Array.isArray(a)?a.map($=>this.topics($)):a!=null?this.hash(a,!0):null}filter(a){return Formatter.check(this.formats.filter,a)}filterLog(a){return Formatter.check(this.formats.filterLog,a)}static check(a,$){const j={};for(const _e in a)try{const et=a[_e]($[_e]);et!==void 0&&(j[_e]=et)}catch(et){throw et.checkKey=_e,et.checkValue=$[_e],et}return j}static allowNull(a,$){return function(j){return j==null?$:a(j)}}static allowFalsish(a,$){return function(j){return j?a(j):$}}static arrayOf(a){return function($){if(!Array.isArray($))throw new Error("not an array");const j=[];return $.forEach(function(_e){j.push(a(_e))}),j}}}var __awaiter$1=globalThis&&globalThis.__awaiter||function(_,a,$,j){function _e(et){return et instanceof $?et:new $(function(tt){tt(et)})}return new($||($=Promise))(function(et,tt){function rt(st){try{it(j.next(st))}catch(ot){tt(ot)}}function nt(st){try{it(j.throw(st))}catch(ot){tt(ot)}}function it(st){st.done?et(st.value):_e(st.value).then(rt,nt)}it((j=j.apply(_,a||[])).next())})};const logger$5=new Logger(version$3),MAX_CCIP_REDIRECTS=10;function checkTopic(_){return _==null?"null":(hexDataLength(_)!==32&&logger$5.throwArgumentError("invalid topic","topic",_),_.toLowerCase())}function serializeTopics(_){for(_=_.slice();_.length>0&&_[_.length-1]==null;)_.pop();return _.map(a=>{if(Array.isArray(a)){const $={};a.forEach(_e=>{$[checkTopic(_e)]=!0});const j=Object.keys($);return j.sort(),j.join("|")}else return checkTopic(a)}).join("&")}function deserializeTopics(_){return _===""?[]:_.split(/&/g).map(a=>{if(a==="")return[];const $=a.split("|").map(j=>j==="null"?null:j);return $.length===1?$[0]:$})}function getEventTag(_){if(typeof _=="string"){if(_=_.toLowerCase(),hexDataLength(_)===32)return"tx:"+_;if(_.indexOf(":")===-1)return _}else{if(Array.isArray(_))return"filter:*:"+serializeTopics(_);if(ForkEvent.isForkEvent(_))throw logger$5.warn("not implemented"),new Error("not implemented");if(_&&typeof _=="object")return"filter:"+(_.address||"*")+":"+serializeTopics(_.topics||[])}throw new Error("invalid event - "+_)}function getTime$1(){return new Date().getTime()}function stall(_){return new Promise(a=>{setTimeout(a,_)})}const PollableEvents=["block","network","pending","poll"];class Event$1{constructor(a,$,j){defineReadOnly(this,"tag",a),defineReadOnly(this,"listener",$),defineReadOnly(this,"once",j),this._lastBlockNumber=-2,this._inflight=!1}get event(){switch(this.type){case"tx":return this.hash;case"filter":return this.filter}return this.tag}get type(){return this.tag.split(":")[0]}get hash(){const a=this.tag.split(":");return a[0]!=="tx"?null:a[1]}get filter(){const a=this.tag.split(":");if(a[0]!=="filter")return null;const $=a[1],j=deserializeTopics(a[2]),_e={};return j.length>0&&(_e.topics=j),$&&$!=="*"&&(_e.address=$),_e}pollable(){return this.tag.indexOf(":")>=0||PollableEvents.indexOf(this.tag)>=0}}const coinInfos={0:{symbol:"btc",p2pkh:0,p2sh:5,prefix:"bc"},2:{symbol:"ltc",p2pkh:48,p2sh:50,prefix:"ltc"},3:{symbol:"doge",p2pkh:30,p2sh:22},60:{symbol:"eth",ilk:"eth"},61:{symbol:"etc",ilk:"eth"},700:{symbol:"xdai",ilk:"eth"}};function bytes32ify(_){return hexZeroPad(BigNumber.from(_).toHexString(),32)}function base58Encode(_){return Base58.encode(concat$3([_,hexDataSlice(sha256$5(sha256$5(_)),0,4)]))}const matcherIpfs=new RegExp("^(ipfs)://(.*)$","i"),matchers=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),matcherIpfs,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];function _parseString(_,a){try{return toUtf8String(_parseBytes(_,a))}catch{}return null}function _parseBytes(_,a){if(_==="0x")return null;const $=BigNumber.from(hexDataSlice(_,a,a+32)).toNumber(),j=BigNumber.from(hexDataSlice(_,$,$+32)).toNumber();return hexDataSlice(_,$+32,$+32+j)}function getIpfsLink(_){return _.match(/^ipfs:\/\/ipfs\//i)?_=_.substring(12):_.match(/^ipfs:\/\//i)?_=_.substring(7):logger$5.throwArgumentError("unsupported IPFS format","link",_),`https://gateway.ipfs.io/ipfs/${_}`}function numPad(_){const a=arrayify(_);if(a.length>32)throw new Error("internal; should not happen");const $=new Uint8Array(32);return $.set(a,32-a.length),$}function bytesPad(_){if(_.length%32===0)return _;const a=new Uint8Array(Math.ceil(_.length/32)*32);return a.set(_),a}function encodeBytes$1(_){const a=[];let $=0;for(let j=0;j<_.length;j++)a.push(null),$+=32;for(let j=0;j<_.length;j++){const _e=arrayify(_[j]);a[j]=numPad($),a.push(numPad(_e.length)),a.push(bytesPad(_e)),$+=32+Math.ceil(_e.length/32)*32}return hexConcat(a)}class Resolver$1{constructor(a,$,j,_e){defineReadOnly(this,"provider",a),defineReadOnly(this,"name",j),defineReadOnly(this,"address",a.formatter.address($)),defineReadOnly(this,"_resolvedAddress",_e)}supportsWildcard(){return this._supportsEip2544||(this._supportsEip2544=this.provider.call({to:this.address,data:"0x01ffc9a79061b92300000000000000000000000000000000000000000000000000000000"}).then(a=>BigNumber.from(a).eq(1)).catch(a=>{if(a.code===Logger.errors.CALL_EXCEPTION)return!1;throw this._supportsEip2544=null,a})),this._supportsEip2544}_fetch(a,$){return __awaiter$1(this,void 0,void 0,function*(){const j={to:this.address,ccipReadEnabled:!0,data:hexConcat([a,namehash(this.name),$||"0x"])};let _e=!1;(yield this.supportsWildcard())&&(_e=!0,j.data=hexConcat(["0x9061b923",encodeBytes$1([dnsEncode(this.name),j.data])]));try{let et=yield this.provider.call(j);return arrayify(et).length%32===4&&logger$5.throwError("resolver threw error",Logger.errors.CALL_EXCEPTION,{transaction:j,data:et}),_e&&(et=_parseBytes(et,0)),et}catch(et){if(et.code===Logger.errors.CALL_EXCEPTION)return null;throw et}})}_fetchBytes(a,$){return __awaiter$1(this,void 0,void 0,function*(){const j=yield this._fetch(a,$);return j!=null?_parseBytes(j,0):null})}_getAddress(a,$){const j=coinInfos[String(a)];if(j==null&&logger$5.throwError(`unsupported coin type: ${a}`,Logger.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${a})`}),j.ilk==="eth")return this.provider.formatter.address($);const _e=arrayify($);if(j.p2pkh!=null){const et=$.match(/^0x76a9([0-9a-f][0-9a-f])([0-9a-f]*)88ac$/);if(et){const tt=parseInt(et[1],16);if(et[2].length===tt*2&&tt>=1&&tt<=75)return base58Encode(concat$3([[j.p2pkh],"0x"+et[2]]))}}if(j.p2sh!=null){const et=$.match(/^0xa9([0-9a-f][0-9a-f])([0-9a-f]*)87$/);if(et){const tt=parseInt(et[1],16);if(et[2].length===tt*2&&tt>=1&&tt<=75)return base58Encode(concat$3([[j.p2sh],"0x"+et[2]]))}}if(j.prefix!=null){const et=_e[1];let tt=_e[0];if(tt===0?et!==20&&et!==32&&(tt=-1):tt=-1,tt>=0&&_e.length===2+et&&et>=1&&et<=75){const rt=bech32.toWords(_e.slice(2));return rt.unshift(tt),bech32.encode(j.prefix,rt)}}return null}getAddress(a){return __awaiter$1(this,void 0,void 0,function*(){if(a==null&&(a=60),a===60)try{const _e=yield this._fetch("0x3b3b57de");return _e==="0x"||_e===HashZero?null:this.provider.formatter.callAddress(_e)}catch(_e){if(_e.code===Logger.errors.CALL_EXCEPTION)return null;throw _e}const $=yield this._fetchBytes("0xf1cb7e06",bytes32ify(a));if($==null||$==="0x")return null;const j=this._getAddress(a,$);return j==null&&logger$5.throwError("invalid or unsupported coin data",Logger.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${a})`,coinType:a,data:$}),j})}getAvatar(){return __awaiter$1(this,void 0,void 0,function*(){const a=[{type:"name",content:this.name}];try{const $=yield this.getText("avatar");if($==null)return null;for(let j=0;j<matchers.length;j++){const _e=$.match(matchers[j]);if(_e==null)continue;const et=_e[1].toLowerCase();switch(et){case"https":return a.push({type:"url",content:$}),{linkage:a,url:$};case"data":return a.push({type:"data",content:$}),{linkage:a,url:$};case"ipfs":return a.push({type:"ipfs",content:$}),{linkage:a,url:getIpfsLink($)};case"erc721":case"erc1155":{const tt=et==="erc721"?"0xc87b56dd":"0x0e89341c";a.push({type:et,content:$});const rt=this._resolvedAddress||(yield this.getAddress()),nt=(_e[2]||"").split("/");if(nt.length!==2)return null;const it=yield this.provider.formatter.address(nt[0]),st=hexZeroPad(BigNumber.from(nt[1]).toHexString(),32);if(et==="erc721"){const ut=this.provider.formatter.callAddress(yield this.provider.call({to:it,data:hexConcat(["0x6352211e",st])}));if(rt!==ut)return null;a.push({type:"owner",content:ut})}else if(et==="erc1155"){const ut=BigNumber.from(yield this.provider.call({to:it,data:hexConcat(["0x00fdd58e",hexZeroPad(rt,32),st])}));if(ut.isZero())return null;a.push({type:"balance",content:ut.toString()})}const ot={to:this.provider.formatter.address(nt[0]),data:hexConcat([tt,st])};let at=_parseString(yield this.provider.call(ot),0);if(at==null)return null;a.push({type:"metadata-url-base",content:at}),et==="erc1155"&&(at=at.replace("{id}",st.substring(2)),a.push({type:"metadata-url-expanded",content:at})),at.match(/^ipfs:/i)&&(at=getIpfsLink(at)),a.push({type:"metadata-url",content:at});const lt=yield fetchJson(at);if(!lt)return null;a.push({type:"metadata",content:JSON.stringify(lt)});let ct=lt.image;if(typeof ct!="string")return null;if(!ct.match(/^(https:\/\/|data:)/i)){if(ct.match(matcherIpfs)==null)return null;a.push({type:"url-ipfs",content:ct}),ct=getIpfsLink(ct)}return a.push({type:"url",content:ct}),{linkage:a,url:ct}}}}}catch{}return null})}getContentHash(){return __awaiter$1(this,void 0,void 0,function*(){const a=yield this._fetchBytes("0xbc1c58d1");if(a==null||a==="0x")return null;const $=a.match(/^0xe3010170(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if($){const tt=parseInt($[3],16);if($[4].length===tt*2)return"ipfs://"+Base58.encode("0x"+$[1])}const j=a.match(/^0xe5010172(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(j){const tt=parseInt(j[3],16);if(j[4].length===tt*2)return"ipns://"+Base58.encode("0x"+j[1])}const _e=a.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(_e&&_e[1].length===32*2)return"bzz://"+_e[1];const et=a.match(/^0x90b2c605([0-9a-f]*)$/);if(et&&et[1].length===34*2){const tt={"=":"","+":"-","/":"_"};return"sia://"+encode$w("0x"+et[1]).replace(/[=+\/]/g,nt=>tt[nt])}return logger$5.throwError("invalid or unsupported content hash data",Logger.errors.UNSUPPORTED_OPERATION,{operation:"getContentHash()",data:a})})}getText(a){return __awaiter$1(this,void 0,void 0,function*(){let $=toUtf8Bytes(a);$=concat$3([bytes32ify(64),bytes32ify($.length),$]),$.length%32!==0&&($=concat$3([$,hexZeroPad("0x",32-a.length%32)]));const j=yield this._fetchBytes("0x59d1d43c",hexlify($));return j==null||j==="0x"?null:toUtf8String(j)})}}let defaultFormatter=null,nextPollId=1;class BaseProvider extends Provider$1{constructor(a){if(super(),this._events=[],this._emitted={block:-2},this.disableCcipRead=!1,this.formatter=new.target.getFormatter(),defineReadOnly(this,"anyNetwork",a==="any"),this.anyNetwork&&(a=this.detectNetwork()),a instanceof Promise)this._networkPromise=a,a.catch($=>{}),this._ready().catch($=>{});else{const $=getStatic(new.target,"getNetwork")(a);$?(defineReadOnly(this,"_network",$),this.emit("network",$,null)):logger$5.throwArgumentError("invalid network","network",a)}this._maxInternalBlockNumber=-1024,this._lastBlockNumber=-2,this._maxFilterBlockRange=10,this._pollingInterval=4e3,this._fastQueryDate=0}_ready(){return __awaiter$1(this,void 0,void 0,function*(){if(this._network==null){let a=null;if(this._networkPromise)try{a=yield this._networkPromise}catch{}a==null&&(a=yield this.detectNetwork()),a||logger$5.throwError("no network detected",Logger.errors.UNKNOWN_ERROR,{}),this._network==null&&(this.anyNetwork?this._network=a:defineReadOnly(this,"_network",a),this.emit("network",a,null))}return this._network})}get ready(){return poll(()=>this._ready().then(a=>a,a=>{if(!(a.code===Logger.errors.NETWORK_ERROR&&a.event==="noNetwork"))throw a}))}static getFormatter(){return defaultFormatter==null&&(defaultFormatter=new Formatter),defaultFormatter}static getNetwork(a){return getNetwork(a??"homestead")}ccipReadFetch(a,$,j){return __awaiter$1(this,void 0,void 0,function*(){if(this.disableCcipRead||j.length===0)return null;const _e=a.to.toLowerCase(),et=$.toLowerCase(),tt=[];for(let rt=0;rt<j.length;rt++){const nt=j[rt],it=nt.replace("{sender}",_e).replace("{data}",et),st=nt.indexOf("{data}")>=0?null:JSON.stringify({data:et,sender:_e}),ot=yield fetchJson({url:it,errorPassThrough:!0},st,(lt,ct)=>(lt.status=ct.statusCode,lt));if(ot.data)return ot.data;const at=ot.message||"unknown error";if(ot.status>=400&&ot.status<500)return logger$5.throwError(`response not found during CCIP fetch: ${at}`,Logger.errors.SERVER_ERROR,{url:nt,errorMessage:at});tt.push(at)}return logger$5.throwError(`error encountered during CCIP fetch: ${tt.map(rt=>JSON.stringify(rt)).join(", ")}`,Logger.errors.SERVER_ERROR,{urls:j,errorMessages:tt})})}_getInternalBlockNumber(a){return __awaiter$1(this,void 0,void 0,function*(){if(yield this._ready(),a>0)for(;this._internalBlockNumber;){const _e=this._internalBlockNumber;try{const et=yield _e;if(getTime$1()-et.respTime<=a)return et.blockNumber;break}catch{if(this._internalBlockNumber===_e)break}}const $=getTime$1(),j=resolveProperties({blockNumber:this.perform("getBlockNumber",{}),networkError:this.getNetwork().then(_e=>null,_e=>_e)}).then(({blockNumber:_e,networkError:et})=>{if(et)throw this._internalBlockNumber===j&&(this._internalBlockNumber=null),et;const tt=getTime$1();return _e=BigNumber.from(_e).toNumber(),_e<this._maxInternalBlockNumber&&(_e=this._maxInternalBlockNumber),this._maxInternalBlockNumber=_e,this._setFastBlockNumber(_e),{blockNumber:_e,reqTime:$,respTime:tt}});return this._internalBlockNumber=j,j.catch(_e=>{this._internalBlockNumber===j&&(this._internalBlockNumber=null)}),(yield j).blockNumber})}poll(){return __awaiter$1(this,void 0,void 0,function*(){const a=nextPollId++,$=[];let j=null;try{j=yield this._getInternalBlockNumber(100+this.pollingInterval/2)}catch(_e){this.emit("error",_e);return}if(this._setFastBlockNumber(j),this.emit("poll",a,j),j===this._lastBlockNumber){this.emit("didPoll",a);return}if(this._emitted.block===-2&&(this._emitted.block=j-1),Math.abs(this._emitted.block-j)>1e3)logger$5.warn(`network block skew detected; skipping block events (emitted=${this._emitted.block} blockNumber${j})`),this.emit("error",logger$5.makeError("network block skew detected",Logger.errors.NETWORK_ERROR,{blockNumber:j,event:"blockSkew",previousBlockNumber:this._emitted.block})),this.emit("block",j);else for(let _e=this._emitted.block+1;_e<=j;_e++)this.emit("block",_e);this._emitted.block!==j&&(this._emitted.block=j,Object.keys(this._emitted).forEach(_e=>{if(_e==="block")return;const et=this._emitted[_e];et!=="pending"&&j-et>12&&delete this._emitted[_e]})),this._lastBlockNumber===-2&&(this._lastBlockNumber=j-1),this._events.forEach(_e=>{switch(_e.type){case"tx":{const et=_e.hash;let tt=this.getTransactionReceipt(et).then(rt=>(!rt||rt.blockNumber==null||(this._emitted["t:"+et]=rt.blockNumber,this.emit(et,rt)),null)).catch(rt=>{this.emit("error",rt)});$.push(tt);break}case"filter":{if(!_e._inflight){_e._inflight=!0,_e._lastBlockNumber===-2&&(_e._lastBlockNumber=j-1);const et=_e.filter;et.fromBlock=_e._lastBlockNumber+1,et.toBlock=j;const tt=et.toBlock-this._maxFilterBlockRange;tt>et.fromBlock&&(et.fromBlock=tt),et.fromBlock<0&&(et.fromBlock=0);const rt=this.getLogs(et).then(nt=>{_e._inflight=!1,nt.length!==0&&nt.forEach(it=>{it.blockNumber>_e._lastBlockNumber&&(_e._lastBlockNumber=it.blockNumber),this._emitted["b:"+it.blockHash]=it.blockNumber,this._emitted["t:"+it.transactionHash]=it.blockNumber,this.emit(et,it)})}).catch(nt=>{this.emit("error",nt),_e._inflight=!1});$.push(rt)}break}}}),this._lastBlockNumber=j,Promise.all($).then(()=>{this.emit("didPoll",a)}).catch(_e=>{this.emit("error",_e)})})}resetEventsBlock(a){this._lastBlockNumber=a-1,this.polling&&this.poll()}get network(){return this._network}detectNetwork(){return __awaiter$1(this,void 0,void 0,function*(){return logger$5.throwError("provider does not support network detection",Logger.errors.UNSUPPORTED_OPERATION,{operation:"provider.detectNetwork"})})}getNetwork(){return __awaiter$1(this,void 0,void 0,function*(){const a=yield this._ready(),$=yield this.detectNetwork();if(a.chainId!==$.chainId){if(this.anyNetwork)return this._network=$,this._lastBlockNumber=-2,this._fastBlockNumber=null,this._fastBlockNumberPromise=null,this._fastQueryDate=0,this._emitted.block=-2,this._maxInternalBlockNumber=-1024,this._internalBlockNumber=null,this.emit("network",$,a),yield stall(0),this._network;const j=logger$5.makeError("underlying network changed",Logger.errors.NETWORK_ERROR,{event:"changed",network:a,detectedNetwork:$});throw this.emit("error",j),j}return a})}get blockNumber(){return this._getInternalBlockNumber(100+this.pollingInterval/2).then(a=>{this._setFastBlockNumber(a)},a=>{}),this._fastBlockNumber!=null?this._fastBlockNumber:-1}get polling(){return this._poller!=null}set polling(a){a&&!this._poller?(this._poller=setInterval(()=>{this.poll()},this.pollingInterval),this._bootstrapPoll||(this._bootstrapPoll=setTimeout(()=>{this.poll(),this._bootstrapPoll=setTimeout(()=>{this._poller||this.poll(),this._bootstrapPoll=null},this.pollingInterval)},0))):!a&&this._poller&&(clearInterval(this._poller),this._poller=null)}get pollingInterval(){return this._pollingInterval}set pollingInterval(a){if(typeof a!="number"||a<=0||parseInt(String(a))!=a)throw new Error("invalid polling interval");this._pollingInterval=a,this._poller&&(clearInterval(this._poller),this._poller=setInterval(()=>{this.poll()},this._pollingInterval))}_getFastBlockNumber(){const a=getTime$1();return a-this._fastQueryDate>2*this._pollingInterval&&(this._fastQueryDate=a,this._fastBlockNumberPromise=this.getBlockNumber().then($=>((this._fastBlockNumber==null||$>this._fastBlockNumber)&&(this._fastBlockNumber=$),this._fastBlockNumber))),this._fastBlockNumberPromise}_setFastBlockNumber(a){this._fastBlockNumber!=null&&a<this._fastBlockNumber||(this._fastQueryDate=getTime$1(),(this._fastBlockNumber==null||a>this._fastBlockNumber)&&(this._fastBlockNumber=a,this._fastBlockNumberPromise=Promise.resolve(a)))}waitForTransaction(a,$,j){return __awaiter$1(this,void 0,void 0,function*(){return this._waitForTransaction(a,$??1,j||0,null)})}_waitForTransaction(a,$,j,_e){return __awaiter$1(this,void 0,void 0,function*(){const et=yield this.getTransactionReceipt(a);return(et?et.confirmations:0)>=$?et:new Promise((tt,rt)=>{const nt=[];let it=!1;const st=function(){return it?!0:(it=!0,nt.forEach(at=>{at()}),!1)},ot=at=>{at.confirmations<$||st()||tt(at)};if(this.on(a,ot),nt.push(()=>{this.removeListener(a,ot)}),_e){let at=_e.startBlock,lt=null;const ct=ut=>__awaiter$1(this,void 0,void 0,function*(){it||(yield stall(1e3),this.getTransactionCount(_e.from).then(dt=>__awaiter$1(this,void 0,void 0,function*(){if(!it){if(dt<=_e.nonce)at=ut;else{{const ft=yield this.getTransaction(a);if(ft&&ft.blockNumber!=null)return}for(lt==null&&(lt=at-3,lt<_e.startBlock&&(lt=_e.startBlock));lt<=ut;){if(it)return;const ft=yield this.getBlockWithTransactions(lt);for(let pt=0;pt<ft.transactions.length;pt++){const yt=ft.transactions[pt];if(yt.hash===a)return;if(yt.from===_e.from&&yt.nonce===_e.nonce){if(it)return;const mt=yield this.waitForTransaction(yt.hash,$);if(st())return;let _t="replaced";yt.data===_e.data&&yt.to===_e.to&&yt.value.eq(_e.value)?_t="repriced":yt.data==="0x"&&yt.from===yt.to&&yt.value.isZero()&&(_t="cancelled"),rt(logger$5.makeError("transaction was replaced",Logger.errors.TRANSACTION_REPLACED,{cancelled:_t==="replaced"||_t==="cancelled",reason:_t,replacement:this._wrapTransaction(yt),hash:a,receipt:mt}));return}}lt++}}it||this.once("block",ct)}}),dt=>{it||this.once("block",ct)}))});if(it)return;this.once("block",ct),nt.push(()=>{this.removeListener("block",ct)})}if(typeof j=="number"&&j>0){const at=setTimeout(()=>{st()||rt(logger$5.makeError("timeout exceeded",Logger.errors.TIMEOUT,{timeout:j}))},j);at.unref&&at.unref(),nt.push(()=>{clearTimeout(at)})}})})}getBlockNumber(){return __awaiter$1(this,void 0,void 0,function*(){return this._getInternalBlockNumber(0)})}getGasPrice(){return __awaiter$1(this,void 0,void 0,function*(){yield this.getNetwork();const a=yield this.perform("getGasPrice",{});try{return BigNumber.from(a)}catch($){return logger$5.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"getGasPrice",result:a,error:$})}})}getBalance(a,$){return __awaiter$1(this,void 0,void 0,function*(){yield this.getNetwork();const j=yield resolveProperties({address:this._getAddress(a),blockTag:this._getBlockTag($)}),_e=yield this.perform("getBalance",j);try{return BigNumber.from(_e)}catch(et){return logger$5.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"getBalance",params:j,result:_e,error:et})}})}getTransactionCount(a,$){return __awaiter$1(this,void 0,void 0,function*(){yield this.getNetwork();const j=yield resolveProperties({address:this._getAddress(a),blockTag:this._getBlockTag($)}),_e=yield this.perform("getTransactionCount",j);try{return BigNumber.from(_e).toNumber()}catch(et){return logger$5.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"getTransactionCount",params:j,result:_e,error:et})}})}getCode(a,$){return __awaiter$1(this,void 0,void 0,function*(){yield this.getNetwork();const j=yield resolveProperties({address:this._getAddress(a),blockTag:this._getBlockTag($)}),_e=yield this.perform("getCode",j);try{return hexlify(_e)}catch(et){return logger$5.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"getCode",params:j,result:_e,error:et})}})}getStorageAt(a,$,j){return __awaiter$1(this,void 0,void 0,function*(){yield this.getNetwork();const _e=yield resolveProperties({address:this._getAddress(a),blockTag:this._getBlockTag(j),position:Promise.resolve($).then(tt=>hexValue(tt))}),et=yield this.perform("getStorageAt",_e);try{return hexlify(et)}catch(tt){return logger$5.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"getStorageAt",params:_e,result:et,error:tt})}})}_wrapTransaction(a,$,j){if($!=null&&hexDataLength($)!==32)throw new Error("invalid response - sendTransaction");const _e=a;return $!=null&&a.hash!==$&&logger$5.throwError("Transaction hash mismatch from Provider.sendTransaction.",Logger.errors.UNKNOWN_ERROR,{expectedHash:a.hash,returnedHash:$}),_e.wait=(et,tt)=>__awaiter$1(this,void 0,void 0,function*(){et==null&&(et=1),tt==null&&(tt=0);let rt;et!==0&&j!=null&&(rt={data:a.data,from:a.from,nonce:a.nonce,to:a.to,value:a.value,startBlock:j});const nt=yield this._waitForTransaction(a.hash,et,tt,rt);return nt==null&&et===0?null:(this._emitted["t:"+a.hash]=nt.blockNumber,nt.status===0&&logger$5.throwError("transaction failed",Logger.errors.CALL_EXCEPTION,{transactionHash:a.hash,transaction:a,receipt:nt}),nt)}),_e}sendTransaction(a){return __awaiter$1(this,void 0,void 0,function*(){yield this.getNetwork();const $=yield Promise.resolve(a).then(et=>hexlify(et)),j=this.formatter.transaction(a);j.confirmations==null&&(j.confirmations=0);const _e=yield this._getInternalBlockNumber(100+2*this.pollingInterval);try{const et=yield this.perform("sendTransaction",{signedTransaction:$});return this._wrapTransaction(j,et,_e)}catch(et){throw et.transaction=j,et.transactionHash=j.hash,et}})}_getTransactionRequest(a){return __awaiter$1(this,void 0,void 0,function*(){const $=yield a,j={};return["from","to"].forEach(_e=>{$[_e]!=null&&(j[_e]=Promise.resolve($[_e]).then(et=>et?this._getAddress(et):null))}),["gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","value"].forEach(_e=>{$[_e]!=null&&(j[_e]=Promise.resolve($[_e]).then(et=>et?BigNumber.from(et):null))}),["type"].forEach(_e=>{$[_e]!=null&&(j[_e]=Promise.resolve($[_e]).then(et=>et??null))}),$.accessList&&(j.accessList=this.formatter.accessList($.accessList)),["data"].forEach(_e=>{$[_e]!=null&&(j[_e]=Promise.resolve($[_e]).then(et=>et?hexlify(et):null))}),this.formatter.transactionRequest(yield resolveProperties(j))})}_getFilter(a){return __awaiter$1(this,void 0,void 0,function*(){a=yield a;const $={};return a.address!=null&&($.address=this._getAddress(a.address)),["blockHash","topics"].forEach(j=>{a[j]!=null&&($[j]=a[j])}),["fromBlock","toBlock"].forEach(j=>{a[j]!=null&&($[j]=this._getBlockTag(a[j]))}),this.formatter.filter(yield resolveProperties($))})}_call(a,$,j){return __awaiter$1(this,void 0,void 0,function*(){j>=MAX_CCIP_REDIRECTS&&logger$5.throwError("CCIP read exceeded maximum redirections",Logger.errors.SERVER_ERROR,{redirects:j,transaction:a});const _e=a.to,et=yield this.perform("call",{transaction:a,blockTag:$});if(j>=0&&$==="latest"&&_e!=null&&et.substring(0,10)==="0x556f1830"&&hexDataLength(et)%32===4)try{const tt=hexDataSlice(et,4),rt=hexDataSlice(tt,0,32);BigNumber.from(rt).eq(_e)||logger$5.throwError("CCIP Read sender did not match",Logger.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:a,data:et});const nt=[],it=BigNumber.from(hexDataSlice(tt,32,64)).toNumber(),st=BigNumber.from(hexDataSlice(tt,it,it+32)).toNumber(),ot=hexDataSlice(tt,it+32);for(let ft=0;ft<st;ft++){const pt=_parseString(ot,ft*32);pt==null&&logger$5.throwError("CCIP Read contained corrupt URL string",Logger.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:a,data:et}),nt.push(pt)}const at=_parseBytes(tt,64);BigNumber.from(hexDataSlice(tt,100,128)).isZero()||logger$5.throwError("CCIP Read callback selector included junk",Logger.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:a,data:et});const lt=hexDataSlice(tt,96,100),ct=_parseBytes(tt,128),ut=yield this.ccipReadFetch(a,at,nt);ut==null&&logger$5.throwError("CCIP Read disabled or provided no URLs",Logger.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:a,data:et});const dt={to:_e,data:hexConcat([lt,encodeBytes$1([ut,ct])])};return this._call(dt,$,j+1)}catch(tt){if(tt.code===Logger.errors.SERVER_ERROR)throw tt}try{return hexlify(et)}catch(tt){return logger$5.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"call",params:{transaction:a,blockTag:$},result:et,error:tt})}})}call(a,$){return __awaiter$1(this,void 0,void 0,function*(){yield this.getNetwork();const j=yield resolveProperties({transaction:this._getTransactionRequest(a),blockTag:this._getBlockTag($),ccipReadEnabled:Promise.resolve(a.ccipReadEnabled)});return this._call(j.transaction,j.blockTag,j.ccipReadEnabled?0:-1)})}estimateGas(a){return __awaiter$1(this,void 0,void 0,function*(){yield this.getNetwork();const $=yield resolveProperties({transaction:this._getTransactionRequest(a)}),j=yield this.perform("estimateGas",$);try{return BigNumber.from(j)}catch(_e){return logger$5.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"estimateGas",params:$,result:j,error:_e})}})}_getAddress(a){return __awaiter$1(this,void 0,void 0,function*(){a=yield a,typeof a!="string"&&logger$5.throwArgumentError("invalid address or ENS name","name",a);const $=yield this.resolveName(a);return $==null&&logger$5.throwError("ENS name not configured",Logger.errors.UNSUPPORTED_OPERATION,{operation:`resolveName(${JSON.stringify(a)})`}),$})}_getBlock(a,$){return __awaiter$1(this,void 0,void 0,function*(){yield this.getNetwork(),a=yield a;let j=-128;const _e={includeTransactions:!!$};if(isHexString(a,32))_e.blockHash=a;else try{_e.blockTag=yield this._getBlockTag(a),isHexString(_e.blockTag)&&(j=parseInt(_e.blockTag.substring(2),16))}catch{logger$5.throwArgumentError("invalid block hash or block tag","blockHashOrBlockTag",a)}return poll(()=>__awaiter$1(this,void 0,void 0,function*(){const et=yield this.perform("getBlock",_e);if(et==null)return _e.blockHash!=null&&this._emitted["b:"+_e.blockHash]==null||_e.blockTag!=null&&j>this._emitted.block?null:void 0;if($){let tt=null;for(let nt=0;nt<et.transactions.length;nt++){const it=et.transactions[nt];if(it.blockNumber==null)it.confirmations=0;else if(it.confirmations==null){tt==null&&(tt=yield this._getInternalBlockNumber(100+2*this.pollingInterval));let st=tt-it.blockNumber+1;st<=0&&(st=1),it.confirmations=st}}const rt=this.formatter.blockWithTransactions(et);return rt.transactions=rt.transactions.map(nt=>this._wrapTransaction(nt)),rt}return this.formatter.block(et)}),{oncePoll:this})})}getBlock(a){return this._getBlock(a,!1)}getBlockWithTransactions(a){return this._getBlock(a,!0)}getTransaction(a){return __awaiter$1(this,void 0,void 0,function*(){yield this.getNetwork(),a=yield a;const $={transactionHash:this.formatter.hash(a,!0)};return poll(()=>__awaiter$1(this,void 0,void 0,function*(){const j=yield this.perform("getTransaction",$);if(j==null)return this._emitted["t:"+a]==null?null:void 0;const _e=this.formatter.transactionResponse(j);if(_e.blockNumber==null)_e.confirmations=0;else if(_e.confirmations==null){let tt=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-_e.blockNumber+1;tt<=0&&(tt=1),_e.confirmations=tt}return this._wrapTransaction(_e)}),{oncePoll:this})})}getTransactionReceipt(a){return __awaiter$1(this,void 0,void 0,function*(){yield this.getNetwork(),a=yield a;const $={transactionHash:this.formatter.hash(a,!0)};return poll(()=>__awaiter$1(this,void 0,void 0,function*(){const j=yield this.perform("getTransactionReceipt",$);if(j==null)return this._emitted["t:"+a]==null?null:void 0;if(j.blockHash==null)return;const _e=this.formatter.receipt(j);if(_e.blockNumber==null)_e.confirmations=0;else if(_e.confirmations==null){let tt=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-_e.blockNumber+1;tt<=0&&(tt=1),_e.confirmations=tt}return _e}),{oncePoll:this})})}getLogs(a){return __awaiter$1(this,void 0,void 0,function*(){yield this.getNetwork();const $=yield resolveProperties({filter:this._getFilter(a)}),j=yield this.perform("getLogs",$);return j.forEach(_e=>{_e.removed==null&&(_e.removed=!1)}),Formatter.arrayOf(this.formatter.filterLog.bind(this.formatter))(j)})}getEtherPrice(){return __awaiter$1(this,void 0,void 0,function*(){return yield this.getNetwork(),this.perform("getEtherPrice",{})})}_getBlockTag(a){return __awaiter$1(this,void 0,void 0,function*(){if(a=yield a,typeof a=="number"&&a<0){a%1&&logger$5.throwArgumentError("invalid BlockTag","blockTag",a);let $=yield this._getInternalBlockNumber(100+2*this.pollingInterval);return $+=a,$<0&&($=0),this.formatter.blockTag($)}return this.formatter.blockTag(a)})}getResolver(a){return __awaiter$1(this,void 0,void 0,function*(){let $=a;for(;;){if($===""||$==="."||a!=="eth"&&$==="eth")return null;const j=yield this._getResolver($,"getResolver");if(j!=null){const _e=new Resolver$1(this,j,a);return $!==a&&!(yield _e.supportsWildcard())?null:_e}$=$.split(".").slice(1).join(".")}})}_getResolver(a,$){return __awaiter$1(this,void 0,void 0,function*(){$==null&&($="ENS");const j=yield this.getNetwork();j.ensAddress||logger$5.throwError("network does not support ENS",Logger.errors.UNSUPPORTED_OPERATION,{operation:$,network:j.name});try{const _e=yield this.call({to:j.ensAddress,data:"0x0178b8bf"+namehash(a).substring(2)});return this.formatter.callAddress(_e)}catch{}return null})}resolveName(a){return __awaiter$1(this,void 0,void 0,function*(){a=yield a;try{return Promise.resolve(this.formatter.address(a))}catch(j){if(isHexString(a))throw j}typeof a!="string"&&logger$5.throwArgumentError("invalid ENS name","name",a);const $=yield this.getResolver(a);return $?yield $.getAddress():null})}lookupAddress(a){return __awaiter$1(this,void 0,void 0,function*(){a=yield a,a=this.formatter.address(a);const $=a.substring(2).toLowerCase()+".addr.reverse",j=yield this._getResolver($,"lookupAddress");if(j==null)return null;const _e=_parseString(yield this.call({to:j,data:"0x691f3431"+namehash($).substring(2)}),0);return(yield this.resolveName(_e))!=a?null:_e})}getAvatar(a){return __awaiter$1(this,void 0,void 0,function*(){let $=null;if(isHexString(a)){const et=this.formatter.address(a).substring(2).toLowerCase()+".addr.reverse",tt=yield this._getResolver(et,"getAvatar");if(!tt)return null;$=new Resolver$1(this,tt,et);try{const rt=yield $.getAvatar();if(rt)return rt.url}catch(rt){if(rt.code!==Logger.errors.CALL_EXCEPTION)throw rt}try{const rt=_parseString(yield this.call({to:tt,data:"0x691f3431"+namehash(et).substring(2)}),0);$=yield this.getResolver(rt)}catch(rt){if(rt.code!==Logger.errors.CALL_EXCEPTION)throw rt;return null}}else if($=yield this.getResolver(a),!$)return null;const j=yield $.getAvatar();return j==null?null:j.url})}perform(a,$){return logger$5.throwError(a+" not implemented",Logger.errors.NOT_IMPLEMENTED,{operation:a})}_startEvent(a){this.polling=this._events.filter($=>$.pollable()).length>0}_stopEvent(a){this.polling=this._events.filter($=>$.pollable()).length>0}_addEventListener(a,$,j){const _e=new Event$1(getEventTag(a),$,j);return this._events.push(_e),this._startEvent(_e),this}on(a,$){return this._addEventListener(a,$,!1)}once(a,$){return this._addEventListener(a,$,!0)}emit(a,...$){let j=!1,_e=[],et=getEventTag(a);return this._events=this._events.filter(tt=>tt.tag!==et?!0:(setTimeout(()=>{tt.listener.apply(this,$)},0),j=!0,tt.once?(_e.push(tt),!1):!0)),_e.forEach(tt=>{this._stopEvent(tt)}),j}listenerCount(a){if(!a)return this._events.length;let $=getEventTag(a);return this._events.filter(j=>j.tag===$).length}listeners(a){if(a==null)return this._events.map(j=>j.listener);let $=getEventTag(a);return this._events.filter(j=>j.tag===$).map(j=>j.listener)}off(a,$){if($==null)return this.removeAllListeners(a);const j=[];let _e=!1,et=getEventTag(a);return this._events=this._events.filter(tt=>tt.tag!==et||tt.listener!=$||_e?!0:(_e=!0,j.push(tt),!1)),j.forEach(tt=>{this._stopEvent(tt)}),this}removeAllListeners(a){let $=[];if(a==null)$=this._events,this._events=[];else{const j=getEventTag(a);this._events=this._events.filter(_e=>_e.tag!==j?!0:($.push(_e),!1))}return $.forEach(j=>{this._stopEvent(j)}),this}}var __awaiter=globalThis&&globalThis.__awaiter||function(_,a,$,j){function _e(et){return et instanceof $?et:new $(function(tt){tt(et)})}return new($||($=Promise))(function(et,tt){function rt(st){try{it(j.next(st))}catch(ot){tt(ot)}}function nt(st){try{it(j.throw(st))}catch(ot){tt(ot)}}function it(st){st.done?et(st.value):_e(st.value).then(rt,nt)}it((j=j.apply(_,a||[])).next())})};const logger$4=new Logger(version$3),errorGas=["call","estimateGas"];function spelunk(_,a){if(_==null)return null;if(typeof _.message=="string"&&_.message.match("reverted")){const $=isHexString(_.data)?_.data:null;if(!a||$)return{message:_.message,data:$}}if(typeof _=="object"){for(const $ in _){const j=spelunk(_[$],a);if(j)return j}return null}if(typeof _=="string")try{return spelunk(JSON.parse(_),a)}catch{}return null}function checkError(_,a,$){const j=$.transaction||$.signedTransaction;if(_==="call"){const et=spelunk(a,!0);if(et)return et.data;logger$4.throwError("missing revert data in call exception; Transaction reverted without a reason string",Logger.errors.CALL_EXCEPTION,{data:"0x",transaction:j,error:a})}if(_==="estimateGas"){let et=spelunk(a.body,!1);et==null&&(et=spelunk(a,!1)),et&&logger$4.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",Logger.errors.UNPREDICTABLE_GAS_LIMIT,{reason:et.message,method:_,transaction:j,error:a})}let _e=a.message;throw a.code===Logger.errors.SERVER_ERROR&&a.error&&typeof a.error.message=="string"?_e=a.error.message:typeof a.body=="string"?_e=a.body:typeof a.responseText=="string"&&(_e=a.responseText),_e=(_e||"").toLowerCase(),_e.match(/insufficient funds|base fee exceeds gas limit|InsufficientFunds/i)&&logger$4.throwError("insufficient funds for intrinsic transaction cost",Logger.errors.INSUFFICIENT_FUNDS,{error:a,method:_,transaction:j}),_e.match(/nonce (is )?too low/i)&&logger$4.throwError("nonce has already been used",Logger.errors.NONCE_EXPIRED,{error:a,method:_,transaction:j}),_e.match(/replacement transaction underpriced|transaction gas price.*too low/i)&&logger$4.throwError("replacement fee too low",Logger.errors.REPLACEMENT_UNDERPRICED,{error:a,method:_,transaction:j}),_e.match(/only replay-protected/i)&&logger$4.throwError("legacy pre-eip-155 transactions not supported",Logger.errors.UNSUPPORTED_OPERATION,{error:a,method:_,transaction:j}),errorGas.indexOf(_)>=0&&_e.match(/gas required exceeds allowance|always failing transaction|execution reverted|revert/)&&logger$4.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",Logger.errors.UNPREDICTABLE_GAS_LIMIT,{error:a,method:_,transaction:j}),a}function timer(_){return new Promise(function(a){setTimeout(a,_)})}function getResult(_){if(_.error){const a=new Error(_.error.message);throw a.code=_.error.code,a.data=_.error.data,a}return _.result}function getLowerCase(_){return _&&_.toLowerCase()}const _constructorGuard={};class JsonRpcSigner extends Signer{constructor(a,$,j){if(super(),a!==_constructorGuard)throw new Error("do not call the JsonRpcSigner constructor directly; use provider.getSigner");defineReadOnly(this,"provider",$),j==null&&(j=0),typeof j=="string"?(defineReadOnly(this,"_address",this.provider.formatter.address(j)),defineReadOnly(this,"_index",null)):typeof j=="number"?(defineReadOnly(this,"_index",j),defineReadOnly(this,"_address",null)):logger$4.throwArgumentError("invalid address or index","addressOrIndex",j)}connect(a){return logger$4.throwError("cannot alter JSON-RPC Signer connection",Logger.errors.UNSUPPORTED_OPERATION,{operation:"connect"})}connectUnchecked(){return new UncheckedJsonRpcSigner(_constructorGuard,this.provider,this._address||this._index)}getAddress(){return this._address?Promise.resolve(this._address):this.provider.send("eth_accounts",[]).then(a=>(a.length<=this._index&&logger$4.throwError("unknown account #"+this._index,Logger.errors.UNSUPPORTED_OPERATION,{operation:"getAddress"}),this.provider.formatter.address(a[this._index])))}sendUncheckedTransaction(a){a=shallowCopy(a);const $=this.getAddress().then(j=>(j&&(j=j.toLowerCase()),j));if(a.gasLimit==null){const j=shallowCopy(a);j.from=$,a.gasLimit=this.provider.estimateGas(j)}return a.to!=null&&(a.to=Promise.resolve(a.to).then(j=>__awaiter(this,void 0,void 0,function*(){if(j==null)return null;const _e=yield this.provider.resolveName(j);return _e==null&&logger$4.throwArgumentError("provided ENS name resolves to null","tx.to",j),_e}))),resolveProperties({tx:resolveProperties(a),sender:$}).then(({tx:j,sender:_e})=>{j.from!=null?j.from.toLowerCase()!==_e&&logger$4.throwArgumentError("from address mismatch","transaction",a):j.from=_e;const et=this.provider.constructor.hexlifyTransaction(j,{from:!0});return this.provider.send("eth_sendTransaction",[et]).then(tt=>tt,tt=>(typeof tt.message=="string"&&tt.message.match(/user denied/i)&&logger$4.throwError("user rejected transaction",Logger.errors.ACTION_REJECTED,{action:"sendTransaction",transaction:j}),checkError("sendTransaction",tt,et)))})}signTransaction(a){return logger$4.throwError("signing transactions is unsupported",Logger.errors.UNSUPPORTED_OPERATION,{operation:"signTransaction"})}sendTransaction(a){return __awaiter(this,void 0,void 0,function*(){const $=yield this.provider._getInternalBlockNumber(100+2*this.provider.pollingInterval),j=yield this.sendUncheckedTransaction(a);try{return yield poll(()=>__awaiter(this,void 0,void 0,function*(){const _e=yield this.provider.getTransaction(j);if(_e!==null)return this.provider._wrapTransaction(_e,j,$)}),{oncePoll:this.provider})}catch(_e){throw _e.transactionHash=j,_e}})}signMessage(a){return __awaiter(this,void 0,void 0,function*(){const $=typeof a=="string"?toUtf8Bytes(a):a,j=yield this.getAddress();try{return yield this.provider.send("personal_sign",[hexlify($),j.toLowerCase()])}catch(_e){throw typeof _e.message=="string"&&_e.message.match(/user denied/i)&&logger$4.throwError("user rejected signing",Logger.errors.ACTION_REJECTED,{action:"signMessage",from:j,messageData:a}),_e}})}_legacySignMessage(a){return __awaiter(this,void 0,void 0,function*(){const $=typeof a=="string"?toUtf8Bytes(a):a,j=yield this.getAddress();try{return yield this.provider.send("eth_sign",[j.toLowerCase(),hexlify($)])}catch(_e){throw typeof _e.message=="string"&&_e.message.match(/user denied/i)&&logger$4.throwError("user rejected signing",Logger.errors.ACTION_REJECTED,{action:"_legacySignMessage",from:j,messageData:a}),_e}})}_signTypedData(a,$,j){return __awaiter(this,void 0,void 0,function*(){const _e=yield TypedDataEncoder.resolveNames(a,$,j,tt=>this.provider.resolveName(tt)),et=yield this.getAddress();try{return yield this.provider.send("eth_signTypedData_v4",[et.toLowerCase(),JSON.stringify(TypedDataEncoder.getPayload(_e.domain,$,_e.value))])}catch(tt){throw typeof tt.message=="string"&&tt.message.match(/user denied/i)&&logger$4.throwError("user rejected signing",Logger.errors.ACTION_REJECTED,{action:"_signTypedData",from:et,messageData:{domain:_e.domain,types:$,value:_e.value}}),tt}})}unlock(a){return __awaiter(this,void 0,void 0,function*(){const $=this.provider,j=yield this.getAddress();return $.send("personal_unlockAccount",[j.toLowerCase(),a,null])})}}class UncheckedJsonRpcSigner extends JsonRpcSigner{sendTransaction(a){return this.sendUncheckedTransaction(a).then($=>({hash:$,nonce:null,gasLimit:null,gasPrice:null,data:null,value:null,chainId:null,confirmations:0,from:null,wait:j=>this.provider.waitForTransaction($,j)}))}}const allowedTransactionKeys={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0,type:!0,accessList:!0,maxFeePerGas:!0,maxPriorityFeePerGas:!0};class JsonRpcProvider extends BaseProvider{constructor(a,$){let j=$;j==null&&(j=new Promise((_e,et)=>{setTimeout(()=>{this.detectNetwork().then(tt=>{_e(tt)},tt=>{et(tt)})},0)})),super(j),a||(a=getStatic(this.constructor,"defaultUrl")()),typeof a=="string"?defineReadOnly(this,"connection",Object.freeze({url:a})):defineReadOnly(this,"connection",Object.freeze(shallowCopy(a))),this._nextId=42}get _cache(){return this._eventLoopCache==null&&(this._eventLoopCache={}),this._eventLoopCache}static defaultUrl(){return"http://localhost:8545"}detectNetwork(){return this._cache.detectNetwork||(this._cache.detectNetwork=this._uncachedDetectNetwork(),setTimeout(()=>{this._cache.detectNetwork=null},0)),this._cache.detectNetwork}_uncachedDetectNetwork(){return __awaiter(this,void 0,void 0,function*(){yield timer(0);let a=null;try{a=yield this.send("eth_chainId",[])}catch{try{a=yield this.send("net_version",[])}catch{}}if(a!=null){const $=getStatic(this.constructor,"getNetwork");try{return $(BigNumber.from(a).toNumber())}catch(j){return logger$4.throwError("could not detect network",Logger.errors.NETWORK_ERROR,{chainId:a,event:"invalidNetwork",serverError:j})}}return logger$4.throwError("could not detect network",Logger.errors.NETWORK_ERROR,{event:"noNetwork"})})}getSigner(a){return new JsonRpcSigner(_constructorGuard,this,a)}getUncheckedSigner(a){return this.getSigner(a).connectUnchecked()}listAccounts(){return this.send("eth_accounts",[]).then(a=>a.map($=>this.formatter.address($)))}send(a,$){const j={method:a,params:$,id:this._nextId++,jsonrpc:"2.0"};this.emit("debug",{action:"request",request:deepCopy(j),provider:this});const _e=["eth_chainId","eth_blockNumber"].indexOf(a)>=0;if(_e&&this._cache[a])return this._cache[a];const et=fetchJson(this.connection,JSON.stringify(j),getResult).then(tt=>(this.emit("debug",{action:"response",request:j,response:tt,provider:this}),tt),tt=>{throw this.emit("debug",{action:"response",error:tt,request:j,provider:this}),tt});return _e&&(this._cache[a]=et,setTimeout(()=>{this._cache[a]=null},0)),et}prepareRequest(a,$){switch(a){case"getBlockNumber":return["eth_blockNumber",[]];case"getGasPrice":return["eth_gasPrice",[]];case"getBalance":return["eth_getBalance",[getLowerCase($.address),$.blockTag]];case"getTransactionCount":return["eth_getTransactionCount",[getLowerCase($.address),$.blockTag]];case"getCode":return["eth_getCode",[getLowerCase($.address),$.blockTag]];case"getStorageAt":return["eth_getStorageAt",[getLowerCase($.address),hexZeroPad($.position,32),$.blockTag]];case"sendTransaction":return["eth_sendRawTransaction",[$.signedTransaction]];case"getBlock":return $.blockTag?["eth_getBlockByNumber",[$.blockTag,!!$.includeTransactions]]:$.blockHash?["eth_getBlockByHash",[$.blockHash,!!$.includeTransactions]]:null;case"getTransaction":return["eth_getTransactionByHash",[$.transactionHash]];case"getTransactionReceipt":return["eth_getTransactionReceipt",[$.transactionHash]];case"call":return["eth_call",[getStatic(this.constructor,"hexlifyTransaction")($.transaction,{from:!0}),$.blockTag]];case"estimateGas":return["eth_estimateGas",[getStatic(this.constructor,"hexlifyTransaction")($.transaction,{from:!0})]];case"getLogs":return $.filter&&$.filter.address!=null&&($.filter.address=getLowerCase($.filter.address)),["eth_getLogs",[$.filter]]}return null}perform(a,$){return __awaiter(this,void 0,void 0,function*(){if(a==="call"||a==="estimateGas"){const _e=$.transaction;if(_e&&_e.type!=null&&BigNumber.from(_e.type).isZero()&&_e.maxFeePerGas==null&&_e.maxPriorityFeePerGas==null){const et=yield this.getFeeData();et.maxFeePerGas==null&&et.maxPriorityFeePerGas==null&&($=shallowCopy($),$.transaction=shallowCopy(_e),delete $.transaction.type)}}const j=this.prepareRequest(a,$);j==null&&logger$4.throwError(a+" not implemented",Logger.errors.NOT_IMPLEMENTED,{operation:a});try{return yield this.send(j[0],j[1])}catch(_e){return checkError(a,_e,$)}})}_startEvent(a){a.tag==="pending"&&this._startPending(),super._startEvent(a)}_startPending(){if(this._pendingFilter!=null)return;const a=this,$=this.send("eth_newPendingTransactionFilter",[]);this._pendingFilter=$,$.then(function(j){function _e(){a.send("eth_getFilterChanges",[j]).then(function(et){if(a._pendingFilter!=$)return null;let tt=Promise.resolve();return et.forEach(function(rt){a._emitted["t:"+rt.toLowerCase()]="pending",tt=tt.then(function(){return a.getTransaction(rt).then(function(nt){return a.emit("pending",nt),null})})}),tt.then(function(){return timer(1e3)})}).then(function(){if(a._pendingFilter!=$){a.send("eth_uninstallFilter",[j]);return}return setTimeout(function(){_e()},0),null}).catch(et=>{})}return _e(),j}).catch(j=>{})}_stopEvent(a){a.tag==="pending"&&this.listenerCount("pending")===0&&(this._pendingFilter=null),super._stopEvent(a)}static hexlifyTransaction(a,$){const j=shallowCopy(allowedTransactionKeys);if($)for(const et in $)$[et]&&(j[et]=!0);checkProperties(a,j);const _e={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(function(et){if(a[et]==null)return;const tt=hexValue(BigNumber.from(a[et]));et==="gasLimit"&&(et="gas"),_e[et]=tt}),["from","to","data"].forEach(function(et){a[et]!=null&&(_e[et]=hexlify(a[et]))}),a.accessList&&(_e.accessList=accessListify(a.accessList)),_e}}const logger$3=new Logger(version$3);let _nextId=1;function buildWeb3LegacyFetcher(_,a){const $="Web3LegacyFetcher";return function(j,_e){const et={method:j,params:_e,id:_nextId++,jsonrpc:"2.0"};return new Promise((tt,rt)=>{this.emit("debug",{action:"request",fetcher:$,request:deepCopy(et),provider:this}),a(et,(nt,it)=>{if(nt)return this.emit("debug",{action:"response",fetcher:$,error:nt,request:et,provider:this}),rt(nt);if(this.emit("debug",{action:"response",fetcher:$,request:et,response:it,provider:this}),it.error){const st=new Error(it.error.message);return st.code=it.error.code,st.data=it.error.data,rt(st)}tt(it.result)})})}}function buildEip1193Fetcher(_){return function(a,$){$==null&&($=[]);const j={method:a,params:$};return this.emit("debug",{action:"request",fetcher:"Eip1193Fetcher",request:deepCopy(j),provider:this}),_.request(j).then(_e=>(this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:j,response:_e,provider:this}),_e),_e=>{throw this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:j,error:_e,provider:this}),_e})}}class Web3Provider extends JsonRpcProvider{constructor(a,$){a==null&&logger$3.throwArgumentError("missing provider","provider",a);let j=null,_e=null,et=null;typeof a=="function"?(j="unknown:",_e=a):(j=a.host||a.path||"",!j&&a.isMetaMask&&(j="metamask"),et=a,a.request?(j===""&&(j="eip-1193:"),_e=buildEip1193Fetcher(a)):a.sendAsync?_e=buildWeb3LegacyFetcher(a,a.sendAsync.bind(a)):a.send?_e=buildWeb3LegacyFetcher(a,a.send.bind(a)):logger$3.throwArgumentError("unsupported provider","provider",a),j||(j="unknown:")),super(j,$),defineReadOnly(this,"jsonRpcFetchFunc",_e),defineReadOnly(this,"provider",et)}send(a,$){return this.jsonRpcFetchFunc(a,$)}}new Logger(version$3);const version$2="units/5.7.0",logger$2=new Logger(version$2),names$1=["wei","kwei","mwei","gwei","szabo","finney","ether"];function parseUnits(_,a){if(typeof _!="string"&&logger$2.throwArgumentError("value must be a string","value",_),typeof a=="string"){const $=names$1.indexOf(a);$!==-1&&(a=3*$)}return parseFixed(_,a??18)}const NETWORK=80001;function useMetamask(){const[_,a]=react.exports.useState(null),[$,j]=react.exports.useState(null),[_e,et]=react.exports.useState([]),[tt,rt]=react.exports.useState(null),nt=()=>{if(!window.ethereum)throw Error("Could not find Metamask extension");if(_)return _;const lt=new Web3Provider(window.ethereum);return a(lt),window.ethereum.on("accountsChanged",ct=>{et(ct)}),window.ethereum.on("chainChanged",ct=>{rt({chainId:Number(ct),name:Number(ct)===NETWORK?"Mumbai":"Invalid Network"})}),lt};return{signer:$,accounts:_e,network:tt,connect:async()=>{const lt=nt(),ct=await lt.send("eth_requestAccounts",[]),ut=await lt.getNetwork(),dt=lt.getSigner();rt(ut),et(ct),j(dt)},getAccounts:async()=>{const ct=await nt().send("eth_accounts",[]);return et(ct),ct},getNetwork:async()=>{const ct=await nt().getNetwork();return rt(ct),ct},sendTransaction:async(lt,ct,ut)=>{const dt=nt(),ft=[{from:lt,to:ct,value:parseUnits(ut,"ether").toHexString()}];return await dt.send("eth_sendTransaction",ft)}}}function formatAddress(_){const a=_.length;return _.substring(0,5)+"..."+_.substring(a-5,a)}const useStyles$4=createStyles(_=>({header:{display:"flex",justifyContent:"space-between",alignItems:"center",height:"100%"},headerMobile:{height:"100%",justifyContent:"center"}}));function AppHeader(){const{classes:_}=useStyles$4(),{connect:a,accounts:$,network:j,getAccounts:_e,getNetwork:et}=useMetamask();react.exports.useEffect(()=>{_e().then(()=>et())},[]);const tt=useMediaQuery("(max-width: 600px)"),rt=j?.chainId===80001;return jsx(Header,{height:tt?120:60,style:{minHeight:tt?120:60},p:"lg",children:jsxs(Container,{className:tt?_.headerMobile:_.header,children:[jsxs(Group,{children:[jsx(Link,{to:"/",children:jsx(Image,{src:logo,height:30,alt:"ProtoSound"})}),jsx(ActionIcon,{component:Link,to:"/feed",children:jsx(UGe,{size:18})}),jsx(ActionIcon,{component:Link,to:"/profile",children:jsx(qIe,{size:18})})]}),jsxs(Group,{children:[$[0]?jsxs(Fragment$1,{children:[jsx(Tooltip,{label:rt?"You are in the right network :)":"Please switch your network to Polygon Mumbai and reload",children:jsx(Badge,{color:rt?"violet":"red",children:rt?"Polygon Mumbai":"Invalid Network"})}),jsx(Text,{children:formatAddress($[0])}),jsx(Avatar,{src:`https://avatars.dicebear.com/api/identicon/${$[0]}.svg`})]}):jsxs(Fragment$1,{children:[jsx(Indicator,{inline:!0,dot:!0,processing:!0,size:12,color:"yellow",children:jsx(Button,{onClick:a,children:"Connect"})}),jsx(Avatar,{})]}),jsx(SwitchThemeToggle,{})]})]})})}function WIPAlert(){return jsx(Alert,{m:20,icon:jsx(fe,{size:16}),title:"Work in progress \u{1F477}",color:"yellow",children:"Unfortunatelly, we could not finish all the nice frontend features we wanted for the Chainlink hackathon deadline, so this section is not yet available."})}const mockdata=[{author:"Luca Prodan",name:"La Rubia Tarada",audio:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",image:"https://images.unsplash.com/photo-1501854140801-50d01698950b?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8M3x8bmF0dXJlfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=800&q=60",price:10},{author:"Rolling Stones",name:"Satisfaction",audio:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",image:"https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8NXx8bmF0dXJlfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=800&q=60",price:10},{author:"The Beatles",name:"Yesterday",audio:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",image:"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Nnx8bmF0dXJlfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=800&q=60",price:10}],useStyles$3=createStyles(_=>({audio:{width:"100%","&::-webkit-media-controls-panel":{backgroundColor:"transparent"},"&::-webkit-media-controls-enclosure":{backgroundColor:"transparent"},"&::-webkit-media-controls-current-time-display":{display:"none"},"&::-webkit-media-controls-time-remaining-display":{display:"none"}}}));function Feed$1(){const{classes:_}=useStyles$3();react.exports.useState(!0);const a=mockdata.map($=>jsxs(Card,{withBorder:!0,radius:"md",p:"md",children:[jsx(Card.Section,{children:jsx(Image,{src:$.image,alt:$.name,height:200})}),jsx(Card.Section,{p:"md",children:jsx(Group,{children:jsxs("div",{children:[jsx(Text,{size:"xs",color:"dimmed",children:$.author}),jsx(Text,{size:"sm",weight:500,children:$.name})]})})}),jsx(Card.Section,{children:jsx(Center,{children:jsx("audio",{className:_.audio,src:$.audio,controls:!0})})}),jsx(Card.Section,{p:"md",children:jsxs(Group,{style:{justifyContent:"space-between"},children:[jsxs(Badge,{color:"green",children:[$.price," Matic"]}),jsx(Button,{variant:"outline",leftIcon:jsx(RD,{size:15}),children:"Get song"})]})})]},$.name));return jsxs(Container,{children:[jsx(WIPAlert,{}),jsx(Overlay,{blur:2,style:{top:200},zIndex:2,opacity:0}),jsx(Title,{px:"lg",order:2,children:"Feed"}),jsx(Text,{px:"lg",color:"dimmed",children:"Select your favorite song, purchase, listen and mint your own NFT"}),jsx(SimpleGrid,{cols:3,mt:"md",breakpoints:[{maxWidth:"sm",cols:1},{maxWidth:"md",cols:2}],children:a})]})}var isPlainObj=_=>{if(Object.prototype.toString.call(_)!=="[object Object]")return!1;const a=Object.getPrototypeOf(_);return a===null||a===Object.prototype};const isOptionObject=isPlainObj,{hasOwnProperty:hasOwnProperty$1}=Object.prototype,{propertyIsEnumerable}=Object,defineProperty=(_,a,$)=>Object.defineProperty(_,a,{value:$,writable:!0,enumerable:!0,configurable:!0}),globalThis$1=commonjsGlobal,defaultMergeOptions={concatArrays:!1,ignoreUndefined:!1},getEnumerableOwnPropertyKeys=_=>{const a=[];for(const $ in _)hasOwnProperty$1.call(_,$)&&a.push($);if(Object.getOwnPropertySymbols){const $=Object.getOwnPropertySymbols(_);for(const j of $)propertyIsEnumerable.call(_,j)&&a.push(j)}return a};function clone(_){return Array.isArray(_)?cloneArray(_):isOptionObject(_)?cloneOptionObject(_):_}function cloneArray(_){const a=_.slice(0,0);return getEnumerableOwnPropertyKeys(_).forEach($=>{defineProperty(a,$,clone(_[$]))}),a}function cloneOptionObject(_){const a=Object.getPrototypeOf(_)===null?Object.create(null):{};return getEnumerableOwnPropertyKeys(_).forEach($=>{defineProperty(a,$,clone(_[$]))}),a}const mergeKeys=(_,a,$,j)=>($.forEach(_e=>{typeof a[_e]>"u"&&j.ignoreUndefined||(_e in _&&_[_e]!==Object.getPrototypeOf(_)?defineProperty(_,_e,merge$5(_[_e],a[_e],j)):defineProperty(_,_e,clone(a[_e])))}),_),concatArrays=(_,a,$)=>{let j=_.slice(0,0),_e=0;return[_,a].forEach(et=>{const tt=[];for(let rt=0;rt<et.length;rt++)!hasOwnProperty$1.call(et,rt)||(tt.push(String(rt)),et===_?defineProperty(j,_e++,et[rt]):defineProperty(j,_e++,clone(et[rt])));j=mergeKeys(j,et,getEnumerableOwnPropertyKeys(et).filter(rt=>!tt.includes(rt)),$)}),j};function merge$5(_,a,$){return $.concatArrays&&Array.isArray(_)&&Array.isArray(a)?concatArrays(_,a,$):!isOptionObject(a)||!isOptionObject(_)?clone(a):mergeKeys(_,a,getEnumerableOwnPropertyKeys(a),$)}var mergeOptions$g=function(..._){const a=merge$5(clone(defaultMergeOptions),this!==globalThis$1&&this||{},defaultMergeOptions);let $={_:{}};for(const j of _)if(j!==void 0){if(!isOptionObject(j))throw new TypeError("`"+j+"` is not an Option Object");$=merge$5($,{_:j},a)}return $._};const mergeOptions$f=Object.freeze(Object.defineProperty({__proto__:null,default:mergeOptions$g},Symbol.toStringTag,{value:"Module"}));function commonjsRequire(_){throw new Error('Could not dynamically require "'+_+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function isElectron$2(){return typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}var isElectron_1=isElectron$2;const isElectron$1=isElectron_1,IS_ENV_WITH_DOM=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,IS_ELECTRON=isElectron$1(),IS_BROWSER=IS_ENV_WITH_DOM&&!IS_ELECTRON,IS_ELECTRON_MAIN=IS_ELECTRON&&!IS_ENV_WITH_DOM,IS_ELECTRON_RENDERER=IS_ELECTRON&&IS_ENV_WITH_DOM,IS_NODE=typeof commonjsRequire=="function"&&typeof process<"u"&&typeof process.release<"u"&&process.release.name==="node"&&!IS_ELECTRON,IS_WEBWORKER=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,IS_TEST=typeof process<"u"&&typeof process.env<"u"&&!1,IS_REACT_NATIVE=typeof navigator<"u"&&navigator.product==="ReactNative";var env={isTest:IS_TEST,isElectron:IS_ELECTRON,isElectronMain:IS_ELECTRON_MAIN,isElectronRenderer:IS_ELECTRON_RENDERER,isNode:IS_NODE,isBrowser:IS_BROWSER,isWebWorker:IS_WEBWORKER,isEnvWithDom:IS_ENV_WITH_DOM,isReactNative:IS_REACT_NATIVE},browser$5={exports:{}},ms$1,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms$1;hasRequiredMs=1;var _=1e3,a=_*60,$=a*60,j=$*24,_e=j*7,et=j*365.25;ms$1=function(st,ot){ot=ot||{};var at=typeof st;if(at==="string"&&st.length>0)return tt(st);if(at==="number"&&isFinite(st))return ot.long?nt(st):rt(st);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(st))};function tt(st){if(st=String(st),!(st.length>100)){var ot=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(st);if(!!ot){var at=parseFloat(ot[1]),lt=(ot[2]||"ms").toLowerCase();switch(lt){case"years":case"year":case"yrs":case"yr":case"y":return at*et;case"weeks":case"week":case"w":return at*_e;case"days":case"day":case"d":return at*j;case"hours":case"hour":case"hrs":case"hr":case"h":return at*$;case"minutes":case"minute":case"mins":case"min":case"m":return at*a;case"seconds":case"second":case"secs":case"sec":case"s":return at*_;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return at;default:return}}}}function rt(st){var ot=Math.abs(st);return ot>=j?Math.round(st/j)+"d":ot>=$?Math.round(st/$)+"h":ot>=a?Math.round(st/a)+"m":ot>=_?Math.round(st/_)+"s":st+"ms"}function nt(st){var ot=Math.abs(st);return ot>=j?it(st,ot,j,"day"):ot>=$?it(st,ot,$,"hour"):ot>=a?it(st,ot,a,"minute"):ot>=_?it(st,ot,_,"second"):st+" ms"}function it(st,ot,at,lt){var ct=ot>=at*1.5;return Math.round(st/at)+" "+lt+(ct?"s":"")}return ms$1}function setup(_){$.debug=$,$.default=$,$.coerce=nt,$.disable=et,$.enable=_e,$.enabled=tt,$.humanize=requireMs(),$.destroy=it,Object.keys(_).forEach(st=>{$[st]=_[st]}),$.names=[],$.skips=[],$.formatters={};function a(st){let ot=0;for(let at=0;at<st.length;at++)ot=(ot<<5)-ot+st.charCodeAt(at),ot|=0;return $.colors[Math.abs(ot)%$.colors.length]}$.selectColor=a;function $(st){let ot,at=null,lt,ct;function ut(...dt){if(!ut.enabled)return;const ft=ut,pt=Number(new Date),yt=pt-(ot||pt);ft.diff=yt,ft.prev=ot,ft.curr=pt,ot=pt,dt[0]=$.coerce(dt[0]),typeof dt[0]!="string"&&dt.unshift("%O");let mt=0;dt[0]=dt[0].replace(/%([a-zA-Z%])/g,(vt,ht)=>{if(vt==="%%")return"%";mt++;const St=$.formatters[ht];if(typeof St=="function"){const It=dt[mt];vt=St.call(ft,It),dt.splice(mt,1),mt--}return vt}),$.formatArgs.call(ft,dt),(ft.log||$.log).apply(ft,dt)}return ut.namespace=st,ut.useColors=$.useColors(),ut.color=$.selectColor(st),ut.extend=j,ut.destroy=$.destroy,Object.defineProperty(ut,"enabled",{enumerable:!0,configurable:!1,get:()=>at!==null?at:(lt!==$.namespaces&&(lt=$.namespaces,ct=$.enabled(st)),ct),set:dt=>{at=dt}}),typeof $.init=="function"&&$.init(ut),ut}function j(st,ot){const at=$(this.namespace+(typeof ot>"u"?":":ot)+st);return at.log=this.log,at}function _e(st){$.save(st),$.namespaces=st,$.names=[],$.skips=[];let ot;const at=(typeof st=="string"?st:"").split(/[\s,]+/),lt=at.length;for(ot=0;ot<lt;ot++)!at[ot]||(st=at[ot].replace(/\*/g,".*?"),st[0]==="-"?$.skips.push(new RegExp("^"+st.slice(1)+"$")):$.names.push(new RegExp("^"+st+"$")))}function et(){const st=[...$.names.map(rt),...$.skips.map(rt).map(ot=>"-"+ot)].join(",");return $.enable(""),st}function tt(st){if(st[st.length-1]==="*")return!0;let ot,at;for(ot=0,at=$.skips.length;ot<at;ot++)if($.skips[ot].test(st))return!1;for(ot=0,at=$.names.length;ot<at;ot++)if($.names[ot].test(st))return!0;return!1}function rt(st){return st.toString().substring(2,st.toString().length-2).replace(/\.\*\?$/,"*")}function nt(st){return st instanceof Error?st.stack||st.message:st}function it(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return $.enable($.load()),$}var common$2=setup;(function(_,a){a.formatArgs=j,a.save=_e,a.load=et,a.useColors=$,a.storage=tt(),a.destroy=(()=>{let nt=!1;return()=>{nt||(nt=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),a.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function $(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function j(nt){if(nt[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+nt[0]+(this.useColors?"%c ":" ")+"+"+_.exports.humanize(this.diff),!this.useColors)return;const it="color: "+this.color;nt.splice(1,0,it,"color: inherit");let st=0,ot=0;nt[0].replace(/%[a-zA-Z%]/g,at=>{at!=="%%"&&(st++,at==="%c"&&(ot=st))}),nt.splice(ot,0,it)}a.log=console.debug||console.log||(()=>{});function _e(nt){try{nt?a.storage.setItem("debug",nt):a.storage.removeItem("debug")}catch{}}function et(){let nt;try{nt=a.storage.getItem("debug")}catch{}return!nt&&typeof process<"u"&&"env"in process&&(nt=process.env.DEBUG),nt}function tt(){try{return localStorage}catch{}}_.exports=common$2(a);const{formatters:rt}=_.exports;rt.j=function(nt){try{return JSON.stringify(nt)}catch(it){return"[UnexpectedJSONParseError]: "+it.message}}})(browser$5,browser$5.exports);const debug=browser$5.exports;function base$3(_,a){if(_.length>=255)throw new TypeError("Alphabet too long");for(var $=new Uint8Array(256),j=0;j<$.length;j++)$[j]=255;for(var _e=0;_e<_.length;_e++){var et=_.charAt(_e),tt=et.charCodeAt(0);if($[tt]!==255)throw new TypeError(et+" is ambiguous");$[tt]=_e}var rt=_.length,nt=_.charAt(0),it=Math.log(rt)/Math.log(256),st=Math.log(256)/Math.log(rt);function ot(ct){if(ct instanceof Uint8Array||(ArrayBuffer.isView(ct)?ct=new Uint8Array(ct.buffer,ct.byteOffset,ct.byteLength):Array.isArray(ct)&&(ct=Uint8Array.from(ct))),!(ct instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(ct.length===0)return"";for(var ut=0,dt=0,ft=0,pt=ct.length;ft!==pt&&ct[ft]===0;)ft++,ut++;for(var yt=(pt-ft)*st+1>>>0,mt=new Uint8Array(yt);ft!==pt;){for(var _t=ct[ft],vt=0,ht=yt-1;(_t!==0||vt<dt)&&ht!==-1;ht--,vt++)_t+=256*mt[ht]>>>0,mt[ht]=_t%rt>>>0,_t=_t/rt>>>0;if(_t!==0)throw new Error("Non-zero carry");dt=vt,ft++}for(var St=yt-dt;St!==yt&&mt[St]===0;)St++;for(var It=nt.repeat(ut);St<yt;++St)It+=_.charAt(mt[St]);return It}function at(ct){if(typeof ct!="string")throw new TypeError("Expected String");if(ct.length===0)return new Uint8Array;var ut=0;if(ct[ut]!==" "){for(var dt=0,ft=0;ct[ut]===nt;)dt++,ut++;for(var pt=(ct.length-ut)*it+1>>>0,yt=new Uint8Array(pt);ct[ut];){var mt=$[ct.charCodeAt(ut)];if(mt===255)return;for(var _t=0,vt=pt-1;(mt!==0||_t<ft)&&vt!==-1;vt--,_t++)mt+=rt*yt[vt]>>>0,yt[vt]=mt%256>>>0,mt=mt/256>>>0;if(mt!==0)throw new Error("Non-zero carry");ft=_t,ut++}if(ct[ut]!==" "){for(var ht=pt-ft;ht!==pt&&yt[ht]===0;)ht++;for(var St=new Uint8Array(dt+(pt-ht)),It=dt;ht!==pt;)St[It++]=yt[ht++];return St}}}function lt(ct){var ut=at(ct);if(ut)return ut;throw new Error(`Non-${a} character`)}return{encode:ot,decodeUnsafe:at,decode:lt}}var src$6=base$3,_brrp__multiformats_scope_baseX$2=src$6;const empty$1=new Uint8Array(0),fromHex=_=>{const a=_.match(/../g);return a?new Uint8Array(a.map($=>parseInt($,16))):empty$1},equals$3=(_,a)=>{if(_===a)return!0;if(_.byteLength!==a.byteLength)return!1;for(let $=0;$<_.byteLength;$++)if(_[$]!==a[$])return!1;return!0},coerce$2=_=>{if(_ instanceof Uint8Array&&_.constructor.name==="Uint8Array")return _;if(_ instanceof ArrayBuffer)return new Uint8Array(_);if(ArrayBuffer.isView(_))return new Uint8Array(_.buffer,_.byteOffset,_.byteLength);throw new Error("Unknown type, must be binary type")},fromString$7=_=>new TextEncoder().encode(_),toString$9=_=>new TextDecoder().decode(_);class Encoder$4{constructor(a,$,j){this.name=a,this.prefix=$,this.baseEncode=j}encode(a){if(a instanceof Uint8Array)return`${this.prefix}${this.baseEncode(a)}`;throw Error("Unknown type, must be binary type")}}class Decoder$4{constructor(a,$,j){if(this.name=a,this.prefix=$,$.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=$.codePointAt(0),this.baseDecode=j}decode(a){if(typeof a=="string"){if(a.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(a)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(a.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(a){return or$3(this,a)}}class ComposedDecoder$2{constructor(a){this.decoders=a}or(a){return or$3(this,a)}decode(a){const $=a[0],j=this.decoders[$];if(j)return j.decode(a);throw RangeError(`Unable to decode multibase string ${JSON.stringify(a)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const or$3=(_,a)=>new ComposedDecoder$2({..._.decoders||{[_.prefix]:_},...a.decoders||{[a.prefix]:a}});class Codec$2{constructor(a,$,j,_e){this.name=a,this.prefix=$,this.baseEncode=j,this.baseDecode=_e,this.encoder=new Encoder$4(a,$,j),this.decoder=new Decoder$4(a,$,_e)}encode(a){return this.encoder.encode(a)}decode(a){return this.decoder.decode(a)}}const from$6=({name:_,prefix:a,encode:$,decode:j})=>new Codec$2(_,a,$,j),baseX$2=({prefix:_,name:a,alphabet:$})=>{const{encode:j,decode:_e}=_brrp__multiformats_scope_baseX$2($,a);return from$6({prefix:_,name:a,encode:j,decode:et=>coerce$2(_e(et))})},decode$q=(_,a,$,j)=>{const _e={};for(let st=0;st<a.length;++st)_e[a[st]]=st;let et=_.length;for(;_[et-1]==="=";)--et;const tt=new Uint8Array(et*$/8|0);let rt=0,nt=0,it=0;for(let st=0;st<et;++st){const ot=_e[_[st]];if(ot===void 0)throw new SyntaxError(`Non-${j} character`);nt=nt<<$|ot,rt+=$,rt>=8&&(rt-=8,tt[it++]=255&nt>>rt)}if(rt>=$||255&nt<<8-rt)throw new SyntaxError("Unexpected end of data");return tt},encode$u=(_,a,$)=>{const j=a[a.length-1]==="=",_e=(1<<$)-1;let et="",tt=0,rt=0;for(let nt=0;nt<_.length;++nt)for(rt=rt<<8|_[nt],tt+=8;tt>$;)tt-=$,et+=a[_e&rt>>tt];if(tt&&(et+=a[_e&rt<<$-tt]),j)for(;et.length*$&7;)et+="=";return et},rfc4648$2=({name:_,prefix:a,bitsPerChar:$,alphabet:j})=>from$6({prefix:a,name:_,encode(_e){return encode$u(_e,j,$)},decode(_e){return decode$q(_e,j,$,_)}}),base58btc$2=baseX$2({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$2=baseX$2({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$2=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$2,base58flickr:base58flickr$2},Symbol.toStringTag,{value:"Module"})),base32$4=rfc4648$2({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$2=rfc4648$2({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$2=rfc4648$2({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$2=rfc4648$2({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$2=rfc4648$2({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$2=rfc4648$2({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$2=rfc4648$2({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$2=rfc4648$2({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$2=rfc4648$2({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$5=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$4,base32upper:base32upper$2,base32pad:base32pad$2,base32padupper:base32padupper$2,base32hex:base32hex$2,base32hexupper:base32hexupper$2,base32hexpad:base32hexpad$2,base32hexpadupper:base32hexpadupper$2,base32z:base32z$2},Symbol.toStringTag,{value:"Module"})),base64$6=rfc4648$2({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$2=rfc4648$2({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$2=rfc4648$2({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$2=rfc4648$2({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$7=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$6,base64pad:base64pad$2,base64url:base64url$2,base64urlpad:base64urlpad$2},Symbol.toStringTag,{value:"Module"}));debug.formatters.b=_=>_==null?"undefined":base58btc$2.baseEncode(_);debug.formatters.t=_=>_==null?"undefined":base32$4.baseEncode(_);debug.formatters.m=_=>_==null?"undefined":base64$6.baseEncode(_);debug.formatters.p=_=>_==null?"undefined":_.toString();debug.formatters.c=_=>_==null?"undefined":_.toString();debug.formatters.k=_=>_==null?"undefined":_.toString();function logger$1(_){return Object.assign(debug(_),{error:debug(`${_}:error`),trace:debug(`${_}:trace`)})}function assign$1(_,a){for(const $ in a)Object.defineProperty(_,$,{value:a[$],enumerable:!0,configurable:!0});return _}function createError(_,a,$){if(!_||typeof _=="string")throw new TypeError("Please pass an Error to err-code");$||($={}),typeof a=="object"&&($=a,a=""),a&&($.code=a);try{return assign$1(_,$)}catch{$.message=_.message,$.stack=_.stack;const _e=function(){};return _e.prototype=Object.create(Object.getPrototypeOf(_)),assign$1(new _e,$)}}var errCode=createError,minimal$3={exports:{}},indexMinimal$1={},minimal$2={},aspromise=asPromise;function asPromise(_,a){for(var $=new Array(arguments.length-1),j=0,_e=2,et=!0;_e<arguments.length;)$[j++]=arguments[_e++];return new Promise(function(rt,nt){$[j]=function(st){if(et)if(et=!1,st)nt(st);else{for(var ot=new Array(arguments.length-1),at=0;at<ot.length;)ot[at++]=arguments[at];rt.apply(null,ot)}};try{_.apply(a||null,$)}catch(it){et&&(et=!1,nt(it))}})}var base64$5={};(function(_){var a=_;a.length=function(rt){var nt=rt.length;if(!nt)return 0;for(var it=0;--nt%4>1&&rt.charAt(nt)==="=";)++it;return Math.ceil(rt.length*3)/4-it};for(var $=new Array(64),j=new Array(123),_e=0;_e<64;)j[$[_e]=_e<26?_e+65:_e<52?_e+71:_e<62?_e-4:_e-59|43]=_e++;a.encode=function(rt,nt,it){for(var st=null,ot=[],at=0,lt=0,ct;nt<it;){var ut=rt[nt++];switch(lt){case 0:ot[at++]=$[ut>>2],ct=(ut&3)<<4,lt=1;break;case 1:ot[at++]=$[ct|ut>>4],ct=(ut&15)<<2,lt=2;break;case 2:ot[at++]=$[ct|ut>>6],ot[at++]=$[ut&63],lt=0;break}at>8191&&((st||(st=[])).push(String.fromCharCode.apply(String,ot)),at=0)}return lt&&(ot[at++]=$[ct],ot[at++]=61,lt===1&&(ot[at++]=61)),st?(at&&st.push(String.fromCharCode.apply(String,ot.slice(0,at))),st.join("")):String.fromCharCode.apply(String,ot.slice(0,at))};var et="invalid encoding";a.decode=function(rt,nt,it){for(var st=it,ot=0,at,lt=0;lt<rt.length;){var ct=rt.charCodeAt(lt++);if(ct===61&&ot>1)break;if((ct=j[ct])===void 0)throw Error(et);switch(ot){case 0:at=ct,ot=1;break;case 1:nt[it++]=at<<2|(ct&48)>>4,at=ct,ot=2;break;case 2:nt[it++]=(at&15)<<4|(ct&60)>>2,at=ct,ot=3;break;case 3:nt[it++]=(at&3)<<6|ct,ot=0;break}}if(ot===1)throw Error(et);return it-st},a.test=function(rt){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(rt)}})(base64$5);var eventemitter=EventEmitter$5;function EventEmitter$5(){this._listeners={}}EventEmitter$5.prototype.on=function(a,$,j){return(this._listeners[a]||(this._listeners[a]=[])).push({fn:$,ctx:j||this}),this};EventEmitter$5.prototype.off=function(a,$){if(a===void 0)this._listeners={};else if($===void 0)this._listeners[a]=[];else for(var j=this._listeners[a],_e=0;_e<j.length;)j[_e].fn===$?j.splice(_e,1):++_e;return this};EventEmitter$5.prototype.emit=function(a){var $=this._listeners[a];if($){for(var j=[],_e=1;_e<arguments.length;)j.push(arguments[_e++]);for(_e=0;_e<$.length;)$[_e].fn.apply($[_e++].ctx,j)}return this};var float=factory(factory);function factory(_){return typeof Float32Array<"u"?function(){var a=new Float32Array([-0]),$=new Uint8Array(a.buffer),j=$[3]===128;function _e(nt,it,st){a[0]=nt,it[st]=$[0],it[st+1]=$[1],it[st+2]=$[2],it[st+3]=$[3]}function et(nt,it,st){a[0]=nt,it[st]=$[3],it[st+1]=$[2],it[st+2]=$[1],it[st+3]=$[0]}_.writeFloatLE=j?_e:et,_.writeFloatBE=j?et:_e;function tt(nt,it){return $[0]=nt[it],$[1]=nt[it+1],$[2]=nt[it+2],$[3]=nt[it+3],a[0]}function rt(nt,it){return $[3]=nt[it],$[2]=nt[it+1],$[1]=nt[it+2],$[0]=nt[it+3],a[0]}_.readFloatLE=j?tt:rt,_.readFloatBE=j?rt:tt}():function(){function a(j,_e,et,tt){var rt=_e<0?1:0;if(rt&&(_e=-_e),_e===0)j(1/_e>0?0:2147483648,et,tt);else if(isNaN(_e))j(2143289344,et,tt);else if(_e>34028234663852886e22)j((rt<<31|2139095040)>>>0,et,tt);else if(_e<11754943508222875e-54)j((rt<<31|Math.round(_e/1401298464324817e-60))>>>0,et,tt);else{var nt=Math.floor(Math.log(_e)/Math.LN2),it=Math.round(_e*Math.pow(2,-nt)*8388608)&8388607;j((rt<<31|nt+127<<23|it)>>>0,et,tt)}}_.writeFloatLE=a.bind(null,writeUintLE$1),_.writeFloatBE=a.bind(null,writeUintBE$1);function $(j,_e,et){var tt=j(_e,et),rt=(tt>>31)*2+1,nt=tt>>>23&255,it=tt&8388607;return nt===255?it?NaN:rt*(1/0):nt===0?rt*1401298464324817e-60*it:rt*Math.pow(2,nt-150)*(it+8388608)}_.readFloatLE=$.bind(null,readUintLE$1),_.readFloatBE=$.bind(null,readUintBE$1)}(),typeof Float64Array<"u"?function(){var a=new Float64Array([-0]),$=new Uint8Array(a.buffer),j=$[7]===128;function _e(nt,it,st){a[0]=nt,it[st]=$[0],it[st+1]=$[1],it[st+2]=$[2],it[st+3]=$[3],it[st+4]=$[4],it[st+5]=$[5],it[st+6]=$[6],it[st+7]=$[7]}function et(nt,it,st){a[0]=nt,it[st]=$[7],it[st+1]=$[6],it[st+2]=$[5],it[st+3]=$[4],it[st+4]=$[3],it[st+5]=$[2],it[st+6]=$[1],it[st+7]=$[0]}_.writeDoubleLE=j?_e:et,_.writeDoubleBE=j?et:_e;function tt(nt,it){return $[0]=nt[it],$[1]=nt[it+1],$[2]=nt[it+2],$[3]=nt[it+3],$[4]=nt[it+4],$[5]=nt[it+5],$[6]=nt[it+6],$[7]=nt[it+7],a[0]}function rt(nt,it){return $[7]=nt[it],$[6]=nt[it+1],$[5]=nt[it+2],$[4]=nt[it+3],$[3]=nt[it+4],$[2]=nt[it+5],$[1]=nt[it+6],$[0]=nt[it+7],a[0]}_.readDoubleLE=j?tt:rt,_.readDoubleBE=j?rt:tt}():function(){function a(j,_e,et,tt,rt,nt){var it=tt<0?1:0;if(it&&(tt=-tt),tt===0)j(0,rt,nt+_e),j(1/tt>0?0:2147483648,rt,nt+et);else if(isNaN(tt))j(0,rt,nt+_e),j(2146959360,rt,nt+et);else if(tt>17976931348623157e292)j(0,rt,nt+_e),j((it<<31|2146435072)>>>0,rt,nt+et);else{var st;if(tt<22250738585072014e-324)st=tt/5e-324,j(st>>>0,rt,nt+_e),j((it<<31|st/4294967296)>>>0,rt,nt+et);else{var ot=Math.floor(Math.log(tt)/Math.LN2);ot===1024&&(ot=1023),st=tt*Math.pow(2,-ot),j(st*4503599627370496>>>0,rt,nt+_e),j((it<<31|ot+1023<<20|st*1048576&1048575)>>>0,rt,nt+et)}}}_.writeDoubleLE=a.bind(null,writeUintLE$1,0,4),_.writeDoubleBE=a.bind(null,writeUintBE$1,4,0);function $(j,_e,et,tt,rt){var nt=j(tt,rt+_e),it=j(tt,rt+et),st=(it>>31)*2+1,ot=it>>>20&2047,at=4294967296*(it&1048575)+nt;return ot===2047?at?NaN:st*(1/0):ot===0?st*5e-324*at:st*Math.pow(2,ot-1075)*(at+4503599627370496)}_.readDoubleLE=$.bind(null,readUintLE$1,0,4),_.readDoubleBE=$.bind(null,readUintBE$1,4,0)}(),_}function writeUintLE$1(_,a,$){a[$]=_&255,a[$+1]=_>>>8&255,a[$+2]=_>>>16&255,a[$+3]=_>>>24}function writeUintBE$1(_,a,$){a[$]=_>>>24,a[$+1]=_>>>16&255,a[$+2]=_>>>8&255,a[$+3]=_&255}function readUintLE$1(_,a){return(_[a]|_[a+1]<<8|_[a+2]<<16|_[a+3]<<24)>>>0}function readUintBE$1(_,a){return(_[a]<<24|_[a+1]<<16|_[a+2]<<8|_[a+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(_){}return null}var utf8$2={};(function(_){var a=_;a.length=function(j){for(var _e=0,et=0,tt=0;tt<j.length;++tt)et=j.charCodeAt(tt),et<128?_e+=1:et<2048?_e+=2:(et&64512)===55296&&(j.charCodeAt(tt+1)&64512)===56320?(++tt,_e+=4):_e+=3;return _e},a.read=function(j,_e,et){var tt=et-_e;if(tt<1)return"";for(var rt=null,nt=[],it=0,st;_e<et;)st=j[_e++],st<128?nt[it++]=st:st>191&&st<224?nt[it++]=(st&31)<<6|j[_e++]&63:st>239&&st<365?(st=((st&7)<<18|(j[_e++]&63)<<12|(j[_e++]&63)<<6|j[_e++]&63)-65536,nt[it++]=55296+(st>>10),nt[it++]=56320+(st&1023)):nt[it++]=(st&15)<<12|(j[_e++]&63)<<6|j[_e++]&63,it>8191&&((rt||(rt=[])).push(String.fromCharCode.apply(String,nt)),it=0);return rt?(it&&rt.push(String.fromCharCode.apply(String,nt.slice(0,it))),rt.join("")):String.fromCharCode.apply(String,nt.slice(0,it))},a.write=function(j,_e,et){for(var tt=et,rt,nt,it=0;it<j.length;++it)rt=j.charCodeAt(it),rt<128?_e[et++]=rt:rt<2048?(_e[et++]=rt>>6|192,_e[et++]=rt&63|128):(rt&64512)===55296&&((nt=j.charCodeAt(it+1))&64512)===56320?(rt=65536+((rt&1023)<<10)+(nt&1023),++it,_e[et++]=rt>>18|240,_e[et++]=rt>>12&63|128,_e[et++]=rt>>6&63|128,_e[et++]=rt&63|128):(_e[et++]=rt>>12|224,_e[et++]=rt>>6&63|128,_e[et++]=rt&63|128);return et-tt}})(utf8$2);var pool_1=pool;function pool(_,a,$){var j=$||8192,_e=j>>>1,et=null,tt=j;return function(nt){if(nt<1||nt>_e)return _(nt);tt+nt>j&&(et=_(j),tt=0);var it=a.call(et,tt,tt+=nt);return tt&7&&(tt=(tt|7)+1),it}}var longbits$1,hasRequiredLongbits$1;function requireLongbits$1(){if(hasRequiredLongbits$1)return longbits$1;hasRequiredLongbits$1=1,longbits$1=a;var _=requireMinimal$2();function a(et,tt){this.lo=et>>>0,this.hi=tt>>>0}var $=a.zero=new a(0,0);$.toNumber=function(){return 0},$.zzEncode=$.zzDecode=function(){return this},$.length=function(){return 1};var j=a.zeroHash="\0\0\0\0\0\0\0\0";a.fromNumber=function(tt){if(tt===0)return $;var rt=tt<0;rt&&(tt=-tt);var nt=tt>>>0,it=(tt-nt)/4294967296>>>0;return rt&&(it=~it>>>0,nt=~nt>>>0,++nt>4294967295&&(nt=0,++it>4294967295&&(it=0))),new a(nt,it)},a.from=function(tt){if(typeof tt=="number")return a.fromNumber(tt);if(_.isString(tt))if(_.Long)tt=_.Long.fromString(tt);else return a.fromNumber(parseInt(tt,10));return tt.low||tt.high?new a(tt.low>>>0,tt.high>>>0):$},a.prototype.toNumber=function(tt){if(!tt&&this.hi>>>31){var rt=~this.lo+1>>>0,nt=~this.hi>>>0;return rt||(nt=nt+1>>>0),-(rt+nt*4294967296)}return this.lo+this.hi*4294967296},a.prototype.toLong=function(tt){return _.Long?new _.Long(this.lo|0,this.hi|0,Boolean(tt)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(tt)}};var _e=String.prototype.charCodeAt;return a.fromHash=function(tt){return tt===j?$:new a((_e.call(tt,0)|_e.call(tt,1)<<8|_e.call(tt,2)<<16|_e.call(tt,3)<<24)>>>0,(_e.call(tt,4)|_e.call(tt,5)<<8|_e.call(tt,6)<<16|_e.call(tt,7)<<24)>>>0)},a.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},a.prototype.zzEncode=function(){var tt=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^tt)>>>0,this.lo=(this.lo<<1^tt)>>>0,this},a.prototype.zzDecode=function(){var tt=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^tt)>>>0,this.hi=(this.hi>>>1^tt)>>>0,this},a.prototype.length=function(){var tt=this.lo,rt=(this.lo>>>28|this.hi<<4)>>>0,nt=this.hi>>>24;return nt===0?rt===0?tt<16384?tt<128?1:2:tt<2097152?3:4:rt<16384?rt<128?5:6:rt<2097152?7:8:nt<128?9:10},longbits$1}var hasRequiredMinimal$2;function requireMinimal$2(){return hasRequiredMinimal$2||(hasRequiredMinimal$2=1,function(_){var a=_;a.asPromise=aspromise,a.base64=base64$5,a.EventEmitter=eventemitter,a.float=float,a.inquire=inquire_1,a.utf8=utf8$2,a.pool=pool_1,a.LongBits=requireLongbits$1(),a.isNode=Boolean(typeof{}<"u"&&{}&&{}.process&&{}.process.versions&&{}.process.versions.node),a.global=a.isNode&&{}||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,a.emptyArray=Object.freeze?Object.freeze([]):[],a.emptyObject=Object.freeze?Object.freeze({}):{},a.isInteger=Number.isInteger||function(et){return typeof et=="number"&&isFinite(et)&&Math.floor(et)===et},a.isString=function(et){return typeof et=="string"||et instanceof String},a.isObject=function(et){return et&&typeof et=="object"},a.isset=a.isSet=function(et,tt){var rt=et[tt];return rt!=null&&et.hasOwnProperty(tt)?typeof rt!="object"||(Array.isArray(rt)?rt.length:Object.keys(rt).length)>0:!1},a.Buffer=function(){try{var _e=a.inquire("buffer").Buffer;return _e.prototype.utf8Write?_e:null}catch{return null}}(),a._Buffer_from=null,a._Buffer_allocUnsafe=null,a.newBuffer=function(et){return typeof et=="number"?a.Buffer?a._Buffer_allocUnsafe(et):new a.Array(et):a.Buffer?a._Buffer_from(et):typeof Uint8Array>"u"?et:new Uint8Array(et)},a.Array=typeof Uint8Array<"u"?Uint8Array:Array,a.Long=a.global.dcodeIO&&a.global.dcodeIO.Long||a.global.Long||a.inquire("long"),a.key2Re=/^true|false|0|1$/,a.key32Re=/^-?(?:0|[1-9][0-9]*)$/,a.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,a.longToHash=function(et){return et?a.LongBits.from(et).toHash():a.LongBits.zeroHash},a.longFromHash=function(et,tt){var rt=a.LongBits.fromHash(et);return a.Long?a.Long.fromBits(rt.lo,rt.hi,tt):rt.toNumber(Boolean(tt))};function $(_e,et,tt){for(var rt=Object.keys(et),nt=0;nt<rt.length;++nt)(_e[rt[nt]]===void 0||!tt)&&(_e[rt[nt]]=et[rt[nt]]);return _e}a.merge=$,a.lcFirst=function(et){return et.charAt(0).toLowerCase()+et.substring(1)};function j(_e){function et(tt,rt){if(!(this instanceof et))return new et(tt,rt);Object.defineProperty(this,"message",{get:function(){return tt}}),Error.captureStackTrace?Error.captureStackTrace(this,et):Object.defineProperty(this,"stack",{value:new Error().stack||""}),rt&&$(this,rt)}return et.prototype=Object.create(Error.prototype,{constructor:{value:et,writable:!0,enumerable:!1,configurable:!0},name:{get(){return _e},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),et}a.newError=j,a.ProtocolError=j("ProtocolError"),a.oneOfGetter=function(et){for(var tt={},rt=0;rt<et.length;++rt)tt[et[rt]]=1;return function(){for(var nt=Object.keys(this),it=nt.length-1;it>-1;--it)if(tt[nt[it]]===1&&this[nt[it]]!==void 0&&this[nt[it]]!==null)return nt[it]}},a.oneOfSetter=function(et){return function(tt){for(var rt=0;rt<et.length;++rt)et[rt]!==tt&&delete this[et[rt]]}},a.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},a._configure=function(){var _e=a.Buffer;if(!_e){a._Buffer_from=a._Buffer_allocUnsafe=null;return}a._Buffer_from=_e.from!==Uint8Array.from&&_e.from||function(tt,rt){return new _e(tt,rt)},a._Buffer_allocUnsafe=_e.allocUnsafe||function(tt){return new _e(tt)}}}(minimal$2)),minimal$2}var writer$2=Writer$1,util$7=requireMinimal$2(),BufferWriter$1,LongBits$2=util$7.LongBits,base64$4=util$7.base64,utf8$1=util$7.utf8;function Op(_,a,$){this.fn=_,this.len=a,this.next=void 0,this.val=$}function noop$6(){}function State(_){this.head=_.head,this.tail=_.tail,this.len=_.len,this.next=_.states}function Writer$1(){this.len=0,this.head=new Op(noop$6,0,0),this.tail=this.head,this.states=null}var create$c=function _(){return util$7.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$c();Writer$1.alloc=function _(a){return new util$7.Array(a)};util$7.Array!==Array&&(Writer$1.alloc=util$7.pool(Writer$1.alloc,util$7.Array.prototype.subarray));Writer$1.prototype._push=function _(a,$,j){return this.tail=this.tail.next=new Op(a,$,j),this.len+=$,this};function writeByte(_,a,$){a[$]=_&255}function writeVarint32(_,a,$){for(;_>127;)a[$++]=_&127|128,_>>>=7;a[$]=_}function VarintOp(_,a){this.len=_,this.next=void 0,this.val=a}VarintOp.prototype=Object.create(Op.prototype);VarintOp.prototype.fn=writeVarint32;Writer$1.prototype.uint32=function _(a){return this.len+=(this.tail=this.tail.next=new VarintOp((a=a>>>0)<128?1:a<16384?2:a<2097152?3:a<268435456?4:5,a)).len,this};Writer$1.prototype.int32=function _(a){return a<0?this._push(writeVarint64,10,LongBits$2.fromNumber(a)):this.uint32(a)};Writer$1.prototype.sint32=function _(a){return this.uint32((a<<1^a>>31)>>>0)};function writeVarint64(_,a,$){for(;_.hi;)a[$++]=_.lo&127|128,_.lo=(_.lo>>>7|_.hi<<25)>>>0,_.hi>>>=7;for(;_.lo>127;)a[$++]=_.lo&127|128,_.lo=_.lo>>>7;a[$++]=_.lo}Writer$1.prototype.uint64=function _(a){var $=LongBits$2.from(a);return this._push(writeVarint64,$.length(),$)};Writer$1.prototype.int64=Writer$1.prototype.uint64;Writer$1.prototype.sint64=function _(a){var $=LongBits$2.from(a).zzEncode();return this._push(writeVarint64,$.length(),$)};Writer$1.prototype.bool=function _(a){return this._push(writeByte,1,a?1:0)};function writeFixed32(_,a,$){a[$]=_&255,a[$+1]=_>>>8&255,a[$+2]=_>>>16&255,a[$+3]=_>>>24}Writer$1.prototype.fixed32=function _(a){return this._push(writeFixed32,4,a>>>0)};Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32;Writer$1.prototype.fixed64=function _(a){var $=LongBits$2.from(a);return this._push(writeFixed32,4,$.lo)._push(writeFixed32,4,$.hi)};Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64;Writer$1.prototype.float=function _(a){return this._push(util$7.float.writeFloatLE,4,a)};Writer$1.prototype.double=function _(a){return this._push(util$7.float.writeDoubleLE,8,a)};var writeBytes=util$7.Array.prototype.set?function _(a,$,j){$.set(a,j)}:function _(a,$,j){for(var _e=0;_e<a.length;++_e)$[j+_e]=a[_e]};Writer$1.prototype.bytes=function _(a){var $=a.length>>>0;if(!$)return this._push(writeByte,1,0);if(util$7.isString(a)){var j=Writer$1.alloc($=base64$4.length(a));base64$4.decode(a,j,0),a=j}return this.uint32($)._push(writeBytes,$,a)};Writer$1.prototype.string=function _(a){var $=utf8$1.length(a);return $?this.uint32($)._push(utf8$1.write,$,a):this._push(writeByte,1,0)};Writer$1.prototype.fork=function _(){return this.states=new State(this),this.head=this.tail=new Op(noop$6,0,0),this.len=0,this};Writer$1.prototype.reset=function _(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$6,0,0),this.len=0),this};Writer$1.prototype.ldelim=function _(){var a=this.head,$=this.tail,j=this.len;return this.reset().uint32(j),j&&(this.tail.next=a.next,this.tail=$,this.len+=j),this};Writer$1.prototype.finish=function _(){for(var a=this.head.next,$=this.constructor.alloc(this.len),j=0;a;)a.fn(a.val,$,j),j+=a.len,a=a.next;return $};Writer$1._configure=function(_){BufferWriter$1=_,Writer$1.create=create$c(),BufferWriter$1._configure()};var writer_buffer$1=BufferWriter,Writer=writer$2;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$6=requireMinimal$2();function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$6._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$6.Buffer&&util$6.Buffer.prototype instanceof Uint8Array&&util$6.Buffer.prototype.set.name==="set"?function(a,$,j){$.set(a,j)}:function(a,$,j){if(a.copy)a.copy($,j,0,a.length);else for(var _e=0;_e<a.length;)$[j++]=a[_e++]}};BufferWriter.prototype.bytes=function _(a){util$6.isString(a)&&(a=util$6._Buffer_from(a,"base64"));var $=a.length>>>0;return this.uint32($),$&&this._push(BufferWriter.writeBytesBuffer,$,a),this};function writeStringBuffer(_,a,$){_.length<40?util$6.utf8.write(_,a,$):a.utf8Write?a.utf8Write(_,$):a.write(_,$)}BufferWriter.prototype.string=function _(a){var $=util$6.Buffer.byteLength(a);return this.uint32($),$&&this._push(writeStringBuffer,$,a),this};BufferWriter._configure();var reader$3=Reader$1,util$5=requireMinimal$2(),BufferReader$1,LongBits$1=util$5.LongBits,utf8=util$5.utf8;function indexOutOfRange(_,a){return RangeError("index out of range: "+_.pos+" + "+(a||1)+" > "+_.len)}function Reader$1(_){this.buf=_,this.pos=0,this.len=_.length}var create_array=typeof Uint8Array<"u"?function _(a){if(a instanceof Uint8Array||Array.isArray(a))return new Reader$1(a);throw Error("illegal buffer")}:function _(a){if(Array.isArray(a))return new Reader$1(a);throw Error("illegal buffer")},create$b=function _(){return util$5.Buffer?function($){return(Reader$1.create=function(_e){return util$5.Buffer.isBuffer(_e)?new BufferReader$1(_e):create_array(_e)})($)}:create_array};Reader$1.create=create$b();Reader$1.prototype._slice=util$5.Array.prototype.subarray||util$5.Array.prototype.slice;Reader$1.prototype.uint32=function _(){var a=4294967295;return function(){if(a=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(a=(a|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(a=(a|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(a=(a|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(a=(a|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return a;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return a}}();Reader$1.prototype.int32=function _(){return this.uint32()|0};Reader$1.prototype.sint32=function _(){var a=this.uint32();return a>>>1^-(a&1)|0};function readLongVarint(){var _=new LongBits$1(0,0),a=0;if(this.len-this.pos>4){for(;a<4;++a)if(_.lo=(_.lo|(this.buf[this.pos]&127)<<a*7)>>>0,this.buf[this.pos++]<128)return _;if(_.lo=(_.lo|(this.buf[this.pos]&127)<<28)>>>0,_.hi=(_.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return _;a=0}else{for(;a<3;++a){if(this.pos>=this.len)throw indexOutOfRange(this);if(_.lo=(_.lo|(this.buf[this.pos]&127)<<a*7)>>>0,this.buf[this.pos++]<128)return _}return _.lo=(_.lo|(this.buf[this.pos++]&127)<<a*7)>>>0,_}if(this.len-this.pos>4){for(;a<5;++a)if(_.hi=(_.hi|(this.buf[this.pos]&127)<<a*7+3)>>>0,this.buf[this.pos++]<128)return _}else for(;a<5;++a){if(this.pos>=this.len)throw indexOutOfRange(this);if(_.hi=(_.hi|(this.buf[this.pos]&127)<<a*7+3)>>>0,this.buf[this.pos++]<128)return _}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function _(){return this.uint32()!==0};function readFixed32_end(_,a){return(_[a-4]|_[a-3]<<8|_[a-2]<<16|_[a-1]<<24)>>>0}Reader$1.prototype.fixed32=function _(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)};Reader$1.prototype.sfixed32=function _(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits$1(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function _(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var a=util$5.float.readFloatLE(this.buf,this.pos);return this.pos+=4,a};Reader$1.prototype.double=function _(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var a=util$5.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,a};Reader$1.prototype.bytes=function _(){var a=this.uint32(),$=this.pos,j=this.pos+a;if(j>this.len)throw indexOutOfRange(this,a);return this.pos+=a,Array.isArray(this.buf)?this.buf.slice($,j):$===j?new this.buf.constructor(0):this._slice.call(this.buf,$,j)};Reader$1.prototype.string=function _(){var a=this.bytes();return utf8.read(a,0,a.length)};Reader$1.prototype.skip=function _(a){if(typeof a=="number"){if(this.pos+a>this.len)throw indexOutOfRange(this,a);this.pos+=a}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this};Reader$1.prototype.skipType=function(_){switch(_){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(_=this.uint32()&7)!==4;)this.skipType(_);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+_+" at offset "+this.pos)}return this};Reader$1._configure=function(_){BufferReader$1=_,Reader$1.create=create$b(),BufferReader$1._configure();var a=util$5.Long?"toLong":"toNumber";util$5.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[a](!1)},uint64:function(){return readLongVarint.call(this)[a](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[a](!1)},fixed64:function(){return readFixed64.call(this)[a](!0)},sfixed64:function(){return readFixed64.call(this)[a](!1)}})};var reader_buffer$1=BufferReader,Reader=reader$3;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$4=requireMinimal$2();function BufferReader(_){Reader.call(this,_)}BufferReader._configure=function(){util$4.Buffer&&(BufferReader.prototype._slice=util$4.Buffer.prototype.slice)};BufferReader.prototype.string=function _(){var a=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+a,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+a,this.len))};BufferReader._configure();var rpc$2={},service$1=Service$1,util$3=requireMinimal$2();(Service$1.prototype=Object.create(util$3.EventEmitter.prototype)).constructor=Service$1;function Service$1(_,a,$){if(typeof _!="function")throw TypeError("rpcImpl must be a function");util$3.EventEmitter.call(this),this.rpcImpl=_,this.requestDelimited=Boolean(a),this.responseDelimited=Boolean($)}Service$1.prototype.rpcCall=function _(a,$,j,_e,et){if(!_e)throw TypeError("request must be specified");var tt=this;if(!et)return util$3.asPromise(_,tt,a,$,j,_e);if(!tt.rpcImpl){setTimeout(function(){et(Error("already ended"))},0);return}try{return tt.rpcImpl(a,$[tt.requestDelimited?"encodeDelimited":"encode"](_e).finish(),function(nt,it){if(nt)return tt.emit("error",nt,a),et(nt);if(it===null){tt.end(!0);return}if(!(it instanceof j))try{it=j[tt.responseDelimited?"decodeDelimited":"decode"](it)}catch(st){return tt.emit("error",st,a),et(st)}return tt.emit("data",it,a),et(null,it)})}catch(rt){tt.emit("error",rt,a),setTimeout(function(){et(rt)},0);return}};Service$1.prototype.end=function _(a){return this.rpcImpl&&(a||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};(function(_){var a=_;a.Service=service$1})(rpc$2);var roots$1={};(function(_){var a=_;a.build="minimal",a.Writer=writer$2,a.BufferWriter=writer_buffer$1,a.Reader=reader$3,a.BufferReader=reader_buffer$1,a.util=requireMinimal$2(),a.rpc=rpc$2,a.roots=roots$1,a.configure=$;function $(){a.util._configure(),a.Writer._configure(a.BufferWriter),a.Reader._configure(a.BufferReader)}$()})(indexMinimal$1);(function(_){_.exports=indexMinimal$1})(minimal$3);const $protobuf=getDefaultExportFromCjs(minimal$3.exports),$Reader$7=$protobuf.Reader,$Writer$7=$protobuf.Writer,$util$6=$protobuf.util,$root$7=$protobuf.roots["ipfs-unixfs"]||($protobuf.roots["ipfs-unixfs"]={}),Data=$root$7.Data=(()=>{function _(a){if(this.blocksizes=[],a)for(var $=Object.keys(a),j=0;j<$.length;++j)a[$[j]]!=null&&(this[$[j]]=a[$[j]])}return _.prototype.Type=0,_.prototype.Data=$util$6.newBuffer([]),_.prototype.filesize=$util$6.Long?$util$6.Long.fromBits(0,0,!0):0,_.prototype.blocksizes=$util$6.emptyArray,_.prototype.hashType=$util$6.Long?$util$6.Long.fromBits(0,0,!0):0,_.prototype.fanout=$util$6.Long?$util$6.Long.fromBits(0,0,!0):0,_.prototype.mode=0,_.prototype.mtime=null,_.encode=function($,j){if(j||(j=$Writer$7.create()),j.uint32(8).int32($.Type),$.Data!=null&&Object.hasOwnProperty.call($,"Data")&&j.uint32(18).bytes($.Data),$.filesize!=null&&Object.hasOwnProperty.call($,"filesize")&&j.uint32(24).uint64($.filesize),$.blocksizes!=null&&$.blocksizes.length)for(var _e=0;_e<$.blocksizes.length;++_e)j.uint32(32).uint64($.blocksizes[_e]);return $.hashType!=null&&Object.hasOwnProperty.call($,"hashType")&&j.uint32(40).uint64($.hashType),$.fanout!=null&&Object.hasOwnProperty.call($,"fanout")&&j.uint32(48).uint64($.fanout),$.mode!=null&&Object.hasOwnProperty.call($,"mode")&&j.uint32(56).uint32($.mode),$.mtime!=null&&Object.hasOwnProperty.call($,"mtime")&&$root$7.UnixTime.encode($.mtime,j.uint32(66).fork()).ldelim(),j},_.decode=function($,j){$ instanceof $Reader$7||($=$Reader$7.create($));for(var _e=j===void 0?$.len:$.pos+j,et=new $root$7.Data;$.pos<_e;){var tt=$.uint32();switch(tt>>>3){case 1:et.Type=$.int32();break;case 2:et.Data=$.bytes();break;case 3:et.filesize=$.uint64();break;case 4:if(et.blocksizes&&et.blocksizes.length||(et.blocksizes=[]),(tt&7)===2)for(var rt=$.uint32()+$.pos;$.pos<rt;)et.blocksizes.push($.uint64());else et.blocksizes.push($.uint64());break;case 5:et.hashType=$.uint64();break;case 6:et.fanout=$.uint64();break;case 7:et.mode=$.uint32();break;case 8:et.mtime=$root$7.UnixTime.decode($,$.uint32());break;default:$.skipType(tt&7);break}}if(!et.hasOwnProperty("Type"))throw $util$6.ProtocolError("missing required 'Type'",{instance:et});return et},_.fromObject=function($){if($ instanceof $root$7.Data)return $;var j=new $root$7.Data;switch($.Type){case"Raw":case 0:j.Type=0;break;case"Directory":case 1:j.Type=1;break;case"File":case 2:j.Type=2;break;case"Metadata":case 3:j.Type=3;break;case"Symlink":case 4:j.Type=4;break;case"HAMTShard":case 5:j.Type=5;break}if($.Data!=null&&(typeof $.Data=="string"?$util$6.base64.decode($.Data,j.Data=$util$6.newBuffer($util$6.base64.length($.Data)),0):$.Data.length&&(j.Data=$.Data)),$.filesize!=null&&($util$6.Long?(j.filesize=$util$6.Long.fromValue($.filesize)).unsigned=!0:typeof $.filesize=="string"?j.filesize=parseInt($.filesize,10):typeof $.filesize=="number"?j.filesize=$.filesize:typeof $.filesize=="object"&&(j.filesize=new $util$6.LongBits($.filesize.low>>>0,$.filesize.high>>>0).toNumber(!0))),$.blocksizes){if(!Array.isArray($.blocksizes))throw TypeError(".Data.blocksizes: array expected");j.blocksizes=[];for(var _e=0;_e<$.blocksizes.length;++_e)$util$6.Long?(j.blocksizes[_e]=$util$6.Long.fromValue($.blocksizes[_e])).unsigned=!0:typeof $.blocksizes[_e]=="string"?j.blocksizes[_e]=parseInt($.blocksizes[_e],10):typeof $.blocksizes[_e]=="number"?j.blocksizes[_e]=$.blocksizes[_e]:typeof $.blocksizes[_e]=="object"&&(j.blocksizes[_e]=new $util$6.LongBits($.blocksizes[_e].low>>>0,$.blocksizes[_e].high>>>0).toNumber(!0))}if($.hashType!=null&&($util$6.Long?(j.hashType=$util$6.Long.fromValue($.hashType)).unsigned=!0:typeof $.hashType=="string"?j.hashType=parseInt($.hashType,10):typeof $.hashType=="number"?j.hashType=$.hashType:typeof $.hashType=="object"&&(j.hashType=new $util$6.LongBits($.hashType.low>>>0,$.hashType.high>>>0).toNumber(!0))),$.fanout!=null&&($util$6.Long?(j.fanout=$util$6.Long.fromValue($.fanout)).unsigned=!0:typeof $.fanout=="string"?j.fanout=parseInt($.fanout,10):typeof $.fanout=="number"?j.fanout=$.fanout:typeof $.fanout=="object"&&(j.fanout=new $util$6.LongBits($.fanout.low>>>0,$.fanout.high>>>0).toNumber(!0))),$.mode!=null&&(j.mode=$.mode>>>0),$.mtime!=null){if(typeof $.mtime!="object")throw TypeError(".Data.mtime: object expected");j.mtime=$root$7.UnixTime.fromObject($.mtime)}return j},_.toObject=function($,j){j||(j={});var _e={};if((j.arrays||j.defaults)&&(_e.blocksizes=[]),j.defaults){if(_e.Type=j.enums===String?"Raw":0,j.bytes===String?_e.Data="":(_e.Data=[],j.bytes!==Array&&(_e.Data=$util$6.newBuffer(_e.Data))),$util$6.Long){var et=new $util$6.Long(0,0,!0);_e.filesize=j.longs===String?et.toString():j.longs===Number?et.toNumber():et}else _e.filesize=j.longs===String?"0":0;if($util$6.Long){var et=new $util$6.Long(0,0,!0);_e.hashType=j.longs===String?et.toString():j.longs===Number?et.toNumber():et}else _e.hashType=j.longs===String?"0":0;if($util$6.Long){var et=new $util$6.Long(0,0,!0);_e.fanout=j.longs===String?et.toString():j.longs===Number?et.toNumber():et}else _e.fanout=j.longs===String?"0":0;_e.mode=0,_e.mtime=null}if($.Type!=null&&$.hasOwnProperty("Type")&&(_e.Type=j.enums===String?$root$7.Data.DataType[$.Type]:$.Type),$.Data!=null&&$.hasOwnProperty("Data")&&(_e.Data=j.bytes===String?$util$6.base64.encode($.Data,0,$.Data.length):j.bytes===Array?Array.prototype.slice.call($.Data):$.Data),$.filesize!=null&&$.hasOwnProperty("filesize")&&(typeof $.filesize=="number"?_e.filesize=j.longs===String?String($.filesize):$.filesize:_e.filesize=j.longs===String?$util$6.Long.prototype.toString.call($.filesize):j.longs===Number?new $util$6.LongBits($.filesize.low>>>0,$.filesize.high>>>0).toNumber(!0):$.filesize),$.blocksizes&&$.blocksizes.length){_e.blocksizes=[];for(var tt=0;tt<$.blocksizes.length;++tt)typeof $.blocksizes[tt]=="number"?_e.blocksizes[tt]=j.longs===String?String($.blocksizes[tt]):$.blocksizes[tt]:_e.blocksizes[tt]=j.longs===String?$util$6.Long.prototype.toString.call($.blocksizes[tt]):j.longs===Number?new $util$6.LongBits($.blocksizes[tt].low>>>0,$.blocksizes[tt].high>>>0).toNumber(!0):$.blocksizes[tt]}return $.hashType!=null&&$.hasOwnProperty("hashType")&&(typeof $.hashType=="number"?_e.hashType=j.longs===String?String($.hashType):$.hashType:_e.hashType=j.longs===String?$util$6.Long.prototype.toString.call($.hashType):j.longs===Number?new $util$6.LongBits($.hashType.low>>>0,$.hashType.high>>>0).toNumber(!0):$.hashType),$.fanout!=null&&$.hasOwnProperty("fanout")&&(typeof $.fanout=="number"?_e.fanout=j.longs===String?String($.fanout):$.fanout:_e.fanout=j.longs===String?$util$6.Long.prototype.toString.call($.fanout):j.longs===Number?new $util$6.LongBits($.fanout.low>>>0,$.fanout.high>>>0).toNumber(!0):$.fanout),$.mode!=null&&$.hasOwnProperty("mode")&&(_e.mode=$.mode),$.mtime!=null&&$.hasOwnProperty("mtime")&&(_e.mtime=$root$7.UnixTime.toObject($.mtime,j)),_e},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_.DataType=function(){const a={},$=Object.create(a);return $[a[0]="Raw"]=0,$[a[1]="Directory"]=1,$[a[2]="File"]=2,$[a[3]="Metadata"]=3,$[a[4]="Symlink"]=4,$[a[5]="HAMTShard"]=5,$}(),_})();$root$7.UnixTime=(()=>{function _(a){if(a)for(var $=Object.keys(a),j=0;j<$.length;++j)a[$[j]]!=null&&(this[$[j]]=a[$[j]])}return _.prototype.Seconds=$util$6.Long?$util$6.Long.fromBits(0,0,!1):0,_.prototype.FractionalNanoseconds=0,_.encode=function($,j){return j||(j=$Writer$7.create()),j.uint32(8).int64($.Seconds),$.FractionalNanoseconds!=null&&Object.hasOwnProperty.call($,"FractionalNanoseconds")&&j.uint32(21).fixed32($.FractionalNanoseconds),j},_.decode=function($,j){$ instanceof $Reader$7||($=$Reader$7.create($));for(var _e=j===void 0?$.len:$.pos+j,et=new $root$7.UnixTime;$.pos<_e;){var tt=$.uint32();switch(tt>>>3){case 1:et.Seconds=$.int64();break;case 2:et.FractionalNanoseconds=$.fixed32();break;default:$.skipType(tt&7);break}}if(!et.hasOwnProperty("Seconds"))throw $util$6.ProtocolError("missing required 'Seconds'",{instance:et});return et},_.fromObject=function($){if($ instanceof $root$7.UnixTime)return $;var j=new $root$7.UnixTime;return $.Seconds!=null&&($util$6.Long?(j.Seconds=$util$6.Long.fromValue($.Seconds)).unsigned=!1:typeof $.Seconds=="string"?j.Seconds=parseInt($.Seconds,10):typeof $.Seconds=="number"?j.Seconds=$.Seconds:typeof $.Seconds=="object"&&(j.Seconds=new $util$6.LongBits($.Seconds.low>>>0,$.Seconds.high>>>0).toNumber())),$.FractionalNanoseconds!=null&&(j.FractionalNanoseconds=$.FractionalNanoseconds>>>0),j},_.toObject=function($,j){j||(j={});var _e={};if(j.defaults){if($util$6.Long){var et=new $util$6.Long(0,0,!1);_e.Seconds=j.longs===String?et.toString():j.longs===Number?et.toNumber():et}else _e.Seconds=j.longs===String?"0":0;_e.FractionalNanoseconds=0}return $.Seconds!=null&&$.hasOwnProperty("Seconds")&&(typeof $.Seconds=="number"?_e.Seconds=j.longs===String?String($.Seconds):$.Seconds:_e.Seconds=j.longs===String?$util$6.Long.prototype.toString.call($.Seconds):j.longs===Number?new $util$6.LongBits($.Seconds.low>>>0,$.Seconds.high>>>0).toNumber():$.Seconds),$.FractionalNanoseconds!=null&&$.hasOwnProperty("FractionalNanoseconds")&&(_e.FractionalNanoseconds=$.FractionalNanoseconds),_e},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})();$root$7.Metadata=(()=>{function _(a){if(a)for(var $=Object.keys(a),j=0;j<$.length;++j)a[$[j]]!=null&&(this[$[j]]=a[$[j]])}return _.prototype.MimeType="",_.encode=function($,j){return j||(j=$Writer$7.create()),$.MimeType!=null&&Object.hasOwnProperty.call($,"MimeType")&&j.uint32(10).string($.MimeType),j},_.decode=function($,j){$ instanceof $Reader$7||($=$Reader$7.create($));for(var _e=j===void 0?$.len:$.pos+j,et=new $root$7.Metadata;$.pos<_e;){var tt=$.uint32();switch(tt>>>3){case 1:et.MimeType=$.string();break;default:$.skipType(tt&7);break}}return et},_.fromObject=function($){if($ instanceof $root$7.Metadata)return $;var j=new $root$7.Metadata;return $.MimeType!=null&&(j.MimeType=String($.MimeType)),j},_.toObject=function($,j){j||(j={});var _e={};return j.defaults&&(_e.MimeType=""),$.MimeType!=null&&$.hasOwnProperty("MimeType")&&(_e.MimeType=$.MimeType),_e},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})();const PBData=Data,types=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],dirTypes=["directory","hamt-sharded-directory"],DEFAULT_FILE_MODE=parseInt("0644",8),DEFAULT_DIRECTORY_MODE=parseInt("0755",8);function parseMode(_){if(_!=null)return typeof _=="number"?_&4095:(_=_.toString(),_.substring(0,1)==="0"?parseInt(_,8)&4095:parseInt(_,10)&4095)}function parseMtime$1(_){if(_==null)return;let a;if(_.secs!=null&&(a={secs:_.secs,nsecs:_.nsecs}),_.Seconds!=null&&(a={secs:_.Seconds,nsecs:_.FractionalNanoseconds}),Array.isArray(_)&&(a={secs:_[0],nsecs:_[1]}),_ instanceof Date){const $=_.getTime(),j=Math.floor($/1e3);a={secs:j,nsecs:($-j*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(a,"secs")){if(a!=null&&a.nsecs!=null&&(a.nsecs<0||a.nsecs>999999999))throw errCode(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return a}}class UnixFS{static unmarshal(a){const $=PBData.decode(a),j=PBData.toObject($,{defaults:!1,arrays:!0,longs:Number,objects:!1}),_e=new UnixFS({type:types[j.Type],data:j.Data,blockSizes:j.blocksizes,mode:j.mode,mtime:j.mtime?{secs:j.mtime.Seconds,nsecs:j.mtime.FractionalNanoseconds}:void 0});return _e._originalMode=j.mode||0,_e}constructor(a={type:"file"}){const{type:$,data:j,blockSizes:_e,hashType:et,fanout:tt,mtime:rt,mode:nt}=a;if($&&!types.includes($))throw errCode(new Error("Type: "+$+" is not valid"),"ERR_INVALID_TYPE");this.type=$||"file",this.data=j,this.hashType=et,this.fanout=tt,this.blockSizes=_e||[],this._originalMode=0,this.mode=parseMode(nt),rt&&(this.mtime=parseMtime$1(rt),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(a){this._mode=this.isDirectory()?DEFAULT_DIRECTORY_MODE:DEFAULT_FILE_MODE;const $=parseMode(a);$!==void 0&&(this._mode=$)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&dirTypes.includes(this.type))}addBlockSize(a){this.blockSizes.push(a)}removeBlockSize(a){this.blockSizes.splice(a,1)}fileSize(){if(this.isDirectory())return 0;let a=0;return this.blockSizes.forEach($=>{a+=$}),this.data&&(a+=this.data.length),a}marshal(){let a;switch(this.type){case"raw":a=PBData.DataType.Raw;break;case"directory":a=PBData.DataType.Directory;break;case"file":a=PBData.DataType.File;break;case"metadata":a=PBData.DataType.Metadata;break;case"symlink":a=PBData.DataType.Symlink;break;case"hamt-sharded-directory":a=PBData.DataType.HAMTShard;break;default:throw errCode(new Error("Type: "+a+" is not valid"),"ERR_INVALID_TYPE")}let $=this.data;(!this.data||!this.data.length)&&($=void 0);let j;this.mode!=null&&(j=this._originalMode&4294963200|(parseMode(this.mode)||0),j===DEFAULT_FILE_MODE&&!this.isDirectory()&&(j=void 0),j===DEFAULT_DIRECTORY_MODE&&this.isDirectory()&&(j=void 0));let _e;if(this.mtime!=null){const tt=parseMtime$1(this.mtime);tt&&(_e={Seconds:tt.secs,FractionalNanoseconds:tt.nsecs},_e.FractionalNanoseconds===0&&delete _e.FractionalNanoseconds)}const et={Type:a,Data:$,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:j,mtime:_e};return PBData.encode(et).finish()}}var encode_1$4=encode$t,MSB$7=128,REST$7=127,MSBALL$4=~REST$7,INT$4=Math.pow(2,31);function encode$t(_,a,$){a=a||[],$=$||0;for(var j=$;_>=INT$4;)a[$++]=_&255|MSB$7,_/=128;for(;_&MSBALL$4;)a[$++]=_&255|MSB$7,_>>>=7;return a[$]=_|0,encode$t.bytes=$-j+1,a}var decode$p=read$5,MSB$1$3=128,REST$1$3=127;function read$5(_,j){var $=0,j=j||0,_e=0,et=j,tt,rt=_.length;do{if(et>=rt)throw read$5.bytes=0,new RangeError("Could not decode varint");tt=_[et++],$+=_e<28?(tt&REST$1$3)<<_e:(tt&REST$1$3)*Math.pow(2,_e),_e+=7}while(tt>=MSB$1$3);return read$5.bytes=et-j,$}var N1$5=Math.pow(2,7),N2$5=Math.pow(2,14),N3$5=Math.pow(2,21),N4$5=Math.pow(2,28),N5$5=Math.pow(2,35),N6$5=Math.pow(2,42),N7$5=Math.pow(2,49),N8$5=Math.pow(2,56),N9$5=Math.pow(2,63),length$7=function(_){return _<N1$5?1:_<N2$5?2:_<N3$5?3:_<N4$5?4:_<N5$5?5:_<N6$5?6:_<N7$5?7:_<N8$5?8:_<N9$5?9:10},varint$5={encode:encode_1$4,decode:decode$p,encodingLength:length$7},_brrp_varint$2=varint$5;const decode$o=(_,a=0)=>[_brrp_varint$2.decode(_,a),_brrp_varint$2.decode.bytes],encodeTo$2=(_,a,$=0)=>(_brrp_varint$2.encode(_,a,$),a),encodingLength$2=_=>_brrp_varint$2.encodingLength(_),create$a=(_,a)=>{const $=a.byteLength,j=encodingLength$2(_),_e=j+encodingLength$2($),et=new Uint8Array(_e+$);return encodeTo$2(_,et,0),encodeTo$2($,et,j),et.set(a,_e),new Digest$2(_,$,a,et)},decode$n=_=>{const a=coerce$2(_),[$,j]=decode$o(a),[_e,et]=decode$o(a.subarray(j)),tt=a.subarray(j+et);if(tt.byteLength!==_e)throw new Error("Incorrect length");return new Digest$2($,_e,tt,a)},equals$2=(_,a)=>{if(_===a)return!0;{const $=a;return _.code===$.code&&_.size===$.size&&$.bytes instanceof Uint8Array&&equals$3(_.bytes,$.bytes)}};class Digest$2{constructor(a,$,j,_e){this.code=a,this.size=$,this.digest=j,this.bytes=_e}}const format$4=(_,a)=>{const{bytes:$,version:j}=_;switch(j){case 0:return toStringV0($,baseCache(_),a||base58btc$2.encoder);default:return toStringV1($,baseCache(_),a||base32$4.encoder)}},cache$3=new WeakMap,baseCache=_=>{const a=cache$3.get(_);if(a==null){const $=new Map;return cache$3.set(_,$),$}return a};class CID{constructor(a,$,j,_e){this.code=$,this.version=a,this.multihash=j,this.bytes=_e,this["/"]=_e}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:a,multihash:$}=this;if(a!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if($.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return CID.createV0($)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:a,digest:$}=this.multihash,j=create$a(a,$);return CID.createV1(this.code,j)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(a){return CID.equals(this,a)}static equals(a,$){const j=$;return j&&a.code===j.code&&a.version===j.version&&equals$2(a.multihash,j.multihash)}toString(a){return format$4(this,a)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(a){if(a==null)return null;const $=a;if($ instanceof CID)return $;if($["/"]!=null&&$["/"]===$.bytes||$.asCID===$){const{version:j,code:_e,multihash:et,bytes:tt}=$;return new CID(j,_e,et,tt||encodeCID$1(j,_e,et.bytes))}else if($[cidSymbol]===!0){const{version:j,multihash:_e,code:et}=$,tt=decode$n(_e);return CID.create(j,et,tt)}else return null}static create(a,$,j){if(typeof $!="number")throw new Error("String codecs are no longer supported");if(!(j.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(a){case 0:{if($!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new CID(a,$,j,j.bytes)}case 1:{const _e=encodeCID$1(a,$,j.bytes);return new CID(a,$,j,_e)}default:throw new Error("Invalid version")}}static createV0(a){return CID.create(0,DAG_PB_CODE,a)}static createV1(a,$){return CID.create(1,a,$)}static decode(a){const[$,j]=CID.decodeFirst(a);if(j.length)throw new Error("Incorrect length");return $}static decodeFirst(a){const $=CID.inspectBytes(a),j=$.size-$.multihashSize,_e=coerce$2(a.subarray(j,j+$.multihashSize));if(_e.byteLength!==$.multihashSize)throw new Error("Incorrect length");const et=_e.subarray($.multihashSize-$.digestSize),tt=new Digest$2($.multihashCode,$.digestSize,et,_e);return[$.version===0?CID.createV0(tt):CID.createV1($.codec,tt),a.subarray($.size)]}static inspectBytes(a){let $=0;const j=()=>{const[ot,at]=decode$o(a.subarray($));return $+=at,ot};let _e=j(),et=DAG_PB_CODE;if(_e===18?(_e=0,$=0):et=j(),_e!==0&&_e!==1)throw new RangeError(`Invalid CID version ${_e}`);const tt=$,rt=j(),nt=j(),it=$+nt,st=it-tt;return{version:_e,codec:et,multihashCode:rt,digestSize:nt,multihashSize:st,size:it}}static parse(a,$){const[j,_e]=parseCIDtoBytes(a,$),et=CID.decode(_e);return baseCache(et).set(j,a),et}}const parseCIDtoBytes=(_,a)=>{switch(_[0]){case"Q":{const $=a||base58btc$2;return[base58btc$2.prefix,$.decode(`${base58btc$2.prefix}${_}`)]}case base58btc$2.prefix:{const $=a||base58btc$2;return[base58btc$2.prefix,$.decode(_)]}case base32$4.prefix:{const $=a||base32$4;return[base32$4.prefix,$.decode(_)]}default:{if(a==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[_[0],a.decode(_)]}}},toStringV0=(_,a,$)=>{const{prefix:j}=$;if(j!==base58btc$2.prefix)throw Error(`Cannot string encode V0 in ${$.name} encoding`);const _e=a.get(j);if(_e==null){const et=$.encode(_).slice(1);return a.set(j,et),et}else return _e},toStringV1=(_,a,$)=>{const{prefix:j}=$,_e=a.get(j);if(_e==null){const et=$.encode(_);return a.set(j,et),et}else return _e},DAG_PB_CODE=112,SHA_256_CODE=18,encodeCID$1=(_,a,$)=>{const j=encodingLength$2(_),_e=j+encodingLength$2(a),et=new Uint8Array(_e+$.byteLength);return encodeTo$2(_,et,0),encodeTo$2(a,et,j),et.set($,_e),et},cidSymbol=Symbol.for("@ipld/js-cid/CID"),textDecoder$3=new TextDecoder;function decodeVarint(_,a){let $=0;for(let j=0;;j+=7){if(j>=64)throw new Error("protobuf: varint overflow");if(a>=_.length)throw new Error("protobuf: unexpected end of data");const _e=_[a++];if($+=j<28?(_e&127)<<j:(_e&127)*2**j,_e<128)break}return[$,a]}function decodeBytes(_,a){let $;[$,a]=decodeVarint(_,a);const j=a+$;if($<0||j<0)throw new Error("protobuf: invalid length");if(j>_.length)throw new Error("protobuf: unexpected end of data");return[_.subarray(a,j),j]}function decodeKey(_,a){let $;return[$,a]=decodeVarint(_,a),[$&7,$>>3,a]}function decodeLink(_){const a={},$=_.length;let j=0;for(;j<$;){let _e,et;if([_e,et,j]=decodeKey(_,j),et===1){if(a.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(_e!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${_e}) for Hash`);if(a.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(a.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[a.Hash,j]=decodeBytes(_,j)}else if(et===2){if(a.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(_e!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${_e}) for Name`);if(a.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let tt;[tt,j]=decodeBytes(_,j),a.Name=textDecoder$3.decode(tt)}else if(et===3){if(a.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(_e!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${_e}) for Tsize`);[a.Tsize,j]=decodeVarint(_,j)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${et}`)}if(j>$)throw new Error("protobuf: (PBLink) unexpected end of data");return a}function decodeNode(_){const a=_.length;let $=0,j,_e=!1,et;for(;$<a;){let rt,nt;if([rt,nt,$]=decodeKey(_,$),rt!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${rt}`);if(nt===1){if(et)throw new Error("protobuf: (PBNode) duplicate Data section");[et,$]=decodeBytes(_,$),j&&(_e=!0)}else if(nt===2){if(_e)throw new Error("protobuf: (PBNode) duplicate Links section");j||(j=[]);let it;[it,$]=decodeBytes(_,$),j.push(decodeLink(it))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${nt}`)}if($>a)throw new Error("protobuf: (PBNode) unexpected end of data");const tt={};return et&&(tt.Data=et),tt.Links=j||[],tt}const textEncoder$5=new TextEncoder,maxInt32=2**32,maxUInt32=2**31;function encodeLink(_,a){let $=a.length;if(typeof _.Tsize=="number"){if(_.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(_.Tsize))throw new Error("Tsize too large for encoding");$=encodeVarint(a,$,_.Tsize)-1,a[$]=24}if(typeof _.Name=="string"){const j=textEncoder$5.encode(_.Name);$-=j.length,a.set(j,$),$=encodeVarint(a,$,j.length)-1,a[$]=18}return _.Hash&&($-=_.Hash.length,a.set(_.Hash,$),$=encodeVarint(a,$,_.Hash.length)-1,a[$]=10),a.length-$}function encodeNode(_){const a=sizeNode(_),$=new Uint8Array(a);let j=a;if(_.Data&&(j-=_.Data.length,$.set(_.Data,j),j=encodeVarint($,j,_.Data.length)-1,$[j]=10),_.Links)for(let _e=_.Links.length-1;_e>=0;_e--){const et=encodeLink(_.Links[_e],$.subarray(0,j));j-=et,j=encodeVarint($,j,et)-1,$[j]=18}return $}function sizeLink(_){let a=0;if(_.Hash){const $=_.Hash.length;a+=1+$+sov($)}if(typeof _.Name=="string"){const $=textEncoder$5.encode(_.Name).length;a+=1+$+sov($)}return typeof _.Tsize=="number"&&(a+=1+sov(_.Tsize)),a}function sizeNode(_){let a=0;if(_.Data){const $=_.Data.length;a+=1+$+sov($)}if(_.Links)for(const $ of _.Links){const j=sizeLink($);a+=1+j+sov(j)}return a}function encodeVarint(_,a,$){a-=sov($);const j=a;for(;$>=maxUInt32;)_[a++]=$&127|128,$/=128;for(;$>=128;)_[a++]=$&127|128,$>>>=7;return _[a]=$,j}function sov(_){return _%2===0&&_++,Math.floor((len64(_)+6)/7)}function len64(_){let a=0;return _>=maxInt32&&(_=Math.floor(_/maxInt32),a=32),_>=1<<16&&(_>>>=16,a+=16),_>=1<<8&&(_>>>=8,a+=8),a+len8tab[_]}const len8tab=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],pbNodeProperties=["Data","Links"],pbLinkProperties=["Hash","Name","Tsize"],textEncoder$4=new TextEncoder;function linkComparator(_,a){if(_===a)return 0;const $=_.Name?textEncoder$4.encode(_.Name):[],j=a.Name?textEncoder$4.encode(a.Name):[];let _e=$.length,et=j.length;for(let tt=0,rt=Math.min(_e,et);tt<rt;++tt)if($[tt]!==j[tt]){_e=$[tt],et=j[tt];break}return _e<et?-1:et<_e?1:0}function hasOnlyProperties(_,a){return!Object.keys(_).some($=>!a.includes($))}function asLink(_){if(typeof _.asCID=="object"){const $=CID.asCID(_);if(!$)throw new TypeError("Invalid DAG-PB form");return{Hash:$}}if(typeof _!="object"||Array.isArray(_))throw new TypeError("Invalid DAG-PB form");const a={};if(_.Hash){let $=CID.asCID(_.Hash);try{$||(typeof _.Hash=="string"?$=CID.parse(_.Hash):_.Hash instanceof Uint8Array&&($=CID.decode(_.Hash)))}catch(j){throw new TypeError(`Invalid DAG-PB form: ${j.message}`)}$&&(a.Hash=$)}if(!a.Hash)throw new TypeError("Invalid DAG-PB form");return typeof _.Name=="string"&&(a.Name=_.Name),typeof _.Tsize=="number"&&(a.Tsize=_.Tsize),a}function prepare(_){if((_ instanceof Uint8Array||typeof _=="string")&&(_={Data:_}),typeof _!="object"||Array.isArray(_))throw new TypeError("Invalid DAG-PB form");const a={};if(_.Data!==void 0)if(typeof _.Data=="string")a.Data=textEncoder$4.encode(_.Data);else if(_.Data instanceof Uint8Array)a.Data=_.Data;else throw new TypeError("Invalid DAG-PB form");if(_.Links!==void 0)if(Array.isArray(_.Links))a.Links=_.Links.map(asLink),a.Links.sort(linkComparator);else throw new TypeError("Invalid DAG-PB form");else a.Links=[];return a}function validate$1(_){if(!_||typeof _!="object"||Array.isArray(_))throw new TypeError("Invalid DAG-PB form");if(!hasOnlyProperties(_,pbNodeProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(_.Data!==void 0&&!(_.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(_.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let a=0;a<_.Links.length;a++){const $=_.Links[a];if(!$||typeof $!="object"||Array.isArray($))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!hasOnlyProperties($,pbLinkProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!$.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if($.Hash.asCID!==$.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if($.Name!==void 0&&typeof $.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if($.Tsize!==void 0&&(typeof $.Tsize!="number"||$.Tsize%1!==0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(a>0&&linkComparator($,_.Links[a-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function createNode$2(_,a=[]){return prepare({Data:_,Links:a})}function createLink(_,a,$){return asLink({Hash:$,Name:_,Tsize:a})}const name$9="dag-pb",code$9=112;function encode$s(_){validate$1(_);const a={};return _.Links&&(a.Links=_.Links.map($=>{const j={};return $.Hash&&(j.Hash=$.Hash.bytes),$.Name!==void 0&&(j.Name=$.Name),$.Tsize!==void 0&&(j.Tsize=$.Tsize),j})),_.Data&&(a.Data=_.Data),encodeNode(a)}function decode$m(_){const a=decodeNode(_),$={};return a.Data&&($.Data=a.Data),a.Links&&($.Links=a.Links.map(j=>{const _e={};try{_e.Hash=CID.decode(j.Hash)}catch{}if(!_e.Hash)throw new Error("Invalid Hash field found in link, expected CID");return j.Name!==void 0&&(_e.Name=j.Name),j.Tsize!==void 0&&(_e.Tsize=j.Tsize),_e})),$}const dagPB=Object.freeze(Object.defineProperty({__proto__:null,name:name$9,code:code$9,encode:encode$s,decode:decode$m,prepare,validate:validate$1,createNode:createNode$2,createLink},Symbol.toStringTag,{value:"Module"})),typeofs=["string","number","bigint","symbol"],objectTypeNames=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function is(_){if(_===null)return"null";if(_===void 0)return"undefined";if(_===!0||_===!1)return"boolean";const a=typeof _;if(typeofs.includes(a))return a;if(a==="function")return"Function";if(Array.isArray(_))return"Array";if(isBuffer$1(_))return"Buffer";const $=getObjectType(_);return $||"Object"}function isBuffer$1(_){return _&&_.constructor&&_.constructor.isBuffer&&_.constructor.isBuffer.call(null,_)}function getObjectType(_){const a=Object.prototype.toString.call(_).slice(8,-1);if(objectTypeNames.includes(a))return a}class Type{constructor(a,$,j){this.major=a,this.majorEncoded=a<<5,this.name=$,this.terminal=j}toString(){return`Type[${this.major}].${this.name}`}compare(a){return this.major<a.major?-1:this.major>a.major?1:0}}Type.uint=new Type(0,"uint",!0);Type.negint=new Type(1,"negint",!0);Type.bytes=new Type(2,"bytes",!0);Type.string=new Type(3,"string",!0);Type.array=new Type(4,"array",!1);Type.map=new Type(5,"map",!1);Type.tag=new Type(6,"tag",!1);Type.float=new Type(7,"float",!0);Type.false=new Type(7,"false",!0);Type.true=new Type(7,"true",!0);Type.null=new Type(7,"null",!0);Type.undefined=new Type(7,"undefined",!0);Type.break=new Type(7,"break",!0);class Token{constructor(a,$,j){this.type=a,this.value=$,this.encodedLength=j,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const useBuffer=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",textDecoder$2=new TextDecoder,textEncoder$3=new TextEncoder;function isBuffer(_){return useBuffer&&globalThis.Buffer.isBuffer(_)}function asU8A(_){return _ instanceof Uint8Array?isBuffer(_)?new Uint8Array(_.buffer,_.byteOffset,_.byteLength):_:Uint8Array.from(_)}const toString$8=useBuffer?(_,a,$)=>$-a>64?globalThis.Buffer.from(_.subarray(a,$)).toString("utf8"):utf8Slice(_,a,$):(_,a,$)=>$-a>64?textDecoder$2.decode(_.subarray(a,$)):utf8Slice(_,a,$),fromString$6=useBuffer?_=>_.length>64?globalThis.Buffer.from(_):utf8ToBytes(_):_=>_.length>64?textEncoder$3.encode(_):utf8ToBytes(_),fromArray=_=>Uint8Array.from(_),slice=useBuffer?(_,a,$)=>isBuffer(_)?new Uint8Array(_.subarray(a,$)):_.slice(a,$):(_,a,$)=>_.slice(a,$),concat$2=useBuffer?(_,a)=>(_=_.map($=>$ instanceof Uint8Array?$:globalThis.Buffer.from($)),asU8A(globalThis.Buffer.concat(_,a))):(_,a)=>{const $=new Uint8Array(a);let j=0;for(let _e of _)j+_e.length>$.length&&(_e=_e.subarray(0,$.length-j)),$.set(_e,j),j+=_e.length;return $},alloc$1=useBuffer?_=>globalThis.Buffer.allocUnsafe(_):_=>new Uint8Array(_);function compare$2(_,a){if(isBuffer(_)&&isBuffer(a))return _.compare(a);for(let $=0;$<_.length;$++)if(_[$]!==a[$])return _[$]<a[$]?-1:1;return 0}function utf8ToBytes(_,a=1/0){let $;const j=_.length;let _e=null;const et=[];for(let tt=0;tt<j;++tt){if($=_.charCodeAt(tt),$>55295&&$<57344){if(!_e){if($>56319){(a-=3)>-1&&et.push(239,191,189);continue}else if(tt+1===j){(a-=3)>-1&&et.push(239,191,189);continue}_e=$;continue}if($<56320){(a-=3)>-1&&et.push(239,191,189),_e=$;continue}$=(_e-55296<<10|$-56320)+65536}else _e&&(a-=3)>-1&&et.push(239,191,189);if(_e=null,$<128){if((a-=1)<0)break;et.push($)}else if($<2048){if((a-=2)<0)break;et.push($>>6|192,$&63|128)}else if($<65536){if((a-=3)<0)break;et.push($>>12|224,$>>6&63|128,$&63|128)}else if($<1114112){if((a-=4)<0)break;et.push($>>18|240,$>>12&63|128,$>>6&63|128,$&63|128)}else throw new Error("Invalid code point")}return et}function utf8Slice(_,a,$){const j=[];for(;a<$;){const _e=_[a];let et=null,tt=_e>239?4:_e>223?3:_e>191?2:1;if(a+tt<=$){let rt,nt,it,st;switch(tt){case 1:_e<128&&(et=_e);break;case 2:rt=_[a+1],(rt&192)===128&&(st=(_e&31)<<6|rt&63,st>127&&(et=st));break;case 3:rt=_[a+1],nt=_[a+2],(rt&192)===128&&(nt&192)===128&&(st=(_e&15)<<12|(rt&63)<<6|nt&63,st>2047&&(st<55296||st>57343)&&(et=st));break;case 4:rt=_[a+1],nt=_[a+2],it=_[a+3],(rt&192)===128&&(nt&192)===128&&(it&192)===128&&(st=(_e&15)<<18|(rt&63)<<12|(nt&63)<<6|it&63,st>65535&&st<1114112&&(et=st))}}et===null?(et=65533,tt=1):et>65535&&(et-=65536,j.push(et>>>10&1023|55296),et=56320|et&1023),j.push(et),a+=tt}return decodeCodePointsArray(j)}const MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(_){const a=_.length;if(a<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,_);let $="",j=0;for(;j<a;)$+=String.fromCharCode.apply(String,_.slice(j,j+=MAX_ARGUMENTS_LENGTH));return $}const defaultChunkSize=256;class Bl{constructor(a=defaultChunkSize){this.chunkSize=a,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(a){let $=this.chunks[this.chunks.length-1];if(this.cursor+a.length<=this.maxCursor+1){const _e=$.length-(this.maxCursor-this.cursor)-1;$.set(a,_e)}else{if($){const _e=$.length-(this.maxCursor-this.cursor)-1;_e<$.length&&(this.chunks[this.chunks.length-1]=$.subarray(0,_e),this.maxCursor=this.cursor-1)}a.length<64&&a.length<this.chunkSize?($=alloc$1(this.chunkSize),this.chunks.push($),this.maxCursor+=$.length,this._initReuseChunk===null&&(this._initReuseChunk=$),$.set(a,0)):(this.chunks.push(a),this.maxCursor+=a.length)}this.cursor+=a.length}toBytes(a=!1){let $;if(this.chunks.length===1){const j=this.chunks[0];a&&this.cursor>j.length/2?($=this.cursor===j.length?j:j.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):$=slice(j,0,this.cursor)}else $=concat$2(this.chunks,this.cursor);return a&&this.reset(),$}}const decodeErrPrefix="CBOR decode error:",encodeErrPrefix="CBOR encode error:";function assertEnoughData(_,a,$){if(_.length-a<$)throw new Error(`${decodeErrPrefix} not enough data for type`)}const uintBoundaries=[24,256,65536,4294967296,BigInt("18446744073709551616")];function readUint8(_,a,$){assertEnoughData(_,a,1);const j=_[a];if($.strict===!0&&j<uintBoundaries[0])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return j}function readUint16(_,a,$){assertEnoughData(_,a,2);const j=_[a]<<8|_[a+1];if($.strict===!0&&j<uintBoundaries[1])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return j}function readUint32(_,a,$){assertEnoughData(_,a,4);const j=_[a]*16777216+(_[a+1]<<16)+(_[a+2]<<8)+_[a+3];if($.strict===!0&&j<uintBoundaries[2])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return j}function readUint64(_,a,$){assertEnoughData(_,a,8);const j=_[a]*16777216+(_[a+1]<<16)+(_[a+2]<<8)+_[a+3],_e=_[a+4]*16777216+(_[a+5]<<16)+(_[a+6]<<8)+_[a+7],et=(BigInt(j)<<BigInt(32))+BigInt(_e);if($.strict===!0&&et<uintBoundaries[3])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);if(et<=Number.MAX_SAFE_INTEGER)return Number(et);if($.allowBigInt===!0)return et;throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`)}function decodeUint8(_,a,$,j){return new Token(Type.uint,readUint8(_,a+1,j),2)}function decodeUint16(_,a,$,j){return new Token(Type.uint,readUint16(_,a+1,j),3)}function decodeUint32(_,a,$,j){return new Token(Type.uint,readUint32(_,a+1,j),5)}function decodeUint64(_,a,$,j){return new Token(Type.uint,readUint64(_,a+1,j),9)}function encodeUint(_,a){return encodeUintValue(_,0,a.value)}function encodeUintValue(_,a,$){if($<uintBoundaries[0]){const j=Number($);_.push([a|j])}else if($<uintBoundaries[1]){const j=Number($);_.push([a|24,j])}else if($<uintBoundaries[2]){const j=Number($);_.push([a|25,j>>>8,j&255])}else if($<uintBoundaries[3]){const j=Number($);_.push([a|26,j>>>24&255,j>>>16&255,j>>>8&255,j&255])}else{const j=BigInt($);if(j<uintBoundaries[4]){const _e=[a|27,0,0,0,0,0,0,0];let et=Number(j&BigInt(4294967295)),tt=Number(j>>BigInt(32)&BigInt(4294967295));_e[8]=et&255,et=et>>8,_e[7]=et&255,et=et>>8,_e[6]=et&255,et=et>>8,_e[5]=et&255,_e[4]=tt&255,tt=tt>>8,_e[3]=tt&255,tt=tt>>8,_e[2]=tt&255,tt=tt>>8,_e[1]=tt&255,_.push(_e)}else throw new Error(`${decodeErrPrefix} encountered BigInt larger than allowable range`)}}encodeUint.encodedSize=function _(a){return encodeUintValue.encodedSize(a.value)};encodeUintValue.encodedSize=function _(a){return a<uintBoundaries[0]?1:a<uintBoundaries[1]?2:a<uintBoundaries[2]?3:a<uintBoundaries[3]?5:9};encodeUint.compareTokens=function _(a,$){return a.value<$.value?-1:a.value>$.value?1:0};function decodeNegint8(_,a,$,j){return new Token(Type.negint,-1-readUint8(_,a+1,j),2)}function decodeNegint16(_,a,$,j){return new Token(Type.negint,-1-readUint16(_,a+1,j),3)}function decodeNegint32(_,a,$,j){return new Token(Type.negint,-1-readUint32(_,a+1,j),5)}const neg1b=BigInt(-1),pos1b=BigInt(1);function decodeNegint64(_,a,$,j){const _e=readUint64(_,a+1,j);if(typeof _e!="bigint"){const et=-1-_e;if(et>=Number.MIN_SAFE_INTEGER)return new Token(Type.negint,et,9)}if(j.allowBigInt!==!0)throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`);return new Token(Type.negint,neg1b-BigInt(_e),9)}function encodeNegint(_,a){const $=a.value,j=typeof $=="bigint"?$*neg1b-pos1b:$*-1-1;encodeUintValue(_,a.type.majorEncoded,j)}encodeNegint.encodedSize=function _(a){const $=a.value,j=typeof $=="bigint"?$*neg1b-pos1b:$*-1-1;return j<uintBoundaries[0]?1:j<uintBoundaries[1]?2:j<uintBoundaries[2]?3:j<uintBoundaries[3]?5:9};encodeNegint.compareTokens=function _(a,$){return a.value<$.value?1:a.value>$.value?-1:0};function toToken$3(_,a,$,j){assertEnoughData(_,a,$+j);const _e=slice(_,a+$,a+$+j);return new Token(Type.bytes,_e,$+j)}function decodeBytesCompact(_,a,$,j){return toToken$3(_,a,1,$)}function decodeBytes8(_,a,$,j){return toToken$3(_,a,2,readUint8(_,a+1,j))}function decodeBytes16(_,a,$,j){return toToken$3(_,a,3,readUint16(_,a+1,j))}function decodeBytes32(_,a,$,j){return toToken$3(_,a,5,readUint32(_,a+1,j))}function decodeBytes64(_,a,$,j){const _e=readUint64(_,a+1,j);if(typeof _e=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer bytes lengths not supported`);return toToken$3(_,a,9,_e)}function tokenBytes(_){return _.encodedBytes===void 0&&(_.encodedBytes=_.type===Type.string?fromString$6(_.value):_.value),_.encodedBytes}function encodeBytes(_,a){const $=tokenBytes(a);encodeUintValue(_,a.type.majorEncoded,$.length),_.push($)}encodeBytes.encodedSize=function _(a){const $=tokenBytes(a);return encodeUintValue.encodedSize($.length)+$.length};encodeBytes.compareTokens=function _(a,$){return compareBytes(tokenBytes(a),tokenBytes($))};function compareBytes(_,a){return _.length<a.length?-1:_.length>a.length?1:compare$2(_,a)}function toToken$2(_,a,$,j,_e){const et=$+j;assertEnoughData(_,a,et);const tt=new Token(Type.string,toString$8(_,a+$,a+et),et);return _e.retainStringBytes===!0&&(tt.byteValue=slice(_,a+$,a+et)),tt}function decodeStringCompact(_,a,$,j){return toToken$2(_,a,1,$,j)}function decodeString8(_,a,$,j){return toToken$2(_,a,2,readUint8(_,a+1,j),j)}function decodeString16(_,a,$,j){return toToken$2(_,a,3,readUint16(_,a+1,j),j)}function decodeString32(_,a,$,j){return toToken$2(_,a,5,readUint32(_,a+1,j),j)}function decodeString64(_,a,$,j){const _e=readUint64(_,a+1,j);if(typeof _e=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer string lengths not supported`);return toToken$2(_,a,9,_e,j)}const encodeString=encodeBytes;function toToken$1(_,a,$,j){return new Token(Type.array,j,$)}function decodeArrayCompact(_,a,$,j){return toToken$1(_,a,1,$)}function decodeArray8(_,a,$,j){return toToken$1(_,a,2,readUint8(_,a+1,j))}function decodeArray16(_,a,$,j){return toToken$1(_,a,3,readUint16(_,a+1,j))}function decodeArray32(_,a,$,j){return toToken$1(_,a,5,readUint32(_,a+1,j))}function decodeArray64(_,a,$,j){const _e=readUint64(_,a+1,j);if(typeof _e=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer array lengths not supported`);return toToken$1(_,a,9,_e)}function decodeArrayIndefinite(_,a,$,j){if(j.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken$1(_,a,1,1/0)}function encodeArray(_,a){encodeUintValue(_,Type.array.majorEncoded,a.value)}encodeArray.compareTokens=encodeUint.compareTokens;encodeArray.encodedSize=function _(a){return encodeUintValue.encodedSize(a.value)};function toToken(_,a,$,j){return new Token(Type.map,j,$)}function decodeMapCompact(_,a,$,j){return toToken(_,a,1,$)}function decodeMap8(_,a,$,j){return toToken(_,a,2,readUint8(_,a+1,j))}function decodeMap16(_,a,$,j){return toToken(_,a,3,readUint16(_,a+1,j))}function decodeMap32(_,a,$,j){return toToken(_,a,5,readUint32(_,a+1,j))}function decodeMap64(_,a,$,j){const _e=readUint64(_,a+1,j);if(typeof _e=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer map lengths not supported`);return toToken(_,a,9,_e)}function decodeMapIndefinite(_,a,$,j){if(j.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken(_,a,1,1/0)}function encodeMap(_,a){encodeUintValue(_,Type.map.majorEncoded,a.value)}encodeMap.compareTokens=encodeUint.compareTokens;encodeMap.encodedSize=function _(a){return encodeUintValue.encodedSize(a.value)};function decodeTagCompact(_,a,$,j){return new Token(Type.tag,$,1)}function decodeTag8(_,a,$,j){return new Token(Type.tag,readUint8(_,a+1,j),2)}function decodeTag16(_,a,$,j){return new Token(Type.tag,readUint16(_,a+1,j),3)}function decodeTag32(_,a,$,j){return new Token(Type.tag,readUint32(_,a+1,j),5)}function decodeTag64(_,a,$,j){return new Token(Type.tag,readUint64(_,a+1,j),9)}function encodeTag(_,a){encodeUintValue(_,Type.tag.majorEncoded,a.value)}encodeTag.compareTokens=encodeUint.compareTokens;encodeTag.encodedSize=function _(a){return encodeUintValue.encodedSize(a.value)};const MINOR_FALSE=20,MINOR_TRUE=21,MINOR_NULL=22,MINOR_UNDEFINED=23;function decodeUndefined(_,a,$,j){if(j.allowUndefined===!1)throw new Error(`${decodeErrPrefix} undefined values are not supported`);return j.coerceUndefinedToNull===!0?new Token(Type.null,null,1):new Token(Type.undefined,void 0,1)}function decodeBreak(_,a,$,j){if(j.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return new Token(Type.break,void 0,1)}function createToken(_,a,$){if($){if($.allowNaN===!1&&Number.isNaN(_))throw new Error(`${decodeErrPrefix} NaN values are not supported`);if($.allowInfinity===!1&&(_===1/0||_===-1/0))throw new Error(`${decodeErrPrefix} Infinity values are not supported`)}return new Token(Type.float,_,a)}function decodeFloat16(_,a,$,j){return createToken(readFloat16(_,a+1),3,j)}function decodeFloat32(_,a,$,j){return createToken(readFloat32(_,a+1),5,j)}function decodeFloat64(_,a,$,j){return createToken(readFloat64(_,a+1),9,j)}function encodeFloat(_,a,$){const j=a.value;if(j===!1)_.push([Type.float.majorEncoded|MINOR_FALSE]);else if(j===!0)_.push([Type.float.majorEncoded|MINOR_TRUE]);else if(j===null)_.push([Type.float.majorEncoded|MINOR_NULL]);else if(j===void 0)_.push([Type.float.majorEncoded|MINOR_UNDEFINED]);else{let _e,et=!1;(!$||$.float64!==!0)&&(encodeFloat16(j),_e=readFloat16(ui8a,1),j===_e||Number.isNaN(j)?(ui8a[0]=249,_.push(ui8a.slice(0,3)),et=!0):(encodeFloat32(j),_e=readFloat32(ui8a,1),j===_e&&(ui8a[0]=250,_.push(ui8a.slice(0,5)),et=!0))),et||(encodeFloat64(j),_e=readFloat64(ui8a,1),ui8a[0]=251,_.push(ui8a.slice(0,9)))}}encodeFloat.encodedSize=function _(a,$){const j=a.value;if(j===!1||j===!0||j===null||j===void 0)return 1;if(!$||$.float64!==!0){encodeFloat16(j);let _e=readFloat16(ui8a,1);if(j===_e||Number.isNaN(j))return 3;if(encodeFloat32(j),_e=readFloat32(ui8a,1),j===_e)return 5}return 9};const buffer$1=new ArrayBuffer(9),dataView=new DataView(buffer$1,1),ui8a=new Uint8Array(buffer$1,0);function encodeFloat16(_){if(_===1/0)dataView.setUint16(0,31744,!1);else if(_===-1/0)dataView.setUint16(0,64512,!1);else if(Number.isNaN(_))dataView.setUint16(0,32256,!1);else{dataView.setFloat32(0,_);const a=dataView.getUint32(0),$=(a&2139095040)>>23,j=a&8388607;if($===255)dataView.setUint16(0,31744,!1);else if($===0)dataView.setUint16(0,(_&2147483648)>>16|j>>13,!1);else{const _e=$-127;_e<-24?dataView.setUint16(0,0):_e<-14?dataView.setUint16(0,(a&2147483648)>>16|1<<24+_e,!1):dataView.setUint16(0,(a&2147483648)>>16|_e+15<<10|j>>13,!1)}}}function readFloat16(_,a){if(_.length-a<2)throw new Error(`${decodeErrPrefix} not enough data for float16`);const $=(_[a]<<8)+_[a+1];if($===31744)return 1/0;if($===64512)return-1/0;if($===32256)return NaN;const j=$>>10&31,_e=$&1023;let et;return j===0?et=_e*2**-24:j!==31?et=(_e+1024)*2**(j-25):et=_e===0?1/0:NaN,$&32768?-et:et}function encodeFloat32(_){dataView.setFloat32(0,_,!1)}function readFloat32(_,a){if(_.length-a<4)throw new Error(`${decodeErrPrefix} not enough data for float32`);const $=(_.byteOffset||0)+a;return new DataView(_.buffer,$,4).getFloat32(0,!1)}function encodeFloat64(_){dataView.setFloat64(0,_,!1)}function readFloat64(_,a){if(_.length-a<8)throw new Error(`${decodeErrPrefix} not enough data for float64`);const $=(_.byteOffset||0)+a;return new DataView(_.buffer,$,8).getFloat64(0,!1)}encodeFloat.compareTokens=encodeUint.compareTokens;function invalidMinor(_,a,$){throw new Error(`${decodeErrPrefix} encountered invalid minor (${$}) for major ${_[a]>>>5}`)}function errorer(_){return()=>{throw new Error(`${decodeErrPrefix} ${_}`)}}const jump=[];for(let _=0;_<=23;_++)jump[_]=invalidMinor;jump[24]=decodeUint8;jump[25]=decodeUint16;jump[26]=decodeUint32;jump[27]=decodeUint64;jump[28]=invalidMinor;jump[29]=invalidMinor;jump[30]=invalidMinor;jump[31]=invalidMinor;for(let _=32;_<=55;_++)jump[_]=invalidMinor;jump[56]=decodeNegint8;jump[57]=decodeNegint16;jump[58]=decodeNegint32;jump[59]=decodeNegint64;jump[60]=invalidMinor;jump[61]=invalidMinor;jump[62]=invalidMinor;jump[63]=invalidMinor;for(let _=64;_<=87;_++)jump[_]=decodeBytesCompact;jump[88]=decodeBytes8;jump[89]=decodeBytes16;jump[90]=decodeBytes32;jump[91]=decodeBytes64;jump[92]=invalidMinor;jump[93]=invalidMinor;jump[94]=invalidMinor;jump[95]=errorer("indefinite length bytes/strings are not supported");for(let _=96;_<=119;_++)jump[_]=decodeStringCompact;jump[120]=decodeString8;jump[121]=decodeString16;jump[122]=decodeString32;jump[123]=decodeString64;jump[124]=invalidMinor;jump[125]=invalidMinor;jump[126]=invalidMinor;jump[127]=errorer("indefinite length bytes/strings are not supported");for(let _=128;_<=151;_++)jump[_]=decodeArrayCompact;jump[152]=decodeArray8;jump[153]=decodeArray16;jump[154]=decodeArray32;jump[155]=decodeArray64;jump[156]=invalidMinor;jump[157]=invalidMinor;jump[158]=invalidMinor;jump[159]=decodeArrayIndefinite;for(let _=160;_<=183;_++)jump[_]=decodeMapCompact;jump[184]=decodeMap8;jump[185]=decodeMap16;jump[186]=decodeMap32;jump[187]=decodeMap64;jump[188]=invalidMinor;jump[189]=invalidMinor;jump[190]=invalidMinor;jump[191]=decodeMapIndefinite;for(let _=192;_<=215;_++)jump[_]=decodeTagCompact;jump[216]=decodeTag8;jump[217]=decodeTag16;jump[218]=decodeTag32;jump[219]=decodeTag64;jump[220]=invalidMinor;jump[221]=invalidMinor;jump[222]=invalidMinor;jump[223]=invalidMinor;for(let _=224;_<=243;_++)jump[_]=errorer("simple values are not supported");jump[244]=invalidMinor;jump[245]=invalidMinor;jump[246]=invalidMinor;jump[247]=decodeUndefined;jump[248]=errorer("simple values are not supported");jump[249]=decodeFloat16;jump[250]=decodeFloat32;jump[251]=decodeFloat64;jump[252]=invalidMinor;jump[253]=invalidMinor;jump[254]=invalidMinor;jump[255]=decodeBreak;const quick=[];for(let _=0;_<24;_++)quick[_]=new Token(Type.uint,_,1);for(let _=-1;_>=-24;_--)quick[31-_]=new Token(Type.negint,_,1);quick[64]=new Token(Type.bytes,new Uint8Array(0),1);quick[96]=new Token(Type.string,"",1);quick[128]=new Token(Type.array,0,1);quick[160]=new Token(Type.map,0,1);quick[244]=new Token(Type.false,!1,1);quick[245]=new Token(Type.true,!0,1);quick[246]=new Token(Type.null,null,1);function quickEncodeToken(_){switch(_.type){case Type.false:return fromArray([244]);case Type.true:return fromArray([245]);case Type.null:return fromArray([246]);case Type.bytes:return _.value.length?void 0:fromArray([64]);case Type.string:return _.value===""?fromArray([96]):void 0;case Type.array:return _.value===0?fromArray([128]):void 0;case Type.map:return _.value===0?fromArray([160]):void 0;case Type.uint:return _.value<24?fromArray([Number(_.value)]):void 0;case Type.negint:if(_.value>=-24)return fromArray([31-Number(_.value)])}}const defaultEncodeOptions$1={float64:!1,mapSorter:mapSorter$1,quickEncodeToken};function makeCborEncoders(){const _=[];return _[Type.uint.major]=encodeUint,_[Type.negint.major]=encodeNegint,_[Type.bytes.major]=encodeBytes,_[Type.string.major]=encodeString,_[Type.array.major]=encodeArray,_[Type.map.major]=encodeMap,_[Type.tag.major]=encodeTag,_[Type.float.major]=encodeFloat,_}const cborEncoders=makeCborEncoders(),buf=new Bl;class Ref{constructor(a,$){this.obj=a,this.parent=$}includes(a){let $=this;do if($.obj===a)return!0;while($=$.parent);return!1}static createCheck(a,$){if(a&&a.includes($))throw new Error(`${encodeErrPrefix} object contains circular references`);return new Ref($,a)}}const simpleTokens={null:new Token(Type.null,null),undefined:new Token(Type.undefined,void 0),true:new Token(Type.true,!0),false:new Token(Type.false,!1),emptyArray:new Token(Type.array,0),emptyMap:new Token(Type.map,0)},typeEncoders={number(_,a,$,j){return!Number.isInteger(_)||!Number.isSafeInteger(_)?new Token(Type.float,_):_>=0?new Token(Type.uint,_):new Token(Type.negint,_)},bigint(_,a,$,j){return _>=BigInt(0)?new Token(Type.uint,_):new Token(Type.negint,_)},Uint8Array(_,a,$,j){return new Token(Type.bytes,_)},string(_,a,$,j){return new Token(Type.string,_)},boolean(_,a,$,j){return _?simpleTokens.true:simpleTokens.false},null(_,a,$,j){return simpleTokens.null},undefined(_,a,$,j){return simpleTokens.undefined},ArrayBuffer(_,a,$,j){return new Token(Type.bytes,new Uint8Array(_))},DataView(_,a,$,j){return new Token(Type.bytes,new Uint8Array(_.buffer,_.byteOffset,_.byteLength))},Array(_,a,$,j){if(!_.length)return $.addBreakTokens===!0?[simpleTokens.emptyArray,new Token(Type.break)]:simpleTokens.emptyArray;j=Ref.createCheck(j,_);const _e=[];let et=0;for(const tt of _)_e[et++]=objectToTokens(tt,$,j);return $.addBreakTokens?[new Token(Type.array,_.length),_e,new Token(Type.break)]:[new Token(Type.array,_.length),_e]},Object(_,a,$,j){const _e=a!=="Object",et=_e?_.keys():Object.keys(_),tt=_e?_.size:et.length;if(!tt)return $.addBreakTokens===!0?[simpleTokens.emptyMap,new Token(Type.break)]:simpleTokens.emptyMap;j=Ref.createCheck(j,_);const rt=[];let nt=0;for(const it of et)rt[nt++]=[objectToTokens(it,$,j),objectToTokens(_e?_.get(it):_[it],$,j)];return sortMapEntries(rt,$),$.addBreakTokens?[new Token(Type.map,tt),rt,new Token(Type.break)]:[new Token(Type.map,tt),rt]}};typeEncoders.Map=typeEncoders.Object;typeEncoders.Buffer=typeEncoders.Uint8Array;for(const _ of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))typeEncoders[`${_}Array`]=typeEncoders.DataView;function objectToTokens(_,a={},$){const j=is(_),_e=a&&a.typeEncoders&&a.typeEncoders[j]||typeEncoders[j];if(typeof _e=="function"){const tt=_e(_,j,a,$);if(tt!=null)return tt}const et=typeEncoders[j];if(!et)throw new Error(`${encodeErrPrefix} unsupported type: ${j}`);return et(_,j,a,$)}function sortMapEntries(_,a){a.mapSorter&&_.sort(a.mapSorter)}function mapSorter$1(_,a){const $=Array.isArray(_[0])?_[0][0]:_[0],j=Array.isArray(a[0])?a[0][0]:a[0];if($.type!==j.type)return $.type.compare(j.type);const _e=$.type.major,et=cborEncoders[_e].compareTokens($,j);return et===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),et}function tokensToEncoded(_,a,$,j){if(Array.isArray(a))for(const _e of a)tokensToEncoded(_,_e,$,j);else $[a.type.major](_,a,j)}function encodeCustom(_,a,$){const j=objectToTokens(_,$);if(!Array.isArray(j)&&$.quickEncodeToken){const _e=$.quickEncodeToken(j);if(_e)return _e;const et=a[j.type.major];if(et.encodedSize){const tt=et.encodedSize(j,$),rt=new Bl(tt);if(et(rt,j,$),rt.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${j} was wrong`);return asU8A(rt.chunks[0])}}return buf.reset(),tokensToEncoded(buf,j,a,$),buf.toBytes(!0)}function encode$r(_,a){return a=Object.assign({},defaultEncodeOptions$1,a),encodeCustom(_,cborEncoders,a)}const defaultDecodeOptions={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Tokeniser{constructor(a,$={}){this.pos=0,this.data=a,this.options=$}done(){return this.pos>=this.data.length}next(){const a=this.data[this.pos];let $=quick[a];if($===void 0){const j=jump[a];if(!j)throw new Error(`${decodeErrPrefix} no decoder for major type ${a>>>5} (byte 0x${a.toString(16).padStart(2,"0")})`);const _e=a&31;$=j(this.data,this.pos,_e,this.options)}return this.pos+=$.encodedLength,$}}const DONE$1=Symbol.for("DONE"),BREAK=Symbol.for("BREAK");function tokenToArray(_,a,$){const j=[];for(let _e=0;_e<_.value;_e++){const et=tokensToObject(a,$);if(et===BREAK){if(_.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed array`)}if(et===DONE$1)throw new Error(`${decodeErrPrefix} found array but not enough entries (got ${_e}, expected ${_.value})`);j[_e]=et}return j}function tokenToMap(_,a,$){const j=$.useMaps===!0,_e=j?void 0:{},et=j?new Map:void 0;for(let tt=0;tt<_.value;tt++){const rt=tokensToObject(a,$);if(rt===BREAK){if(_.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed map`)}if(rt===DONE$1)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${tt} [no key], expected ${_.value})`);if(j!==!0&&typeof rt!="string")throw new Error(`${decodeErrPrefix} non-string keys not supported (got ${typeof rt})`);const nt=tokensToObject(a,$);if(nt===DONE$1)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${tt} [no value], expected ${_.value})`);j?et.set(rt,nt):_e[rt]=nt}return j?et:_e}function tokensToObject(_,a){if(_.done())return DONE$1;const $=_.next();if($.type===Type.break)return BREAK;if($.type.terminal)return $.value;if($.type===Type.array)return tokenToArray($,_,a);if($.type===Type.map)return tokenToMap($,_,a);if($.type===Type.tag){if(a.tags&&typeof a.tags[$.value]=="function"){const j=tokensToObject(_,a);return a.tags[$.value](j)}throw new Error(`${decodeErrPrefix} tag not supported (${$.value})`)}throw new Error("unsupported")}function decode$l(_,a){if(!(_ instanceof Uint8Array))throw new Error(`${decodeErrPrefix} data to decode must be a Uint8Array`);a=Object.assign({},defaultDecodeOptions,a);const $=a.tokenizer||new Tokeniser(_,a),j=tokensToObject($,a);if(j===DONE$1)throw new Error(`${decodeErrPrefix} did not find any content to decode`);if(j===BREAK)throw new Error(`${decodeErrPrefix} got unexpected break`);if(!$.done())throw new Error(`${decodeErrPrefix} too many terminals, data makes no sense`);return j}const CID_CBOR_TAG=42;function cidEncoder$1(_){if(_.asCID!==_&&_["/"]!==_.bytes)return null;const a=CID.asCID(_);if(!a)return null;const $=new Uint8Array(a.bytes.byteLength+1);return $.set(a.bytes,1),[new Token(Type.tag,CID_CBOR_TAG),new Token(Type.bytes,$)]}function undefinedEncoder$1(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder$1(_){if(Number.isNaN(_))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(_===1/0||_===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions$1={float64:!0,typeEncoders:{Object:cidEncoder$1,undefined:undefinedEncoder$1,number:numberEncoder$1}};function cidDecoder(_){if(_[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return CID.decode(_.subarray(1))}const decodeOptions$1={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};decodeOptions$1.tags[CID_CBOR_TAG]=cidDecoder;const name$8="dag-cbor",code$8=113,encode$q=_=>encode$r(_,encodeOptions$1),decode$k=_=>decode$l(_,decodeOptions$1),dagCBOR=Object.freeze(Object.defineProperty({__proto__:null,name:name$8,code:code$8,encode:encode$q,decode:decode$k},Symbol.toStringTag,{value:"Module"})),from$5=({name:_,code:a,encode:$})=>new Hasher$2(_,a,$);class Hasher$2{constructor(a,$,j){this.name=a,this.code=$,this.encode=j}digest(a){if(a instanceof Uint8Array){const $=this.encode(a);return $ instanceof Uint8Array?create$a(this.code,$):$.then(j=>create$a(this.code,j))}else throw Error("Unknown type, must be binary type")}}class JSONEncoder extends Array{constructor(){super(),this.inRecursive=[]}prefix(a){const $=this.inRecursive[this.inRecursive.length-1];$&&($.type===Type.array&&($.elements++,$.elements!==1&&a.push([44])),$.type===Type.map&&($.elements++,$.elements!==1&&($.elements%2===1?a.push([44]):a.push([58]))))}[Type.uint.major](a,$){this.prefix(a);const j=String($.value),_e=[];for(let et=0;et<j.length;et++)_e[et]=j.charCodeAt(et);a.push(_e)}[Type.negint.major](a,$){this[Type.uint.major](a,$)}[Type.bytes.major](a,$){throw new Error(`${encodeErrPrefix} unsupported type: Uint8Array`)}[Type.string.major](a,$){this.prefix(a);const j=fromString$6(JSON.stringify($.value));a.push(j.length>32?asU8A(j):j)}[Type.array.major](a,$){this.prefix(a),this.inRecursive.push({type:Type.array,elements:0}),a.push([91])}[Type.map.major](a,$){this.prefix(a),this.inRecursive.push({type:Type.map,elements:0}),a.push([123])}[Type.tag.major](a,$){}[Type.float.major](a,$){if($.type.name==="break"){const tt=this.inRecursive.pop();if(tt){if(tt.type===Type.array)a.push([93]);else if(tt.type===Type.map)a.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if($.value===void 0)throw new Error(`${encodeErrPrefix} unsupported type: undefined`);if(this.prefix(a),$.type.name==="true"){a.push([116,114,117,101]);return}else if($.type.name==="false"){a.push([102,97,108,115,101]);return}else if($.type.name==="null"){a.push([110,117,108,108]);return}const j=String($.value),_e=[];let et=!1;for(let tt=0;tt<j.length;tt++)_e[tt]=j.charCodeAt(tt),!et&&(_e[tt]===46||_e[tt]===101||_e[tt]===69)&&(et=!0);et||(_e.push(46),_e.push(48)),a.push(_e)}}function mapSorter(_,a){if(Array.isArray(_[0])||Array.isArray(a[0]))throw new Error(`${encodeErrPrefix} complex map keys are not supported`);const $=_[0],j=a[0];if($.type!==Type.string||j.type!==Type.string)throw new Error(`${encodeErrPrefix} non-string map keys are not supported`);if($<j)return-1;if($>j)return 1;throw new Error(`${encodeErrPrefix} unexpected duplicate map keys, this is not supported`)}const defaultEncodeOptions={addBreakTokens:!0,mapSorter};function encode$p(_,a){return a=Object.assign({},defaultEncodeOptions,a),encodeCustom(_,new JSONEncoder,a)}class Tokenizer{constructor(a,$={}){this.pos=0,this.data=a,this.options=$,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let a=this.ch();for(;a===32||a===9||a===13||a===10;)a=this.data[++this.pos]}expect(a){if(this.data.length-this.pos<a.length)throw new Error(`${decodeErrPrefix} unexpected end of input at position ${this.pos}`);for(let $=0;$<a.length;$++)if(this.data[this.pos++]!==a[$])throw new Error(`${decodeErrPrefix} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...a)}'`)}parseNumber(){const a=this.pos;let $=!1,j=!1;const _e=rt=>{for(;!this.done();){const nt=this.ch();if(rt.includes(nt))this.pos++;else break}};if(this.ch()===45&&($=!0,this.pos++),this.ch()===48)if(this.pos++,this.ch()===46)this.pos++,j=!0;else return new Token(Type.uint,0,this.pos-a);if(_e([48,49,50,51,52,53,54,55,56,57]),$&&this.pos===a+1)throw new Error(`${decodeErrPrefix} unexpected token at position ${this.pos}`);if(!this.done()&&this.ch()===46){if(j)throw new Error(`${decodeErrPrefix} unexpected token at position ${this.pos}`);j=!0,this.pos++,_e([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(j=!0,this.pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this.pos++,_e([48,49,50,51,52,53,54,55,56,57]));const et=String.fromCharCode.apply(null,this.data.subarray(a,this.pos)),tt=parseFloat(et);return j?new Token(Type.float,tt,this.pos-a):this.options.allowBigInt!==!0||Number.isSafeInteger(tt)?new Token(tt>=0?Type.uint:Type.negint,tt,this.pos-a):new Token(tt>=0?Type.uint:Type.negint,BigInt(et),this.pos-a)}parseString(){if(this.ch()!==34)throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let et=this.pos,tt=0;et<this.data.length&&tt<65536;et++,tt++){const rt=this.data[et];if(rt===92||rt<32||rt>=128)break;if(rt===34){const nt=String.fromCharCode.apply(null,this.data.subarray(this.pos,et));return this.pos=et+1,new Token(Type.string,nt,tt)}}const a=this.pos,$=[],j=()=>{if(this.pos+4>=this.data.length)throw new Error(`${decodeErrPrefix} unexpected end of unicode escape sequence at position ${this.pos}`);let et=0;for(let tt=0;tt<4;tt++){let rt=this.ch();if(rt>=48&&rt<=57)rt-=48;else if(rt>=97&&rt<=102)rt=rt-97+10;else if(rt>=65&&rt<=70)rt=rt-65+10;else throw new Error(`${decodeErrPrefix} unexpected unicode escape character at position ${this.pos}`);et=et*16+rt,this.pos++}return et},_e=()=>{const et=this.ch();let tt=null,rt=et>239?4:et>223?3:et>191?2:1;if(this.pos+rt>this.data.length)throw new Error(`${decodeErrPrefix} unexpected unicode sequence at position ${this.pos}`);let nt,it,st,ot;switch(rt){case 1:et<128&&(tt=et);break;case 2:nt=this.data[this.pos+1],(nt&192)===128&&(ot=(et&31)<<6|nt&63,ot>127&&(tt=ot));break;case 3:nt=this.data[this.pos+1],it=this.data[this.pos+2],(nt&192)===128&&(it&192)===128&&(ot=(et&15)<<12|(nt&63)<<6|it&63,ot>2047&&(ot<55296||ot>57343)&&(tt=ot));break;case 4:nt=this.data[this.pos+1],it=this.data[this.pos+2],st=this.data[this.pos+3],(nt&192)===128&&(it&192)===128&&(st&192)===128&&(ot=(et&15)<<18|(nt&63)<<12|(it&63)<<6|st&63,ot>65535&&ot<1114112&&(tt=ot))}tt===null?(tt=65533,rt=1):tt>65535&&(tt-=65536,$.push(tt>>>10&1023|55296),tt=56320|tt&1023),$.push(tt),this.pos+=rt};for(;!this.done();){const et=this.ch();let tt;switch(et){case 92:if(this.pos++,this.done())throw new Error(`${decodeErrPrefix} unexpected string termination at position ${this.pos}`);switch(tt=this.ch(),this.pos++,tt){case 34:case 39:case 92:case 47:$.push(tt);break;case 98:$.push(8);break;case 116:$.push(9);break;case 110:$.push(10);break;case 102:$.push(12);break;case 114:$.push(13);break;case 117:$.push(j());break;default:throw new Error(`${decodeErrPrefix} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new Token(Type.string,decodeCodePointsArray($),this.pos-a);default:if(et<32)throw new Error(`${decodeErrPrefix} invalid control character at position ${this.pos}`);et<128?($.push(et),this.pos++):_e()}}throw new Error(`${decodeErrPrefix} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new Token(Type.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new Token(Type.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Token(Type.null,null,4);case 102:return this.expect([102,97,108,115,101]),new Token(Type.false,!1,5);case 116:return this.expect([116,114,117,101]),new Token(Type.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this.pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(this.ch()!==44)throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this.pos++,this.skipWhitespace(),new Token(Type.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(this.ch()!==44)throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this.pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);const a=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),a}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${decodeErrPrefix} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}}function decode$j(_,a){return a=Object.assign({tokenizer:new Tokenizer(_,a)},a),decode$l(_,a)}function cidEncoder(_){if(_.asCID!==_&&_["/"]!==_.bytes)return null;const a=CID.asCID(_);if(!a)return null;const $=a.toString();return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.string,$,$.length),new Token(Type.break,void 0,1)]}function bytesEncoder(_){const a=base64$6.encode(_).slice(1);return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.map,1/0,1),new Token(Type.string,"bytes",5),new Token(Type.string,a,a.length),new Token(Type.break,void 0,1),new Token(Type.break,void 0,1)]}function undefinedEncoder(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder(_){if(Number.isNaN(_))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(_===1/0||_===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions={typeEncoders:{Object:cidEncoder,Uint8Array:bytesEncoder,Buffer:bytesEncoder,undefined:undefinedEncoder,number:numberEncoder}};class DagJsonTokenizer extends Tokenizer{constructor(a,$){super(a,$),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const a=this._next();if(a.type===Type.map){const $=this._next();if($.type===Type.string&&$.value==="/"){const j=this._next();if(j.type===Type.string){if(this._next().type!==Type.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(j),new Token(Type.tag,42,0)}if(j.type===Type.map){const _e=this._next();if(_e.type===Type.string&&_e.value==="bytes"){const et=this._next();if(et.type===Type.string){for(let rt=0;rt<2;rt++)if(this._next().type!==Type.break)throw new Error("Invalid encoded Bytes form");const tt=base64$6.decode(`m${et.value}`);return new Token(Type.bytes,tt,et.value.length)}this.tokenBuffer.push(et)}this.tokenBuffer.push(_e)}this.tokenBuffer.push(j)}this.tokenBuffer.push($)}return a}}const decodeOptions={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};decodeOptions.tags[42]=CID.parse;const name$7="dag-json",code$7=297,encode$o=_=>encode$p(_,encodeOptions),decode$i=_=>{const a=Object.assign(decodeOptions,{tokenizer:new DagJsonTokenizer(_,decodeOptions)});return decode$j(_,a)},dagJSON=Object.freeze(Object.defineProperty({__proto__:null,name:name$7,code:code$7,encode:encode$o,decode:decode$i},Symbol.toStringTag,{value:"Module"}));function toBase64url(_){return base64url$2.encode(_).slice(1)}function fromBase64url(_){return base64url$2.decode(`u${_}`)}function fromSplit$1(_){const[a,$,j]=_;return{payload:$,signatures:[{protected:a,signature:j}],link:CID.decode(fromBase64url($))}}function encodeSignature(_){const a={signature:fromBase64url(_.signature)};return _.header&&(a.header=_.header),_.protected&&(a.protected=fromBase64url(_.protected)),a}function encode$n(_){const a=fromBase64url(_.payload);try{CID.decode(a)}catch{throw new Error("Not a valid DagJWS")}return{payload:a,signatures:_.signatures.map(encodeSignature)}}function decodeSignature(_){const a={signature:toBase64url(_.signature)};return _.header&&(a.header=_.header),_.protected&&(a.protected=toBase64url(_.protected)),a}function decode$h(_){const a={payload:toBase64url(_.payload),signatures:_.signatures.map(decodeSignature)};return a.link=CID.decode(new Uint8Array(_.payload)),a}function fromSplit(_){const[a,$,j,_e,et]=_,tt={ciphertext:_e,iv:j,protected:a,tag:et};return $&&(tt.recipients=[{encrypted_key:$}]),tt}function encodeRecipient(_){const a={};return _.encrypted_key&&(a.encrypted_key=fromBase64url(_.encrypted_key)),_.header&&(a.header=_.header),a}function encode$m(_){const a={ciphertext:fromBase64url(_.ciphertext),protected:fromBase64url(_.protected),iv:fromBase64url(_.iv),tag:fromBase64url(_.tag)};return _.aad&&(a.aad=fromBase64url(_.aad)),_.recipients&&(a.recipients=_.recipients.map(encodeRecipient)),_.unprotected&&(a.unprotected=_.unprotected),a}function decodeRecipient(_){const a={};return _.encrypted_key&&(a.encrypted_key=toBase64url(_.encrypted_key)),_.header&&(a.header=_.header),a}function decode$g(_){const a={ciphertext:toBase64url(_.ciphertext),protected:toBase64url(_.protected),iv:toBase64url(_.iv),tag:toBase64url(_.tag)};return _.aad&&(a.aad=toBase64url(_.aad)),_.recipients&&(a.recipients=_.recipients.map(decodeRecipient)),_.unprotected&&(a.unprotected=_.unprotected),a}const name$6="dag-jose",code$6=133;function isDagJWS(_){return"payload"in _&&typeof _.payload=="string"&&"signatures"in _&&Array.isArray(_.signatures)}function isEncodedJWS(_){return"payload"in _&&_.payload instanceof Uint8Array&&"signatures"in _&&Array.isArray(_.signatures)}function isEncodedJWE(_){return"ciphertext"in _&&_.ciphertext instanceof Uint8Array&&"iv"in _&&_.iv instanceof Uint8Array&&"protected"in _&&_.protected instanceof Uint8Array&&"tag"in _&&_.tag instanceof Uint8Array}function isDagJWE(_){return"ciphertext"in _&&typeof _.ciphertext=="string"&&"iv"in _&&typeof _.iv=="string"&&"protected"in _&&typeof _.protected=="string"&&"tag"in _&&typeof _.tag=="string"}function toGeneral(_){if(typeof _=="string"){const a=_.split(".");if(a.length===3)return fromSplit$1(a);if(a.length===5)return fromSplit(a);throw new Error("Not a valid JOSE string")}if(isDagJWS(_)||isDagJWE(_))return _;throw new Error("Not a valid unencoded JOSE object")}function encode$l(_){typeof _=="string"&&(_=toGeneral(_));let a;if(isDagJWS(_))a=encode$n(_);else if(isDagJWE(_))a=encode$m(_);else throw new Error("Not a valid JOSE object");return new Uint8Array(encode$q(a))}function decode$f(_){let a;try{a=decode$k(_)}catch{throw new Error("Not a valid DAG-JOSE object")}if(isEncodedJWS(a))return decode$h(a);if(isEncodedJWE(a))return decode$g(a);throw new Error("Not a valid DAG-JOSE object")}const dagJOSE=Object.freeze(Object.defineProperty({__proto__:null,name:name$6,code:code$6,toGeneral,encode:encode$l,decode:decode$f},Symbol.toStringTag,{value:"Module"})),code$5=0,name$5="identity",encode$k=coerce$2,digest$2=_=>create$a(code$5,encode$k(_)),identity$8={code:code$5,name:name$5,encode:encode$k,digest:digest$2},identity$9=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$8},Symbol.toStringTag,{value:"Module"})),identity$7=from$6({prefix:"\0",name:"identity",encode:_=>toString$9(_),decode:_=>fromString$7(_)}),identityBase$2=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$7},Symbol.toStringTag,{value:"Module"})),base2$4=rfc4648$2({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$5=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$4},Symbol.toStringTag,{value:"Module"})),base8$4=rfc4648$2({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$5=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$4},Symbol.toStringTag,{value:"Module"})),base10$4=baseX$2({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$5=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$4},Symbol.toStringTag,{value:"Module"})),base16$4=rfc4648$2({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$2=rfc4648$2({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$5=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$4,base16upper:base16upper$2},Symbol.toStringTag,{value:"Module"})),base36$4=baseX$2({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$2=baseX$2({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$5=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$4,base36upper:base36upper$2},Symbol.toStringTag,{value:"Module"})),alphabet$3=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),alphabetBytesToChars$2=alphabet$3.reduce((_,a,$)=>(_[$]=a,_),[]),alphabetCharsToBytes$2=alphabet$3.reduce((_,a,$)=>(_[a.codePointAt(0)]=$,_),[]);function encode$j(_){return _.reduce((a,$)=>(a+=alphabetBytesToChars$2[$],a),"")}function decode$e(_){const a=[];for(const $ of _){const j=alphabetCharsToBytes$2[$.codePointAt(0)];if(j===void 0)throw new Error(`Non-base256emoji character: ${$}`);a.push(j)}return new Uint8Array(a)}const base256emoji$4=from$6({prefix:"\u{1F680}",name:"base256emoji",encode:encode$j,decode:decode$e}),base256emoji$5=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$4},Symbol.toStringTag,{value:"Module"})),sha$2=_=>async a=>new Uint8Array(await crypto.subtle.digest(_,a)),sha256$4=from$5({name:"sha2-256",code:18,encode:sha$2("SHA-256")}),sha512$3=from$5({name:"sha2-512",code:19,encode:sha$2("SHA-512")}),sha2$2=Object.freeze(Object.defineProperty({__proto__:null,sha256:sha256$4,sha512:sha512$3},Symbol.toStringTag,{value:"Module"})),name$4="raw",code$4=85,encode$i=_=>coerce$2(_),decode$d=_=>coerce$2(_),raw=Object.freeze(Object.defineProperty({__proto__:null,name:name$4,code:code$4,encode:encode$i,decode:decode$d},Symbol.toStringTag,{value:"Module"})),textEncoder$2=new TextEncoder,textDecoder$1=new TextDecoder,name$3="json",code$3=512,encode$h=_=>textEncoder$2.encode(JSON.stringify(_)),decode$c=_=>JSON.parse(textDecoder$1.decode(_)),json=Object.freeze(Object.defineProperty({__proto__:null,name:name$3,code:code$3,encode:encode$h,decode:decode$c},Symbol.toStringTag,{value:"Module"})),bases$2={...identityBase$2,...base2$5,...base8$5,...base10$5,...base16$5,...base32$5,...base36$5,...base58$2,...base64$7,...base256emoji$5},hashes={...sha2$2,...identity$9},codecs={raw,json};function initAssets(){}class NotInitializedError extends Error{constructor(a="not initialized"){super(a),this.name="NotInitializedError",this.code=NotInitializedError.code}}NotInitializedError.code="ERR_NOT_INITIALIZED";class AlreadyInitializingError extends Error{constructor(a="cannot initialize an initializing node"){super(a),this.name="AlreadyInitializingError",this.code=AlreadyInitializedError.code}}AlreadyInitializingError.code="ERR_ALREADY_INITIALIZING";class AlreadyInitializedError extends Error{constructor(a="cannot re-initialize an initialized node"){super(a),this.name="AlreadyInitializedError",this.code=AlreadyInitializedError.code}}AlreadyInitializedError.code="ERR_ALREADY_INITIALIZED";class NotStartedError extends Error{constructor(a="not started"){super(a),this.name="NotStartedError",this.code=NotStartedError.code}}NotStartedError.code="ERR_NOT_STARTED";class AlreadyStartingError extends Error{constructor(a="cannot start, already startin"){super(a),this.name="AlreadyStartingError",this.code=AlreadyStartingError.code}}AlreadyStartingError.code="ERR_ALREADY_STARTING";class AlreadyStartedError extends Error{constructor(a="cannot start, already started"){super(a),this.name="AlreadyStartedError",this.code=AlreadyStartedError.code}}AlreadyStartedError.code="ERR_ALREADY_STARTED";class NotEnabledError extends Error{constructor(a="not enabled"){super(a),this.name="NotEnabledError",this.code=NotEnabledError.code}}NotEnabledError.code="ERR_NOT_ENABLED";function asUint8Array$2(_){return globalThis.Buffer!=null?new Uint8Array(_.buffer,_.byteOffset,_.byteLength):_}function alloc(_=0){return globalThis.Buffer?.alloc!=null?asUint8Array$2(globalThis.Buffer.alloc(_)):new Uint8Array(_)}function allocUnsafe$5(_=0){return globalThis.Buffer?.allocUnsafe!=null?asUint8Array$2(globalThis.Buffer.allocUnsafe(_)):new Uint8Array(_)}function createCodec$3(_,a,$,j){return{name:_,prefix:a,encoder:{name:_,prefix:a,encode:$},decoder:{decode:j}}}const string$2=createCodec$3("utf8","u",_=>"u"+new TextDecoder("utf8").decode(_),_=>new TextEncoder().encode(_.substring(1))),ascii$2=createCodec$3("ascii","a",_=>{let a="a";for(let $=0;$<_.length;$++)a+=String.fromCharCode(_[$]);return a},_=>{_=_.substring(1);const a=allocUnsafe$5(_.length);for(let $=0;$<_.length;$++)a[$]=_.charCodeAt($);return a}),BASES$2={utf8:string$2,"utf-8":string$2,hex:bases$2.base16,latin1:ascii$2,ascii:ascii$2,binary:ascii$2,...bases$2};function fromString$5(_,a="utf8"){const $=BASES$2[a];if($==null)throw new Error(`Unsupported encoding "${a}"`);return(a==="utf8"||a==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array$2(globalThis.Buffer.from(_,"utf-8")):$.decoder.decode(`${$.prefix}${_}`)}var timeBrowser=function _(){return Date.now()};const getTime=timeBrowser;class Retimer{constructor(a,$,j){const _e=this;this._started=getTime(),this._rescheduled=0,this._scheduled=$,this._args=j,this._triggered=!1,this._timerWrapper=()=>{_e._rescheduled>0?(_e._scheduled=_e._rescheduled-(getTime()-_e._started),_e._schedule(_e._scheduled)):(_e._triggered=!0,a.apply(null,_e._args))},this._timer=setTimeout(this._timerWrapper,$)}reschedule(a){a||(a=this._scheduled);const $=getTime();$+a-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(a)):this._triggered?this._schedule(a):(this._started=$,this._rescheduled=a)}_schedule(a){this._triggered=!1,this._started=getTime(),this._rescheduled=0,this._scheduled=a,this._timer=setTimeout(this._timerWrapper,a)}clear(){clearTimeout(this._timer)}}function retimer$1(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let _;if(arguments.length>0){_=new Array(arguments.length-2);for(var a=0;a<_.length;a++)_[a]=arguments[a+2]}return new Retimer(arguments[0],arguments[1],_)}var retimer_1=retimer$1;const{AbortController:AbortController$1}=globalThis,retimer=retimer_1;class TimeoutController extends AbortController$1{constructor(a){super(),this._ms=a,this._timer=retimer(()=>this.abort(),a),Object.setPrototypeOf(this,TimeoutController.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=retimer(()=>this.abort(),this._ms)}}var timeoutAbortController={TimeoutController};const word$1="[a-fA-F\\d:]",boundry=_=>_&&_.includeBoundaries?`(?:(?<=\\s|^)(?=${word$1})|(?<=${word$1})(?=\\s|$))`:"",v4$1="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",v6segment="[a-fA-F\\d]{1,4}",v6$1=`
(?:
(?:${v6segment}:){7}(?:${v6segment}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${v6segment}:){6}(?:${v4$1}|:${v6segment}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${v6segment}:){5}(?::${v4$1}|(?::${v6segment}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${v6segment}:){4}(?:(?::${v6segment}){0,1}:${v4$1}|(?::${v6segment}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${v6segment}:){3}(?:(?::${v6segment}){0,2}:${v4$1}|(?::${v6segment}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${v6segment}:){2}(?:(?::${v6segment}){0,3}:${v4$1}|(?::${v6segment}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${v6segment}:){1}(?:(?::${v6segment}){0,4}:${v4$1}|(?::${v6segment}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${v6segment}){0,5}:${v4$1}|(?::${v6segment}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),v46Exact$1=new RegExp(`(?:^${v4$1}$)|(?:^${v6$1}$)`),v4exact$1=new RegExp(`^${v4$1}$`),v6exact$1=new RegExp(`^${v6$1}$`),ipRegex$2=_=>_&&_.exact?v46Exact$1:new RegExp(`(?:${boundry(_)}${v4$1}${boundry(_)})|(?:${boundry(_)}${v6$1}${boundry(_)})`,"g");ipRegex$2.v4=_=>_&&_.exact?v4exact$1:new RegExp(`${boundry(_)}${v4$1}${boundry(_)}`,"g");ipRegex$2.v6=_=>_&&_.exact?v6exact$1:new RegExp(`${boundry(_)}${v6$1}${boundry(_)}`,"g");function functionTimeout(_){const a=(...$)=>_(...$);return Object.defineProperty(a,"name",{value:`functionTimeout(${_.name||"<anonymous>"})`,configurable:!0}),a}const{toString:toString$7}=Object.prototype;function isRegexp(_){return toString$7.call(_)==="[object RegExp]"}const flagMap={ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function clonedRegexp(_,a={}){if(!isRegexp(_))throw new TypeError("Expected a RegExp instance");const $=Object.keys(flagMap).map(_e=>(typeof a[_e]=="boolean"?a[_e]:_[_e])?flagMap[_e]:"").join(""),j=new RegExp(a.source||_.source,$);return j.lastIndex=typeof a.lastIndex=="number"?a.lastIndex:_.lastIndex,j}function isMatch(_,a,{timeout:$}={}){try{return functionTimeout(()=>clonedRegexp(_).test(a),{timeout:$})()}catch(j){throw j}}const maxIPv4Length=15,maxIPv6Length=45,options={timeout:400};function isIP(_){return isMatch(ipRegex$2({exact:!0}),_.slice(0,maxIPv6Length),options)}function isIPv6(_){return isMatch(ipRegex$2.v6({exact:!0}),_.slice(0,maxIPv6Length),options)}function isIPv4(_){return isMatch(ipRegex$2.v4({exact:!0}),_.slice(0,maxIPv4Length),options)}function toString$6(_,a="utf8"){const $=BASES$2[a];if($==null)throw new Error(`Unsupported encoding "${a}"`);return(a==="utf8"||a==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(_.buffer,_.byteOffset,_.byteLength).toString("utf8"):$.encoder.encode(_).substring(1)}const isV4=isIPv4,isV6=isIPv6,toBytes$1=function(_){let a=0;if(_=_.toString().trim(),isV4(_)){const $=new Uint8Array(a+4);return _.split(/\./g).forEach(j=>{$[a++]=parseInt(j,10)&255}),$}if(isV6(_)){const $=_.split(":",8);let j;for(j=0;j<$.length;j++){const et=isV4($[j]);let tt;et&&(tt=toBytes$1($[j]),$[j]=toString$6(tt.slice(0,2),"base16")),tt!=null&&++j<8&&$.splice(j,0,toString$6(tt.slice(2,4),"base16"))}if($[0]==="")for(;$.length<8;)$.unshift("0");else if($[$.length-1]==="")for(;$.length<8;)$.push("0");else if($.length<8){for(j=0;j<$.length&&$[j]!=="";j++);const et=[j,1];for(j=9-$.length;j>0;j--)et.push("0");$.splice.apply($,et)}const _e=new Uint8Array(a+16);for(j=0;j<$.length;j++){const et=parseInt($[j],16);_e[a++]=et>>8&255,_e[a++]=et&255}return _e}throw new Error("invalid ip address")},toString$5=function(_,a=0,$){a=~~a,$=$??_.length-a;const j=new DataView(_.buffer);if($===4){const _e=[];for(let et=0;et<$;et++)_e.push(_[a+et]);return _e.join(".")}if($===16){const _e=[];for(let et=0;et<$;et+=2)_e.push(j.getUint16(a+et).toString(16));return _e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},V=-1,names={},codes$3={},table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,V,"ip6zone"],[53,V,"dns",!0],[54,V,"dns4",!0],[55,V,"dns6",!0],[56,V,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,V,"unix",!1,!0],[421,V,"ipfs"],[421,V,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,V,"garlic64"],[460,0,"quic"],[465,0,"webtransport"],[466,V,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,V,"memory"]];table.forEach(_=>{const a=createProtocol(..._);codes$3[a.code]=a,names[a.name]=a});function createProtocol(_,a,$,j,_e){return{code:_,size:a,name:$,resolvable:Boolean(j),path:Boolean(_e)}}function getProtocol(_){if(typeof _=="number"){if(codes$3[_]!=null)return codes$3[_];throw new Error(`no protocol with code: ${_}`)}else if(typeof _=="string"){if(names[_]!=null)return names[_];throw new Error(`no protocol with name: ${_}`)}throw new Error(`invalid protocol id type: ${typeof _}`)}var encode_1$3=encode$g,MSB$6=128,REST$6=127,MSBALL$3=~REST$6,INT$3=Math.pow(2,31);function encode$g(_,a,$){if(Number.MAX_SAFE_INTEGER&&_>Number.MAX_SAFE_INTEGER)throw encode$g.bytes=0,new RangeError("Could not encode varint");a=a||[],$=$||0;for(var j=$;_>=INT$3;)a[$++]=_&255|MSB$6,_/=128;for(;_&MSBALL$3;)a[$++]=_&255|MSB$6,_>>>=7;return a[$]=_|0,encode$g.bytes=$-j+1,a}var decode$b=read$4,MSB$5=128,REST$5=127;function read$4(_,j){var $=0,j=j||0,_e=0,et=j,tt,rt=_.length;do{if(et>=rt||_e>49)throw read$4.bytes=0,new RangeError("Could not decode varint");tt=_[et++],$+=_e<28?(tt&REST$5)<<_e:(tt&REST$5)*Math.pow(2,_e),_e+=7}while(tt>=MSB$5);return read$4.bytes=et-j,$}var N1$4=Math.pow(2,7),N2$4=Math.pow(2,14),N3$4=Math.pow(2,21),N4$4=Math.pow(2,28),N5$4=Math.pow(2,35),N6$4=Math.pow(2,42),N7$4=Math.pow(2,49),N8$4=Math.pow(2,56),N9$4=Math.pow(2,63),length$6=function(_){return _<N1$4?1:_<N2$4?2:_<N3$4?3:_<N4$4?4:_<N5$4?5:_<N6$4?6:_<N7$4?7:_<N8$4?8:_<N9$4?9:10},varint$4={encode:encode_1$3,decode:decode$b,encodingLength:length$6};function concat$1(_,a){a==null&&(a=_.reduce((_e,et)=>_e+et.length,0));const $=allocUnsafe$5(a);let j=0;for(const _e of _)$.set(_e,j),j+=_e.length;return asUint8Array$2($)}function convertToString$1(_,a){switch(getProtocol(_).code){case 4:case 41:return bytes2ip(a);case 6:case 273:case 33:case 132:return bytes2port(a).toString();case 53:case 54:case 55:case 56:case 400:case 777:return bytes2str(a);case 421:return bytes2mh(a);case 444:return bytes2onion(a);case 445:return bytes2onion(a);case 466:return bytes2mb(a);default:return toString$6(a,"base16")}}function convertToBytes(_,a){switch(getProtocol(_).code){case 4:return ip2bytes(a);case 41:return ip2bytes(a);case 6:case 273:case 33:case 132:return port2bytes(parseInt(a,10));case 53:case 54:case 55:case 56:case 400:case 777:return str2bytes(a);case 421:return mh2bytes(a);case 444:return onion2bytes(a);case 445:return onion32bytes(a);case 466:return mb2bytes(a);default:return fromString$5(a,"base16")}}const decoders=Object.values(bases$2).map(_=>_.decoder),anybaseDecoder=function(){let _=decoders[0].or(decoders[1]);return decoders.slice(2).forEach(a=>_=_.or(a)),_}();function ip2bytes(_){if(!isIP(_))throw new Error("invalid ip address");return toBytes$1(_)}function bytes2ip(_){const a=toString$5(_,0,_.length);if(a==null)throw new Error("ipBuff is required");if(!isIP(a))throw new Error("invalid ip address");return a}function port2bytes(_){const a=new ArrayBuffer(2);return new DataView(a).setUint16(0,_),new Uint8Array(a)}function bytes2port(_){return new DataView(_.buffer).getUint16(_.byteOffset)}function str2bytes(_){const a=fromString$5(_),$=Uint8Array.from(varint$4.encode(a.length));return concat$1([$,a],$.length+a.length)}function bytes2str(_){const a=varint$4.decode(_);if(_=_.slice(varint$4.decode.bytes),_.length!==a)throw new Error("inconsistent lengths");return toString$6(_)}function mh2bytes(_){let a;_[0]==="Q"||_[0]==="1"?a=decode$n(base58btc$2.decode(`z${_}`)).bytes:a=CID.parse(_).multihash.bytes;const $=Uint8Array.from(varint$4.encode(a.length));return concat$1([$,a],$.length+a.length)}function mb2bytes(_){const a=anybaseDecoder.decode(_),$=Uint8Array.from(varint$4.encode(a.length));return concat$1([$,a],$.length+a.length)}function bytes2mb(_){const a=varint$4.decode(_),$=_.slice(varint$4.decode.bytes);if($.length!==a)throw new Error("inconsistent lengths");return"u"+toString$6($,"base64url")}function bytes2mh(_){const a=varint$4.decode(_),$=_.slice(varint$4.decode.bytes);if($.length!==a)throw new Error("inconsistent lengths");return toString$6($,"base58btc")}function onion2bytes(_){const a=_.split(":");if(a.length!==2)throw new Error(`failed to parse onion addr: ["'${a.join('", "')}'"]' does not contain a port number`);if(a[0].length!==16)throw new Error(`failed to parse onion addr: ${a[0]} not a Tor onion address.`);const $=base32$4.decode("b"+a[0]),j=parseInt(a[1],10);if(j<1||j>65536)throw new Error("Port number is not in range(1, 65536)");const _e=port2bytes(j);return concat$1([$,_e],$.length+_e.length)}function onion32bytes(_){const a=_.split(":");if(a.length!==2)throw new Error(`failed to parse onion addr: ["'${a.join('", "')}'"]' does not contain a port number`);if(a[0].length!==56)throw new Error(`failed to parse onion addr: ${a[0]} not a Tor onion3 address.`);const $=base32$4.decode(`b${a[0]}`),j=parseInt(a[1],10);if(j<1||j>65536)throw new Error("Port number is not in range(1, 65536)");const _e=port2bytes(j);return concat$1([$,_e],$.length+_e.length)}function bytes2onion(_){const a=_.slice(0,_.length-2),$=_.slice(_.length-2),j=toString$6(a,"base32"),_e=bytes2port($);return`${j}:${_e}`}function stringToStringTuples(_){const a=[],$=_.split("/").slice(1);if($.length===1&&$[0]==="")return[];for(let j=0;j<$.length;j++){const _e=$[j],et=getProtocol(_e);if(et.size===0){a.push([_e]);continue}if(j++,j>=$.length)throw ParseError("invalid address: "+_);if(et.path===!0){a.push([_e,cleanPath($.slice(j).join("/"))]);break}a.push([_e,$[j]])}return a}function stringTuplesToString(_){const a=[];return _.map($=>{const j=protoFromTuple($);return a.push(j.name),$.length>1&&$[1]!=null&&a.push($[1]),null}),cleanPath(a.join("/"))}function stringTuplesToTuples(_){return _.map(a=>{Array.isArray(a)||(a=[a]);const $=protoFromTuple(a);return a.length>1?[$.code,convertToBytes($.code,a[1])]:[$.code]})}function tuplesToStringTuples(_){return _.map(a=>{const $=protoFromTuple(a);return a[1]!=null?[$.code,convertToString$1($.code,a[1])]:[$.code]})}function tuplesToBytes(_){return fromBytes$1(concat$1(_.map(a=>{const $=protoFromTuple(a);let j=Uint8Array.from(varint$4.encode($.code));return a.length>1&&a[1]!=null&&(j=concat$1([j,a[1]])),j})))}function sizeForAddr(_,a){return _.size>0?_.size/8:_.size===0?0:varint$4.decode(a)+varint$4.decode.bytes}function bytesToTuples(_){const a=[];let $=0;for(;$<_.length;){const j=varint$4.decode(_,$),_e=varint$4.decode.bytes,et=getProtocol(j),tt=sizeForAddr(et,_.slice($+_e));if(tt===0){a.push([j]),$+=_e;continue}const rt=_.slice($+_e,$+_e+tt);if($+=tt+_e,$>_.length)throw ParseError("Invalid address Uint8Array: "+toString$6(_,"base16"));a.push([j,rt])}return a}function bytesToString(_){const a=bytesToTuples(_),$=tuplesToStringTuples(a);return stringTuplesToString($)}function stringToBytes(_){_=cleanPath(_);const a=stringToStringTuples(_),$=stringTuplesToTuples(a);return tuplesToBytes($)}function fromString$4(_){return stringToBytes(_)}function fromBytes$1(_){const a=validateBytes(_);if(a!=null)throw a;return Uint8Array.from(_)}function validateBytes(_){try{bytesToTuples(_)}catch(a){return a}}function cleanPath(_){return"/"+_.trim().split("/").filter(a=>a).join("/")}function ParseError(_){return new Error("Error parsing address: "+_)}function protoFromTuple(_){return getProtocol(_[0])}function equals$1(_,a){if(_===a)return!0;if(_.byteLength!==a.byteLength)return!1;for(let $=0;$<_.byteLength;$++)if(_[$]!==a[$])return!1;return!0}var __classPrivateFieldGet$3=globalThis&&globalThis.__classPrivateFieldGet||function(_,a,$,j){if($==="a"&&!j)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?_!==a||!j:!a.has(_))throw new TypeError("Cannot read private member from an object whose class did not declare it");return $==="m"?j:$==="a"?j.call(_):j?j.value:a.get(_)},__classPrivateFieldSet$1=globalThis&&globalThis.__classPrivateFieldSet||function(_,a,$,j,_e){if(j==="m")throw new TypeError("Private method is not writable");if(j==="a"&&!_e)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?_!==a||!_e:!a.has(_))throw new TypeError("Cannot write private member to an object whose class did not declare it");return j==="a"?_e.call(_,$):_e?_e.value=$:a.set(_,$),$},_DefaultMultiaddr_string,_DefaultMultiaddr_tuples,_DefaultMultiaddr_stringTuples,_a;const inspect=Symbol.for("nodejs.util.inspect.custom"),DNS_CODES=[getProtocol("dns").code,getProtocol("dns4").code,getProtocol("dns6").code,getProtocol("dnsaddr").code],P2P_CODES=[getProtocol("p2p").code,getProtocol("ipfs").code],resolvers$1=new Map,symbol$5=Symbol.for("@multiformats/js-multiaddr/multiaddr");function fromNodeAddress(_,a){if(_==null)throw new Error("requires node address object");if(a==null)throw new Error("requires transport protocol");let $;switch(_.family){case 4:$="ip4";break;case 6:$="ip6";break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new DefaultMultiaddr("/"+[$,_.address,a,_.port].join("/"))}function isName(_){return isMultiaddr(_)?_.protos().some(a=>a.resolvable):!1}function isMultiaddr(_){return Boolean(_?.[symbol$5])}class DefaultMultiaddr{constructor(a){if(_DefaultMultiaddr_string.set(this,void 0),_DefaultMultiaddr_tuples.set(this,void 0),_DefaultMultiaddr_stringTuples.set(this,void 0),this[_a]=!0,a==null&&(a=""),a instanceof Uint8Array)this.bytes=fromBytes$1(a);else if(typeof a=="string"){if(a.length>0&&a.charAt(0)!=="/")throw new Error(`multiaddr "${a}" must start with a "/"`);this.bytes=fromString$4(a)}else if(isMultiaddr(a))this.bytes=fromBytes$1(a.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return __classPrivateFieldGet$3(this,_DefaultMultiaddr_string,"f")==null&&__classPrivateFieldSet$1(this,_DefaultMultiaddr_string,bytesToString(this.bytes),"f"),__classPrivateFieldGet$3(this,_DefaultMultiaddr_string,"f")}toJSON(){return this.toString()}toOptions(){const a=this.protoCodes(),$=this.toString().split("/").slice(1);let j,_e;if($.length>2)DNS_CODES.includes(a[0])&&P2P_CODES.includes(a[1])?(j=getProtocol("tcp").name,_e=443):(j=getProtocol($[2]).name,_e=parseInt($[3]));else if(DNS_CODES.includes(a[0]))j=getProtocol("tcp").name,_e=443;else throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:a[0]===41||a[0]===55?6:4,host:$[1],transport:j,port:_e}}protos(){return this.protoCodes().map(a=>Object.assign({},getProtocol(a)))}protoCodes(){const a=[],$=this.bytes;let j=0;for(;j<$.length;){const _e=varint$4.decode($,j),et=varint$4.decode.bytes,tt=getProtocol(_e),rt=sizeForAddr(tt,$.slice(j+et));j+=rt+et,a.push(_e)}return a}protoNames(){return this.protos().map(a=>a.name)}tuples(){return __classPrivateFieldGet$3(this,_DefaultMultiaddr_tuples,"f")==null&&__classPrivateFieldSet$1(this,_DefaultMultiaddr_tuples,bytesToTuples(this.bytes),"f"),__classPrivateFieldGet$3(this,_DefaultMultiaddr_tuples,"f")}stringTuples(){return __classPrivateFieldGet$3(this,_DefaultMultiaddr_stringTuples,"f")==null&&__classPrivateFieldSet$1(this,_DefaultMultiaddr_stringTuples,tuplesToStringTuples(this.tuples()),"f"),__classPrivateFieldGet$3(this,_DefaultMultiaddr_stringTuples,"f")}encapsulate(a){return a=new DefaultMultiaddr(a),new DefaultMultiaddr(this.toString()+a.toString())}decapsulate(a){const $=a.toString(),j=this.toString(),_e=j.lastIndexOf($);if(_e<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${a.toString()}`);return new DefaultMultiaddr(j.slice(0,_e))}decapsulateCode(a){const $=this.tuples();for(let j=$.length-1;j>=0;j--)if($[j][0]===a)return new DefaultMultiaddr(tuplesToBytes($.slice(0,j)));return this}getPeerId(){try{const $=this.stringTuples().filter(j=>j[0]===names.ipfs.code).pop();if($?.[1]!=null){const j=$[1];return j[0]==="Q"||j[0]==="1"?toString$6(base58btc$2.decode(`z${j}`),"base58btc"):toString$6(CID.parse(j).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let a=null;try{a=this.stringTuples().filter($=>getProtocol($[0]).path===!0)[0][1],a==null&&(a=null)}catch{a=null}return a}equals(a){return equals$1(this.bytes,a.bytes)}async resolve(a){const $=this.protos().find(et=>et.resolvable);if($==null)return[this];const j=resolvers$1.get($.name);if(j==null)throw errCode(new Error(`no available resolver for ${$.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await j(this,a)).map(et=>new DefaultMultiaddr(et))}nodeAddress(){const a=this.toOptions();if(a.transport!=="tcp"&&a.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${a.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:a.family,address:a.host,port:a.port}}isThinWaistAddress(a){const $=(a??this).protos();return!($.length!==2||$[0].code!==4&&$[0].code!==41||$[1].code!==6&&$[1].code!==273)}[(_DefaultMultiaddr_string=new WeakMap,_DefaultMultiaddr_tuples=new WeakMap,_DefaultMultiaddr_stringTuples=new WeakMap,_a=symbol$5,inspect)](){return this.inspect()}inspect(){return"<Multiaddr "+toString$6(this.bytes,"base16")+" - "+bytesToString(this.bytes)+">"}}function multiaddr(_){return new DefaultMultiaddr(_)}const DNS4=base$2("dns4"),DNS6=base$2("dns6"),DNSADDR=base$2("dnsaddr"),DNS=or$2(base$2("dns"),DNSADDR,DNS4,DNS6),IP=or$2(base$2("ip4"),base$2("ip6")),TCP=or$2(and(IP,base$2("tcp")),and(DNS,base$2("tcp"))),UDP=and(IP,base$2("udp")),UTP=and(UDP,base$2("utp")),QUIC=and(UDP,base$2("quic")),WebSockets$1=or$2(and(TCP,base$2("ws")),and(DNS,base$2("ws"))),WebSocketsSecure=or$2(and(TCP,base$2("wss")),and(DNS,base$2("wss"))),HTTP$1=or$2(and(TCP,base$2("http")),and(IP,base$2("http")),and(DNS,base$2("http"))),HTTPS=or$2(and(TCP,base$2("https")),and(IP,base$2("https")),and(DNS,base$2("https"))),WebRTCStar$1=or$2(and(WebSockets$1,base$2("p2p-webrtc-star"),base$2("p2p")),and(WebSocketsSecure,base$2("p2p-webrtc-star"),base$2("p2p")),and(WebSockets$1,base$2("p2p-webrtc-star")),and(WebSocketsSecure,base$2("p2p-webrtc-star"))),WebRTCDirect=or$2(and(HTTP$1,base$2("p2p-webrtc-direct"),base$2("p2p")),and(HTTPS,base$2("p2p-webrtc-direct"),base$2("p2p")),and(HTTP$1,base$2("p2p-webrtc-direct")),and(HTTPS,base$2("p2p-webrtc-direct"))),Reliable=or$2(WebSockets$1,WebSocketsSecure,HTTP$1,HTTPS,WebRTCStar$1,WebRTCDirect,TCP,UTP,QUIC,DNS),_P2P=or$2(and(Reliable,base$2("p2p")),WebRTCStar$1,WebRTCDirect,base$2("p2p")),_Circuit=or$2(and(_P2P,base$2("p2p-circuit"),_P2P),and(_P2P,base$2("p2p-circuit")),and(base$2("p2p-circuit"),_P2P),and(Reliable,base$2("p2p-circuit")),and(base$2("p2p-circuit"),Reliable),base$2("p2p-circuit")),CircuitRecursive=()=>or$2(and(_Circuit,CircuitRecursive),_Circuit),Circuit$1=CircuitRecursive(),P2P=or$2(and(Circuit$1,_P2P,Circuit$1),and(_P2P,Circuit$1),and(Circuit$1,_P2P),Circuit$1,_P2P),IPFS$1=P2P;function makeMatchesFunction(_){function a($){let j;try{j=multiaddr($)}catch{return!1}const _e=_(j.protoNames());return _e===null?!1:_e===!0||_e===!1?_e:_e.length===0}return a}function and(..._){function a($){if($.length<_.length)return null;let j=$;return _.some(_e=>(j=typeof _e=="function"?_e().partialMatch($):_e.partialMatch($),Array.isArray(j)&&($=j),j===null)),j}return{toString:function(){return"{ "+_.join(" ")+" }"},input:_,matches:makeMatchesFunction(a),partialMatch:a}}function or$2(..._){function a(j){let _e=null;return _.some(et=>{const tt=typeof et=="function"?et().partialMatch(j):et.partialMatch(j);return tt!=null?(_e=tt,!0):!1}),_e}return{toString:function(){return"{ "+_.join(" ")+" }"},input:_,matches:makeMatchesFunction(a),partialMatch:a}}function base$2(_){const a=_;function $(_e){let et;try{et=multiaddr(_e)}catch{return!1}const tt=et.protoNames();return tt.length===1&&tt[0]===a}function j(_e){return _e.length===0?null:_e[0]===a?_e.slice(1):null}return{toString:function(){return a},matches:$,partialMatch:j}}const isReactNative$2=typeof navigator<"u"&&navigator.product==="ReactNative";function getDefaultBase(){return isReactNative$2?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}const URL$2=self.URL,defaultBase$1=getDefaultBase();class URLWithLegacySupport$2{constructor(a="",$=defaultBase$1){this.super=new URL$2(a,$),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(a){this.super.hash=a}set host(a){this.super.host=a}set hostname(a){this.super.hostname=a}set href(a){this.super.href=a}set password(a){this.super.password=a}set pathname(a){this.super.pathname=a}set port(a){this.super.port=a}set protocol(a){this.super.protocol=a}set search(a){this.super.search=a}set username(a){this.super.username=a}static createObjectURL(a){return URL$2.createObjectURL(a)}static revokeObjectURL(a){URL$2.revokeObjectURL(a)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}}function format$3(_){if(typeof _=="string")return new URL$2(_).toString();if(!(_ instanceof URL$2)){const a=_.username&&_.password?`${_.username}:${_.password}@`:"",$=_.auth?_.auth+"@":"",j=_.port?":"+_.port:"",_e=_.protocol?_.protocol+"//":"",et=_.host||"",tt=_.hostname||"",rt=_.search||(_.query?"?"+_.query:""),nt=_.hash||"",it=_.pathname||"",st=_.path||it+rt;return`${_e}${a||$}${et||tt+j}${st}${nt}`}}var urlBrowser={URLWithLegacySupport:URLWithLegacySupport$2,URLSearchParams:self.URLSearchParams,defaultBase:defaultBase$1,format:format$3};const{URLWithLegacySupport:URLWithLegacySupport$1,format:format$2}=urlBrowser;var relative$1=(_,a={},$={},j)=>{let _e=a.protocol?a.protocol.replace(":",""):"http";_e=($[_e]||j||_e)+":";let et;try{et=new URLWithLegacySupport$1(_)}catch{et={}}const tt=Object.assign({},a,{protocol:_e||et.protocol,host:a.host||et.host});return new URLWithLegacySupport$1(_,format$2(tt)).toString()};const{URLWithLegacySupport,format:format$1,URLSearchParams:URLSearchParams$2,defaultBase}=urlBrowser,relative=relative$1;var isoUrl={URL:URLWithLegacySupport,URLSearchParams:URLSearchParams$2,format:format$1,relative,defaultBase};const pathPattern=/^\/(ip[fn]s)\/([^/?#]+)/,defaultProtocolMatch=1,defaultHashMath=2,subdomainGatewayPattern=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,fqdnWithTld=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function isCID(_){try{return isString(_)?Boolean(CID.parse(_)):_ instanceof Uint8Array?Boolean(CID.decode(_)):Boolean(CID.asCID(_))}catch{return!1}}function isIpfs(_,a,$=defaultProtocolMatch,j=defaultHashMath){const _e=convertToString(_);if(_e===!1)return!1;const et=_e.match(a);if(et==null||et[$]!=="ipfs")return!1;let tt=et[j];return tt!=null&&a===subdomainGatewayPattern&&(tt=tt.toLowerCase()),isCID(tt)}function isIpns(_,a,$=defaultProtocolMatch,j=defaultHashMath){const _e=convertToString(_);if(_e===!1)return!1;const et=_e.match(a);if(et==null||et[$]!=="ipns")return!1;let tt=et[j];if(tt!=null&&a===subdomainGatewayPattern){if(tt=tt.toLowerCase(),isCID(tt))return!0;try{!tt.includes(".")&&tt.includes("-")&&(tt=tt.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));const{hostname:rt}=new isoUrl.URL(`http://${tt}`);return fqdnWithTld.test(rt)}catch{return!1}}return!0}function isString(_){return typeof _=="string"}function convertToString(_){return _ instanceof Uint8Array?toString$6(_,"base58btc"):isString(_)?_:!1}const path=_=>isIpfs(_,pathPattern)||isIpns(_,pathPattern),ipfsPath$1=_=>isIpfs(_,pathPattern),ipnsPath=_=>isIpns(_,pathPattern);let nanoid=(_=21)=>crypto.getRandomValues(new Uint8Array(_)).reduce((a,$)=>($&=63,$<36?a+=$.toString(36):$<62?a+=($-26).toString(36).toUpperCase():$>62?a+="-":a+="_",a),"");const pathSepS="/",pathSepB=new TextEncoder().encode(pathSepS),pathSep=pathSepB[0];class Key{constructor(a,$){if(typeof a=="string")this._buf=fromString$5(a);else if(a instanceof Uint8Array)this._buf=a;else throw new Error("Invalid key, should be String of Uint8Array");if($==null&&($=!0),$&&this.clean(),this._buf.byteLength===0||this._buf[0]!==pathSep)throw new Error("Invalid key")}toString(a="utf8"){return toString$6(this._buf,a)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(a){return new Key(a.join(pathSepS))}static random(){return new Key(nanoid().replace(/-/g,""))}static asKey(a){return a instanceof Uint8Array||typeof a=="string"?new Key(a):typeof a.uint8Array=="function"?new Key(a.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=pathSepB),this._buf[0]!==pathSep){const a=new Uint8Array(this._buf.byteLength+1);a.fill(pathSep,0,1),a.set(this._buf,1),this._buf=a}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===pathSep;)this._buf=this._buf.subarray(0,-1)}less(a){const $=this.list(),j=a.list();for(let _e=0;_e<$.length;_e++){if(j.length<_e+1)return!1;const et=$[_e],tt=j[_e];if(et<tt)return!0;if(et>tt)return!1}return $.length<j.length}reverse(){return Key.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const a=this.namespaces();return a[a.length-1]}list(){return this.toString().split(pathSepS).slice(1)}type(){return namespaceType(this.baseNamespace())}name(){return namespaceValue(this.baseNamespace())}instance(a){return new Key(this.toString()+":"+a)}path(){let a=this.parent().toString();return a.endsWith(pathSepS)||(a+=pathSepS),a+=this.type(),new Key(a)}parent(){const a=this.list();return a.length===1?new Key(pathSepS):new Key(a.slice(0,-1).join(pathSepS))}child(a){return this.toString()===pathSepS?a:a.toString()===pathSepS?this:new Key(this.toString()+a.toString(),!1)}isAncestorOf(a){return a.toString()===this.toString()?!1:a.toString().startsWith(this.toString())}isDecendantOf(a){return a.toString()===this.toString()?!1:this.toString().startsWith(a.toString())}isTopLevel(){return this.list().length===1}concat(...a){return Key.withNamespaces([...this.namespaces(),...flatten(a.map($=>$.namespaces()))])}}function namespaceType(_){const a=_.split(":");return a.length<2?"":a.slice(0,-1).join(":")}function namespaceValue(_){const a=_.split(":");return a[a.length-1]}function flatten(_){return[].concat(..._)}var anySignal$2={exports:{}};function anySignal$1(_){const a=new globalThis.AbortController;function $(){a.abort();for(const j of _)!j||!j.removeEventListener||j.removeEventListener("abort",$)}for(const j of _)if(!(!j||!j.addEventListener)){if(j.aborted){$();break}j.addEventListener("abort",$)}return a.signal}anySignal$2.exports=anySignal$1;var anySignal_2=anySignal$2.exports.anySignal=anySignal$1;let durationRE=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;parse$3.nanosecond=parse$3.ns=1/1e6;parse$3.\u00B5s=parse$3.\u03BCs=parse$3.us=parse$3.microsecond=1/1e3;parse$3.millisecond=parse$3.ms=parse$3[""]=1;parse$3.second=parse$3.sec=parse$3.s=parse$3.ms*1e3;parse$3.minute=parse$3.min=parse$3.m=parse$3.s*60;parse$3.hour=parse$3.hr=parse$3.h=parse$3.m*60;parse$3.day=parse$3.d=parse$3.h*24;parse$3.week=parse$3.wk=parse$3.w=parse$3.d*7;parse$3.month=parse$3.b=parse$3.d*(365.25/12);parse$3.year=parse$3.yr=parse$3.y=parse$3.d*365.25;function parse$3(_="",a="ms"){var $=null;return _=(_+"").replace(/(\d)[,_](\d)/g,"$1$2"),_.replace(durationRE,function(j,_e,et){et=unitRatio(et),et&&($=($||0)+parseFloat(_e,10)*et)}),$&&$/(unitRatio(a)||1)}function unitRatio(_){return parse$3[_]||parse$3[_.toLowerCase().replace(/s$/,"")]}class TimeoutError$6 extends Error{constructor(a="request timed out"){super(a),this.name="TimeoutError",this.code=TimeoutError$6.code}}TimeoutError$6.code="ERR_TIMEOUT";function withTimeoutOption(_,a){return(...$)=>{const j=$[a??$.length-1];if(!j||!j.timeout)return _(...$);const _e=typeof j.timeout=="string"?parse$3(j.timeout):j.timeout,et=new timeoutAbortController.TimeoutController(_e);j.signal=anySignal_2([j.signal,et.signal]);const tt=_(...$),rt=new Promise((st,ot)=>{et.signal.addEventListener("abort",()=>{ot(new TimeoutError$6)})}),nt=Date.now(),it=()=>{if(et.signal.aborted)throw new TimeoutError$6;if(Date.now()-nt>_e)throw et.abort(),new TimeoutError$6};return tt[Symbol.asyncIterator]?async function*(){const st=tt[Symbol.asyncIterator]();try{for(;;){const{value:ot,done:at}=await Promise.race([st.next(),rt]);if(at)break;it(),yield ot}}catch(ot){throw it(),ot}finally{et.clear(),st.return&&st.return()}}():(async()=>{try{const st=await Promise.race([tt,rt]);return it(),st}catch(st){throw it(),st}finally{et.clear()}})()}}const IPFS_PREFIX$1="/ipfs/";function toCidAndPath(_){if(_ instanceof Uint8Array)try{_=CID.decode(_)}catch(_e){throw errCode(_e,"ERR_INVALID_CID")}let a=CID.asCID(_);if(a)return{cid:a,path:void 0};_=_.toString(),_.startsWith(IPFS_PREFIX$1)&&(_=_.substring(IPFS_PREFIX$1.length));const $=_.split("/");let j;try{a=CID.parse($.shift()||"")}catch(_e){throw errCode(_e,"ERR_INVALID_CID")}return $.length&&(j=`/${$.join("/")}`),{cid:a,path:j}}const ERR_BAD_PATH="ERR_BAD_PATH",OFFLINE_ERROR="This command must be run in online mode. Try running 'ipfs daemon' first.",MFS_ROOT_KEY$2=new Key("/local/filesroot"),MFS_MAX_CHUNK_SIZE=262144,normalizePath=_=>{if(CID.asCID(_))return`/ipfs/${_}`;const $=_.toString();try{return`/ipfs/${CID.parse($)}`}catch{}if(path($))return $;throw errCode(new Error(`invalid path: ${_}`),ERR_BAD_PATH)},normalizeCidPath=_=>_ instanceof Uint8Array?CID.decode(_).toString():(_=_.toString(),_.indexOf("/ipfs/")===0&&(_=_.substring(6)),_.charAt(_.length-1)==="/"&&(_=_.substring(0,_.length-1)),_),resolvePath$1=async function(_,a,$,j={}){const{cid:_e,path:et}=toCidAndPath($);et&&(j.path=et);let tt=_e,rt=j.path||"";if(rt.startsWith("/")&&(rt=rt.substring(1)),j.path)try{for await(const{value:nt,remainderPath:it}of resolve$5(_e,j.path,a,_,{signal:j.signal})){if(!CID.asCID(nt))break;rt=it,tt=nt}}catch(nt){throw nt.message.startsWith("Object has no property")&&(nt.message=`no link named "${rt.split("/")[0]}" under ${tt}`,nt.code="ERR_NO_LINK"),nt}return{cid:tt,remainderPath:rt||""}},mapFile=_=>{if(_.type!=="file"&&_.type!=="directory"&&_.type!=="raw")throw new Error(`Unknown node type '${_.type}'`);const a={cid:_.cid,path:_.path,name:_.name,size:_.size,type:"file"};return _.type==="directory"&&(a.type="dir"),_.type==="file"&&(a.size=_.unixfs.fileSize()),(_.type==="file"||_.type==="directory")&&(a.mode=_.unixfs.mode,_.unixfs.mtime!==void 0&&(a.mtime=_.unixfs.mtime)),a},withTimeout=withTimeoutOption(async(_,a)=>await _),resolve$5=async function*(_,a,$,j,_e){const et=async it=>{const st=await $.getCodec(it.code),ot=await j.blocks.get(it,_e);return st.decode(ot)},tt=a.split("/").filter(Boolean);let rt=await et(_),nt=_;for(;tt.length;){const it=tt.shift();if(!it)throw errCode(new Error(`Could not resolve path "${a}"`),"ERR_INVALID_PATH");if(_.code===code$9&&Array.isArray(rt.Links)){const st=rt.Links.find(ot=>ot.Name===it);if(st){yield{value:st.Hash,remainderPath:tt.join("/")},rt=await et(st.Hash),nt=st.Hash;continue}}if(Object.prototype.hasOwnProperty.call(rt,it))rt=rt[it],yield{value:rt,remainderPath:tt.join("/")};else throw errCode(new Error(`no link named "${it}" under ${nt}`),"ERR_NO_LINK");CID.asCID(rt)&&(nt=rt,rt=await et(rt))}yield{value:rt,remainderPath:""}};class Service{static create({start:a,stop:$}){return new Service(a,$)}static async start(a,$){const{state:j,activate:_e}=a;switch(j.status){case"stopped":try{const et=_e($);a.state={status:"starting",ready:et};const tt=await et;return a.state={status:"started",value:tt},tt}catch(et){throw a.state={status:"stopped"},et}case"starting":throw new AlreadyStartingError;case"started":throw new AlreadyStartedError;case"stopping":return await j.ready,await Service.start(a,$);default:return Service.panic(a)}}static async stop(a){const{state:$,deactivate:j}=a;switch($.status){case"stopped":break;case"starting":{try{await $.ready}catch{}return await Service.stop(a)}case"stopping":return await $.ready;case"started":{j&&await j($.value),a.state={status:"stopped"};break}default:Service.panic($)}}static try({state:a}){switch(a.status){case"started":return a.value;default:return null}}static async use({state:a},$){switch(a.status){case"started":return a.value;case"starting":return await withTimeout(a.ready,$);default:throw new NotStartedError}}static panic({state:a}){const $=JSON.stringify({status:a.status});throw RangeError(`Service in invalid state ${$}, should never happen if you see this please report a bug`)}constructor(a,$){this.activate=a,this.deactivate=$,this.state={status:"stopped"}}async use(a){return await Service.use(this,a)}try(){return Service.try(this)}}function createStart$1({network:_,preload:a,peerId:$,keychain:j,repo:_e,ipns:et,mfsPreload:tt,print:rt,hashers:nt,options:it}){return async()=>{const{libp2p:ot}=await Service.start(_,{peerId:$,repo:_e,print:rt,hashers:nt,options:it});await Promise.all([et.startOnline({keychain:j,libp2p:ot,peerId:$,repo:_e}),a.start(),tt.start()])}}function createStop$1({network:_,preload:a,ipns:$,repo:j,mfsPreload:_e}){return async()=>{await Promise.all([a.stop(),$.stop(),_e.stop()]),await Service.stop(_),await j.close()}}var hashlru=function(_){if(!_)throw Error("hashlru must have a max value, of type number, greater than 0");var a=0,$=Object.create(null),j=Object.create(null);function _e(et,tt){$[et]=tt,a++,a>=_&&(a=0,j=$,$=Object.create(null))}return{has:function(et){return $[et]!==void 0||j[et]!==void 0},remove:function(et){$[et]!==void 0&&($[et]=void 0),j[et]!==void 0&&(j[et]=void 0)},get:function(et){var tt=$[et];if(tt!==void 0)return tt;if((tt=j[et])!==void 0)return _e(et,tt),tt},set:function(et,tt){$[et]!==void 0?$[et]=tt:_e(et,tt)},clear:function(){$=Object.create(null),j=Object.create(null)}}};class TLRU$1{constructor(a){this.lru=hashlru(a)}get(a){const $=this.lru.get(a);if($){if($.expire&&$.expire<Date.now()){this.lru.remove(a);return}return $.value}}set(a,$,j){this.lru.set(a,{value:$,expire:Date.now()+j})}has(a){return!!this.get(a)}remove(a){this.lru.remove(a)}clear(){this.lru.clear()}}var eventemitter3={exports:{}};(function(_){var a=Object.prototype.hasOwnProperty,$="~";function j(){}Object.create&&(j.prototype=Object.create(null),new j().__proto__||($=!1));function _e(nt,it,st){this.fn=nt,this.context=it,this.once=st||!1}function et(nt,it,st,ot,at){if(typeof st!="function")throw new TypeError("The listener must be a function");var lt=new _e(st,ot||nt,at),ct=$?$+it:it;return nt._events[ct]?nt._events[ct].fn?nt._events[ct]=[nt._events[ct],lt]:nt._events[ct].push(lt):(nt._events[ct]=lt,nt._eventsCount++),nt}function tt(nt,it){--nt._eventsCount===0?nt._events=new j:delete nt._events[it]}function rt(){this._events=new j,this._eventsCount=0}rt.prototype.eventNames=function(){var it=[],st,ot;if(this._eventsCount===0)return it;for(ot in st=this._events)a.call(st,ot)&&it.push($?ot.slice(1):ot);return Object.getOwnPropertySymbols?it.concat(Object.getOwnPropertySymbols(st)):it},rt.prototype.listeners=function(it){var st=$?$+it:it,ot=this._events[st];if(!ot)return[];if(ot.fn)return[ot.fn];for(var at=0,lt=ot.length,ct=new Array(lt);at<lt;at++)ct[at]=ot[at].fn;return ct},rt.prototype.listenerCount=function(it){var st=$?$+it:it,ot=this._events[st];return ot?ot.fn?1:ot.length:0},rt.prototype.emit=function(it,st,ot,at,lt,ct){var ut=$?$+it:it;if(!this._events[ut])return!1;var dt=this._events[ut],ft=arguments.length,pt,yt;if(dt.fn){switch(dt.once&&this.removeListener(it,dt.fn,void 0,!0),ft){case 1:return dt.fn.call(dt.context),!0;case 2:return dt.fn.call(dt.context,st),!0;case 3:return dt.fn.call(dt.context,st,ot),!0;case 4:return dt.fn.call(dt.context,st,ot,at),!0;case 5:return dt.fn.call(dt.context,st,ot,at,lt),!0;case 6:return dt.fn.call(dt.context,st,ot,at,lt,ct),!0}for(yt=1,pt=new Array(ft-1);yt<ft;yt++)pt[yt-1]=arguments[yt];dt.fn.apply(dt.context,pt)}else{var mt=dt.length,_t;for(yt=0;yt<mt;yt++)switch(dt[yt].once&&this.removeListener(it,dt[yt].fn,void 0,!0),ft){case 1:dt[yt].fn.call(dt[yt].context);break;case 2:dt[yt].fn.call(dt[yt].context,st);break;case 3:dt[yt].fn.call(dt[yt].context,st,ot);break;case 4:dt[yt].fn.call(dt[yt].context,st,ot,at);break;default:if(!pt)for(_t=1,pt=new Array(ft-1);_t<ft;_t++)pt[_t-1]=arguments[_t];dt[yt].fn.apply(dt[yt].context,pt)}}return!0},rt.prototype.on=function(it,st,ot){return et(this,it,st,ot,!1)},rt.prototype.once=function(it,st,ot){return et(this,it,st,ot,!0)},rt.prototype.removeListener=function(it,st,ot,at){var lt=$?$+it:it;if(!this._events[lt])return this;if(!st)return tt(this,lt),this;var ct=this._events[lt];if(ct.fn)ct.fn===st&&(!at||ct.once)&&(!ot||ct.context===ot)&&tt(this,lt);else{for(var ut=0,dt=[],ft=ct.length;ut<ft;ut++)(ct[ut].fn!==st||at&&!ct[ut].once||ot&&ct[ut].context!==ot)&&dt.push(ct[ut]);dt.length?this._events[lt]=dt.length===1?dt[0]:dt:tt(this,lt)}return this},rt.prototype.removeAllListeners=function(it){var st;return it?(st=$?$+it:it,this._events[st]&&tt(this,st)):(this._events=new j,this._eventsCount=0),this},rt.prototype.off=rt.prototype.removeListener,rt.prototype.addListener=rt.prototype.on,rt.prefixed=$,rt.EventEmitter=rt,_.exports=rt})(eventemitter3);const EventEmitter$4=eventemitter3.exports;class TimeoutError$5 extends Error{constructor(a){super(a),this.name="TimeoutError"}}class AbortError$7 extends Error{constructor(a){super(),this.name="AbortError",this.message=a}}const getDOMException$2=_=>globalThis.DOMException===void 0?new AbortError$7(_):new DOMException(_),getAbortedReason$2=_=>{const a=_.reason===void 0?getDOMException$2("This operation was aborted."):_.reason;return a instanceof Error?a:getDOMException$2(a)};function pTimeout$2(_,a,$,j){let _e;const et=new Promise((tt,rt)=>{if(typeof a!="number"||Math.sign(a)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${a}\``);if(a===Number.POSITIVE_INFINITY){tt(_);return}if(j={customTimers:{setTimeout,clearTimeout},...j},j.signal){const{signal:nt}=j;nt.aborted&&rt(getAbortedReason$2(nt)),nt.addEventListener("abort",()=>{rt(getAbortedReason$2(nt))})}_e=j.customTimers.setTimeout.call(void 0,()=>{if(typeof $=="function"){try{tt($())}catch(st){rt(st)}return}const nt=typeof $=="string"?$:`Promise timed out after ${a} milliseconds`,it=$ instanceof Error?$:new TimeoutError$5(nt);typeof _.cancel=="function"&&_.cancel(),rt(it)},a),(async()=>{try{tt(await _)}catch(nt){rt(nt)}finally{j.customTimers.clearTimeout.call(void 0,_e)}})()});return et.clear=()=>{clearTimeout(_e),_e=void 0},et}function lowerBound(_,a,$){let j=0,_e=_.length;for(;_e>0;){const et=Math.trunc(_e/2);let tt=j+et;$(_[tt],a)<=0?(j=++tt,_e-=et+1):_e=et}return j}var __classPrivateFieldGet$2=globalThis&&globalThis.__classPrivateFieldGet||function(_,a,$,j){if($==="a"&&!j)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?_!==a||!j:!a.has(_))throw new TypeError("Cannot read private member from an object whose class did not declare it");return $==="m"?j:$==="a"?j.call(_):j?j.value:a.get(_)},_PriorityQueue_queue;class PriorityQueue{constructor(){_PriorityQueue_queue.set(this,[])}enqueue(a,$){$={priority:0,...$};const j={priority:$.priority,run:a};if(this.size&&__classPrivateFieldGet$2(this,_PriorityQueue_queue,"f")[this.size-1].priority>=$.priority){__classPrivateFieldGet$2(this,_PriorityQueue_queue,"f").push(j);return}const _e=lowerBound(__classPrivateFieldGet$2(this,_PriorityQueue_queue,"f"),j,(et,tt)=>tt.priority-et.priority);__classPrivateFieldGet$2(this,_PriorityQueue_queue,"f").splice(_e,0,j)}dequeue(){const a=__classPrivateFieldGet$2(this,_PriorityQueue_queue,"f").shift();return a?.run}filter(a){return __classPrivateFieldGet$2(this,_PriorityQueue_queue,"f").filter($=>$.priority===a.priority).map($=>$.run)}get size(){return __classPrivateFieldGet$2(this,_PriorityQueue_queue,"f").length}}_PriorityQueue_queue=new WeakMap;var __classPrivateFieldSet=globalThis&&globalThis.__classPrivateFieldSet||function(_,a,$,j,_e){if(j==="m")throw new TypeError("Private method is not writable");if(j==="a"&&!_e)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?_!==a||!_e:!a.has(_))throw new TypeError("Cannot write private member to an object whose class did not declare it");return j==="a"?_e.call(_,$):_e?_e.value=$:a.set(_,$),$},__classPrivateFieldGet$1=globalThis&&globalThis.__classPrivateFieldGet||function(_,a,$,j){if($==="a"&&!j)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?_!==a||!j:!a.has(_))throw new TypeError("Cannot read private member from an object whose class did not declare it");return $==="m"?j:$==="a"?j.call(_):j?j.value:a.get(_)},_PQueue_instances,_PQueue_carryoverConcurrencyCount,_PQueue_isIntervalIgnored,_PQueue_intervalCount,_PQueue_intervalCap,_PQueue_interval,_PQueue_intervalEnd,_PQueue_intervalId,_PQueue_timeoutId,_PQueue_queue,_PQueue_queueClass,_PQueue_pendingCount,_PQueue_concurrency,_PQueue_isPaused,_PQueue_throwOnTimeout,_PQueue_doesIntervalAllowAnother_get,_PQueue_doesConcurrentAllowAnother_get,_PQueue_next,_PQueue_emitEvents,_PQueue_onResumeInterval,_PQueue_isIntervalPaused_get,_PQueue_tryToStartAnother,_PQueue_initializeIntervalIfNeeded,_PQueue_onInterval,_PQueue_processQueue,_PQueue_onEvent;const timeoutError=new TimeoutError$5;class AbortError$6 extends Error{}class PQueue extends EventEmitter$4{constructor(a){var $,j,_e,et;if(super(),_PQueue_instances.add(this),_PQueue_carryoverConcurrencyCount.set(this,void 0),_PQueue_isIntervalIgnored.set(this,void 0),_PQueue_intervalCount.set(this,0),_PQueue_intervalCap.set(this,void 0),_PQueue_interval.set(this,void 0),_PQueue_intervalEnd.set(this,0),_PQueue_intervalId.set(this,void 0),_PQueue_timeoutId.set(this,void 0),_PQueue_queue.set(this,void 0),_PQueue_queueClass.set(this,void 0),_PQueue_pendingCount.set(this,0),_PQueue_concurrency.set(this,void 0),_PQueue_isPaused.set(this,void 0),_PQueue_throwOnTimeout.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:PriorityQueue,...a},!(typeof a.intervalCap=="number"&&a.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(j=($=a.intervalCap)===null||$===void 0?void 0:$.toString())!==null&&j!==void 0?j:""}\` (${typeof a.intervalCap})`);if(a.interval===void 0||!(Number.isFinite(a.interval)&&a.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(et=(_e=a.interval)===null||_e===void 0?void 0:_e.toString())!==null&&et!==void 0?et:""}\` (${typeof a.interval})`);__classPrivateFieldSet(this,_PQueue_carryoverConcurrencyCount,a.carryoverConcurrencyCount,"f"),__classPrivateFieldSet(this,_PQueue_isIntervalIgnored,a.intervalCap===Number.POSITIVE_INFINITY||a.interval===0,"f"),__classPrivateFieldSet(this,_PQueue_intervalCap,a.intervalCap,"f"),__classPrivateFieldSet(this,_PQueue_interval,a.interval,"f"),__classPrivateFieldSet(this,_PQueue_queue,new a.queueClass,"f"),__classPrivateFieldSet(this,_PQueue_queueClass,a.queueClass,"f"),this.concurrency=a.concurrency,this.timeout=a.timeout,__classPrivateFieldSet(this,_PQueue_throwOnTimeout,a.throwOnTimeout===!0,"f"),__classPrivateFieldSet(this,_PQueue_isPaused,a.autoStart===!1,"f")}get concurrency(){return __classPrivateFieldGet$1(this,_PQueue_concurrency,"f")}set concurrency(a){if(!(typeof a=="number"&&a>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${a}\` (${typeof a})`);__classPrivateFieldSet(this,_PQueue_concurrency,a,"f"),__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_processQueue).call(this)}async add(a,$={}){return new Promise((j,_e)=>{const et=async()=>{var tt,rt,nt;__classPrivateFieldSet(this,_PQueue_pendingCount,(rt=__classPrivateFieldGet$1(this,_PQueue_pendingCount,"f"),rt++,rt),"f"),__classPrivateFieldSet(this,_PQueue_intervalCount,(nt=__classPrivateFieldGet$1(this,_PQueue_intervalCount,"f"),nt++,nt),"f");try{if(!((tt=$.signal)===null||tt===void 0)&&tt.aborted){_e(new AbortError$6("The task was aborted."));return}const st=await(this.timeout===void 0&&$.timeout===void 0?a({signal:$.signal}):pTimeout$2(Promise.resolve(a({signal:$.signal})),$.timeout===void 0?this.timeout:$.timeout,()=>{($.throwOnTimeout===void 0?__classPrivateFieldGet$1(this,_PQueue_throwOnTimeout,"f"):$.throwOnTimeout)&&_e(timeoutError)}));j(st),this.emit("completed",st)}catch(it){_e(it),this.emit("error",it)}__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_next).call(this)};__classPrivateFieldGet$1(this,_PQueue_queue,"f").enqueue(et,$),__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this),this.emit("add")})}async addAll(a,$){return Promise.all(a.map(async j=>this.add(j,$)))}start(){return __classPrivateFieldGet$1(this,_PQueue_isPaused,"f")?(__classPrivateFieldSet(this,_PQueue_isPaused,!1,"f"),__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_processQueue).call(this),this):this}pause(){__classPrivateFieldSet(this,_PQueue_isPaused,!0,"f")}clear(){__classPrivateFieldSet(this,_PQueue_queue,new(__classPrivateFieldGet$1(this,_PQueue_queueClass,"f")),"f")}async onEmpty(){__classPrivateFieldGet$1(this,_PQueue_queue,"f").size!==0&&await __classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"empty")}async onSizeLessThan(a){__classPrivateFieldGet$1(this,_PQueue_queue,"f").size<a||await __classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"next",()=>__classPrivateFieldGet$1(this,_PQueue_queue,"f").size<a)}async onIdle(){__classPrivateFieldGet$1(this,_PQueue_pendingCount,"f")===0&&__classPrivateFieldGet$1(this,_PQueue_queue,"f").size===0||await __classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"idle")}get size(){return __classPrivateFieldGet$1(this,_PQueue_queue,"f").size}sizeBy(a){return __classPrivateFieldGet$1(this,_PQueue_queue,"f").filter(a).length}get pending(){return __classPrivateFieldGet$1(this,_PQueue_pendingCount,"f")}get isPaused(){return __classPrivateFieldGet$1(this,_PQueue_isPaused,"f")}}_PQueue_carryoverConcurrencyCount=new WeakMap,_PQueue_isIntervalIgnored=new WeakMap,_PQueue_intervalCount=new WeakMap,_PQueue_intervalCap=new WeakMap,_PQueue_interval=new WeakMap,_PQueue_intervalEnd=new WeakMap,_PQueue_intervalId=new WeakMap,_PQueue_timeoutId=new WeakMap,_PQueue_queue=new WeakMap,_PQueue_queueClass=new WeakMap,_PQueue_pendingCount=new WeakMap,_PQueue_concurrency=new WeakMap,_PQueue_isPaused=new WeakMap,_PQueue_throwOnTimeout=new WeakMap,_PQueue_instances=new WeakSet,_PQueue_doesIntervalAllowAnother_get=function _(){return __classPrivateFieldGet$1(this,_PQueue_isIntervalIgnored,"f")||__classPrivateFieldGet$1(this,_PQueue_intervalCount,"f")<__classPrivateFieldGet$1(this,_PQueue_intervalCap,"f")},_PQueue_doesConcurrentAllowAnother_get=function _(){return __classPrivateFieldGet$1(this,_PQueue_pendingCount,"f")<__classPrivateFieldGet$1(this,_PQueue_concurrency,"f")},_PQueue_next=function _(){var a;__classPrivateFieldSet(this,_PQueue_pendingCount,(a=__classPrivateFieldGet$1(this,_PQueue_pendingCount,"f"),a--,a),"f"),__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this),this.emit("next")},_PQueue_emitEvents=function _(){this.emit("empty"),__classPrivateFieldGet$1(this,_PQueue_pendingCount,"f")===0&&this.emit("idle")},_PQueue_onResumeInterval=function _(){__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_onInterval).call(this),__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_initializeIntervalIfNeeded).call(this),__classPrivateFieldSet(this,_PQueue_timeoutId,void 0,"f")},_PQueue_isIntervalPaused_get=function _(){const a=Date.now();if(__classPrivateFieldGet$1(this,_PQueue_intervalId,"f")===void 0){const $=__classPrivateFieldGet$1(this,_PQueue_intervalEnd,"f")-a;if($<0)__classPrivateFieldSet(this,_PQueue_intervalCount,__classPrivateFieldGet$1(this,_PQueue_carryoverConcurrencyCount,"f")?__classPrivateFieldGet$1(this,_PQueue_pendingCount,"f"):0,"f");else return __classPrivateFieldGet$1(this,_PQueue_timeoutId,"f")===void 0&&__classPrivateFieldSet(this,_PQueue_timeoutId,setTimeout(()=>{__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_onResumeInterval).call(this)},$),"f"),!0}return!1},_PQueue_tryToStartAnother=function _(){if(__classPrivateFieldGet$1(this,_PQueue_queue,"f").size===0)return __classPrivateFieldGet$1(this,_PQueue_intervalId,"f")&&clearInterval(__classPrivateFieldGet$1(this,_PQueue_intervalId,"f")),__classPrivateFieldSet(this,_PQueue_intervalId,void 0,"f"),__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_emitEvents).call(this),!1;if(!__classPrivateFieldGet$1(this,_PQueue_isPaused,"f")){const a=!__classPrivateFieldGet$1(this,_PQueue_instances,"a",_PQueue_isIntervalPaused_get);if(__classPrivateFieldGet$1(this,_PQueue_instances,"a",_PQueue_doesIntervalAllowAnother_get)&&__classPrivateFieldGet$1(this,_PQueue_instances,"a",_PQueue_doesConcurrentAllowAnother_get)){const $=__classPrivateFieldGet$1(this,_PQueue_queue,"f").dequeue();return $?(this.emit("active"),$(),a&&__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_initializeIntervalIfNeeded).call(this),!0):!1}}return!1},_PQueue_initializeIntervalIfNeeded=function _(){__classPrivateFieldGet$1(this,_PQueue_isIntervalIgnored,"f")||__classPrivateFieldGet$1(this,_PQueue_intervalId,"f")!==void 0||(__classPrivateFieldSet(this,_PQueue_intervalId,setInterval(()=>{__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_onInterval).call(this)},__classPrivateFieldGet$1(this,_PQueue_interval,"f")),"f"),__classPrivateFieldSet(this,_PQueue_intervalEnd,Date.now()+__classPrivateFieldGet$1(this,_PQueue_interval,"f"),"f"))},_PQueue_onInterval=function _(){__classPrivateFieldGet$1(this,_PQueue_intervalCount,"f")===0&&__classPrivateFieldGet$1(this,_PQueue_pendingCount,"f")===0&&__classPrivateFieldGet$1(this,_PQueue_intervalId,"f")&&(clearInterval(__classPrivateFieldGet$1(this,_PQueue_intervalId,"f")),__classPrivateFieldSet(this,_PQueue_intervalId,void 0,"f")),__classPrivateFieldSet(this,_PQueue_intervalCount,__classPrivateFieldGet$1(this,_PQueue_carryoverConcurrencyCount,"f")?__classPrivateFieldGet$1(this,_PQueue_pendingCount,"f"):0,"f"),__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_processQueue).call(this)},_PQueue_processQueue=function _(){for(;__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this););},_PQueue_onEvent=async function _(a,$){return new Promise(j=>{const _e=()=>{$&&!$()||(this.off(a,_e),j())};this.on(a,_e)})};var error={};class TimeoutError$4 extends Error{constructor(a="Request timed out"){super(a),this.name="TimeoutError"}}error.TimeoutError=TimeoutError$4;class AbortError$5 extends Error{constructor(a="The operation was aborted."){super(a),this.name="AbortError"}}error.AbortError=AbortError$5;class HTTPError$1 extends Error{constructor(a){super(a.statusText),this.name="HTTPError",this.response=a}}error.HTTPError=HTTPError$1;var fetch_browser$1={exports:{}},src$5={exports:{}},browser$4={exports:{}},hasRequiredBrowser;function requireBrowser(){return hasRequiredBrowser||(hasRequiredBrowser=1,function(_,a){var $=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof{}<"u")return{};throw new Error("unable to locate ({}) object")};$(),_.exports=a={}.fetch,{}.fetch&&(a.default={}.fetch.bind({})),a.Headers={}.Headers,a.Request={}.Request,a.Response={}.Response}(browser$4,browser$4.exports)),browser$4.exports}globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?src$5.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:src$5.exports={default:requireBrowser().default,Headers:requireBrowser().Headers,Request:requireBrowser().Request,Response:requireBrowser().Response};(function(_){_.exports=src$5.exports})(fetch_browser$1);const{TimeoutError:TimeoutError$3,AbortError:AbortError$4}=error,{Response:Response$1,Request:Request$2,Headers:Headers$1,default:fetch$2}=fetch_browser$1.exports,fetchWithProgress=(_,a={})=>{const $=new XMLHttpRequest;$.open(a.method||"GET",_.toString(),!0);const{timeout:j,headers:_e}=a;if(j&&j>0&&j<1/0&&($.timeout=j),a.overrideMimeType!=null&&$.overrideMimeType(a.overrideMimeType),_e)for(const[et,tt]of new Headers$1(_e))$.setRequestHeader(et,tt);return a.signal&&(a.signal.onabort=()=>$.abort()),a.onUploadProgress&&($.upload.onprogress=a.onUploadProgress),$.responseType="arraybuffer",new Promise((et,tt)=>{const rt=nt=>{switch(nt.type){case"error":{et(Response$1.error());break}case"load":{et(new ResponseWithURL($.responseURL,$.response,{status:$.status,statusText:$.statusText,headers:parseHeaders($.getAllResponseHeaders())}));break}case"timeout":{tt(new TimeoutError$3);break}case"abort":{tt(new AbortError$4);break}}};$.onerror=rt,$.onload=rt,$.ontimeout=rt,$.onabort=rt,$.send(a.body)})},fetchWithStreaming=fetch$2,fetchWith=(_,a={})=>a.onUploadProgress!=null?fetchWithProgress(_,a):fetchWithStreaming(_,a),parseHeaders=_=>{const a=new Headers$1;for(const $ of _.trim().split(/[\r\n]+/)){const j=$.indexOf(": ");j>0&&a.set($.slice(0,j),$.slice(j+1))}return a};class ResponseWithURL extends Response$1{constructor(a,$,j){super($,j),Object.defineProperty(this,"url",{value:a})}}var fetch_browser={fetch:fetchWith,Request:Request$2,Headers:Headers$1};const require$$2=getAugmentedNamespace(mergeOptions$f),{fetch:fetch$1,Request:Request$1,Headers}=fetch_browser,{TimeoutError:TimeoutError$2,HTTPError}=error,merge$4=require$$2.bind({ignoreUndefined:!0}),{URL:URL$1,URLSearchParams:URLSearchParams$1}=isoUrl,anySignal=anySignal$2.exports,timeout=(_,a,$)=>{if(a===void 0)return _;const j=Date.now(),_e=()=>Date.now()-j>=a;return new Promise((et,tt)=>{const rt=setTimeout(()=>{_e()&&(tt(new TimeoutError$2),$.abort())},a),nt=it=>ot=>{if(clearTimeout(rt),_e()){tt(new TimeoutError$2);return}it(ot)};_.then(nt(et),nt(tt))})},defaults={throwHttpErrors:!0,credentials:"same-origin"};class HTTP{constructor(a={}){this.opts=merge$4(defaults,a)}async fetch(a,$={}){const j=merge$4(this.opts,$),_e=new Headers(j.headers);if(typeof a!="string"&&!(a instanceof URL$1||a instanceof Request$1))throw new TypeError("`resource` must be a string, URL, or Request");const et=new URL$1(a.toString(),j.base),{searchParams:tt,transformSearchParams:rt,json:nt}=j;tt&&(typeof rt=="function"?et.search=rt(new URLSearchParams$1(j.searchParams)):et.search=new URLSearchParams$1(j.searchParams)),nt&&(j.body=JSON.stringify(j.json),_e.set("content-type","application/json"));const it=new AbortController,st=anySignal([it.signal,j.signal]),ot=await timeout(fetch$1(et.toString(),{...j,signal:st,timeout:void 0,headers:_e}),j.timeout,it);if(!ot.ok&&j.throwHttpErrors)throw j.handleError&&await j.handleError(ot),new HTTPError(ot);return ot.iterator=async function*(){yield*fromStream(ot.body)},ot.ndjson=async function*(){for await(const at of ndjson(ot.iterator()))$.transform?yield $.transform(at):yield at},ot}post(a,$={}){return this.fetch(a,{...$,method:"POST"})}get(a,$={}){return this.fetch(a,{...$,method:"GET"})}put(a,$={}){return this.fetch(a,{...$,method:"PUT"})}delete(a,$={}){return this.fetch(a,{...$,method:"DELETE"})}options(a,$={}){return this.fetch(a,{...$,method:"OPTIONS"})}}const ndjson=async function*(_){const a=new TextDecoder;let $="";for await(const j of _){$+=a.decode(j,{stream:!0});const _e=$.split(/\r?\n/);for(let et=0;et<_e.length-1;et++){const tt=_e[et].trim();tt.length>0&&(yield JSON.parse(tt))}$=_e[_e.length-1]}$+=a.decode(),$=$.trim(),$.length!==0&&(yield JSON.parse($))},fromStream=_=>{if(isNodeReadableStream(_)){const a=_[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:a.next.bind(a),return($){return _.destroy(),typeof a.return=="function"?a.return():Promise.resolve({done:!0,value:$})}}}}}if(isWebReadableStream(_)){const a=_.getReader();return async function*(){try{for(;;){const{done:$,value:j}=await a.read();if($)return;j&&(yield j)}}finally{a.releaseLock()}}()}if(isAsyncIterable$1(_))return _;throw new TypeError("Body can't be converted to AsyncIterable")},isAsyncIterable$1=_=>typeof _=="object"&&_!==null&&typeof _[Symbol.asyncIterator]=="function",isWebReadableStream=_=>_&&typeof _.getReader=="function",isNodeReadableStream=_=>Object.prototype.hasOwnProperty.call(_,"readable")&&Object.prototype.hasOwnProperty.call(_,"writable");HTTP.HTTPError=HTTPError;HTTP.TimeoutError=TimeoutError$2;HTTP.streamToAsyncIterator=fromStream;HTTP.post=(_,a)=>new HTTP(a).post(_,a);HTTP.get=(_,a)=>new HTTP(a).get(_,a);HTTP.put=(_,a)=>new HTTP(a).put(_,a);HTTP.delete=(_,a)=>new HTTP(a).delete(_,a);HTTP.options=(_,a)=>new HTTP(a).options(_,a);var http=HTTP;const cache$2=new TLRU$1(1e3),ttl=60*1e3,Queue$3=PQueue.default?PQueue.default:PQueue,httpQueue$1=new Queue$3({concurrency:4}),ipfsPath=_=>{if(_.Path)return _.Path;throw new Error(_.Message)};async function resolveDnslink(_,a){return(async(j,_e={})=>{const et=new URLSearchParams(_e);et.set("arg",j);const tt=et.toString();if(!_e.nocache&&cache$2.has(tt)){const nt=cache$2.get(tt);return ipfsPath(nt)}const rt=await httpQueue$1.add(async()=>{const nt=await http.get("https://ipfs.io/api/v0/dns",{searchParams:et}),it=new URL(nt.url).search.slice(1),st=await nt.json();return cache$2.set(it,st,ttl),st});return ipfsPath(rt)})(_,a)}function fqdnFixups(_){return _.endsWith(".eth")&&(_=_.replace(/.eth$/,".eth.link")),_}function createDns$1(){return withTimeoutOption(async(a,$={recursive:!0})=>{if(typeof a!="string")throw new Error("Invalid arguments, domain must be a string");return a=fqdnFixups(a),resolveDnslink(a,$)})}function createIsOnline$1({network:_}){return()=>{const a=_.try();return a!=null&&Boolean(a.libp2p.isStarted())}}const symbol$4=Symbol.for("@libp2p/peer-id");function isPeerId(_){return _!=null&&Boolean(_[symbol$4])}const baseDecoder=Object.values(bases$2).map(_=>_.decoder).reduce((_,a)=>_.or(a),bases$2.identity.decoder),LIBP2P_KEY_CODE=114,MARSHALLED_ED225519_PUBLIC_KEY_LENGTH=36,MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH=37;class PeerIdImpl{constructor(a){this.type=a.type,this.multihash=a.multihash,this.privateKey=a.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[symbol$4](){return!0}toString(){return this.string==null&&(this.string=base58btc$2.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return CID.createV1(LIBP2P_KEY_CODE,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(a){if(a instanceof Uint8Array)return equals$1(this.multihash.bytes,a);if(typeof a=="string")return peerIdFromString(a).equals(this);if(a?.multihash?.bytes!=null)return equals$1(this.multihash.bytes,a.multihash.bytes);throw new Error("not valid Id")}}class RSAPeerIdImpl extends PeerIdImpl{constructor(a){super({...a,type:"RSA"}),this.type="RSA",this.publicKey=a.publicKey}}class Ed25519PeerIdImpl extends PeerIdImpl{constructor(a){super({...a,type:"Ed25519"}),this.type="Ed25519",this.publicKey=a.multihash.digest}}class Secp256k1PeerIdImpl extends PeerIdImpl{constructor(a){super({...a,type:"secp256k1"}),this.type="secp256k1",this.publicKey=a.multihash.digest}}function peerIdFromPeerId(_){if(_.type==="RSA")return new RSAPeerIdImpl(_);if(_.type==="Ed25519")return new Ed25519PeerIdImpl(_);if(_.type==="secp256k1")return new Secp256k1PeerIdImpl(_);throw errCode(new Error("Not a PeerId"),"ERR_INVALID_PARAMETERS")}function peerIdFromString(_,a){if(_.charAt(0)==="1"||_.charAt(0)==="Q"){const $=decode$n(base58btc$2.decode(`z${_}`));return _.startsWith("12D")?new Ed25519PeerIdImpl({multihash:$}):_.startsWith("16U")?new Secp256k1PeerIdImpl({multihash:$}):new RSAPeerIdImpl({multihash:$})}return peerIdFromBytes(baseDecoder.decode(_))}function peerIdFromBytes(_){try{const a=decode$n(_);if(a.code===identity$8.code){if(a.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH)return new Ed25519PeerIdImpl({multihash:a});if(a.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH)return new Secp256k1PeerIdImpl({multihash:a})}if(a.code===sha256$4.code)return new RSAPeerIdImpl({multihash:a})}catch{return peerIdFromCID(CID.decode(_))}throw new Error("Supplied PeerID CID is invalid")}function peerIdFromCID(_){if(_==null||_.multihash==null||_.version==null||_.version===1&&_.code!==LIBP2P_KEY_CODE)throw new Error("Supplied PeerID CID is invalid");const a=_.multihash;if(a.code===sha256$4.code)return new RSAPeerIdImpl({multihash:_.multihash});if(a.code===identity$8.code){if(a.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH)return new Ed25519PeerIdImpl({multihash:_.multihash});if(a.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH)return new Secp256k1PeerIdImpl({multihash:_.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function peerIdFromKeys(_,a){return _.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH?new Ed25519PeerIdImpl({multihash:create$a(identity$8.code,_),privateKey:a}):_.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH?new Secp256k1PeerIdImpl({multihash:create$a(identity$8.code,_),privateKey:a}):new RSAPeerIdImpl({multihash:await sha256$4.digest(_),publicKey:_,privateKey:a})}function createResolve$5({repo:_,codecs:a,bases:$,name:j}){async function _e(et,tt={}){if(!path(et))throw new Error("invalid argument "+et);if(ipnsPath(et))for await(const dt of j.resolve(et,tt))et=dt;const[,rt,nt,...it]=et.split("/"),st=tt.cidBase?await $.getBase(tt.cidBase):void 0,ot=parseBytes(nt);if(it.length===0){const dt=st?st.encoder.encode(ot):nt;return`/${rt}/${dt}`}const at=CID.decode(ot);et=it.join("/");const lt=resolve$5(at,et,a,_,tt);let ct=at,ut=et;for await(const dt of lt)CID.asCID(dt.value)&&(ct=dt.value,ut=dt.remainderPath);return`/ipfs/${ct.toString(st&&st.encoder)}${ut?"/"+ut:""}`}return withTimeoutOption(_e)}function parseBytes(_){try{return peerIdFromString(_).toBytes()}catch{return CID.parse(_).bytes}}async function last(_){let a;for await(const $ of _)a=$;return a}function createAdd$7({addAll:_}){return(a,$={})=>{let j;const _e=CID.asCID(a);return _e?j=_([{cid:_e,...$}],$):j=_([{path:a.toString(),...$}],$),last(j)}}async function*normaliseInput$3(_){if(_==null)throw errCode(new Error(`Unexpected input: ${_}`),"ERR_UNEXPECTED_INPUT");const a=CID.asCID(_);if(a){yield toPin$2({cid:a});return}if(_ instanceof String||typeof _=="string"){yield toPin$2({path:_});return}if(_.cid!=null||_.path!=null)return yield toPin$2(_);if(Symbol.iterator in _){const $=_[Symbol.iterator](),j=$.next();if(j.done)return $;if(CID.asCID(j.value)||j.value instanceof String||typeof j.value=="string"){yield toPin$2({cid:j.value});for(const _e of $)yield toPin$2({cid:_e});return}if(j.value.cid!=null||j.value.path!=null){yield toPin$2(j.value);for(const _e of $)yield toPin$2(_e);return}throw errCode(new Error("Unexpected input: "+typeof _),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in _){const $=_[Symbol.asyncIterator](),j=await $.next();if(j.done)return $;if(CID.asCID(j.value)||j.value instanceof String||typeof j.value=="string"){yield toPin$2({cid:j.value});for await(const _e of $)yield toPin$2({cid:_e});return}if(j.value.cid!=null||j.value.path!=null){yield toPin$2(j.value);for await(const _e of $)yield toPin$2(_e);return}throw errCode(new Error("Unexpected input: "+typeof _),"ERR_UNEXPECTED_INPUT")}throw errCode(new Error("Unexpected input: "+typeof _),"ERR_UNEXPECTED_INPUT")}function toPin$2(_){const a=_.cid||`${_.path}`;if(!a)throw errCode(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const $={path:a,recursive:_.recursive!==!1};return _.metadata!=null&&($.metadata=_.metadata),$}const PinTypes$1={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};function createAddAll$3({repo:_,codecs:a}){async function*$(j,_e={}){const et=async function*(){for await(const{path:nt,recursive:it,metadata:st}of normaliseInput$3(j)){const{cid:ot}=await resolvePath$1(_,a,nt),{reason:at}=await _.pins.isPinnedWithType(ot,[PinTypes$1.recursive,PinTypes$1.direct]);if(at==="recursive"&&!it)throw new Error(`${ot} already pinned recursively`);it?await _.pins.pinRecursively(ot,{metadata:st}):await _.pins.pinDirectly(ot,{metadata:st}),yield ot}};if(!Boolean(_e.lock)){yield*et();return}const rt=await _.gcLock.readLock();try{yield*et()}finally{rt()}}return withTimeoutOption($)}function toPin$1(_,a,$){const j={type:_,cid:a};return $&&(j.metadata=$),j}function createLs$9({repo:_,codecs:a}){async function*$(j={}){let _e=PinTypes$1.all;if(j.type&&(_e=j.type,!Object.keys(PinTypes$1).includes(_e)))throw errCode(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(j.paths){let et=!1;for await(const{path:tt}of normaliseInput$3(j.paths)){const{cid:rt}=await resolvePath$1(_,a,tt),{reason:nt,pinned:it,parent:st,metadata:ot}=await _.pins.isPinnedWithType(rt,_e);if(!it)throw errCode(new Error(`path '${tt}' is not pinned`),"ERR_NOT_PINNED");switch(nt){case PinTypes$1.direct:case PinTypes$1.recursive:et=!0,yield toPin$1(nt,rt,ot);break;default:et=!0,yield toPin$1(`${PinTypes$1.indirect} through ${st}`,rt,ot)}}if(!et)throw new Error("No match found");return}if(_e===PinTypes$1.recursive||_e===PinTypes$1.all)for await(const{cid:et,metadata:tt}of _.pins.recursiveKeys())yield toPin$1(PinTypes$1.recursive,et,tt);if(_e===PinTypes$1.indirect||_e===PinTypes$1.all)for await(const et of _.pins.indirectKeys(j))yield toPin$1(PinTypes$1.indirect,et);if(_e===PinTypes$1.direct||_e===PinTypes$1.all)for await(const{cid:et,metadata:tt}of _.pins.directKeys())yield toPin$1(PinTypes$1.direct,et,tt)}return withTimeoutOption($)}function createRm$b({rmAll:_}){async function a($,j={}){const _e=await last(_([{path:$,...j}],j));if(!_e)throw new Error("CID expected");return _e}return a}function createRmAll$2({repo:_,codecs:a}){async function*$(j,_e={}){const et=await _.gcLock.readLock();try{for await(const{path:tt,recursive:rt}of normaliseInput$3(j)){const{cid:nt}=await resolvePath$1(_,a,tt),{pinned:it,reason:st}=await _.pins.isPinnedWithType(nt,PinTypes$1.all);if(!it)throw new Error(`${nt} is not pinned`);switch(st){case PinTypes$1.recursive:if(!rt)throw new Error(`${nt} is pinned recursively`);await _.pins.unpin(nt),yield nt;break;case PinTypes$1.direct:await _.pins.unpin(nt),yield nt;break;default:throw new Error(`${nt} is pinned indirectly under ${st}`)}}}finally{et()}}return withTimeoutOption($)}class PinAPI{constructor({codecs:a,repo:$}){const j=createAddAll$3({codecs:a,repo:$});this.addAll=j,this.add=createAdd$7({addAll:j});const _e=createRmAll$2({codecs:a,repo:$});this.rmAll=_e,this.rm=createRm$b({rmAll:_e}),this.ls=createLs$9({codecs:a,repo:$}),this.remote={add:(et,tt={})=>Promise.reject(new Error("Not implemented")),ls:async function*(et,tt={}){return Promise.reject(new Error("Not implemented"))},rm:(et,tt={})=>Promise.reject(new Error("Not implemented")),rmAll:(et,tt={})=>Promise.reject(new Error("Not implemented")),service:{add:(et,tt)=>Promise.reject(new Error("Not implemented")),rm:(et,tt={})=>Promise.reject(new Error("Not implemented")),ls:(et={})=>Promise.reject(new Error("Not implemented"))}}}}function dbOpenFailedError(_){return _=_||new Error("Cannot open database"),errCode(_,"ERR_DB_OPEN_FAILED")}function dbDeleteFailedError(_){return _=_||new Error("Delete failed"),errCode(_,"ERR_DB_DELETE_FAILED")}function dbWriteFailedError(_){return _=_||new Error("Write failed"),errCode(_,"ERR_DB_WRITE_FAILED")}function notFoundError$1(_){return _=_||new Error("Not Found"),errCode(_,"ERR_NOT_FOUND")}var timestamp={exports:{}};/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */(function(_){(function(){_.exports=pt;var a=24*3600,$=3200,j=(365*400+97)*$/400,_e=a*j,et=_e*1e3,tt=1e3*1e4*1e4*a,rt=16777216,nt=65536*65536,it=1e3*1e3,st=1e3*1e3*1e3,ot="000000000",at=Math.trunc||Nt,lt=pt.prototype;pt.fromDate=Lt,pt.fromInt64BE=Tt(0,1,2,3,0,4),pt.fromInt64LE=Tt(3,2,1,0,4,0),pt.fromString=It,pt.fromTimeT=Mt,lt.year=0,lt.time=0,lt.nano=0,lt.addNano=ht,lt.getNano=St,lt.getTimeT=kt,lt.getYear=yt,lt.toDate=_t,lt.toJSON=gt,lt.toString=Et,lt.writeInt64BE=xt(0,1,2,3,0,4),lt.writeInt64LE=xt(3,2,1,0,4,0);var ct="%Y-%m-%dT%H:%M:%S.%NZ",ut=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dt=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ft={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return pt;function pt(Rt,Gt,Pt){var Ft=this;if(!(Ft instanceof pt))return new pt(Rt,Gt,Pt);Ft.time=+Rt||0,Ft.nano=+Gt||0,Ft.year=+Pt||0,mt(Ft)}function yt(){var Rt=this.toDate().getUTCFullYear();return Rt+this.year}function mt(Rt){var Gt=Rt.year,Pt=Rt.time,Ft=Rt.nano,jt,Vt;if(Ft<0||it<=Ft){var Wt=Math.floor(Ft/it);Ft-=Wt*it,Pt+=Wt,jt=1}var Qt=Gt%$;if(Pt<-tt||tt<Pt||Qt){Vt=at(Pt/et),Vt&&(Gt+=Vt*$,Pt-=Vt*et);var qt=vt(Pt);qt.setUTCFullYear(Qt+qt.getUTCFullYear()),Gt-=Qt,Pt=+qt,Vt=at(Gt/$);var Yt=Pt+Vt*et;Vt&&-tt<=Yt&&Yt<=tt&&(Gt-=Vt*$,Pt=Yt),jt=1}return jt&&(Rt.year=Gt,Rt.time=Pt,Rt.nano=Ft),Rt}function _t(){var Rt=mt(this);return vt(Rt.time)}function vt(Rt){var Gt=new Date(0);return Gt.setTime(Rt),Gt}function ht(Rt){return this.nano+=+Rt||0,this}function St(){var Rt=mt(this);return(Rt.time%1e3*it+ +Rt.nano+st)%st}function It(Rt){var Gt,Pt=new pt;Rt+="";var Ft=Rt.replace(/^\s*[+\-]?\d+/,function(jt){var Vt=+jt,Wt=1970+(Vt-1970)%400;return Pt.year=Vt-Wt,Wt}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(jt,Vt,Wt){return Vt<0&&(Wt*=-1),Gt=(+Vt*60+ +Wt)*6e4,""}).replace(/\.\d+$/,function(jt){return Pt.nano=+(jt+ot).substr(1,9),""}).split(/\D+/);if(Ft.length>1?Ft[1]--:Ft[1]=0,Pt.time=Gt=Date.UTC.apply(Date,Ft)-(Gt||0),isNaN(Gt))throw new TypeError("Invalid Date");return mt(Pt)}function Lt(Rt){return new pt(+Rt)}function Mt(Rt){return Kt(Rt,0)}function Kt(Rt,Gt){Gt|=0,Gt*=nt,Rt=+Rt||0;var Pt=at(Gt/_e)+at(Rt/_e),Ft=Gt%_e+Rt%_e,jt=at(Ft/_e);return jt&&(Pt+=jt,Ft-=jt*_e),new pt(Ft*1e3,0,Pt*$)}function kt(){var Rt=mt(this),Gt=Math.floor(Rt.time/1e3),Pt=Rt.year;return Pt&&(Gt+=Pt*j*a/$),Gt}function gt(){return this.toString().replace(/0{1,6}Z$/,"Z")}function Et(Rt){var Gt=this,Pt=Gt.toDate(),Ft={H:Yt,L:tr,M:Xt,N:Dr,S:Zt,Y:Vt,a:fr,b:hr,d:Qt,e:qt,m:Wt};return jt(Rt||ct);function jt(Or){return Or.replace(/%./g,function(lr){var ir=lr[1],dr=ft[ir],ar=Ft[ir];return dr?jt(dr):ar?ar():lr})}function Vt(){var Or=Gt.getYear();return Or>999999?"+"+Or:Or>9999?"+"+bt(Or,6):Or>=0?bt(Or,4):Or>=-999999?"-"+bt(-Or,6):Or}function Wt(){return Ot(Pt.getUTCMonth()+1)}function Qt(){return Ot(Pt.getUTCDate())}function qt(){return Bt(Pt.getUTCDate())}function Yt(){return Ot(Pt.getUTCHours())}function Xt(){return Ot(Pt.getUTCMinutes())}function Zt(){return Ot(Pt.getUTCSeconds())}function tr(){return bt(Pt.getUTCMilliseconds(),3)}function Dr(){return bt(Gt.getNano(),9)}function fr(){return dt[Pt.getUTCDay()]}function hr(){return ut[Pt.getUTCMonth()]}}function xt(Rt,Gt,Pt,Ft,jt,Vt){return Wt;function Wt(qt,Yt){var Xt=mt(this);qt||(qt=new Array(8)),At(qt,Yt|=0);var Zt=Math.floor(Xt.time/1e3),tr=Xt.year*(j*a/$),Dr=at(tr/nt)+at(Zt/nt),fr=tr%nt+Zt%nt,hr=Math.floor(fr/nt);return hr&&(Dr+=hr,fr-=hr*nt),Qt(qt,Yt+jt,Dr),Qt(qt,Yt+Vt,fr),qt}function Qt(qt,Yt,Xt){qt[Yt+Rt]=Xt>>24&255,qt[Yt+Gt]=Xt>>16&255,qt[Yt+Pt]=Xt>>8&255,qt[Yt+Ft]=Xt&255}}function Tt(Rt,Gt,Pt,Ft,jt,Vt){return Wt;function Wt(qt,Yt){At(qt,Yt|=0);var Xt=Qt(qt,Yt+jt),Zt=Qt(qt,Yt+Vt);return Kt(Zt,Xt)}function Qt(qt,Yt){return qt[Yt+Rt]*rt+(qt[Yt+Gt]<<16|qt[Yt+Pt]<<8|qt[Yt+Ft])}}function At(Rt,Gt){var Pt=Rt&&Rt.length;if(Pt==null)throw new TypeError("Invalid Buffer");if(Pt<Gt+8)throw new RangeError("Out of range")}function Nt(Rt){var Gt=Rt-Rt%1;return Gt===0&&(Rt<0||Rt===0&&1/Rt!==1/0)?-0:Gt}function Bt(Rt){return(Rt>9?"":" ")+(Rt|0)}function Ot(Rt){return(Rt>9?"":"0")+(Rt|0)}function bt(Rt,Gt){return(ot+(Rt|0)).substr(-Gt)}})()})(timestamp);const NanoDate=timestamp.exports;var minimalExports=requireMinimal$2();function configure$1(){minimalExports._configure(),reader$3._configure(reader_buffer$1),writer$2._configure(writer_buffer$1)}configure$1();const methods=["uint64","int64","sint64","fixed64","sfixed64"];function patchReader(_){for(const a of methods){if(_[a]==null)continue;const $=_[a];_[a]=function(){return BigInt($.call(this).toString())}}return _}function reader$2(_){return patchReader(new reader$3(_))}function patchWriter(_){for(const a of methods){if(_[a]==null)continue;const $=_[a];_[a]=function(j){return $.call(this,j.toString())}}return _}function writer$1(){return patchWriter(writer$2.create())}function decodeMessage(_,a){const $=reader$2(_ instanceof Uint8Array?_:_.subarray());return a.decode($)}function encodeMessage(_,a){const $=writer$1();return a.encode(_,$,{lengthDelimited:!1}),$.finish()}var CODEC_TYPES;(function(_){_[_.VARINT=0]="VARINT",_[_.BIT64=1]="BIT64",_[_.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",_[_.START_GROUP=3]="START_GROUP",_[_.END_GROUP=4]="END_GROUP",_[_.BIT32=5]="BIT32"})(CODEC_TYPES||(CODEC_TYPES={}));function createCodec$2(_,a,$,j){return{name:_,type:a,encode:$,decode:j}}function enumeration(_){function a(_e){if(_[_e.toString()]==null)throw new Error("Invalid enum value");return _[_e]}const $=function(et,tt){const rt=a(et);tt.int32(rt)},j=function(et){const tt=et.int32();return a(tt)};return createCodec$2("enum",CODEC_TYPES.VARINT,$,j)}function message(_,a){return createCodec$2("message",CODEC_TYPES.LENGTH_DELIMITED,_,a)}var KeyType;(function(_){_.RSA="RSA",_.Ed25519="Ed25519",_.Secp256k1="Secp256k1"})(KeyType||(KeyType={}));var __KeyTypeValues;(function(_){_[_.RSA=0]="RSA",_[_.Ed25519=1]="Ed25519",_[_.Secp256k1=2]="Secp256k1"})(__KeyTypeValues||(__KeyTypeValues={}));(function(_){_.codec=()=>enumeration(__KeyTypeValues)})(KeyType||(KeyType={}));var PublicKey;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{_e.lengthDelimited!==!1&&j.fork(),$.Type!=null&&(j.uint32(8),KeyType.codec().encode($.Type,j)),$.Data!=null&&(j.uint32(18),j.bytes($.Data)),_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.Type=KeyType.codec().decode($);break;case 2:_e.Data=$.bytes();break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(PublicKey||(PublicKey={}));var PrivateKey;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{_e.lengthDelimited!==!1&&j.fork(),$.Type!=null&&(j.uint32(8),KeyType.codec().encode($.Type,j)),$.Data!=null&&(j.uint32(18),j.bytes($.Data)),_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.Type=KeyType.codec().decode($);break;case 2:_e.Data=$.bytes();break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(PrivateKey||(PrivateKey={}));var forge$s={options:{usePureJavaScript:!1}},util$2={exports:{}},api={},baseN$1=api,_reverseAlphabets={};api.encode=function(_,a,$){if(typeof a!="string")throw new TypeError('"alphabet" must be a string.');if($!==void 0&&typeof $!="number")throw new TypeError('"maxline" must be a number.');var j="";if(!(_ instanceof Uint8Array))j=_encodeWithByteBuffer(_,a);else{var _e=0,et=a.length,tt=a.charAt(0),rt=[0];for(_e=0;_e<_.length;++_e){for(var nt=0,it=_[_e];nt<rt.length;++nt)it+=rt[nt]<<8,rt[nt]=it%et,it=it/et|0;for(;it>0;)rt.push(it%et),it=it/et|0}for(_e=0;_[_e]===0&&_e<_.length-1;++_e)j+=tt;for(_e=rt.length-1;_e>=0;--_e)j+=a[rt[_e]]}if($){var st=new RegExp(".{1,"+$+"}","g");j=j.match(st).join(`\r
`)}return j};api.decode=function(_,a){if(typeof _!="string")throw new TypeError('"input" must be a string.');if(typeof a!="string")throw new TypeError('"alphabet" must be a string.');var $=_reverseAlphabets[a];if(!$){$=_reverseAlphabets[a]=[];for(var j=0;j<a.length;++j)$[a.charCodeAt(j)]=j}_=_.replace(/\s/g,"");for(var _e=a.length,et=a.charAt(0),tt=[0],j=0;j<_.length;j++){var rt=$[_.charCodeAt(j)];if(rt===void 0)return;for(var nt=0,it=rt;nt<tt.length;++nt)it+=tt[nt]*_e,tt[nt]=it&255,it>>=8;for(;it>0;)tt.push(it&255),it>>=8}for(var st=0;_[st]===et&&st<_.length-1;++st)tt.push(0);return typeof Buffer<"u"?Buffer.from(tt.reverse()):new Uint8Array(tt.reverse())};function _encodeWithByteBuffer(_,a){var $=0,j=a.length,_e=a.charAt(0),et=[0];for($=0;$<_.length();++$){for(var tt=0,rt=_.at($);tt<et.length;++tt)rt+=et[tt]<<8,et[tt]=rt%j,rt=rt/j|0;for(;rt>0;)et.push(rt%j),rt=rt/j|0}var nt="";for($=0;_.at($)===0&&$<_.length()-1;++$)nt+=_e;for($=et.length-1;$>=0;--$)nt+=a[et[$]];return nt}var forge$r=forge$s,baseN=baseN$1,util$1=util$2.exports=forge$r.util=forge$r.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){util$1.nextTick=process.nextTick,typeof setImmediate=="function"?util$1.setImmediate=setImmediate:util$1.setImmediate=util$1.nextTick;return}if(typeof setImmediate=="function"){util$1.setImmediate=function(){return setImmediate.apply(void 0,arguments)},util$1.nextTick=function(rt){return setImmediate(rt)};return}if(util$1.setImmediate=function(rt){setTimeout(rt,0)},typeof window<"u"&&typeof window.postMessage=="function"){let rt=function(nt){if(nt.source===window&&nt.data===_){nt.stopPropagation();var it=a.slice();a.length=0,it.forEach(function(st){st()})}};var tt=rt,_="forge.setImmediate",a=[];util$1.setImmediate=function(nt){a.push(nt),a.length===1&&window.postMessage(_,"*")},window.addEventListener("message",rt,!0)}if(typeof MutationObserver<"u"){var $=Date.now(),j=!0,_e=document.createElement("div"),a=[];new MutationObserver(function(){var nt=a.slice();a.length=0,nt.forEach(function(it){it()})}).observe(_e,{attributes:!0});var et=util$1.setImmediate;util$1.setImmediate=function(nt){Date.now()-$>15?($=Date.now(),et(nt)):(a.push(nt),a.length===1&&_e.setAttribute("a",j=!j))}}util$1.nextTick=util$1.setImmediate})();util$1.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;util$1.globalScope=function(){return util$1.isNodejs?{}:typeof self>"u"?window:self}();util$1.isArray=Array.isArray||function(_){return Object.prototype.toString.call(_)==="[object Array]"};util$1.isArrayBuffer=function(_){return typeof ArrayBuffer<"u"&&_ instanceof ArrayBuffer};util$1.isArrayBufferView=function(_){return _&&util$1.isArrayBuffer(_.buffer)&&_.byteLength!==void 0};function _checkBitsParam(_){if(!(_===8||_===16||_===24||_===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+_)}util$1.ByteBuffer=ByteStringBuffer;function ByteStringBuffer(_){if(this.data="",this.read=0,typeof _=="string")this.data=_;else if(util$1.isArrayBuffer(_)||util$1.isArrayBufferView(_))if(typeof Buffer<"u"&&_ instanceof Buffer)this.data=_.toString("binary");else{var a=new Uint8Array(_);try{this.data=String.fromCharCode.apply(null,a)}catch{for(var $=0;$<a.length;++$)this.putByte(a[$])}}else(_ instanceof ByteStringBuffer||typeof _=="object"&&typeof _.data=="string"&&typeof _.read=="number")&&(this.data=_.data,this.read=_.read);this._constructedStringLength=0}util$1.ByteStringBuffer=ByteStringBuffer;var _MAX_CONSTRUCTED_STRING_LENGTH=4096;util$1.ByteStringBuffer.prototype._optimizeConstructedString=function(_){this._constructedStringLength+=_,this._constructedStringLength>_MAX_CONSTRUCTED_STRING_LENGTH&&(this.data.substr(0,1),this._constructedStringLength=0)};util$1.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};util$1.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};util$1.ByteStringBuffer.prototype.putByte=function(_){return this.putBytes(String.fromCharCode(_))};util$1.ByteStringBuffer.prototype.fillWithByte=function(_,a){_=String.fromCharCode(_);for(var $=this.data;a>0;)a&1&&($+=_),a>>>=1,a>0&&(_+=_);return this.data=$,this._optimizeConstructedString(a),this};util$1.ByteStringBuffer.prototype.putBytes=function(_){return this.data+=_,this._optimizeConstructedString(_.length),this};util$1.ByteStringBuffer.prototype.putString=function(_){return this.putBytes(util$1.encodeUtf8(_))};util$1.ByteStringBuffer.prototype.putInt16=function(_){return this.putBytes(String.fromCharCode(_>>8&255)+String.fromCharCode(_&255))};util$1.ByteStringBuffer.prototype.putInt24=function(_){return this.putBytes(String.fromCharCode(_>>16&255)+String.fromCharCode(_>>8&255)+String.fromCharCode(_&255))};util$1.ByteStringBuffer.prototype.putInt32=function(_){return this.putBytes(String.fromCharCode(_>>24&255)+String.fromCharCode(_>>16&255)+String.fromCharCode(_>>8&255)+String.fromCharCode(_&255))};util$1.ByteStringBuffer.prototype.putInt16Le=function(_){return this.putBytes(String.fromCharCode(_&255)+String.fromCharCode(_>>8&255))};util$1.ByteStringBuffer.prototype.putInt24Le=function(_){return this.putBytes(String.fromCharCode(_&255)+String.fromCharCode(_>>8&255)+String.fromCharCode(_>>16&255))};util$1.ByteStringBuffer.prototype.putInt32Le=function(_){return this.putBytes(String.fromCharCode(_&255)+String.fromCharCode(_>>8&255)+String.fromCharCode(_>>16&255)+String.fromCharCode(_>>24&255))};util$1.ByteStringBuffer.prototype.putInt=function(_,a){_checkBitsParam(a);var $="";do a-=8,$+=String.fromCharCode(_>>a&255);while(a>0);return this.putBytes($)};util$1.ByteStringBuffer.prototype.putSignedInt=function(_,a){return _<0&&(_+=2<<a-1),this.putInt(_,a)};util$1.ByteStringBuffer.prototype.putBuffer=function(_){return this.putBytes(_.getBytes())};util$1.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};util$1.ByteStringBuffer.prototype.getInt16=function(){var _=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,_};util$1.ByteStringBuffer.prototype.getInt24=function(){var _=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,_};util$1.ByteStringBuffer.prototype.getInt32=function(){var _=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,_};util$1.ByteStringBuffer.prototype.getInt16Le=function(){var _=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,_};util$1.ByteStringBuffer.prototype.getInt24Le=function(){var _=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,_};util$1.ByteStringBuffer.prototype.getInt32Le=function(){var _=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,_};util$1.ByteStringBuffer.prototype.getInt=function(_){_checkBitsParam(_);var a=0;do a=(a<<8)+this.data.charCodeAt(this.read++),_-=8;while(_>0);return a};util$1.ByteStringBuffer.prototype.getSignedInt=function(_){var a=this.getInt(_),$=2<<_-2;return a>=$&&(a-=$<<1),a};util$1.ByteStringBuffer.prototype.getBytes=function(_){var a;return _?(_=Math.min(this.length(),_),a=this.data.slice(this.read,this.read+_),this.read+=_):_===0?a="":(a=this.read===0?this.data:this.data.slice(this.read),this.clear()),a};util$1.ByteStringBuffer.prototype.bytes=function(_){return typeof _>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+_)};util$1.ByteStringBuffer.prototype.at=function(_){return this.data.charCodeAt(this.read+_)};util$1.ByteStringBuffer.prototype.setAt=function(_,a){return this.data=this.data.substr(0,this.read+_)+String.fromCharCode(a)+this.data.substr(this.read+_+1),this};util$1.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};util$1.ByteStringBuffer.prototype.copy=function(){var _=util$1.createBuffer(this.data);return _.read=this.read,_};util$1.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};util$1.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};util$1.ByteStringBuffer.prototype.truncate=function(_){var a=Math.max(0,this.length()-_);return this.data=this.data.substr(this.read,a),this.read=0,this};util$1.ByteStringBuffer.prototype.toHex=function(){for(var _="",a=this.read;a<this.data.length;++a){var $=this.data.charCodeAt(a);$<16&&(_+="0"),_+=$.toString(16)}return _};util$1.ByteStringBuffer.prototype.toString=function(){return util$1.decodeUtf8(this.bytes())};function DataBuffer(_,a){a=a||{},this.read=a.readOffset||0,this.growSize=a.growSize||1024;var $=util$1.isArrayBuffer(_),j=util$1.isArrayBufferView(_);if($||j){$?this.data=new DataView(_):this.data=new DataView(_.buffer,_.byteOffset,_.byteLength),this.write="writeOffset"in a?a.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,_!=null&&this.putBytes(_),"writeOffset"in a&&(this.write=a.writeOffset)}util$1.DataBuffer=DataBuffer;util$1.DataBuffer.prototype.length=function(){return this.write-this.read};util$1.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};util$1.DataBuffer.prototype.accommodate=function(_,a){if(this.length()>=_)return this;a=Math.max(a||this.growSize,_);var $=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),j=new Uint8Array(this.length()+a);return j.set($),this.data=new DataView(j.buffer),this};util$1.DataBuffer.prototype.putByte=function(_){return this.accommodate(1),this.data.setUint8(this.write++,_),this};util$1.DataBuffer.prototype.fillWithByte=function(_,a){this.accommodate(a);for(var $=0;$<a;++$)this.data.setUint8(_);return this};util$1.DataBuffer.prototype.putBytes=function(_,a){if(util$1.isArrayBufferView(_)){var $=new Uint8Array(_.buffer,_.byteOffset,_.byteLength),j=$.byteLength-$.byteOffset;this.accommodate(j);var _e=new Uint8Array(this.data.buffer,this.write);return _e.set($),this.write+=j,this}if(util$1.isArrayBuffer(_)){var $=new Uint8Array(_);this.accommodate($.byteLength);var _e=new Uint8Array(this.data.buffer);return _e.set($,this.write),this.write+=$.byteLength,this}if(_ instanceof util$1.DataBuffer||typeof _=="object"&&typeof _.read=="number"&&typeof _.write=="number"&&util$1.isArrayBufferView(_.data)){var $=new Uint8Array(_.data.byteLength,_.read,_.length());this.accommodate($.byteLength);var _e=new Uint8Array(_.data.byteLength,this.write);return _e.set($),this.write+=$.byteLength,this}if(_ instanceof util$1.ByteStringBuffer&&(_=_.data,a="binary"),a=a||"binary",typeof _=="string"){var et;if(a==="hex")return this.accommodate(Math.ceil(_.length/2)),et=new Uint8Array(this.data.buffer,this.write),this.write+=util$1.binary.hex.decode(_,et,this.write),this;if(a==="base64")return this.accommodate(Math.ceil(_.length/4)*3),et=new Uint8Array(this.data.buffer,this.write),this.write+=util$1.binary.base64.decode(_,et,this.write),this;if(a==="utf8"&&(_=util$1.encodeUtf8(_),a="binary"),a==="binary"||a==="raw")return this.accommodate(_.length),et=new Uint8Array(this.data.buffer,this.write),this.write+=util$1.binary.raw.decode(et),this;if(a==="utf16")return this.accommodate(_.length*2),et=new Uint16Array(this.data.buffer,this.write),this.write+=util$1.text.utf16.encode(et),this;throw new Error("Invalid encoding: "+a)}throw Error("Invalid parameter: "+_)};util$1.DataBuffer.prototype.putBuffer=function(_){return this.putBytes(_),_.clear(),this};util$1.DataBuffer.prototype.putString=function(_){return this.putBytes(_,"utf16")};util$1.DataBuffer.prototype.putInt16=function(_){return this.accommodate(2),this.data.setInt16(this.write,_),this.write+=2,this};util$1.DataBuffer.prototype.putInt24=function(_){return this.accommodate(3),this.data.setInt16(this.write,_>>8&65535),this.data.setInt8(this.write,_>>16&255),this.write+=3,this};util$1.DataBuffer.prototype.putInt32=function(_){return this.accommodate(4),this.data.setInt32(this.write,_),this.write+=4,this};util$1.DataBuffer.prototype.putInt16Le=function(_){return this.accommodate(2),this.data.setInt16(this.write,_,!0),this.write+=2,this};util$1.DataBuffer.prototype.putInt24Le=function(_){return this.accommodate(3),this.data.setInt8(this.write,_>>16&255),this.data.setInt16(this.write,_>>8&65535,!0),this.write+=3,this};util$1.DataBuffer.prototype.putInt32Le=function(_){return this.accommodate(4),this.data.setInt32(this.write,_,!0),this.write+=4,this};util$1.DataBuffer.prototype.putInt=function(_,a){_checkBitsParam(a),this.accommodate(a/8);do a-=8,this.data.setInt8(this.write++,_>>a&255);while(a>0);return this};util$1.DataBuffer.prototype.putSignedInt=function(_,a){return _checkBitsParam(a),this.accommodate(a/8),_<0&&(_+=2<<a-1),this.putInt(_,a)};util$1.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};util$1.DataBuffer.prototype.getInt16=function(){var _=this.data.getInt16(this.read);return this.read+=2,_};util$1.DataBuffer.prototype.getInt24=function(){var _=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,_};util$1.DataBuffer.prototype.getInt32=function(){var _=this.data.getInt32(this.read);return this.read+=4,_};util$1.DataBuffer.prototype.getInt16Le=function(){var _=this.data.getInt16(this.read,!0);return this.read+=2,_};util$1.DataBuffer.prototype.getInt24Le=function(){var _=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,_};util$1.DataBuffer.prototype.getInt32Le=function(){var _=this.data.getInt32(this.read,!0);return this.read+=4,_};util$1.DataBuffer.prototype.getInt=function(_){_checkBitsParam(_);var a=0;do a=(a<<8)+this.data.getInt8(this.read++),_-=8;while(_>0);return a};util$1.DataBuffer.prototype.getSignedInt=function(_){var a=this.getInt(_),$=2<<_-2;return a>=$&&(a-=$<<1),a};util$1.DataBuffer.prototype.getBytes=function(_){var a;return _?(_=Math.min(this.length(),_),a=this.data.slice(this.read,this.read+_),this.read+=_):_===0?a="":(a=this.read===0?this.data:this.data.slice(this.read),this.clear()),a};util$1.DataBuffer.prototype.bytes=function(_){return typeof _>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+_)};util$1.DataBuffer.prototype.at=function(_){return this.data.getUint8(this.read+_)};util$1.DataBuffer.prototype.setAt=function(_,a){return this.data.setUint8(_,a),this};util$1.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};util$1.DataBuffer.prototype.copy=function(){return new util$1.DataBuffer(this)};util$1.DataBuffer.prototype.compact=function(){if(this.read>0){var _=new Uint8Array(this.data.buffer,this.read),a=new Uint8Array(_.byteLength);a.set(_),this.data=new DataView(a),this.write-=this.read,this.read=0}return this};util$1.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};util$1.DataBuffer.prototype.truncate=function(_){return this.write=Math.max(0,this.length()-_),this.read=Math.min(this.read,this.write),this};util$1.DataBuffer.prototype.toHex=function(){for(var _="",a=this.read;a<this.data.byteLength;++a){var $=this.data.getUint8(a);$<16&&(_+="0"),_+=$.toString(16)}return _};util$1.DataBuffer.prototype.toString=function(_){var a=new Uint8Array(this.data,this.read,this.length());if(_=_||"utf8",_==="binary"||_==="raw")return util$1.binary.raw.encode(a);if(_==="hex")return util$1.binary.hex.encode(a);if(_==="base64")return util$1.binary.base64.encode(a);if(_==="utf8")return util$1.text.utf8.decode(a);if(_==="utf16")return util$1.text.utf16.decode(a);throw new Error("Invalid encoding: "+_)};util$1.createBuffer=function(_,a){return a=a||"raw",_!==void 0&&a==="utf8"&&(_=util$1.encodeUtf8(_)),new util$1.ByteBuffer(_)};util$1.fillString=function(_,a){for(var $="";a>0;)a&1&&($+=_),a>>>=1,a>0&&(_+=_);return $};util$1.xorBytes=function(_,a,$){for(var j="",_e="",et="",tt=0,rt=0;$>0;--$,++tt)_e=_.charCodeAt(tt)^a.charCodeAt(tt),rt>=10&&(j+=et,et="",rt=0),et+=String.fromCharCode(_e),++rt;return j+=et,j};util$1.hexToBytes=function(_){var a="",$=0;for(_.length&!0&&($=1,a+=String.fromCharCode(parseInt(_[0],16)));$<_.length;$+=2)a+=String.fromCharCode(parseInt(_.substr($,2),16));return a};util$1.bytesToHex=function(_){return util$1.createBuffer(_).toHex()};util$1.int32ToBytes=function(_){return String.fromCharCode(_>>24&255)+String.fromCharCode(_>>16&255)+String.fromCharCode(_>>8&255)+String.fromCharCode(_&255)};var _base64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_base64Idx=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],_base58="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";util$1.encode64=function(_,a){for(var $="",j="",_e,et,tt,rt=0;rt<_.length;)_e=_.charCodeAt(rt++),et=_.charCodeAt(rt++),tt=_.charCodeAt(rt++),$+=_base64.charAt(_e>>2),$+=_base64.charAt((_e&3)<<4|et>>4),isNaN(et)?$+="==":($+=_base64.charAt((et&15)<<2|tt>>6),$+=isNaN(tt)?"=":_base64.charAt(tt&63)),a&&$.length>a&&(j+=$.substr(0,a)+`\r
`,$=$.substr(a));return j+=$,j};util$1.decode64=function(_){_=_.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var a="",$,j,_e,et,tt=0;tt<_.length;)$=_base64Idx[_.charCodeAt(tt++)-43],j=_base64Idx[_.charCodeAt(tt++)-43],_e=_base64Idx[_.charCodeAt(tt++)-43],et=_base64Idx[_.charCodeAt(tt++)-43],a+=String.fromCharCode($<<2|j>>4),_e!==64&&(a+=String.fromCharCode((j&15)<<4|_e>>2),et!==64&&(a+=String.fromCharCode((_e&3)<<6|et)));return a};util$1.encodeUtf8=function(_){return unescape(encodeURIComponent(_))};util$1.decodeUtf8=function(_){return decodeURIComponent(escape(_))};util$1.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:baseN.encode,decode:baseN.decode}};util$1.binary.raw.encode=function(_){return String.fromCharCode.apply(null,_)};util$1.binary.raw.decode=function(_,a,$){var j=a;j||(j=new Uint8Array(_.length)),$=$||0;for(var _e=$,et=0;et<_.length;++et)j[_e++]=_.charCodeAt(et);return a?_e-$:j};util$1.binary.hex.encode=util$1.bytesToHex;util$1.binary.hex.decode=function(_,a,$){var j=a;j||(j=new Uint8Array(Math.ceil(_.length/2))),$=$||0;var _e=0,et=$;for(_.length&1&&(_e=1,j[et++]=parseInt(_[0],16));_e<_.length;_e+=2)j[et++]=parseInt(_.substr(_e,2),16);return a?et-$:j};util$1.binary.base64.encode=function(_,a){for(var $="",j="",_e,et,tt,rt=0;rt<_.byteLength;)_e=_[rt++],et=_[rt++],tt=_[rt++],$+=_base64.charAt(_e>>2),$+=_base64.charAt((_e&3)<<4|et>>4),isNaN(et)?$+="==":($+=_base64.charAt((et&15)<<2|tt>>6),$+=isNaN(tt)?"=":_base64.charAt(tt&63)),a&&$.length>a&&(j+=$.substr(0,a)+`\r
`,$=$.substr(a));return j+=$,j};util$1.binary.base64.decode=function(_,a,$){var j=a;j||(j=new Uint8Array(Math.ceil(_.length/4)*3)),_=_.replace(/[^A-Za-z0-9\+\/\=]/g,""),$=$||0;for(var _e,et,tt,rt,nt=0,it=$;nt<_.length;)_e=_base64Idx[_.charCodeAt(nt++)-43],et=_base64Idx[_.charCodeAt(nt++)-43],tt=_base64Idx[_.charCodeAt(nt++)-43],rt=_base64Idx[_.charCodeAt(nt++)-43],j[it++]=_e<<2|et>>4,tt!==64&&(j[it++]=(et&15)<<4|tt>>2,rt!==64&&(j[it++]=(tt&3)<<6|rt));return a?it-$:j.subarray(0,it)};util$1.binary.base58.encode=function(_,a){return util$1.binary.baseN.encode(_,_base58,a)};util$1.binary.base58.decode=function(_,a){return util$1.binary.baseN.decode(_,_base58,a)};util$1.text={utf8:{},utf16:{}};util$1.text.utf8.encode=function(_,a,$){_=util$1.encodeUtf8(_);var j=a;j||(j=new Uint8Array(_.length)),$=$||0;for(var _e=$,et=0;et<_.length;++et)j[_e++]=_.charCodeAt(et);return a?_e-$:j};util$1.text.utf8.decode=function(_){return util$1.decodeUtf8(String.fromCharCode.apply(null,_))};util$1.text.utf16.encode=function(_,a,$){var j=a;j||(j=new Uint8Array(_.length*2));var _e=new Uint16Array(j.buffer);$=$||0;for(var et=$,tt=$,rt=0;rt<_.length;++rt)_e[tt++]=_.charCodeAt(rt),et+=2;return a?et-$:j};util$1.text.utf16.decode=function(_){return String.fromCharCode.apply(null,new Uint16Array(_.buffer))};util$1.deflate=function(_,a,$){if(a=util$1.decode64(_.deflate(util$1.encode64(a)).rval),$){var j=2,_e=a.charCodeAt(1);_e&32&&(j=6),a=a.substring(j,a.length-4)}return a};util$1.inflate=function(_,a,$){var j=_.inflate(util$1.encode64(a)).rval;return j===null?null:util$1.decode64(j)};var _setStorageObject=function(_,a,$){if(!_)throw new Error("WebStorage not available.");var j;if($===null?j=_.removeItem(a):($=util$1.encode64(JSON.stringify($)),j=_.setItem(a,$)),typeof j<"u"&&j.rval!==!0){var _e=new Error(j.error.message);throw _e.id=j.error.id,_e.name=j.error.name,_e}},_getStorageObject=function(_,a){if(!_)throw new Error("WebStorage not available.");var $=_.getItem(a);if(_.init)if($.rval===null){if($.error){var j=new Error($.error.message);throw j.id=$.error.id,j.name=$.error.name,j}$=null}else $=$.rval;return $!==null&&($=JSON.parse(util$1.decode64($))),$},_setItem=function(_,a,$,j){var _e=_getStorageObject(_,a);_e===null&&(_e={}),_e[$]=j,_setStorageObject(_,a,_e)},_getItem=function(_,a,$){var j=_getStorageObject(_,a);return j!==null&&(j=$ in j?j[$]:null),j},_removeItem=function(_,a,$){var j=_getStorageObject(_,a);if(j!==null&&$ in j){delete j[$];var _e=!0;for(var et in j){_e=!1;break}_e&&(j=null),_setStorageObject(_,a,j)}},_clearItems=function(_,a){_setStorageObject(_,a,null)},_callStorageFunction=function(_,a,$){var j=null;typeof $>"u"&&($=["web","flash"]);var _e,et=!1,tt=null;for(var rt in $){_e=$[rt];try{if(_e==="flash"||_e==="both"){if(a[0]===null)throw new Error("Flash local storage not available.");j=_.apply(this,a),et=_e==="flash"}(_e==="web"||_e==="both")&&(a[0]=localStorage,j=_.apply(this,a),et=!0)}catch(nt){tt=nt}if(et)break}if(!et)throw tt;return j};util$1.setItem=function(_,a,$,j,_e){_callStorageFunction(_setItem,arguments,_e)};util$1.getItem=function(_,a,$,j){return _callStorageFunction(_getItem,arguments,j)};util$1.removeItem=function(_,a,$,j){_callStorageFunction(_removeItem,arguments,j)};util$1.clearItems=function(_,a,$){_callStorageFunction(_clearItems,arguments,$)};util$1.isEmpty=function(_){for(var a in _)if(_.hasOwnProperty(a))return!1;return!0};util$1.format=function(_){for(var a=/%./g,$,j,_e=0,et=[],tt=0;$=a.exec(_);){j=_.substring(tt,a.lastIndex-2),j.length>0&&et.push(j),tt=a.lastIndex;var rt=$[0][1];switch(rt){case"s":case"o":_e<arguments.length?et.push(arguments[_e+++1]):et.push("<?>");break;case"%":et.push("%");break;default:et.push("<%"+rt+"?>")}}return et.push(_.substring(tt)),et.join("")};util$1.formatNumber=function(_,a,$,j){var _e=_,et=isNaN(a=Math.abs(a))?2:a,tt=$===void 0?",":$,rt=j===void 0?".":j,nt=_e<0?"-":"",it=parseInt(_e=Math.abs(+_e||0).toFixed(et),10)+"",st=it.length>3?it.length%3:0;return nt+(st?it.substr(0,st)+rt:"")+it.substr(st).replace(/(\d{3})(?=\d)/g,"$1"+rt)+(et?tt+Math.abs(_e-it).toFixed(et).slice(2):"")};util$1.formatSize=function(_){return _>=1073741824?_=util$1.formatNumber(_/1073741824,2,".","")+" GiB":_>=1048576?_=util$1.formatNumber(_/1048576,2,".","")+" MiB":_>=1024?_=util$1.formatNumber(_/1024,0)+" KiB":_=util$1.formatNumber(_,0)+" bytes",_};util$1.bytesFromIP=function(_){return _.indexOf(".")!==-1?util$1.bytesFromIPv4(_):_.indexOf(":")!==-1?util$1.bytesFromIPv6(_):null};util$1.bytesFromIPv4=function(_){if(_=_.split("."),_.length!==4)return null;for(var a=util$1.createBuffer(),$=0;$<_.length;++$){var j=parseInt(_[$],10);if(isNaN(j))return null;a.putByte(j)}return a.getBytes()};util$1.bytesFromIPv6=function(_){var a=0;_=_.split(":").filter(function(tt){return tt.length===0&&++a,!0});for(var $=(8-_.length+a)*2,j=util$1.createBuffer(),_e=0;_e<8;++_e){if(!_[_e]||_[_e].length===0){j.fillWithByte(0,$),$=0;continue}var et=util$1.hexToBytes(_[_e]);et.length<2&&j.putByte(0),j.putBytes(et)}return j.getBytes()};util$1.bytesToIP=function(_){return _.length===4?util$1.bytesToIPv4(_):_.length===16?util$1.bytesToIPv6(_):null};util$1.bytesToIPv4=function(_){if(_.length!==4)return null;for(var a=[],$=0;$<_.length;++$)a.push(_.charCodeAt($));return a.join(".")};util$1.bytesToIPv6=function(_){if(_.length!==16)return null;for(var a=[],$=[],j=0,_e=0;_e<_.length;_e+=2){for(var et=util$1.bytesToHex(_[_e]+_[_e+1]);et[0]==="0"&&et!=="0";)et=et.substr(1);if(et==="0"){var tt=$[$.length-1],rt=a.length;!tt||rt!==tt.end+1?$.push({start:rt,end:rt}):(tt.end=rt,tt.end-tt.start>$[j].end-$[j].start&&(j=$.length-1))}a.push(et)}if($.length>0){var nt=$[j];nt.end-nt.start>0&&(a.splice(nt.start,nt.end-nt.start+1,""),nt.start===0&&a.unshift(""),nt.end===7&&a.push(""))}return a.join(":")};util$1.estimateCores=function(_,a){if(typeof _=="function"&&(a=_,_={}),_=_||{},"cores"in util$1&&!_.update)return a(null,util$1.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return util$1.cores=navigator.hardwareConcurrency,a(null,util$1.cores);if(typeof Worker>"u")return util$1.cores=1,a(null,util$1.cores);if(typeof Blob>"u")return util$1.cores=2,a(null,util$1.cores);var $=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(tt){var rt=Date.now(),nt=rt+4;self.postMessage({st:rt,et:nt})})}.toString(),")()"],{type:"application/javascript"}));j([],5,16);function j(tt,rt,nt){if(rt===0){var it=Math.floor(tt.reduce(function(st,ot){return st+ot},0)/tt.length);return util$1.cores=Math.max(1,it),URL.revokeObjectURL($),a(null,util$1.cores)}_e(nt,function(st,ot){tt.push(et(nt,ot)),j(tt,rt-1,nt)})}function _e(tt,rt){for(var nt=[],it=[],st=0;st<tt;++st){var ot=new Worker($);ot.addEventListener("message",function(at){if(it.push(at.data),it.length===tt){for(var lt=0;lt<tt;++lt)nt[lt].terminate();rt(null,it)}}),nt.push(ot)}for(var st=0;st<tt;++st)nt[st].postMessage(st)}function et(tt,rt){for(var nt=[],it=0;it<tt;++it)for(var st=rt[it],ot=nt[it]=[],at=0;at<tt;++at)if(it!==at){var lt=rt[at];(st.st>lt.st&&st.st<lt.et||lt.st>st.st&&lt.st<st.et)&&ot.push(at)}return nt.reduce(function(ct,ut){return Math.max(ct,ut.length)},0)}};var forge$q=forge$s;forge$q.pki=forge$q.pki||{};var oids$2=forge$q.pki.oids=forge$q.oids=forge$q.oids||{};function _IN(_,a){oids$2[_]=a,oids$2[a]=_}function _I_(_,a){oids$2[_]=a}_IN("1.2.840.113549.1.1.1","rsaEncryption");_IN("1.2.840.113549.1.1.4","md5WithRSAEncryption");_IN("1.2.840.113549.1.1.5","sha1WithRSAEncryption");_IN("1.2.840.113549.1.1.7","RSAES-OAEP");_IN("1.2.840.113549.1.1.8","mgf1");_IN("1.2.840.113549.1.1.9","pSpecified");_IN("1.2.840.113549.1.1.10","RSASSA-PSS");_IN("1.2.840.113549.1.1.11","sha256WithRSAEncryption");_IN("1.2.840.113549.1.1.12","sha384WithRSAEncryption");_IN("1.2.840.113549.1.1.13","sha512WithRSAEncryption");_IN("1.3.101.112","EdDSA25519");_IN("1.2.840.10040.4.3","dsa-with-sha1");_IN("1.3.14.3.2.7","desCBC");_IN("1.3.14.3.2.26","sha1");_IN("1.3.14.3.2.29","sha1WithRSASignature");_IN("2.16.840.1.101.3.4.2.1","sha256");_IN("2.16.840.1.101.3.4.2.2","sha384");_IN("2.16.840.1.101.3.4.2.3","sha512");_IN("2.16.840.1.101.3.4.2.4","sha224");_IN("2.16.840.1.101.3.4.2.5","sha512-224");_IN("2.16.840.1.101.3.4.2.6","sha512-256");_IN("1.2.840.113549.2.2","md2");_IN("1.2.840.113549.2.5","md5");_IN("1.2.840.113549.1.7.1","data");_IN("1.2.840.113549.1.7.2","signedData");_IN("1.2.840.113549.1.7.3","envelopedData");_IN("1.2.840.113549.1.7.4","signedAndEnvelopedData");_IN("1.2.840.113549.1.7.5","digestedData");_IN("1.2.840.113549.1.7.6","encryptedData");_IN("1.2.840.113549.1.9.1","emailAddress");_IN("1.2.840.113549.1.9.2","unstructuredName");_IN("1.2.840.113549.1.9.3","contentType");_IN("1.2.840.113549.1.9.4","messageDigest");_IN("1.2.840.113549.1.9.5","signingTime");_IN("1.2.840.113549.1.9.6","counterSignature");_IN("1.2.840.113549.1.9.7","challengePassword");_IN("1.2.840.113549.1.9.8","unstructuredAddress");_IN("1.2.840.113549.1.9.14","extensionRequest");_IN("1.2.840.113549.1.9.20","friendlyName");_IN("1.2.840.113549.1.9.21","localKeyId");_IN("1.2.840.113549.1.9.22.1","x509Certificate");_IN("1.2.840.113549.1.12.10.1.1","keyBag");_IN("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");_IN("1.2.840.113549.1.12.10.1.3","certBag");_IN("1.2.840.113549.1.12.10.1.4","crlBag");_IN("1.2.840.113549.1.12.10.1.5","secretBag");_IN("1.2.840.113549.1.12.10.1.6","safeContentsBag");_IN("1.2.840.113549.1.5.13","pkcs5PBES2");_IN("1.2.840.113549.1.5.12","pkcs5PBKDF2");_IN("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");_IN("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");_IN("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");_IN("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");_IN("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");_IN("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");_IN("1.2.840.113549.2.7","hmacWithSHA1");_IN("1.2.840.113549.2.8","hmacWithSHA224");_IN("1.2.840.113549.2.9","hmacWithSHA256");_IN("1.2.840.113549.2.10","hmacWithSHA384");_IN("1.2.840.113549.2.11","hmacWithSHA512");_IN("1.2.840.113549.3.7","des-EDE3-CBC");_IN("2.16.840.1.101.3.4.1.2","aes128-CBC");_IN("2.16.840.1.101.3.4.1.22","aes192-CBC");_IN("2.16.840.1.101.3.4.1.42","aes256-CBC");_IN("2.5.4.3","commonName");_IN("2.5.4.4","surname");_IN("2.5.4.5","serialNumber");_IN("2.5.4.6","countryName");_IN("2.5.4.7","localityName");_IN("2.5.4.8","stateOrProvinceName");_IN("2.5.4.9","streetAddress");_IN("2.5.4.10","organizationName");_IN("2.5.4.11","organizationalUnitName");_IN("2.5.4.12","title");_IN("2.5.4.13","description");_IN("2.5.4.15","businessCategory");_IN("2.5.4.17","postalCode");_IN("2.5.4.42","givenName");_IN("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");_IN("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");_IN("2.16.840.1.113730.1.1","nsCertType");_IN("2.16.840.1.113730.1.13","nsComment");_I_("2.5.29.1","authorityKeyIdentifier");_I_("2.5.29.2","keyAttributes");_I_("2.5.29.3","certificatePolicies");_I_("2.5.29.4","keyUsageRestriction");_I_("2.5.29.5","policyMapping");_I_("2.5.29.6","subtreesConstraint");_I_("2.5.29.7","subjectAltName");_I_("2.5.29.8","issuerAltName");_I_("2.5.29.9","subjectDirectoryAttributes");_I_("2.5.29.10","basicConstraints");_I_("2.5.29.11","nameConstraints");_I_("2.5.29.12","policyConstraints");_I_("2.5.29.13","basicConstraints");_IN("2.5.29.14","subjectKeyIdentifier");_IN("2.5.29.15","keyUsage");_I_("2.5.29.16","privateKeyUsagePeriod");_IN("2.5.29.17","subjectAltName");_IN("2.5.29.18","issuerAltName");_IN("2.5.29.19","basicConstraints");_I_("2.5.29.20","cRLNumber");_I_("2.5.29.21","cRLReason");_I_("2.5.29.22","expirationDate");_I_("2.5.29.23","instructionCode");_I_("2.5.29.24","invalidityDate");_I_("2.5.29.25","cRLDistributionPoints");_I_("2.5.29.26","issuingDistributionPoint");_I_("2.5.29.27","deltaCRLIndicator");_I_("2.5.29.28","issuingDistributionPoint");_I_("2.5.29.29","certificateIssuer");_I_("2.5.29.30","nameConstraints");_IN("2.5.29.31","cRLDistributionPoints");_IN("2.5.29.32","certificatePolicies");_I_("2.5.29.33","policyMappings");_I_("2.5.29.34","policyConstraints");_IN("2.5.29.35","authorityKeyIdentifier");_I_("2.5.29.36","policyConstraints");_IN("2.5.29.37","extKeyUsage");_I_("2.5.29.46","freshestCRL");_I_("2.5.29.54","inhibitAnyPolicy");_IN("1.3.6.1.4.1.11129.2.4.2","timestampList");_IN("1.3.6.1.5.5.7.1.1","authorityInfoAccess");_IN("1.3.6.1.5.5.7.3.1","serverAuth");_IN("1.3.6.1.5.5.7.3.2","clientAuth");_IN("1.3.6.1.5.5.7.3.3","codeSigning");_IN("1.3.6.1.5.5.7.3.4","emailProtection");_IN("1.3.6.1.5.5.7.3.8","timeStamping");var forge$p=forge$s,asn1$5=forge$p.asn1=forge$p.asn1||{};asn1$5.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};asn1$5.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};asn1$5.create=function(_,a,$,j,_e){if(forge$p.util.isArray(j)){for(var et=[],tt=0;tt<j.length;++tt)j[tt]!==void 0&&et.push(j[tt]);j=et}var rt={tagClass:_,type:a,constructed:$,composed:$||forge$p.util.isArray(j),value:j};return _e&&"bitStringContents"in _e&&(rt.bitStringContents=_e.bitStringContents,rt.original=asn1$5.copy(rt)),rt};asn1$5.copy=function(_,a){var $;if(forge$p.util.isArray(_)){$=[];for(var j=0;j<_.length;++j)$.push(asn1$5.copy(_[j],a));return $}return typeof _=="string"?_:($={tagClass:_.tagClass,type:_.type,constructed:_.constructed,composed:_.composed,value:asn1$5.copy(_.value,a)},a&&!a.excludeBitStringContents&&($.bitStringContents=_.bitStringContents),$)};asn1$5.equals=function(_,a,$){if(forge$p.util.isArray(_)){if(!forge$p.util.isArray(a)||_.length!==a.length)return!1;for(var j=0;j<_.length;++j)if(!asn1$5.equals(_[j],a[j]))return!1;return!0}if(typeof _!=typeof a)return!1;if(typeof _=="string")return _===a;var _e=_.tagClass===a.tagClass&&_.type===a.type&&_.constructed===a.constructed&&_.composed===a.composed&&asn1$5.equals(_.value,a.value);return $&&$.includeBitStringContents&&(_e=_e&&_.bitStringContents===a.bitStringContents),_e};asn1$5.getBerValueLength=function(_){var a=_.getByte();if(a!==128){var $,j=a&128;return j?$=_.getInt((a&127)<<3):$=a,$}};function _checkBufferLength(_,a,$){if($>a){var j=new Error("Too few bytes to parse DER.");throw j.available=_.length(),j.remaining=a,j.requested=$,j}}var _getValueLength=function(_,a){var $=_.getByte();if(a--,$!==128){var j,_e=$&128;if(!_e)j=$;else{var et=$&127;_checkBufferLength(_,a,et),j=_.getInt(et<<3)}if(j<0)throw new Error("Negative length: "+j);return j}};asn1$5.fromDer=function(_,a){a===void 0&&(a={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof a=="boolean"&&(a={strict:a,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in a||(a.strict=!0),"parseAllBytes"in a||(a.parseAllBytes=!0),"decodeBitStrings"in a||(a.decodeBitStrings=!0),typeof _=="string"&&(_=forge$p.util.createBuffer(_));var $=_.length(),j=_fromDer(_,_.length(),0,a);if(a.parseAllBytes&&_.length()!==0){var _e=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw _e.byteCount=$,_e.remaining=_.length(),_e}return j};function _fromDer(_,a,$,j){var _e;_checkBufferLength(_,a,2);var et=_.getByte();a--;var tt=et&192,rt=et&31;_e=_.length();var nt=_getValueLength(_,a);if(a-=_e-_.length(),nt!==void 0&&nt>a){if(j.strict){var it=new Error("Too few bytes to read ASN.1 value.");throw it.available=_.length(),it.remaining=a,it.requested=nt,it}nt=a}var st,ot,at=(et&32)===32;if(at)if(st=[],nt===void 0)for(;;){if(_checkBufferLength(_,a,2),_.bytes(2)===String.fromCharCode(0,0)){_.getBytes(2),a-=2;break}_e=_.length(),st.push(_fromDer(_,a,$+1,j)),a-=_e-_.length()}else for(;nt>0;)_e=_.length(),st.push(_fromDer(_,nt,$+1,j)),a-=_e-_.length(),nt-=_e-_.length();if(st===void 0&&tt===asn1$5.Class.UNIVERSAL&&rt===asn1$5.Type.BITSTRING&&(ot=_.bytes(nt)),st===void 0&&j.decodeBitStrings&&tt===asn1$5.Class.UNIVERSAL&&rt===asn1$5.Type.BITSTRING&&nt>1){var lt=_.read,ct=a,ut=0;if(rt===asn1$5.Type.BITSTRING&&(_checkBufferLength(_,a,1),ut=_.getByte(),a--),ut===0)try{_e=_.length();var dt={strict:!0,decodeBitStrings:!0},ft=_fromDer(_,a,$+1,dt),pt=_e-_.length();a-=pt,rt==asn1$5.Type.BITSTRING&&pt++;var yt=ft.tagClass;pt===nt&&(yt===asn1$5.Class.UNIVERSAL||yt===asn1$5.Class.CONTEXT_SPECIFIC)&&(st=[ft])}catch{}st===void 0&&(_.read=lt,a=ct)}if(st===void 0){if(nt===void 0){if(j.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");nt=a}if(rt===asn1$5.Type.BMPSTRING)for(st="";nt>0;nt-=2)_checkBufferLength(_,a,2),st+=String.fromCharCode(_.getInt16()),a-=2;else st=_.getBytes(nt),a-=nt}var mt=ot===void 0?null:{bitStringContents:ot};return asn1$5.create(tt,rt,at,st,mt)}asn1$5.toDer=function(_){var a=forge$p.util.createBuffer(),$=_.tagClass|_.type,j=forge$p.util.createBuffer(),_e=!1;if("bitStringContents"in _&&(_e=!0,_.original&&(_e=asn1$5.equals(_,_.original))),_e)j.putBytes(_.bitStringContents);else if(_.composed){_.constructed?$|=32:j.putByte(0);for(var et=0;et<_.value.length;++et)_.value[et]!==void 0&&j.putBuffer(asn1$5.toDer(_.value[et]))}else if(_.type===asn1$5.Type.BMPSTRING)for(var et=0;et<_.value.length;++et)j.putInt16(_.value.charCodeAt(et));else _.type===asn1$5.Type.INTEGER&&_.value.length>1&&(_.value.charCodeAt(0)===0&&(_.value.charCodeAt(1)&128)===0||_.value.charCodeAt(0)===255&&(_.value.charCodeAt(1)&128)===128)?j.putBytes(_.value.substr(1)):j.putBytes(_.value);if(a.putByte($),j.length()<=127)a.putByte(j.length()&127);else{var tt=j.length(),rt="";do rt+=String.fromCharCode(tt&255),tt=tt>>>8;while(tt>0);a.putByte(rt.length|128);for(var et=rt.length-1;et>=0;--et)a.putByte(rt.charCodeAt(et))}return a.putBuffer(j),a};asn1$5.oidToDer=function(_){var a=_.split("."),$=forge$p.util.createBuffer();$.putByte(40*parseInt(a[0],10)+parseInt(a[1],10));for(var j,_e,et,tt,rt=2;rt<a.length;++rt){j=!0,_e=[],et=parseInt(a[rt],10);do tt=et&127,et=et>>>7,j||(tt|=128),_e.push(tt),j=!1;while(et>0);for(var nt=_e.length-1;nt>=0;--nt)$.putByte(_e[nt])}return $};asn1$5.derToOid=function(_){var a;typeof _=="string"&&(_=forge$p.util.createBuffer(_));var $=_.getByte();a=Math.floor($/40)+"."+$%40;for(var j=0;_.length()>0;)$=_.getByte(),j=j<<7,$&128?j+=$&127:(a+="."+(j+$),j=0);return a};asn1$5.utcTimeToDate=function(_){var a=new Date,$=parseInt(_.substr(0,2),10);$=$>=50?1900+$:2e3+$;var j=parseInt(_.substr(2,2),10)-1,_e=parseInt(_.substr(4,2),10),et=parseInt(_.substr(6,2),10),tt=parseInt(_.substr(8,2),10),rt=0;if(_.length>11){var nt=_.charAt(10),it=10;nt!=="+"&&nt!=="-"&&(rt=parseInt(_.substr(10,2),10),it+=2)}if(a.setUTCFullYear($,j,_e),a.setUTCHours(et,tt,rt,0),it&&(nt=_.charAt(it),nt==="+"||nt==="-")){var st=parseInt(_.substr(it+1,2),10),ot=parseInt(_.substr(it+4,2),10),at=st*60+ot;at*=6e4,nt==="+"?a.setTime(+a-at):a.setTime(+a+at)}return a};asn1$5.generalizedTimeToDate=function(_){var a=new Date,$=parseInt(_.substr(0,4),10),j=parseInt(_.substr(4,2),10)-1,_e=parseInt(_.substr(6,2),10),et=parseInt(_.substr(8,2),10),tt=parseInt(_.substr(10,2),10),rt=parseInt(_.substr(12,2),10),nt=0,it=0,st=!1;_.charAt(_.length-1)==="Z"&&(st=!0);var ot=_.length-5,at=_.charAt(ot);if(at==="+"||at==="-"){var lt=parseInt(_.substr(ot+1,2),10),ct=parseInt(_.substr(ot+4,2),10);it=lt*60+ct,it*=6e4,at==="+"&&(it*=-1),st=!0}return _.charAt(14)==="."&&(nt=parseFloat(_.substr(14),10)*1e3),st?(a.setUTCFullYear($,j,_e),a.setUTCHours(et,tt,rt,nt),a.setTime(+a+it)):(a.setFullYear($,j,_e),a.setHours(et,tt,rt,nt)),a};asn1$5.dateToUtcTime=function(_){if(typeof _=="string")return _;var a="",$=[];$.push((""+_.getUTCFullYear()).substr(2)),$.push(""+(_.getUTCMonth()+1)),$.push(""+_.getUTCDate()),$.push(""+_.getUTCHours()),$.push(""+_.getUTCMinutes()),$.push(""+_.getUTCSeconds());for(var j=0;j<$.length;++j)$[j].length<2&&(a+="0"),a+=$[j];return a+="Z",a};asn1$5.dateToGeneralizedTime=function(_){if(typeof _=="string")return _;var a="",$=[];$.push(""+_.getUTCFullYear()),$.push(""+(_.getUTCMonth()+1)),$.push(""+_.getUTCDate()),$.push(""+_.getUTCHours()),$.push(""+_.getUTCMinutes()),$.push(""+_.getUTCSeconds());for(var j=0;j<$.length;++j)$[j].length<2&&(a+="0"),a+=$[j];return a+="Z",a};asn1$5.integerToDer=function(_){var a=forge$p.util.createBuffer();if(_>=-128&&_<128)return a.putSignedInt(_,8);if(_>=-32768&&_<32768)return a.putSignedInt(_,16);if(_>=-8388608&&_<8388608)return a.putSignedInt(_,24);if(_>=-2147483648&&_<2147483648)return a.putSignedInt(_,32);var $=new Error("Integer too large; max is 32-bits.");throw $.integer=_,$};asn1$5.derToInteger=function(_){typeof _=="string"&&(_=forge$p.util.createBuffer(_));var a=_.length()*8;if(a>32)throw new Error("Integer too large; max is 32-bits.");return _.getSignedInt(a)};asn1$5.validate=function(_,a,$,j){var _e=!1;if((_.tagClass===a.tagClass||typeof a.tagClass>"u")&&(_.type===a.type||typeof a.type>"u"))if(_.constructed===a.constructed||typeof a.constructed>"u"){if(_e=!0,a.value&&forge$p.util.isArray(a.value))for(var et=0,tt=0;_e&&tt<a.value.length;++tt)_e=a.value[tt].optional||!1,_.value[et]&&(_e=asn1$5.validate(_.value[et],a.value[tt],$,j),_e?++et:a.value[tt].optional&&(_e=!0)),!_e&&j&&j.push("["+a.name+'] Tag class "'+a.tagClass+'", type "'+a.type+'" expected value length "'+a.value.length+'", got "'+_.value.length+'"');if(_e&&$&&(a.capture&&($[a.capture]=_.value),a.captureAsn1&&($[a.captureAsn1]=_),a.captureBitStringContents&&"bitStringContents"in _&&($[a.captureBitStringContents]=_.bitStringContents),a.captureBitStringValue&&"bitStringContents"in _))if(_.bitStringContents.length<2)$[a.captureBitStringValue]="";else{var rt=_.bitStringContents.charCodeAt(0);if(rt!==0)throw new Error("captureBitStringValue only supported for zero unused bits");$[a.captureBitStringValue]=_.bitStringContents.slice(1)}}else j&&j.push("["+a.name+'] Expected constructed "'+a.constructed+'", got "'+_.constructed+'"');else j&&(_.tagClass!==a.tagClass&&j.push("["+a.name+'] Expected tag class "'+a.tagClass+'", got "'+_.tagClass+'"'),_.type!==a.type&&j.push("["+a.name+'] Expected type "'+a.type+'", got "'+_.type+'"'));return _e};var _nonLatinRegex=/[^\\u0000-\\u00ff]/;asn1$5.prettyPrint=function(_,a,$){var j="";a=a||0,$=$||2,a>0&&(j+=`
`);for(var _e="",et=0;et<a*$;++et)_e+=" ";switch(j+=_e+"Tag: ",_.tagClass){case asn1$5.Class.UNIVERSAL:j+="Universal:";break;case asn1$5.Class.APPLICATION:j+="Application:";break;case asn1$5.Class.CONTEXT_SPECIFIC:j+="Context-Specific:";break;case asn1$5.Class.PRIVATE:j+="Private:";break}if(_.tagClass===asn1$5.Class.UNIVERSAL)switch(j+=_.type,_.type){case asn1$5.Type.NONE:j+=" (None)";break;case asn1$5.Type.BOOLEAN:j+=" (Boolean)";break;case asn1$5.Type.INTEGER:j+=" (Integer)";break;case asn1$5.Type.BITSTRING:j+=" (Bit string)";break;case asn1$5.Type.OCTETSTRING:j+=" (Octet string)";break;case asn1$5.Type.NULL:j+=" (Null)";break;case asn1$5.Type.OID:j+=" (Object Identifier)";break;case asn1$5.Type.ODESC:j+=" (Object Descriptor)";break;case asn1$5.Type.EXTERNAL:j+=" (External or Instance of)";break;case asn1$5.Type.REAL:j+=" (Real)";break;case asn1$5.Type.ENUMERATED:j+=" (Enumerated)";break;case asn1$5.Type.EMBEDDED:j+=" (Embedded PDV)";break;case asn1$5.Type.UTF8:j+=" (UTF8)";break;case asn1$5.Type.ROID:j+=" (Relative Object Identifier)";break;case asn1$5.Type.SEQUENCE:j+=" (Sequence)";break;case asn1$5.Type.SET:j+=" (Set)";break;case asn1$5.Type.PRINTABLESTRING:j+=" (Printable String)";break;case asn1$5.Type.IA5String:j+=" (IA5String (ASCII))";break;case asn1$5.Type.UTCTIME:j+=" (UTC time)";break;case asn1$5.Type.GENERALIZEDTIME:j+=" (Generalized time)";break;case asn1$5.Type.BMPSTRING:j+=" (BMP String)";break}else j+=_.type;if(j+=`
`,j+=_e+"Constructed: "+_.constructed+`
`,_.composed){for(var tt=0,rt="",et=0;et<_.value.length;++et)_.value[et]!==void 0&&(tt+=1,rt+=asn1$5.prettyPrint(_.value[et],a+1,$),et+1<_.value.length&&(rt+=","));j+=_e+"Sub values: "+tt+rt}else{if(j+=_e+"Value: ",_.type===asn1$5.Type.OID){var nt=asn1$5.derToOid(_.value);j+=nt,forge$p.pki&&forge$p.pki.oids&&nt in forge$p.pki.oids&&(j+=" ("+forge$p.pki.oids[nt]+") ")}if(_.type===asn1$5.Type.INTEGER)try{j+=asn1$5.derToInteger(_.value)}catch{j+="0x"+forge$p.util.bytesToHex(_.value)}else if(_.type===asn1$5.Type.BITSTRING){if(_.value.length>1?j+="0x"+forge$p.util.bytesToHex(_.value.slice(1)):j+="(none)",_.value.length>0){var it=_.value.charCodeAt(0);it==1?j+=" (1 unused bit shown)":it>1&&(j+=" ("+it+" unused bits shown)")}}else if(_.type===asn1$5.Type.OCTETSTRING)_nonLatinRegex.test(_.value)||(j+="("+_.value+") "),j+="0x"+forge$p.util.bytesToHex(_.value);else if(_.type===asn1$5.Type.UTF8)try{j+=forge$p.util.decodeUtf8(_.value)}catch(st){if(st.message==="URI malformed")j+="0x"+forge$p.util.bytesToHex(_.value)+" (malformed UTF8)";else throw st}else _.type===asn1$5.Type.PRINTABLESTRING||_.type===asn1$5.Type.IA5String?j+=_.value:_nonLatinRegex.test(_.value)?j+="0x"+forge$p.util.bytesToHex(_.value):_.value.length===0?j+="[null]":j+=_.value}return j};var forge$o=forge$s;forge$o.cipher=forge$o.cipher||{};forge$o.cipher.algorithms=forge$o.cipher.algorithms||{};forge$o.cipher.createCipher=function(_,a){var $=_;if(typeof $=="string"&&($=forge$o.cipher.getAlgorithm($),$&&($=$())),!$)throw new Error("Unsupported algorithm: "+_);return new forge$o.cipher.BlockCipher({algorithm:$,key:a,decrypt:!1})};forge$o.cipher.createDecipher=function(_,a){var $=_;if(typeof $=="string"&&($=forge$o.cipher.getAlgorithm($),$&&($=$())),!$)throw new Error("Unsupported algorithm: "+_);return new forge$o.cipher.BlockCipher({algorithm:$,key:a,decrypt:!0})};forge$o.cipher.registerAlgorithm=function(_,a){_=_.toUpperCase(),forge$o.cipher.algorithms[_]=a};forge$o.cipher.getAlgorithm=function(_){return _=_.toUpperCase(),_ in forge$o.cipher.algorithms?forge$o.cipher.algorithms[_]:null};var BlockCipher=forge$o.cipher.BlockCipher=function(_){this.algorithm=_.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=_.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=_.decrypt,this.algorithm.initialize(_)};BlockCipher.prototype.start=function(_){_=_||{};var a={};for(var $ in _)a[$]=_[$];a.decrypt=this._decrypt,this._finish=!1,this._input=forge$o.util.createBuffer(),this.output=_.output||forge$o.util.createBuffer(),this.mode.start(a)};BlockCipher.prototype.update=function(_){for(_&&this._input.putBuffer(_);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};BlockCipher.prototype.finish=function(_){_&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function($){return _(this.blockSize,$,!1)},this.mode.unpad=function($){return _(this.blockSize,$,!0)});var a={};return a.decrypt=this._decrypt,a.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,a)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,a))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,a))};var forge$n=forge$s;forge$n.cipher=forge$n.cipher||{};var modes=forge$n.cipher.modes=forge$n.cipher.modes||{};modes.ecb=function(_){_=_||{},this.name="ECB",this.cipher=_.cipher,this.blockSize=_.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};modes.ecb.prototype.start=function(_){};modes.ecb.prototype.encrypt=function(_,a,$){if(_.length()<this.blockSize&&!($&&_.length()>0))return!0;for(var j=0;j<this._ints;++j)this._inBlock[j]=_.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var j=0;j<this._ints;++j)a.putInt32(this._outBlock[j])};modes.ecb.prototype.decrypt=function(_,a,$){if(_.length()<this.blockSize&&!($&&_.length()>0))return!0;for(var j=0;j<this._ints;++j)this._inBlock[j]=_.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var j=0;j<this._ints;++j)a.putInt32(this._outBlock[j])};modes.ecb.prototype.pad=function(_,a){var $=_.length()===this.blockSize?this.blockSize:this.blockSize-_.length();return _.fillWithByte($,$),!0};modes.ecb.prototype.unpad=function(_,a){if(a.overflow>0)return!1;var $=_.length(),j=_.at($-1);return j>this.blockSize<<2?!1:(_.truncate(j),!0)};modes.cbc=function(_){_=_||{},this.name="CBC",this.cipher=_.cipher,this.blockSize=_.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};modes.cbc.prototype.start=function(_){if(_.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in _)this._iv=transformIV(_.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};modes.cbc.prototype.encrypt=function(_,a,$){if(_.length()<this.blockSize&&!($&&_.length()>0))return!0;for(var j=0;j<this._ints;++j)this._inBlock[j]=this._prev[j]^_.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var j=0;j<this._ints;++j)a.putInt32(this._outBlock[j]);this._prev=this._outBlock};modes.cbc.prototype.decrypt=function(_,a,$){if(_.length()<this.blockSize&&!($&&_.length()>0))return!0;for(var j=0;j<this._ints;++j)this._inBlock[j]=_.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var j=0;j<this._ints;++j)a.putInt32(this._prev[j]^this._outBlock[j]);this._prev=this._inBlock.slice(0)};modes.cbc.prototype.pad=function(_,a){var $=_.length()===this.blockSize?this.blockSize:this.blockSize-_.length();return _.fillWithByte($,$),!0};modes.cbc.prototype.unpad=function(_,a){if(a.overflow>0)return!1;var $=_.length(),j=_.at($-1);return j>this.blockSize<<2?!1:(_.truncate(j),!0)};modes.cfb=function(_){_=_||{},this.name="CFB",this.cipher=_.cipher,this.blockSize=_.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=forge$n.util.createBuffer(),this._partialBytes=0};modes.cfb.prototype.start=function(_){if(!("iv"in _))throw new Error("Invalid IV parameter.");this._iv=transformIV(_.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};modes.cfb.prototype.encrypt=function(_,a,$){var j=_.length();if(j===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&j>=this.blockSize){for(var _e=0;_e<this._ints;++_e)this._inBlock[_e]=_.getInt32()^this._outBlock[_e],a.putInt32(this._inBlock[_e]);return}var et=(this.blockSize-j)%this.blockSize;et>0&&(et=this.blockSize-et),this._partialOutput.clear();for(var _e=0;_e<this._ints;++_e)this._partialBlock[_e]=_.getInt32()^this._outBlock[_e],this._partialOutput.putInt32(this._partialBlock[_e]);if(et>0)_.read-=this.blockSize;else for(var _e=0;_e<this._ints;++_e)this._inBlock[_e]=this._partialBlock[_e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),et>0&&!$)return a.putBytes(this._partialOutput.getBytes(et-this._partialBytes)),this._partialBytes=et,!0;a.putBytes(this._partialOutput.getBytes(j-this._partialBytes)),this._partialBytes=0};modes.cfb.prototype.decrypt=function(_,a,$){var j=_.length();if(j===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&j>=this.blockSize){for(var _e=0;_e<this._ints;++_e)this._inBlock[_e]=_.getInt32(),a.putInt32(this._inBlock[_e]^this._outBlock[_e]);return}var et=(this.blockSize-j)%this.blockSize;et>0&&(et=this.blockSize-et),this._partialOutput.clear();for(var _e=0;_e<this._ints;++_e)this._partialBlock[_e]=_.getInt32(),this._partialOutput.putInt32(this._partialBlock[_e]^this._outBlock[_e]);if(et>0)_.read-=this.blockSize;else for(var _e=0;_e<this._ints;++_e)this._inBlock[_e]=this._partialBlock[_e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),et>0&&!$)return a.putBytes(this._partialOutput.getBytes(et-this._partialBytes)),this._partialBytes=et,!0;a.putBytes(this._partialOutput.getBytes(j-this._partialBytes)),this._partialBytes=0};modes.ofb=function(_){_=_||{},this.name="OFB",this.cipher=_.cipher,this.blockSize=_.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=forge$n.util.createBuffer(),this._partialBytes=0};modes.ofb.prototype.start=function(_){if(!("iv"in _))throw new Error("Invalid IV parameter.");this._iv=transformIV(_.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};modes.ofb.prototype.encrypt=function(_,a,$){var j=_.length();if(_.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&j>=this.blockSize){for(var _e=0;_e<this._ints;++_e)a.putInt32(_.getInt32()^this._outBlock[_e]),this._inBlock[_e]=this._outBlock[_e];return}var et=(this.blockSize-j)%this.blockSize;et>0&&(et=this.blockSize-et),this._partialOutput.clear();for(var _e=0;_e<this._ints;++_e)this._partialOutput.putInt32(_.getInt32()^this._outBlock[_e]);if(et>0)_.read-=this.blockSize;else for(var _e=0;_e<this._ints;++_e)this._inBlock[_e]=this._outBlock[_e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),et>0&&!$)return a.putBytes(this._partialOutput.getBytes(et-this._partialBytes)),this._partialBytes=et,!0;a.putBytes(this._partialOutput.getBytes(j-this._partialBytes)),this._partialBytes=0};modes.ofb.prototype.decrypt=modes.ofb.prototype.encrypt;modes.ctr=function(_){_=_||{},this.name="CTR",this.cipher=_.cipher,this.blockSize=_.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=forge$n.util.createBuffer(),this._partialBytes=0};modes.ctr.prototype.start=function(_){if(!("iv"in _))throw new Error("Invalid IV parameter.");this._iv=transformIV(_.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};modes.ctr.prototype.encrypt=function(_,a,$){var j=_.length();if(j===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&j>=this.blockSize)for(var _e=0;_e<this._ints;++_e)a.putInt32(_.getInt32()^this._outBlock[_e]);else{var et=(this.blockSize-j)%this.blockSize;et>0&&(et=this.blockSize-et),this._partialOutput.clear();for(var _e=0;_e<this._ints;++_e)this._partialOutput.putInt32(_.getInt32()^this._outBlock[_e]);if(et>0&&(_.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),et>0&&!$)return a.putBytes(this._partialOutput.getBytes(et-this._partialBytes)),this._partialBytes=et,!0;a.putBytes(this._partialOutput.getBytes(j-this._partialBytes)),this._partialBytes=0}inc32(this._inBlock)};modes.ctr.prototype.decrypt=modes.ctr.prototype.encrypt;modes.gcm=function(_){_=_||{},this.name="GCM",this.cipher=_.cipher,this.blockSize=_.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=forge$n.util.createBuffer(),this._partialBytes=0,this._R=3774873600};modes.gcm.prototype.start=function(_){if(!("iv"in _))throw new Error("Invalid IV parameter.");var a=forge$n.util.createBuffer(_.iv);this._cipherLength=0;var $;if("additionalData"in _?$=forge$n.util.createBuffer(_.additionalData):$=forge$n.util.createBuffer(),"tagLength"in _?this._tagLength=_.tagLength:this._tagLength=128,this._tag=null,_.decrypt&&(this._tag=forge$n.util.createBuffer(_.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var j=a.length();if(j===12)this._j0=[a.getInt32(),a.getInt32(),a.getInt32(),1];else{for(this._j0=[0,0,0,0];a.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[a.getInt32(),a.getInt32(),a.getInt32(),a.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(from64To32(j*8)))}this._inBlock=this._j0.slice(0),inc32(this._inBlock),this._partialBytes=0,$=forge$n.util.createBuffer($),this._aDataLength=from64To32($.length()*8);var _e=$.length()%this.blockSize;for(_e&&$.fillWithByte(0,this.blockSize-_e),this._s=[0,0,0,0];$.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[$.getInt32(),$.getInt32(),$.getInt32(),$.getInt32()])};modes.gcm.prototype.encrypt=function(_,a,$){var j=_.length();if(j===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&j>=this.blockSize){for(var _e=0;_e<this._ints;++_e)a.putInt32(this._outBlock[_e]^=_.getInt32());this._cipherLength+=this.blockSize}else{var et=(this.blockSize-j)%this.blockSize;et>0&&(et=this.blockSize-et),this._partialOutput.clear();for(var _e=0;_e<this._ints;++_e)this._partialOutput.putInt32(_.getInt32()^this._outBlock[_e]);if(et<=0||$){if($){var tt=j%this.blockSize;this._cipherLength+=tt,this._partialOutput.truncate(this.blockSize-tt)}else this._cipherLength+=this.blockSize;for(var _e=0;_e<this._ints;++_e)this._outBlock[_e]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),et>0&&!$)return _.read-=this.blockSize,a.putBytes(this._partialOutput.getBytes(et-this._partialBytes)),this._partialBytes=et,!0;a.putBytes(this._partialOutput.getBytes(j-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),inc32(this._inBlock)};modes.gcm.prototype.decrypt=function(_,a,$){var j=_.length();if(j<this.blockSize&&!($&&j>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),inc32(this._inBlock),this._hashBlock[0]=_.getInt32(),this._hashBlock[1]=_.getInt32(),this._hashBlock[2]=_.getInt32(),this._hashBlock[3]=_.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var _e=0;_e<this._ints;++_e)a.putInt32(this._outBlock[_e]^this._hashBlock[_e]);j<this.blockSize?this._cipherLength+=j%this.blockSize:this._cipherLength+=this.blockSize};modes.gcm.prototype.afterFinish=function(_,a){var $=!0;a.decrypt&&a.overflow&&_.truncate(this.blockSize-a.overflow),this.tag=forge$n.util.createBuffer();var j=this._aDataLength.concat(from64To32(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,j);var _e=[];this.cipher.encrypt(this._j0,_e);for(var et=0;et<this._ints;++et)this.tag.putInt32(this._s[et]^_e[et]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),a.decrypt&&this.tag.bytes()!==this._tag&&($=!1),$};modes.gcm.prototype.multiply=function(_,a){for(var $=[0,0,0,0],j=a.slice(0),_e=0;_e<128;++_e){var et=_[_e/32|0]&1<<31-_e%32;et&&($[0]^=j[0],$[1]^=j[1],$[2]^=j[2],$[3]^=j[3]),this.pow(j,j)}return $};modes.gcm.prototype.pow=function(_,a){for(var $=_[3]&1,j=3;j>0;--j)a[j]=_[j]>>>1|(_[j-1]&1)<<31;a[0]=_[0]>>>1,$&&(a[0]^=this._R)};modes.gcm.prototype.tableMultiply=function(_){for(var a=[0,0,0,0],$=0;$<32;++$){var j=$/8|0,_e=_[j]>>>(7-$%8)*4&15,et=this._m[$][_e];a[0]^=et[0],a[1]^=et[1],a[2]^=et[2],a[3]^=et[3]}return a};modes.gcm.prototype.ghash=function(_,a,$){return a[0]^=$[0],a[1]^=$[1],a[2]^=$[2],a[3]^=$[3],this.tableMultiply(a)};modes.gcm.prototype.generateHashTable=function(_,a){for(var $=8/a,j=4*$,_e=16*$,et=new Array(_e),tt=0;tt<_e;++tt){var rt=[0,0,0,0],nt=tt/j|0,it=(j-1-tt%j)*a;rt[nt]=1<<a-1<<it,et[tt]=this.generateSubHashTable(this.multiply(rt,_),a)}return et};modes.gcm.prototype.generateSubHashTable=function(_,a){var $=1<<a,j=$>>>1,_e=new Array($);_e[j]=_.slice(0);for(var et=j>>>1;et>0;)this.pow(_e[2*et],_e[et]=[]),et>>=1;for(et=2;et<j;){for(var tt=1;tt<et;++tt){var rt=_e[et],nt=_e[tt];_e[et+tt]=[rt[0]^nt[0],rt[1]^nt[1],rt[2]^nt[2],rt[3]^nt[3]]}et*=2}for(_e[0]=[0,0,0,0],et=j+1;et<$;++et){var it=_e[et^j];_e[et]=[_[0]^it[0],_[1]^it[1],_[2]^it[2],_[3]^it[3]]}return _e};function transformIV(_,a){if(typeof _=="string"&&(_=forge$n.util.createBuffer(_)),forge$n.util.isArray(_)&&_.length>4){var $=_;_=forge$n.util.createBuffer();for(var j=0;j<$.length;++j)_.putByte($[j])}if(_.length()<a)throw new Error("Invalid IV length; got "+_.length()+" bytes and expected "+a+" bytes.");if(!forge$n.util.isArray(_)){for(var _e=[],et=a/4,j=0;j<et;++j)_e.push(_.getInt32());_=_e}return _}function inc32(_){_[_.length-1]=_[_.length-1]+1&4294967295}function from64To32(_){return[_/4294967296|0,_&4294967295]}var forge$m=forge$s;forge$m.aes=forge$m.aes||{};forge$m.aes.startEncrypting=function(_,a,$,j){var _e=_createCipher$1({key:_,output:$,decrypt:!1,mode:j});return _e.start(a),_e};forge$m.aes.createEncryptionCipher=function(_,a){return _createCipher$1({key:_,output:null,decrypt:!1,mode:a})};forge$m.aes.startDecrypting=function(_,a,$,j){var _e=_createCipher$1({key:_,output:$,decrypt:!0,mode:j});return _e.start(a),_e};forge$m.aes.createDecryptionCipher=function(_,a){return _createCipher$1({key:_,output:null,decrypt:!0,mode:a})};forge$m.aes.Algorithm=function(_,a){init||initialize();var $=this;$.name=_,$.mode=new a({blockSize:16,cipher:{encrypt:function(j,_e){return _updateBlock$1($._w,j,_e,!1)},decrypt:function(j,_e){return _updateBlock$1($._w,j,_e,!0)}}}),$._init=!1};forge$m.aes.Algorithm.prototype.initialize=function(_){if(!this._init){var a=_.key,$;if(typeof a=="string"&&(a.length===16||a.length===24||a.length===32))a=forge$m.util.createBuffer(a);else if(forge$m.util.isArray(a)&&(a.length===16||a.length===24||a.length===32)){$=a,a=forge$m.util.createBuffer();for(var j=0;j<$.length;++j)a.putByte($[j])}if(!forge$m.util.isArray(a)){$=a,a=[];var _e=$.length();if(_e===16||_e===24||_e===32){_e=_e>>>2;for(var j=0;j<_e;++j)a.push($.getInt32())}}if(!forge$m.util.isArray(a)||!(a.length===4||a.length===6||a.length===8))throw new Error("Invalid key parameter.");var et=this.mode.name,tt=["CFB","OFB","CTR","GCM"].indexOf(et)!==-1;this._w=_expandKey(a,_.decrypt&&!tt),this._init=!0}};forge$m.aes._expandKey=function(_,a){return init||initialize(),_expandKey(_,a)};forge$m.aes._updateBlock=_updateBlock$1;registerAlgorithm$1("AES-ECB",forge$m.cipher.modes.ecb);registerAlgorithm$1("AES-CBC",forge$m.cipher.modes.cbc);registerAlgorithm$1("AES-CFB",forge$m.cipher.modes.cfb);registerAlgorithm$1("AES-OFB",forge$m.cipher.modes.ofb);registerAlgorithm$1("AES-CTR",forge$m.cipher.modes.ctr);registerAlgorithm$1("AES-GCM",forge$m.cipher.modes.gcm);function registerAlgorithm$1(_,a){var $=function(){return new forge$m.aes.Algorithm(_,a)};forge$m.cipher.registerAlgorithm(_,$)}var init=!1,Nb=4,sbox,isbox,rcon,mix,imix;function initialize(){init=!0,rcon=[0,1,2,4,8,16,32,64,128,27,54];for(var _=new Array(256),a=0;a<128;++a)_[a]=a<<1,_[a+128]=a+128<<1^283;sbox=new Array(256),isbox=new Array(256),mix=new Array(4),imix=new Array(4);for(var a=0;a<4;++a)mix[a]=new Array(256),imix[a]=new Array(256);for(var $=0,j=0,_e,et,tt,rt,nt,it,st,a=0;a<256;++a){rt=j^j<<1^j<<2^j<<3^j<<4,rt=rt>>8^rt&255^99,sbox[$]=rt,isbox[rt]=$,nt=_[rt],_e=_[$],et=_[_e],tt=_[et],it=nt<<24^rt<<16^rt<<8^(rt^nt),st=(_e^et^tt)<<24^($^tt)<<16^($^et^tt)<<8^($^_e^tt);for(var ot=0;ot<4;++ot)mix[ot][$]=it,imix[ot][rt]=st,it=it<<24|it>>>8,st=st<<24|st>>>8;$===0?$=j=1:($=_e^_[_[_[_e^tt]]],j^=_[_[j]])}}function _expandKey(_,a){for(var $=_.slice(0),j,_e=1,et=$.length,tt=et+6+1,rt=Nb*tt,nt=et;nt<rt;++nt)j=$[nt-1],nt%et===0?(j=sbox[j>>>16&255]<<24^sbox[j>>>8&255]<<16^sbox[j&255]<<8^sbox[j>>>24]^rcon[_e]<<24,_e++):et>6&&nt%et===4&&(j=sbox[j>>>24]<<24^sbox[j>>>16&255]<<16^sbox[j>>>8&255]<<8^sbox[j&255]),$[nt]=$[nt-et]^j;if(a){var it,st=imix[0],ot=imix[1],at=imix[2],lt=imix[3],ct=$.slice(0);rt=$.length;for(var nt=0,ut=rt-Nb;nt<rt;nt+=Nb,ut-=Nb)if(nt===0||nt===rt-Nb)ct[nt]=$[ut],ct[nt+1]=$[ut+3],ct[nt+2]=$[ut+2],ct[nt+3]=$[ut+1];else for(var dt=0;dt<Nb;++dt)it=$[ut+dt],ct[nt+(3&-dt)]=st[sbox[it>>>24]]^ot[sbox[it>>>16&255]]^at[sbox[it>>>8&255]]^lt[sbox[it&255]];$=ct}return $}function _updateBlock$1(_,a,$,j){var _e=_.length/4-1,et,tt,rt,nt,it;j?(et=imix[0],tt=imix[1],rt=imix[2],nt=imix[3],it=isbox):(et=mix[0],tt=mix[1],rt=mix[2],nt=mix[3],it=sbox);var st,ot,at,lt,ct,ut,dt;st=a[0]^_[0],ot=a[j?3:1]^_[1],at=a[2]^_[2],lt=a[j?1:3]^_[3];for(var ft=3,pt=1;pt<_e;++pt)ct=et[st>>>24]^tt[ot>>>16&255]^rt[at>>>8&255]^nt[lt&255]^_[++ft],ut=et[ot>>>24]^tt[at>>>16&255]^rt[lt>>>8&255]^nt[st&255]^_[++ft],dt=et[at>>>24]^tt[lt>>>16&255]^rt[st>>>8&255]^nt[ot&255]^_[++ft],lt=et[lt>>>24]^tt[st>>>16&255]^rt[ot>>>8&255]^nt[at&255]^_[++ft],st=ct,ot=ut,at=dt;$[0]=it[st>>>24]<<24^it[ot>>>16&255]<<16^it[at>>>8&255]<<8^it[lt&255]^_[++ft],$[j?3:1]=it[ot>>>24]<<24^it[at>>>16&255]<<16^it[lt>>>8&255]<<8^it[st&255]^_[++ft],$[2]=it[at>>>24]<<24^it[lt>>>16&255]<<16^it[st>>>8&255]<<8^it[ot&255]^_[++ft],$[j?1:3]=it[lt>>>24]<<24^it[st>>>16&255]<<16^it[ot>>>8&255]<<8^it[at&255]^_[++ft]}function _createCipher$1(_){_=_||{};var a=(_.mode||"CBC").toUpperCase(),$="AES-"+a,j;_.decrypt?j=forge$m.cipher.createDecipher($,_.key):j=forge$m.cipher.createCipher($,_.key);var _e=j.start;return j.start=function(et,tt){var rt=null;tt instanceof forge$m.util.ByteBuffer&&(rt=tt,tt={}),tt=tt||{},tt.output=rt,tt.iv=et,_e.call(j,tt)},j}var forge$l=forge$s;forge$l.des=forge$l.des||{};forge$l.des.startEncrypting=function(_,a,$,j){var _e=_createCipher({key:_,output:$,decrypt:!1,mode:j||(a===null?"ECB":"CBC")});return _e.start(a),_e};forge$l.des.createEncryptionCipher=function(_,a){return _createCipher({key:_,output:null,decrypt:!1,mode:a})};forge$l.des.startDecrypting=function(_,a,$,j){var _e=_createCipher({key:_,output:$,decrypt:!0,mode:j||(a===null?"ECB":"CBC")});return _e.start(a),_e};forge$l.des.createDecryptionCipher=function(_,a){return _createCipher({key:_,output:null,decrypt:!0,mode:a})};forge$l.des.Algorithm=function(_,a){var $=this;$.name=_,$.mode=new a({blockSize:8,cipher:{encrypt:function(j,_e){return _updateBlock($._keys,j,_e,!1)},decrypt:function(j,_e){return _updateBlock($._keys,j,_e,!0)}}}),$._init=!1};forge$l.des.Algorithm.prototype.initialize=function(_){if(!this._init){var a=forge$l.util.createBuffer(_.key);if(this.name.indexOf("3DES")===0&&a.length()!==24)throw new Error("Invalid Triple-DES key size: "+a.length()*8);this._keys=_createKeys(a),this._init=!0}};registerAlgorithm("DES-ECB",forge$l.cipher.modes.ecb);registerAlgorithm("DES-CBC",forge$l.cipher.modes.cbc);registerAlgorithm("DES-CFB",forge$l.cipher.modes.cfb);registerAlgorithm("DES-OFB",forge$l.cipher.modes.ofb);registerAlgorithm("DES-CTR",forge$l.cipher.modes.ctr);registerAlgorithm("3DES-ECB",forge$l.cipher.modes.ecb);registerAlgorithm("3DES-CBC",forge$l.cipher.modes.cbc);registerAlgorithm("3DES-CFB",forge$l.cipher.modes.cfb);registerAlgorithm("3DES-OFB",forge$l.cipher.modes.ofb);registerAlgorithm("3DES-CTR",forge$l.cipher.modes.ctr);function registerAlgorithm(_,a){var $=function(){return new forge$l.des.Algorithm(_,a)};forge$l.cipher.registerAlgorithm(_,$)}var spfunction1=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],spfunction2=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],spfunction3=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],spfunction4=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],spfunction5=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],spfunction6=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],spfunction7=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],spfunction8=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function _createKeys(_){for(var a=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],$=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],j=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],_e=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],et=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],tt=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],rt=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],nt=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],it=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],st=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],ot=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],at=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],lt=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],ct=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],ut=_.length()>8?3:1,dt=[],ft=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],pt=0,yt,mt=0;mt<ut;mt++){var _t=_.getInt32(),vt=_.getInt32();yt=(_t>>>4^vt)&252645135,vt^=yt,_t^=yt<<4,yt=(vt>>>-16^_t)&65535,_t^=yt,vt^=yt<<-16,yt=(_t>>>2^vt)&858993459,vt^=yt,_t^=yt<<2,yt=(vt>>>-16^_t)&65535,_t^=yt,vt^=yt<<-16,yt=(_t>>>1^vt)&1431655765,vt^=yt,_t^=yt<<1,yt=(vt>>>8^_t)&16711935,_t^=yt,vt^=yt<<8,yt=(_t>>>1^vt)&1431655765,vt^=yt,_t^=yt<<1,yt=_t<<8|vt>>>20&240,_t=vt<<24|vt<<8&16711680|vt>>>8&65280|vt>>>24&240,vt=yt;for(var ht=0;ht<ft.length;++ht){ft[ht]?(_t=_t<<2|_t>>>26,vt=vt<<2|vt>>>26):(_t=_t<<1|_t>>>27,vt=vt<<1|vt>>>27),_t&=-15,vt&=-15;var St=a[_t>>>28]|$[_t>>>24&15]|j[_t>>>20&15]|_e[_t>>>16&15]|et[_t>>>12&15]|tt[_t>>>8&15]|rt[_t>>>4&15],It=nt[vt>>>28]|it[vt>>>24&15]|st[vt>>>20&15]|ot[vt>>>16&15]|at[vt>>>12&15]|lt[vt>>>8&15]|ct[vt>>>4&15];yt=(It>>>16^St)&65535,dt[pt++]=St^yt,dt[pt++]=It^yt<<16}}return dt}function _updateBlock(_,a,$,j){var _e=_.length===32?3:9,et;_e===3?et=j?[30,-2,-2]:[0,32,2]:et=j?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var tt,rt=a[0],nt=a[1];tt=(rt>>>4^nt)&252645135,nt^=tt,rt^=tt<<4,tt=(rt>>>16^nt)&65535,nt^=tt,rt^=tt<<16,tt=(nt>>>2^rt)&858993459,rt^=tt,nt^=tt<<2,tt=(nt>>>8^rt)&16711935,rt^=tt,nt^=tt<<8,tt=(rt>>>1^nt)&1431655765,nt^=tt,rt^=tt<<1,rt=rt<<1|rt>>>31,nt=nt<<1|nt>>>31;for(var it=0;it<_e;it+=3){for(var st=et[it+1],ot=et[it+2],at=et[it];at!=st;at+=ot){var lt=nt^_[at],ct=(nt>>>4|nt<<28)^_[at+1];tt=rt,rt=nt,nt=tt^(spfunction2[lt>>>24&63]|spfunction4[lt>>>16&63]|spfunction6[lt>>>8&63]|spfunction8[lt&63]|spfunction1[ct>>>24&63]|spfunction3[ct>>>16&63]|spfunction5[ct>>>8&63]|spfunction7[ct&63])}tt=rt,rt=nt,nt=tt}rt=rt>>>1|rt<<31,nt=nt>>>1|nt<<31,tt=(rt>>>1^nt)&1431655765,nt^=tt,rt^=tt<<1,tt=(nt>>>8^rt)&16711935,rt^=tt,nt^=tt<<8,tt=(nt>>>2^rt)&858993459,rt^=tt,nt^=tt<<2,tt=(rt>>>16^nt)&65535,nt^=tt,rt^=tt<<16,tt=(rt>>>4^nt)&252645135,nt^=tt,rt^=tt<<4,$[0]=rt,$[1]=nt}function _createCipher(_){_=_||{};var a=(_.mode||"CBC").toUpperCase(),$="DES-"+a,j;_.decrypt?j=forge$l.cipher.createDecipher($,_.key):j=forge$l.cipher.createCipher($,_.key);var _e=j.start;return j.start=function(et,tt){var rt=null;tt instanceof forge$l.util.ByteBuffer&&(rt=tt,tt={}),tt=tt||{},tt.output=rt,tt.iv=et,_e.call(j,tt)},j}var forge$k=forge$s;forge$k.md=forge$k.md||{};forge$k.md.algorithms=forge$k.md.algorithms||{};var forge$j=forge$s,hmac$2=forge$j.hmac=forge$j.hmac||{};hmac$2.create=function(){var _=null,a=null,$=null,j=null,_e={};return _e.start=function(et,tt){if(et!==null)if(typeof et=="string")if(et=et.toLowerCase(),et in forge$j.md.algorithms)a=forge$j.md.algorithms[et].create();else throw new Error('Unknown hash algorithm "'+et+'"');else a=et;if(tt===null)tt=_;else{if(typeof tt=="string")tt=forge$j.util.createBuffer(tt);else if(forge$j.util.isArray(tt)){var rt=tt;tt=forge$j.util.createBuffer();for(var nt=0;nt<rt.length;++nt)tt.putByte(rt[nt])}var it=tt.length();it>a.blockLength&&(a.start(),a.update(tt.bytes()),tt=a.digest()),$=forge$j.util.createBuffer(),j=forge$j.util.createBuffer(),it=tt.length();for(var nt=0;nt<it;++nt){var rt=tt.at(nt);$.putByte(54^rt),j.putByte(92^rt)}if(it<a.blockLength)for(var rt=a.blockLength-it,nt=0;nt<rt;++nt)$.putByte(54),j.putByte(92);_=tt,$=$.bytes(),j=j.bytes()}a.start(),a.update($)},_e.update=function(et){a.update(et)},_e.getMac=function(){var et=a.digest().bytes();return a.start(),a.update(j),a.update(et),a.digest()},_e.digest=_e.getMac,_e};var forge$i=forge$s,pkcs5=forge$i.pkcs5=forge$i.pkcs5||{},crypto$5;forge$i.util.isNodejs&&!forge$i.options.usePureJavaScript&&(crypto$5=require$$1);var pbkdf2$1=forge$i.pbkdf2=pkcs5.pbkdf2=function(_,a,$,j,_e,et){if(typeof _e=="function"&&(et=_e,_e=null),forge$i.util.isNodejs&&!forge$i.options.usePureJavaScript&&crypto$5.pbkdf2&&(_e===null||typeof _e!="object")&&(crypto$5.pbkdf2Sync.length>4||!_e||_e==="sha1"))return typeof _e!="string"&&(_e="sha1"),_=Buffer.from(_,"binary"),a=Buffer.from(a,"binary"),et?crypto$5.pbkdf2Sync.length===4?crypto$5.pbkdf2(_,a,$,j,function(yt,mt){if(yt)return et(yt);et(null,mt.toString("binary"))}):crypto$5.pbkdf2(_,a,$,j,_e,function(yt,mt){if(yt)return et(yt);et(null,mt.toString("binary"))}):crypto$5.pbkdf2Sync.length===4?crypto$5.pbkdf2Sync(_,a,$,j).toString("binary"):crypto$5.pbkdf2Sync(_,a,$,j,_e).toString("binary");if((typeof _e>"u"||_e===null)&&(_e="sha1"),typeof _e=="string"){if(!(_e in forge$i.md.algorithms))throw new Error("Unknown hash algorithm: "+_e);_e=forge$i.md[_e].create()}var tt=_e.digestLength;if(j>4294967295*tt){var rt=new Error("Derived key is too long.");if(et)return et(rt);throw rt}var nt=Math.ceil(j/tt),it=j-(nt-1)*tt,st=forge$i.hmac.create();st.start(_e,_);var ot="",at,lt,ct;if(!et){for(var ut=1;ut<=nt;++ut){st.start(null,null),st.update(a),st.update(forge$i.util.int32ToBytes(ut)),at=ct=st.digest().getBytes();for(var dt=2;dt<=$;++dt)st.start(null,null),st.update(ct),lt=st.digest().getBytes(),at=forge$i.util.xorBytes(at,lt,tt),ct=lt;ot+=ut<nt?at:at.substr(0,it)}return ot}var ut=1,dt;function ft(){if(ut>nt)return et(null,ot);st.start(null,null),st.update(a),st.update(forge$i.util.int32ToBytes(ut)),at=ct=st.digest().getBytes(),dt=2,pt()}function pt(){if(dt<=$)return st.start(null,null),st.update(ct),lt=st.digest().getBytes(),at=forge$i.util.xorBytes(at,lt,tt),ct=lt,++dt,forge$i.util.setImmediate(pt);ot+=ut<nt?at:at.substr(0,it),++ut,ft()}ft()},forge$h=forge$s,pem=forge$h.pem=forge$h.pem||{};pem.encode=function(_,a){a=a||{};var $="-----BEGIN "+_.type+`-----\r
`,j;if(_.procType&&(j={name:"Proc-Type",values:[String(_.procType.version),_.procType.type]},$+=foldHeader(j)),_.contentDomain&&(j={name:"Content-Domain",values:[_.contentDomain]},$+=foldHeader(j)),_.dekInfo&&(j={name:"DEK-Info",values:[_.dekInfo.algorithm]},_.dekInfo.parameters&&j.values.push(_.dekInfo.parameters),$+=foldHeader(j)),_.headers)for(var _e=0;_e<_.headers.length;++_e)$+=foldHeader(_.headers[_e]);return _.procType&&($+=`\r
`),$+=forge$h.util.encode64(_.body,a.maxline||64)+`\r
`,$+="-----END "+_.type+`-----\r
`,$};pem.decode=function(_){for(var a=[],$=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,j=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,_e=/\r?\n/,et;et=$.exec(_),!!et;){var tt=et[1];tt==="NEW CERTIFICATE REQUEST"&&(tt="CERTIFICATE REQUEST");var rt={type:tt,procType:null,contentDomain:null,dekInfo:null,headers:[],body:forge$h.util.decode64(et[3])};if(a.push(rt),!!et[2]){for(var nt=et[2].split(_e),it=0;et&&it<nt.length;){for(var st=nt[it].replace(/\s+$/,""),ot=it+1;ot<nt.length;++ot){var at=nt[ot];if(!/\s/.test(at[0]))break;st+=at,it=ot}if(et=st.match(j),et){for(var lt={name:et[1],values:[]},ct=et[2].split(","),ut=0;ut<ct.length;++ut)lt.values.push(ltrim(ct[ut]));if(rt.procType)if(!rt.contentDomain&&lt.name==="Content-Domain")rt.contentDomain=ct[0]||"";else if(!rt.dekInfo&&lt.name==="DEK-Info"){if(lt.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');rt.dekInfo={algorithm:ct[0],parameters:ct[1]||null}}else rt.headers.push(lt);else{if(lt.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(lt.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');rt.procType={version:ct[0],type:ct[1]}}}++it}if(rt.procType==="ENCRYPTED"&&!rt.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(a.length===0)throw new Error("Invalid PEM formatted message.");return a};function foldHeader(_){for(var a=_.name+": ",$=[],j=function(nt,it){return" "+it},_e=0;_e<_.values.length;++_e)$.push(_.values[_e].replace(/^(\S+\r\n)/,j));a+=$.join(",")+`\r
`;for(var et=0,tt=-1,_e=0;_e<a.length;++_e,++et)if(et>65&&tt!==-1){var rt=a[tt];rt===","?(++tt,a=a.substr(0,tt)+`\r
 `+a.substr(tt)):a=a.substr(0,tt)+`\r
`+rt+a.substr(tt+1),et=_e-tt-1,tt=-1,++_e}else(a[_e]===" "||a[_e]==="	"||a[_e]===",")&&(tt=_e);return a}function ltrim(_){return _.replace(/^\s+/,"")}var forge$g=forge$s,sha256$3=forge$g.sha256=forge$g.sha256||{};forge$g.md.sha256=forge$g.md.algorithms.sha256=sha256$3;sha256$3.create=function(){_initialized$2||_init$2();var _=null,a=forge$g.util.createBuffer(),$=new Array(64),j={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return j.start=function(){j.messageLength=0,j.fullMessageLength=j.messageLength64=[];for(var _e=j.messageLengthSize/4,et=0;et<_e;++et)j.fullMessageLength.push(0);return a=forge$g.util.createBuffer(),_={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},j},j.start(),j.update=function(_e,et){et==="utf8"&&(_e=forge$g.util.encodeUtf8(_e));var tt=_e.length;j.messageLength+=tt,tt=[tt/4294967296>>>0,tt>>>0];for(var rt=j.fullMessageLength.length-1;rt>=0;--rt)j.fullMessageLength[rt]+=tt[1],tt[1]=tt[0]+(j.fullMessageLength[rt]/4294967296>>>0),j.fullMessageLength[rt]=j.fullMessageLength[rt]>>>0,tt[0]=tt[1]/4294967296>>>0;return a.putBytes(_e),_update$2(_,$,a),(a.read>2048||a.length()===0)&&a.compact(),j},j.digest=function(){var _e=forge$g.util.createBuffer();_e.putBytes(a.bytes());var et=j.fullMessageLength[j.fullMessageLength.length-1]+j.messageLengthSize,tt=et&j.blockLength-1;_e.putBytes(_padding$2.substr(0,j.blockLength-tt));for(var rt,nt,it=j.fullMessageLength[0]*8,st=0;st<j.fullMessageLength.length-1;++st)rt=j.fullMessageLength[st+1]*8,nt=rt/4294967296>>>0,it+=nt,_e.putInt32(it>>>0),it=rt>>>0;_e.putInt32(it);var ot={h0:_.h0,h1:_.h1,h2:_.h2,h3:_.h3,h4:_.h4,h5:_.h5,h6:_.h6,h7:_.h7};_update$2(ot,$,_e);var at=forge$g.util.createBuffer();return at.putInt32(ot.h0),at.putInt32(ot.h1),at.putInt32(ot.h2),at.putInt32(ot.h3),at.putInt32(ot.h4),at.putInt32(ot.h5),at.putInt32(ot.h6),at.putInt32(ot.h7),at},j};var _padding$2=null,_initialized$2=!1,_k$1=null;function _init$2(){_padding$2=String.fromCharCode(128),_padding$2+=forge$g.util.fillString(String.fromCharCode(0),64),_k$1=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],_initialized$2=!0}function _update$2(_,a,$){for(var j,_e,et,tt,rt,nt,it,st,ot,at,lt,ct,ut,dt,ft,pt=$.length();pt>=64;){for(it=0;it<16;++it)a[it]=$.getInt32();for(;it<64;++it)j=a[it-2],j=(j>>>17|j<<15)^(j>>>19|j<<13)^j>>>10,_e=a[it-15],_e=(_e>>>7|_e<<25)^(_e>>>18|_e<<14)^_e>>>3,a[it]=j+a[it-7]+_e+a[it-16]|0;for(st=_.h0,ot=_.h1,at=_.h2,lt=_.h3,ct=_.h4,ut=_.h5,dt=_.h6,ft=_.h7,it=0;it<64;++it)tt=(ct>>>6|ct<<26)^(ct>>>11|ct<<21)^(ct>>>25|ct<<7),rt=dt^ct&(ut^dt),et=(st>>>2|st<<30)^(st>>>13|st<<19)^(st>>>22|st<<10),nt=st&ot|at&(st^ot),j=ft+tt+rt+_k$1[it]+a[it],_e=et+nt,ft=dt,dt=ut,ut=ct,ct=lt+j>>>0,lt=at,at=ot,ot=st,st=j+_e>>>0;_.h0=_.h0+st|0,_.h1=_.h1+ot|0,_.h2=_.h2+at|0,_.h3=_.h3+lt|0,_.h4=_.h4+ct|0,_.h5=_.h5+ut|0,_.h6=_.h6+dt|0,_.h7=_.h7+ft|0,pt-=64}}var forge$f=forge$s,_crypto$1=null;forge$f.util.isNodejs&&!forge$f.options.usePureJavaScript&&!process.versions["node-webkit"]&&(_crypto$1=require$$1);var prng=forge$f.prng=forge$f.prng||{};prng.create=function(_){for(var a={plugin:_,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},$=_.md,j=new Array(32),_e=0;_e<32;++_e)j[_e]=$.create();a.pools=j,a.pool=0,a.generate=function(it,st){if(!st)return a.generateSync(it);var ot=a.plugin.cipher,at=a.plugin.increment,lt=a.plugin.formatKey,ct=a.plugin.formatSeed,ut=forge$f.util.createBuffer();a.key=null,dt();function dt(ft){if(ft)return st(ft);if(ut.length()>=it)return st(null,ut.getBytes(it));if(a.generated>1048575&&(a.key=null),a.key===null)return forge$f.util.nextTick(function(){et(dt)});var pt=ot(a.key,a.seed);a.generated+=pt.length,ut.putBytes(pt),a.key=lt(ot(a.key,at(a.seed))),a.seed=ct(ot(a.key,a.seed)),forge$f.util.setImmediate(dt)}},a.generateSync=function(it){var st=a.plugin.cipher,ot=a.plugin.increment,at=a.plugin.formatKey,lt=a.plugin.formatSeed;a.key=null;for(var ct=forge$f.util.createBuffer();ct.length()<it;){a.generated>1048575&&(a.key=null),a.key===null&&tt();var ut=st(a.key,a.seed);a.generated+=ut.length,ct.putBytes(ut),a.key=at(st(a.key,ot(a.seed))),a.seed=lt(st(a.key,a.seed))}return ct.getBytes(it)};function et(it){if(a.pools[0].messageLength>=32)return rt(),it();var st=32-a.pools[0].messageLength<<5;a.seedFile(st,function(ot,at){if(ot)return it(ot);a.collect(at),rt(),it()})}function tt(){if(a.pools[0].messageLength>=32)return rt();var it=32-a.pools[0].messageLength<<5;a.collect(a.seedFileSync(it)),rt()}function rt(){a.reseeds=a.reseeds===4294967295?0:a.reseeds+1;var it=a.plugin.md.create();it.update(a.keyBytes);for(var st=1,ot=0;ot<32;++ot)a.reseeds%st===0&&(it.update(a.pools[ot].digest().getBytes()),a.pools[ot].start()),st=st<<1;a.keyBytes=it.digest().getBytes(),it.start(),it.update(a.keyBytes);var at=it.digest().getBytes();a.key=a.plugin.formatKey(a.keyBytes),a.seed=a.plugin.formatSeed(at),a.generated=0}function nt(it){var st=null,ot=forge$f.util.globalScope,at=ot.crypto||ot.msCrypto;at&&at.getRandomValues&&(st=function(_t){return at.getRandomValues(_t)});var lt=forge$f.util.createBuffer();if(st)for(;lt.length()<it;){var ct=Math.max(1,Math.min(it-lt.length(),65536)/4),ut=new Uint32Array(Math.floor(ct));try{st(ut);for(var dt=0;dt<ut.length;++dt)lt.putInt32(ut[dt])}catch(_t){if(!(typeof QuotaExceededError<"u"&&_t instanceof QuotaExceededError))throw _t}}if(lt.length()<it)for(var ft,pt,yt,mt=Math.floor(Math.random()*65536);lt.length()<it;){pt=16807*(mt&65535),ft=16807*(mt>>16),pt+=(ft&32767)<<16,pt+=ft>>15,pt=(pt&2147483647)+(pt>>31),mt=pt&4294967295;for(var dt=0;dt<3;++dt)yt=mt>>>(dt<<3),yt^=Math.floor(Math.random()*256),lt.putByte(yt&255)}return lt.getBytes(it)}return _crypto$1?(a.seedFile=function(it,st){_crypto$1.randomBytes(it,function(ot,at){if(ot)return st(ot);st(null,at.toString())})},a.seedFileSync=function(it){return _crypto$1.randomBytes(it).toString()}):(a.seedFile=function(it,st){try{st(null,nt(it))}catch(ot){st(ot)}},a.seedFileSync=nt),a.collect=function(it){for(var st=it.length,ot=0;ot<st;++ot)a.pools[a.pool].update(it.substr(ot,1)),a.pool=a.pool===31?0:a.pool+1},a.collectInt=function(it,st){for(var ot="",at=0;at<st;at+=8)ot+=String.fromCharCode(it>>at&255);a.collect(ot)},a.registerWorker=function(it){if(it===self)a.seedFile=function(ot,at){function lt(ct){var ut=ct.data;ut.forge&&ut.forge.prng&&(self.removeEventListener("message",lt),at(ut.forge.prng.err,ut.forge.prng.bytes))}self.addEventListener("message",lt),self.postMessage({forge:{prng:{needed:ot}}})};else{var st=function(ot){var at=ot.data;at.forge&&at.forge.prng&&a.seedFile(at.forge.prng.needed,function(lt,ct){it.postMessage({forge:{prng:{err:lt,bytes:ct}}})})};it.addEventListener("message",st)}},a};var forge$e=forge$s;(function(){forge$e.random&&forge$e.random.getBytes||function(_){var a={},$=new Array(4),j=forge$e.util.createBuffer();a.formatKey=function(ot){var at=forge$e.util.createBuffer(ot);return ot=new Array(4),ot[0]=at.getInt32(),ot[1]=at.getInt32(),ot[2]=at.getInt32(),ot[3]=at.getInt32(),forge$e.aes._expandKey(ot,!1)},a.formatSeed=function(ot){var at=forge$e.util.createBuffer(ot);return ot=new Array(4),ot[0]=at.getInt32(),ot[1]=at.getInt32(),ot[2]=at.getInt32(),ot[3]=at.getInt32(),ot},a.cipher=function(ot,at){return forge$e.aes._updateBlock(ot,at,$,!1),j.putInt32($[0]),j.putInt32($[1]),j.putInt32($[2]),j.putInt32($[3]),j.getBytes()},a.increment=function(ot){return++ot[3],ot},a.md=forge$e.md.sha256;function _e(){var ot=forge$e.prng.create(a);return ot.getBytes=function(at,lt){return ot.generate(at,lt)},ot.getBytesSync=function(at){return ot.generate(at)},ot}var et=_e(),tt=null,rt=forge$e.util.globalScope,nt=rt.crypto||rt.msCrypto;if(nt&&nt.getRandomValues&&(tt=function(ot){return nt.getRandomValues(ot)}),!forge$e.util.isNodejs&&!tt){if(et.collectInt(+new Date,32),typeof navigator<"u"){var it="";for(var st in navigator)try{typeof navigator[st]=="string"&&(it+=navigator[st])}catch{}et.collect(it),it=null}_&&(_().mousemove(function(ot){et.collectInt(ot.clientX,16),et.collectInt(ot.clientY,16)}),_().keypress(function(ot){et.collectInt(ot.charCode,8)}))}if(!forge$e.random)forge$e.random=et;else for(var st in et)forge$e.random[st]=et[st];forge$e.random.createInstance=_e}(typeof jQuery<"u"?jQuery:null)})();var forge$d=forge$s,piTable=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],s$1=[1,2,3,5],rol=function(_,a){return _<<a&65535|(_&65535)>>16-a},ror=function(_,a){return(_&65535)>>a|_<<16-a&65535};forge$d.rc2=forge$d.rc2||{};forge$d.rc2.expandKey=function(_,a){typeof _=="string"&&(_=forge$d.util.createBuffer(_)),a=a||128;var $=_,j=_.length(),_e=a,et=Math.ceil(_e/8),tt=255>>(_e&7),rt;for(rt=j;rt<128;rt++)$.putByte(piTable[$.at(rt-1)+$.at(rt-j)&255]);for($.setAt(128-et,piTable[$.at(128-et)&tt]),rt=127-et;rt>=0;rt--)$.setAt(rt,piTable[$.at(rt+1)^$.at(rt+et)]);return $};var createCipher=function(_,a,$){var j=!1,_e=null,et=null,tt=null,rt,nt,it,st,ot=[];for(_=forge$d.rc2.expandKey(_,a),it=0;it<64;it++)ot.push(_.getInt16Le());$?(rt=function(ct){for(it=0;it<4;it++)ct[it]+=ot[st]+(ct[(it+3)%4]&ct[(it+2)%4])+(~ct[(it+3)%4]&ct[(it+1)%4]),ct[it]=rol(ct[it],s$1[it]),st++},nt=function(ct){for(it=0;it<4;it++)ct[it]+=ot[ct[(it+3)%4]&63]}):(rt=function(ct){for(it=3;it>=0;it--)ct[it]=ror(ct[it],s$1[it]),ct[it]-=ot[st]+(ct[(it+3)%4]&ct[(it+2)%4])+(~ct[(it+3)%4]&ct[(it+1)%4]),st--},nt=function(ct){for(it=3;it>=0;it--)ct[it]-=ot[ct[(it+3)%4]&63]});var at=function(ct){var ut=[];for(it=0;it<4;it++){var dt=_e.getInt16Le();tt!==null&&($?dt^=tt.getInt16Le():tt.putInt16Le(dt)),ut.push(dt&65535)}st=$?0:63;for(var ft=0;ft<ct.length;ft++)for(var pt=0;pt<ct[ft][0];pt++)ct[ft][1](ut);for(it=0;it<4;it++)tt!==null&&($?tt.putInt16Le(ut[it]):ut[it]^=tt.getInt16Le()),et.putInt16Le(ut[it])},lt=null;return lt={start:function(ct,ut){ct&&typeof ct=="string"&&(ct=forge$d.util.createBuffer(ct)),j=!1,_e=forge$d.util.createBuffer(),et=ut||new forge$d.util.createBuffer,tt=ct,lt.output=et},update:function(ct){for(j||_e.putBuffer(ct);_e.length()>=8;)at([[5,rt],[1,nt],[6,rt],[1,nt],[5,rt]])},finish:function(ct){var ut=!0;if($)if(ct)ut=ct(8,_e,!$);else{var dt=_e.length()===8?8:8-_e.length();_e.fillWithByte(dt,dt)}if(ut&&(j=!0,lt.update()),!$&&(ut=_e.length()===0,ut))if(ct)ut=ct(8,et,!$);else{var ft=et.length(),pt=et.at(ft-1);pt>ft?ut=!1:et.truncate(pt)}return ut}},lt};forge$d.rc2.startEncrypting=function(_,a,$){var j=forge$d.rc2.createEncryptionCipher(_,128);return j.start(a,$),j};forge$d.rc2.createEncryptionCipher=function(_,a){return createCipher(_,a,!0)};forge$d.rc2.startDecrypting=function(_,a,$){var j=forge$d.rc2.createDecryptionCipher(_,128);return j.start(a,$),j};forge$d.rc2.createDecryptionCipher=function(_,a){return createCipher(_,a,!1)};var forge$c=forge$s;forge$c.jsbn=forge$c.jsbn||{};var dbits;function BigInteger$2(_,a,$){this.data=[],_!=null&&(typeof _=="number"?this.fromNumber(_,a,$):a==null&&typeof _!="string"?this.fromString(_,256):this.fromString(_,a))}forge$c.jsbn.BigInteger=BigInteger$2;function nbi(){return new BigInteger$2(null)}function am1(_,a,$,j,_e,et){for(;--et>=0;){var tt=a*this.data[_++]+$.data[j]+_e;_e=Math.floor(tt/67108864),$.data[j++]=tt&67108863}return _e}function am2(_,a,$,j,_e,et){for(var tt=a&32767,rt=a>>15;--et>=0;){var nt=this.data[_]&32767,it=this.data[_++]>>15,st=rt*nt+it*tt;nt=tt*nt+((st&32767)<<15)+$.data[j]+(_e&1073741823),_e=(nt>>>30)+(st>>>15)+rt*it+(_e>>>30),$.data[j++]=nt&1073741823}return _e}function am3(_,a,$,j,_e,et){for(var tt=a&16383,rt=a>>14;--et>=0;){var nt=this.data[_]&16383,it=this.data[_++]>>14,st=rt*nt+it*tt;nt=tt*nt+((st&16383)<<14)+$.data[j]+_e,_e=(nt>>28)+(st>>14)+rt*it,$.data[j++]=nt&268435455}return _e}typeof navigator>"u"?(BigInteger$2.prototype.am=am3,dbits=28):navigator.appName=="Microsoft Internet Explorer"?(BigInteger$2.prototype.am=am2,dbits=30):navigator.appName!="Netscape"?(BigInteger$2.prototype.am=am1,dbits=26):(BigInteger$2.prototype.am=am3,dbits=28);BigInteger$2.prototype.DB=dbits;BigInteger$2.prototype.DM=(1<<dbits)-1;BigInteger$2.prototype.DV=1<<dbits;var BI_FP=52;BigInteger$2.prototype.FV=Math.pow(2,BI_FP);BigInteger$2.prototype.F1=BI_FP-dbits;BigInteger$2.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;rr="0".charCodeAt(0);for(vv=0;vv<=9;++vv)BI_RC[rr++]=vv;rr="a".charCodeAt(0);for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;rr="A".charCodeAt(0);for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(_){return BI_RM.charAt(_)}function intAt(_,a){var $=BI_RC[_.charCodeAt(a)];return $??-1}function bnpCopyTo(_){for(var a=this.t-1;a>=0;--a)_.data[a]=this.data[a];_.t=this.t,_.s=this.s}function bnpFromInt(_){this.t=1,this.s=_<0?-1:0,_>0?this.data[0]=_:_<-1?this.data[0]=_+this.DV:this.t=0}function nbv(_){var a=nbi();return a.fromInt(_),a}function bnpFromString(_,a){var $;if(a==16)$=4;else if(a==8)$=3;else if(a==256)$=8;else if(a==2)$=1;else if(a==32)$=5;else if(a==4)$=2;else{this.fromRadix(_,a);return}this.t=0,this.s=0;for(var j=_.length,_e=!1,et=0;--j>=0;){var tt=$==8?_[j]&255:intAt(_,j);if(tt<0){_.charAt(j)=="-"&&(_e=!0);continue}_e=!1,et==0?this.data[this.t++]=tt:et+$>this.DB?(this.data[this.t-1]|=(tt&(1<<this.DB-et)-1)<<et,this.data[this.t++]=tt>>this.DB-et):this.data[this.t-1]|=tt<<et,et+=$,et>=this.DB&&(et-=this.DB)}$==8&&(_[0]&128)!=0&&(this.s=-1,et>0&&(this.data[this.t-1]|=(1<<this.DB-et)-1<<et)),this.clamp(),_e&&BigInteger$2.ZERO.subTo(this,this)}function bnpClamp(){for(var _=this.s&this.DM;this.t>0&&this.data[this.t-1]==_;)--this.t}function bnToString(_){if(this.s<0)return"-"+this.negate().toString(_);var a;if(_==16)a=4;else if(_==8)a=3;else if(_==2)a=1;else if(_==32)a=5;else if(_==4)a=2;else return this.toRadix(_);var $=(1<<a)-1,j,_e=!1,et="",tt=this.t,rt=this.DB-tt*this.DB%a;if(tt-- >0)for(rt<this.DB&&(j=this.data[tt]>>rt)>0&&(_e=!0,et=int2char(j));tt>=0;)rt<a?(j=(this.data[tt]&(1<<rt)-1)<<a-rt,j|=this.data[--tt]>>(rt+=this.DB-a)):(j=this.data[tt]>>(rt-=a)&$,rt<=0&&(rt+=this.DB,--tt)),j>0&&(_e=!0),_e&&(et+=int2char(j));return _e?et:"0"}function bnNegate(){var _=nbi();return BigInteger$2.ZERO.subTo(this,_),_}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(_){var a=this.s-_.s;if(a!=0)return a;var $=this.t;if(a=$-_.t,a!=0)return this.s<0?-a:a;for(;--$>=0;)if((a=this.data[$]-_.data[$])!=0)return a;return 0}function nbits(_){var a=1,$;return($=_>>>16)!=0&&(_=$,a+=16),($=_>>8)!=0&&(_=$,a+=8),($=_>>4)!=0&&(_=$,a+=4),($=_>>2)!=0&&(_=$,a+=2),($=_>>1)!=0&&(_=$,a+=1),a}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this.data[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(_,a){var $;for($=this.t-1;$>=0;--$)a.data[$+_]=this.data[$];for($=_-1;$>=0;--$)a.data[$]=0;a.t=this.t+_,a.s=this.s}function bnpDRShiftTo(_,a){for(var $=_;$<this.t;++$)a.data[$-_]=this.data[$];a.t=Math.max(this.t-_,0),a.s=this.s}function bnpLShiftTo(_,a){var $=_%this.DB,j=this.DB-$,_e=(1<<j)-1,et=Math.floor(_/this.DB),tt=this.s<<$&this.DM,rt;for(rt=this.t-1;rt>=0;--rt)a.data[rt+et+1]=this.data[rt]>>j|tt,tt=(this.data[rt]&_e)<<$;for(rt=et-1;rt>=0;--rt)a.data[rt]=0;a.data[et]=tt,a.t=this.t+et+1,a.s=this.s,a.clamp()}function bnpRShiftTo(_,a){a.s=this.s;var $=Math.floor(_/this.DB);if($>=this.t){a.t=0;return}var j=_%this.DB,_e=this.DB-j,et=(1<<j)-1;a.data[0]=this.data[$]>>j;for(var tt=$+1;tt<this.t;++tt)a.data[tt-$-1]|=(this.data[tt]&et)<<_e,a.data[tt-$]=this.data[tt]>>j;j>0&&(a.data[this.t-$-1]|=(this.s&et)<<_e),a.t=this.t-$,a.clamp()}function bnpSubTo(_,a){for(var $=0,j=0,_e=Math.min(_.t,this.t);$<_e;)j+=this.data[$]-_.data[$],a.data[$++]=j&this.DM,j>>=this.DB;if(_.t<this.t){for(j-=_.s;$<this.t;)j+=this.data[$],a.data[$++]=j&this.DM,j>>=this.DB;j+=this.s}else{for(j+=this.s;$<_.t;)j-=_.data[$],a.data[$++]=j&this.DM,j>>=this.DB;j-=_.s}a.s=j<0?-1:0,j<-1?a.data[$++]=this.DV+j:j>0&&(a.data[$++]=j),a.t=$,a.clamp()}function bnpMultiplyTo(_,a){var $=this.abs(),j=_.abs(),_e=$.t;for(a.t=_e+j.t;--_e>=0;)a.data[_e]=0;for(_e=0;_e<j.t;++_e)a.data[_e+$.t]=$.am(0,j.data[_e],a,_e,0,$.t);a.s=0,a.clamp(),this.s!=_.s&&BigInteger$2.ZERO.subTo(a,a)}function bnpSquareTo(_){for(var a=this.abs(),$=_.t=2*a.t;--$>=0;)_.data[$]=0;for($=0;$<a.t-1;++$){var j=a.am($,a.data[$],_,2*$,0,1);(_.data[$+a.t]+=a.am($+1,2*a.data[$],_,2*$+1,j,a.t-$-1))>=a.DV&&(_.data[$+a.t]-=a.DV,_.data[$+a.t+1]=1)}_.t>0&&(_.data[_.t-1]+=a.am($,a.data[$],_,2*$,0,1)),_.s=0,_.clamp()}function bnpDivRemTo(_,a,$){var j=_.abs();if(!(j.t<=0)){var _e=this.abs();if(_e.t<j.t){a?.fromInt(0),$!=null&&this.copyTo($);return}$==null&&($=nbi());var et=nbi(),tt=this.s,rt=_.s,nt=this.DB-nbits(j.data[j.t-1]);nt>0?(j.lShiftTo(nt,et),_e.lShiftTo(nt,$)):(j.copyTo(et),_e.copyTo($));var it=et.t,st=et.data[it-1];if(st!=0){var ot=st*(1<<this.F1)+(it>1?et.data[it-2]>>this.F2:0),at=this.FV/ot,lt=(1<<this.F1)/ot,ct=1<<this.F2,ut=$.t,dt=ut-it,ft=a??nbi();for(et.dlShiftTo(dt,ft),$.compareTo(ft)>=0&&($.data[$.t++]=1,$.subTo(ft,$)),BigInteger$2.ONE.dlShiftTo(it,ft),ft.subTo(et,et);et.t<it;)et.data[et.t++]=0;for(;--dt>=0;){var pt=$.data[--ut]==st?this.DM:Math.floor($.data[ut]*at+($.data[ut-1]+ct)*lt);if(($.data[ut]+=et.am(0,pt,$,dt,0,it))<pt)for(et.dlShiftTo(dt,ft),$.subTo(ft,$);$.data[ut]<--pt;)$.subTo(ft,$)}a!=null&&($.drShiftTo(it,a),tt!=rt&&BigInteger$2.ZERO.subTo(a,a)),$.t=it,$.clamp(),nt>0&&$.rShiftTo(nt,$),tt<0&&BigInteger$2.ZERO.subTo($,$)}}}function bnMod(_){var a=nbi();return this.abs().divRemTo(_,null,a),this.s<0&&a.compareTo(BigInteger$2.ZERO)>0&&_.subTo(a,a),a}function Classic(_){this.m=_}function cConvert(_){return _.s<0||_.compareTo(this.m)>=0?_.mod(this.m):_}function cRevert(_){return _}function cReduce(_){_.divRemTo(this.m,null,_)}function cMulTo(_,a,$){_.multiplyTo(a,$),this.reduce($)}function cSqrTo(_,a){_.squareTo(a),this.reduce(a)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1)return 0;var _=this.data[0];if((_&1)==0)return 0;var a=_&3;return a=a*(2-(_&15)*a)&15,a=a*(2-(_&255)*a)&255,a=a*(2-((_&65535)*a&65535))&65535,a=a*(2-_*a%this.DV)%this.DV,a>0?this.DV-a:-a}function Montgomery(_){this.m=_,this.mp=_.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<_.DB-15)-1,this.mt2=2*_.t}function montConvert(_){var a=nbi();return _.abs().dlShiftTo(this.m.t,a),a.divRemTo(this.m,null,a),_.s<0&&a.compareTo(BigInteger$2.ZERO)>0&&this.m.subTo(a,a),a}function montRevert(_){var a=nbi();return _.copyTo(a),this.reduce(a),a}function montReduce(_){for(;_.t<=this.mt2;)_.data[_.t++]=0;for(var a=0;a<this.m.t;++a){var $=_.data[a]&32767,j=$*this.mpl+(($*this.mph+(_.data[a]>>15)*this.mpl&this.um)<<15)&_.DM;for($=a+this.m.t,_.data[$]+=this.m.am(0,j,_,a,0,this.m.t);_.data[$]>=_.DV;)_.data[$]-=_.DV,_.data[++$]++}_.clamp(),_.drShiftTo(this.m.t,_),_.compareTo(this.m)>=0&&_.subTo(this.m,_)}function montSqrTo(_,a){_.squareTo(a),this.reduce(a)}function montMulTo(_,a,$){_.multiplyTo(a,$),this.reduce($)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return(this.t>0?this.data[0]&1:this.s)==0}function bnpExp(_,a){if(_>4294967295||_<1)return BigInteger$2.ONE;var $=nbi(),j=nbi(),_e=a.convert(this),et=nbits(_)-1;for(_e.copyTo($);--et>=0;)if(a.sqrTo($,j),(_&1<<et)>0)a.mulTo(j,_e,$);else{var tt=$;$=j,j=tt}return a.revert($)}function bnModPowInt(_,a){var $;return _<256||a.isEven()?$=new Classic(a):$=new Montgomery(a),this.exp(_,$)}BigInteger$2.prototype.copyTo=bnpCopyTo;BigInteger$2.prototype.fromInt=bnpFromInt;BigInteger$2.prototype.fromString=bnpFromString;BigInteger$2.prototype.clamp=bnpClamp;BigInteger$2.prototype.dlShiftTo=bnpDLShiftTo;BigInteger$2.prototype.drShiftTo=bnpDRShiftTo;BigInteger$2.prototype.lShiftTo=bnpLShiftTo;BigInteger$2.prototype.rShiftTo=bnpRShiftTo;BigInteger$2.prototype.subTo=bnpSubTo;BigInteger$2.prototype.multiplyTo=bnpMultiplyTo;BigInteger$2.prototype.squareTo=bnpSquareTo;BigInteger$2.prototype.divRemTo=bnpDivRemTo;BigInteger$2.prototype.invDigit=bnpInvDigit;BigInteger$2.prototype.isEven=bnpIsEven;BigInteger$2.prototype.exp=bnpExp;BigInteger$2.prototype.toString=bnToString;BigInteger$2.prototype.negate=bnNegate;BigInteger$2.prototype.abs=bnAbs;BigInteger$2.prototype.compareTo=bnCompareTo;BigInteger$2.prototype.bitLength=bnBitLength;BigInteger$2.prototype.mod=bnMod;BigInteger$2.prototype.modPowInt=bnModPowInt;BigInteger$2.ZERO=nbv(0);BigInteger$2.ONE=nbv(1);function bnClone(){var _=nbi();return this.copyTo(_),_}function bnIntValue(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function bnByteValue(){return this.t==0?this.s:this.data[0]<<24>>24}function bnShortValue(){return this.t==0?this.s:this.data[0]<<16>>16}function bnpChunkSize(_){return Math.floor(Math.LN2*this.DB/Math.log(_))}function bnSigNum(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function bnpToRadix(_){if(_==null&&(_=10),this.signum()==0||_<2||_>36)return"0";var a=this.chunkSize(_),$=Math.pow(_,a),j=nbv($),_e=nbi(),et=nbi(),tt="";for(this.divRemTo(j,_e,et);_e.signum()>0;)tt=($+et.intValue()).toString(_).substr(1)+tt,_e.divRemTo(j,_e,et);return et.intValue().toString(_)+tt}function bnpFromRadix(_,a){this.fromInt(0),a==null&&(a=10);for(var $=this.chunkSize(a),j=Math.pow(a,$),_e=!1,et=0,tt=0,rt=0;rt<_.length;++rt){var nt=intAt(_,rt);if(nt<0){_.charAt(rt)=="-"&&this.signum()==0&&(_e=!0);continue}tt=a*tt+nt,++et>=$&&(this.dMultiply(j),this.dAddOffset(tt,0),et=0,tt=0)}et>0&&(this.dMultiply(Math.pow(a,et)),this.dAddOffset(tt,0)),_e&&BigInteger$2.ZERO.subTo(this,this)}function bnpFromNumber(_,a,$){if(typeof a=="number")if(_<2)this.fromInt(1);else for(this.fromNumber(_,$),this.testBit(_-1)||this.bitwiseTo(BigInteger$2.ONE.shiftLeft(_-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(a);)this.dAddOffset(2,0),this.bitLength()>_&&this.subTo(BigInteger$2.ONE.shiftLeft(_-1),this);else{var j=new Array,_e=_&7;j.length=(_>>3)+1,a.nextBytes(j),_e>0?j[0]&=(1<<_e)-1:j[0]=0,this.fromString(j,256)}}function bnToByteArray(){var _=this.t,a=new Array;a[0]=this.s;var $=this.DB-_*this.DB%8,j,_e=0;if(_-- >0)for($<this.DB&&(j=this.data[_]>>$)!=(this.s&this.DM)>>$&&(a[_e++]=j|this.s<<this.DB-$);_>=0;)$<8?(j=(this.data[_]&(1<<$)-1)<<8-$,j|=this.data[--_]>>($+=this.DB-8)):(j=this.data[_]>>($-=8)&255,$<=0&&($+=this.DB,--_)),(j&128)!=0&&(j|=-256),_e==0&&(this.s&128)!=(j&128)&&++_e,(_e>0||j!=this.s)&&(a[_e++]=j);return a}function bnEquals(_){return this.compareTo(_)==0}function bnMin(_){return this.compareTo(_)<0?this:_}function bnMax(_){return this.compareTo(_)>0?this:_}function bnpBitwiseTo(_,a,$){var j,_e,et=Math.min(_.t,this.t);for(j=0;j<et;++j)$.data[j]=a(this.data[j],_.data[j]);if(_.t<this.t){for(_e=_.s&this.DM,j=et;j<this.t;++j)$.data[j]=a(this.data[j],_e);$.t=this.t}else{for(_e=this.s&this.DM,j=et;j<_.t;++j)$.data[j]=a(_e,_.data[j]);$.t=_.t}$.s=a(this.s,_.s),$.clamp()}function op_and(_,a){return _&a}function bnAnd(_){var a=nbi();return this.bitwiseTo(_,op_and,a),a}function op_or(_,a){return _|a}function bnOr(_){var a=nbi();return this.bitwiseTo(_,op_or,a),a}function op_xor(_,a){return _^a}function bnXor(_){var a=nbi();return this.bitwiseTo(_,op_xor,a),a}function op_andnot(_,a){return _&~a}function bnAndNot(_){var a=nbi();return this.bitwiseTo(_,op_andnot,a),a}function bnNot(){for(var _=nbi(),a=0;a<this.t;++a)_.data[a]=this.DM&~this.data[a];return _.t=this.t,_.s=~this.s,_}function bnShiftLeft(_){var a=nbi();return _<0?this.rShiftTo(-_,a):this.lShiftTo(_,a),a}function bnShiftRight(_){var a=nbi();return _<0?this.lShiftTo(-_,a):this.rShiftTo(_,a),a}function lbit(_){if(_==0)return-1;var a=0;return(_&65535)==0&&(_>>=16,a+=16),(_&255)==0&&(_>>=8,a+=8),(_&15)==0&&(_>>=4,a+=4),(_&3)==0&&(_>>=2,a+=2),(_&1)==0&&++a,a}function bnGetLowestSetBit(){for(var _=0;_<this.t;++_)if(this.data[_]!=0)return _*this.DB+lbit(this.data[_]);return this.s<0?this.t*this.DB:-1}function cbit(_){for(var a=0;_!=0;)_&=_-1,++a;return a}function bnBitCount(){for(var _=0,a=this.s&this.DM,$=0;$<this.t;++$)_+=cbit(this.data[$]^a);return _}function bnTestBit(_){var a=Math.floor(_/this.DB);return a>=this.t?this.s!=0:(this.data[a]&1<<_%this.DB)!=0}function bnpChangeBit(_,a){var $=BigInteger$2.ONE.shiftLeft(_);return this.bitwiseTo($,a,$),$}function bnSetBit(_){return this.changeBit(_,op_or)}function bnClearBit(_){return this.changeBit(_,op_andnot)}function bnFlipBit(_){return this.changeBit(_,op_xor)}function bnpAddTo(_,a){for(var $=0,j=0,_e=Math.min(_.t,this.t);$<_e;)j+=this.data[$]+_.data[$],a.data[$++]=j&this.DM,j>>=this.DB;if(_.t<this.t){for(j+=_.s;$<this.t;)j+=this.data[$],a.data[$++]=j&this.DM,j>>=this.DB;j+=this.s}else{for(j+=this.s;$<_.t;)j+=_.data[$],a.data[$++]=j&this.DM,j>>=this.DB;j+=_.s}a.s=j<0?-1:0,j>0?a.data[$++]=j:j<-1&&(a.data[$++]=this.DV+j),a.t=$,a.clamp()}function bnAdd(_){var a=nbi();return this.addTo(_,a),a}function bnSubtract(_){var a=nbi();return this.subTo(_,a),a}function bnMultiply(_){var a=nbi();return this.multiplyTo(_,a),a}function bnDivide(_){var a=nbi();return this.divRemTo(_,a,null),a}function bnRemainder(_){var a=nbi();return this.divRemTo(_,null,a),a}function bnDivideAndRemainder(_){var a=nbi(),$=nbi();return this.divRemTo(_,a,$),new Array(a,$)}function bnpDMultiply(_){this.data[this.t]=this.am(0,_-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(_,a){if(_!=0){for(;this.t<=a;)this.data[this.t++]=0;for(this.data[a]+=_;this.data[a]>=this.DV;)this.data[a]-=this.DV,++a>=this.t&&(this.data[this.t++]=0),++this.data[a]}}function NullExp(){}function nNop(_){return _}function nMulTo(_,a,$){_.multiplyTo(a,$)}function nSqrTo(_,a){_.squareTo(a)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(_){return this.exp(_,new NullExp)}function bnpMultiplyLowerTo(_,a,$){var j=Math.min(this.t+_.t,a);for($.s=0,$.t=j;j>0;)$.data[--j]=0;var _e;for(_e=$.t-this.t;j<_e;++j)$.data[j+this.t]=this.am(0,_.data[j],$,j,0,this.t);for(_e=Math.min(_.t,a);j<_e;++j)this.am(0,_.data[j],$,j,0,a-j);$.clamp()}function bnpMultiplyUpperTo(_,a,$){--a;var j=$.t=this.t+_.t-a;for($.s=0;--j>=0;)$.data[j]=0;for(j=Math.max(a-this.t,0);j<_.t;++j)$.data[this.t+j-a]=this.am(a-j,_.data[j],$,0,0,this.t+j-a);$.clamp(),$.drShiftTo(1,$)}function Barrett(_){this.r2=nbi(),this.q3=nbi(),BigInteger$2.ONE.dlShiftTo(2*_.t,this.r2),this.mu=this.r2.divide(_),this.m=_}function barrettConvert(_){if(_.s<0||_.t>2*this.m.t)return _.mod(this.m);if(_.compareTo(this.m)<0)return _;var a=nbi();return _.copyTo(a),this.reduce(a),a}function barrettRevert(_){return _}function barrettReduce(_){for(_.drShiftTo(this.m.t-1,this.r2),_.t>this.m.t+1&&(_.t=this.m.t+1,_.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);_.compareTo(this.r2)<0;)_.dAddOffset(1,this.m.t+1);for(_.subTo(this.r2,_);_.compareTo(this.m)>=0;)_.subTo(this.m,_)}function barrettSqrTo(_,a){_.squareTo(a),this.reduce(a)}function barrettMulTo(_,a,$){_.multiplyTo(a,$),this.reduce($)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(_,a){var $=_.bitLength(),j,_e=nbv(1),et;if($<=0)return _e;$<18?j=1:$<48?j=3:$<144?j=4:$<768?j=5:j=6,$<8?et=new Classic(a):a.isEven()?et=new Barrett(a):et=new Montgomery(a);var tt=new Array,rt=3,nt=j-1,it=(1<<j)-1;if(tt[1]=et.convert(this),j>1){var st=nbi();for(et.sqrTo(tt[1],st);rt<=it;)tt[rt]=nbi(),et.mulTo(st,tt[rt-2],tt[rt]),rt+=2}var ot=_.t-1,at,lt=!0,ct=nbi(),ut;for($=nbits(_.data[ot])-1;ot>=0;){for($>=nt?at=_.data[ot]>>$-nt&it:(at=(_.data[ot]&(1<<$+1)-1)<<nt-$,ot>0&&(at|=_.data[ot-1]>>this.DB+$-nt)),rt=j;(at&1)==0;)at>>=1,--rt;if(($-=rt)<0&&($+=this.DB,--ot),lt)tt[at].copyTo(_e),lt=!1;else{for(;rt>1;)et.sqrTo(_e,ct),et.sqrTo(ct,_e),rt-=2;rt>0?et.sqrTo(_e,ct):(ut=_e,_e=ct,ct=ut),et.mulTo(ct,tt[at],_e)}for(;ot>=0&&(_.data[ot]&1<<$)==0;)et.sqrTo(_e,ct),ut=_e,_e=ct,ct=ut,--$<0&&($=this.DB-1,--ot)}return et.revert(_e)}function bnGCD(_){var a=this.s<0?this.negate():this.clone(),$=_.s<0?_.negate():_.clone();if(a.compareTo($)<0){var j=a;a=$,$=j}var _e=a.getLowestSetBit(),et=$.getLowestSetBit();if(et<0)return a;for(_e<et&&(et=_e),et>0&&(a.rShiftTo(et,a),$.rShiftTo(et,$));a.signum()>0;)(_e=a.getLowestSetBit())>0&&a.rShiftTo(_e,a),(_e=$.getLowestSetBit())>0&&$.rShiftTo(_e,$),a.compareTo($)>=0?(a.subTo($,a),a.rShiftTo(1,a)):($.subTo(a,$),$.rShiftTo(1,$));return et>0&&$.lShiftTo(et,$),$}function bnpModInt(_){if(_<=0)return 0;var a=this.DV%_,$=this.s<0?_-1:0;if(this.t>0)if(a==0)$=this.data[0]%_;else for(var j=this.t-1;j>=0;--j)$=(a*$+this.data[j])%_;return $}function bnModInverse(_){var a=_.isEven();if(this.isEven()&&a||_.signum()==0)return BigInteger$2.ZERO;for(var $=_.clone(),j=this.clone(),_e=nbv(1),et=nbv(0),tt=nbv(0),rt=nbv(1);$.signum()!=0;){for(;$.isEven();)$.rShiftTo(1,$),a?((!_e.isEven()||!et.isEven())&&(_e.addTo(this,_e),et.subTo(_,et)),_e.rShiftTo(1,_e)):et.isEven()||et.subTo(_,et),et.rShiftTo(1,et);for(;j.isEven();)j.rShiftTo(1,j),a?((!tt.isEven()||!rt.isEven())&&(tt.addTo(this,tt),rt.subTo(_,rt)),tt.rShiftTo(1,tt)):rt.isEven()||rt.subTo(_,rt),rt.rShiftTo(1,rt);$.compareTo(j)>=0?($.subTo(j,$),a&&_e.subTo(tt,_e),et.subTo(rt,et)):(j.subTo($,j),a&&tt.subTo(_e,tt),rt.subTo(et,rt))}if(j.compareTo(BigInteger$2.ONE)!=0)return BigInteger$2.ZERO;if(rt.compareTo(_)>=0)return rt.subtract(_);if(rt.signum()<0)rt.addTo(_,rt);else return rt;return rt.signum()<0?rt.add(_):rt}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(_){var a,$=this.abs();if($.t==1&&$.data[0]<=lowprimes[lowprimes.length-1]){for(a=0;a<lowprimes.length;++a)if($.data[0]==lowprimes[a])return!0;return!1}if($.isEven())return!1;for(a=1;a<lowprimes.length;){for(var j=lowprimes[a],_e=a+1;_e<lowprimes.length&&j<lplim;)j*=lowprimes[_e++];for(j=$.modInt(j);a<_e;)if(j%lowprimes[a++]==0)return!1}return $.millerRabin(_)}function bnpMillerRabin(_){var a=this.subtract(BigInteger$2.ONE),$=a.getLowestSetBit();if($<=0)return!1;for(var j=a.shiftRight($),_e=bnGetPrng(),et,tt=0;tt<_;++tt){do et=new BigInteger$2(this.bitLength(),_e);while(et.compareTo(BigInteger$2.ONE)<=0||et.compareTo(a)>=0);var rt=et.modPow(j,this);if(rt.compareTo(BigInteger$2.ONE)!=0&&rt.compareTo(a)!=0){for(var nt=1;nt++<$&&rt.compareTo(a)!=0;)if(rt=rt.modPowInt(2,this),rt.compareTo(BigInteger$2.ONE)==0)return!1;if(rt.compareTo(a)!=0)return!1}}return!0}function bnGetPrng(){return{nextBytes:function(_){for(var a=0;a<_.length;++a)_[a]=Math.floor(Math.random()*256)}}}BigInteger$2.prototype.chunkSize=bnpChunkSize;BigInteger$2.prototype.toRadix=bnpToRadix;BigInteger$2.prototype.fromRadix=bnpFromRadix;BigInteger$2.prototype.fromNumber=bnpFromNumber;BigInteger$2.prototype.bitwiseTo=bnpBitwiseTo;BigInteger$2.prototype.changeBit=bnpChangeBit;BigInteger$2.prototype.addTo=bnpAddTo;BigInteger$2.prototype.dMultiply=bnpDMultiply;BigInteger$2.prototype.dAddOffset=bnpDAddOffset;BigInteger$2.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger$2.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger$2.prototype.modInt=bnpModInt;BigInteger$2.prototype.millerRabin=bnpMillerRabin;BigInteger$2.prototype.clone=bnClone;BigInteger$2.prototype.intValue=bnIntValue;BigInteger$2.prototype.byteValue=bnByteValue;BigInteger$2.prototype.shortValue=bnShortValue;BigInteger$2.prototype.signum=bnSigNum;BigInteger$2.prototype.toByteArray=bnToByteArray;BigInteger$2.prototype.equals=bnEquals;BigInteger$2.prototype.min=bnMin;BigInteger$2.prototype.max=bnMax;BigInteger$2.prototype.and=bnAnd;BigInteger$2.prototype.or=bnOr;BigInteger$2.prototype.xor=bnXor;BigInteger$2.prototype.andNot=bnAndNot;BigInteger$2.prototype.not=bnNot;BigInteger$2.prototype.shiftLeft=bnShiftLeft;BigInteger$2.prototype.shiftRight=bnShiftRight;BigInteger$2.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger$2.prototype.bitCount=bnBitCount;BigInteger$2.prototype.testBit=bnTestBit;BigInteger$2.prototype.setBit=bnSetBit;BigInteger$2.prototype.clearBit=bnClearBit;BigInteger$2.prototype.flipBit=bnFlipBit;BigInteger$2.prototype.add=bnAdd;BigInteger$2.prototype.subtract=bnSubtract;BigInteger$2.prototype.multiply=bnMultiply;BigInteger$2.prototype.divide=bnDivide;BigInteger$2.prototype.remainder=bnRemainder;BigInteger$2.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger$2.prototype.modPow=bnModPow;BigInteger$2.prototype.modInverse=bnModInverse;BigInteger$2.prototype.pow=bnPow;BigInteger$2.prototype.gcd=bnGCD;BigInteger$2.prototype.isProbablePrime=bnIsProbablePrime;var forge$b=forge$s,sha1=forge$b.sha1=forge$b.sha1||{};forge$b.md.sha1=forge$b.md.algorithms.sha1=sha1;sha1.create=function(){_initialized$1||_init$1();var _=null,a=forge$b.util.createBuffer(),$=new Array(80),j={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return j.start=function(){j.messageLength=0,j.fullMessageLength=j.messageLength64=[];for(var _e=j.messageLengthSize/4,et=0;et<_e;++et)j.fullMessageLength.push(0);return a=forge$b.util.createBuffer(),_={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},j},j.start(),j.update=function(_e,et){et==="utf8"&&(_e=forge$b.util.encodeUtf8(_e));var tt=_e.length;j.messageLength+=tt,tt=[tt/4294967296>>>0,tt>>>0];for(var rt=j.fullMessageLength.length-1;rt>=0;--rt)j.fullMessageLength[rt]+=tt[1],tt[1]=tt[0]+(j.fullMessageLength[rt]/4294967296>>>0),j.fullMessageLength[rt]=j.fullMessageLength[rt]>>>0,tt[0]=tt[1]/4294967296>>>0;return a.putBytes(_e),_update$1(_,$,a),(a.read>2048||a.length()===0)&&a.compact(),j},j.digest=function(){var _e=forge$b.util.createBuffer();_e.putBytes(a.bytes());var et=j.fullMessageLength[j.fullMessageLength.length-1]+j.messageLengthSize,tt=et&j.blockLength-1;_e.putBytes(_padding$1.substr(0,j.blockLength-tt));for(var rt,nt,it=j.fullMessageLength[0]*8,st=0;st<j.fullMessageLength.length-1;++st)rt=j.fullMessageLength[st+1]*8,nt=rt/4294967296>>>0,it+=nt,_e.putInt32(it>>>0),it=rt>>>0;_e.putInt32(it);var ot={h0:_.h0,h1:_.h1,h2:_.h2,h3:_.h3,h4:_.h4};_update$1(ot,$,_e);var at=forge$b.util.createBuffer();return at.putInt32(ot.h0),at.putInt32(ot.h1),at.putInt32(ot.h2),at.putInt32(ot.h3),at.putInt32(ot.h4),at},j};var _padding$1=null,_initialized$1=!1;function _init$1(){_padding$1=String.fromCharCode(128),_padding$1+=forge$b.util.fillString(String.fromCharCode(0),64),_initialized$1=!0}function _update$1(_,a,$){for(var j,_e,et,tt,rt,nt,it,st,ot=$.length();ot>=64;){for(_e=_.h0,et=_.h1,tt=_.h2,rt=_.h3,nt=_.h4,st=0;st<16;++st)j=$.getInt32(),a[st]=j,it=rt^et&(tt^rt),j=(_e<<5|_e>>>27)+it+nt+1518500249+j,nt=rt,rt=tt,tt=(et<<30|et>>>2)>>>0,et=_e,_e=j;for(;st<20;++st)j=a[st-3]^a[st-8]^a[st-14]^a[st-16],j=j<<1|j>>>31,a[st]=j,it=rt^et&(tt^rt),j=(_e<<5|_e>>>27)+it+nt+1518500249+j,nt=rt,rt=tt,tt=(et<<30|et>>>2)>>>0,et=_e,_e=j;for(;st<32;++st)j=a[st-3]^a[st-8]^a[st-14]^a[st-16],j=j<<1|j>>>31,a[st]=j,it=et^tt^rt,j=(_e<<5|_e>>>27)+it+nt+1859775393+j,nt=rt,rt=tt,tt=(et<<30|et>>>2)>>>0,et=_e,_e=j;for(;st<40;++st)j=a[st-6]^a[st-16]^a[st-28]^a[st-32],j=j<<2|j>>>30,a[st]=j,it=et^tt^rt,j=(_e<<5|_e>>>27)+it+nt+1859775393+j,nt=rt,rt=tt,tt=(et<<30|et>>>2)>>>0,et=_e,_e=j;for(;st<60;++st)j=a[st-6]^a[st-16]^a[st-28]^a[st-32],j=j<<2|j>>>30,a[st]=j,it=et&tt|rt&(et^tt),j=(_e<<5|_e>>>27)+it+nt+2400959708+j,nt=rt,rt=tt,tt=(et<<30|et>>>2)>>>0,et=_e,_e=j;for(;st<80;++st)j=a[st-6]^a[st-16]^a[st-28]^a[st-32],j=j<<2|j>>>30,a[st]=j,it=et^tt^rt,j=(_e<<5|_e>>>27)+it+nt+3395469782+j,nt=rt,rt=tt,tt=(et<<30|et>>>2)>>>0,et=_e,_e=j;_.h0=_.h0+_e|0,_.h1=_.h1+et|0,_.h2=_.h2+tt|0,_.h3=_.h3+rt|0,_.h4=_.h4+nt|0,ot-=64}}var forge$a=forge$s,pkcs1=forge$a.pkcs1=forge$a.pkcs1||{};pkcs1.encode_rsa_oaep=function(_,a,$){var j,_e,et,tt;typeof $=="string"?(j=$,_e=arguments[3]||void 0,et=arguments[4]||void 0):$&&(j=$.label||void 0,_e=$.seed||void 0,et=$.md||void 0,$.mgf1&&$.mgf1.md&&(tt=$.mgf1.md)),et?et.start():et=forge$a.md.sha1.create(),tt||(tt=et);var rt=Math.ceil(_.n.bitLength()/8),nt=rt-2*et.digestLength-2;if(a.length>nt){var it=new Error("RSAES-OAEP input message length is too long.");throw it.length=a.length,it.maxLength=nt,it}j||(j=""),et.update(j,"raw");for(var st=et.digest(),ot="",at=nt-a.length,lt=0;lt<at;lt++)ot+="\0";var ct=st.getBytes()+ot+""+a;if(!_e)_e=forge$a.random.getBytes(et.digestLength);else if(_e.length!==et.digestLength){var it=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw it.seedLength=_e.length,it.digestLength=et.digestLength,it}var ut=rsa_mgf1(_e,rt-et.digestLength-1,tt),dt=forge$a.util.xorBytes(ct,ut,ct.length),ft=rsa_mgf1(dt,et.digestLength,tt),pt=forge$a.util.xorBytes(_e,ft,_e.length);return"\0"+pt+dt};pkcs1.decode_rsa_oaep=function(_,a,$){var j,_e,et;typeof $=="string"?(j=$,_e=arguments[3]||void 0):$&&(j=$.label||void 0,_e=$.md||void 0,$.mgf1&&$.mgf1.md&&(et=$.mgf1.md));var tt=Math.ceil(_.n.bitLength()/8);if(a.length!==tt){var dt=new Error("RSAES-OAEP encoded message length is invalid.");throw dt.length=a.length,dt.expectedLength=tt,dt}if(_e===void 0?_e=forge$a.md.sha1.create():_e.start(),et||(et=_e),tt<2*_e.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");j||(j=""),_e.update(j,"raw");for(var rt=_e.digest().getBytes(),nt=a.charAt(0),it=a.substring(1,_e.digestLength+1),st=a.substring(1+_e.digestLength),ot=rsa_mgf1(st,_e.digestLength,et),at=forge$a.util.xorBytes(it,ot,it.length),lt=rsa_mgf1(at,tt-_e.digestLength-1,et),ct=forge$a.util.xorBytes(st,lt,st.length),ut=ct.substring(0,_e.digestLength),dt=nt!=="\0",ft=0;ft<_e.digestLength;++ft)dt|=rt.charAt(ft)!==ut.charAt(ft);for(var pt=1,yt=_e.digestLength,mt=_e.digestLength;mt<ct.length;mt++){var _t=ct.charCodeAt(mt),vt=_t&1^1,ht=pt?65534:0;dt|=_t&ht,pt=pt&vt,yt+=pt}if(dt||ct.charCodeAt(yt)!==1)throw new Error("Invalid RSAES-OAEP padding.");return ct.substring(yt+1)};function rsa_mgf1(_,a,$){$||($=forge$a.md.sha1.create());for(var j="",_e=Math.ceil(a/$.digestLength),et=0;et<_e;++et){var tt=String.fromCharCode(et>>24&255,et>>16&255,et>>8&255,et&255);$.start(),$.update(_+tt),j+=$.digest().getBytes()}return j.substring(0,a)}var forge$9=forge$s;(function(){if(forge$9.prime)return;var _=forge$9.prime=forge$9.prime||{},a=forge$9.jsbn.BigInteger,$=[6,4,2,4,2,4,6,2],j=new a(null);j.fromInt(30);var _e=function(ot,at){return ot|at};_.generateProbablePrime=function(ot,at,lt){typeof at=="function"&&(lt=at,at={}),at=at||{};var ct=at.algorithm||"PRIMEINC";typeof ct=="string"&&(ct={name:ct}),ct.options=ct.options||{};var ut=at.prng||forge$9.random,dt={nextBytes:function(ft){for(var pt=ut.getBytesSync(ft.length),yt=0;yt<ft.length;++yt)ft[yt]=pt.charCodeAt(yt)}};if(ct.name==="PRIMEINC")return et(ot,dt,ct.options,lt);throw new Error("Invalid prime generation algorithm: "+ct.name)};function et(ot,at,lt,ct){return"workers"in lt?nt(ot,at,lt,ct):tt(ot,at,lt,ct)}function tt(ot,at,lt,ct){var ut=it(ot,at),dt=0,ft=st(ut.bitLength());"millerRabinTests"in lt&&(ft=lt.millerRabinTests);var pt=10;"maxBlockTime"in lt&&(pt=lt.maxBlockTime),rt(ut,ot,at,dt,ft,pt,ct)}function rt(ot,at,lt,ct,ut,dt,ft){var pt=+new Date;do{if(ot.bitLength()>at&&(ot=it(at,lt)),ot.isProbablePrime(ut))return ft(null,ot);ot.dAddOffset($[ct++%8],0)}while(dt<0||+new Date-pt<dt);forge$9.util.setImmediate(function(){rt(ot,at,lt,ct,ut,dt,ft)})}function nt(ot,at,lt,ct){if(typeof Worker>"u")return tt(ot,at,lt,ct);var ut=it(ot,at),dt=lt.workers,ft=lt.workLoad||100,pt=ft*30/8,yt=lt.workerScript||"forge/prime.worker.js";if(dt===-1)return forge$9.util.estimateCores(function(_t,vt){_t&&(vt=2),dt=vt-1,mt()});mt();function mt(){dt=Math.max(1,dt);for(var _t=[],vt=0;vt<dt;++vt)_t[vt]=new Worker(yt);for(var vt=0;vt<dt;++vt)_t[vt].addEventListener("message",St);var ht=!1;function St(It){if(!ht){var Lt=It.data;if(Lt.found){for(var Mt=0;Mt<_t.length;++Mt)_t[Mt].terminate();return ht=!0,ct(null,new a(Lt.prime,16))}ut.bitLength()>ot&&(ut=it(ot,at));var Kt=ut.toString(16);It.target.postMessage({hex:Kt,workLoad:ft}),ut.dAddOffset(pt,0)}}}}function it(ot,at){var lt=new a(ot,at),ct=ot-1;return lt.testBit(ct)||lt.bitwiseTo(a.ONE.shiftLeft(ct),_e,lt),lt.dAddOffset(31-lt.mod(j).byteValue(),0),lt}function st(ot){return ot<=100?27:ot<=150?18:ot<=200?15:ot<=250?12:ot<=300?9:ot<=350?8:ot<=400?7:ot<=500?6:ot<=600?5:ot<=800?4:ot<=1250?3:2}})();var forge$8=forge$s;if(typeof BigInteger$1>"u")var BigInteger$1=forge$8.jsbn.BigInteger;var _crypto=forge$8.util.isNodejs?require$$1:null,asn1$4=forge$8.asn1,util=forge$8.util;forge$8.pki=forge$8.pki||{};forge$8.pki.rsa=forge$8.rsa=forge$8.rsa||{};var pki$3=forge$8.pki,GCD_30_DELTA=[6,4,2,4,2,4,6,2],privateKeyValidator={name:"PrivateKeyInfo",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},rsaPrivateKeyValidator={name:"RSAPrivateKey",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},rsaPublicKeyValidator={name:"RSAPublicKey",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},publicKeyValidator$1=forge$8.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},digestInfoValidator={name:"DigestInfo",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},emsaPkcs1v15encode=function(_){var a;if(_.algorithm in pki$3.oids)a=pki$3.oids[_.algorithm];else{var $=new Error("Unknown message digest algorithm.");throw $.algorithm=_.algorithm,$}var j=asn1$4.oidToDer(a).getBytes(),_e=asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[]),et=asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[]);et.value.push(asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OID,!1,j)),et.value.push(asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.NULL,!1,""));var tt=asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OCTETSTRING,!1,_.digest().getBytes());return _e.value.push(et),_e.value.push(tt),asn1$4.toDer(_e).getBytes()},_modPow=function(_,a,$){if($)return _.modPow(a.e,a.n);if(!a.p||!a.q)return _.modPow(a.d,a.n);a.dP||(a.dP=a.d.mod(a.p.subtract(BigInteger$1.ONE))),a.dQ||(a.dQ=a.d.mod(a.q.subtract(BigInteger$1.ONE))),a.qInv||(a.qInv=a.q.modInverse(a.p));var j;do j=new BigInteger$1(forge$8.util.bytesToHex(forge$8.random.getBytes(a.n.bitLength()/8)),16);while(j.compareTo(a.n)>=0||!j.gcd(a.n).equals(BigInteger$1.ONE));_=_.multiply(j.modPow(a.e,a.n)).mod(a.n);for(var _e=_.mod(a.p).modPow(a.dP,a.p),et=_.mod(a.q).modPow(a.dQ,a.q);_e.compareTo(et)<0;)_e=_e.add(a.p);var tt=_e.subtract(et).multiply(a.qInv).mod(a.p).multiply(a.q).add(et);return tt=tt.multiply(j.modInverse(a.n)).mod(a.n),tt};pki$3.rsa.encrypt=function(_,a,$){var j=$,_e,et=Math.ceil(a.n.bitLength()/8);$!==!1&&$!==!0?(j=$===2,_e=_encodePkcs1_v1_5(_,a,$)):(_e=forge$8.util.createBuffer(),_e.putBytes(_));for(var tt=new BigInteger$1(_e.toHex(),16),rt=_modPow(tt,a,j),nt=rt.toString(16),it=forge$8.util.createBuffer(),st=et-Math.ceil(nt.length/2);st>0;)it.putByte(0),--st;return it.putBytes(forge$8.util.hexToBytes(nt)),it.getBytes()};pki$3.rsa.decrypt=function(_,a,$,j){var _e=Math.ceil(a.n.bitLength()/8);if(_.length!==_e){var et=new Error("Encrypted message length is invalid.");throw et.length=_.length,et.expected=_e,et}var tt=new BigInteger$1(forge$8.util.createBuffer(_).toHex(),16);if(tt.compareTo(a.n)>=0)throw new Error("Encrypted message is invalid.");for(var rt=_modPow(tt,a,$),nt=rt.toString(16),it=forge$8.util.createBuffer(),st=_e-Math.ceil(nt.length/2);st>0;)it.putByte(0),--st;return it.putBytes(forge$8.util.hexToBytes(nt)),j!==!1?_decodePkcs1_v1_5(it.getBytes(),a,$):it.getBytes()};pki$3.rsa.createKeyPairGenerationState=function(_,a,$){typeof _=="string"&&(_=parseInt(_,10)),_=_||2048,$=$||{};var j=$.prng||forge$8.random,_e={nextBytes:function(rt){for(var nt=j.getBytesSync(rt.length),it=0;it<rt.length;++it)rt[it]=nt.charCodeAt(it)}},et=$.algorithm||"PRIMEINC",tt;if(et==="PRIMEINC")tt={algorithm:et,state:0,bits:_,rng:_e,eInt:a||65537,e:new BigInteger$1(null),p:null,q:null,qBits:_>>1,pBits:_-(_>>1),pqState:0,num:null,keys:null},tt.e.fromInt(tt.eInt);else throw new Error("Invalid key generation algorithm: "+et);return tt};pki$3.rsa.stepKeyPairGenerationState=function(_,a){"algorithm"in _||(_.algorithm="PRIMEINC");var $=new BigInteger$1(null);$.fromInt(30);for(var j=0,_e=function(ot,at){return ot|at},et=+new Date,tt,rt=0;_.keys===null&&(a<=0||rt<a);){if(_.state===0){var nt=_.p===null?_.pBits:_.qBits,it=nt-1;_.pqState===0?(_.num=new BigInteger$1(nt,_.rng),_.num.testBit(it)||_.num.bitwiseTo(BigInteger$1.ONE.shiftLeft(it),_e,_.num),_.num.dAddOffset(31-_.num.mod($).byteValue(),0),j=0,++_.pqState):_.pqState===1?_.num.bitLength()>nt?_.pqState=0:_.num.isProbablePrime(_getMillerRabinTests(_.num.bitLength()))?++_.pqState:_.num.dAddOffset(GCD_30_DELTA[j++%8],0):_.pqState===2?_.pqState=_.num.subtract(BigInteger$1.ONE).gcd(_.e).compareTo(BigInteger$1.ONE)===0?3:0:_.pqState===3&&(_.pqState=0,_.p===null?_.p=_.num:_.q=_.num,_.p!==null&&_.q!==null&&++_.state,_.num=null)}else if(_.state===1)_.p.compareTo(_.q)<0&&(_.num=_.p,_.p=_.q,_.q=_.num),++_.state;else if(_.state===2)_.p1=_.p.subtract(BigInteger$1.ONE),_.q1=_.q.subtract(BigInteger$1.ONE),_.phi=_.p1.multiply(_.q1),++_.state;else if(_.state===3)_.phi.gcd(_.e).compareTo(BigInteger$1.ONE)===0?++_.state:(_.p=null,_.q=null,_.state=0);else if(_.state===4)_.n=_.p.multiply(_.q),_.n.bitLength()===_.bits?++_.state:(_.q=null,_.state=0);else if(_.state===5){var st=_.e.modInverse(_.phi);_.keys={privateKey:pki$3.rsa.setPrivateKey(_.n,_.e,st,_.p,_.q,st.mod(_.p1),st.mod(_.q1),_.q.modInverse(_.p)),publicKey:pki$3.rsa.setPublicKey(_.n,_.e)}}tt=+new Date,rt+=tt-et,et=tt}return _.keys!==null};pki$3.rsa.generateKeyPair=function(_,a,$,j){if(arguments.length===1?typeof _=="object"?($=_,_=void 0):typeof _=="function"&&(j=_,_=void 0):arguments.length===2?typeof _=="number"?typeof a=="function"?(j=a,a=void 0):typeof a!="number"&&($=a,a=void 0):($=_,j=a,_=void 0,a=void 0):arguments.length===3&&(typeof a=="number"?typeof $=="function"&&(j=$,$=void 0):(j=$,$=a,a=void 0)),$=$||{},_===void 0&&(_=$.bits||2048),a===void 0&&(a=$.e||65537),!$.prng&&_>=256&&_<=16384&&(a===65537||a===3)){if(j){if(_detectNodeCrypto("generateKeyPair"))return _crypto.generateKeyPair("rsa",{modulusLength:_,publicExponent:a,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(rt,nt,it){if(rt)return j(rt);j(null,{privateKey:pki$3.privateKeyFromPem(it),publicKey:pki$3.publicKeyFromPem(nt)})});if(_detectSubtleCrypto("generateKey")&&_detectSubtleCrypto("exportKey"))return util.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:_,publicExponent:_intToUint8Array(a),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(rt){return util.globalScope.crypto.subtle.exportKey("pkcs8",rt.privateKey)}).then(void 0,function(rt){j(rt)}).then(function(rt){if(rt){var nt=pki$3.privateKeyFromAsn1(asn1$4.fromDer(forge$8.util.createBuffer(rt)));j(null,{privateKey:nt,publicKey:pki$3.setRsaPublicKey(nt.n,nt.e)})}});if(_detectSubtleMsCrypto("generateKey")&&_detectSubtleMsCrypto("exportKey")){var _e=util.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:_,publicExponent:_intToUint8Array(a),hash:{name:"SHA-256"}},!0,["sign","verify"]);_e.oncomplete=function(rt){var nt=rt.target.result,it=util.globalScope.msCrypto.subtle.exportKey("pkcs8",nt.privateKey);it.oncomplete=function(st){var ot=st.target.result,at=pki$3.privateKeyFromAsn1(asn1$4.fromDer(forge$8.util.createBuffer(ot)));j(null,{privateKey:at,publicKey:pki$3.setRsaPublicKey(at.n,at.e)})},it.onerror=function(st){j(st)}},_e.onerror=function(rt){j(rt)};return}}else if(_detectNodeCrypto("generateKeyPairSync")){var et=_crypto.generateKeyPairSync("rsa",{modulusLength:_,publicExponent:a,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:pki$3.privateKeyFromPem(et.privateKey),publicKey:pki$3.publicKeyFromPem(et.publicKey)}}}var tt=pki$3.rsa.createKeyPairGenerationState(_,a,$);if(!j)return pki$3.rsa.stepKeyPairGenerationState(tt,0),tt.keys;_generateKeyPair(tt,$,j)};pki$3.setRsaPublicKey=pki$3.rsa.setPublicKey=function(_,a){var $={n:_,e:a};return $.encrypt=function(j,_e,et){if(typeof _e=="string"?_e=_e.toUpperCase():_e===void 0&&(_e="RSAES-PKCS1-V1_5"),_e==="RSAES-PKCS1-V1_5")_e={encode:function(rt,nt,it){return _encodePkcs1_v1_5(rt,nt,2).getBytes()}};else if(_e==="RSA-OAEP"||_e==="RSAES-OAEP")_e={encode:function(rt,nt){return forge$8.pkcs1.encode_rsa_oaep(nt,rt,et)}};else if(["RAW","NONE","NULL",null].indexOf(_e)!==-1)_e={encode:function(rt){return rt}};else if(typeof _e=="string")throw new Error('Unsupported encryption scheme: "'+_e+'".');var tt=_e.encode(j,$,!0);return pki$3.rsa.encrypt(tt,$,!0)},$.verify=function(j,_e,et,tt){typeof et=="string"?et=et.toUpperCase():et===void 0&&(et="RSASSA-PKCS1-V1_5"),tt===void 0&&(tt={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in tt||(tt._parseAllDigestBytes=!0),et==="RSASSA-PKCS1-V1_5"?et={verify:function(nt,it){it=_decodePkcs1_v1_5(it,$,!0);var st=asn1$4.fromDer(it,{parseAllBytes:tt._parseAllDigestBytes}),ot={},at=[];if(!asn1$4.validate(st,digestInfoValidator,ot,at)){var lt=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw lt.errors=at,lt}var ct=asn1$4.derToOid(ot.algorithmIdentifier);if(!(ct===forge$8.oids.md2||ct===forge$8.oids.md5||ct===forge$8.oids.sha1||ct===forge$8.oids.sha224||ct===forge$8.oids.sha256||ct===forge$8.oids.sha384||ct===forge$8.oids.sha512||ct===forge$8.oids["sha512-224"]||ct===forge$8.oids["sha512-256"])){var lt=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw lt.oid=ct,lt}if((ct===forge$8.oids.md2||ct===forge$8.oids.md5)&&!("parameters"in ot))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return nt===ot.digest}}:(et==="NONE"||et==="NULL"||et===null)&&(et={verify:function(nt,it){return it=_decodePkcs1_v1_5(it,$,!0),nt===it}});var rt=pki$3.rsa.decrypt(_e,$,!0,!1);return et.verify(j,rt,$.n.bitLength())},$};pki$3.setRsaPrivateKey=pki$3.rsa.setPrivateKey=function(_,a,$,j,_e,et,tt,rt){var nt={n:_,e:a,d:$,p:j,q:_e,dP:et,dQ:tt,qInv:rt};return nt.decrypt=function(it,st,ot){typeof st=="string"?st=st.toUpperCase():st===void 0&&(st="RSAES-PKCS1-V1_5");var at=pki$3.rsa.decrypt(it,nt,!1,!1);if(st==="RSAES-PKCS1-V1_5")st={decode:_decodePkcs1_v1_5};else if(st==="RSA-OAEP"||st==="RSAES-OAEP")st={decode:function(lt,ct){return forge$8.pkcs1.decode_rsa_oaep(ct,lt,ot)}};else if(["RAW","NONE","NULL",null].indexOf(st)!==-1)st={decode:function(lt){return lt}};else throw new Error('Unsupported encryption scheme: "'+st+'".');return st.decode(at,nt,!1)},nt.sign=function(it,st){var ot=!1;typeof st=="string"&&(st=st.toUpperCase()),st===void 0||st==="RSASSA-PKCS1-V1_5"?(st={encode:emsaPkcs1v15encode},ot=1):(st==="NONE"||st==="NULL"||st===null)&&(st={encode:function(){return it}},ot=1);var at=st.encode(it,nt.n.bitLength());return pki$3.rsa.encrypt(at,nt,ot)},nt};pki$3.wrapRsaPrivateKey=function(_){return asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,asn1$4.integerToDer(0).getBytes()),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OID,!1,asn1$4.oidToDer(pki$3.oids.rsaEncryption).getBytes()),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.NULL,!1,"")]),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OCTETSTRING,!1,asn1$4.toDer(_).getBytes())])};pki$3.privateKeyFromAsn1=function(_){var a={},$=[];if(asn1$4.validate(_,privateKeyValidator,a,$)&&(_=asn1$4.fromDer(forge$8.util.createBuffer(a.privateKey))),a={},$=[],!asn1$4.validate(_,rsaPrivateKeyValidator,a,$)){var j=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw j.errors=$,j}var _e,et,tt,rt,nt,it,st,ot;return _e=forge$8.util.createBuffer(a.privateKeyModulus).toHex(),et=forge$8.util.createBuffer(a.privateKeyPublicExponent).toHex(),tt=forge$8.util.createBuffer(a.privateKeyPrivateExponent).toHex(),rt=forge$8.util.createBuffer(a.privateKeyPrime1).toHex(),nt=forge$8.util.createBuffer(a.privateKeyPrime2).toHex(),it=forge$8.util.createBuffer(a.privateKeyExponent1).toHex(),st=forge$8.util.createBuffer(a.privateKeyExponent2).toHex(),ot=forge$8.util.createBuffer(a.privateKeyCoefficient).toHex(),pki$3.setRsaPrivateKey(new BigInteger$1(_e,16),new BigInteger$1(et,16),new BigInteger$1(tt,16),new BigInteger$1(rt,16),new BigInteger$1(nt,16),new BigInteger$1(it,16),new BigInteger$1(st,16),new BigInteger$1(ot,16))};pki$3.privateKeyToAsn1=pki$3.privateKeyToRSAPrivateKey=function(_){return asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,asn1$4.integerToDer(0).getBytes()),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.n)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.e)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.d)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.p)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.q)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.dP)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.dQ)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.qInv))])};pki$3.publicKeyFromAsn1=function(_){var a={},$=[];if(asn1$4.validate(_,publicKeyValidator$1,a,$)){var j=asn1$4.derToOid(a.publicKeyOid);if(j!==pki$3.oids.rsaEncryption){var _e=new Error("Cannot read public key. Unknown OID.");throw _e.oid=j,_e}_=a.rsaPublicKey}if($=[],!asn1$4.validate(_,rsaPublicKeyValidator,a,$)){var _e=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw _e.errors=$,_e}var et=forge$8.util.createBuffer(a.publicKeyModulus).toHex(),tt=forge$8.util.createBuffer(a.publicKeyExponent).toHex();return pki$3.setRsaPublicKey(new BigInteger$1(et,16),new BigInteger$1(tt,16))};pki$3.publicKeyToAsn1=pki$3.publicKeyToSubjectPublicKeyInfo=function(_){return asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OID,!1,asn1$4.oidToDer(pki$3.oids.rsaEncryption).getBytes()),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.NULL,!1,"")]),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.BITSTRING,!1,[pki$3.publicKeyToRSAPublicKey(_)])])};pki$3.publicKeyToRSAPublicKey=function(_){return asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.n)),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,_bnToBytes(_.e))])};function _encodePkcs1_v1_5(_,a,$){var j=forge$8.util.createBuffer(),_e=Math.ceil(a.n.bitLength()/8);if(_.length>_e-11){var et=new Error("Message is too long for PKCS#1 v1.5 padding.");throw et.length=_.length,et.max=_e-11,et}j.putByte(0),j.putByte($);var tt=_e-3-_.length,rt;if($===0||$===1){rt=$===0?0:255;for(var nt=0;nt<tt;++nt)j.putByte(rt)}else for(;tt>0;){for(var it=0,st=forge$8.random.getBytes(tt),nt=0;nt<tt;++nt)rt=st.charCodeAt(nt),rt===0?++it:j.putByte(rt);tt=it}return j.putByte(0),j.putBytes(_),j}function _decodePkcs1_v1_5(_,a,$,j){var _e=Math.ceil(a.n.bitLength()/8),et=forge$8.util.createBuffer(_),tt=et.getByte(),rt=et.getByte();if(tt!==0||$&&rt!==0&&rt!==1||!$&&rt!=2||$&&rt===0&&typeof j>"u")throw new Error("Encryption block is invalid.");var nt=0;if(rt===0){nt=_e-3-j;for(var it=0;it<nt;++it)if(et.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(rt===1)for(nt=0;et.length()>1;){if(et.getByte()!==255){--et.read;break}++nt}else if(rt===2)for(nt=0;et.length()>1;){if(et.getByte()===0){--et.read;break}++nt}var st=et.getByte();if(st!==0||nt!==_e-3-et.length())throw new Error("Encryption block is invalid.");return et.getBytes()}function _generateKeyPair(_,a,$){typeof a=="function"&&($=a,a={}),a=a||{};var j={algorithm:{name:a.algorithm||"PRIMEINC",options:{workers:a.workers||2,workLoad:a.workLoad||100,workerScript:a.workerScript}}};"prng"in a&&(j.prng=a.prng),_e();function _e(){et(_.pBits,function(rt,nt){if(rt)return $(rt);if(_.p=nt,_.q!==null)return tt(rt,_.q);et(_.qBits,tt)})}function et(rt,nt){forge$8.prime.generateProbablePrime(rt,j,nt)}function tt(rt,nt){if(rt)return $(rt);if(_.q=nt,_.p.compareTo(_.q)<0){var it=_.p;_.p=_.q,_.q=it}if(_.p.subtract(BigInteger$1.ONE).gcd(_.e).compareTo(BigInteger$1.ONE)!==0){_.p=null,_e();return}if(_.q.subtract(BigInteger$1.ONE).gcd(_.e).compareTo(BigInteger$1.ONE)!==0){_.q=null,et(_.qBits,tt);return}if(_.p1=_.p.subtract(BigInteger$1.ONE),_.q1=_.q.subtract(BigInteger$1.ONE),_.phi=_.p1.multiply(_.q1),_.phi.gcd(_.e).compareTo(BigInteger$1.ONE)!==0){_.p=_.q=null,_e();return}if(_.n=_.p.multiply(_.q),_.n.bitLength()!==_.bits){_.q=null,et(_.qBits,tt);return}var st=_.e.modInverse(_.phi);_.keys={privateKey:pki$3.rsa.setPrivateKey(_.n,_.e,st,_.p,_.q,st.mod(_.p1),st.mod(_.q1),_.q.modInverse(_.p)),publicKey:pki$3.rsa.setPublicKey(_.n,_.e)},$(null,_.keys)}}function _bnToBytes(_){var a=_.toString(16);a[0]>="8"&&(a="00"+a);var $=forge$8.util.hexToBytes(a);return $.length>1&&($.charCodeAt(0)===0&&($.charCodeAt(1)&128)===0||$.charCodeAt(0)===255&&($.charCodeAt(1)&128)===128)?$.substr(1):$}function _getMillerRabinTests(_){return _<=100?27:_<=150?18:_<=200?15:_<=250?12:_<=300?9:_<=350?8:_<=400?7:_<=500?6:_<=600?5:_<=800?4:_<=1250?3:2}function _detectNodeCrypto(_){return forge$8.util.isNodejs&&typeof _crypto[_]=="function"}function _detectSubtleCrypto(_){return typeof util.globalScope<"u"&&typeof util.globalScope.crypto=="object"&&typeof util.globalScope.crypto.subtle=="object"&&typeof util.globalScope.crypto.subtle[_]=="function"}function _detectSubtleMsCrypto(_){return typeof util.globalScope<"u"&&typeof util.globalScope.msCrypto=="object"&&typeof util.globalScope.msCrypto.subtle=="object"&&typeof util.globalScope.msCrypto.subtle[_]=="function"}function _intToUint8Array(_){for(var a=forge$8.util.hexToBytes(_.toString(16)),$=new Uint8Array(a.length),j=0;j<a.length;++j)$[j]=a.charCodeAt(j);return $}var forge$7=forge$s;if(typeof BigInteger>"u")var BigInteger=forge$7.jsbn.BigInteger;var asn1$3=forge$7.asn1,pki$2=forge$7.pki=forge$7.pki||{};pki$2.pbe=forge$7.pbe=forge$7.pbe||{};var oids$1=pki$2.oids,encryptedPrivateKeyValidator={name:"EncryptedPrivateKeyInfo",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},PBES2AlgorithmsValidator={name:"PBES2Algorithms",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},pkcs12PbeParamsValidator={name:"pkcs-12PbeParams",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.INTEGER,constructed:!1,capture:"iterations"}]};pki$2.encryptPrivateKeyInfo=function(_,a,$){$=$||{},$.saltSize=$.saltSize||8,$.count=$.count||2048,$.algorithm=$.algorithm||"aes128",$.prfAlgorithm=$.prfAlgorithm||"sha1";var j=forge$7.random.getBytesSync($.saltSize),_e=$.count,et=asn1$3.integerToDer(_e),tt,rt,nt;if($.algorithm.indexOf("aes")===0||$.algorithm==="des"){var it,st,ot;switch($.algorithm){case"aes128":tt=16,it=16,st=oids$1["aes128-CBC"],ot=forge$7.aes.createEncryptionCipher;break;case"aes192":tt=24,it=16,st=oids$1["aes192-CBC"],ot=forge$7.aes.createEncryptionCipher;break;case"aes256":tt=32,it=16,st=oids$1["aes256-CBC"],ot=forge$7.aes.createEncryptionCipher;break;case"des":tt=8,it=8,st=oids$1.desCBC,ot=forge$7.des.createEncryptionCipher;break;default:var at=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw at.algorithm=$.algorithm,at}var lt="hmacWith"+$.prfAlgorithm.toUpperCase(),ct=prfAlgorithmToMessageDigest(lt),ut=forge$7.pkcs5.pbkdf2(a,j,_e,tt,ct),dt=forge$7.random.getBytesSync(it),ft=ot(ut);ft.start(dt),ft.update(asn1$3.toDer(_)),ft.finish(),nt=ft.output.getBytes();var pt=createPbkdf2Params(j,et,tt,lt);rt=asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OID,!1,asn1$3.oidToDer(oids$1.pkcs5PBES2).getBytes()),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OID,!1,asn1$3.oidToDer(oids$1.pkcs5PBKDF2).getBytes()),pt]),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OID,!1,asn1$3.oidToDer(st).getBytes()),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OCTETSTRING,!1,dt)])])])}else if($.algorithm==="3des"){tt=24;var yt=new forge$7.util.ByteBuffer(j),ut=pki$2.pbe.generatePkcs12Key(a,yt,1,_e,tt),dt=pki$2.pbe.generatePkcs12Key(a,yt,2,_e,tt),ft=forge$7.des.createEncryptionCipher(ut);ft.start(dt),ft.update(asn1$3.toDer(_)),ft.finish(),nt=ft.output.getBytes(),rt=asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OID,!1,asn1$3.oidToDer(oids$1["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OCTETSTRING,!1,j),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.INTEGER,!1,et.getBytes())])])}else{var at=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw at.algorithm=$.algorithm,at}var mt=asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[rt,asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OCTETSTRING,!1,nt)]);return mt};pki$2.decryptPrivateKeyInfo=function(_,a){var $=null,j={},_e=[];if(!asn1$3.validate(_,encryptedPrivateKeyValidator,j,_e)){var et=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw et.errors=_e,et}var tt=asn1$3.derToOid(j.encryptionOid),rt=pki$2.pbe.getCipher(tt,j.encryptionParams,a),nt=forge$7.util.createBuffer(j.encryptedData);return rt.update(nt),rt.finish()&&($=asn1$3.fromDer(rt.output)),$};pki$2.encryptedPrivateKeyToPem=function(_,a){var $={type:"ENCRYPTED PRIVATE KEY",body:asn1$3.toDer(_).getBytes()};return forge$7.pem.encode($,{maxline:a})};pki$2.encryptedPrivateKeyFromPem=function(_){var a=forge$7.pem.decode(_)[0];if(a.type!=="ENCRYPTED PRIVATE KEY"){var $=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw $.headerType=a.type,$}if(a.procType&&a.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return asn1$3.fromDer(a.body)};pki$2.encryptRsaPrivateKey=function(_,a,$){if($=$||{},!$.legacy){var j=pki$2.wrapRsaPrivateKey(pki$2.privateKeyToAsn1(_));return j=pki$2.encryptPrivateKeyInfo(j,a,$),pki$2.encryptedPrivateKeyToPem(j)}var _e,et,tt,rt;switch($.algorithm){case"aes128":_e="AES-128-CBC",tt=16,et=forge$7.random.getBytesSync(16),rt=forge$7.aes.createEncryptionCipher;break;case"aes192":_e="AES-192-CBC",tt=24,et=forge$7.random.getBytesSync(16),rt=forge$7.aes.createEncryptionCipher;break;case"aes256":_e="AES-256-CBC",tt=32,et=forge$7.random.getBytesSync(16),rt=forge$7.aes.createEncryptionCipher;break;case"3des":_e="DES-EDE3-CBC",tt=24,et=forge$7.random.getBytesSync(8),rt=forge$7.des.createEncryptionCipher;break;case"des":_e="DES-CBC",tt=8,et=forge$7.random.getBytesSync(8),rt=forge$7.des.createEncryptionCipher;break;default:var nt=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+$.algorithm+'".');throw nt.algorithm=$.algorithm,nt}var it=forge$7.pbe.opensslDeriveBytes(a,et.substr(0,8),tt),st=rt(it);st.start(et),st.update(asn1$3.toDer(pki$2.privateKeyToAsn1(_))),st.finish();var ot={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:_e,parameters:forge$7.util.bytesToHex(et).toUpperCase()},body:st.output.getBytes()};return forge$7.pem.encode(ot)};pki$2.decryptRsaPrivateKey=function(_,a){var $=null,j=forge$7.pem.decode(_)[0];if(j.type!=="ENCRYPTED PRIVATE KEY"&&j.type!=="PRIVATE KEY"&&j.type!=="RSA PRIVATE KEY"){var _e=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw _e.headerType=_e,_e}if(j.procType&&j.procType.type==="ENCRYPTED"){var et,tt;switch(j.dekInfo.algorithm){case"DES-CBC":et=8,tt=forge$7.des.createDecryptionCipher;break;case"DES-EDE3-CBC":et=24,tt=forge$7.des.createDecryptionCipher;break;case"AES-128-CBC":et=16,tt=forge$7.aes.createDecryptionCipher;break;case"AES-192-CBC":et=24,tt=forge$7.aes.createDecryptionCipher;break;case"AES-256-CBC":et=32,tt=forge$7.aes.createDecryptionCipher;break;case"RC2-40-CBC":et=5,tt=function(ot){return forge$7.rc2.createDecryptionCipher(ot,40)};break;case"RC2-64-CBC":et=8,tt=function(ot){return forge$7.rc2.createDecryptionCipher(ot,64)};break;case"RC2-128-CBC":et=16,tt=function(ot){return forge$7.rc2.createDecryptionCipher(ot,128)};break;default:var _e=new Error('Could not decrypt private key; unsupported encryption algorithm "'+j.dekInfo.algorithm+'".');throw _e.algorithm=j.dekInfo.algorithm,_e}var rt=forge$7.util.hexToBytes(j.dekInfo.parameters),nt=forge$7.pbe.opensslDeriveBytes(a,rt.substr(0,8),et),it=tt(nt);if(it.start(rt),it.update(forge$7.util.createBuffer(j.body)),it.finish())$=it.output.getBytes();else return $}else $=j.body;return j.type==="ENCRYPTED PRIVATE KEY"?$=pki$2.decryptPrivateKeyInfo(asn1$3.fromDer($),a):$=asn1$3.fromDer($),$!==null&&($=pki$2.privateKeyFromAsn1($)),$};pki$2.pbe.generatePkcs12Key=function(_,a,$,j,_e,et){var tt,rt;if(typeof et>"u"||et===null){if(!("sha1"in forge$7.md))throw new Error('"sha1" hash algorithm unavailable.');et=forge$7.md.sha1.create()}var nt=et.digestLength,it=et.blockLength,st=new forge$7.util.ByteBuffer,ot=new forge$7.util.ByteBuffer;if(_!=null){for(rt=0;rt<_.length;rt++)ot.putInt16(_.charCodeAt(rt));ot.putInt16(0)}var at=ot.length(),lt=a.length(),ct=new forge$7.util.ByteBuffer;ct.fillWithByte($,it);var ut=it*Math.ceil(lt/it),dt=new forge$7.util.ByteBuffer;for(rt=0;rt<ut;rt++)dt.putByte(a.at(rt%lt));var ft=it*Math.ceil(at/it),pt=new forge$7.util.ByteBuffer;for(rt=0;rt<ft;rt++)pt.putByte(ot.at(rt%at));var yt=dt;yt.putBuffer(pt);for(var mt=Math.ceil(_e/nt),_t=1;_t<=mt;_t++){var vt=new forge$7.util.ByteBuffer;vt.putBytes(ct.bytes()),vt.putBytes(yt.bytes());for(var ht=0;ht<j;ht++)et.start(),et.update(vt.getBytes()),vt=et.digest();var St=new forge$7.util.ByteBuffer;for(rt=0;rt<it;rt++)St.putByte(vt.at(rt%nt));var It=Math.ceil(lt/it)+Math.ceil(at/it),Lt=new forge$7.util.ByteBuffer;for(tt=0;tt<It;tt++){var Mt=new forge$7.util.ByteBuffer(yt.getBytes(it)),Kt=511;for(rt=St.length()-1;rt>=0;rt--)Kt=Kt>>8,Kt+=St.at(rt)+Mt.at(rt),Mt.setAt(rt,Kt&255);Lt.putBuffer(Mt)}yt=Lt,st.putBuffer(vt)}return st.truncate(st.length()-_e),st};pki$2.pbe.getCipher=function(_,a,$){switch(_){case pki$2.oids.pkcs5PBES2:return pki$2.pbe.getCipherForPBES2(_,a,$);case pki$2.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case pki$2.oids["pbewithSHAAnd40BitRC2-CBC"]:return pki$2.pbe.getCipherForPKCS12PBE(_,a,$);default:var j=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw j.oid=_,j.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],j}};pki$2.pbe.getCipherForPBES2=function(_,a,$){var j={},_e=[];if(!asn1$3.validate(a,PBES2AlgorithmsValidator,j,_e)){var et=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw et.errors=_e,et}if(_=asn1$3.derToOid(j.kdfOid),_!==pki$2.oids.pkcs5PBKDF2){var et=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw et.oid=_,et.supportedOids=["pkcs5PBKDF2"],et}if(_=asn1$3.derToOid(j.encOid),_!==pki$2.oids["aes128-CBC"]&&_!==pki$2.oids["aes192-CBC"]&&_!==pki$2.oids["aes256-CBC"]&&_!==pki$2.oids["des-EDE3-CBC"]&&_!==pki$2.oids.desCBC){var et=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw et.oid=_,et.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],et}var tt=j.kdfSalt,rt=forge$7.util.createBuffer(j.kdfIterationCount);rt=rt.getInt(rt.length()<<3);var nt,it;switch(pki$2.oids[_]){case"aes128-CBC":nt=16,it=forge$7.aes.createDecryptionCipher;break;case"aes192-CBC":nt=24,it=forge$7.aes.createDecryptionCipher;break;case"aes256-CBC":nt=32,it=forge$7.aes.createDecryptionCipher;break;case"des-EDE3-CBC":nt=24,it=forge$7.des.createDecryptionCipher;break;case"desCBC":nt=8,it=forge$7.des.createDecryptionCipher;break}var st=prfOidToMessageDigest(j.prfOid),ot=forge$7.pkcs5.pbkdf2($,tt,rt,nt,st),at=j.encIv,lt=it(ot);return lt.start(at),lt};pki$2.pbe.getCipherForPKCS12PBE=function(_,a,$){var j={},_e=[];if(!asn1$3.validate(a,pkcs12PbeParamsValidator,j,_e)){var et=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw et.errors=_e,et}var tt=forge$7.util.createBuffer(j.salt),rt=forge$7.util.createBuffer(j.iterations);rt=rt.getInt(rt.length()<<3);var nt,it,st;switch(_){case pki$2.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:nt=24,it=8,st=forge$7.des.startDecrypting;break;case pki$2.oids["pbewithSHAAnd40BitRC2-CBC"]:nt=5,it=8,st=function(ut,dt){var ft=forge$7.rc2.createDecryptionCipher(ut,40);return ft.start(dt,null),ft};break;default:var et=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw et.oid=_,et}var ot=prfOidToMessageDigest(j.prfOid),at=pki$2.pbe.generatePkcs12Key($,tt,1,rt,nt,ot);ot.start();var lt=pki$2.pbe.generatePkcs12Key($,tt,2,rt,it,ot);return st(at,lt)};pki$2.pbe.opensslDeriveBytes=function(_,a,$,j){if(typeof j>"u"||j===null){if(!("md5"in forge$7.md))throw new Error('"md5" hash algorithm unavailable.');j=forge$7.md.md5.create()}a===null&&(a="");for(var _e=[hash$2(j,_+a)],et=16,tt=1;et<$;++tt,et+=16)_e.push(hash$2(j,_e[tt-1]+_+a));return _e.join("").substr(0,$)};function hash$2(_,a){return _.start().update(a).digest().getBytes()}function prfOidToMessageDigest(_){var a;if(!_)a="hmacWithSHA1";else if(a=pki$2.oids[asn1$3.derToOid(_)],!a){var $=new Error("Unsupported PRF OID.");throw $.oid=_,$.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],$}return prfAlgorithmToMessageDigest(a)}function prfAlgorithmToMessageDigest(_){var a=forge$7.md;switch(_){case"hmacWithSHA224":a=forge$7.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":_=_.substr(8).toLowerCase();break;default:var $=new Error("Unsupported PRF algorithm.");throw $.algorithm=_,$.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],$}if(!a||!(_ in a))throw new Error("Unknown hash algorithm: "+_);return a[_].create()}function createPbkdf2Params(_,a,$,j){var _e=asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OCTETSTRING,!1,_),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.INTEGER,!1,a.getBytes())]);return j!=="hmacWithSHA1"&&_e.value.push(asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.INTEGER,!1,forge$7.util.hexToBytes($.toString(16))),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.SEQUENCE,!0,[asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.OID,!1,asn1$3.oidToDer(pki$2.oids[j]).getBytes()),asn1$3.create(asn1$3.Class.UNIVERSAL,asn1$3.Type.NULL,!1,"")])),_e}const webcrypto={get(_=globalThis){const a=_.crypto;if(a==null||a.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return a}};function bigIntegerToUintBase64url(_,a){let $=Uint8Array.from(_.abs().toByteArray());if($=$[0]===0?$.slice(1):$,a!=null){if($.length>a)throw new Error("byte array longer than desired length");$=concat$1([new Uint8Array(a-$.length),$])}return toString$6($,"base64url")}function base64urlToBigInteger(_){const a=base64urlToBuffer(_);return new forge$s.jsbn.BigInteger(toString$6(a,"base16"),16)}function base64urlToBuffer(_,a){let $=fromString$5(_,"base64urlpad");if(a!=null){if($.length>a)throw new Error("byte array longer than desired length");$=concat$1([new Uint8Array(a-$.length),$])}return $}const bits={"P-256":256,"P-384":384,"P-521":521},curveTypes=Object.keys(bits);curveTypes.join(" / ");function create$9(_){const a=_?.algorithm??"AES-GCM";let $=_?.keyLength??16;const j=_?.nonceLength??12,_e=_?.digest??"SHA-256",et=_?.saltLength??16,tt=_?.iterations??32767,rt=webcrypto.get();$*=8;async function nt(ot,at){const lt=rt.getRandomValues(new Uint8Array(et)),ct=rt.getRandomValues(new Uint8Array(j)),ut={name:a,iv:ct};typeof at=="string"&&(at=fromString$5(at));const dt={name:"PBKDF2",salt:lt,iterations:tt,hash:{name:_e}},ft=await rt.subtle.importKey("raw",at,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),pt=await rt.subtle.deriveKey(dt,ft,{name:a,length:$},!0,["encrypt"]),yt=await rt.subtle.encrypt(ut,pt,ot);return concat$1([lt,ut.iv,new Uint8Array(yt)])}async function it(ot,at){const lt=ot.slice(0,et),ct=ot.slice(et,et+j),ut=ot.slice(et+j),dt={name:a,iv:ct};typeof at=="string"&&(at=fromString$5(at));const ft={name:"PBKDF2",salt:lt,iterations:tt,hash:{name:_e}},pt=await rt.subtle.importKey("raw",at,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),yt=await rt.subtle.deriveKey(ft,pt,{name:a,length:$},!0,["decrypt"]),mt=await rt.subtle.decrypt(dt,yt,ut);return new Uint8Array(mt)}return{encrypt:nt,decrypt:it}}async function importer$1(_,a){const $=base64$6.decode(_);return await create$9().decrypt($,a)}var forge$6=forge$s,sha512$2=forge$6.sha512=forge$6.sha512||{};forge$6.md.sha512=forge$6.md.algorithms.sha512=sha512$2;var sha384=forge$6.sha384=forge$6.sha512.sha384=forge$6.sha512.sha384||{};sha384.create=function(){return sha512$2.create("SHA-384")};forge$6.md.sha384=forge$6.md.algorithms.sha384=sha384;forge$6.sha512.sha256=forge$6.sha512.sha256||{create:function(){return sha512$2.create("SHA-512/256")}};forge$6.md["sha512/256"]=forge$6.md.algorithms["sha512/256"]=forge$6.sha512.sha256;forge$6.sha512.sha224=forge$6.sha512.sha224||{create:function(){return sha512$2.create("SHA-512/224")}};forge$6.md["sha512/224"]=forge$6.md.algorithms["sha512/224"]=forge$6.sha512.sha224;sha512$2.create=function(_){if(_initialized||_init(),typeof _>"u"&&(_="SHA-512"),!(_ in _states))throw new Error("Invalid SHA-512 algorithm: "+_);for(var a=_states[_],$=null,j=forge$6.util.createBuffer(),_e=new Array(80),et=0;et<80;++et)_e[et]=new Array(2);var tt=64;switch(_){case"SHA-384":tt=48;break;case"SHA-512/256":tt=32;break;case"SHA-512/224":tt=28;break}var rt={algorithm:_.replace("-","").toLowerCase(),blockLength:128,digestLength:tt,messageLength:0,fullMessageLength:null,messageLengthSize:16};return rt.start=function(){rt.messageLength=0,rt.fullMessageLength=rt.messageLength128=[];for(var nt=rt.messageLengthSize/4,it=0;it<nt;++it)rt.fullMessageLength.push(0);j=forge$6.util.createBuffer(),$=new Array(a.length);for(var it=0;it<a.length;++it)$[it]=a[it].slice(0);return rt},rt.start(),rt.update=function(nt,it){it==="utf8"&&(nt=forge$6.util.encodeUtf8(nt));var st=nt.length;rt.messageLength+=st,st=[st/4294967296>>>0,st>>>0];for(var ot=rt.fullMessageLength.length-1;ot>=0;--ot)rt.fullMessageLength[ot]+=st[1],st[1]=st[0]+(rt.fullMessageLength[ot]/4294967296>>>0),rt.fullMessageLength[ot]=rt.fullMessageLength[ot]>>>0,st[0]=st[1]/4294967296>>>0;return j.putBytes(nt),_update($,_e,j),(j.read>2048||j.length()===0)&&j.compact(),rt},rt.digest=function(){var nt=forge$6.util.createBuffer();nt.putBytes(j.bytes());var it=rt.fullMessageLength[rt.fullMessageLength.length-1]+rt.messageLengthSize,st=it&rt.blockLength-1;nt.putBytes(_padding.substr(0,rt.blockLength-st));for(var ot,at,lt=rt.fullMessageLength[0]*8,ct=0;ct<rt.fullMessageLength.length-1;++ct)ot=rt.fullMessageLength[ct+1]*8,at=ot/4294967296>>>0,lt+=at,nt.putInt32(lt>>>0),lt=ot>>>0;nt.putInt32(lt);for(var ut=new Array($.length),ct=0;ct<$.length;++ct)ut[ct]=$[ct].slice(0);_update(ut,_e,nt);var dt=forge$6.util.createBuffer(),ft;_==="SHA-512"?ft=ut.length:_==="SHA-384"?ft=ut.length-2:ft=ut.length-4;for(var ct=0;ct<ft;++ct)dt.putInt32(ut[ct][0]),(ct!==ft-1||_!=="SHA-512/224")&&dt.putInt32(ut[ct][1]);return dt},rt};var _padding=null,_initialized=!1,_k=null,_states=null;function _init(){_padding=String.fromCharCode(128),_padding+=forge$6.util.fillString(String.fromCharCode(0),128),_k=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],_states={},_states["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],_states["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],_states["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],_states["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],_initialized=!0}function _update(_,a,$){for(var j,_e,et,tt,rt,nt,it,st,ot,at,lt,ct,ut,dt,ft,pt,yt,mt,_t,vt,ht,St,It,Lt,Mt,Kt,kt,gt,Et,xt,Tt,At,Nt,Bt,Ot,bt=$.length();bt>=128;){for(Et=0;Et<16;++Et)a[Et][0]=$.getInt32()>>>0,a[Et][1]=$.getInt32()>>>0;for(;Et<80;++Et)At=a[Et-2],xt=At[0],Tt=At[1],j=((xt>>>19|Tt<<13)^(Tt>>>29|xt<<3)^xt>>>6)>>>0,_e=((xt<<13|Tt>>>19)^(Tt<<3|xt>>>29)^(xt<<26|Tt>>>6))>>>0,Bt=a[Et-15],xt=Bt[0],Tt=Bt[1],et=((xt>>>1|Tt<<31)^(xt>>>8|Tt<<24)^xt>>>7)>>>0,tt=((xt<<31|Tt>>>1)^(xt<<24|Tt>>>8)^(xt<<25|Tt>>>7))>>>0,Nt=a[Et-7],Ot=a[Et-16],Tt=_e+Nt[1]+tt+Ot[1],a[Et][0]=j+Nt[0]+et+Ot[0]+(Tt/4294967296>>>0)>>>0,a[Et][1]=Tt>>>0;for(ut=_[0][0],dt=_[0][1],ft=_[1][0],pt=_[1][1],yt=_[2][0],mt=_[2][1],_t=_[3][0],vt=_[3][1],ht=_[4][0],St=_[4][1],It=_[5][0],Lt=_[5][1],Mt=_[6][0],Kt=_[6][1],kt=_[7][0],gt=_[7][1],Et=0;Et<80;++Et)it=((ht>>>14|St<<18)^(ht>>>18|St<<14)^(St>>>9|ht<<23))>>>0,st=((ht<<18|St>>>14)^(ht<<14|St>>>18)^(St<<23|ht>>>9))>>>0,ot=(Mt^ht&(It^Mt))>>>0,at=(Kt^St&(Lt^Kt))>>>0,rt=((ut>>>28|dt<<4)^(dt>>>2|ut<<30)^(dt>>>7|ut<<25))>>>0,nt=((ut<<4|dt>>>28)^(dt<<30|ut>>>2)^(dt<<25|ut>>>7))>>>0,lt=(ut&ft|yt&(ut^ft))>>>0,ct=(dt&pt|mt&(dt^pt))>>>0,Tt=gt+st+at+_k[Et][1]+a[Et][1],j=kt+it+ot+_k[Et][0]+a[Et][0]+(Tt/4294967296>>>0)>>>0,_e=Tt>>>0,Tt=nt+ct,et=rt+lt+(Tt/4294967296>>>0)>>>0,tt=Tt>>>0,kt=Mt,gt=Kt,Mt=It,Kt=Lt,It=ht,Lt=St,Tt=vt+_e,ht=_t+j+(Tt/4294967296>>>0)>>>0,St=Tt>>>0,_t=yt,vt=mt,yt=ft,mt=pt,ft=ut,pt=dt,Tt=_e+tt,ut=j+et+(Tt/4294967296>>>0)>>>0,dt=Tt>>>0;Tt=_[0][1]+dt,_[0][0]=_[0][0]+ut+(Tt/4294967296>>>0)>>>0,_[0][1]=Tt>>>0,Tt=_[1][1]+pt,_[1][0]=_[1][0]+ft+(Tt/4294967296>>>0)>>>0,_[1][1]=Tt>>>0,Tt=_[2][1]+mt,_[2][0]=_[2][0]+yt+(Tt/4294967296>>>0)>>>0,_[2][1]=Tt>>>0,Tt=_[3][1]+vt,_[3][0]=_[3][0]+_t+(Tt/4294967296>>>0)>>>0,_[3][1]=Tt>>>0,Tt=_[4][1]+St,_[4][0]=_[4][0]+ht+(Tt/4294967296>>>0)>>>0,_[4][1]=Tt>>>0,Tt=_[5][1]+Lt,_[5][0]=_[5][0]+It+(Tt/4294967296>>>0)>>>0,_[5][1]=Tt>>>0,Tt=_[6][1]+Kt,_[6][0]=_[6][0]+Mt+(Tt/4294967296>>>0)>>>0,_[6][1]=Tt>>>0,Tt=_[7][1]+gt,_[7][0]=_[7][0]+kt+(Tt/4294967296>>>0)>>>0,_[7][1]=Tt>>>0,bt-=128}}/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const _0n$1=BigInt(0),_1n$1=BigInt(1),_2n$1=BigInt(2),_3n=BigInt(3),_8n=BigInt(8),CURVE$1=Object.freeze({a:_0n$1,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:_1n$1,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")});function weistrass(_){const{a,b:$}=CURVE$1,j=mod$1(_*_),_e=mod$1(j*_);return mod$1(_e+a*_+$)}const USE_ENDOMORPHISM=CURVE$1.a===_0n$1;class ShaError extends Error{constructor(a){super(a)}}class JacobianPoint{constructor(a,$,j){this.x=a,this.y=$,this.z=j}static fromAffine(a){if(!(a instanceof Point$1))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new JacobianPoint(a.x,a.y,_1n$1)}static toAffineBatch(a){const $=invertBatch$1(a.map(j=>j.z));return a.map((j,_e)=>j.toAffine($[_e]))}static normalizeZ(a){return JacobianPoint.toAffineBatch(a).map(JacobianPoint.fromAffine)}equals(a){if(!(a instanceof JacobianPoint))throw new TypeError("JacobianPoint expected");const{x:$,y:j,z:_e}=this,{x:et,y:tt,z:rt}=a,nt=mod$1(_e*_e),it=mod$1(rt*rt),st=mod$1($*it),ot=mod$1(et*nt),at=mod$1(mod$1(j*rt)*it),lt=mod$1(mod$1(tt*_e)*nt);return st===ot&&at===lt}negate(){return new JacobianPoint(this.x,mod$1(-this.y),this.z)}double(){const{x:a,y:$,z:j}=this,_e=mod$1(a*a),et=mod$1($*$),tt=mod$1(et*et),rt=a+et,nt=mod$1(_2n$1*(mod$1(rt*rt)-_e-tt)),it=mod$1(_3n*_e),st=mod$1(it*it),ot=mod$1(st-_2n$1*nt),at=mod$1(it*(nt-ot)-_8n*tt),lt=mod$1(_2n$1*$*j);return new JacobianPoint(ot,at,lt)}add(a){if(!(a instanceof JacobianPoint))throw new TypeError("JacobianPoint expected");const{x:$,y:j,z:_e}=this,{x:et,y:tt,z:rt}=a;if(et===_0n$1||tt===_0n$1)return this;if($===_0n$1||j===_0n$1)return a;const nt=mod$1(_e*_e),it=mod$1(rt*rt),st=mod$1($*it),ot=mod$1(et*nt),at=mod$1(mod$1(j*rt)*it),lt=mod$1(mod$1(tt*_e)*nt),ct=mod$1(ot-st),ut=mod$1(lt-at);if(ct===_0n$1)return ut===_0n$1?this.double():JacobianPoint.ZERO;const dt=mod$1(ct*ct),ft=mod$1(ct*dt),pt=mod$1(st*dt),yt=mod$1(ut*ut-ft-_2n$1*pt),mt=mod$1(ut*(pt-yt)-at*ft),_t=mod$1(_e*rt*ct);return new JacobianPoint(yt,mt,_t)}subtract(a){return this.add(a.negate())}multiplyUnsafe(a){const $=JacobianPoint.ZERO;if(typeof a=="bigint"&&a===_0n$1)return $;let j=normalizeScalar$1(a);if(j===_1n$1)return this;if(!USE_ENDOMORPHISM){let ot=$,at=this;for(;j>_0n$1;)j&_1n$1&&(ot=ot.add(at)),at=at.double(),j>>=_1n$1;return ot}let{k1neg:_e,k1:et,k2neg:tt,k2:rt}=splitScalarEndo(j),nt=$,it=$,st=this;for(;et>_0n$1||rt>_0n$1;)et&_1n$1&&(nt=nt.add(st)),rt&_1n$1&&(it=it.add(st)),st=st.double(),et>>=_1n$1,rt>>=_1n$1;return _e&&(nt=nt.negate()),tt&&(it=it.negate()),it=new JacobianPoint(mod$1(it.x*CURVE$1.beta),it.y,it.z),nt.add(it)}precomputeWindow(a){const $=USE_ENDOMORPHISM?128/a+1:256/a+1,j=[];let _e=this,et=_e;for(let tt=0;tt<$;tt++){et=_e,j.push(et);for(let rt=1;rt<2**(a-1);rt++)et=et.add(_e),j.push(et);_e=et.double()}return j}wNAF(a,$){!$&&this.equals(JacobianPoint.BASE)&&($=Point$1.BASE);const j=$&&$._WINDOW_SIZE||1;if(256%j)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let _e=$&&pointPrecomputes$1.get($);_e||(_e=this.precomputeWindow(j),$&&j!==1&&(_e=JacobianPoint.normalizeZ(_e),pointPrecomputes$1.set($,_e)));let et=JacobianPoint.ZERO,tt=JacobianPoint.ZERO;const rt=1+(USE_ENDOMORPHISM?128/j:256/j),nt=2**(j-1),it=BigInt(2**j-1),st=2**j,ot=BigInt(j);for(let at=0;at<rt;at++){const lt=at*nt;let ct=Number(a&it);if(a>>=ot,ct>nt&&(ct-=st,a+=_1n$1),ct===0){let ut=_e[lt];at%2&&(ut=ut.negate()),tt=tt.add(ut)}else{let ut=_e[lt+Math.abs(ct)-1];ct<0&&(ut=ut.negate()),et=et.add(ut)}}return{p:et,f:tt}}multiply(a,$){let j=normalizeScalar$1(a),_e,et;if(USE_ENDOMORPHISM){const{k1neg:tt,k1:rt,k2neg:nt,k2:it}=splitScalarEndo(j);let{p:st,f:ot}=this.wNAF(rt,$),{p:at,f:lt}=this.wNAF(it,$);tt&&(st=st.negate()),nt&&(at=at.negate()),at=new JacobianPoint(mod$1(at.x*CURVE$1.beta),at.y,at.z),_e=st.add(at),et=ot.add(lt)}else{const{p:tt,f:rt}=this.wNAF(j,$);_e=tt,et=rt}return JacobianPoint.normalizeZ([_e,et])[0]}toAffine(a=invert$1(this.z)){const{x:$,y:j,z:_e}=this,et=a,tt=mod$1(et*et),rt=mod$1(tt*et),nt=mod$1($*tt),it=mod$1(j*rt);if(mod$1(_e*et)!==_1n$1)throw new Error("invZ was invalid");return new Point$1(nt,it)}}JacobianPoint.BASE=new JacobianPoint(CURVE$1.Gx,CURVE$1.Gy,_1n$1);JacobianPoint.ZERO=new JacobianPoint(_0n$1,_1n$1,_0n$1);const pointPrecomputes$1=new WeakMap;class Point$1{constructor(a,$){this.x=a,this.y=$}_setWindowSize(a){this._WINDOW_SIZE=a,pointPrecomputes$1.delete(this)}hasEvenY(){return this.y%_2n$1===_0n$1}static fromCompressedHex(a){const $=a.length===32,j=bytesToNumber($?a:a.subarray(1));if(!isValidFieldElement(j))throw new Error("Point is not on curve");const _e=weistrass(j);let et=sqrtMod(_e);const tt=(et&_1n$1)===_1n$1;$?tt&&(et=mod$1(-et)):(a[0]&1)===1!==tt&&(et=mod$1(-et));const rt=new Point$1(j,et);return rt.assertValidity(),rt}static fromUncompressedHex(a){const $=bytesToNumber(a.subarray(1,33)),j=bytesToNumber(a.subarray(33,65)),_e=new Point$1($,j);return _e.assertValidity(),_e}static fromHex(a){const $=ensureBytes$1(a),j=$.length,_e=$[0];if(j===32||j===33&&(_e===2||_e===3))return this.fromCompressedHex($);if(j===65&&_e===4)return this.fromUncompressedHex($);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${j}`)}static fromPrivateKey(a){return Point$1.BASE.multiply(normalizePrivateKey(a))}static fromSignature(a,$,j){a=ensureBytes$1(a);const _e=truncateHash(a),{r:et,s:tt}=normalizeSignature($);if(j!==0&&j!==1)throw new Error("Cannot recover signature: invalid recovery bit");const rt=j&1?"03":"02",nt=Point$1.fromHex(rt+numTo32bStr(et)),{n:it}=CURVE$1,st=invert$1(et,it),ot=mod$1(-_e*st,it),at=mod$1(tt*st,it),lt=Point$1.BASE.multiplyAndAddUnsafe(nt,ot,at);if(!lt)throw new Error("Cannot recover signature: point at infinify");return lt.assertValidity(),lt}toRawBytes(a=!1){return hexToBytes$1(this.toHex(a))}toHex(a=!1){const $=numTo32bStr(this.x);return a?`${this.hasEvenY()?"02":"03"}${$}`:`04${$}${numTo32bStr(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const a="Point is not on elliptic curve",{x:$,y:j}=this;if(!isValidFieldElement($)||!isValidFieldElement(j))throw new Error(a);const _e=mod$1(j*j),et=weistrass($);if(mod$1(_e-et)!==_0n$1)throw new Error(a)}equals(a){return this.x===a.x&&this.y===a.y}negate(){return new Point$1(this.x,mod$1(-this.y))}double(){return JacobianPoint.fromAffine(this).double().toAffine()}add(a){return JacobianPoint.fromAffine(this).add(JacobianPoint.fromAffine(a)).toAffine()}subtract(a){return this.add(a.negate())}multiply(a){return JacobianPoint.fromAffine(this).multiply(a,this).toAffine()}multiplyAndAddUnsafe(a,$,j){const _e=JacobianPoint.fromAffine(this),et=$===_0n$1||$===_1n$1||this!==Point$1.BASE?_e.multiplyUnsafe($):_e.multiply($),tt=JacobianPoint.fromAffine(a).multiplyUnsafe(j),rt=et.add(tt);return rt.equals(JacobianPoint.ZERO)?void 0:rt.toAffine()}}Point$1.BASE=new Point$1(CURVE$1.Gx,CURVE$1.Gy);Point$1.ZERO=new Point$1(_0n$1,_0n$1);function sliceDER(_){return Number.parseInt(_[0],16)>=8?"00"+_:_}function parseDERInt(_){if(_.length<2||_[0]!==2)throw new Error(`Invalid signature integer tag: ${bytesToHex$1(_)}`);const a=_[1],$=_.subarray(2,a+2);if(!a||$.length!==a)throw new Error("Invalid signature integer: wrong length");if($[0]===0&&$[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:bytesToNumber($),left:_.subarray(a+2)}}function parseDERSignature(_){if(_.length<2||_[0]!=48)throw new Error(`Invalid signature tag: ${bytesToHex$1(_)}`);if(_[1]!==_.length-2)throw new Error("Invalid signature: incorrect length");const{data:a,left:$}=parseDERInt(_.subarray(2)),{data:j,left:_e}=parseDERInt($);if(_e.length)throw new Error(`Invalid signature: left bytes after parsing: ${bytesToHex$1(_e)}`);return{r:a,s:j}}class Signature$1{constructor(a,$){this.r=a,this.s=$,this.assertValidity()}static fromCompact(a){const $=a instanceof Uint8Array,j="Signature.fromCompact";if(typeof a!="string"&&!$)throw new TypeError(`${j}: Expected string or Uint8Array`);const _e=$?bytesToHex$1(a):a;if(_e.length!==128)throw new Error(`${j}: Expected 64-byte hex`);return new Signature$1(hexToNumber(_e.slice(0,64)),hexToNumber(_e.slice(64,128)))}static fromDER(a){const $=a instanceof Uint8Array;if(typeof a!="string"&&!$)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r:j,s:_e}=parseDERSignature($?a:hexToBytes$1(a));return new Signature$1(j,_e)}static fromHex(a){return this.fromDER(a)}assertValidity(){const{r:a,s:$}=this;if(!isWithinCurveOrder(a))throw new Error("Invalid Signature: r must be 0 < r < n");if(!isWithinCurveOrder($))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const a=CURVE$1.n>>_1n$1;return this.s>a}normalizeS(){return this.hasHighS()?new Signature$1(this.r,CURVE$1.n-this.s):this}toDERRawBytes(a=!1){return hexToBytes$1(this.toDERHex(a))}toDERHex(a=!1){const $=sliceDER(numberToHexUnpadded(this.s));if(a)return $;const j=sliceDER(numberToHexUnpadded(this.r)),_e=numberToHexUnpadded(j.length/2),et=numberToHexUnpadded($.length/2);return`30${numberToHexUnpadded(j.length/2+$.length/2+4)}02${_e}${j}02${et}${$}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return hexToBytes$1(this.toCompactHex())}toCompactHex(){return numTo32bStr(this.r)+numTo32bStr(this.s)}}function concatBytes$1(..._){if(!_.every(j=>j instanceof Uint8Array))throw new Error("Uint8Array list expected");if(_.length===1)return _[0];const a=_.reduce((j,_e)=>j+_e.length,0),$=new Uint8Array(a);for(let j=0,_e=0;j<_.length;j++){const et=_[j];$.set(et,_e),_e+=et.length}return $}const hexes$1=Array.from({length:256},(_,a)=>a.toString(16).padStart(2,"0"));function bytesToHex$1(_){if(!(_ instanceof Uint8Array))throw new Error("Expected Uint8Array");let a="";for(let $=0;$<_.length;$++)a+=hexes$1[_[$]];return a}const POW_2_256$1=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function numTo32bStr(_){if(typeof _!="bigint")throw new Error("Expected bigint");if(!(_0n$1<=_&&_<POW_2_256$1))throw new Error("Expected number < 2^256");return _.toString(16).padStart(64,"0")}function numTo32b(_){const a=hexToBytes$1(numTo32bStr(_));if(a.length!==32)throw new Error("Error: expected 32 bytes");return a}function numberToHexUnpadded(_){const a=_.toString(16);return a.length&1?`0${a}`:a}function hexToNumber(_){if(typeof _!="string")throw new TypeError("hexToNumber: expected string, got "+typeof _);return BigInt(`0x${_}`)}function hexToBytes$1(_){if(typeof _!="string")throw new TypeError("hexToBytes: expected string, got "+typeof _);if(_.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+_.length);const a=new Uint8Array(_.length/2);for(let $=0;$<a.length;$++){const j=$*2,_e=_.slice(j,j+2),et=Number.parseInt(_e,16);if(Number.isNaN(et)||et<0)throw new Error("Invalid byte sequence");a[$]=et}return a}function bytesToNumber(_){return hexToNumber(bytesToHex$1(_))}function ensureBytes$1(_){return _ instanceof Uint8Array?Uint8Array.from(_):hexToBytes$1(_)}function normalizeScalar$1(_){if(typeof _=="number"&&Number.isSafeInteger(_)&&_>0)return BigInt(_);if(typeof _=="bigint"&&isWithinCurveOrder(_))return _;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function mod$1(_,a=CURVE$1.P){const $=_%a;return $>=_0n$1?$:a+$}function pow2$1(_,a){const{P:$}=CURVE$1;let j=_;for(;a-- >_0n$1;)j*=j,j%=$;return j}function sqrtMod(_){const{P:a}=CURVE$1,$=BigInt(6),j=BigInt(11),_e=BigInt(22),et=BigInt(23),tt=BigInt(44),rt=BigInt(88),nt=_*_*_%a,it=nt*nt*_%a,st=pow2$1(it,_3n)*it%a,ot=pow2$1(st,_3n)*it%a,at=pow2$1(ot,_2n$1)*nt%a,lt=pow2$1(at,j)*at%a,ct=pow2$1(lt,_e)*lt%a,ut=pow2$1(ct,tt)*ct%a,dt=pow2$1(ut,rt)*ut%a,ft=pow2$1(dt,tt)*ct%a,pt=pow2$1(ft,_3n)*it%a,yt=pow2$1(pt,et)*lt%a,mt=pow2$1(yt,$)*nt%a;return pow2$1(mt,_2n$1)}function invert$1(_,a=CURVE$1.P){if(_===_0n$1||a<=_0n$1)throw new Error(`invert: expected positive integers, got n=${_} mod=${a}`);let $=mod$1(_,a),j=a,_e=_0n$1,et=_1n$1;for(;$!==_0n$1;){const rt=j/$,nt=j%$,it=_e-et*rt;j=$,$=nt,_e=et,et=it}if(j!==_1n$1)throw new Error("invert: does not exist");return mod$1(_e,a)}function invertBatch$1(_,a=CURVE$1.P){const $=new Array(_.length),j=_.reduce((et,tt,rt)=>tt===_0n$1?et:($[rt]=et,mod$1(et*tt,a)),_1n$1),_e=invert$1(j,a);return _.reduceRight((et,tt,rt)=>tt===_0n$1?et:($[rt]=mod$1(et*$[rt],a),mod$1(et*tt,a)),_e),$}const divNearest=(_,a)=>(_+a/_2n$1)/a,ENDO={a1:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),b1:-_1n$1*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a2:BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),b2:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),POW_2_128:BigInt("0x100000000000000000000000000000000")};function splitScalarEndo(_){const{n:a}=CURVE$1,{a1:$,b1:j,a2:_e,b2:et,POW_2_128:tt}=ENDO,rt=divNearest(et*_,a),nt=divNearest(-j*_,a);let it=mod$1(_-rt*$-nt*_e,a),st=mod$1(-rt*j-nt*et,a);const ot=it>tt,at=st>tt;if(ot&&(it=a-it),at&&(st=a-st),it>tt||st>tt)throw new Error("splitScalarEndo: Endomorphism failed, k="+_);return{k1neg:ot,k1:it,k2neg:at,k2:st}}function truncateHash(_){const{n:a}=CURVE$1,j=_.length*8-256;let _e=bytesToNumber(_);return j>0&&(_e=_e>>BigInt(j)),_e>=a&&(_e-=a),_e}let _sha256Sync,_hmacSha256Sync;class HmacDrbg{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...a){return utils$1.hmacSha256(this.k,...a)}hmacSync(...a){return _hmacSha256Sync(this.k,...a)}checkSync(){if(typeof _hmacSha256Sync!="function")throw new ShaError("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(a=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),a),this.v=await this.hmac(this.v),a.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),a),this.v=await this.hmac(this.v))}reseedSync(a=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),a),this.v=this.hmacSync(this.v),a.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),a),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.checkSync(),this.incr(),this.v=this.hmacSync(this.v),this.v}}function isWithinCurveOrder(_){return _0n$1<_&&_<CURVE$1.n}function isValidFieldElement(_){return _0n$1<_&&_<CURVE$1.P}function kmdToSig(_,a,$){const j=bytesToNumber(_);if(!isWithinCurveOrder(j))return;const{n:_e}=CURVE$1,et=Point$1.BASE.multiply(j),tt=mod$1(et.x,_e);if(tt===_0n$1)return;const rt=mod$1(invert$1(j,_e)*mod$1(a+$*tt,_e),_e);if(rt===_0n$1)return;const nt=new Signature$1(tt,rt),it=(et.x===nt.r?0:2)|Number(et.y&_1n$1);return{sig:nt,recovery:it}}function normalizePrivateKey(_){let a;if(typeof _=="bigint")a=_;else if(typeof _=="number"&&Number.isSafeInteger(_)&&_>0)a=BigInt(_);else if(typeof _=="string"){if(_.length!==64)throw new Error("Expected 32 bytes of private key");a=hexToNumber(_)}else if(_ instanceof Uint8Array){if(_.length!==32)throw new Error("Expected 32 bytes of private key");a=bytesToNumber(_)}else throw new TypeError("Expected valid private key");if(!isWithinCurveOrder(a))throw new Error("Expected private key: 0 < key < n");return a}function normalizePublicKey(_){return _ instanceof Point$1?(_.assertValidity(),_):Point$1.fromHex(_)}function normalizeSignature(_){if(_ instanceof Signature$1)return _.assertValidity(),_;try{return Signature$1.fromDER(_)}catch{return Signature$1.fromCompact(_)}}function getPublicKey$1(_,a=!1){return Point$1.fromPrivateKey(_).toRawBytes(a)}function bits2int(_){const a=_.length>32?_.slice(0,32):_;return bytesToNumber(a)}function bits2octets(_){const a=bits2int(_),$=mod$1(a,CURVE$1.n);return int2octets($<_0n$1?a:$)}function int2octets(_){return numTo32b(_)}function initSigArgs(_,a,$){if(_==null)throw new Error(`sign: expected valid message hash, not "${_}"`);const j=ensureBytes$1(_),_e=normalizePrivateKey(a),et=[int2octets(_e),bits2octets(j)];if($!=null){$===!0&&($=utils$1.randomBytes(32));const nt=ensureBytes$1($);if(nt.length!==32)throw new Error("sign: Expected 32 bytes of extra data");et.push(nt)}const tt=concatBytes$1(...et),rt=bits2int(j);return{seed:tt,m:rt,d:_e}}function finalizeSig(_,a){let{sig:$,recovery:j}=_;const{canonical:_e,der:et,recovered:tt}=Object.assign({canonical:!0,der:!0},a);_e&&$.hasHighS()&&($=$.normalizeS(),j^=1);const rt=et?$.toDERRawBytes():$.toCompactRawBytes();return tt?[rt,j]:rt}async function sign$1(_,a,$={}){const{seed:j,m:_e,d:et}=initSigArgs(_,a,$.extraEntropy);let tt;const rt=new HmacDrbg;for(await rt.reseed(j);!(tt=kmdToSig(await rt.generate(),_e,et));)await rt.reseed();return finalizeSig(tt,$)}const vopts={strict:!0};function verify$1(_,a,$,j=vopts){let _e;try{_e=normalizeSignature(_),a=ensureBytes$1(a)}catch{return!1}const{r:et,s:tt}=_e;if(j.strict&&_e.hasHighS())return!1;const rt=truncateHash(a);let nt;try{nt=normalizePublicKey($)}catch{return!1}const{n:it}=CURVE$1,st=invert$1(tt,it),ot=mod$1(rt*st,it),at=mod$1(et*st,it),lt=Point$1.BASE.multiplyAndAddUnsafe(nt,ot,at);return lt?mod$1(lt.x,it)===et:!1}Point$1.BASE._setWindowSize(8);const crypto$4={node:nodeCrypto,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},TAGGED_HASH_PREFIXES={},utils$1={bytesToHex:bytesToHex$1,hexToBytes:hexToBytes$1,concatBytes:concatBytes$1,mod:mod$1,invert:invert$1,isValidPrivateKey(_){try{return normalizePrivateKey(_),!0}catch{return!1}},_bigintTo32Bytes:numTo32b,_normalizePrivateKey:normalizePrivateKey,hashToPrivateKey:_=>{if(_=ensureBytes$1(_),_.length<40||_.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");const a=mod$1(bytesToNumber(_),CURVE$1.n-_1n$1)+_1n$1;return numTo32b(a)},randomBytes:(_=32)=>{if(crypto$4.web)return crypto$4.web.getRandomValues(new Uint8Array(_));if(crypto$4.node){const{randomBytes:a}=crypto$4.node;return Uint8Array.from(a(_))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>utils$1.hashToPrivateKey(utils$1.randomBytes(40)),sha256:async(..._)=>{if(crypto$4.web){const a=await crypto$4.web.subtle.digest("SHA-256",concatBytes$1(..._));return new Uint8Array(a)}else if(crypto$4.node){const{createHash:a}=crypto$4.node,$=a("sha256");return _.forEach(j=>$.update(j)),Uint8Array.from($.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(_,...a)=>{if(crypto$4.web){const $=await crypto$4.web.subtle.importKey("raw",_,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),j=concatBytes$1(...a),_e=await crypto$4.web.subtle.sign("HMAC",$,j);return new Uint8Array(_e)}else if(crypto$4.node){const{createHmac:$}=crypto$4.node,j=$("sha256",_);return a.forEach(_e=>j.update(_e)),Uint8Array.from(j.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(_,...a)=>{let $=TAGGED_HASH_PREFIXES[_];if($===void 0){const j=await utils$1.sha256(Uint8Array.from(_,_e=>_e.charCodeAt(0)));$=concatBytes$1(j,j),TAGGED_HASH_PREFIXES[_]=$}return utils$1.sha256($,...a)},taggedHashSync:(_,...a)=>{if(typeof _sha256Sync!="function")throw new ShaError("sha256Sync is undefined, you need to set it");let $=TAGGED_HASH_PREFIXES[_];if($===void 0){const j=_sha256Sync(Uint8Array.from(_,_e=>_e.charCodeAt(0)));$=concatBytes$1(j,j),TAGGED_HASH_PREFIXES[_]=$}return _sha256Sync($,...a)},precompute(_=8,a=Point$1.BASE){const $=a===Point$1.BASE?a:new Point$1(a.x,a.y);return $._setWindowSize(_),$.multiply(_3n),$}};Object.defineProperties(utils$1,{sha256Sync:{configurable:!1,get(){return _sha256Sync},set(_){_sha256Sync||(_sha256Sync=_)}},hmacSha256Sync:{configurable:!1,get(){return _hmacSha256Sync},set(_){_hmacSha256Sync||(_hmacSha256Sync=_)}}});function randomBytes$3(_){if(isNaN(_)||_<=0)throw errCode(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return utils$1.randomBytes(_)}function pkcs1ToJwk(_){const a=forge$s.asn1.fromDer(toString$6(_,"ascii")),$=forge$s.pki.privateKeyFromAsn1(a);return{kty:"RSA",n:bigIntegerToUintBase64url($.n),e:bigIntegerToUintBase64url($.e),d:bigIntegerToUintBase64url($.d),p:bigIntegerToUintBase64url($.p),q:bigIntegerToUintBase64url($.q),dp:bigIntegerToUintBase64url($.dP),dq:bigIntegerToUintBase64url($.dQ),qi:bigIntegerToUintBase64url($.qInv),alg:"RS256"}}function jwkToPkcs1(_){if(_.n==null||_.e==null||_.d==null||_.p==null||_.q==null||_.dp==null||_.dq==null||_.qi==null)throw errCode(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");const a=forge$s.pki.privateKeyToAsn1({n:base64urlToBigInteger(_.n),e:base64urlToBigInteger(_.e),d:base64urlToBigInteger(_.d),p:base64urlToBigInteger(_.p),q:base64urlToBigInteger(_.q),dP:base64urlToBigInteger(_.dp),dQ:base64urlToBigInteger(_.dq),qInv:base64urlToBigInteger(_.qi)});return fromString$5(forge$s.asn1.toDer(a).getBytes(),"ascii")}function pkixToJwk(_){const a=forge$s.asn1.fromDer(toString$6(_,"ascii")),$=forge$s.pki.publicKeyFromAsn1(a);return{kty:"RSA",n:bigIntegerToUintBase64url($.n),e:bigIntegerToUintBase64url($.e)}}function jwkToPkix(_){if(_.n==null||_.e==null)throw errCode(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");const a=forge$s.pki.publicKeyToAsn1({n:base64urlToBigInteger(_.n),e:base64urlToBigInteger(_.e)});return fromString$5(forge$s.asn1.toDer(a).getBytes(),"ascii")}function convert(_,a){return a.map($=>base64urlToBigInteger(_[$]))}function jwk2priv(_){return forge$s.pki.setRsaPrivateKey(...convert(_,["n","e","d","p","q","dp","dq","qi"]))}function jwk2pub(_){return forge$s.pki.setRsaPublicKey(...convert(_,["n","e"]))}async function generateKey$2(_){const a=await webcrypto.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:_,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),$=await exportKey(a);return{privateKey:$[0],publicKey:$[1]}}async function unmarshalPrivateKey$1(_){const $=[await webcrypto.get().subtle.importKey("jwk",_,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await derivePublicFromPrivate(_)],j=await exportKey({privateKey:$[0],publicKey:$[1]});return{privateKey:j[0],publicKey:j[1]}}async function hashAndSign$2(_,a){const $=await webcrypto.get().subtle.importKey("jwk",_,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),j=await webcrypto.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},$,Uint8Array.from(a));return new Uint8Array(j,0,j.byteLength)}async function hashAndVerify$2(_,a,$){const j=await webcrypto.get().subtle.importKey("jwk",_,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await webcrypto.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},j,a,$)}async function exportKey(_){if(_.privateKey==null||_.publicKey==null)throw errCode(new Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([webcrypto.get().subtle.exportKey("jwk",_.privateKey),webcrypto.get().subtle.exportKey("jwk",_.publicKey)])}async function derivePublicFromPrivate(_){return await webcrypto.get().subtle.importKey("jwk",{kty:_.kty,n:_.n,e:_.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function convertKey(_,a,$,j){const _e=a?jwk2pub(_):jwk2priv(_),et=toString$6(Uint8Array.from($),"ascii"),tt=j(et,_e);return fromString$5(tt,"ascii")}function encrypt(_,a){return convertKey(_,!0,a,($,j)=>j.encrypt($))}function decrypt(_,a){return convertKey(_,!1,a,($,j)=>j.decrypt($))}async function exporter$1(_,a){const j=await create$9().encrypt(_,a);return base64$6.encode(j)}class RsaPublicKey{constructor(a){this._key=a}async verify(a,$){return await hashAndVerify$2(this._key,$,a)}marshal(){return jwkToPkix(this._key)}get bytes(){return PublicKey.encode({Type:KeyType.RSA,Data:this.marshal()}).subarray()}encrypt(a){return encrypt(this._key,a)}equals(a){return equals$1(this.bytes,a.bytes)}async hash(){const{bytes:a}=await sha256$4.digest(this.bytes);return a}}class RsaPrivateKey{constructor(a,$){this._key=a,this._publicKey=$}genSecret(){return randomBytes$3(16)}async sign(a){return await hashAndSign$2(this._key,a)}get public(){if(this._publicKey==null)throw errCode(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new RsaPublicKey(this._publicKey)}decrypt(a){return decrypt(this._key,a)}marshal(){return jwkToPkcs1(this._key)}get bytes(){return PrivateKey.encode({Type:KeyType.RSA,Data:this.marshal()}).subarray()}equals(a){return equals$1(this.bytes,a.bytes)}async hash(){const{bytes:a}=await sha256$4.digest(this.bytes);return a}async id(){const a=await this.public.hash();return toString$6(a,"base58btc")}async export(a,$="pkcs-8"){if($==="pkcs-8"){const j=new forge$s.util.ByteBuffer(this.marshal()),_e=forge$s.asn1.fromDer(j),et=forge$s.pki.privateKeyFromAsn1(_e),tt={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return forge$s.pki.encryptRsaPrivateKey(et,a,tt)}else{if($==="libp2p-key")return await exporter$1(this.bytes,a);throw errCode(new Error(`export format '${$}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}}async function unmarshalRsaPrivateKey(_){const a=pkcs1ToJwk(_),$=await unmarshalPrivateKey$1(a);return new RsaPrivateKey($.privateKey,$.publicKey)}function unmarshalRsaPublicKey(_){const a=pkixToJwk(_);return new RsaPublicKey(a)}async function fromJwk(_){const a=await unmarshalPrivateKey$1(_);return new RsaPrivateKey(a.privateKey,a.publicKey)}async function generateKeyPair$3(_){const a=await generateKey$2(_);return new RsaPrivateKey(a.privateKey,a.publicKey)}const RSA=Object.freeze(Object.defineProperty({__proto__:null,RsaPublicKey,RsaPrivateKey,unmarshalRsaPrivateKey,unmarshalRsaPublicKey,fromJwk,generateKeyPair:generateKeyPair$3},Symbol.toStringTag,{value:"Module"}));/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const _0n=BigInt(0),_1n=BigInt(1),_2n=BigInt(2),CU_O=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),CURVE=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:CU_O,n:CU_O,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),POW_2_256=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),SQRT_M1=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742");const SQRT_AD_MINUS_ONE=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),INVSQRT_A_MINUS_D=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),ONE_MINUS_D_SQ=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),D_MINUS_ONE_SQ=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class ExtendedPoint{constructor(a,$,j,_e){this.x=a,this.y=$,this.z=j,this.t=_e}static fromAffine(a){if(!(a instanceof Point))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return a.equals(Point.ZERO)?ExtendedPoint.ZERO:new ExtendedPoint(a.x,a.y,_1n,mod(a.x*a.y))}static toAffineBatch(a){const $=invertBatch(a.map(j=>j.z));return a.map((j,_e)=>j.toAffine($[_e]))}static normalizeZ(a){return this.toAffineBatch(a).map(this.fromAffine)}equals(a){assertExtPoint(a);const{x:$,y:j,z:_e}=this,{x:et,y:tt,z:rt}=a,nt=mod($*rt),it=mod(et*_e),st=mod(j*rt),ot=mod(tt*_e);return nt===it&&st===ot}negate(){return new ExtendedPoint(mod(-this.x),this.y,this.z,mod(-this.t))}double(){const{x:a,y:$,z:j}=this,{a:_e}=CURVE,et=mod(a*a),tt=mod($*$),rt=mod(_2n*mod(j*j)),nt=mod(_e*et),it=a+$,st=mod(mod(it*it)-et-tt),ot=nt+tt,at=ot-rt,lt=nt-tt,ct=mod(st*at),ut=mod(ot*lt),dt=mod(st*lt),ft=mod(at*ot);return new ExtendedPoint(ct,ut,ft,dt)}add(a){assertExtPoint(a);const{x:$,y:j,z:_e,t:et}=this,{x:tt,y:rt,z:nt,t:it}=a,st=mod((j-$)*(rt+tt)),ot=mod((j+$)*(rt-tt)),at=mod(ot-st);if(at===_0n)return this.double();const lt=mod(_e*_2n*it),ct=mod(et*_2n*nt),ut=ct+lt,dt=ot+st,ft=ct-lt,pt=mod(ut*at),yt=mod(dt*ft),mt=mod(ut*ft),_t=mod(at*dt);return new ExtendedPoint(pt,yt,_t,mt)}subtract(a){return this.add(a.negate())}precomputeWindow(a){const $=1+256/a,j=[];let _e=this,et=_e;for(let tt=0;tt<$;tt++){et=_e,j.push(et);for(let rt=1;rt<2**(a-1);rt++)et=et.add(_e),j.push(et);_e=et.double()}return j}wNAF(a,$){!$&&this.equals(ExtendedPoint.BASE)&&($=Point.BASE);const j=$&&$._WINDOW_SIZE||1;if(256%j)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let _e=$&&pointPrecomputes.get($);_e||(_e=this.precomputeWindow(j),$&&j!==1&&(_e=ExtendedPoint.normalizeZ(_e),pointPrecomputes.set($,_e)));let et=ExtendedPoint.ZERO,tt=ExtendedPoint.ZERO;const rt=1+256/j,nt=2**(j-1),it=BigInt(2**j-1),st=2**j,ot=BigInt(j);for(let at=0;at<rt;at++){const lt=at*nt;let ct=Number(a&it);if(a>>=ot,ct>nt&&(ct-=st,a+=_1n),ct===0){let ut=_e[lt];at%2&&(ut=ut.negate()),tt=tt.add(ut)}else{let ut=_e[lt+Math.abs(ct)-1];ct<0&&(ut=ut.negate()),et=et.add(ut)}}return ExtendedPoint.normalizeZ([et,tt])[0]}multiply(a,$){return this.wNAF(normalizeScalar(a,CURVE.l),$)}multiplyUnsafe(a){let $=normalizeScalar(a,CURVE.l,!1);const j=ExtendedPoint.BASE,_e=ExtendedPoint.ZERO;if($===_0n)return _e;if(this.equals(_e)||$===_1n)return this;if(this.equals(j))return this.wNAF($);let et=_e,tt=this;for(;$>_0n;)$&_1n&&(et=et.add(tt)),tt=tt.double(),$>>=_1n;return et}isSmallOrder(){return this.multiplyUnsafe(CURVE.h).equals(ExtendedPoint.ZERO)}isTorsionFree(){return this.multiplyUnsafe(CURVE.l).equals(ExtendedPoint.ZERO)}toAffine(a=invert(this.z)){const{x:$,y:j,z:_e}=this,et=mod($*a),tt=mod(j*a);if(mod(_e*a)!==_1n)throw new Error("invZ was invalid");return new Point(et,tt)}fromRistrettoBytes(){legacyRist()}toRistrettoBytes(){legacyRist()}fromRistrettoHash(){legacyRist()}}ExtendedPoint.BASE=new ExtendedPoint(CURVE.Gx,CURVE.Gy,_1n,mod(CURVE.Gx*CURVE.Gy));ExtendedPoint.ZERO=new ExtendedPoint(_0n,_1n,_1n,_0n);function assertExtPoint(_){if(!(_ instanceof ExtendedPoint))throw new TypeError("ExtendedPoint expected")}function assertRstPoint(_){if(!(_ instanceof RistrettoPoint))throw new TypeError("RistrettoPoint expected")}function legacyRist(){throw new Error("Legacy method: switch to RistrettoPoint")}class RistrettoPoint{constructor(a){this.ep=a}static calcElligatorRistrettoMap(a){const{d:$}=CURVE,j=mod(SQRT_M1*a*a),_e=mod((j+_1n)*ONE_MINUS_D_SQ);let et=BigInt(-1);const tt=mod((et-$*j)*mod(j+$));let{isValid:rt,value:nt}=uvRatio(_e,tt),it=mod(nt*a);edIsNegative(it)||(it=mod(-it)),rt||(nt=it),rt||(et=j);const st=mod(et*(j-_1n)*D_MINUS_ONE_SQ-tt),ot=nt*nt,at=mod((nt+nt)*tt),lt=mod(st*SQRT_AD_MINUS_ONE),ct=mod(_1n-ot),ut=mod(_1n+ot);return new ExtendedPoint(mod(at*ut),mod(ct*lt),mod(lt*ut),mod(at*ct))}static hashToCurve(a){a=ensureBytes(a,64);const $=bytes255ToNumberLE(a.slice(0,32)),j=this.calcElligatorRistrettoMap($),_e=bytes255ToNumberLE(a.slice(32,64)),et=this.calcElligatorRistrettoMap(_e);return new RistrettoPoint(j.add(et))}static fromHex(a){a=ensureBytes(a,32);const{a:$,d:j}=CURVE,_e="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",et=bytes255ToNumberLE(a);if(!equalBytes(numberTo32BytesLE(et),a)||edIsNegative(et))throw new Error(_e);const tt=mod(et*et),rt=mod(_1n+$*tt),nt=mod(_1n-$*tt),it=mod(rt*rt),st=mod(nt*nt),ot=mod($*j*it-st),{isValid:at,value:lt}=invertSqrt(mod(ot*st)),ct=mod(lt*nt),ut=mod(lt*ct*ot);let dt=mod((et+et)*ct);edIsNegative(dt)&&(dt=mod(-dt));const ft=mod(rt*ut),pt=mod(dt*ft);if(!at||edIsNegative(pt)||ft===_0n)throw new Error(_e);return new RistrettoPoint(new ExtendedPoint(dt,ft,_1n,pt))}toRawBytes(){let{x:a,y:$,z:j,t:_e}=this.ep;const et=mod(mod(j+$)*mod(j-$)),tt=mod(a*$),rt=mod(tt*tt),{value:nt}=invertSqrt(mod(et*rt)),it=mod(nt*et),st=mod(nt*tt),ot=mod(it*st*_e);let at;if(edIsNegative(_e*ot)){let ct=mod($*SQRT_M1),ut=mod(a*SQRT_M1);a=ct,$=ut,at=mod(it*INVSQRT_A_MINUS_D)}else at=st;edIsNegative(a*ot)&&($=mod(-$));let lt=mod((j-$)*at);return edIsNegative(lt)&&(lt=mod(-lt)),numberTo32BytesLE(lt)}toHex(){return bytesToHex(this.toRawBytes())}toString(){return this.toHex()}equals(a){assertRstPoint(a);const $=this.ep,j=a.ep,_e=mod($.x*j.y)===mod($.y*j.x),et=mod($.y*j.y)===mod($.x*j.x);return _e||et}add(a){return assertRstPoint(a),new RistrettoPoint(this.ep.add(a.ep))}subtract(a){return assertRstPoint(a),new RistrettoPoint(this.ep.subtract(a.ep))}multiply(a){return new RistrettoPoint(this.ep.multiply(a))}multiplyUnsafe(a){return new RistrettoPoint(this.ep.multiplyUnsafe(a))}}RistrettoPoint.BASE=new RistrettoPoint(ExtendedPoint.BASE);RistrettoPoint.ZERO=new RistrettoPoint(ExtendedPoint.ZERO);const pointPrecomputes=new WeakMap;class Point{constructor(a,$){this.x=a,this.y=$}_setWindowSize(a){this._WINDOW_SIZE=a,pointPrecomputes.delete(this)}static fromHex(a,$=!0){const{d:j,P:_e}=CURVE;a=ensureBytes(a,32);const et=a.slice();et[31]=a[31]&-129;const tt=bytesToNumberLE(et);if($&&tt>=_e)throw new Error("Expected 0 < hex < P");if(!$&&tt>=POW_2_256)throw new Error("Expected 0 < hex < 2**256");const rt=mod(tt*tt),nt=mod(rt-_1n),it=mod(j*rt+_1n);let{isValid:st,value:ot}=uvRatio(nt,it);if(!st)throw new Error("Point.fromHex: invalid y coordinate");const at=(ot&_1n)===_1n;return(a[31]&128)!==0!==at&&(ot=mod(-ot)),new Point(ot,tt)}static async fromPrivateKey(a){return(await getExtendedPublicKey(a)).point}toRawBytes(){const a=numberTo32BytesLE(this.y);return a[31]|=this.x&_1n?128:0,a}toHex(){return bytesToHex(this.toRawBytes())}toX25519(){const{y:a}=this,$=mod((_1n+a)*invert(_1n-a));return numberTo32BytesLE($)}isTorsionFree(){return ExtendedPoint.fromAffine(this).isTorsionFree()}equals(a){return this.x===a.x&&this.y===a.y}negate(){return new Point(mod(-this.x),this.y)}add(a){return ExtendedPoint.fromAffine(this).add(ExtendedPoint.fromAffine(a)).toAffine()}subtract(a){return this.add(a.negate())}multiply(a){return ExtendedPoint.fromAffine(this).multiply(a,this).toAffine()}}Point.BASE=new Point(CURVE.Gx,CURVE.Gy);Point.ZERO=new Point(_0n,_1n);class Signature{constructor(a,$){this.r=a,this.s=$,this.assertValidity()}static fromHex(a){const $=ensureBytes(a,64),j=Point.fromHex($.slice(0,32),!1),_e=bytesToNumberLE($.slice(32,64));return new Signature(j,_e)}assertValidity(){const{r:a,s:$}=this;if(!(a instanceof Point))throw new Error("Expected Point instance");return normalizeScalar($,CURVE.l,!1),this}toRawBytes(){const a=new Uint8Array(64);return a.set(this.r.toRawBytes()),a.set(numberTo32BytesLE(this.s),32),a}toHex(){return bytesToHex(this.toRawBytes())}}function concatBytes(..._){if(!_.every(j=>j instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(_.length===1)return _[0];const a=_.reduce((j,_e)=>j+_e.length,0),$=new Uint8Array(a);for(let j=0,_e=0;j<_.length;j++){const et=_[j];$.set(et,_e),_e+=et.length}return $}const hexes=Array.from({length:256},(_,a)=>a.toString(16).padStart(2,"0"));function bytesToHex(_){if(!(_ instanceof Uint8Array))throw new Error("Uint8Array expected");let a="";for(let $=0;$<_.length;$++)a+=hexes[_[$]];return a}function hexToBytes(_){if(typeof _!="string")throw new TypeError("hexToBytes: expected string, got "+typeof _);if(_.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const a=new Uint8Array(_.length/2);for(let $=0;$<a.length;$++){const j=$*2,_e=_.slice(j,j+2),et=Number.parseInt(_e,16);if(Number.isNaN(et)||et<0)throw new Error("Invalid byte sequence");a[$]=et}return a}function numberTo32BytesBE(_){const $=_.toString(16).padStart(64,"0");return hexToBytes($)}function numberTo32BytesLE(_){return numberTo32BytesBE(_).reverse()}function edIsNegative(_){return(mod(_)&_1n)===_1n}function bytesToNumberLE(_){if(!(_ instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+bytesToHex(Uint8Array.from(_).reverse()))}const MAX_255B=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function bytes255ToNumberLE(_){return mod(bytesToNumberLE(_)&MAX_255B)}function mod(_,a=CURVE.P){const $=_%a;return $>=_0n?$:a+$}function invert(_,a=CURVE.P){if(_===_0n||a<=_0n)throw new Error(`invert: expected positive integers, got n=${_} mod=${a}`);let $=mod(_,a),j=a,_e=_0n,et=_1n;for(;$!==_0n;){const rt=j/$,nt=j%$,it=_e-et*rt;j=$,$=nt,_e=et,et=it}if(j!==_1n)throw new Error("invert: does not exist");return mod(_e,a)}function invertBatch(_,a=CURVE.P){const $=new Array(_.length),j=_.reduce((et,tt,rt)=>tt===_0n?et:($[rt]=et,mod(et*tt,a)),_1n),_e=invert(j,a);return _.reduceRight((et,tt,rt)=>tt===_0n?et:($[rt]=mod(et*$[rt],a),mod(et*tt,a)),_e),$}function pow2(_,a){const{P:$}=CURVE;let j=_;for(;a-- >_0n;)j*=j,j%=$;return j}function pow_2_252_3(_){const{P:a}=CURVE,$=BigInt(5),j=BigInt(10),_e=BigInt(20),et=BigInt(40),tt=BigInt(80),nt=_*_%a*_%a,it=pow2(nt,_2n)*nt%a,st=pow2(it,_1n)*_%a,ot=pow2(st,$)*st%a,at=pow2(ot,j)*ot%a,lt=pow2(at,_e)*at%a,ct=pow2(lt,et)*lt%a,ut=pow2(ct,tt)*ct%a,dt=pow2(ut,tt)*ct%a,ft=pow2(dt,j)*ot%a;return{pow_p_5_8:pow2(ft,_2n)*_%a,b2:nt}}function uvRatio(_,a){const $=mod(a*a*a),j=mod($*$*a),_e=pow_2_252_3(_*j).pow_p_5_8;let et=mod(_*$*_e);const tt=mod(a*et*et),rt=et,nt=mod(et*SQRT_M1),it=tt===_,st=tt===mod(-_),ot=tt===mod(-_*SQRT_M1);return it&&(et=rt),(st||ot)&&(et=nt),edIsNegative(et)&&(et=mod(-et)),{isValid:it||st,value:et}}function invertSqrt(_){return uvRatio(_1n,_)}function modlLE(_){return mod(bytesToNumberLE(_),CURVE.l)}function equalBytes(_,a){if(_.length!==a.length)return!1;for(let $=0;$<_.length;$++)if(_[$]!==a[$])return!1;return!0}function ensureBytes(_,a){const $=_ instanceof Uint8Array?Uint8Array.from(_):hexToBytes(_);if(typeof a=="number"&&$.length!==a)throw new Error(`Expected ${a} bytes`);return $}function normalizeScalar(_,a,$=!0){if(!a)throw new TypeError("Specify max value");if(typeof _=="number"&&Number.isSafeInteger(_)&&(_=BigInt(_)),typeof _=="bigint"&&_<a){if($){if(_0n<_)return _}else if(_0n<=_)return _}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function adjustBytes25519(_){return _[0]&=248,_[31]&=127,_[31]|=64,_}function checkPrivateKey(_){if(_=typeof _=="bigint"||typeof _=="number"?numberTo32BytesBE(normalizeScalar(_,POW_2_256)):ensureBytes(_),_.length!==32)throw new Error("Expected 32 bytes");return _}function getKeyFromHash(_){const a=adjustBytes25519(_.slice(0,32)),$=_.slice(32,64),j=modlLE(a),_e=Point.BASE.multiply(j),et=_e.toRawBytes();return{head:a,prefix:$,scalar:j,point:_e,pointBytes:et}}let _sha512Sync;async function getExtendedPublicKey(_){return getKeyFromHash(await utils.sha512(checkPrivateKey(_)))}async function getPublicKey(_){return(await getExtendedPublicKey(_)).pointBytes}async function sign(_,a){_=ensureBytes(_);const{prefix:$,scalar:j,pointBytes:_e}=await getExtendedPublicKey(a),et=modlLE(await utils.sha512($,_)),tt=Point.BASE.multiply(et),rt=modlLE(await utils.sha512(tt.toRawBytes(),_e,_)),nt=mod(et+rt*j,CURVE.l);return new Signature(tt,nt).toRawBytes()}function prepareVerification(_,a,$){a=ensureBytes(a),$ instanceof Point||($=Point.fromHex($,!1));const{r:j,s:_e}=_ instanceof Signature?_.assertValidity():Signature.fromHex(_),et=ExtendedPoint.BASE.multiplyUnsafe(_e);return{r:j,s:_e,SB:et,pub:$,msg:a}}function finishVerification(_,a,$,j){const _e=modlLE(j),et=ExtendedPoint.fromAffine(_).multiplyUnsafe(_e);return ExtendedPoint.fromAffine(a).add(et).subtract($).multiplyUnsafe(CURVE.h).equals(ExtendedPoint.ZERO)}async function verify(_,a,$){const{r:j,SB:_e,msg:et,pub:tt}=prepareVerification(_,a,$),rt=await utils.sha512(j.toRawBytes(),tt.toRawBytes(),et);return finishVerification(tt,j,_e,rt)}Point.BASE._setWindowSize(8);const crypto$3={node:nodeCrypto,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},utils={bytesToHex,hexToBytes,concatBytes,getExtendedPublicKey,mod,invert,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:_=>{if(_=ensureBytes(_),_.length<40||_.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return mod(bytesToNumberLE(_),CURVE.l-_1n)+_1n},randomBytes:(_=32)=>{if(crypto$3.web)return crypto$3.web.getRandomValues(new Uint8Array(_));if(crypto$3.node){const{randomBytes:a}=crypto$3.node;return new Uint8Array(a(_).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>utils.randomBytes(32),sha512:async(..._)=>{const a=concatBytes(..._);if(crypto$3.web){const $=await crypto$3.web.subtle.digest("SHA-512",a.buffer);return new Uint8Array($)}else{if(crypto$3.node)return Uint8Array.from(crypto$3.node.createHash("sha512").update(a).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(_=8,a=Point.BASE){const $=a.equals(Point.BASE)?a:new Point(a.x,a.y);return $._setWindowSize(_),$.multiply(_2n),$},sha512Sync:void 0};Object.defineProperties(utils,{sha512Sync:{configurable:!1,get(){return _sha512Sync},set(_){_sha512Sync||(_sha512Sync=_)}}});const PUBLIC_KEY_BYTE_LENGTH=32,PRIVATE_KEY_BYTE_LENGTH=64,KEYS_BYTE_LENGTH=32;async function generateKey$1(){const _=utils.randomPrivateKey(),a=await getPublicKey(_);return{privateKey:concatKeys(_,a),publicKey:a}}async function generateKeyFromSeed(_){if(_.length!==KEYS_BYTE_LENGTH)throw new TypeError('"seed" must be 32 bytes in length.');if(!(_ instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const a=_,$=await getPublicKey(a);return{privateKey:concatKeys(a,$),publicKey:$}}async function hashAndSign$1(_,a){const $=_.slice(0,KEYS_BYTE_LENGTH);return await sign(a,$)}async function hashAndVerify$1(_,a,$){return await verify(a,$,_)}function concatKeys(_,a){const $=new Uint8Array(PRIVATE_KEY_BYTE_LENGTH);for(let j=0;j<KEYS_BYTE_LENGTH;j++)$[j]=_[j],$[KEYS_BYTE_LENGTH+j]=a[j];return $}class Ed25519PublicKey{constructor(a){this._key=ensureKey(a,PUBLIC_KEY_BYTE_LENGTH)}async verify(a,$){return await hashAndVerify$1(this._key,$,a)}marshal(){return this._key}get bytes(){return PublicKey.encode({Type:KeyType.Ed25519,Data:this.marshal()}).subarray()}equals(a){return equals$1(this.bytes,a.bytes)}async hash(){const{bytes:a}=await sha256$4.digest(this.bytes);return a}}class Ed25519PrivateKey{constructor(a,$){this._key=ensureKey(a,PRIVATE_KEY_BYTE_LENGTH),this._publicKey=ensureKey($,PUBLIC_KEY_BYTE_LENGTH)}async sign(a){return await hashAndSign$1(this._key,a)}get public(){return new Ed25519PublicKey(this._publicKey)}marshal(){return this._key}get bytes(){return PrivateKey.encode({Type:KeyType.Ed25519,Data:this.marshal()}).subarray()}equals(a){return equals$1(this.bytes,a.bytes)}async hash(){const{bytes:a}=await sha256$4.digest(this.bytes);return a}async id(){const a=await identity$8.digest(this.public.bytes);return base58btc$2.encode(a.bytes).substring(1)}async export(a,$="libp2p-key"){if($==="libp2p-key")return await exporter$1(this.bytes,a);throw errCode(new Error(`export format '${$}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function unmarshalEd25519PrivateKey(_){if(_.length>PRIVATE_KEY_BYTE_LENGTH){_=ensureKey(_,PRIVATE_KEY_BYTE_LENGTH+PUBLIC_KEY_BYTE_LENGTH);const j=_.slice(0,PRIVATE_KEY_BYTE_LENGTH),_e=_.slice(PRIVATE_KEY_BYTE_LENGTH,_.length);return new Ed25519PrivateKey(j,_e)}_=ensureKey(_,PRIVATE_KEY_BYTE_LENGTH);const a=_.slice(0,PRIVATE_KEY_BYTE_LENGTH),$=_.slice(PUBLIC_KEY_BYTE_LENGTH);return new Ed25519PrivateKey(a,$)}function unmarshalEd25519PublicKey(_){return _=ensureKey(_,PUBLIC_KEY_BYTE_LENGTH),new Ed25519PublicKey(_)}async function generateKeyPair$2(){const{privateKey:_,publicKey:a}=await generateKey$1();return new Ed25519PrivateKey(_,a)}async function generateKeyPairFromSeed(_){const{privateKey:a,publicKey:$}=await generateKeyFromSeed(_);return new Ed25519PrivateKey(a,$)}function ensureKey(_,a){if(_=Uint8Array.from(_??[]),_.length!==a)throw errCode(new Error(`Key must be a Uint8Array of length ${a}, got ${_.length}`),"ERR_INVALID_KEY_TYPE");return _}const Ed25519=Object.freeze(Object.defineProperty({__proto__:null,Ed25519PublicKey,Ed25519PrivateKey,unmarshalEd25519PrivateKey,unmarshalEd25519PublicKey,generateKeyPair:generateKeyPair$2,generateKeyPairFromSeed},Symbol.toStringTag,{value:"Module"}));function generateKey(){return utils$1.randomPrivateKey()}async function hashAndSign(_,a){const{digest:$}=await sha256$4.digest(a);try{return await sign$1($,_)}catch(j){throw errCode(j,"ERR_INVALID_INPUT")}}async function hashAndVerify(_,a,$){try{const{digest:j}=await sha256$4.digest($);return verify$1(a,j,_)}catch(j){throw errCode(j,"ERR_INVALID_INPUT")}}function compressPublicKey(_){return Point$1.fromHex(_).toRawBytes(!0)}function validatePrivateKey(_){try{getPublicKey$1(_,!0)}catch(a){throw errCode(a,"ERR_INVALID_PRIVATE_KEY")}}function validatePublicKey(_){try{Point$1.fromHex(_)}catch(a){throw errCode(a,"ERR_INVALID_PUBLIC_KEY")}}function computePublicKey(_){try{return getPublicKey$1(_,!0)}catch(a){throw errCode(a,"ERR_INVALID_PRIVATE_KEY")}}class Secp256k1PublicKey{constructor(a){validatePublicKey(a),this._key=a}async verify(a,$){return await hashAndVerify(this._key,$,a)}marshal(){return compressPublicKey(this._key)}get bytes(){return PublicKey.encode({Type:KeyType.Secp256k1,Data:this.marshal()}).subarray()}equals(a){return equals$1(this.bytes,a.bytes)}async hash(){const{bytes:a}=await sha256$4.digest(this.bytes);return a}}class Secp256k1PrivateKey{constructor(a,$){this._key=a,this._publicKey=$??computePublicKey(a),validatePrivateKey(this._key),validatePublicKey(this._publicKey)}async sign(a){return await hashAndSign(this._key,a)}get public(){return new Secp256k1PublicKey(this._publicKey)}marshal(){return this._key}get bytes(){return PrivateKey.encode({Type:KeyType.Secp256k1,Data:this.marshal()}).subarray()}equals(a){return equals$1(this.bytes,a.bytes)}async hash(){const{bytes:a}=await sha256$4.digest(this.bytes);return a}async id(){const a=await this.public.hash();return toString$6(a,"base58btc")}async export(a,$="libp2p-key"){if($==="libp2p-key")return await exporter$1(this.bytes,a);throw errCode(new Error(`export format '${$}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function unmarshalSecp256k1PrivateKey(_){return new Secp256k1PrivateKey(_)}function unmarshalSecp256k1PublicKey(_){return new Secp256k1PublicKey(_)}async function generateKeyPair$1(){const _=await generateKey();return new Secp256k1PrivateKey(_)}const Secp256k1=Object.freeze(Object.defineProperty({__proto__:null,Secp256k1PublicKey,Secp256k1PrivateKey,unmarshalSecp256k1PrivateKey,unmarshalSecp256k1PublicKey,generateKeyPair:generateKeyPair$1},Symbol.toStringTag,{value:"Module"})),supportedKeys={rsa:RSA,ed25519:Ed25519,secp256k1:Secp256k1};function unsupportedKey(_){const a=Object.keys(supportedKeys).join(" / ");return errCode(new Error(`invalid or unsupported key type ${_}. Must be ${a}`),"ERR_UNSUPPORTED_KEY_TYPE")}function typeToKey(_){if(_=_.toLowerCase(),_==="rsa"||_==="ed25519"||_==="secp256k1")return supportedKeys[_];throw unsupportedKey(_)}async function generateKeyPair(_,a){return await typeToKey(_).generateKeyPair(a??2048)}function unmarshalPublicKey(_){const a=PublicKey.decode(_),$=a.Data??new Uint8Array;switch(a.Type){case KeyType.RSA:return supportedKeys.rsa.unmarshalRsaPublicKey($);case KeyType.Ed25519:return supportedKeys.ed25519.unmarshalEd25519PublicKey($);case KeyType.Secp256k1:return supportedKeys.secp256k1.unmarshalSecp256k1PublicKey($);default:throw unsupportedKey(a.Type??"RSA")}}function marshalPublicKey(_,a){return a=(a??"rsa").toLowerCase(),typeToKey(a),_.bytes}async function unmarshalPrivateKey(_){const a=PrivateKey.decode(_),$=a.Data??new Uint8Array;switch(a.Type){case KeyType.RSA:return await supportedKeys.rsa.unmarshalRsaPrivateKey($);case KeyType.Ed25519:return supportedKeys.ed25519.unmarshalEd25519PrivateKey($);case KeyType.Secp256k1:return supportedKeys.secp256k1.unmarshalSecp256k1PrivateKey($);default:throw unsupportedKey(a.Type??"RSA")}}function marshalPrivateKey(_,a){return a=(a??"rsa").toLowerCase(),typeToKey(a),_.bytes}async function importKey(_,a){try{const _e=await importer$1(_,a);return await unmarshalPrivateKey(_e)}catch{}const $=forge$s.pki.decryptRsaPrivateKey(_,a);if($===null)throw errCode(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let j=forge$s.asn1.toDer(forge$s.pki.privateKeyToAsn1($));return j=fromString$5(j.getBytes(),"ascii"),await supportedKeys.rsa.unmarshalRsaPrivateKey(j)}const ERR_IPNS_EXPIRED_RECORD="ERR_IPNS_EXPIRED_RECORD",ERR_UNRECOGNIZED_VALIDITY="ERR_UNRECOGNIZED_VALIDITY",ERR_SIGNATURE_CREATION="ERR_SIGNATURE_CREATION",ERR_SIGNATURE_VERIFICATION="ERR_SIGNATURE_VERIFICATION",ERR_UNRECOGNIZED_FORMAT="ERR_UNRECOGNIZED_FORMAT",ERR_UNDEFINED_PARAMETER="ERR_UNDEFINED_PARAMETER",ERR_INVALID_RECORD_DATA="ERR_INVALID_RECORD_DATA",ERR_INVALID_EMBEDDED_KEY="ERR_INVALID_EMBEDDED_KEY",ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY";var IpnsEntry;(function(_){(function(j){j.EOL="EOL"})(_.ValidityType||(_.ValidityType={}));let a;(function(j){j[j.EOL=0]="EOL"})(a||(a={})),function(j){j.codec=()=>enumeration(a)}(_.ValidityType||(_.ValidityType={}));let $;_.codec=()=>($==null&&($=message((j,_e,et={})=>{et.lengthDelimited!==!1&&_e.fork(),j.value!=null&&(_e.uint32(10),_e.bytes(j.value)),j.signature!=null&&(_e.uint32(18),_e.bytes(j.signature)),j.validityType!=null&&(_e.uint32(24),_.ValidityType.codec().encode(j.validityType,_e)),j.validity!=null&&(_e.uint32(34),_e.bytes(j.validity)),j.sequence!=null&&(_e.uint32(40),_e.uint64(j.sequence)),j.ttl!=null&&(_e.uint32(48),_e.uint64(j.ttl)),j.pubKey!=null&&(_e.uint32(58),_e.bytes(j.pubKey)),j.signatureV2!=null&&(_e.uint32(66),_e.bytes(j.signatureV2)),j.data!=null&&(_e.uint32(74),_e.bytes(j.data)),et.lengthDelimited!==!1&&_e.ldelim()},(j,_e)=>{const et={},tt=_e==null?j.len:j.pos+_e;for(;j.pos<tt;){const rt=j.uint32();switch(rt>>>3){case 1:et.value=j.bytes();break;case 2:et.signature=j.bytes();break;case 3:et.validityType=_.ValidityType.codec().decode(j);break;case 4:et.validity=j.bytes();break;case 5:et.sequence=j.uint64();break;case 6:et.ttl=j.uint64();break;case 7:et.pubKey=j.bytes();break;case 8:et.signatureV2=j.bytes();break;case 9:et.data=j.bytes();break;default:j.skipType(rt&7);break}}return et})),$),_.encode=j=>encodeMessage(j,_.codec()),_.decode=j=>decodeMessage(j,_.codec())})(IpnsEntry||(IpnsEntry={}));const log$1E=logger$1("ipns:utils"),IPNS_PREFIX$1=fromString$5("/ipns/");function parseRFC3339$1(_){const a=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),$=String(_).trim().match(a);if($==null)throw new Error("Invalid format");const j=parseInt($[1],10),_e=parseInt($[2],10)-1,et=parseInt($[3],10),tt=parseInt($[4],10),rt=parseInt($[5],10),nt=parseInt($[6],10),it=parseInt($[7].slice(0,-6),10);return new Date(Date.UTC(j,_e,et,tt,rt,nt,it))}const extractPublicKey=async(_,a)=>{if(a==null||_==null){const j=new Error("one or more of the provided parameters are not defined");throw log$1E.error(j),errCode(j,ERR_UNDEFINED_PARAMETER)}let $;if(a.pubKey!=null){try{$=unmarshalPublicKey(a.pubKey)}catch(_e){throw log$1E.error(_e),_e}if(!(await peerIdFromKeys(a.pubKey)).equals(_))throw errCode(new Error("Embedded public key did not match PeerID"),ERR_INVALID_EMBEDDED_KEY)}else _.publicKey!=null&&($=unmarshalPublicKey(_.publicKey));if($!=null)return $;throw errCode(new Error("no public key is available"),ERR_UNDEFINED_PARAMETER)},ipnsEntryDataForV1Sig=(_,a,$)=>{const j=fromString$5(a);return concat$1([_,$,j])},ipnsEntryDataForV2Sig=_=>{const a=fromString$5("ipns-signature:");return concat$1([a,_])},marshal=_=>IpnsEntry.encode(_),unmarshal=_=>{const a=IpnsEntry.decode(_);return a.sequence!=null&&(a.sequence=BigInt(a.sequence)),a.ttl!=null&&(a.ttl=BigInt(a.ttl)),{value:a.value??new Uint8Array(0),signature:a.signature??new Uint8Array(0),validityType:a.validityType??IpnsEntry.ValidityType.EOL,validity:a.validity??new Uint8Array(0),sequence:a.sequence??0n,pubKey:a.pubKey,ttl:a.ttl??void 0,signatureV2:a.signatureV2,data:a.data}},peerIdToRoutingKey=_=>concat$1([IPNS_PREFIX$1,_.toBytes()]),peerIdFromRoutingKey=_=>peerIdFromBytes(_.slice(IPNS_PREFIX$1.length)),createCborData=(_,a,$,j,_e)=>{let et;if($===IpnsEntry.ValidityType.EOL)et=0;else throw errCode(new Error("Unknown validity type"),ERR_UNRECOGNIZED_VALIDITY);return encode$r({Value:_,Validity:a,ValidityType:et,Sequence:j,TTL:_e})},parseCborData=_=>{const a=decode$l(_);if(a.ValidityType===0)a.ValidityType=IpnsEntry.ValidityType.EOL;else throw errCode(new Error("Unknown validity type"),ERR_UNRECOGNIZED_VALIDITY);return Number.isInteger(a.Sequence)&&(a.Sequence=BigInt(a.Sequence)),Number.isInteger(a.TTL)&&(a.TTL=BigInt(a.TTL)),a},log$1D=logger$1("ipns"),ID_MULTIHASH_CODE=identity$8.code,namespace$1="/ipns/",namespaceLength=namespace$1.length,create$8=async(_,a,$,j)=>{const _e=new NanoDate(Date.now()+Number(j)),et=IpnsEntry.ValidityType.EOL,[tt,rt]=j.toString().split("."),nt=BigInt(tt)*BigInt(1e5)+BigInt(rt??"0");return await _create(_,a,$,et,_e,nt)},_create=async(_,a,$,j,_e,et)=>{$=BigInt($);const tt=fromString$5(_e.toString());if(_.privateKey==null)throw errCode(new Error("Missing private key"),ERR_MISSING_PRIVATE_KEY);const rt=await unmarshalPrivateKey(_.privateKey),nt=await signLegacyV1(rt,a,j,tt),it=createCborData(a,tt,j,$,et),st=ipnsEntryDataForV2Sig(it),ot=await rt.sign(st),at={value:a,signature:nt,validityType:j,validity:tt,sequence:$,ttl:et,signatureV2:ot,data:it};if(_.publicKey!=null){const lt=decode$n(_.toBytes());(lt.code!==ID_MULTIHASH_CODE||!equals$1(_.publicKey,lt.digest))&&(at.pubKey=_.publicKey)}return log$1D("ipns entry for %b created",a),at},rawStdEncoding=_=>base32upper$2.encode(_).slice(1),getLocalKey=_=>new Key(`/ipns/${rawStdEncoding(_)}`),signLegacyV1=async(_,a,$,j)=>{try{const _e=ipnsEntryDataForV1Sig(a,$,j);return await _.sign(_e)}catch(_e){throw log$1D.error("record signature creation failed",_e),errCode(new Error("record signature creation failed"),ERR_SIGNATURE_CREATION)}},log$1C=logger$1("ipfs:ipns:publisher"),ERR_NOT_FOUND$3=notFoundError$1().code,defaultRecordLifetime$1=60*60*1e3;class IpnsPublisher{constructor(a,$){this._routing=a,this._datastore=$}async publishWithEOL(a,$,j,_e){const et=await this._updateOrCreateRecord(a,$,j,_e);return this._putRecordToRouting(et,a,_e)}publish(a,$,j){return this.publishWithEOL(a,$,defaultRecordLifetime$1,j)}async _putRecordToRouting(a,$,j){if(!isPeerId($)){const et="peerId received is not valid";throw log$1C.error(et),errCode(new Error(et),"ERR_INVALID_PEER_ID")}if($.publicKey==null)throw errCode(new Error("Public key was missing"),"ERR_MISSING_PUBLIC_KEY");const _e=peerIdToRoutingKey($);return await this._publishEntry(_e,a,j),a}async _publishEntry(a,$,j){try{const _e=await this._routing.put(a,$,j);return log$1C(`ipns record for ${toString$6(a,"base32")} was stored in the routing`),_e}catch(_e){const et=`ipns record for ${toString$6(a,"base32")} could not be stored in the routing - ${_e.stack}`;throw log$1C.error(et),log$1C.error(_e),errCode(new Error(et),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(a,$={}){if(!isPeerId(a)){const _e="peerId received is not valid";throw log$1C.error(_e),errCode(new Error(_e),"ERR_INVALID_PEER_ID")}const j=$.checkRouting!==!1;try{const _e=await this._datastore.get(getLocalKey(a.toBytes()));return this._unmarshalData(_e)}catch(_e){if(_e.code!==ERR_NOT_FOUND$3){const et=`unexpected error getting the ipns record ${a.toString()} from datastore`;throw log$1C.error(et),errCode(new Error(et),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!j)throw errCode(_e,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{const et=peerIdToRoutingKey(a),tt=await this._routing.get(et);return this._unmarshalData(tt)}catch(et){throw log$1C.error(et),et}}}_unmarshalData(a){try{return unmarshal(a)}catch($){throw errCode($,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(a,$,j,_e){if(!isPeerId(a)){const it="peerId received is not valid";throw log$1C.error(it),errCode(new Error(it),"ERR_INVALID_PEER_ID")}const et={checkRouting:!0};let tt;try{tt=await this._getPublished(a,et)}catch(it){if(it.code!==ERR_NOT_FOUND$3){const st=`unexpected error when determining the last published IPNS record for ${a.toString()} ${it.stack}`;throw log$1C.error(st),errCode(new Error(st),"ERR_DETERMINING_PUBLISHED_RECORD")}}let rt=0n;tt&&tt.sequence!==void 0&&(rt=equals$1(tt.value,$)?tt.sequence:tt.sequence+BigInt(1));let nt;try{nt=await create$8(a,$,rt,j)}catch(it){const st=`ipns record for ${$} could not be created`;throw log$1C.error(it),errCode(new Error(st),"ERR_CREATING_IPNS_RECORD")}try{const it=marshal(nt);return await this._datastore.put(getLocalKey(a.toBytes()),it,_e),log$1C(`ipns record for ${toString$6($,"base32")} was stored in the datastore`),it}catch{const st=`ipns record for ${$} could not be stored in the datastore`;throw log$1C.error(st),errCode(new Error(st),"ERR_STORING_IN_DATASTORE")}}}IpnsPublisher.defaultRecordLifetime=defaultRecordLifetime$1;const log$1B=logger$1("ipfs:ipns:republisher"),minute$3=60*1e3,hour$1=60*minute$3,defaultBroadcastInterval=4*hour$1,defaultRecordLifetime=24*hour$1;class IpnsRepublisher{constructor(a,$,j,_e,et={pass:""}){this._publisher=a,this._datastore=$,this._peerId=j,this._keychain=_e,this._options=et,this._republishHandle=null}async start(){if(this._republishHandle)throw errCode(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");const a={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:_e=>{a._timeoutId=setTimeout(async()=>{a._timeoutId=null;try{a._inflightTask=a._task(),await a._inflightTask,a._task&&a.runPeriodically(_e)}catch(et){log$1B.error(et)}},_e())},cancel:async()=>{a._timeoutId!=null&&clearTimeout(a._timeoutId),a._task=null,await a._inflightTask}},{pass:$}=this._options;let j=!0;a._task=async()=>{const _e=new timeoutAbortController.TimeoutController(3e4);try{await this._republishEntries(this._peerId,$,{signal:_e.signal})}finally{_e.clear()}},a.runPeriodically(()=>j?(j=!1,this._options.initialBroadcastInterval||minute$3):this._options.broadcastInterval||defaultBroadcastInterval),this._republishHandle=a}async stop(){const a=this._republishHandle;if(!a)throw errCode(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await a.cancel()}async _republishEntries(a,$,j){try{await this._republishEntry(a,j)}catch{const et="cannot republish entry for the node's private key";log$1B.error(et);return}if($)try{const _e=await this._keychain.listKeys();for(const et of _e){if(et.name==="self")continue;const tt=await this._keychain.exportKey(et.name,$),rt=await importKey(tt,$),nt=await peerIdFromKeys(rt.public.bytes,rt.bytes);await this._republishEntry(nt,j)}}catch(_e){log$1B.error(_e)}}async _republishEntry(a,$){try{const j=await this._getPreviousValue(a);await this._publisher.publishWithEOL(a,j,defaultRecordLifetime,$)}catch(j){if(j.code==="ERR_NO_ENTRY_FOUND")return;throw j}}async _getPreviousValue(a){if(!isPeerId(a))throw errCode(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{const $=await this._datastore.get(getLocalKey(a.toBytes()));if(!($ instanceof Uint8Array))throw errCode(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return unmarshal($).value}catch(j){throw log$1B.error(j),errCode(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch($){throw $&&$.notFound?errCode(new Error(`no previous entry for record with id: ${a.toString()}`),"ERR_NO_ENTRY_FOUND"):$}}}const log$1A=logger$1("ipns:validator"),validate=async(_,a)=>{const{value:$,validityType:j,validity:_e}=a;let et,tt;if(a.signatureV2!=null&&a.data!=null)tt=a.signatureV2,et=ipnsEntryDataForV2Sig(a.data),validateCborDataMatchesPbData(a);else throw errCode(new Error("missing data or signatureV2"),ERR_SIGNATURE_VERIFICATION);let rt;try{rt=await _.verify(et,tt)}catch{rt=!1}if(!rt)throw log$1A.error("record signature verification failed"),errCode(new Error("record signature verification failed"),ERR_SIGNATURE_VERIFICATION);if(_e!=null&&j===IpnsEntry.ValidityType.EOL){let nt;try{nt=parseRFC3339$1(toString$6(_e))}catch{throw log$1A.error("unrecognized validity format (not an rfc3339 format)"),errCode(new Error("unrecognized validity format (not an rfc3339 format)"),ERR_UNRECOGNIZED_FORMAT)}if(nt.getTime()<Date.now())throw log$1A.error("record has expired"),errCode(new Error("record has expired"),ERR_IPNS_EXPIRED_RECORD)}else if(j!=null)throw log$1A.error("unrecognized validity type"),errCode(new Error("unrecognized validity type"),ERR_UNRECOGNIZED_VALIDITY);log$1A("ipns entry for %b is valid",$)},validateCborDataMatchesPbData=_=>{if(_.data==null)throw errCode(new Error("Record data is missing"),ERR_INVALID_RECORD_DATA);const a=parseCborData(_.data);if(!equals$1(a.Value,_.value))throw errCode(new Error('Field "value" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION);if(!equals$1(a.Validity,_.validity))throw errCode(new Error('Field "validity" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION);if(a.ValidityType!==_.validityType)throw errCode(new Error('Field "validityType" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION);if(a.Sequence!==_.sequence)throw errCode(new Error('Field "sequence" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION);if(a.TTL!==_.ttl)throw errCode(new Error('Field "ttl" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION)},ipnsValidator=async(_,a)=>{const $=peerIdFromRoutingKey(_),j=unmarshal(a),_e=await extractPublicKey($,j);await validate(_e,j)},log$1z=logger$1("ipfs:ipns:resolver"),ERR_NOT_FOUND$2=notFoundError$1().code,defaultMaximumRecursiveDepth=32;class IpnsResolver{constructor(a){this._routing=a}async resolve(a,$={}){if(typeof a!="string")throw errCode(new Error("invalid name"),"ERR_INVALID_NAME");const j=$.recursive&&$.recursive.toString()==="true",_e=a.split("/");if(_e.length!==3||_e[0]!=="")throw errCode(new Error("invalid name"),"ERR_INVALID_NAME");const et=_e[2];let tt=1/0;j&&(tt=defaultMaximumRecursiveDepth);const rt=await this.resolver(et,tt,$);return log$1z(`${a} was locally resolved correctly`),rt}async resolver(a,$,j){if($===0){const tt=`could not resolve name (recursion limit of ${defaultMaximumRecursiveDepth} exceeded)`;throw log$1z.error(tt),errCode(new Error(tt),"ERR_RESOLVE_RECURSION_LIMIT")}const _e=await this._resolveName(a,j),et=_e.split("/");return et[1]==="ipfs"||!$?_e:this.resolver(et[2],$-1,j)}async _resolveName(a,$){const j=peerIdFromString(a),_e=peerIdToRoutingKey(j);let et;try{et=await this._routing.get(_e,$)}catch(tt){throw log$1z.error("could not get record from routing",tt),tt.code===ERR_NOT_FOUND$2?errCode(new Error(`record requested for ${a} was not found in the network`),"ERR_NO_RECORD_FOUND"):errCode(new Error(`unexpected error getting the ipns record ${j.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}return this._validateRecord(j,et)}async _validateRecord(a,$){await ipnsValidator(concat$1([fromString$5("/ipns/"),a.toBytes()]),$);const j=unmarshal($);return toString$6(j.value)}}class TLRU{constructor(a){this.lru=hashlru(a)}get(a){const $=this.lru.get(a);if($){if($.expire&&$.expire<Date.now()){this.lru.remove(a);return}return $.value}}set(a,$,j){this.lru.set(a,{value:$,expire:Date.now()+j})}has(a){return!!this.get(a)}remove(a){this.lru.remove(a)}clear(){this.lru.clear()}}const log$1y=logger$1("ipfs:ipns"),defaultRecordTtl=60*1e3;class IPNS{constructor(a,$,j,_e,et){this.publisher=new IpnsPublisher(a,$),this.republisher=new IpnsRepublisher(this.publisher,$,j,_e,et),this.resolver=new IpnsResolver(a),this.cache=new TLRU(1e3),this.routing=a}async publish(a,$,j=IpnsPublisher.defaultRecordLifetime,_e){try{await this.publisher.publishWithEOL(a,$,j,_e),log$1y(`IPNS value ${toString$6($,"base32")} was published correctly`);const et=a.toString(),tt=parseFloat(j),rt=tt<defaultRecordTtl?tt:defaultRecordTtl;return this.cache.set(et,$,rt),log$1y(`IPNS value ${toString$6($,"base32")} was cached correctly`),{name:et,value:$}}catch(et){throw log$1y.error(et),et}}async resolve(a,$={}){if(typeof a!="string")throw errCode(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!$.nocache&&!$.recursive){const j=a.split("/")[2],_e=this.cache.get(j);if(_e)return _e}try{const j=await this.resolver.resolve(a,$);return log$1y(`IPNS record from ${a} was resolved correctly`),j}catch(j){throw log$1y.error(j),j}}async initializeKeyspace(a,$,j){return this.publish(a,$,IpnsPublisher.defaultRecordLifetime,j)}}const all$6=async _=>{const a=[];for await(const $ of _)a.push($);return a};var itAll$3=all$6;const sortAll$1=(_,a)=>async function*(){yield*(await itAll$3(_)).sort(a)}(),drain$4=async _=>{for await(const a of _);};var itDrain$3=drain$4;const filter$4=async function*(_,a){for await(const $ of _)await a($)&&(yield $)};var itFilter=filter$4;const take=async function*(_,a){let $=0;if(!(a<1)){for await(const j of _)if(yield j,$++,$===a)return}};var itTake=take;class BaseDatastore{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(a,$,j){return Promise.reject(new Error(".put is not implemented"))}get(a,$){return Promise.reject(new Error(".get is not implemented"))}has(a,$){return Promise.reject(new Error(".has is not implemented"))}delete(a,$){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(a,$={}){for await(const{key:j,value:_e}of a)await this.put(j,_e,$),yield{key:j,value:_e}}async*getMany(a,$={}){for await(const j of a)yield this.get(j,$)}async*deleteMany(a,$={}){for await(const j of a)await this.delete(j,$),yield j}batch(){let a=[],$=[];return{put(j,_e){a.push({key:j,value:_e})},delete(j){$.push(j)},commit:async j=>{await itDrain$3(this.putMany(a,j)),a=[],await itDrain$3(this.deleteMany($,j)),$=[]}}}async*_all(a,$){throw new Error("._all is not implemented")}async*_allKeys(a,$){throw new Error("._allKeys is not implemented")}query(a,$){let j=this._all(a,$);if(a.prefix!=null&&(j=itFilter(j,_e=>_e.key.toString().startsWith(a.prefix))),Array.isArray(a.filters)&&(j=a.filters.reduce((_e,et)=>itFilter(_e,et),j)),Array.isArray(a.orders)&&(j=a.orders.reduce((_e,et)=>sortAll$1(_e,et),j)),a.offset!=null){let _e=0;j=itFilter(j,()=>_e++>=a.offset)}return a.limit!=null&&(j=itTake(j,a.limit)),j}queryKeys(a,$){let j=this._allKeys(a,$);if(a.prefix!=null&&(j=itFilter(j,_e=>_e.toString().startsWith(a.prefix))),Array.isArray(a.filters)&&(j=a.filters.reduce((_e,et)=>itFilter(_e,et),j)),Array.isArray(a.orders)&&(j=a.orders.reduce((_e,et)=>sortAll$1(_e,et),j)),a.offset!=null){let _e=0;j=itFilter(j,()=>_e++>=a.offset)}return a.limit!=null&&(j=itTake(j,a.limit)),j}}class FixedFIFO$1{constructor(a){if(!(a>0)||(a-1&a)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(a),this.mask=a-1,this.top=0,this.btm=0,this.next=null}push(a){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=a,this.top=this.top+1&this.mask,!0)}shift(){const a=this.buffer[this.btm];if(a!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,a}isEmpty(){return this.buffer[this.btm]===void 0}}class FIFO$2{constructor(a={}){this.hwm=a.splitLimit??16,this.head=new FixedFIFO$1(this.hwm),this.tail=this.head,this.size=0}calculateSize(a){return a?.byteLength!=null?a.byteLength:1}push(a){if(a?.value!=null&&(this.size+=this.calculateSize(a.value)),!this.head.push(a)){const $=this.head;this.head=$.next=new FixedFIFO$1(2*this.head.buffer.length),this.head.push(a)}}shift(){let a=this.tail.shift();if(a===void 0&&this.tail.next!=null){const $=this.tail.next;this.tail.next=null,this.tail=$,a=this.tail.shift()}return a?.value!=null&&(this.size-=this.calculateSize(a.value)),a}isEmpty(){return this.head.isEmpty()}}function pushable$2(_={}){return _pushable($=>{const j=$.shift();if(j==null)return{done:!0};if(j.error!=null)throw j.error;return{done:j.done===!0,value:j.value}},_)}function pushableV(_={}){return _pushable($=>{let j;const _e=[];for(;!$.isEmpty()&&(j=$.shift(),j!=null);){if(j.error!=null)throw j.error;j.done===!1&&_e.push(j.value)}return j==null?{done:!0}:{done:j.done===!0,value:_e}},_)}function _pushable(_,a){a=a??{};let $=a.onEnd,j=new FIFO$2,_e,et,tt;const rt=async()=>j.isEmpty()?tt?{done:!0}:await new Promise((ut,dt)=>{et=ft=>{et=null,j.push(ft);try{ut(_(j))}catch(pt){dt(pt)}return _e}}):_(j),nt=ut=>et!=null?et(ut):(j.push(ut),_e),it=ut=>(j=new FIFO$2,et!=null?et({error:ut}):(j.push({error:ut}),_e)),st=ut=>{if(tt)return _e;if(a?.objectMode!==!0&&ut?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return nt({done:!1,value:ut})},ot=ut=>tt?_e:(tt=!0,ut!=null?it(ut):nt({done:!0})),at=()=>(j=new FIFO$2,ot(),{done:!0}),lt=ut=>(ot(ut),{done:!0});if(_e={[Symbol.asyncIterator](){return this},next:rt,return:at,throw:lt,push:st,end:ot,get readableLength(){return j.size}},$==null)return _e;const ct=_e;return _e={[Symbol.asyncIterator](){return this},next(){return ct.next()},throw(ut){return ct.throw(ut),$!=null&&($(ut),$=void 0),{done:!0}},return(){return ct.return(),$!=null&&($(),$=void 0),{done:!0}},push:st,end(ut){return ct.end(ut),$!=null&&($(ut),$=void 0),_e},get readableLength(){return ct.readableLength}},_e}const log$1x=logger$1("datastore:core:tiered");class TieredDatastore extends BaseDatastore{constructor(a){super(),this.stores=a.slice()}async open(){try{await Promise.all(this.stores.map(a=>a.open()))}catch{throw dbOpenFailedError()}}async put(a,$,j){try{await Promise.all(this.stores.map(_e=>_e.put(a,$,j)))}catch{throw dbWriteFailedError()}}async get(a,$){for(const j of this.stores)try{const _e=await j.get(a,$);if(_e)return _e}catch(_e){log$1x.error(_e)}throw notFoundError$1()}async has(a,$){for(const j of this.stores)if(await j.has(a,$))return!0;return!1}async delete(a,$){try{await Promise.all(this.stores.map(j=>j.delete(a,$)))}catch{throw dbDeleteFailedError()}}async*putMany(a,$={}){let j;const _e=this.stores.map(et=>{const tt=pushable$2({objectMode:!0});return itDrain$3(et.putMany(tt,$)).catch(rt=>{j=rt}),tt});try{for await(const et of a){if(j)throw j;_e.forEach(tt=>tt.push(et)),yield et}}finally{_e.forEach(et=>et.end())}}async*deleteMany(a,$={}){let j;const _e=this.stores.map(et=>{const tt=pushable$2({objectMode:!0});return itDrain$3(et.deleteMany(tt,$)).catch(rt=>{j=rt}),tt});try{for await(const et of a){if(j)throw j;_e.forEach(tt=>tt.push(et)),yield et}}finally{_e.forEach(et=>et.end())}}async close(){await Promise.all(this.stores.map(a=>a.close()))}batch(){const a=this.stores.map($=>$.batch());return{put:($,j)=>{a.forEach(_e=>_e.put($,j))},delete:$=>{a.forEach(j=>j.delete($))},commit:async $=>{for(const j of a)await j.commit($)}}}query(a,$){return this.stores[this.stores.length-1].query(a,$)}queryKeys(a,$){return this.stores[this.stores.length-1].queryKeys(a,$)}}function get$2(_,a,$,j,_e){for(a=a.split?a.split("."):a,j=0;j<a.length;j++)_=_?_[a[j]]:_e;return _===_e?$:_}const ipnsSelector=(_,a)=>{const $=a.map((j,_e)=>({entry:IpnsEntry.decode(j),index:_e}));return $.sort((j,_e)=>{if(j.entry.signatureV2!=null&&_e.entry.signatureV2==null)return-1;if(j.entry.signatureV2==null&&_e.entry.signatureV2!=null)return 1;const et=j.entry.sequence??0n,tt=_e.entry.sequence??0n;if(et>tt)return-1;if(et<tt)return 1;const rt=j.entry.validity??new Uint8Array(0),nt=_e.entry.validity??new Uint8Array(0),it=parseRFC3339$1(toString$6(rt)),st=parseRFC3339$1(toString$6(nt));return it.getTime()>st.getTime()?-1:it.getTime()<st.getTime()?1:0}),$[0].index},SHARDING_FN="SHARDING",README_FN="_README";class MemoryDatastore extends BaseDatastore{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(a,$){this.data[a.toString()]=$}async get(a){if(!await this.has(a))throw notFoundError$1();return this.data[a.toString()]}async has(a){return this.data[a.toString()]!==void 0}async delete(a){delete this.data[a.toString()]}async*_all(){yield*Object.entries(this.data).map(([a,$])=>({key:new Key(a),value:$}))}async*_allKeys(){yield*Object.entries(this.data).map(([a])=>new Key(a))}}var fixedSize=class{constructor(a){if(!(a>0)||(a-1&a)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(a),this.mask=a-1,this.top=0,this.btm=0,this.next=null}push(a){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=a,this.top=this.top+1&this.mask,!0)}shift(){const a=this.buffer[this.btm];if(a!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,a}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}};const FixedFIFO=fixedSize;var fastFifo=class{constructor(a){this.hwm=a||16,this.head=new FixedFIFO(this.hwm),this.tail=this.head}push(a){if(!this.head.push(a)){const $=this.head;this.head=$.next=new FixedFIFO(2*this.head.buffer.length),this.head.push(a)}}shift(){const a=this.tail.shift();if(a===void 0&&this.tail.next){const $=this.tail.next;return this.tail.next=null,this.tail=$,this.tail.shift()}return a}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}};const FIFO$1=fastFifo;var itPushable$1=_=>{_=_||{};let a;typeof _=="function"?(a=_,_={}):a=_.onEnd;let $=new FIFO$1,j,_e,et;const tt=()=>{if(!$.isEmpty()){if(_.writev){let ut;const dt=[];for(;!$.isEmpty();){if(ut=$.shift(),ut.error)throw ut.error;dt.push(ut.value)}return{done:ut.done,value:dt}}const ct=$.shift();if(ct.error)throw ct.error;return ct}return et?{done:!0}:new Promise((ct,ut)=>{_e=dt=>(_e=null,dt.error?ut(dt.error):_.writev&&!dt.done?ct({done:dt.done,value:[dt.value]}):ct(dt),j)})},rt=ct=>_e?_e(ct):($.push(ct),j),nt=ct=>($=new FIFO$1,_e?_e({error:ct}):($.push({error:ct}),j)),it=ct=>et?j:rt({done:!1,value:ct}),st=ct=>et?j:(et=!0,ct?nt(ct):rt({done:!0})),ot=()=>($=new FIFO$1,st(),{done:!0}),at=ct=>(st(ct),{done:!0});if(j={[Symbol.asyncIterator](){return this},next:tt,return:ot,throw:at,push:it,end:st},!a)return j;const lt=j;return j={[Symbol.asyncIterator](){return this},next(){return lt.next()},throw(ct){return lt.throw(ct),a&&(a(ct),a=null),{done:!0}},return(){return lt.return(),a&&(a(),a=null),{done:!0}},push:it,end(ct){return lt.end(ct),a&&(a(ct),a=null),j}},j};const pushable$1=itPushable$1,merge$3=async function*(..._){const a=pushable$1();setTimeout(async()=>{try{await Promise.all(_.map(async $=>{for await(const j of $)a.push(j)})),a.end()}catch($){a.end($)}},0),yield*a};var itMerge$1=merge$3;const rawPipe=(..._)=>{let a;for(;_.length>0;)a=_.shift()(a);return a},isIterable$1=_=>_!=null&&(typeof _[Symbol.asyncIterator]=="function"||typeof _[Symbol.iterator]=="function"||typeof _.next=="function"),isDuplex=_=>_!=null&&typeof _.sink=="function"&&isIterable$1(_.source),duplexPipelineFn=_=>a=>{const $=_.sink(a);if($.then!=null){const j=pushable$2({objectMode:!0});return $.then(()=>{j.end()},et=>{j.end(et)}),itMerge$1(j,async function*(){yield*_.source,j.end()}())}return _.source};function pipe(_,...a){if(isDuplex(_)){const j=_;_=()=>j.source}else if(isIterable$1(_)){const j=_;_=()=>j}const $=[_,...a];if($.length>1&&isDuplex($[$.length-1])&&($[$.length-1]=$[$.length-1].sink),$.length>2)for(let j=1;j<$.length-1;j++)isDuplex($[j])&&($[j]=duplexPipelineFn($[j]));return rawPipe(...$)}new Key(SHARDING_FN);new Key(README_FN);const namespace="/record/";function encodeBase32(_){return toString$6(_,"base32")}function keyToTopic(_){(typeof _=="string"||_ instanceof String)&&(_=fromString$5(_.toString()));const a=toString$6(_,"base64url");return`${namespace}${a}`}function topicToKey(_){if(_.substring(0,namespace.length)!==namespace)throw errCode(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");const a=_.substring(namespace.length);return fromString$5(a,"base64url")}const log$1w=logger$1("datastore-pubsub:publisher");class PubSubDatastore extends BaseDatastore{constructor(a,$,j,_e,et,tt){if(super(),!_e)throw errCode(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if(typeof _e!="function")throw errCode(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if(typeof et!="function")throw errCode(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(tt&&typeof tt!="function")throw errCode(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=a,this._datastore=$,this._peerId=j,this._validator=_e,this._selector=et,this._handleSubscriptionKeyFn=tt,this._onMessage=this._onMessage.bind(this),this._pubsub.addEventListener("message",this._onMessage)}async put(a,$,j){if(!(a instanceof Uint8Array)){const et="datastore key does not have a valid format";throw log$1w.error(et),errCode(new Error(et),"ERR_INVALID_DATASTORE_KEY")}if(!($ instanceof Uint8Array)){const et="received value is not a Uint8Array";throw log$1w.error(et),errCode(new Error(et),"ERR_INVALID_VALUE_RECEIVED")}const _e=keyToTopic(a);log$1w(`publish value for topic ${_e}`),await this._pubsub.publish(_e,$)}async get(a,$){if(!(a instanceof Uint8Array)){const et="datastore key does not have a valid format";throw log$1w.error(et),errCode(new Error(et),"ERR_INVALID_DATASTORE_KEY")}const j=keyToTopic(a),_e=await this._pubsub.getTopics();if(_e&&Array.isArray(_e)&&_e.indexOf(j)>-1)return this._getLocal(a,$);try{await this._pubsub.subscribe(j)}catch{const tt=`cannot subscribe topic ${j}`;throw log$1w.error(tt),errCode(new Error(tt),"ERR_SUBSCRIBING_TOPIC")}return log$1w(`subscribed values for key ${j}`),this._getLocal(a)}unsubscribe(a){const $=keyToTopic(a);return this._pubsub.unsubscribe($)}async _getLocal(a,$){const j=new Key("/"+encodeBase32(a),!1);let _e;try{_e=await this._datastore.get(j,$)}catch(et){if(et.code!=="ERR_NOT_FOUND"){const rt=`unexpected error getting the ipns record for ${j.toString()}`;throw log$1w.error(rt),errCode(new Error(rt),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}const tt=`local record requested was not found for ${j.toString()}`;throw log$1w.error(tt),errCode(new Error(tt),"ERR_NOT_FOUND")}if(!(_e instanceof Uint8Array)){const et="found record that we couldn't convert to a value";throw log$1w.error(et),errCode(new Error(et),"ERR_INVALID_RECORD_RECEIVED")}return _e}async _onMessage(a){const $=a.detail;if($.type!=="signed"){log$1w.error("unsigned message received, this module can only work with signed messages");return}const{data:j,from:_e,topic:et}=$;let tt;try{tt=topicToKey(et)}catch(rt){log$1w.error(rt);return}if(log$1w(`message received for topic ${et}`),this._peerId.equals(_e)){log$1w("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let rt;try{rt=await this._handleSubscriptionKeyFn(tt)}catch{log$1w.error("message discarded by the subscriptionKeyFn");return}tt=rt}try{await this._storeIfSubscriptionIsBetter(tt,j)}catch(rt){log$1w.error(rt)}}async _storeIfSubscriptionIsBetter(a,$,j){let _e=!1;try{_e=await this._isBetter(a,$)}catch(et){if(et.code!=="ERR_NOT_VALID_RECORD")throw et}_e&&await this._storeRecord(a,$,j)}async _validateRecord(a,$){return this._validator(a,$)}async _selectRecord(a,$){return await this._selector(a,$)===0}async _isBetter(a,$){try{await this._validateRecord(a,$)}catch{const tt="record received through pubsub is not valid";throw log$1w.error(tt),errCode(new Error(tt),"ERR_NOT_VALID_RECORD")}const j=new Key(a);let _e;try{_e=await this._getLocal(j.uint8Array())}catch{return!0}return equals$1(_e,$)?!1:this._selectRecord(a,[_e,$])}async _storeRecord(a,$,j){const _e=new Key("/"+encodeBase32(a),!1);await this._datastore.put(_e,$,j),log$1w(`record for ${keyToTopic(a)} was stored in the datastore`)}}const log$1v=logger$1("ipfs:ipns:pubsub");class IpnsPubsubDatastore{constructor(a,$,j){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new PubSubDatastore(a,$,j,ipnsValidator,ipnsSelector,this._handleSubscriptionKey)}async put(a,$,j){try{await this._pubsubDs.put(a,$,j)}catch(_e){throw log$1v.error(_e),_e}}async get(a,$){let j,_e;try{j=await this._pubsubDs.get(a,$)}catch(tt){_e=tt}const et=a.slice(0,namespaceLength);if(toString$6(et)===namespace$1){const tt=base58btc$2.encode(a).substring(1),rt=base58btc$2.encode(a.slice(namespaceLength)).substring(1);this._subscriptions[tt]=rt,log$1v(`subscribed to pubsub topic ${tt}, id ${rt}`)}if(_e)throw _e;return j}_handleSubscriptionKey(a){a instanceof Uint8Array&&(a=toString$6(a,"base58btc"));const $=this._subscriptions[a];if(!$)throw errCode(new Error(`key ${a} does not correspond to a subscription`),"ERR_INVALID_KEY");try{return peerIdToRoutingKey(peerIdFromString($))}catch(j){throw log$1v.error(j),j}}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map($=>`${namespace$1}${$}`)}async cancel(a){if(typeof a!="string")throw errCode(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");a.startsWith(namespace$1)&&(a=a.substring(namespaceLength));const $=Object.keys(this._subscriptions).find(_e=>this._subscriptions[_e]===a);if(!$)return{canceled:!1};const j=fromString$5($);return this._pubsubDs.unsubscribe(j),delete this._subscriptions[$],log$1v(`unsubscribed pubsub ${$}: ${a}`),{canceled:!0}}}var Record$2;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{_e.lengthDelimited!==!1&&j.fork(),(_e.writeDefaults===!0||$.key!=null&&$.key.byteLength>0)&&(j.uint32(10),j.bytes($.key)),(_e.writeDefaults===!0||$.value!=null&&$.value.byteLength>0)&&(j.uint32(18),j.bytes($.value)),(_e.writeDefaults===!0||$.timeReceived!=="")&&(j.uint32(42),j.string($.timeReceived)),_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={key:new Uint8Array(0),value:new Uint8Array(0),timeReceived:""},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.key=$.bytes();break;case 2:_e.value=$.bytes();break;case 5:_e.timeReceived=$.string();break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(Record$2||(Record$2={}));function toRFC3339(_){const a=_.getUTCFullYear(),$=String(_.getUTCMonth()+1).padStart(2,"0"),j=String(_.getUTCDate()).padStart(2,"0"),_e=String(_.getUTCHours()).padStart(2,"0"),et=String(_.getUTCMinutes()).padStart(2,"0"),tt=String(_.getUTCSeconds()).padStart(2,"0"),rt=_.getUTCMilliseconds(),nt=String(rt*1e3*1e3).padStart(9,"0");return`${a}-${$}-${j}T${_e}:${et}:${tt}.${nt}Z`}function parseRFC3339(_){const a=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),$=String(_).trim().match(a);if($==null)throw new Error("Invalid format");const j=parseInt($[1],10),_e=parseInt($[2],10)-1,et=parseInt($[3],10),tt=parseInt($[4],10),rt=parseInt($[5],10),nt=parseInt($[6],10),it=parseInt($[7].slice(0,-6),10);return new Date(Date.UTC(j,_e,et,tt,rt,nt,it))}class Libp2pRecord{constructor(a,$,j){if(!(a instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!($ instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=a,this.value=$,this.timeReceived=j}serialize(){return Record$2.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:toRFC3339(this.timeReceived)}}static deserialize(a){const $=Record$2.decode(a);return new Libp2pRecord($.key,$.value,new Date($.timeReceived))}static fromDeserialized(a){const $=parseRFC3339(a.timeReceived);if(a.key==null)throw new Error("key missing from deserialized object");if(a.value==null)throw new Error("value missing from deserialized object");return new Libp2pRecord(a.key,a.value,$)}}const log$1u=logger$1("ipfs:ipns:offline-datastore");class OfflineDatastore{constructor(a){this._datastore=a,this.stores=[]}async put(a,$,j){if(!(a instanceof Uint8Array))throw errCode(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!($ instanceof Uint8Array))throw errCode(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let _e;try{_e=this._routingKey(a)}catch(tt){throw log$1u.error(tt),errCode(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const et=new Libp2pRecord(a,$,new Date);await this._datastore.put(_e,et.serialize(),j)}async get(a,$){if(!(a instanceof Uint8Array))throw errCode(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let j;try{j=this._routingKey(a)}catch(tt){throw log$1u.error(tt),errCode(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const _e=await this._datastore.get(j,$);let et;try{et=Libp2pRecord.deserialize(_e)}catch(tt){throw log$1u.error(tt),tt}return et.value}_routingKey(a){return new Key("/dht/record/"+toString$6(a,"base32"),!1)}}async function drain$3(_){for await(const a of _);}const log$1t=logger$1("ipfs:ipns:dht-datastore");class DHTDatastore{constructor(a){this._dht=a}async put(a,$,j){try{await drain$3(this._dht.put(a,$,j))}catch(_e){throw log$1t.error(_e),_e}}async get(a,$){for await(const j of this._dht.get(a,$))if(j.name==="VALUE")return j.value;throw notFoundError$1()}}function createRouting({libp2p:_,repo:a,peerId:$,options:j}){const _e=[];let et;if(get$2(j,"EXPERIMENTAL.ipnsPubsub",!1)&&(et=new IpnsPubsubDatastore(_.pubsub,a.datastore,$),_e.push(et)),get$2(j,"offline",!1)!==!0&&["dht","dhtclient","dhtserver"].includes(get$2(j,"config.Routing.Type","none"))&&_e.push(new DHTDatastore(_.dht)),get$2(j,"offline",!1)||_e.length===0){const tt=new OfflineDatastore(a.datastore);_e.push(tt)}return new TieredDatastore(_e)}const log$1s=logger$1("ipfs:components:ipns");class IPNSAPI{constructor(a={pass:""}){this.options=a,this.offline=null,this.online=null}getIPNS(){const a=this.online||this.offline;if(a)return a;throw new NotInitializedError}get routing(){return this.getIPNS().routing}startOffline({repo:a,peerId:$,keychain:j}){if(this.offline!=null)throw new AlreadyInitializedError;log$1s("initializing IPNS keyspace (offline)");const _e=new OfflineDatastore(a.datastore),et=new IPNS(_e,a.datastore,$,j,this.options);this.offline=et}async startOnline({libp2p:a,repo:$,peerId:j,keychain:_e}){if(this.online!=null)throw new AlreadyInitializedError;const et=createRouting({libp2p:a,repo:$,peerId:j,options:this.options}),tt=new IPNS(et,$.datastore,j,_e,this.options);await tt.republisher.start(),this.online=tt}async stop(){const a=this.online;a&&(await a.republisher.stop(),this.online=null)}publish(a,$,j,_e){return this.getIPNS().publish(a,$,j,_e)}resolve(a,$){return this.getIPNS().resolve(a,$)}initializeKeyspace(a,$,j){return this.getIPNS().initializeKeyspace(a,$,j)}}async function resolvePath({ipns:_,repo:a,codecs:$},j,_e){if(ipnsPath(j))return _.resolve(j);const{cid:et,path:tt}=toCidAndPath(j);await drain$3(resolve$5(et,tt||"",$,a,_e))}const log$1r=logger$1("ipfs:name:publish");function createPublish$2({ipns:_,repo:a,codecs:$,peerId:j,isOnline:_e,keychain:et}){const tt=async nt=>{let it;if(nt==="self"&&j.privateKey!=null)it=await unmarshalPrivateKey(j.privateKey);else try{const st=await et.exportKey(nt,"temp");it=await importKey(st,"temp")}catch(st){throw log$1r.error(st),errCode(st,"ERR_CANNOT_GET_KEY")}return peerIdFromKeys(it.public.bytes,it.bytes)};async function rt(nt,it={}){const st=it.resolve!==!1,ot=it.lifetime||"24h",at=it.key||"self";if(!_e())throw errCode(new Error(OFFLINE_ERROR),"OFFLINE_ERROR");try{nt=normalizePath(nt)}catch(ft){throw log$1r.error(ft),ft}let lt=0;try{lt=parse$3(ot)||0,lt=parseFloat(lt.toFixed(6))}catch(ft){throw log$1r.error(ft),ft}const ct=await Promise.all([tt(at),st?resolvePath({ipns:_,repo:a,codecs:$},nt):Promise.resolve()]),ut=fromString$5(nt),dt=await _.publish(ct[0],ut,lt,it);return{name:dt.name,value:toString$6(dt.value)}}return withTimeoutOption(rt)}var domainNameRegex=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i,isDomainName=function _(a,$){if($==null&&($=!1),a.length<2||a.length>255)return!1;var j=a[a.length-1];if($){if(j!==".")return!1}else if(j===".")return!1;return domainNameRegex.test(a)};const mergeOptions$e=mergeOptions$g.bind({ignoreUndefined:!0}),log$1q=logger$1("ipfs:name:resolve"),appendRemainder=(_,a)=>a.length>0?_+"/"+a.join("/"):_;function createResolve$4({dns:_,ipns:a,isOnline:$,options:{offline:j}}){async function*_e(et,tt={}){if(tt=mergeOptions$e({nocache:!1,recursive:!0},tt),j&&tt&&tt.nocache)throw errCode(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");if(!$()&&!j)throw errCode(new Error(OFFLINE_ERROR),"OFFLINE_ERROR");let rt=et.toString();rt.startsWith("/ipns/")||(rt=`/ipns/${rt}`);let[nt,it,...st]=rt.slice(1).split("/");try{if(it.substring(0,1)==="1"){const at=peerIdFromString(it),lt=decode$n(at.toBytes());it=CID.createV1(114,lt).toString(base36$4)}else{const at=CID.parse(it);at.version===1&&(it=at.toString(base36$4))}}catch(at){if(isDomainName(it)){yield appendRemainder(await _(it,tt),st);return}throw log$1q.error(at),errCode(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}const ot=await a.resolve(`/${nt}/${it}`,tt);yield appendRemainder(ot instanceof Uint8Array?toString$6(ot):ot,st)}return withTimeoutOption(_e)}function getPubsubRouting(_,a){if(!_||!(a&&a.ipnsPubsub))throw errCode(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(_.routing instanceof IpnsPubsubDatastore)return _.routing;const $=(_.routing.stores||[]).find(j=>j instanceof IpnsPubsubDatastore);if(!$)throw errCode(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return $}function createCancel$1({ipns:_,options:a}){const $=a.EXPERIMENTAL;async function j(_e,et={}){return getPubsubRouting(_,$).cancel(_e,et)}return withTimeoutOption(j)}function createState$1({ipns:_,options:a}){const $=a.EXPERIMENTAL;async function j(_e={}){try{return{enabled:Boolean(getPubsubRouting(_,$))}}catch{return{enabled:!1}}}return withTimeoutOption(j)}function createSubs$1({ipns:_,options:a}){const $=a.EXPERIMENTAL;async function j(_e={}){return getPubsubRouting(_,$).getSubscriptions(_e)}return withTimeoutOption(j)}class PubSubAPI{constructor({ipns:a,options:$}){this.cancel=createCancel$1({ipns:a,options:$}),this.state=createState$1({ipns:a,options:$}),this.subs=createSubs$1({ipns:a,options:$})}}class NameAPI{constructor({dns:a,ipns:$,repo:j,codecs:_e,peerId:et,isOnline:tt,keychain:rt,options:nt}){this.publish=createPublish$2({ipns:$,repo:j,codecs:_e,peerId:et,isOnline:tt,keychain:rt}),this.resolve=createResolve$4({dns:a,ipns:$,isOnline:tt,options:nt}),this.pubsub=new PubSubAPI({ipns:$,options:nt})}}const ERR_NOT_FOUND$1=notFoundError$1().code,Format={default:"<dst>",edges:"<src> -> <dst>"};function createRefs$1({repo:_,codecs:a,resolve:$,preload:j}){async function*_e(et,tt={}){if(tt.maxDepth===0)return;if(tt.edges&&tt.format&&tt.format!==Format.default)throw new Error("Cannot set edges to true and also specify format");if(tt.format=tt.edges?Format.edges:tt.format,typeof tt.maxDepth!="number"&&(tt.maxDepth=tt.recursive?1/0:1),tt.timeout){const st=[new timeoutAbortController.TimeoutController(tt.timeout).signal];tt.signal&&st.push(tt.signal),tt.signal=anySignal_2(st)}const nt=(Array.isArray(et)?et:[et]).map(it=>getFullPath(j,it,tt));for(const it of nt)try{yield*refsStream($,_,a,it,tt)}catch(st){yield{ref:"",err:st.message}}}return _e}function getFullPath(_,a,$){const{cid:j,path:_e}=toCidAndPath(a);return $.preload!==!1&&_(j),`/ipfs/${j}${_e||""}`}async function*refsStream(_,a,$,j,_e){const et=await _(j,_e),{cid:tt}=toCidAndPath(et),rt=_e.maxDepth!=null?_e.maxDepth:1/0,nt=_e.unique||!1;for await(const it of objectStream(a,$,tt,rt,nt,_e))!it.parent||it.isDuplicate||(yield{ref:formatLink(it.parent.cid,it.node.cid,it.node.name,_e.format)})}function formatLink(_,a,$="",j=Format.default){let _e=j.replace(/<src>/g,_.toString());return _e=_e.replace(/<dst>/g,a.toString()),_e=_e.replace(/<linkname>/g,$),_e}async function*objectStream(_,a,$,j,_e,et){const tt=new Set;async function*rt(nt,it){const st=it+1;if(!(st>j))try{for await(const ot of getLinks(_,a,nt.cid,et))yield{parent:nt,node:ot,isDuplicate:_e&&tt.has(ot.cid.toString())},_e&&tt.add(ot.cid.toString()),yield*rt(ot,st)}catch(ot){throw ot.code===ERR_NOT_FOUND$1&&(ot.message=`Could not find object with CID: ${nt.cid}`),ot}}yield*rt({cid:$},0)}async function*getLinks(_,a,$,j){const _e=await _.blocks.get($,j),tt=(await a.getCodec($.code)).decode(_e),rt=$.code===code$9,nt=[];for(const[it,st]of links$1(tt,nt)){if(rt){const ot=it.match(/^Links\/(\d+)\/Hash$/);if(ot){const at=Number(ot[1]);if(at<tt.Links.length){yield{name:tt.Links[at].Name,cid:st};continue}}}yield{name:it,cid:st}}}const links$1=function*(_,a){if(_!=null&&!(_ instanceof Uint8Array)){for(const[$,j]of Object.entries(_)){const _e=[...a,$];if(j!=null&&typeof j=="object")if(Array.isArray(j))for(const[et,tt]of j.entries()){const rt=[..._e,et],nt=CID.asCID(tt);nt?yield[rt.join("/"),nt]:typeof tt=="object"&&(yield*links$1(tt,rt))}else{const et=CID.asCID(j);et?yield[_e.join("/"),et]:yield*links$1(j,_e)}}return[]}};function createLocal$1({repo:_}){async function*a($={}){for await(const j of _.blocks.queryKeys({},{signal:$.signal}))yield{ref:j.toString()}}return withTimeoutOption(a)}function createWantlist$1({network:_}){async function a($={}){const{bitswap:j}=await _.use($),_e=j.getWantlist();return Array.from(_e).map(et=>et[1].cid)}return withTimeoutOption(a)}function createWantlistForPeer$1({network:_}){async function a($,j={}){const{bitswap:_e}=await _.use(j),et=_e.wantlistForPeer($);return Array.from(et).map(tt=>tt[1].cid)}return withTimeoutOption(a)}function createUnwant$1({network:_}){async function a($,j={}){const{bitswap:_e}=await _.use(j);return Array.isArray($)||($=[$]),_e.unwant($)}return withTimeoutOption(a)}function createStat$9({network:_}){async function a($={}){const j=(await _.use($)).bitswap,_e=j.stat().snapshot;return{provideBufLen:parseInt(_e.providesBufferLength.toString()),blocksReceived:BigInt(_e.blocksReceived.toString()),wantlist:Array.from(j.getWantlist()).map(et=>et[1].cid),peers:j.peers(),dupBlksReceived:BigInt(_e.dupBlksReceived.toString()),dupDataReceived:BigInt(_e.dupDataReceived.toString()),dataReceived:BigInt(_e.dataReceived.toString()),blocksSent:BigInt(_e.blocksSent.toString()),dataSent:BigInt(_e.dataSent.toString())}}return withTimeoutOption(a)}class BitswapAPI{constructor({network:a}){this.wantlist=createWantlist$1({network:a}),this.wantlistForPeer=createWantlistForPeer$1({network:a}),this.unwant=createUnwant$1({network:a}),this.stat=createStat$9({network:a})}}function isValidMultiaddr(_){try{return IPFS$1.matches(_)}catch{return!1}}function createAdd$6({repo:_}){async function a($,j={}){if(!isValidMultiaddr($))throw new Error(`${$} is not a valid Multiaddr`);const _e=await _.config.getAll(j),et=_e.Bootstrap||[];return et.push($.toString()),_e.Bootstrap=Array.from(new Set(et)).sort((tt,rt)=>tt.localeCompare(rt)),await _.config.replace(_e),{Peers:[$]}}return withTimeoutOption(a)}function createClear$1({repo:_}){async function a($={}){const j=await _.config.getAll($),_e=j.Bootstrap||[];return j.Bootstrap=[],await _.config.replace(j),{Peers:_e.map(et=>multiaddr(et))}}return withTimeoutOption(a)}function createList$4({repo:_}){async function a($={}){return{Peers:(await _.config.get("Bootstrap",$)||[]).map(_e=>multiaddr(_e))}}return withTimeoutOption(a)}const getDefaultConfig=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}});function createReset$1({repo:_}){async function a($={}){const j=await _.config.getAll($);return j.Bootstrap=getDefaultConfig().Bootstrap,await _.config.replace(j),{Peers:getDefaultConfig().Bootstrap.map(_e=>multiaddr(_e))}}return withTimeoutOption(a)}function createRm$a({repo:_}){async function a($,j={}){if(!isValidMultiaddr($))throw new Error(`${$} is not a valid Multiaddr`);const _e=await _.config.getAll(j);return _e.Bootstrap=(_e.Bootstrap||[]).filter(et=>et.toString()!==$.toString()),await _.config.replace(_e),{Peers:[$]}}return withTimeoutOption(a)}class BootstrapAPI{constructor({repo:a}){this.add=createAdd$6({repo:a}),this.list=createList$4({repo:a}),this.rm=createRm$a({repo:a}),this.clear=createClear$1({repo:a}),this.reset=createReset$1({repo:a})}}function createGet$9({preload:_,repo:a}){async function $(j,_e={}){return _e.preload!==!1&&_(j),a.blocks.get(j,_e)}return withTimeoutOption($)}function createPut$6({codecs:_,hashers:a,repo:$,preload:j}){async function _e(et,tt={}){const rt=tt.pin?await $.gcLock.readLock():null;try{const nt=tt.version!=null?tt.version:0,it=tt.format||(nt===0?"dag-pb":"raw"),ot=await(await a.getHasher(tt.mhtype||"sha2-256")).digest(et),at=await _.getCodec(it),lt=CID.create(nt,at.code,ot);return await $.blocks.put(lt,et,{signal:tt.signal}),tt.preload!==!1&&j(lt),tt.pin===!0&&await $.pins.pinRecursively(lt,{signal:tt.signal}),lt}finally{rt&&rt()}}return withTimeoutOption(_e)}function pDefer$2(){const _={};return _.promise=new Promise((a,$)=>{_.resolve=a,_.reject=$}),_}const CustomEvent$2=globalThis.CustomEvent??Event;async function*parallel$2(_,a={}){let $=a.concurrency??1/0;$<1&&($=1/0);const j=a.ordered==null?!1:a.ordered,_e=new EventTarget,et=[];let tt=pDefer$2(),rt=pDefer$2(),nt=!1,it,st=!1;_e.addEventListener("task-complete",()=>{rt.resolve()}),Promise.resolve().then(async()=>{try{for await(const ct of _){if(et.length===$&&(tt=pDefer$2(),await tt.promise),st)break;const ut={done:!1};et.push(ut),ct().then(dt=>{ut.done=!0,ut.ok=!0,ut.value=dt,_e.dispatchEvent(new CustomEvent$2("task-complete"))},dt=>{ut.done=!0,ut.err=dt,_e.dispatchEvent(new CustomEvent$2("task-complete"))})}nt=!0,_e.dispatchEvent(new CustomEvent$2("task-complete"))}catch(ct){it=ct,_e.dispatchEvent(new CustomEvent$2("task-complete"))}});function ot(){return j?et[0]?.done:Boolean(et.find(ct=>ct.done))}function*at(){for(;et.length>0&&et[0].done;){const ct=et[0];if(et.shift(),ct.ok)yield ct.value;else throw st=!0,tt.resolve(),ct.err;tt.resolve()}}function*lt(){for(;ot();)for(let ct=0;ct<et.length;ct++)if(et[ct].done){const ut=et[ct];if(et.splice(ct,1),ct--,ut.ok)yield ut.value;else throw st=!0,tt.resolve(),ut.err;tt.resolve()}}for(;;){if(ot()||(rt=pDefer$2(),await rt.promise),it!=null)throw it;if(j?yield*at():yield*lt(),nt&&et.length===0)break}}async function*map$6(_,a){for await(const $ of _)yield a($)}async function*filter$3(_,a){for await(const $ of _)await a($)&&(yield $)}function cleanCid(_){return _ instanceof Uint8Array?CID.decode(_):CID.parse(_.toString())}const BLOCK_RM_CONCURRENCY$1=8;function createRm$9({repo:_}){async function*a($,j={}){Array.isArray($)||($=[$]);const _e=await _.gcLock.writeLock();try{yield*pipe($,et=>map$6(et,tt=>async()=>{tt=cleanCid(tt);const rt={cid:tt};try{if(!await _.blocks.has(tt))throw errCode(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await _.blocks.delete(tt)}catch(nt){j.force||(nt.message=`cannot remove ${tt}: ${nt.message}`,rt.error=nt)}return rt}),et=>parallel$2(et,{concurrency:BLOCK_RM_CONCURRENCY$1}),et=>filter$3(et,()=>!j.quiet))}finally{_e()}}return withTimeoutOption(a)}function createStat$8({repo:_,preload:a}){async function $(j,_e={}){j=cleanCid(j),_e.preload!==!1&&a(j);const et=await _.blocks.get(j);return{cid:j,size:et.length}}return withTimeoutOption($)}class BlockAPI{constructor({codecs:a,hashers:$,preload:j,repo:_e}){this.get=createGet$9({preload:j,repo:_e}),this.put=createPut$6({codecs:a,hashers:$,preload:j,repo:_e}),this.rm=createRm$9({repo:_e}),this.stat=createStat$8({preload:j,repo:_e})}}async function*browserReadableStreamToIt(_,a={}){const $=_.getReader();try{for(;;){const j=await $.read();if(j.done)return;yield j.value}}finally{a.preventCancel!==!0&&await $.cancel(),$.releaseLock()}}function blobToIt(_){return typeof _.stream=="function"?browserReadableStreamToIt(_.stream()):browserReadableStreamToIt(new Response(_).body)}function peekableIterator(_){const[a,$]=_[Symbol.asyncIterator]!=null?[_[Symbol.asyncIterator](),Symbol.asyncIterator]:[_[Symbol.iterator](),Symbol.iterator],j=[];return{peek:()=>a.next(),push:_e=>{j.push(_e)},next:()=>j.length>0?{done:!1,value:j.shift()}:a.next(),[$](){return this}}}async function all$5(_){const a=[];for await(const $ of _)a.push($);return a}function isBytes(_){return ArrayBuffer.isView(_)||_ instanceof ArrayBuffer}function isBlob(_){return _.constructor&&(_.constructor.name==="Blob"||_.constructor.name==="File")&&typeof _.stream=="function"}function isFileObject(_){return typeof _=="object"&&(_.path||_.content)}const isReadableStream=_=>_&&typeof _.getReader=="function";async function*toAsyncIterable(_){yield _}async function normaliseContent$1(_){if(isBytes(_))return toAsyncIterable(toBytes(_));if(typeof _=="string"||_ instanceof String)return toAsyncIterable(toBytes(_.toString()));if(isBlob(_))return blobToIt(_);if(isReadableStream(_)&&(_=browserReadableStreamToIt(_)),Symbol.iterator in _||Symbol.asyncIterator in _){const a=peekableIterator(_),{value:$,done:j}=await a.peek();if(j)return toAsyncIterable(new Uint8Array(0));if(a.push($),Number.isInteger($))return toAsyncIterable(Uint8Array.from(await all$5(a)));if(isBytes($)||typeof $=="string"||$ instanceof String)return map$6(a,toBytes)}throw errCode(new Error(`Unexpected input: ${_}`),"ERR_UNEXPECTED_INPUT")}function toBytes(_){return _ instanceof Uint8Array?_:ArrayBuffer.isView(_)?new Uint8Array(_.buffer,_.byteOffset,_.byteLength):_ instanceof ArrayBuffer?new Uint8Array(_):Array.isArray(_)?Uint8Array.from(_):fromString$5(_.toString())}async function*normaliseCandidateSingle(_,a){if(_==null)throw errCode(new Error(`Unexpected input: ${_}`),"ERR_UNEXPECTED_INPUT");if(typeof _=="string"||_ instanceof String){yield toFileObject$1(_.toString(),a);return}if(isBytes(_)||isBlob(_)){yield toFileObject$1(_,a);return}if(isReadableStream(_)&&(_=browserReadableStreamToIt(_)),Symbol.iterator in _||Symbol.asyncIterator in _){const $=peekableIterator(_),{value:j,done:_e}=await $.peek();if(_e){yield{content:[]};return}if($.push(j),Number.isInteger(j)||isBytes(j)||typeof j=="string"||j instanceof String){yield toFileObject$1($,a);return}throw errCode(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(isFileObject(_)){yield toFileObject$1(_,a);return}throw errCode(new Error('Unexpected input: cannot convert "'+typeof _+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function toFileObject$1(_,a){const{path:$,mode:j,mtime:_e,content:et}=_,tt={path:$||"",mode:parseMode(j),mtime:parseMtime$1(_e)};return et?tt.content=await a(et):$||(tt.content=await a(_)),tt}function normaliseInput$2(_){return normaliseCandidateSingle(_,normaliseContent$1)}function createAdd$5({addAll:_}){async function a($,j={}){const _e=await last(_(normaliseInput$2($),j));if(_e==null)throw Error("Failed to add a file, if you see this please report a bug");return _e}return a}async function*batch(_,a=1){let $=[];a<1&&(a=1);for await(const j of _)for($.push(j);$.length>=a;)yield $.slice(0,a),$=$.slice(a);for(;$.length>0;)yield $.slice(0,a),$=$.slice(a)}async function*parallelBatch(_,a=1){for await(const $ of batch(_,a)){const j=$.map(async _e=>await _e().then(et=>({ok:!0,value:et}),et=>({ok:!1,err:et})));for(let _e=0;_e<j.length;_e++){const et=await j[_e];if(et.ok)yield et.value;else throw et.err}}}var murmurhash3jsRevisited={exports:{}},murmurHash3js={exports:{}};(function(_,a){(function($,j){var _e={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function et(ut){if(!Array.isArray(ut)&&!ArrayBuffer.isView(ut))return!1;for(var dt=0;dt<ut.length;dt++)if(!Number.isInteger(ut[dt])||ut[dt]<0||ut[dt]>255)return!1;return!0}function tt(ut,dt){return(ut&65535)*dt+(((ut>>>16)*dt&65535)<<16)}function rt(ut,dt){return ut<<dt|ut>>>32-dt}function nt(ut){return ut^=ut>>>16,ut=tt(ut,2246822507),ut^=ut>>>13,ut=tt(ut,3266489909),ut^=ut>>>16,ut}function it(ut,dt){ut=[ut[0]>>>16,ut[0]&65535,ut[1]>>>16,ut[1]&65535],dt=[dt[0]>>>16,dt[0]&65535,dt[1]>>>16,dt[1]&65535];var ft=[0,0,0,0];return ft[3]+=ut[3]+dt[3],ft[2]+=ft[3]>>>16,ft[3]&=65535,ft[2]+=ut[2]+dt[2],ft[1]+=ft[2]>>>16,ft[2]&=65535,ft[1]+=ut[1]+dt[1],ft[0]+=ft[1]>>>16,ft[1]&=65535,ft[0]+=ut[0]+dt[0],ft[0]&=65535,[ft[0]<<16|ft[1],ft[2]<<16|ft[3]]}function st(ut,dt){ut=[ut[0]>>>16,ut[0]&65535,ut[1]>>>16,ut[1]&65535],dt=[dt[0]>>>16,dt[0]&65535,dt[1]>>>16,dt[1]&65535];var ft=[0,0,0,0];return ft[3]+=ut[3]*dt[3],ft[2]+=ft[3]>>>16,ft[3]&=65535,ft[2]+=ut[2]*dt[3],ft[1]+=ft[2]>>>16,ft[2]&=65535,ft[2]+=ut[3]*dt[2],ft[1]+=ft[2]>>>16,ft[2]&=65535,ft[1]+=ut[1]*dt[3],ft[0]+=ft[1]>>>16,ft[1]&=65535,ft[1]+=ut[2]*dt[2],ft[0]+=ft[1]>>>16,ft[1]&=65535,ft[1]+=ut[3]*dt[1],ft[0]+=ft[1]>>>16,ft[1]&=65535,ft[0]+=ut[0]*dt[3]+ut[1]*dt[2]+ut[2]*dt[1]+ut[3]*dt[0],ft[0]&=65535,[ft[0]<<16|ft[1],ft[2]<<16|ft[3]]}function ot(ut,dt){return dt%=64,dt===32?[ut[1],ut[0]]:dt<32?[ut[0]<<dt|ut[1]>>>32-dt,ut[1]<<dt|ut[0]>>>32-dt]:(dt-=32,[ut[1]<<dt|ut[0]>>>32-dt,ut[0]<<dt|ut[1]>>>32-dt])}function at(ut,dt){return dt%=64,dt===0?ut:dt<32?[ut[0]<<dt|ut[1]>>>32-dt,ut[1]<<dt]:[ut[1]<<dt-32,0]}function lt(ut,dt){return[ut[0]^dt[0],ut[1]^dt[1]]}function ct(ut){return ut=lt(ut,[0,ut[0]>>>1]),ut=st(ut,[4283543511,3981806797]),ut=lt(ut,[0,ut[0]>>>1]),ut=st(ut,[3301882366,444984403]),ut=lt(ut,[0,ut[0]>>>1]),ut}_e.x86.hash32=function(ut,dt){if(_e.inputValidation&&!et(ut))return j;dt=dt||0;for(var ft=ut.length%4,pt=ut.length-ft,yt=dt,mt=0,_t=3432918353,vt=461845907,ht=0;ht<pt;ht=ht+4)mt=ut[ht]|ut[ht+1]<<8|ut[ht+2]<<16|ut[ht+3]<<24,mt=tt(mt,_t),mt=rt(mt,15),mt=tt(mt,vt),yt^=mt,yt=rt(yt,13),yt=tt(yt,5)+3864292196;switch(mt=0,ft){case 3:mt^=ut[ht+2]<<16;case 2:mt^=ut[ht+1]<<8;case 1:mt^=ut[ht],mt=tt(mt,_t),mt=rt(mt,15),mt=tt(mt,vt),yt^=mt}return yt^=ut.length,yt=nt(yt),yt>>>0},_e.x86.hash128=function(ut,dt){if(_e.inputValidation&&!et(ut))return j;dt=dt||0;for(var ft=ut.length%16,pt=ut.length-ft,yt=dt,mt=dt,_t=dt,vt=dt,ht=0,St=0,It=0,Lt=0,Mt=597399067,Kt=2869860233,kt=951274213,gt=2716044179,Et=0;Et<pt;Et=Et+16)ht=ut[Et]|ut[Et+1]<<8|ut[Et+2]<<16|ut[Et+3]<<24,St=ut[Et+4]|ut[Et+5]<<8|ut[Et+6]<<16|ut[Et+7]<<24,It=ut[Et+8]|ut[Et+9]<<8|ut[Et+10]<<16|ut[Et+11]<<24,Lt=ut[Et+12]|ut[Et+13]<<8|ut[Et+14]<<16|ut[Et+15]<<24,ht=tt(ht,Mt),ht=rt(ht,15),ht=tt(ht,Kt),yt^=ht,yt=rt(yt,19),yt+=mt,yt=tt(yt,5)+1444728091,St=tt(St,Kt),St=rt(St,16),St=tt(St,kt),mt^=St,mt=rt(mt,17),mt+=_t,mt=tt(mt,5)+197830471,It=tt(It,kt),It=rt(It,17),It=tt(It,gt),_t^=It,_t=rt(_t,15),_t+=vt,_t=tt(_t,5)+2530024501,Lt=tt(Lt,gt),Lt=rt(Lt,18),Lt=tt(Lt,Mt),vt^=Lt,vt=rt(vt,13),vt+=yt,vt=tt(vt,5)+850148119;switch(ht=0,St=0,It=0,Lt=0,ft){case 15:Lt^=ut[Et+14]<<16;case 14:Lt^=ut[Et+13]<<8;case 13:Lt^=ut[Et+12],Lt=tt(Lt,gt),Lt=rt(Lt,18),Lt=tt(Lt,Mt),vt^=Lt;case 12:It^=ut[Et+11]<<24;case 11:It^=ut[Et+10]<<16;case 10:It^=ut[Et+9]<<8;case 9:It^=ut[Et+8],It=tt(It,kt),It=rt(It,17),It=tt(It,gt),_t^=It;case 8:St^=ut[Et+7]<<24;case 7:St^=ut[Et+6]<<16;case 6:St^=ut[Et+5]<<8;case 5:St^=ut[Et+4],St=tt(St,Kt),St=rt(St,16),St=tt(St,kt),mt^=St;case 4:ht^=ut[Et+3]<<24;case 3:ht^=ut[Et+2]<<16;case 2:ht^=ut[Et+1]<<8;case 1:ht^=ut[Et],ht=tt(ht,Mt),ht=rt(ht,15),ht=tt(ht,Kt),yt^=ht}return yt^=ut.length,mt^=ut.length,_t^=ut.length,vt^=ut.length,yt+=mt,yt+=_t,yt+=vt,mt+=yt,_t+=yt,vt+=yt,yt=nt(yt),mt=nt(mt),_t=nt(_t),vt=nt(vt),yt+=mt,yt+=_t,yt+=vt,mt+=yt,_t+=yt,vt+=yt,("00000000"+(yt>>>0).toString(16)).slice(-8)+("00000000"+(mt>>>0).toString(16)).slice(-8)+("00000000"+(_t>>>0).toString(16)).slice(-8)+("00000000"+(vt>>>0).toString(16)).slice(-8)},_e.x64.hash128=function(ut,dt){if(_e.inputValidation&&!et(ut))return j;dt=dt||0;for(var ft=ut.length%16,pt=ut.length-ft,yt=[0,dt],mt=[0,dt],_t=[0,0],vt=[0,0],ht=[2277735313,289559509],St=[1291169091,658871167],It=0;It<pt;It=It+16)_t=[ut[It+4]|ut[It+5]<<8|ut[It+6]<<16|ut[It+7]<<24,ut[It]|ut[It+1]<<8|ut[It+2]<<16|ut[It+3]<<24],vt=[ut[It+12]|ut[It+13]<<8|ut[It+14]<<16|ut[It+15]<<24,ut[It+8]|ut[It+9]<<8|ut[It+10]<<16|ut[It+11]<<24],_t=st(_t,ht),_t=ot(_t,31),_t=st(_t,St),yt=lt(yt,_t),yt=ot(yt,27),yt=it(yt,mt),yt=it(st(yt,[0,5]),[0,1390208809]),vt=st(vt,St),vt=ot(vt,33),vt=st(vt,ht),mt=lt(mt,vt),mt=ot(mt,31),mt=it(mt,yt),mt=it(st(mt,[0,5]),[0,944331445]);switch(_t=[0,0],vt=[0,0],ft){case 15:vt=lt(vt,at([0,ut[It+14]],48));case 14:vt=lt(vt,at([0,ut[It+13]],40));case 13:vt=lt(vt,at([0,ut[It+12]],32));case 12:vt=lt(vt,at([0,ut[It+11]],24));case 11:vt=lt(vt,at([0,ut[It+10]],16));case 10:vt=lt(vt,at([0,ut[It+9]],8));case 9:vt=lt(vt,[0,ut[It+8]]),vt=st(vt,St),vt=ot(vt,33),vt=st(vt,ht),mt=lt(mt,vt);case 8:_t=lt(_t,at([0,ut[It+7]],56));case 7:_t=lt(_t,at([0,ut[It+6]],48));case 6:_t=lt(_t,at([0,ut[It+5]],40));case 5:_t=lt(_t,at([0,ut[It+4]],32));case 4:_t=lt(_t,at([0,ut[It+3]],24));case 3:_t=lt(_t,at([0,ut[It+2]],16));case 2:_t=lt(_t,at([0,ut[It+1]],8));case 1:_t=lt(_t,[0,ut[It]]),_t=st(_t,ht),_t=ot(_t,31),_t=st(_t,St),yt=lt(yt,_t)}return yt=lt(yt,[0,ut.length]),mt=lt(mt,[0,ut.length]),yt=it(yt,mt),mt=it(mt,yt),yt=ct(yt),mt=ct(mt),yt=it(yt,mt),mt=it(mt,yt),("00000000"+(yt[0]>>>0).toString(16)).slice(-8)+("00000000"+(yt[1]>>>0).toString(16)).slice(-8)+("00000000"+(mt[0]>>>0).toString(16)).slice(-8)+("00000000"+(mt[1]>>>0).toString(16)).slice(-8)},_.exports&&(a=_.exports=_e),a.murmurHash3=_e})()})(murmurHash3js,murmurHash3js.exports);(function(_){_.exports=murmurHash3js.exports})(murmurhash3jsRevisited);const mur=getDefaultExportFromCjs(murmurhash3jsRevisited.exports);function fromNumberTo32BitBuf(_){const a=new Array(4);for(let $=0;$<4;$++)a[$]=_&255,_=_>>8;return new Uint8Array(a)}from$5({name:"murmur3-32",code:35,encode:_=>fromNumberTo32BitBuf(mur.x86.hash32(_))});const murmur3128=from$5({name:"murmur3-128",code:34,encode:_=>fromHex(mur.x64.hash128(_))});async function hamtHashFn$1(_){return(await murmur3128.encode(_)).slice(0,8).reverse()}const defaultOptions$k={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:sha256$4,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:0x3df305dfb2a804,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:hamtHashFn$1,hamtHashCode:34,hamtBucketBits:8},defaultOptions$l=(_={})=>mergeOptions$g.bind({ignoreUndefined:!0})(defaultOptions$k,_),persist$1=async(_,a,$)=>{$.codec||($.codec=dagPB),$.hasher||($.hasher=sha256$4),$.cidVersion===void 0&&($.cidVersion=1),$.codec===dagPB&&$.hasher!==sha256$4&&($.cidVersion=1);const j=await $.hasher.digest(_),_e=CID.create($.cidVersion,$.codec.code,j);return $.onlyHash||await a.put(_e,_,{signal:$.signal}),_e},dirBuilder=async(_,a,$)=>{const j=new UnixFS({type:"directory",mtime:_.mtime,mode:_.mode}),_e=encode$s(prepare({Data:j.marshal()})),et=await persist$1(_e,a,$),tt=_.path;return{cid:et,path:tt,unixfs:j,size:_e.length}};async function flat(_,a){return a(await all$5(_))}function balanced(_,a,$){return reduceToParents(_,a,$)}async function reduceToParents(_,a,$){const j=[];for await(const _e of batch(_,$.maxChildrenPerNode))j.push(await a(_e));return j.length>1?reduceToParents(j,a,$):j[0]}async function trickleStream(_,a,$){const j=new Root($.layerRepeat);let _e=0,et=1,tt=j;for await(const rt of batch(_,$.maxChildrenPerNode))tt.isFull()&&(tt!==j&&j.addChild(await tt.reduce(a)),_e&&_e%$.layerRepeat===0&&et++,tt=new SubTree(et,$.layerRepeat,_e),_e++),tt.append(rt);return tt&&tt!==j&&j.addChild(await tt.reduce(a)),j.reduce(a)}class SubTree{constructor(a,$,j=0){this.maxDepth=a,this.layerRepeat=$,this.currentDepth=1,this.iteration=j,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:a,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;const a=this._findParent(this.node,this.currentDepth);return a?(this._addNextNodeToParent(a),!1):!0}_addNextNodeToParent(a){this.parent=a;const $={children:[],depth:a.depth+1,parent:a,maxDepth:this.maxDepth,maxChildren:Math.floor(a.children.length/this.layerRepeat)*this.layerRepeat};a.children.push($),this.currentDepth=$.depth,this.node=$}append(a){this.node.data=a}reduce(a){return this._reduce(this.root,a)}async _reduce(a,$){let j=[];return a.children.length&&(j=await Promise.all(a.children.filter(_e=>_e.data).map(_e=>this._reduce(_e,$)))),$((a.data||[]).concat(j))}_findParent(a,$){const j=a.parent;if(!(!j||j.depth===0))return j.children.length===j.maxChildren||!j.maxChildren?this._findParent(j,$):j}}class Root extends SubTree{constructor(a){super(0,a),this.root.depth=0,this.currentDepth=1}addChild(a){this.root.children.push(a)}reduce(a){return a((this.root.data||[]).concat(this.root.children))}}async function*bufferImporter(_,a,$){for await(let j of _.content)yield async()=>{$.progress(j.length,_.path);let _e;const et={codec:dagPB,cidVersion:$.cidVersion,hasher:$.hasher,onlyHash:$.onlyHash};return $.rawLeaves?(et.codec=raw,et.cidVersion=1):(_e=new UnixFS({type:$.leafType,data:j}),j=encode$s({Data:_e.marshal(),Links:[]})),{cid:await persist$1(j,a,et),unixfs:_e,size:j.length}}}const dagBuilders={flat,balanced,trickle:trickleStream};async function*buildFileBatch(_,a,$){let j=-1,_e,et;typeof $.bufferImporter=="function"?et=$.bufferImporter:et=bufferImporter;for await(const tt of parallelBatch(et(_,a,$),$.blockWriteConcurrency)){if(j++,j===0){_e=tt;continue}else j===1&&_e&&(yield _e,_e=null);yield tt}_e&&(_e.single=!0,yield _e)}const reduce=(_,a,$)=>{async function j(_e){if(_e.length===1&&_e[0].single&&$.reduceSingleLeafToSelf){const st=_e[0];if(_.mtime!==void 0||_.mode!==void 0){let ot=await a.get(st.cid);st.unixfs=new UnixFS({type:"file",mtime:_.mtime,mode:_.mode,data:ot}),ot=encode$s(prepare({Data:st.unixfs.marshal()})),st.cid=await persist$1(ot,a,{...$,codec:dagPB,hasher:$.hasher,cidVersion:$.cidVersion}),st.size=ot.length}return{cid:st.cid,path:_.path,unixfs:st.unixfs,size:st.size}}const et=new UnixFS({type:"file",mtime:_.mtime,mode:_.mode}),tt=_e.filter(st=>st.cid.code===code$4&&st.size||st.unixfs&&!st.unixfs.data&&st.unixfs.fileSize()?!0:Boolean(st.unixfs&&st.unixfs.data&&st.unixfs.data.length)).map(st=>st.cid.code===code$4?(et.addBlockSize(st.size),{Name:"",Tsize:st.size,Hash:st.cid}):(!st.unixfs||!st.unixfs.data?et.addBlockSize(st.unixfs&&st.unixfs.fileSize()||0):et.addBlockSize(st.unixfs.data.length),{Name:"",Tsize:st.size,Hash:st.cid})),rt={Data:et.marshal(),Links:tt},nt=encode$s(prepare(rt));return{cid:await persist$1(nt,a,$),path:_.path,unixfs:et,size:nt.length+rt.Links.reduce((st,ot)=>st+ot.Tsize,0)}}return j};function fileBuilder(_,a,$){const j=dagBuilders[$.strategy];if(!j)throw errCode(new Error(`Unknown importer build strategy name: ${$.strategy}`),"ERR_BAD_STRATEGY");return j(buildFileBatch(_,a,$),reduce(_,a,$),$)}const symbol$3=Symbol.for("@achingbrain/uint8arraylist");function findBufAndOffset(_,a){if(a==null||a<0)throw new RangeError("index is out of bounds");let $=0;for(const j of _){const _e=$+j.byteLength;if(a<_e)return{buf:j,index:a-$};$=_e}throw new RangeError("index is out of bounds")}function isUint8ArrayList(_){return Boolean(_?.[symbol$3])}class Uint8ArrayList{constructor(...a){Object.defineProperty(this,symbol$3,{value:!0}),this.bufs=[],this.length=0,a.length>0&&this.appendAll(a)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...a){this.appendAll(a)}appendAll(a){let $=0;for(const j of a)if(j instanceof Uint8Array)$+=j.byteLength,this.bufs.push(j);else if(isUint8ArrayList(j))$+=j.byteLength,this.bufs.push(...j.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=$}prepend(...a){this.prependAll(a)}prependAll(a){let $=0;for(const j of a.reverse())if(j instanceof Uint8Array)$+=j.byteLength,this.bufs.unshift(j);else if(isUint8ArrayList(j))$+=j.byteLength,this.bufs.unshift(...j.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=$}get(a){const $=findBufAndOffset(this.bufs,a);return $.buf[$.index]}set(a,$){const j=findBufAndOffset(this.bufs,a);j.buf[j.index]=$}write(a,$=0){if(a instanceof Uint8Array)for(let j=0;j<a.length;j++)this.set($+j,a[j]);else if(isUint8ArrayList(a))for(let j=0;j<a.length;j++)this.set($+j,a.get(j));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(a){if(a=Math.trunc(a),!(Number.isNaN(a)||a<=0))for(;this.bufs.length>0;)if(a>=this.bufs[0].byteLength)a-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(a),this.length-=a;break}}slice(a,$){const{bufs:j,length:_e}=this._subList(a,$);return concat$1(j,_e)}subarray(a,$){const{bufs:j,length:_e}=this._subList(a,$);return j.length===1?j[0]:concat$1(j,_e)}sublist(a,$){const{bufs:j,length:_e}=this._subList(a,$),et=new Uint8ArrayList;return et.length=_e,et.bufs=j,et}_subList(a,$){if(a=a??0,$=$??this.length,a<0&&(a=this.length+a),$<0&&($=this.length+$),a<0||$>this.length)throw new RangeError("index is out of bounds");if(a===$)return{bufs:[],length:0};if(a===0&&$===this.length)return{bufs:[...this.bufs],length:this.length};const j=[];let _e=0;for(let et=0;et<this.bufs.length;et++){const tt=this.bufs[et],rt=_e,nt=rt+tt.byteLength;if(_e=nt,a>=nt)continue;const it=a>=rt&&a<nt,st=$>rt&&$<=nt;if(it&&st){if(a===rt&&$===nt){j.push(tt);break}const ot=a-rt;j.push(tt.subarray(ot,ot+($-a)));break}if(it){if(a===0){j.push(tt);continue}j.push(tt.subarray(a-rt));continue}if(st){if($===nt){j.push(tt);break}j.push(tt.subarray(0,$-rt));break}j.push(tt)}return{bufs:j,length:$-a}}getInt8(a){const $=this.subarray(a,a+1);return new DataView($.buffer,$.byteOffset,$.byteLength).getInt8(0)}setInt8(a,$){const j=allocUnsafe$5(1);new DataView(j.buffer,j.byteOffset,j.byteLength).setInt8(0,$),this.write(j,a)}getInt16(a,$){const j=this.subarray(a,a+2);return new DataView(j.buffer,j.byteOffset,j.byteLength).getInt16(0,$)}setInt16(a,$,j){const _e=alloc(2);new DataView(_e.buffer,_e.byteOffset,_e.byteLength).setInt16(0,$,j),this.write(_e,a)}getInt32(a,$){const j=this.subarray(a,a+4);return new DataView(j.buffer,j.byteOffset,j.byteLength).getInt32(0,$)}setInt32(a,$,j){const _e=alloc(4);new DataView(_e.buffer,_e.byteOffset,_e.byteLength).setInt32(0,$,j),this.write(_e,a)}getBigInt64(a,$){const j=this.subarray(a,a+8);return new DataView(j.buffer,j.byteOffset,j.byteLength).getBigInt64(0,$)}setBigInt64(a,$,j){const _e=alloc(8);new DataView(_e.buffer,_e.byteOffset,_e.byteLength).setBigInt64(0,$,j),this.write(_e,a)}getUint8(a){const $=this.subarray(a,a+1);return new DataView($.buffer,$.byteOffset,$.byteLength).getUint8(0)}setUint8(a,$){const j=allocUnsafe$5(1);new DataView(j.buffer,j.byteOffset,j.byteLength).setUint8(0,$),this.write(j,a)}getUint16(a,$){const j=this.subarray(a,a+2);return new DataView(j.buffer,j.byteOffset,j.byteLength).getUint16(0,$)}setUint16(a,$,j){const _e=alloc(2);new DataView(_e.buffer,_e.byteOffset,_e.byteLength).setUint16(0,$,j),this.write(_e,a)}getUint32(a,$){const j=this.subarray(a,a+4);return new DataView(j.buffer,j.byteOffset,j.byteLength).getUint32(0,$)}setUint32(a,$,j){const _e=alloc(4);new DataView(_e.buffer,_e.byteOffset,_e.byteLength).setUint32(0,$,j),this.write(_e,a)}getBigUint64(a,$){const j=this.subarray(a,a+8);return new DataView(j.buffer,j.byteOffset,j.byteLength).getBigUint64(0,$)}setBigUint64(a,$,j){const _e=alloc(8);new DataView(_e.buffer,_e.byteOffset,_e.byteLength).setBigUint64(0,$,j),this.write(_e,a)}getFloat32(a,$){const j=this.subarray(a,a+4);return new DataView(j.buffer,j.byteOffset,j.byteLength).getFloat32(0,$)}setFloat32(a,$,j){const _e=alloc(4);new DataView(_e.buffer,_e.byteOffset,_e.byteLength).setFloat32(0,$,j),this.write(_e,a)}getFloat64(a,$){const j=this.subarray(a,a+8);return new DataView(j.buffer,j.byteOffset,j.byteLength).getFloat64(0,$)}setFloat64(a,$,j){const _e=alloc(8);new DataView(_e.buffer,_e.byteOffset,_e.byteLength).setFloat64(0,$,j),this.write(_e,a)}equals(a){if(a==null||!(a instanceof Uint8ArrayList)||a.bufs.length!==this.bufs.length)return!1;for(let $=0;$<this.bufs.length;$++)if(!equals$1(this.bufs[$],a.bufs[$]))return!1;return!0}static fromUint8Arrays(a,$){const j=new Uint8ArrayList;return j.bufs=a,$==null&&($=a.reduce((_e,et)=>_e+et.byteLength,0)),j.length=$,j}}class Rabin$1{constructor(a,$=12,j=8*1024,_e=32*1024,et=64,tt){this.bits=$,this.min=j,this.max=_e,this.asModule=a,this.rabin=new a.Rabin($,j,_e,et,tt),this.polynomial=tt}fingerprint(a){const{__retain:$,__release:j,__allocArray:_e,__getInt32Array:et,Int32Array_ID:tt,Uint8Array_ID:rt}=this.asModule,nt=new Int32Array(Math.ceil(a.length/this.min)),it=$(_e(tt,nt)),st=$(_e(rt,a)),ot=this.rabin.fingerprint(st,it),at=et(ot);j(st),j(it);const lt=at.indexOf(0);return lt>=0?at.subarray(0,lt):at}}var rabin$1=Rabin$1,loader={};const ID_OFFSET=-8,SIZE_OFFSET=-4,ARRAYBUFFER_ID=0,STRING_ID=1,ARRAYBUFFERVIEW=1<<0,ARRAY=1<<1,VAL_ALIGN_OFFSET=5,VAL_SIGNED=1<<10,VAL_FLOAT=1<<11,VAL_MANAGED=1<<13,ARRAYBUFFERVIEW_BUFFER_OFFSET=0,ARRAYBUFFERVIEW_DATASTART_OFFSET=4,ARRAYBUFFERVIEW_DATALENGTH_OFFSET=8,ARRAYBUFFERVIEW_SIZE=12,ARRAY_LENGTH_OFFSET=12,ARRAY_SIZE=16,BIGINT=typeof BigUint64Array<"u",THIS=Symbol(),CHUNKSIZE=1024;function getStringImpl(_,a){const $=new Uint32Array(_),j=new Uint16Array(_);var _e=$[a+SIZE_OFFSET>>>2]>>>1,et=a>>>1;if(_e<=CHUNKSIZE)return String.fromCharCode.apply(String,j.subarray(et,et+_e));const tt=[];do{const rt=j[et+CHUNKSIZE-1],nt=rt>=55296&&rt<56320?CHUNKSIZE-1:CHUNKSIZE;tt.push(String.fromCharCode.apply(String,j.subarray(et,et+=nt))),_e-=nt}while(_e>CHUNKSIZE);return tt.join("")+String.fromCharCode.apply(String,j.subarray(et,et+_e))}function preInstantiate(_){const a={};function $(_e,et){return _e?getStringImpl(_e.buffer,et):"<yet unknown>"}const j=_.env=_.env||{};return j.abort=j.abort||function(et,tt,rt,nt){const it=a.memory||j.memory;throw Error("abort: "+$(it,et)+" at "+$(it,tt)+":"+rt+":"+nt)},j.trace=j.trace||function(et,tt){const rt=a.memory||j.memory;console.log("trace: "+$(rt,et)+(tt?" ":"")+Array.prototype.slice.call(arguments,2,2+tt).join(", "))},_.Math=_.Math||Math,_.Date=_.Date||Date,a}function postInstantiate(_,a){const $=a.exports,j=$.memory,_e=$.table,et=$.__alloc,tt=$.__retain,rt=$.__rtti_base||-1;function nt(_t){const vt=new Uint32Array(j.buffer),ht=vt[rt>>>2];if((_t>>>=0)>=ht)throw Error("invalid id: "+_t);return vt[(rt+4>>>2)+_t*2]}function it(_t){const vt=new Uint32Array(j.buffer),ht=vt[rt>>>2];if((_t>>>=0)>=ht)throw Error("invalid id: "+_t);return vt[(rt+4>>>2)+_t*2+1]}function st(_t){return 31-Math.clz32(_t>>>VAL_ALIGN_OFFSET&31)}function ot(_t){const vt=_t.length,ht=et(vt<<1,STRING_ID),St=new Uint16Array(j.buffer);for(var It=0,Lt=ht>>>1;It<vt;++It)St[Lt+It]=_t.charCodeAt(It);return ht}_.__allocString=ot;function at(_t){const vt=j.buffer;if(new Uint32Array(vt)[_t+ID_OFFSET>>>2]!==STRING_ID)throw Error("not a string: "+_t);return getStringImpl(vt,_t)}_.__getString=at;function lt(_t,vt,ht){const St=j.buffer;if(ht)switch(_t){case 2:return new Float32Array(St);case 3:return new Float64Array(St)}else switch(_t){case 0:return new(vt?Int8Array:Uint8Array)(St);case 1:return new(vt?Int16Array:Uint16Array)(St);case 2:return new(vt?Int32Array:Uint32Array)(St);case 3:return new(vt?BigInt64Array:BigUint64Array)(St)}throw Error("unsupported align: "+_t)}function ct(_t,vt){const ht=nt(_t);if(!(ht&(ARRAYBUFFERVIEW|ARRAY)))throw Error("not an array: "+_t+" @ "+ht);const St=st(ht),It=vt.length,Lt=et(It<<St,ARRAYBUFFER_ID),Mt=et(ht&ARRAY?ARRAY_SIZE:ARRAYBUFFERVIEW_SIZE,_t),Kt=new Uint32Array(j.buffer);Kt[Mt+ARRAYBUFFERVIEW_BUFFER_OFFSET>>>2]=tt(Lt),Kt[Mt+ARRAYBUFFERVIEW_DATASTART_OFFSET>>>2]=Lt,Kt[Mt+ARRAYBUFFERVIEW_DATALENGTH_OFFSET>>>2]=It<<St,ht&ARRAY&&(Kt[Mt+ARRAY_LENGTH_OFFSET>>>2]=It);const kt=lt(St,ht&VAL_SIGNED,ht&VAL_FLOAT);if(ht&VAL_MANAGED)for(let gt=0;gt<It;++gt)kt[(Lt>>>St)+gt]=tt(vt[gt]);else kt.set(vt,Lt>>>St);return Mt}_.__allocArray=ct;function ut(_t){const vt=new Uint32Array(j.buffer),ht=vt[_t+ID_OFFSET>>>2],St=nt(ht);if(!(St&ARRAYBUFFERVIEW))throw Error("not an array: "+ht);const It=st(St);var Lt=vt[_t+ARRAYBUFFERVIEW_DATASTART_OFFSET>>>2];const Mt=St&ARRAY?vt[_t+ARRAY_LENGTH_OFFSET>>>2]:vt[Lt+SIZE_OFFSET>>>2]>>>It;return lt(It,St&VAL_SIGNED,St&VAL_FLOAT).subarray(Lt>>>=It,Lt+Mt)}_.__getArrayView=ut;function dt(_t){const vt=ut(_t),ht=vt.length,St=new Array(ht);for(let It=0;It<ht;It++)St[It]=vt[It];return St}_.__getArray=dt;function ft(_t){const vt=j.buffer,ht=new Uint32Array(vt)[_t+SIZE_OFFSET>>>2];return vt.slice(_t,_t+ht)}_.__getArrayBuffer=ft;function pt(_t,vt,ht){return new _t(yt(_t,vt,ht))}function yt(_t,vt,ht){const St=j.buffer,It=new Uint32Array(St),Lt=It[ht+ARRAYBUFFERVIEW_DATASTART_OFFSET>>>2];return new _t(St,Lt,It[Lt+SIZE_OFFSET>>>2]>>>vt)}_.__getInt8Array=pt.bind(null,Int8Array,0),_.__getInt8ArrayView=yt.bind(null,Int8Array,0),_.__getUint8Array=pt.bind(null,Uint8Array,0),_.__getUint8ArrayView=yt.bind(null,Uint8Array,0),_.__getUint8ClampedArray=pt.bind(null,Uint8ClampedArray,0),_.__getUint8ClampedArrayView=yt.bind(null,Uint8ClampedArray,0),_.__getInt16Array=pt.bind(null,Int16Array,1),_.__getInt16ArrayView=yt.bind(null,Int16Array,1),_.__getUint16Array=pt.bind(null,Uint16Array,1),_.__getUint16ArrayView=yt.bind(null,Uint16Array,1),_.__getInt32Array=pt.bind(null,Int32Array,2),_.__getInt32ArrayView=yt.bind(null,Int32Array,2),_.__getUint32Array=pt.bind(null,Uint32Array,2),_.__getUint32ArrayView=yt.bind(null,Uint32Array,2),BIGINT&&(_.__getInt64Array=pt.bind(null,BigInt64Array,3),_.__getInt64ArrayView=yt.bind(null,BigInt64Array,3),_.__getUint64Array=pt.bind(null,BigUint64Array,3),_.__getUint64ArrayView=yt.bind(null,BigUint64Array,3)),_.__getFloat32Array=pt.bind(null,Float32Array,2),_.__getFloat32ArrayView=yt.bind(null,Float32Array,2),_.__getFloat64Array=pt.bind(null,Float64Array,3),_.__getFloat64ArrayView=yt.bind(null,Float64Array,3);function mt(_t,vt){const ht=new Uint32Array(j.buffer);var St=ht[_t+ID_OFFSET>>>2];if(St<=ht[rt>>>2])do if(St==vt)return!0;while(St=it(St));return!1}return _.__instanceof=mt,_.memory=_.memory||j,_.table=_.table||_e,demangle($,_)}function isResponse(_){return typeof Response<"u"&&_ instanceof Response}async function instantiate$1(_,a){return isResponse(_=await _)?instantiateStreaming(_,a):postInstantiate(preInstantiate(a||(a={})),await WebAssembly.instantiate(_ instanceof WebAssembly.Module?_:await WebAssembly.compile(_),a))}loader.instantiate=instantiate$1;function instantiateSync(_,a){return postInstantiate(preInstantiate(a||(a={})),new WebAssembly.Instance(_ instanceof WebAssembly.Module?_:new WebAssembly.Module(_),a))}loader.instantiateSync=instantiateSync;async function instantiateStreaming(_,a){return WebAssembly.instantiateStreaming?postInstantiate(preInstantiate(a||(a={})),(await WebAssembly.instantiateStreaming(_,a)).instance):instantiate$1(isResponse(_=await _)?_.arrayBuffer():_,a)}loader.instantiateStreaming=instantiateStreaming;function demangle(_,a){var $=a?Object.create(a):{},j=_.__argumentsLength?function(_e){_.__argumentsLength.value=_e}:_.__setArgumentsLength||_.__setargc||function(){};for(let _e in _){if(!Object.prototype.hasOwnProperty.call(_,_e))continue;const et=_[_e];let tt=_e.split("."),rt=$;for(;tt.length>1;){let st=tt.shift();Object.prototype.hasOwnProperty.call(rt,st)||(rt[st]={}),rt=rt[st]}let nt=tt[0],it=nt.indexOf("#");if(it>=0){let st=nt.substring(0,it),ot=rt[st];if(typeof ot>"u"||!ot.prototype){let at=function(...lt){return at.wrap(at.prototype.constructor(0,...lt))};at.prototype={valueOf:function(){return this[THIS]}},at.wrap=function(lt){return Object.create(at.prototype,{[THIS]:{value:lt,writable:!1}})},ot&&Object.getOwnPropertyNames(ot).forEach(lt=>Object.defineProperty(at,lt,Object.getOwnPropertyDescriptor(ot,lt))),rt[st]=at}if(nt=nt.substring(it+1),rt=rt[st].prototype,/^(get|set):/.test(nt)){if(!Object.prototype.hasOwnProperty.call(rt,nt=nt.substring(4))){let at=_[_e.replace("set:","get:")],lt=_[_e.replace("get:","set:")];Object.defineProperty(rt,nt,{get:function(){return at(this[THIS])},set:function(ct){lt(this[THIS],ct)},enumerable:!0})}}else nt==="constructor"?(rt[nt]=(...at)=>(j(at.length),et(...at))).original=et:(rt[nt]=function(...at){return j(at.length),et(this[THIS],...at)}).original=et}else/^(get|set):/.test(nt)?Object.prototype.hasOwnProperty.call(rt,nt=nt.substring(4))||Object.defineProperty(rt,nt,{get:_[_e.replace("set:","get:")],set:_[_e.replace("get:","set:")],enumerable:!0}):typeof et=="function"&&et!==j?(rt[nt]=(...st)=>(j(st.length),et(...st))).original=et:rt[nt]=et}return $}loader.demangle=demangle;const{instantiate}=loader;loadWebAssembly.supported=typeof WebAssembly<"u";function loadWebAssembly(_={}){if(!loadWebAssembly.supported)return null;var a=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return instantiate(new Response(new Blob([a],{type:"application/wasm"})),_)}var rabinWasm=loadWebAssembly;const Rabin=rabin$1,getRabin=rabinWasm,create$7=async(_,a,$,j,_e)=>{const et=await getRabin();return new Rabin(et,_,a,$,j,_e)};var src$4={Rabin,create:create$7};async function*rabinChunker(_,a){let $,j,_e;if(a.minChunkSize&&a.maxChunkSize&&a.avgChunkSize)_e=a.avgChunkSize,$=a.minChunkSize,j=a.maxChunkSize;else if(a.avgChunkSize)_e=a.avgChunkSize,$=_e/3,j=_e+_e/2;else throw errCode(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if($<16)throw errCode(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");j<$&&(j=$),_e<$&&(_e=$);const et=Math.floor(Math.log2(_e));for await(const tt of rabin(_,{min:$,max:j,bits:et,window:a.window,polynomial:a.polynomial}))yield tt}async function*rabin(_,a){const $=await src$4.create(a.bits,a.min,a.max,a.window),j=new Uint8ArrayList;for await(const _e of _){j.append(_e);const et=$.fingerprint(_e);for(let tt=0;tt<et.length;tt++){const rt=et[tt],nt=j.slice(0,rt);j.consume(rt),yield nt}}j.length&&(yield j.subarray(0))}async function*fixedSizeChunker(_,a){let $=new Uint8ArrayList,j=0,_e=!1;const et=a.maxChunkSize;for await(const tt of _)for($.append(tt),j+=tt.length;j>=et;)if(yield $.slice(0,et),_e=!0,et===$.length)$=new Uint8ArrayList,j=0;else{const rt=new Uint8ArrayList;rt.append($.sublist(et)),$=rt,j-=et}(!_e||j)&&(yield $.subarray(0,j))}async function*validateChunks(_){for await(const a of _){if(a.length===void 0)throw errCode(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof a=="string"||a instanceof String)yield fromString$5(a.toString());else if(Array.isArray(a))yield Uint8Array.from(a);else if(a instanceof Uint8Array)yield a;else throw errCode(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}}function isIterable(_){return Symbol.iterator in _}function isAsyncIterable(_){return Symbol.asyncIterator in _}function contentAsAsyncIterable(_){try{if(_ instanceof Uint8Array)return async function*(){yield _}();if(isIterable(_))return async function*(){yield*_}();if(isAsyncIterable(_))return _}catch{throw errCode(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw errCode(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*dagBuilder(_,a,$){for await(const j of _)if(j.path&&(j.path.substring(0,2)==="./"&&($.wrapWithDirectory=!0),j.path=j.path.split("/").filter(_e=>_e&&_e!==".").join("/")),j.content){let _e;typeof $.chunker=="function"?_e=$.chunker:$.chunker==="rabin"?_e=rabinChunker:_e=fixedSizeChunker;let et;typeof $.chunkValidator=="function"?et=$.chunkValidator:et=validateChunks;const tt={path:j.path,mtime:j.mtime,mode:j.mode,content:_e(et(contentAsAsyncIterable(j.content),$),$)};yield()=>fileBuilder(tt,a,$)}else if(j.path){const _e={path:j.path,mtime:j.mtime,mode:j.mode};yield()=>dirBuilder(_e,a,$)}else throw new Error("Import candidate must have content or path or both")}class Dir$1{constructor(a,$){this.options=$||{},this.root=a.root,this.dir=a.dir,this.path=a.path,this.dirty=a.dirty,this.flat=a.flat,this.parent=a.parent,this.parentKey=a.parentKey,this.unixfs=a.unixfs,this.mode=a.mode,this.mtime=a.mtime,this.cid=void 0,this.size=void 0}async put(a,$){}get(a){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(a){}}class DirFlat extends Dir$1{constructor(a,$){super(a,$),this._children={}}async put(a,$){this.cid=void 0,this.size=void 0,this._children[a]=$}get(a){return Promise.resolve(this._children[a])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){const a=Object.keys(this._children);for(let $=0;$<a.length;$++){const j=a[$];yield{key:j,child:this._children[j]}}}async*flush(a){const $=Object.keys(this._children),j=[];for(let it=0;it<$.length;it++){let st=this._children[$[it]];if(st instanceof Dir$1)for await(const ot of st.flush(a))st=ot,yield st;st.size!=null&&st.cid&&j.push({Name:$[it],Tsize:st.size,Hash:st.cid})}const _e=new UnixFS({type:"directory",mtime:this.mtime,mode:this.mode}),et={Data:_e.marshal(),Links:j},tt=encode$s(prepare(et)),rt=await persist$1(tt,a,this.options),nt=tt.length+et.Links.reduce((it,st)=>it+(st.Tsize==null?0:st.Tsize),0);this.cid=rt,this.size=nt,yield{cid:rt,unixfs:_e,path:this.path,size:nt}}}const BITS_PER_BYTE=7;var sparseArray=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(a,$){let j=this._internalPositionFor(a,!1);if($===void 0)j!==-1&&(this._unsetInternalPos(j),this._unsetBit(a),this._changedLength=!0,this._changedData=!0);else{let _e=!1;j===-1?(j=this._data.length,this._setBit(a),this._changedData=!0):_e=!0,this._setInternalPos(j,a,$,_e),this._changedLength=!0}}unset(a){this.set(a,void 0)}get(a){this._sortData();const $=this._internalPositionFor(a,!0);if($!==-1)return this._data[$][1]}push(a){return this.set(this.length,a),this.length}get length(){if(this._sortData(),this._changedLength){const a=this._data[this._data.length-1];this._length=a?a[0]+1:0,this._changedLength=!1}return this._length}forEach(a){let $=0;for(;$<this.length;)a(this.get($),$,this),$++}map(a){let $=0,j=new Array(this.length);for(;$<this.length;)j[$]=a(this.get($),$,this),$++;return j}reduce(a,$){let j=0,_e=$;for(;j<this.length;){const et=this.get(j);_e=a(_e,et,j),j++}return _e}find(a){let $=0,j,_e;for(;$<this.length&&!j;)_e=this.get($),j=a(_e),$++;return j?_e:void 0}_internalPositionFor(a,$){const j=this._bytePosFor(a,$);if(j>=this._bitArrays.length)return-1;const _e=this._bitArrays[j],et=a-j*BITS_PER_BYTE;if(!((_e&1<<et)>0))return-1;const rt=this._bitArrays.slice(0,j).reduce(popCountReduce,0),nt=~(4294967295<<et+1),it=popCount(_e&nt);return rt+it-1}_bytePosFor(a,$){const j=Math.floor(a/BITS_PER_BYTE),_e=j+1;for(;!$&&this._bitArrays.length<_e;)this._bitArrays.push(0);return j}_setBit(a){const $=this._bytePosFor(a,!1);this._bitArrays[$]|=1<<a-$*BITS_PER_BYTE}_unsetBit(a){const $=this._bytePosFor(a,!1);this._bitArrays[$]&=~(1<<a-$*BITS_PER_BYTE)}_setInternalPos(a,$,j,_e){const et=this._data,tt=[$,j];if(_e)this._sortData(),et[a]=tt;else{if(et.length)if(et[et.length-1][0]>=$)et.push(tt);else if(et[0][0]<=$)et.unshift(tt);else{const rt=Math.round(et.length/2);this._data=et.slice(0,rt).concat(tt).concat(et.slice(rt))}else this._data.push(tt);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(a){this._data.splice(a,1)}_sortData(){this._changedData&&this._data.sort(sortInternal),this._changedData=!1}bitField(){const a=[];let $=8,j=0,_e=0,et;const tt=this._bitArrays.slice();for(;tt.length||j;){j===0&&(et=tt.shift(),j=7);const nt=Math.min(j,$),it=~(255<<nt),st=et&it;_e|=st<<8-$,et=et>>>nt,j-=nt,$-=nt,(!$||!j&&!tt.length)&&(a.push(_e),_e=0,$=8)}for(var rt=a.length-1;rt>0&&a[rt]===0;rt--)a.pop();return a}compactArray(){return this._sortData(),this._data.map(valueOnly)}};function popCountReduce(_,a){return _+popCount(a)}function popCount(_){let a=_;return a=a-(a>>1&1431655765),a=(a&858993459)+(a>>2&858993459),(a+(a>>4)&252645135)*16843009>>24}function sortInternal(_,a){return _[0]-a[0]}function valueOnly(_){return _[1]}class Bucket{constructor(a,$,j=0){this._options=a,this._popCount=0,this._parent=$,this._posAtParent=j,this._children=new sparseArray,this.key=null}async put(a,$){const j=await this._findNewBucketAndPos(a);await j.bucket._putAt(j,a,$)}async get(a){const $=await this._findChild(a);if($!=null)return $.value}async del(a){const $=await this._findPlace(a),j=$.bucket._at($.pos);j!=null&&j.key===a&&$.bucket._delAt($.pos)}leafCount(){return this._children.compactArray().reduce(($,j)=>j instanceof Bucket?$+j.leafCount():$+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const a=this._children.compactArray();for(const $ of a)$ instanceof Bucket?yield*$.eachLeafSeries():yield $}serialize(a,$){const j=[];return $(this._children.reduce((_e,et,tt)=>(et!=null&&(et instanceof Bucket?_e.push(et.serialize(a,$)):_e.push(a(et,tt))),_e),j))}async asyncTransform(a,$){return await asyncTransformBucket(this,a,$)}toJSON(){return this.serialize(mapNode,reduceNodes)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(a){const $=await this._findPlace(a),j=$.bucket._at($.pos);if(!(j instanceof Bucket)&&j!=null&&j.key===a)return j}async _findPlace(a){const $=this._options.hash(typeof a=="string"?fromString$5(a):a),j=await $.take(this._options.bits),_e=this._children.get(j);return _e instanceof Bucket?await _e._findPlace($):{bucket:this,pos:j,hash:$,existingChild:_e}}async _findNewBucketAndPos(a){const $=await this._findPlace(a);if($.existingChild!=null&&$.existingChild.key!==a){const j=new Bucket(this._options,$.bucket,$.pos);$.bucket._putObjectAt($.pos,j);const _e=await j._findPlace($.existingChild.hash);return _e.bucket._putAt(_e,$.existingChild.key,$.existingChild.value),await j._findNewBucketAndPos($.hash)}return $}_putAt(a,$,j){this._putObjectAt(a.pos,{key:$,value:j,hash:a.hash})}_putObjectAt(a,$){this._children.get(a)==null&&this._popCount++,this._children.set(a,$)}_delAt(a){if(a===-1)throw new Error("Invalid position");this._children.get(a)!=null&&this._popCount--,this._children.unset(a),this._level()}_level(){if(this._parent!=null&&this._popCount<=1)if(this._popCount===1){const a=this._children.find(exists);if(a!=null&&!(a instanceof Bucket)){const $=a.hash;$.untake(this._options.bits);const j={pos:this._posAtParent,hash:$,bucket:this._parent};this._parent._putAt(j,a.key,a.value)}}else this._parent._delAt(this._posAtParent)}_at(a){return this._children.get(a)}}function exists(_){return Boolean(_)}function mapNode(_,a){return _.key}function reduceNodes(_){return _}async function asyncTransformBucket(_,a,$){const j=[];for(const _e of _._children.compactArray())if(_e instanceof Bucket)await asyncTransformBucket(_e,a,$);else{const et=await a(_e);j.push({bitField:_._children.bitField(),children:et})}return await $(j)}const START_MASKS=[255,254,252,248,240,224,192,128],STOP_MASKS=[1,3,7,15,31,63,127,255];class ConsumableBuffer{constructor(a){this._value=a,this._currentBytePos=a.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(a){let $=a,j=0;for(;$>0&&this._haveBits();){const _e=this._value[this._currentBytePos],et=this._currentBitPos+1,tt=Math.min(et,$),rt=byteBitsToInt(_e,et-tt,tt);j=(j<<tt)+rt,$-=tt,this._currentBitPos-=tt,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return j}untake(a){for(this._currentBitPos+=a;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function byteBitsToInt(_,a,$){const j=maskFor(a,$);return(_&j)>>>a}function maskFor(_,a){return START_MASKS[_]&STOP_MASKS[Math.min(a+_-1,7)]}function wrapHash(_){function a($){return $ instanceof InfiniteHash?$:new InfiniteHash($,_)}return a}class InfiniteHash{constructor(a,$){if(!(a instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=a,this._hashFn=$,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(a){let $=a;for(;this._availableBits<$;)await this._produceMoreBits();let j=0;for(;$>0;){const _e=this._buffers[this._currentBufferIndex],et=Math.min(_e.availableBits(),$),tt=_e.take(et);j=(j<<et)+tt,$-=et,this._availableBits-=et,_e.availableBits()===0&&this._currentBufferIndex++}return j}untake(a){let $=a;for(;$>0;){const j=this._buffers[this._currentBufferIndex],_e=Math.min(j.totalBits()-j.availableBits(),$);j.untake(_e),$-=_e,this._availableBits+=_e,this._currentBufferIndex>0&&j.totalBits()===j.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const a=this._depth>0?concat$1([this._value,Uint8Array.from([this._depth])]):this._value,$=await this._hashFn(a),j=new ConsumableBuffer($);this._buffers.push(j),this._availableBits+=j.availableBits()}}function createHAMT(_){if(_==null||_.hashFn==null)throw new Error("please define an options.hashFn");const a={bits:_.bits??8,hash:wrapHash(_.hashFn)};return new Bucket(a)}class DirSharded$1 extends Dir$1{constructor(a,$){super(a,$),this._bucket=createHAMT({hashFn:$.hamtHashFn,bits:$.hamtBucketBits})}async put(a,$){await this._bucket.put(a,$)}get(a){return this._bucket.get(a)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:a,value:$}of this._bucket.eachLeafSeries())yield{key:a,child:$}}async*flush(a){for await(const $ of flush$1(this._bucket,a,this,this.options))yield{...$,path:this.path}}}async function*flush$1(_,a,$,j){const _e=_._children,et=[];let tt=0;for(let lt=0;lt<_e.length;lt++){const ct=_e.get(lt);if(!ct)continue;const ut=lt.toString(16).toUpperCase().padStart(2,"0");if(ct instanceof Bucket){let dt;for await(const ft of await flush$1(ct,a,null,j))dt=ft;if(!dt)throw new Error("Could not flush sharded directory, no subshard found");et.push({Name:ut,Tsize:dt.size,Hash:dt.cid}),tt+=dt.size}else if(typeof ct.value.flush=="function"){const dt=ct.value;let ft;for await(const yt of dt.flush(a))ft=yt,yield ft;const pt=ut+ct.key;et.push({Name:pt,Tsize:ft.size,Hash:ft.cid}),tt+=ft.size}else{const dt=ct.value;if(!dt.cid)continue;const ft=ut+ct.key,pt=dt.size;et.push({Name:ft,Tsize:pt,Hash:dt.cid}),tt+=pt}}const rt=Uint8Array.from(_e.bitField().reverse()),nt=new UnixFS({type:"hamt-sharded-directory",data:rt,fanout:_.tableSize(),hashType:j.hamtHashCode,mtime:$&&$.mtime,mode:$&&$.mode}),it={Data:nt.marshal(),Links:et},st=encode$s(prepare(it)),ot=await persist$1(st,a,j),at=st.length+tt;yield{cid:ot,unixfs:nt,size:at}}async function flatToShard(_,a,$,j){let _e=a;a instanceof DirFlat&&a.directChildrenCount()>=$&&(_e=await convertToShard(a,j));const et=_e.parent;if(et){if(_e!==a){if(_&&(_.parent=_e),!_e.parentKey)throw new Error("No parent key found");await et.put(_e.parentKey,_e)}return flatToShard(_e,et,$,j)}return _e}async function convertToShard(_,a){const $=new DirSharded$1({root:_.root,dir:!0,parent:_.parent,parentKey:_.parentKey,path:_.path,dirty:_.dirty,flat:!1,mtime:_.mtime,mode:_.mode},a);for await(const{key:j,child:_e}of _.eachChildSeries())await $.put(j,_e);return $}const toPathComponents$2=(_="")=>(_.trim().match(/([^\\/]|\\\/)+/g)||[]).filter(Boolean);async function addToTree(_,a,$){const j=toPathComponents$2(_.path||""),_e=j.length-1;let et=a,tt="";for(let rt=0;rt<j.length;rt++){const nt=j[rt];tt+=`${tt?"/":""}${nt}`;const it=rt===_e;if(et.dirty=!0,et.cid=void 0,et.size=void 0,it)await et.put(nt,_),a=await flatToShard(null,et,$.shardSplitThreshold,$);else{let st=await et.get(nt);(!st||!(st instanceof Dir$1))&&(st=new DirFlat({root:!1,dir:!0,parent:et,parentKey:nt,path:tt,dirty:!0,flat:!0,mtime:st&&st.unixfs&&st.unixfs.mtime,mode:st&&st.unixfs&&st.unixfs.mode},$)),await et.put(nt,st),et=st}}return a}async function*flushAndYield(_,a){if(!(_ instanceof Dir$1)){_&&_.unixfs&&_.unixfs.isDirectory()&&(yield _);return}yield*_.flush(a)}async function*treeBuilder(_,a,$){let j=new DirFlat({root:!0,dir:!0,path:"",dirty:!0,flat:!0},$);for await(const _e of _)!_e||(j=await addToTree(_e,j,$),(!_e.unixfs||!_e.unixfs.isDirectory())&&(yield _e));if($.wrapWithDirectory)yield*flushAndYield(j,a);else for await(const _e of j.eachChildSeries())!_e||(yield*flushAndYield(_e.child,a))}async function*importer(_,a,$={}){const j=defaultOptions$l($);let _e;typeof $.dagBuilder=="function"?_e=$.dagBuilder:_e=dagBuilder;let et;typeof $.treeBuilder=="function"?et=$.treeBuilder:et=treeBuilder;let tt;Symbol.asyncIterator in _||Symbol.iterator in _?tt=_:tt=[_];for await(const rt of et(parallelBatch(_e(tt,a,j),j.fileImportConcurrency),a,j))yield{cid:rt.cid,path:rt.path,unixfs:rt.unixfs,size:rt.size}}async function*normaliseCandidateMultiple(_,a){if(typeof _=="string"||_ instanceof String||isBytes(_)||isBlob(_)||_._readableState)throw errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(isReadableStream(_)&&(_=browserReadableStreamToIt(_)),Symbol.iterator in _||Symbol.asyncIterator in _){const $=peekableIterator(_),{value:j,done:_e}=await $.peek();if(_e){yield*[];return}if($.push(j),Number.isInteger(j))throw errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(j._readableState){yield*map$6($,et=>toFileObject({content:et},a));return}if(isBytes(j)){yield toFileObject({content:$},a);return}if(isFileObject(j)||j[Symbol.iterator]||j[Symbol.asyncIterator]||isReadableStream(j)||isBlob(j)){yield*map$6($,et=>toFileObject(et,a));return}}throw isFileObject(_)?errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):errCode(new Error("Unexpected input: "+typeof _),"ERR_UNEXPECTED_INPUT")}async function toFileObject(_,a){const{path:$,mode:j,mtime:_e,content:et}=_,tt={path:$||"",mode:parseMode(j),mtime:parseMtime$1(_e)};return et?tt.content=await a(et):$||(tt.content=await a(_)),tt}function normaliseInput$1(_){return normaliseCandidateMultiple(_,normaliseContent$1)}const parseChunkerString=_=>{if(_)if(_.startsWith("size-")){const a=_.split("-")[1],$=parseInt(a);if(isNaN($))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:$}}else{if(_.startsWith("rabin"))return{chunker:"rabin",...parseRabinString(_)};throw new Error(`Unrecognized chunker option: ${_}`)}else return{chunker:"fixed"}},parseRabinString=_=>{const a={},$=_.split("-");switch($.length){case 1:a.avgChunkSize=262144;break;case 2:a.avgChunkSize=parseChunkSize($[1],"avg");break;case 4:a.minChunkSize=parseChunkSize($[1],"min"),a.avgChunkSize=parseChunkSize($[2],"avg"),a.maxChunkSize=parseChunkSize($[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return a},parseChunkSize=(_,a)=>{const $=parseInt(_);if(isNaN($))throw new Error(`Chunker parameter ${a} must be an integer`);return $},mergeOptions$d=mergeOptions$g.bind({ignoreUndefined:!0});function createAddAll$2({repo:_,preload:a,hashers:$,options:j}){const _e=j&&j.sharding;async function*et(tt,rt={}){const nt=mergeOptions$d({shardSplitThreshold:_e?1e3:1/0,strategy:"balanced"},rt,{...parseChunkerString(rt.chunker)});nt.hashAlg&&nt.hashAlg!=="sha2-256"&&nt.cidVersion!==1&&(nt.cidVersion=1),nt.trickle&&(nt.strategy="trickle"),nt.strategy==="trickle"&&(nt.leafType="raw",nt.reduceSingleLeafToSelf=!1),nt.cidVersion>0&&nt.rawLeaves===void 0&&(nt.rawLeaves=!0),nt.hashAlg!==void 0&&nt.rawLeaves===void 0&&(nt.rawLeaves=!0),delete nt.trickle;const it={};if(nt.progress){const lt=nt.progress;nt.progress=(ct,ut)=>{it[ut]||(it[ut]=0),it[ut]+=ct,lt(it[ut],ut)}}let st;nt.hashAlg!=null&&(st=await $.getHasher(nt.hashAlg));const ot=pipe(normaliseInput$1(tt),lt=>importer(lt,_.blocks,{...nt,hasher:st,pin:!1}),transformFile(nt),preloadFile(a,nt),pinFile(_,nt)),at=await _.gcLock.readLock();try{for await(const lt of ot){const ct=lt.path??lt.cid.toString();delete it[ct],yield{...lt,path:ct}}}finally{at()}}return withTimeoutOption(et)}function transformFile(_){async function*a($){for await(const j of $){let _e=j.cid;_.cidVersion===1&&(_e=_e.toV1());let et=j.path?j.path:_e.toString();_.wrapWithDirectory&&!j.path&&(et=""),yield{path:et,cid:_e,size:j.size,mode:j.unixfs&&j.unixfs.mode,mtime:j.unixfs&&j.unixfs.mtime}}}return a}function preloadFile(_,a){async function*$(j){for await(const _e of j)(!_e.path||a.wrapWithDirectory?_e.path==="":!_e.path.includes("/"))&&!a.onlyHash&&a.preload!==!1&&_(_e.cid),yield _e}return $}function pinFile(_,a){async function*$(j){for await(const _e of j){const et=!(_e.path&&_e.path.includes("/"));(a.pin==null?!0:a.pin)&&et&&!a.onlyHash&&await _.pins.pinRecursively(_e.cid),yield _e}}return $}const hashFn=async function(_){return(await murmur3128.encode(_)).slice(0,8).reverse()},addLinksToHamtBucket$1=(_,a,$)=>Promise.all(_.map(j=>{if(j.Name==null)throw new Error("Unexpected Link without a Name");if(j.Name.length===2){const _e=parseInt(j.Name,16);return a._putObjectAt(_e,new Bucket({hash:$._options.hash,bits:$._options.bits},a,_e))}return $.put(j.Name.substring(2),!0)})),toPrefix$1=_=>_.toString(16).toUpperCase().padStart(2,"0").substring(0,2),toBucketPath$1=_=>{let a=_.bucket;const $=[];for(;a._parent;)$.push(a),a=a._parent;return $.push(a),$.reverse()},findShardCid=async(_,a,$,j,_e)=>{if(!j){const st=createHAMT({hashFn});j={rootBucket:st,hamtDepth:1,lastBucket:st}}await addLinksToHamtBucket$1(_.Links,j.lastBucket,j.rootBucket);const et=await j.rootBucket._findNewBucketAndPos(a);let tt=toPrefix$1(et.pos);const rt=toBucketPath$1(et);rt.length>j.hamtDepth&&(j.lastBucket=rt[j.hamtDepth],tt=toPrefix$1(j.lastBucket._posAtParent));const nt=_.Links.find(st=>{if(st.Name==null)return!1;const ot=st.Name.substring(0,2),at=st.Name.substring(2);return!(ot!==tt||at&&at!==a)});if(!nt)return null;if(nt.Name!=null&&nt.Name.substring(2)===a)return nt.Hash;j.hamtDepth++;const it=await $.get(nt.Hash,_e);return _=decode$m(it),findShardCid(_,a,$,j,_e)};function extractDataFromBlock(_,a,$,j){const _e=_.length,et=a+_e;return $>=et||j<a?new Uint8Array(0):(j>=a&&j<et&&(_=_.subarray(0,j-a)),$>=a&&$<et&&(_=_.subarray($-a)),_)}const validateOffsetAndLength=(_,a,$)=>{if(a||(a=0),a<0)throw errCode(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(a>_)throw errCode(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!$&&$!==0&&($=_-a),$<0)throw errCode(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return a+$>_&&($=_-a),{offset:a,length:$}};async function walkDAG(_,a,$,j,_e,et,tt,rt){if(a instanceof Uint8Array){$.push(extractDataFromBlock(a,j,_e,et));return}if(a.Data==null)throw errCode(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let nt;try{nt=UnixFS.unmarshal(a.Data)}catch(st){throw errCode(st,"ERR_NOT_UNIXFS")}if(nt.data!=null){const st=nt.data,ot=extractDataFromBlock(st,j,_e,et);$.push(ot),j+=ot.byteLength}const it=[];for(let st=0;st<a.Links.length;st++){const ot=a.Links[st],at=j,lt=at+nt.blockSizes[st];if((_e>=at&&_e<lt||et>=at&&et<=lt||_e<at&&et>lt)&&it.push({link:ot,blockStart:j}),j=lt,j>et)break}await pipe(it,st=>map$6(st,ot=>async()=>{const at=await _.get(ot.link.Hash,{signal:rt.signal});return{...ot,block:at}}),st=>parallel$2(st,{ordered:!0}),async st=>{for await(const{link:ot,block:at,blockStart:lt}of st){let ct;switch(ot.Hash.code){case code$9:ct=decode$m(at);break;case code$4:ct=at;break;default:$.end(errCode(new Error(`Unsupported codec: ${ot.Hash.code}`),"ERR_NOT_UNIXFS"));return}tt.add(async()=>{await walkDAG(_,ct,$,lt,_e,et,tt,rt)})}})}const fileContent=(_,a,$,j,_e,et,tt)=>{async function*rt(nt={}){const it=$.fileSize();if(it===void 0)throw new Error("File was a directory");const{offset:st,length:ot}=validateOffsetAndLength(it,nt.offset,nt.length);if(ot===0)return;const at=new PQueue({concurrency:1}),lt=pushable$2();at.add(async()=>{await walkDAG(tt,a,lt,0,st,st+ot,at,nt)}),at.on("error",ut=>{lt.end(ut)});let ct=0;for await(const ut of lt)ut!=null&&(ct+=ut.byteLength,ct===ot&&lt.end(),yield ut)}return rt},directoryContent=(_,a,$,j,_e,et,tt)=>{async function*rt(nt={}){const it=nt.offset||0,st=nt.length||a.Links.length,ot=a.Links.slice(it,st);for(const at of ot){const lt=await _e(at.Hash,at.Name||"",`${j}/${at.Name||""}`,[],et+1,tt,nt);lt.entry&&(yield lt.entry)}}return rt},hamtShardedDirectoryContent=(_,a,$,j,_e,et,tt)=>{function rt(nt={}){return listDirectory(a,j,_e,et,tt,nt)}return rt};async function*listDirectory(_,a,$,j,_e,et){const tt=_.Links;for(const rt of tt){const nt=rt.Name!=null?rt.Name.substring(2):null;if(nt)yield(await $(rt.Hash,nt,`${a}/${nt}`,[],j+1,_e,et)).entry;else{const it=await _e.get(rt.Hash);_=decode$m(it);for await(const st of listDirectory(_,a,$,j,_e,et))yield st}}}const findLinkCid=(_,a)=>{const $=_.Links.find(j=>j.Name===a);return $&&$.Hash},contentExporters={raw:fileContent,file:fileContent,directory:directoryContent,"hamt-sharded-directory":hamtShardedDirectoryContent,metadata:(_,a,$,j,_e,et,tt)=>()=>[],symlink:(_,a,$,j,_e,et,tt)=>()=>[]},unixFsResolver=async(_,a,$,j,_e,et,tt,rt)=>{const nt=await tt.get(_,rt),it=decode$m(nt);let st,ot;if(a||(a=_.toString()),it.Data==null)throw errCode(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{st=UnixFS.unmarshal(it.Data)}catch(at){throw errCode(at,"ERR_NOT_UNIXFS")}if($||($=a),j.length){let at;if(st&&st.type==="hamt-sharded-directory"?at=await findShardCid(it,j[0],tt):at=findLinkCid(it,j[0]),!at)throw errCode(new Error("file does not exist"),"ERR_NOT_FOUND");const lt=j.shift(),ct=`${$}/${lt}`;ot={cid:at,toResolve:j,name:lt||"",path:ct}}return{entry:{type:st.isDirectory()?"directory":"file",name:a,path:$,cid:_,content:contentExporters[st.type](_,it,st,$,_e,et,tt),unixfs:st,depth:et,node:it,size:st.fileSize()},next:ot}},rawContent$1=_=>{async function*a($={}){const{offset:j,length:_e}=validateOffsetAndLength(_.length,$.offset,$.length);yield extractDataFromBlock(_,0,j,j+_e)}return a},resolve$4=async(_,a,$,j,_e,et,tt,rt)=>{if(j.length)throw errCode(new Error(`No link named ${$} found in raw node ${_}`),"ERR_NOT_FOUND");const nt=await tt.get(_,rt);return{entry:{type:"raw",name:a,path:$,cid:_,content:rawContent$1(nt),depth:et,size:nt.length,node:nt}}},resolve$3=async(_,a,$,j,_e,et,tt,rt)=>{const nt=await tt.get(_),it=decode$k(nt);let st=it,ot=$;for(;j.length;){const at=j[0];if(at in st){j.shift(),ot=`${ot}/${at}`;const lt=CID.asCID(st[at]);if(lt)return{entry:{type:"object",name:a,path:$,cid:_,node:nt,depth:et,size:nt.length,content:async function*(){yield it}},next:{cid:lt,name:at,path:ot,toResolve:j}};st=st[at]}else throw errCode(new Error(`No property named ${at} found in cbor node ${_}`),"ERR_NO_PROP")}return{entry:{type:"object",name:a,path:$,cid:_,node:nt,depth:et,size:nt.length,content:async function*(){yield it}}}},rawContent=_=>{async function*a($={}){const{offset:j,length:_e}=validateOffsetAndLength(_.length,$.offset,$.length);yield extractDataFromBlock(_,0,j,j+_e)}return a},resolve$2=async(_,a,$,j,_e,et,tt,rt)=>{if(j.length)throw errCode(new Error(`No link named ${$} found in raw node ${_}`),"ERR_NOT_FOUND");const nt=await decode$n(_.multihash.bytes);return{entry:{type:"identity",name:a,path:$,cid:_,content:rawContent(nt.digest),depth:et,size:nt.digest.length,node:nt.digest}}},resolvers={[code$9]:unixFsResolver,[code$4]:resolve$4,[code$8]:resolve$3,[identity$8.code]:resolve$2};function resolve$1(_,a,$,j,_e,et,tt){const rt=resolvers[_.code];if(!rt)throw errCode(new Error(`No resolver for code ${_.code}`),"ERR_NO_RESOLVER");return rt(_,a,$,j,resolve$1,_e,et,tt)}const toPathComponents$1=(_="")=>(_.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),cidAndRest=_=>{if(_ instanceof Uint8Array)return{cid:CID.decode(_),toResolve:[]};const a=CID.asCID(_);if(a)return{cid:a,toResolve:[]};if(typeof _=="string"){_.indexOf("/ipfs/")===0&&(_=_.substring(6));const $=toPathComponents$1(_);return{cid:CID.parse($[0]),toResolve:$.slice(1)}}throw errCode(new Error(`Unknown path type ${_}`),"ERR_BAD_PATH")};async function*walkPath(_,a,$={}){let{cid:j,toResolve:_e}=cidAndRest(_),et=j.toString(),tt=et;const rt=_e.length;for(;;){const nt=await resolve$1(j,et,tt,_e,rt,a,$);if(!nt.entry&&!nt.next)throw errCode(new Error(`Could not resolve ${_}`),"ERR_NOT_FOUND");if(nt.entry&&(yield nt.entry),!nt.next)return;_e=nt.next.toResolve,j=nt.next.cid,et=nt.next.name,tt=nt.next.path}}async function exporter(_,a,$={}){const j=await last(walkPath(_,a,$));if(!j)throw errCode(new Error(`Could not resolve ${_}`),"ERR_NOT_FOUND");return j}async function*recursive(_,a,$={}){const j=await exporter(_,a,$);if(!j)return;if(yield j,j.type==="directory")for await(const et of _e(j,$))yield et;async function*_e(et,tt){for await(const rt of et.content(tt))yield rt,!(rt instanceof Uint8Array)&&rt.type==="directory"&&(yield*_e(rt,tt))}}function createCat$1({repo:_,preload:a}){async function*$(j,_e={}){if(j=normalizeCidPath(j),_e.preload!==!1){const tt=j.split("/");a(CID.parse(tt[0]))}const et=await exporter(j,_.blocks,_e);if(et.type==="directory")throw new Error("this dag node is a directory");if(!et.content)throw new Error("this dag node has no content");yield*et.content(_e)}return withTimeoutOption($)}function compare$1(_,a){for(let $=0;$<_.byteLength;$++){if(_[$]<a[$])return-1;if(_[$]>a[$])return 1}return _.byteLength>a.byteLength?1:_.byteLength<a.byteLength?-1:0}fromString$5("ustar\0","binary");fromString$5("ustar ","binary");fromString$5(" \0","binary");function reader$1(_){const a=async function*(){let $=yield,j=new Uint8ArrayList;for await(const _e of _){if($==null){j.append(_e),$=yield j,j=new Uint8ArrayList;continue}for(j.append(_e);j.length>=$;){const et=j.sublist(0,$);if(j.consume($),$=yield et,$==null){j.length>0&&($=yield j,j=new Uint8ArrayList);break}}}if($!=null)throw Object.assign(new Error(`stream ended before ${$} bytes became available`),{code:"ERR_UNDER_READ",buffer:j})}();return a.next(),a}var index_browser={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:8,RTLD_LOCAL:4,E2BIG:7,EACCES:13,EADDRINUSE:48,EADDRNOTAVAIL:49,EAFNOSUPPORT:47,EAGAIN:35,EALREADY:37,EBADF:9,EBADMSG:94,EBUSY:16,ECANCELED:89,ECHILD:10,ECONNABORTED:53,ECONNREFUSED:61,ECONNRESET:54,EDEADLK:11,EDESTADDRREQ:39,EDOM:33,EDQUOT:69,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:65,EIDRM:90,EILSEQ:92,EINPROGRESS:36,EINTR:4,EINVAL:22,EIO:5,EISCONN:56,EISDIR:21,ELOOP:62,EMFILE:24,EMLINK:31,EMSGSIZE:40,EMULTIHOP:95,ENAMETOOLONG:63,ENETDOWN:50,ENETRESET:52,ENETUNREACH:51,ENFILE:23,ENOBUFS:55,ENODATA:96,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:77,ENOLINK:97,ENOMEM:12,ENOMSG:91,ENOPROTOOPT:42,ENOSPC:28,ENOSR:98,ENOSTR:99,ENOSYS:78,ENOTCONN:57,ENOTDIR:20,ENOTEMPTY:66,ENOTSOCK:38,ENOTSUP:45,ENOTTY:25,ENXIO:6,EOPNOTSUPP:102,EOVERFLOW:84,EPERM:1,EPIPE:32,EPROTO:100,EPROTONOSUPPORT:43,EPROTOTYPE:41,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:70,ETIME:101,ETIMEDOUT:60,ETXTBSY:26,EWOULDBLOCK:35,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:10,SIGFPE:8,SIGKILL:9,SIGUSR1:30,SIGSEGV:11,SIGUSR2:31,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:20,SIGCONT:19,SIGSTOP:17,SIGTSTP:18,SIGTTIN:21,SIGTTOU:22,SIGURG:16,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:23,SIGINFO:29,SIGSYS:12,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:512,O_EXCL:2048,UV_FS_O_FILEMAP:0,O_NOCTTY:131072,O_TRUNC:1024,O_APPEND:8,O_DIRECTORY:1048576,O_NOFOLLOW:256,O_SYNC:128,O_DSYNC:4194304,O_SYMLINK:2097152,O_NONBLOCK:4,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488351,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6};async function toBuffer(_){let a=new Uint8Array(0);for await(const $ of _)a=concat$1([a,$],a.length+$.length);return a}const ZEROS="0000000000000000000",SEVENS="7777777777777777777",ZERO_OFFSET="0".charCodeAt(0),USTAR_MAGIC=fromString$5("ustar\0","binary"),USTAR_VER=fromString$5("00","binary"),MASK=parseInt("7777",8),MAGIC_OFFSET=257,VERSION_OFFSET=263,toTypeflag=function(_){switch(_){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72;default:return 0}},cksum=function(_){let a=256;for(let $=0;$<148;$++)a+=_[$];for(let $=156;$<512;$++)a+=_[$];return a},encodeOct=function(_,a){const $=_.toString(8);return $.length>a?fromString$5(SEVENS.slice(0,a)+" "):fromString$5(ZEROS.slice(0,a-$.length)+$+" ")},addLength=function(_){const a=fromString$5(_).byteLength;let $=Math.floor(Math.log(a)/Math.log(10))+1;return a+$>=Math.pow(10,$)&&$++,`${a+$}${_}`};function encodePax$1(_){let a="";_.name!=null&&(a+=addLength(" path="+_.name+`
`)),_.linkname!=null&&(a+=addLength(" linkpath="+_.linkname+`
`));const $=_.pax;if($!=null)for(const j in $)Object.prototype.hasOwnProperty.call($,j)&&(a+=addLength(" "+j+"="+$[j]+`
`));return fromString$5(a)}function encode$f(_){const a=new Uint8Array(512);let $=_.name,j="";if(_.typeflag===5&&$[$.length-1]!=="/"&&($+="/"),fromString$5($).byteLength!==$.length)return null;for(;fromString$5($).byteLength>100;){const _e=$.indexOf("/");if(_e===-1)return null;j+=j!==""?"/"+$.slice(0,_e):$.slice(0,_e),$=$.slice(_e+1)}return fromString$5($).byteLength>100||fromString$5(j).byteLength>155||_.linkname!=null&&fromString$5(_.linkname).byteLength>100?null:(a.set(fromString$5($),0),a.set(encodeOct(_.mode&MASK,6),100),a.set(encodeOct(_.uid,6),108),a.set(encodeOct(_.gid,6),116),a.set(encodeOct(_.size,11),124),a.set(encodeOct(_.mtime.getTime()/1e3|0,11),136),a[156]=ZERO_OFFSET+toTypeflag(_.type),_.linkname!=null&&a.set(fromString$5(_.linkname),157),a.set(USTAR_MAGIC,MAGIC_OFFSET),a.set(USTAR_VER,VERSION_OFFSET),_.uname!=null&&a.set(fromString$5(_.uname),265),_.gname!=null&&a.set(fromString$5(_.gname),297),a.set(encodeOct(_.devmajor??0,6),329),a.set(encodeOct(_.devminor??0,6),337),j!=null&&a.set(fromString$5(j),345),a.set(encodeOct(cksum(a),6),148),a)}const{S_IFMT,S_IFBLK,S_IFCHR,S_IFDIR,S_IFIFO,S_IFLNK}=index_browser,DMODE=parseInt("755",8),FMODE=parseInt("644",8),END_OF_TAR=new Uint8Array(1024);function modeToType(_=0){switch(_&S_IFMT){case S_IFBLK:return"block-device";case S_IFCHR:return"character-device";case S_IFDIR:return"directory";case S_IFIFO:return"fifo";case S_IFLNK:return"symlink";default:return"file"}}function getPadding(_){return _&=511,_!==0?END_OF_TAR.subarray(0,512-_):new Uint8Array(0)}function encode$e(_){if(_.pax==null){const a=encode$f(_);if(a!=null)return a}return encodePax(_)}function encodePax(_){const a=encodePax$1(_),$={name:"PaxHeader",mode:_.mode,uid:_.uid,gid:_.gid,size:a.length,mtime:_.mtime,type:"pax-header",linkname:_.linkname,uname:_.uname,gname:_.gname,devmajor:_.devmajor,devminor:_.devminor};return new Uint8ArrayList(encode$f($)??new Uint8Array(0),a,getPadding(a.length),encode$f({...$,size:_.size,type:_.type})??new Uint8Array(0)).subarray()}function pack(){return async function*(_){for await(let{header:a,body:$}of _){const j={...a,size:a.type==="symlink"?0:a.size??0,type:a.type??modeToType(a.mode),mode:a.mode??(a.type==="directory"?DMODE:FMODE),uid:a.uid??0,gid:a.gid??0,mtime:a.mtime??new Date};if(typeof $=="string"&&($=fromString$5($)),$ instanceof Uint8Array||isUint8ArrayList($)){j.size=$.length,yield encode$e(j),yield isUint8ArrayList($)?$.subarray():$,yield getPadding(j.size);continue}if(j.type==="symlink"&&j.linkname==null){if($==null)throw new Error("type was symlink but no linkname or body specified");j.linkname=toString$6(await toBuffer($)),yield encode$e(j);continue}if(yield encode$e(j),j.type!=="file"&&j.type!=="contiguous-file")continue;let _e=0;for await(const et of $??[])_e+=et.length,yield isUint8ArrayList(et)?et.subarray():et;if(_e!==j.size)throw new Error(`size mismatch, wrote ${_e} of ${j.size} bytes`);yield getPadding(j.size)}yield END_OF_TAR}}/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(_){let a=_.length;for(;--a>=0;)_[a]=0}const STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),extra_dbits=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),extra_blbits=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bl_order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);const static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);const _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);const _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);const base_length=new Array(LENGTH_CODES$1);zero$1(base_length);const base_dist=new Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(_,a,$,j,_e){this.static_tree=_,this.extra_bits=a,this.extra_base=$,this.elems=j,this.max_length=_e,this.has_stree=_&&_.length}let static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(_,a){this.dyn_tree=_,this.max_code=0,this.stat_desc=a}const d_code=_=>_<256?_dist_code[_]:_dist_code[256+(_>>>7)],put_short=(_,a)=>{_.pending_buf[_.pending++]=a&255,_.pending_buf[_.pending++]=a>>>8&255},send_bits=(_,a,$)=>{_.bi_valid>Buf_size-$?(_.bi_buf|=a<<_.bi_valid&65535,put_short(_,_.bi_buf),_.bi_buf=a>>Buf_size-_.bi_valid,_.bi_valid+=$-Buf_size):(_.bi_buf|=a<<_.bi_valid&65535,_.bi_valid+=$)},send_code=(_,a,$)=>{send_bits(_,$[a*2],$[a*2+1])},bi_reverse=(_,a)=>{let $=0;do $|=_&1,_>>>=1,$<<=1;while(--a>0);return $>>>1},bi_flush=_=>{_.bi_valid===16?(put_short(_,_.bi_buf),_.bi_buf=0,_.bi_valid=0):_.bi_valid>=8&&(_.pending_buf[_.pending++]=_.bi_buf&255,_.bi_buf>>=8,_.bi_valid-=8)},gen_bitlen=(_,a)=>{const $=a.dyn_tree,j=a.max_code,_e=a.stat_desc.static_tree,et=a.stat_desc.has_stree,tt=a.stat_desc.extra_bits,rt=a.stat_desc.extra_base,nt=a.stat_desc.max_length;let it,st,ot,at,lt,ct,ut=0;for(at=0;at<=MAX_BITS$1;at++)_.bl_count[at]=0;for($[_.heap[_.heap_max]*2+1]=0,it=_.heap_max+1;it<HEAP_SIZE$1;it++)st=_.heap[it],at=$[$[st*2+1]*2+1]+1,at>nt&&(at=nt,ut++),$[st*2+1]=at,!(st>j)&&(_.bl_count[at]++,lt=0,st>=rt&&(lt=tt[st-rt]),ct=$[st*2],_.opt_len+=ct*(at+lt),et&&(_.static_len+=ct*(_e[st*2+1]+lt)));if(ut!==0){do{for(at=nt-1;_.bl_count[at]===0;)at--;_.bl_count[at]--,_.bl_count[at+1]+=2,_.bl_count[nt]--,ut-=2}while(ut>0);for(at=nt;at!==0;at--)for(st=_.bl_count[at];st!==0;)ot=_.heap[--it],!(ot>j)&&($[ot*2+1]!==at&&(_.opt_len+=(at-$[ot*2+1])*$[ot*2],$[ot*2+1]=at),st--)}},gen_codes=(_,a,$)=>{const j=new Array(MAX_BITS$1+1);let _e=0,et,tt;for(et=1;et<=MAX_BITS$1;et++)j[et]=_e=_e+$[et-1]<<1;for(tt=0;tt<=a;tt++){let rt=_[tt*2+1];rt!==0&&(_[tt*2]=bi_reverse(j[rt]++,rt))}},tr_static_init=()=>{let _,a,$,j,_e;const et=new Array(MAX_BITS$1+1);for($=0,j=0;j<LENGTH_CODES$1-1;j++)for(base_length[j]=$,_=0;_<1<<extra_lbits[j];_++)_length_code[$++]=j;for(_length_code[$-1]=j,_e=0,j=0;j<16;j++)for(base_dist[j]=_e,_=0;_<1<<extra_dbits[j];_++)_dist_code[_e++]=j;for(_e>>=7;j<D_CODES$1;j++)for(base_dist[j]=_e<<7,_=0;_<1<<extra_dbits[j]-7;_++)_dist_code[256+_e++]=j;for(a=0;a<=MAX_BITS$1;a++)et[a]=0;for(_=0;_<=143;)static_ltree[_*2+1]=8,_++,et[8]++;for(;_<=255;)static_ltree[_*2+1]=9,_++,et[9]++;for(;_<=279;)static_ltree[_*2+1]=7,_++,et[7]++;for(;_<=287;)static_ltree[_*2+1]=8,_++,et[8]++;for(gen_codes(static_ltree,L_CODES$1+1,et),_=0;_<D_CODES$1;_++)static_dtree[_*2+1]=5,static_dtree[_*2]=bi_reverse(_,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)},init_block=_=>{let a;for(a=0;a<L_CODES$1;a++)_.dyn_ltree[a*2]=0;for(a=0;a<D_CODES$1;a++)_.dyn_dtree[a*2]=0;for(a=0;a<BL_CODES$1;a++)_.bl_tree[a*2]=0;_.dyn_ltree[END_BLOCK*2]=1,_.opt_len=_.static_len=0,_.last_lit=_.matches=0},bi_windup=_=>{_.bi_valid>8?put_short(_,_.bi_buf):_.bi_valid>0&&(_.pending_buf[_.pending++]=_.bi_buf),_.bi_buf=0,_.bi_valid=0},copy_block=(_,a,$,j)=>{bi_windup(_),j&&(put_short(_,$),put_short(_,~$)),_.pending_buf.set(_.window.subarray(a,a+$),_.pending),_.pending+=$},smaller=(_,a,$,j)=>{const _e=a*2,et=$*2;return _[_e]<_[et]||_[_e]===_[et]&&j[a]<=j[$]},pqdownheap=(_,a,$)=>{const j=_.heap[$];let _e=$<<1;for(;_e<=_.heap_len&&(_e<_.heap_len&&smaller(a,_.heap[_e+1],_.heap[_e],_.depth)&&_e++,!smaller(a,j,_.heap[_e],_.depth));)_.heap[$]=_.heap[_e],$=_e,_e<<=1;_.heap[$]=j},compress_block=(_,a,$)=>{let j,_e,et=0,tt,rt;if(_.last_lit!==0)do j=_.pending_buf[_.d_buf+et*2]<<8|_.pending_buf[_.d_buf+et*2+1],_e=_.pending_buf[_.l_buf+et],et++,j===0?send_code(_,_e,a):(tt=_length_code[_e],send_code(_,tt+LITERALS$1+1,a),rt=extra_lbits[tt],rt!==0&&(_e-=base_length[tt],send_bits(_,_e,rt)),j--,tt=d_code(j),send_code(_,tt,$),rt=extra_dbits[tt],rt!==0&&(j-=base_dist[tt],send_bits(_,j,rt)));while(et<_.last_lit);send_code(_,END_BLOCK,a)},build_tree=(_,a)=>{const $=a.dyn_tree,j=a.stat_desc.static_tree,_e=a.stat_desc.has_stree,et=a.stat_desc.elems;let tt,rt,nt=-1,it;for(_.heap_len=0,_.heap_max=HEAP_SIZE$1,tt=0;tt<et;tt++)$[tt*2]!==0?(_.heap[++_.heap_len]=nt=tt,_.depth[tt]=0):$[tt*2+1]=0;for(;_.heap_len<2;)it=_.heap[++_.heap_len]=nt<2?++nt:0,$[it*2]=1,_.depth[it]=0,_.opt_len--,_e&&(_.static_len-=j[it*2+1]);for(a.max_code=nt,tt=_.heap_len>>1;tt>=1;tt--)pqdownheap(_,$,tt);it=et;do tt=_.heap[1],_.heap[1]=_.heap[_.heap_len--],pqdownheap(_,$,1),rt=_.heap[1],_.heap[--_.heap_max]=tt,_.heap[--_.heap_max]=rt,$[it*2]=$[tt*2]+$[rt*2],_.depth[it]=(_.depth[tt]>=_.depth[rt]?_.depth[tt]:_.depth[rt])+1,$[tt*2+1]=$[rt*2+1]=it,_.heap[1]=it++,pqdownheap(_,$,1);while(_.heap_len>=2);_.heap[--_.heap_max]=_.heap[1],gen_bitlen(_,a),gen_codes($,nt,_.bl_count)},scan_tree=(_,a,$)=>{let j,_e=-1,et,tt=a[0*2+1],rt=0,nt=7,it=4;for(tt===0&&(nt=138,it=3),a[($+1)*2+1]=65535,j=0;j<=$;j++)et=tt,tt=a[(j+1)*2+1],!(++rt<nt&&et===tt)&&(rt<it?_.bl_tree[et*2]+=rt:et!==0?(et!==_e&&_.bl_tree[et*2]++,_.bl_tree[REP_3_6*2]++):rt<=10?_.bl_tree[REPZ_3_10*2]++:_.bl_tree[REPZ_11_138*2]++,rt=0,_e=et,tt===0?(nt=138,it=3):et===tt?(nt=6,it=3):(nt=7,it=4))},send_tree=(_,a,$)=>{let j,_e=-1,et,tt=a[0*2+1],rt=0,nt=7,it=4;for(tt===0&&(nt=138,it=3),j=0;j<=$;j++)if(et=tt,tt=a[(j+1)*2+1],!(++rt<nt&&et===tt)){if(rt<it)do send_code(_,et,_.bl_tree);while(--rt!==0);else et!==0?(et!==_e&&(send_code(_,et,_.bl_tree),rt--),send_code(_,REP_3_6,_.bl_tree),send_bits(_,rt-3,2)):rt<=10?(send_code(_,REPZ_3_10,_.bl_tree),send_bits(_,rt-3,3)):(send_code(_,REPZ_11_138,_.bl_tree),send_bits(_,rt-11,7));rt=0,_e=et,tt===0?(nt=138,it=3):et===tt?(nt=6,it=3):(nt=7,it=4)}},build_bl_tree=_=>{let a;for(scan_tree(_,_.dyn_ltree,_.l_desc.max_code),scan_tree(_,_.dyn_dtree,_.d_desc.max_code),build_tree(_,_.bl_desc),a=BL_CODES$1-1;a>=3&&_.bl_tree[bl_order[a]*2+1]===0;a--);return _.opt_len+=3*(a+1)+5+5+4,a},send_all_trees=(_,a,$,j)=>{let _e;for(send_bits(_,a-257,5),send_bits(_,$-1,5),send_bits(_,j-4,4),_e=0;_e<j;_e++)send_bits(_,_.bl_tree[bl_order[_e]*2+1],3);send_tree(_,_.dyn_ltree,a-1),send_tree(_,_.dyn_dtree,$-1)},detect_data_type=_=>{let a=4093624447,$;for($=0;$<=31;$++,a>>>=1)if(a&1&&_.dyn_ltree[$*2]!==0)return Z_BINARY;if(_.dyn_ltree[9*2]!==0||_.dyn_ltree[10*2]!==0||_.dyn_ltree[13*2]!==0)return Z_TEXT;for($=32;$<LITERALS$1;$++)if(_.dyn_ltree[$*2]!==0)return Z_TEXT;return Z_BINARY};let static_init_done=!1;const _tr_init$1=_=>{static_init_done||(tr_static_init(),static_init_done=!0),_.l_desc=new TreeDesc(_.dyn_ltree,static_l_desc),_.d_desc=new TreeDesc(_.dyn_dtree,static_d_desc),_.bl_desc=new TreeDesc(_.bl_tree,static_bl_desc),_.bi_buf=0,_.bi_valid=0,init_block(_)},_tr_stored_block$1=(_,a,$,j)=>{send_bits(_,(STORED_BLOCK<<1)+(j?1:0),3),copy_block(_,a,$,!0)},_tr_align$1=_=>{send_bits(_,STATIC_TREES<<1,3),send_code(_,END_BLOCK,static_ltree),bi_flush(_)},_tr_flush_block$1=(_,a,$,j)=>{let _e,et,tt=0;_.level>0?(_.strm.data_type===Z_UNKNOWN$1&&(_.strm.data_type=detect_data_type(_)),build_tree(_,_.l_desc),build_tree(_,_.d_desc),tt=build_bl_tree(_),_e=_.opt_len+3+7>>>3,et=_.static_len+3+7>>>3,et<=_e&&(_e=et)):_e=et=$+5,$+4<=_e&&a!==-1?_tr_stored_block$1(_,a,$,j):_.strategy===Z_FIXED$1||et===_e?(send_bits(_,(STATIC_TREES<<1)+(j?1:0),3),compress_block(_,static_ltree,static_dtree)):(send_bits(_,(DYN_TREES<<1)+(j?1:0),3),send_all_trees(_,_.l_desc.max_code+1,_.d_desc.max_code+1,tt+1),compress_block(_,_.dyn_ltree,_.dyn_dtree)),init_block(_),j&&bi_windup(_)},_tr_tally$1=(_,a,$)=>(_.pending_buf[_.d_buf+_.last_lit*2]=a>>>8&255,_.pending_buf[_.d_buf+_.last_lit*2+1]=a&255,_.pending_buf[_.l_buf+_.last_lit]=$&255,_.last_lit++,a===0?_.dyn_ltree[$*2]++:(_.matches++,a--,_.dyn_ltree[(_length_code[$]+LITERALS$1+1)*2]++,_.dyn_dtree[d_code(a)*2]++),_.last_lit===_.lit_bufsize-1);var _tr_init_1=_tr_init$1,_tr_stored_block_1=_tr_stored_block$1,_tr_flush_block_1=_tr_flush_block$1,_tr_tally_1=_tr_tally$1,_tr_align_1=_tr_align$1,trees={_tr_init:_tr_init_1,_tr_stored_block:_tr_stored_block_1,_tr_flush_block:_tr_flush_block_1,_tr_tally:_tr_tally_1,_tr_align:_tr_align_1};const adler32=(_,a,$,j)=>{let _e=_&65535|0,et=_>>>16&65535|0,tt=0;for(;$!==0;){tt=$>2e3?2e3:$,$-=tt;do _e=_e+a[j++]|0,et=et+_e|0;while(--tt);_e%=65521,et%=65521}return _e|et<<16|0};var adler32_1=adler32;const makeTable=()=>{let _,a=[];for(var $=0;$<256;$++){_=$;for(var j=0;j<8;j++)_=_&1?3988292384^_>>>1:_>>>1;a[$]=_}return a},crcTable=new Uint32Array(makeTable()),crc32=(_,a,$,j)=>{const _e=crcTable,et=j+$;_^=-1;for(let tt=j;tt<et;tt++)_=_>>>8^_e[(_^a[tt])&255];return _^-1};var crc32_1=crc32,messages$1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init,_tr_stored_block,_tr_flush_block,_tr_tally,_tr_align}=trees,{Z_NO_FLUSH:Z_NO_FLUSH$2,Z_PARTIAL_FLUSH,Z_FULL_FLUSH:Z_FULL_FLUSH$1,Z_FINISH:Z_FINISH$3,Z_BLOCK:Z_BLOCK$1,Z_OK:Z_OK$3,Z_STREAM_END:Z_STREAM_END$3,Z_STREAM_ERROR:Z_STREAM_ERROR$2,Z_DATA_ERROR:Z_DATA_ERROR$2,Z_BUF_ERROR:Z_BUF_ERROR$1,Z_DEFAULT_COMPRESSION:Z_DEFAULT_COMPRESSION$1,Z_FILTERED,Z_HUFFMAN_ONLY,Z_RLE,Z_FIXED,Z_DEFAULT_STRATEGY:Z_DEFAULT_STRATEGY$1,Z_UNKNOWN,Z_DEFLATED:Z_DEFLATED$2}=constants$2,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3,err=(_,a)=>(_.msg=messages$1[a],a),rank=_=>(_<<1)-(_>4?9:0),zero=_=>{let a=_.length;for(;--a>=0;)_[a]=0};let HASH_ZLIB=(_,a,$)=>(a<<_.hash_shift^$)&_.hash_mask,HASH=HASH_ZLIB;const flush_pending=_=>{const a=_.state;let $=a.pending;$>_.avail_out&&($=_.avail_out),$!==0&&(_.output.set(a.pending_buf.subarray(a.pending_out,a.pending_out+$),_.next_out),_.next_out+=$,a.pending_out+=$,_.total_out+=$,_.avail_out-=$,a.pending-=$,a.pending===0&&(a.pending_out=0))},flush_block_only=(_,a)=>{_tr_flush_block(_,_.block_start>=0?_.block_start:-1,_.strstart-_.block_start,a),_.block_start=_.strstart,flush_pending(_.strm)},put_byte=(_,a)=>{_.pending_buf[_.pending++]=a},putShortMSB=(_,a)=>{_.pending_buf[_.pending++]=a>>>8&255,_.pending_buf[_.pending++]=a&255},read_buf=(_,a,$,j)=>{let _e=_.avail_in;return _e>j&&(_e=j),_e===0?0:(_.avail_in-=_e,a.set(_.input.subarray(_.next_in,_.next_in+_e),$),_.state.wrap===1?_.adler=adler32_1(_.adler,a,_e,$):_.state.wrap===2&&(_.adler=crc32_1(_.adler,a,_e,$)),_.next_in+=_e,_.total_in+=_e,_e)},longest_match=(_,a)=>{let $=_.max_chain_length,j=_.strstart,_e,et,tt=_.prev_length,rt=_.nice_match;const nt=_.strstart>_.w_size-MIN_LOOKAHEAD?_.strstart-(_.w_size-MIN_LOOKAHEAD):0,it=_.window,st=_.w_mask,ot=_.prev,at=_.strstart+MAX_MATCH;let lt=it[j+tt-1],ct=it[j+tt];_.prev_length>=_.good_match&&($>>=2),rt>_.lookahead&&(rt=_.lookahead);do if(_e=a,!(it[_e+tt]!==ct||it[_e+tt-1]!==lt||it[_e]!==it[j]||it[++_e]!==it[j+1])){j+=2,_e++;do;while(it[++j]===it[++_e]&&it[++j]===it[++_e]&&it[++j]===it[++_e]&&it[++j]===it[++_e]&&it[++j]===it[++_e]&&it[++j]===it[++_e]&&it[++j]===it[++_e]&&it[++j]===it[++_e]&&j<at);if(et=MAX_MATCH-(at-j),j=at-MAX_MATCH,et>tt){if(_.match_start=a,tt=et,et>=rt)break;lt=it[j+tt-1],ct=it[j+tt]}}while((a=ot[a&st])>nt&&--$!==0);return tt<=_.lookahead?tt:_.lookahead},fill_window=_=>{const a=_.w_size;let $,j,_e,et,tt;do{if(et=_.window_size-_.lookahead-_.strstart,_.strstart>=a+(a-MIN_LOOKAHEAD)){_.window.set(_.window.subarray(a,a+a),0),_.match_start-=a,_.strstart-=a,_.block_start-=a,j=_.hash_size,$=j;do _e=_.head[--$],_.head[$]=_e>=a?_e-a:0;while(--j);j=a,$=j;do _e=_.prev[--$],_.prev[$]=_e>=a?_e-a:0;while(--j);et+=a}if(_.strm.avail_in===0)break;if(j=read_buf(_.strm,_.window,_.strstart+_.lookahead,et),_.lookahead+=j,_.lookahead+_.insert>=MIN_MATCH)for(tt=_.strstart-_.insert,_.ins_h=_.window[tt],_.ins_h=HASH(_,_.ins_h,_.window[tt+1]);_.insert&&(_.ins_h=HASH(_,_.ins_h,_.window[tt+MIN_MATCH-1]),_.prev[tt&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=tt,tt++,_.insert--,!(_.lookahead+_.insert<MIN_MATCH)););}while(_.lookahead<MIN_LOOKAHEAD&&_.strm.avail_in!==0)},deflate_stored=(_,a)=>{let $=65535;for($>_.pending_buf_size-5&&($=_.pending_buf_size-5);;){if(_.lookahead<=1){if(fill_window(_),_.lookahead===0&&a===Z_NO_FLUSH$2)return BS_NEED_MORE;if(_.lookahead===0)break}_.strstart+=_.lookahead,_.lookahead=0;const j=_.block_start+$;if((_.strstart===0||_.strstart>=j)&&(_.lookahead=_.strstart-j,_.strstart=j,flush_block_only(_,!1),_.strm.avail_out===0)||_.strstart-_.block_start>=_.w_size-MIN_LOOKAHEAD&&(flush_block_only(_,!1),_.strm.avail_out===0))return BS_NEED_MORE}return _.insert=0,a===Z_FINISH$3?(flush_block_only(_,!0),_.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):(_.strstart>_.block_start&&(flush_block_only(_,!1),_.strm.avail_out===0),BS_NEED_MORE)},deflate_fast=(_,a)=>{let $,j;for(;;){if(_.lookahead<MIN_LOOKAHEAD){if(fill_window(_),_.lookahead<MIN_LOOKAHEAD&&a===Z_NO_FLUSH$2)return BS_NEED_MORE;if(_.lookahead===0)break}if($=0,_.lookahead>=MIN_MATCH&&(_.ins_h=HASH(_,_.ins_h,_.window[_.strstart+MIN_MATCH-1]),$=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart),$!==0&&_.strstart-$<=_.w_size-MIN_LOOKAHEAD&&(_.match_length=longest_match(_,$)),_.match_length>=MIN_MATCH)if(j=_tr_tally(_,_.strstart-_.match_start,_.match_length-MIN_MATCH),_.lookahead-=_.match_length,_.match_length<=_.max_lazy_match&&_.lookahead>=MIN_MATCH){_.match_length--;do _.strstart++,_.ins_h=HASH(_,_.ins_h,_.window[_.strstart+MIN_MATCH-1]),$=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart;while(--_.match_length!==0);_.strstart++}else _.strstart+=_.match_length,_.match_length=0,_.ins_h=_.window[_.strstart],_.ins_h=HASH(_,_.ins_h,_.window[_.strstart+1]);else j=_tr_tally(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++;if(j&&(flush_block_only(_,!1),_.strm.avail_out===0))return BS_NEED_MORE}return _.insert=_.strstart<MIN_MATCH-1?_.strstart:MIN_MATCH-1,a===Z_FINISH$3?(flush_block_only(_,!0),_.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):_.last_lit&&(flush_block_only(_,!1),_.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_slow=(_,a)=>{let $,j,_e;for(;;){if(_.lookahead<MIN_LOOKAHEAD){if(fill_window(_),_.lookahead<MIN_LOOKAHEAD&&a===Z_NO_FLUSH$2)return BS_NEED_MORE;if(_.lookahead===0)break}if($=0,_.lookahead>=MIN_MATCH&&(_.ins_h=HASH(_,_.ins_h,_.window[_.strstart+MIN_MATCH-1]),$=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart),_.prev_length=_.match_length,_.prev_match=_.match_start,_.match_length=MIN_MATCH-1,$!==0&&_.prev_length<_.max_lazy_match&&_.strstart-$<=_.w_size-MIN_LOOKAHEAD&&(_.match_length=longest_match(_,$),_.match_length<=5&&(_.strategy===Z_FILTERED||_.match_length===MIN_MATCH&&_.strstart-_.match_start>4096)&&(_.match_length=MIN_MATCH-1)),_.prev_length>=MIN_MATCH&&_.match_length<=_.prev_length){_e=_.strstart+_.lookahead-MIN_MATCH,j=_tr_tally(_,_.strstart-1-_.prev_match,_.prev_length-MIN_MATCH),_.lookahead-=_.prev_length-1,_.prev_length-=2;do++_.strstart<=_e&&(_.ins_h=HASH(_,_.ins_h,_.window[_.strstart+MIN_MATCH-1]),$=_.prev[_.strstart&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=_.strstart);while(--_.prev_length!==0);if(_.match_available=0,_.match_length=MIN_MATCH-1,_.strstart++,j&&(flush_block_only(_,!1),_.strm.avail_out===0))return BS_NEED_MORE}else if(_.match_available){if(j=_tr_tally(_,0,_.window[_.strstart-1]),j&&flush_block_only(_,!1),_.strstart++,_.lookahead--,_.strm.avail_out===0)return BS_NEED_MORE}else _.match_available=1,_.strstart++,_.lookahead--}return _.match_available&&(j=_tr_tally(_,0,_.window[_.strstart-1]),_.match_available=0),_.insert=_.strstart<MIN_MATCH-1?_.strstart:MIN_MATCH-1,a===Z_FINISH$3?(flush_block_only(_,!0),_.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):_.last_lit&&(flush_block_only(_,!1),_.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_rle=(_,a)=>{let $,j,_e,et;const tt=_.window;for(;;){if(_.lookahead<=MAX_MATCH){if(fill_window(_),_.lookahead<=MAX_MATCH&&a===Z_NO_FLUSH$2)return BS_NEED_MORE;if(_.lookahead===0)break}if(_.match_length=0,_.lookahead>=MIN_MATCH&&_.strstart>0&&(_e=_.strstart-1,j=tt[_e],j===tt[++_e]&&j===tt[++_e]&&j===tt[++_e])){et=_.strstart+MAX_MATCH;do;while(j===tt[++_e]&&j===tt[++_e]&&j===tt[++_e]&&j===tt[++_e]&&j===tt[++_e]&&j===tt[++_e]&&j===tt[++_e]&&j===tt[++_e]&&_e<et);_.match_length=MAX_MATCH-(et-_e),_.match_length>_.lookahead&&(_.match_length=_.lookahead)}if(_.match_length>=MIN_MATCH?($=_tr_tally(_,1,_.match_length-MIN_MATCH),_.lookahead-=_.match_length,_.strstart+=_.match_length,_.match_length=0):($=_tr_tally(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++),$&&(flush_block_only(_,!1),_.strm.avail_out===0))return BS_NEED_MORE}return _.insert=0,a===Z_FINISH$3?(flush_block_only(_,!0),_.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):_.last_lit&&(flush_block_only(_,!1),_.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_huff=(_,a)=>{let $;for(;;){if(_.lookahead===0&&(fill_window(_),_.lookahead===0)){if(a===Z_NO_FLUSH$2)return BS_NEED_MORE;break}if(_.match_length=0,$=_tr_tally(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++,$&&(flush_block_only(_,!1),_.strm.avail_out===0))return BS_NEED_MORE}return _.insert=0,a===Z_FINISH$3?(flush_block_only(_,!0),_.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):_.last_lit&&(flush_block_only(_,!1),_.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE};function Config(_,a,$,j,_e){this.good_length=_,this.max_lazy=a,this.nice_length=$,this.max_chain=j,this.func=_e}const configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],lm_init=_=>{_.window_size=2*_.w_size,zero(_.head),_.max_lazy_match=configuration_table[_.level].max_lazy,_.good_match=configuration_table[_.level].good_length,_.nice_match=configuration_table[_.level].nice_length,_.max_chain_length=configuration_table[_.level].max_chain,_.strstart=0,_.block_start=0,_.lookahead=0,_.insert=0,_.match_length=_.prev_length=MIN_MATCH-1,_.match_available=0,_.ins_h=0};function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(HEAP_SIZE*2),this.dyn_dtree=new Uint16Array((2*D_CODES+1)*2),this.bl_tree=new Uint16Array((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(MAX_BITS+1),this.heap=new Uint16Array(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const deflateResetKeep=_=>{if(!_||!_.state)return err(_,Z_STREAM_ERROR$2);_.total_in=_.total_out=0,_.data_type=Z_UNKNOWN;const a=_.state;return a.pending=0,a.pending_out=0,a.wrap<0&&(a.wrap=-a.wrap),a.status=a.wrap?INIT_STATE:BUSY_STATE,_.adler=a.wrap===2?0:1,a.last_flush=Z_NO_FLUSH$2,_tr_init(a),Z_OK$3},deflateReset=_=>{const a=deflateResetKeep(_);return a===Z_OK$3&&lm_init(_.state),a},deflateSetHeader=(_,a)=>!_||!_.state||_.state.wrap!==2?Z_STREAM_ERROR$2:(_.state.gzhead=a,Z_OK$3),deflateInit2=(_,a,$,j,_e,et)=>{if(!_)return Z_STREAM_ERROR$2;let tt=1;if(a===Z_DEFAULT_COMPRESSION$1&&(a=6),j<0?(tt=0,j=-j):j>15&&(tt=2,j-=16),_e<1||_e>MAX_MEM_LEVEL||$!==Z_DEFLATED$2||j<8||j>15||a<0||a>9||et<0||et>Z_FIXED)return err(_,Z_STREAM_ERROR$2);j===8&&(j=9);const rt=new DeflateState;return _.state=rt,rt.strm=_,rt.wrap=tt,rt.gzhead=null,rt.w_bits=j,rt.w_size=1<<rt.w_bits,rt.w_mask=rt.w_size-1,rt.hash_bits=_e+7,rt.hash_size=1<<rt.hash_bits,rt.hash_mask=rt.hash_size-1,rt.hash_shift=~~((rt.hash_bits+MIN_MATCH-1)/MIN_MATCH),rt.window=new Uint8Array(rt.w_size*2),rt.head=new Uint16Array(rt.hash_size),rt.prev=new Uint16Array(rt.w_size),rt.lit_bufsize=1<<_e+6,rt.pending_buf_size=rt.lit_bufsize*4,rt.pending_buf=new Uint8Array(rt.pending_buf_size),rt.d_buf=1*rt.lit_bufsize,rt.l_buf=(1+2)*rt.lit_bufsize,rt.level=a,rt.strategy=et,rt.method=$,deflateReset(_)},deflateInit=(_,a)=>deflateInit2(_,a,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1),deflate$2=(_,a)=>{let $,j;if(!_||!_.state||a>Z_BLOCK$1||a<0)return _?err(_,Z_STREAM_ERROR$2):Z_STREAM_ERROR$2;const _e=_.state;if(!_.output||!_.input&&_.avail_in!==0||_e.status===FINISH_STATE&&a!==Z_FINISH$3)return err(_,_.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$2);_e.strm=_;const et=_e.last_flush;if(_e.last_flush=a,_e.status===INIT_STATE)if(_e.wrap===2)_.adler=0,put_byte(_e,31),put_byte(_e,139),put_byte(_e,8),_e.gzhead?(put_byte(_e,(_e.gzhead.text?1:0)+(_e.gzhead.hcrc?2:0)+(_e.gzhead.extra?4:0)+(_e.gzhead.name?8:0)+(_e.gzhead.comment?16:0)),put_byte(_e,_e.gzhead.time&255),put_byte(_e,_e.gzhead.time>>8&255),put_byte(_e,_e.gzhead.time>>16&255),put_byte(_e,_e.gzhead.time>>24&255),put_byte(_e,_e.level===9?2:_e.strategy>=Z_HUFFMAN_ONLY||_e.level<2?4:0),put_byte(_e,_e.gzhead.os&255),_e.gzhead.extra&&_e.gzhead.extra.length&&(put_byte(_e,_e.gzhead.extra.length&255),put_byte(_e,_e.gzhead.extra.length>>8&255)),_e.gzhead.hcrc&&(_.adler=crc32_1(_.adler,_e.pending_buf,_e.pending,0)),_e.gzindex=0,_e.status=EXTRA_STATE):(put_byte(_e,0),put_byte(_e,0),put_byte(_e,0),put_byte(_e,0),put_byte(_e,0),put_byte(_e,_e.level===9?2:_e.strategy>=Z_HUFFMAN_ONLY||_e.level<2?4:0),put_byte(_e,OS_CODE),_e.status=BUSY_STATE);else{let tt=Z_DEFLATED$2+(_e.w_bits-8<<4)<<8,rt=-1;_e.strategy>=Z_HUFFMAN_ONLY||_e.level<2?rt=0:_e.level<6?rt=1:_e.level===6?rt=2:rt=3,tt|=rt<<6,_e.strstart!==0&&(tt|=PRESET_DICT),tt+=31-tt%31,_e.status=BUSY_STATE,putShortMSB(_e,tt),_e.strstart!==0&&(putShortMSB(_e,_.adler>>>16),putShortMSB(_e,_.adler&65535)),_.adler=1}if(_e.status===EXTRA_STATE)if(_e.gzhead.extra){for($=_e.pending;_e.gzindex<(_e.gzhead.extra.length&65535)&&!(_e.pending===_e.pending_buf_size&&(_e.gzhead.hcrc&&_e.pending>$&&(_.adler=crc32_1(_.adler,_e.pending_buf,_e.pending-$,$)),flush_pending(_),$=_e.pending,_e.pending===_e.pending_buf_size));)put_byte(_e,_e.gzhead.extra[_e.gzindex]&255),_e.gzindex++;_e.gzhead.hcrc&&_e.pending>$&&(_.adler=crc32_1(_.adler,_e.pending_buf,_e.pending-$,$)),_e.gzindex===_e.gzhead.extra.length&&(_e.gzindex=0,_e.status=NAME_STATE)}else _e.status=NAME_STATE;if(_e.status===NAME_STATE)if(_e.gzhead.name){$=_e.pending;do{if(_e.pending===_e.pending_buf_size&&(_e.gzhead.hcrc&&_e.pending>$&&(_.adler=crc32_1(_.adler,_e.pending_buf,_e.pending-$,$)),flush_pending(_),$=_e.pending,_e.pending===_e.pending_buf_size)){j=1;break}_e.gzindex<_e.gzhead.name.length?j=_e.gzhead.name.charCodeAt(_e.gzindex++)&255:j=0,put_byte(_e,j)}while(j!==0);_e.gzhead.hcrc&&_e.pending>$&&(_.adler=crc32_1(_.adler,_e.pending_buf,_e.pending-$,$)),j===0&&(_e.gzindex=0,_e.status=COMMENT_STATE)}else _e.status=COMMENT_STATE;if(_e.status===COMMENT_STATE)if(_e.gzhead.comment){$=_e.pending;do{if(_e.pending===_e.pending_buf_size&&(_e.gzhead.hcrc&&_e.pending>$&&(_.adler=crc32_1(_.adler,_e.pending_buf,_e.pending-$,$)),flush_pending(_),$=_e.pending,_e.pending===_e.pending_buf_size)){j=1;break}_e.gzindex<_e.gzhead.comment.length?j=_e.gzhead.comment.charCodeAt(_e.gzindex++)&255:j=0,put_byte(_e,j)}while(j!==0);_e.gzhead.hcrc&&_e.pending>$&&(_.adler=crc32_1(_.adler,_e.pending_buf,_e.pending-$,$)),j===0&&(_e.status=HCRC_STATE)}else _e.status=HCRC_STATE;if(_e.status===HCRC_STATE&&(_e.gzhead.hcrc?(_e.pending+2>_e.pending_buf_size&&flush_pending(_),_e.pending+2<=_e.pending_buf_size&&(put_byte(_e,_.adler&255),put_byte(_e,_.adler>>8&255),_.adler=0,_e.status=BUSY_STATE)):_e.status=BUSY_STATE),_e.pending!==0){if(flush_pending(_),_.avail_out===0)return _e.last_flush=-1,Z_OK$3}else if(_.avail_in===0&&rank(a)<=rank(et)&&a!==Z_FINISH$3)return err(_,Z_BUF_ERROR$1);if(_e.status===FINISH_STATE&&_.avail_in!==0)return err(_,Z_BUF_ERROR$1);if(_.avail_in!==0||_e.lookahead!==0||a!==Z_NO_FLUSH$2&&_e.status!==FINISH_STATE){let tt=_e.strategy===Z_HUFFMAN_ONLY?deflate_huff(_e,a):_e.strategy===Z_RLE?deflate_rle(_e,a):configuration_table[_e.level].func(_e,a);if((tt===BS_FINISH_STARTED||tt===BS_FINISH_DONE)&&(_e.status=FINISH_STATE),tt===BS_NEED_MORE||tt===BS_FINISH_STARTED)return _.avail_out===0&&(_e.last_flush=-1),Z_OK$3;if(tt===BS_BLOCK_DONE&&(a===Z_PARTIAL_FLUSH?_tr_align(_e):a!==Z_BLOCK$1&&(_tr_stored_block(_e,0,0,!1),a===Z_FULL_FLUSH$1&&(zero(_e.head),_e.lookahead===0&&(_e.strstart=0,_e.block_start=0,_e.insert=0))),flush_pending(_),_.avail_out===0))return _e.last_flush=-1,Z_OK$3}return a!==Z_FINISH$3?Z_OK$3:_e.wrap<=0?Z_STREAM_END$3:(_e.wrap===2?(put_byte(_e,_.adler&255),put_byte(_e,_.adler>>8&255),put_byte(_e,_.adler>>16&255),put_byte(_e,_.adler>>24&255),put_byte(_e,_.total_in&255),put_byte(_e,_.total_in>>8&255),put_byte(_e,_.total_in>>16&255),put_byte(_e,_.total_in>>24&255)):(putShortMSB(_e,_.adler>>>16),putShortMSB(_e,_.adler&65535)),flush_pending(_),_e.wrap>0&&(_e.wrap=-_e.wrap),_e.pending!==0?Z_OK$3:Z_STREAM_END$3)},deflateEnd=_=>{if(!_||!_.state)return Z_STREAM_ERROR$2;const a=_.state.status;return a!==INIT_STATE&&a!==EXTRA_STATE&&a!==NAME_STATE&&a!==COMMENT_STATE&&a!==HCRC_STATE&&a!==BUSY_STATE&&a!==FINISH_STATE?err(_,Z_STREAM_ERROR$2):(_.state=null,a===BUSY_STATE?err(_,Z_DATA_ERROR$2):Z_OK$3)},deflateSetDictionary=(_,a)=>{let $=a.length;if(!_||!_.state)return Z_STREAM_ERROR$2;const j=_.state,_e=j.wrap;if(_e===2||_e===1&&j.status!==INIT_STATE||j.lookahead)return Z_STREAM_ERROR$2;if(_e===1&&(_.adler=adler32_1(_.adler,a,$,0)),j.wrap=0,$>=j.w_size){_e===0&&(zero(j.head),j.strstart=0,j.block_start=0,j.insert=0);let nt=new Uint8Array(j.w_size);nt.set(a.subarray($-j.w_size,$),0),a=nt,$=j.w_size}const et=_.avail_in,tt=_.next_in,rt=_.input;for(_.avail_in=$,_.next_in=0,_.input=a,fill_window(j);j.lookahead>=MIN_MATCH;){let nt=j.strstart,it=j.lookahead-(MIN_MATCH-1);do j.ins_h=HASH(j,j.ins_h,j.window[nt+MIN_MATCH-1]),j.prev[nt&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=nt,nt++;while(--it);j.strstart=nt,j.lookahead=MIN_MATCH-1,fill_window(j)}return j.strstart+=j.lookahead,j.block_start=j.strstart,j.insert=j.lookahead,j.lookahead=0,j.match_length=j.prev_length=MIN_MATCH-1,j.match_available=0,_.next_in=tt,_.input=rt,_.avail_in=et,j.wrap=_e,Z_OK$3};var deflateInit_1=deflateInit,deflateInit2_1=deflateInit2,deflateReset_1=deflateReset,deflateResetKeep_1=deflateResetKeep,deflateSetHeader_1=deflateSetHeader,deflate_2$1=deflate$2,deflateEnd_1=deflateEnd,deflateSetDictionary_1=deflateSetDictionary,deflateInfo="pako deflate (from Nodeca project)",deflate_1$2={deflateInit:deflateInit_1,deflateInit2:deflateInit2_1,deflateReset:deflateReset_1,deflateResetKeep:deflateResetKeep_1,deflateSetHeader:deflateSetHeader_1,deflate:deflate_2$1,deflateEnd:deflateEnd_1,deflateSetDictionary:deflateSetDictionary_1,deflateInfo};const _has=(_,a)=>Object.prototype.hasOwnProperty.call(_,a);var assign=function(_){const a=Array.prototype.slice.call(arguments,1);for(;a.length;){const $=a.shift();if(!!$){if(typeof $!="object")throw new TypeError($+"must be non-object");for(const j in $)_has($,j)&&(_[j]=$[j])}}return _},flattenChunks=_=>{let a=0;for(let j=0,_e=_.length;j<_e;j++)a+=_[j].length;const $=new Uint8Array(a);for(let j=0,_e=0,et=_.length;j<et;j++){let tt=_[j];$.set(tt,_e),_e+=tt.length}return $},common$1={assign,flattenChunks};let STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(_){STR_APPLY_UIA_OK=!1}const _utf8len=new Uint8Array(256);for(let _=0;_<256;_++)_utf8len[_]=_>=252?6:_>=248?5:_>=240?4:_>=224?3:_>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=_=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(_);let a,$,j,_e,et,tt=_.length,rt=0;for(_e=0;_e<tt;_e++)$=_.charCodeAt(_e),($&64512)===55296&&_e+1<tt&&(j=_.charCodeAt(_e+1),(j&64512)===56320&&($=65536+($-55296<<10)+(j-56320),_e++)),rt+=$<128?1:$<2048?2:$<65536?3:4;for(a=new Uint8Array(rt),et=0,_e=0;et<rt;_e++)$=_.charCodeAt(_e),($&64512)===55296&&_e+1<tt&&(j=_.charCodeAt(_e+1),(j&64512)===56320&&($=65536+($-55296<<10)+(j-56320),_e++)),$<128?a[et++]=$:$<2048?(a[et++]=192|$>>>6,a[et++]=128|$&63):$<65536?(a[et++]=224|$>>>12,a[et++]=128|$>>>6&63,a[et++]=128|$&63):(a[et++]=240|$>>>18,a[et++]=128|$>>>12&63,a[et++]=128|$>>>6&63,a[et++]=128|$&63);return a};const buf2binstring=(_,a)=>{if(a<65534&&_.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,_.length===a?_:_.subarray(0,a));let $="";for(let j=0;j<a;j++)$+=String.fromCharCode(_[j]);return $};var buf2string=(_,a)=>{const $=a||_.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(_.subarray(0,a));let j,_e;const et=new Array($*2);for(_e=0,j=0;j<$;){let tt=_[j++];if(tt<128){et[_e++]=tt;continue}let rt=_utf8len[tt];if(rt>4){et[_e++]=65533,j+=rt-1;continue}for(tt&=rt===2?31:rt===3?15:7;rt>1&&j<$;)tt=tt<<6|_[j++]&63,rt--;if(rt>1){et[_e++]=65533;continue}tt<65536?et[_e++]=tt:(tt-=65536,et[_e++]=55296|tt>>10&1023,et[_e++]=56320|tt&1023)}return buf2binstring(et,_e)},utf8border=(_,a)=>{a=a||_.length,a>_.length&&(a=_.length);let $=a-1;for(;$>=0&&(_[$]&192)===128;)$--;return $<0||$===0?a:$+_utf8len[_[$]]>a?$:a},strings={string2buf,buf2string,utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream;const toString$1$1=Object.prototype.toString,{Z_NO_FLUSH:Z_NO_FLUSH$1,Z_SYNC_FLUSH,Z_FULL_FLUSH,Z_FINISH:Z_FINISH$2,Z_OK:Z_OK$2,Z_STREAM_END:Z_STREAM_END$2,Z_DEFAULT_COMPRESSION,Z_DEFAULT_STRATEGY,Z_DEFLATED:Z_DEFLATED$1}=constants$2;function Deflate$1(_){this.options=common$1.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY},_||{});let a=this.options;a.raw&&a.windowBits>0?a.windowBits=-a.windowBits:a.gzip&&a.windowBits>0&&a.windowBits<16&&(a.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let $=deflate_1$2.deflateInit2(this.strm,a.level,a.method,a.windowBits,a.memLevel,a.strategy);if($!==Z_OK$2)throw new Error(messages$1[$]);if(a.header&&deflate_1$2.deflateSetHeader(this.strm,a.header),a.dictionary){let j;if(typeof a.dictionary=="string"?j=strings.string2buf(a.dictionary):toString$1$1.call(a.dictionary)==="[object ArrayBuffer]"?j=new Uint8Array(a.dictionary):j=a.dictionary,$=deflate_1$2.deflateSetDictionary(this.strm,j),$!==Z_OK$2)throw new Error(messages$1[$]);this._dict_set=!0}}Deflate$1.prototype.push=function(_,a){const $=this.strm,j=this.options.chunkSize;let _e,et;if(this.ended)return!1;for(a===~~a?et=a:et=a===!0?Z_FINISH$2:Z_NO_FLUSH$1,typeof _=="string"?$.input=strings.string2buf(_):toString$1$1.call(_)==="[object ArrayBuffer]"?$.input=new Uint8Array(_):$.input=_,$.next_in=0,$.avail_in=$.input.length;;){if($.avail_out===0&&($.output=new Uint8Array(j),$.next_out=0,$.avail_out=j),(et===Z_SYNC_FLUSH||et===Z_FULL_FLUSH)&&$.avail_out<=6){this.onData($.output.subarray(0,$.next_out)),$.avail_out=0;continue}if(_e=deflate_1$2.deflate($,et),_e===Z_STREAM_END$2)return $.next_out>0&&this.onData($.output.subarray(0,$.next_out)),_e=deflate_1$2.deflateEnd(this.strm),this.onEnd(_e),this.ended=!0,_e===Z_OK$2;if($.avail_out===0){this.onData($.output);continue}if(et>0&&$.next_out>0){this.onData($.output.subarray(0,$.next_out)),$.avail_out=0;continue}if($.avail_in===0)break}return!0};Deflate$1.prototype.onData=function(_){this.chunks.push(_)};Deflate$1.prototype.onEnd=function(_){_===Z_OK$2&&(this.result=common$1.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg};function deflate$1(_,a){const $=new Deflate$1(a);if($.push(_,!0),$.err)throw $.msg||messages$1[$.err];return $.result}function deflateRaw$1(_,a){return a=a||{},a.raw=!0,deflate$1(_,a)}function gzip$1(_,a){return a=a||{},a.gzip=!0,deflate$1(_,a)}var Deflate_1$1=Deflate$1,deflate_2=deflate$1,deflateRaw_1$1=deflateRaw$1,gzip_1$1=gzip$1,constants$1=constants$2,deflate_1$1={Deflate:Deflate_1$1,deflate:deflate_2,deflateRaw:deflateRaw_1$1,gzip:gzip_1$1,constants:constants$1};const BAD$1=30,TYPE$1=12;var inffast=function _(a,$){let j,_e,et,tt,rt,nt,it,st,ot,at,lt,ct,ut,dt,ft,pt,yt,mt,_t,vt,ht,St,It,Lt;const Mt=a.state;j=a.next_in,It=a.input,_e=j+(a.avail_in-5),et=a.next_out,Lt=a.output,tt=et-($-a.avail_out),rt=et+(a.avail_out-257),nt=Mt.dmax,it=Mt.wsize,st=Mt.whave,ot=Mt.wnext,at=Mt.window,lt=Mt.hold,ct=Mt.bits,ut=Mt.lencode,dt=Mt.distcode,ft=(1<<Mt.lenbits)-1,pt=(1<<Mt.distbits)-1;e:do{ct<15&&(lt+=It[j++]<<ct,ct+=8,lt+=It[j++]<<ct,ct+=8),yt=ut[lt&ft];t:for(;;){if(mt=yt>>>24,lt>>>=mt,ct-=mt,mt=yt>>>16&255,mt===0)Lt[et++]=yt&65535;else if(mt&16){_t=yt&65535,mt&=15,mt&&(ct<mt&&(lt+=It[j++]<<ct,ct+=8),_t+=lt&(1<<mt)-1,lt>>>=mt,ct-=mt),ct<15&&(lt+=It[j++]<<ct,ct+=8,lt+=It[j++]<<ct,ct+=8),yt=dt[lt&pt];r:for(;;){if(mt=yt>>>24,lt>>>=mt,ct-=mt,mt=yt>>>16&255,mt&16){if(vt=yt&65535,mt&=15,ct<mt&&(lt+=It[j++]<<ct,ct+=8,ct<mt&&(lt+=It[j++]<<ct,ct+=8)),vt+=lt&(1<<mt)-1,vt>nt){a.msg="invalid distance too far back",Mt.mode=BAD$1;break e}if(lt>>>=mt,ct-=mt,mt=et-tt,vt>mt){if(mt=vt-mt,mt>st&&Mt.sane){a.msg="invalid distance too far back",Mt.mode=BAD$1;break e}if(ht=0,St=at,ot===0){if(ht+=it-mt,mt<_t){_t-=mt;do Lt[et++]=at[ht++];while(--mt);ht=et-vt,St=Lt}}else if(ot<mt){if(ht+=it+ot-mt,mt-=ot,mt<_t){_t-=mt;do Lt[et++]=at[ht++];while(--mt);if(ht=0,ot<_t){mt=ot,_t-=mt;do Lt[et++]=at[ht++];while(--mt);ht=et-vt,St=Lt}}}else if(ht+=ot-mt,mt<_t){_t-=mt;do Lt[et++]=at[ht++];while(--mt);ht=et-vt,St=Lt}for(;_t>2;)Lt[et++]=St[ht++],Lt[et++]=St[ht++],Lt[et++]=St[ht++],_t-=3;_t&&(Lt[et++]=St[ht++],_t>1&&(Lt[et++]=St[ht++]))}else{ht=et-vt;do Lt[et++]=Lt[ht++],Lt[et++]=Lt[ht++],Lt[et++]=Lt[ht++],_t-=3;while(_t>2);_t&&(Lt[et++]=Lt[ht++],_t>1&&(Lt[et++]=Lt[ht++]))}}else if((mt&64)===0){yt=dt[(yt&65535)+(lt&(1<<mt)-1)];continue r}else{a.msg="invalid distance code",Mt.mode=BAD$1;break e}break}}else if((mt&64)===0){yt=ut[(yt&65535)+(lt&(1<<mt)-1)];continue t}else if(mt&32){Mt.mode=TYPE$1;break e}else{a.msg="invalid literal/length code",Mt.mode=BAD$1;break e}break}}while(j<_e&&et<rt);_t=ct>>3,j-=_t,ct-=_t<<3,lt&=(1<<ct)-1,a.next_in=j,a.next_out=et,a.avail_in=j<_e?5+(_e-j):5-(j-_e),a.avail_out=et<rt?257+(rt-et):257-(et-rt),Mt.hold=lt,Mt.bits=ct};const MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=(_,a,$,j,_e,et,tt,rt)=>{const nt=rt.bits;let it=0,st=0,ot=0,at=0,lt=0,ct=0,ut=0,dt=0,ft=0,pt=0,yt,mt,_t,vt,ht,St=null,It=0,Lt;const Mt=new Uint16Array(MAXBITS+1),Kt=new Uint16Array(MAXBITS+1);let kt=null,gt=0,Et,xt,Tt;for(it=0;it<=MAXBITS;it++)Mt[it]=0;for(st=0;st<j;st++)Mt[a[$+st]]++;for(lt=nt,at=MAXBITS;at>=1&&Mt[at]===0;at--);if(lt>at&&(lt=at),at===0)return _e[et++]=1<<24|64<<16|0,_e[et++]=1<<24|64<<16|0,rt.bits=1,0;for(ot=1;ot<at&&Mt[ot]===0;ot++);for(lt<ot&&(lt=ot),dt=1,it=1;it<=MAXBITS;it++)if(dt<<=1,dt-=Mt[it],dt<0)return-1;if(dt>0&&(_===CODES$1||at!==1))return-1;for(Kt[1]=0,it=1;it<MAXBITS;it++)Kt[it+1]=Kt[it]+Mt[it];for(st=0;st<j;st++)a[$+st]!==0&&(tt[Kt[a[$+st]]++]=st);if(_===CODES$1?(St=kt=tt,Lt=19):_===LENS$1?(St=lbase,It-=257,kt=lext,gt-=257,Lt=256):(St=dbase,kt=dext,Lt=-1),pt=0,st=0,it=ot,ht=et,ct=lt,ut=0,_t=-1,ft=1<<lt,vt=ft-1,_===LENS$1&&ft>ENOUGH_LENS$1||_===DISTS$1&&ft>ENOUGH_DISTS$1)return 1;for(;;){Et=it-ut,tt[st]<Lt?(xt=0,Tt=tt[st]):tt[st]>Lt?(xt=kt[gt+tt[st]],Tt=St[It+tt[st]]):(xt=32+64,Tt=0),yt=1<<it-ut,mt=1<<ct,ot=mt;do mt-=yt,_e[ht+(pt>>ut)+mt]=Et<<24|xt<<16|Tt|0;while(mt!==0);for(yt=1<<it-1;pt&yt;)yt>>=1;if(yt!==0?(pt&=yt-1,pt+=yt):pt=0,st++,--Mt[it]===0){if(it===at)break;it=a[$+tt[st]]}if(it>lt&&(pt&vt)!==_t){for(ut===0&&(ut=lt),ht+=ot,ct=it-ut,dt=1<<ct;ct+ut<at&&(dt-=Mt[ct+ut],!(dt<=0));)ct++,dt<<=1;if(ft+=1<<ct,_===LENS$1&&ft>ENOUGH_LENS$1||_===DISTS$1&&ft>ENOUGH_DISTS$1)return 1;_t=pt&vt,_e[_t]=lt<<24|ct<<16|ht-et|0}}return pt!==0&&(_e[ht+pt]=it-ut<<24|64<<16|0),rt.bits=lt,0};var inftrees=inflate_table;const CODES=0,LENS=1,DISTS=2,{Z_FINISH:Z_FINISH$1,Z_BLOCK,Z_TREES,Z_OK:Z_OK$1,Z_STREAM_END:Z_STREAM_END$1,Z_NEED_DICT:Z_NEED_DICT$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1,Z_DATA_ERROR:Z_DATA_ERROR$1,Z_MEM_ERROR:Z_MEM_ERROR$1,Z_BUF_ERROR,Z_DEFLATED}=constants$2,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=_=>(_>>>24&255)+(_>>>8&65280)+((_&65280)<<8)+((_&255)<<24);function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateResetKeep=_=>{if(!_||!_.state)return Z_STREAM_ERROR$1;const a=_.state;return _.total_in=_.total_out=a.total=0,_.msg="",a.wrap&&(_.adler=a.wrap&1),a.mode=HEAD,a.last=0,a.havedict=0,a.dmax=32768,a.head=null,a.hold=0,a.bits=0,a.lencode=a.lendyn=new Int32Array(ENOUGH_LENS),a.distcode=a.distdyn=new Int32Array(ENOUGH_DISTS),a.sane=1,a.back=-1,Z_OK$1},inflateReset=_=>{if(!_||!_.state)return Z_STREAM_ERROR$1;const a=_.state;return a.wsize=0,a.whave=0,a.wnext=0,inflateResetKeep(_)},inflateReset2=(_,a)=>{let $;if(!_||!_.state)return Z_STREAM_ERROR$1;const j=_.state;return a<0?($=0,a=-a):($=(a>>4)+1,a<48&&(a&=15)),a&&(a<8||a>15)?Z_STREAM_ERROR$1:(j.window!==null&&j.wbits!==a&&(j.window=null),j.wrap=$,j.wbits=a,inflateReset(_))},inflateInit2=(_,a)=>{if(!_)return Z_STREAM_ERROR$1;const $=new InflateState;_.state=$,$.window=null;const j=inflateReset2(_,a);return j!==Z_OK$1&&(_.state=null),j},inflateInit=_=>inflateInit2(_,DEF_WBITS);let virgin=!0,lenfix,distfix;const fixedtables=_=>{if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);let a=0;for(;a<144;)_.lens[a++]=8;for(;a<256;)_.lens[a++]=9;for(;a<280;)_.lens[a++]=7;for(;a<288;)_.lens[a++]=8;for(inftrees(LENS,_.lens,0,288,lenfix,0,_.work,{bits:9}),a=0;a<32;)_.lens[a++]=5;inftrees(DISTS,_.lens,0,32,distfix,0,_.work,{bits:5}),virgin=!1}_.lencode=lenfix,_.lenbits=9,_.distcode=distfix,_.distbits=5},updatewindow=(_,a,$,j)=>{let _e;const et=_.state;return et.window===null&&(et.wsize=1<<et.wbits,et.wnext=0,et.whave=0,et.window=new Uint8Array(et.wsize)),j>=et.wsize?(et.window.set(a.subarray($-et.wsize,$),0),et.wnext=0,et.whave=et.wsize):(_e=et.wsize-et.wnext,_e>j&&(_e=j),et.window.set(a.subarray($-j,$-j+_e),et.wnext),j-=_e,j?(et.window.set(a.subarray($-j,$),0),et.wnext=j,et.whave=et.wsize):(et.wnext+=_e,et.wnext===et.wsize&&(et.wnext=0),et.whave<et.wsize&&(et.whave+=_e))),0},inflate$2=(_,a)=>{let $,j,_e,et,tt,rt,nt,it,st,ot,at,lt,ct,ut,dt=0,ft,pt,yt,mt,_t,vt,ht,St;const It=new Uint8Array(4);let Lt,Mt;const Kt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!_||!_.state||!_.output||!_.input&&_.avail_in!==0)return Z_STREAM_ERROR$1;$=_.state,$.mode===TYPE&&($.mode=TYPEDO),tt=_.next_out,_e=_.output,nt=_.avail_out,et=_.next_in,j=_.input,rt=_.avail_in,it=$.hold,st=$.bits,ot=rt,at=nt,St=Z_OK$1;e:for(;;)switch($.mode){case HEAD:if($.wrap===0){$.mode=TYPEDO;break}for(;st<16;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}if($.wrap&2&&it===35615){$.check=0,It[0]=it&255,It[1]=it>>>8&255,$.check=crc32_1($.check,It,2,0),it=0,st=0,$.mode=FLAGS;break}if($.flags=0,$.head&&($.head.done=!1),!($.wrap&1)||(((it&255)<<8)+(it>>8))%31){_.msg="incorrect header check",$.mode=BAD;break}if((it&15)!==Z_DEFLATED){_.msg="unknown compression method",$.mode=BAD;break}if(it>>>=4,st-=4,ht=(it&15)+8,$.wbits===0)$.wbits=ht;else if(ht>$.wbits){_.msg="invalid window size",$.mode=BAD;break}$.dmax=1<<$.wbits,_.adler=$.check=1,$.mode=it&512?DICTID:TYPE,it=0,st=0;break;case FLAGS:for(;st<16;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}if($.flags=it,($.flags&255)!==Z_DEFLATED){_.msg="unknown compression method",$.mode=BAD;break}if($.flags&57344){_.msg="unknown header flags set",$.mode=BAD;break}$.head&&($.head.text=it>>8&1),$.flags&512&&(It[0]=it&255,It[1]=it>>>8&255,$.check=crc32_1($.check,It,2,0)),it=0,st=0,$.mode=TIME;case TIME:for(;st<32;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}$.head&&($.head.time=it),$.flags&512&&(It[0]=it&255,It[1]=it>>>8&255,It[2]=it>>>16&255,It[3]=it>>>24&255,$.check=crc32_1($.check,It,4,0)),it=0,st=0,$.mode=OS;case OS:for(;st<16;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}$.head&&($.head.xflags=it&255,$.head.os=it>>8),$.flags&512&&(It[0]=it&255,It[1]=it>>>8&255,$.check=crc32_1($.check,It,2,0)),it=0,st=0,$.mode=EXLEN;case EXLEN:if($.flags&1024){for(;st<16;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}$.length=it,$.head&&($.head.extra_len=it),$.flags&512&&(It[0]=it&255,It[1]=it>>>8&255,$.check=crc32_1($.check,It,2,0)),it=0,st=0}else $.head&&($.head.extra=null);$.mode=EXTRA;case EXTRA:if($.flags&1024&&(lt=$.length,lt>rt&&(lt=rt),lt&&($.head&&(ht=$.head.extra_len-$.length,$.head.extra||($.head.extra=new Uint8Array($.head.extra_len)),$.head.extra.set(j.subarray(et,et+lt),ht)),$.flags&512&&($.check=crc32_1($.check,j,lt,et)),rt-=lt,et+=lt,$.length-=lt),$.length))break e;$.length=0,$.mode=NAME;case NAME:if($.flags&2048){if(rt===0)break e;lt=0;do ht=j[et+lt++],$.head&&ht&&$.length<65536&&($.head.name+=String.fromCharCode(ht));while(ht&&lt<rt);if($.flags&512&&($.check=crc32_1($.check,j,lt,et)),rt-=lt,et+=lt,ht)break e}else $.head&&($.head.name=null);$.length=0,$.mode=COMMENT;case COMMENT:if($.flags&4096){if(rt===0)break e;lt=0;do ht=j[et+lt++],$.head&&ht&&$.length<65536&&($.head.comment+=String.fromCharCode(ht));while(ht&&lt<rt);if($.flags&512&&($.check=crc32_1($.check,j,lt,et)),rt-=lt,et+=lt,ht)break e}else $.head&&($.head.comment=null);$.mode=HCRC;case HCRC:if($.flags&512){for(;st<16;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}if(it!==($.check&65535)){_.msg="header crc mismatch",$.mode=BAD;break}it=0,st=0}$.head&&($.head.hcrc=$.flags>>9&1,$.head.done=!0),_.adler=$.check=0,$.mode=TYPE;break;case DICTID:for(;st<32;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}_.adler=$.check=zswap32(it),it=0,st=0,$.mode=DICT;case DICT:if($.havedict===0)return _.next_out=tt,_.avail_out=nt,_.next_in=et,_.avail_in=rt,$.hold=it,$.bits=st,Z_NEED_DICT$1;_.adler=$.check=1,$.mode=TYPE;case TYPE:if(a===Z_BLOCK||a===Z_TREES)break e;case TYPEDO:if($.last){it>>>=st&7,st-=st&7,$.mode=CHECK;break}for(;st<3;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}switch($.last=it&1,it>>>=1,st-=1,it&3){case 0:$.mode=STORED;break;case 1:if(fixedtables($),$.mode=LEN_,a===Z_TREES){it>>>=2,st-=2;break e}break;case 2:$.mode=TABLE;break;case 3:_.msg="invalid block type",$.mode=BAD}it>>>=2,st-=2;break;case STORED:for(it>>>=st&7,st-=st&7;st<32;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}if((it&65535)!==(it>>>16^65535)){_.msg="invalid stored block lengths",$.mode=BAD;break}if($.length=it&65535,it=0,st=0,$.mode=COPY_,a===Z_TREES)break e;case COPY_:$.mode=COPY;case COPY:if(lt=$.length,lt){if(lt>rt&&(lt=rt),lt>nt&&(lt=nt),lt===0)break e;_e.set(j.subarray(et,et+lt),tt),rt-=lt,et+=lt,nt-=lt,tt+=lt,$.length-=lt;break}$.mode=TYPE;break;case TABLE:for(;st<14;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}if($.nlen=(it&31)+257,it>>>=5,st-=5,$.ndist=(it&31)+1,it>>>=5,st-=5,$.ncode=(it&15)+4,it>>>=4,st-=4,$.nlen>286||$.ndist>30){_.msg="too many length or distance symbols",$.mode=BAD;break}$.have=0,$.mode=LENLENS;case LENLENS:for(;$.have<$.ncode;){for(;st<3;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}$.lens[Kt[$.have++]]=it&7,it>>>=3,st-=3}for(;$.have<19;)$.lens[Kt[$.have++]]=0;if($.lencode=$.lendyn,$.lenbits=7,Lt={bits:$.lenbits},St=inftrees(CODES,$.lens,0,19,$.lencode,0,$.work,Lt),$.lenbits=Lt.bits,St){_.msg="invalid code lengths set",$.mode=BAD;break}$.have=0,$.mode=CODELENS;case CODELENS:for(;$.have<$.nlen+$.ndist;){for(;dt=$.lencode[it&(1<<$.lenbits)-1],ft=dt>>>24,pt=dt>>>16&255,yt=dt&65535,!(ft<=st);){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}if(yt<16)it>>>=ft,st-=ft,$.lens[$.have++]=yt;else{if(yt===16){for(Mt=ft+2;st<Mt;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}if(it>>>=ft,st-=ft,$.have===0){_.msg="invalid bit length repeat",$.mode=BAD;break}ht=$.lens[$.have-1],lt=3+(it&3),it>>>=2,st-=2}else if(yt===17){for(Mt=ft+3;st<Mt;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}it>>>=ft,st-=ft,ht=0,lt=3+(it&7),it>>>=3,st-=3}else{for(Mt=ft+7;st<Mt;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}it>>>=ft,st-=ft,ht=0,lt=11+(it&127),it>>>=7,st-=7}if($.have+lt>$.nlen+$.ndist){_.msg="invalid bit length repeat",$.mode=BAD;break}for(;lt--;)$.lens[$.have++]=ht}}if($.mode===BAD)break;if($.lens[256]===0){_.msg="invalid code -- missing end-of-block",$.mode=BAD;break}if($.lenbits=9,Lt={bits:$.lenbits},St=inftrees(LENS,$.lens,0,$.nlen,$.lencode,0,$.work,Lt),$.lenbits=Lt.bits,St){_.msg="invalid literal/lengths set",$.mode=BAD;break}if($.distbits=6,$.distcode=$.distdyn,Lt={bits:$.distbits},St=inftrees(DISTS,$.lens,$.nlen,$.ndist,$.distcode,0,$.work,Lt),$.distbits=Lt.bits,St){_.msg="invalid distances set",$.mode=BAD;break}if($.mode=LEN_,a===Z_TREES)break e;case LEN_:$.mode=LEN;case LEN:if(rt>=6&&nt>=258){_.next_out=tt,_.avail_out=nt,_.next_in=et,_.avail_in=rt,$.hold=it,$.bits=st,inffast(_,at),tt=_.next_out,_e=_.output,nt=_.avail_out,et=_.next_in,j=_.input,rt=_.avail_in,it=$.hold,st=$.bits,$.mode===TYPE&&($.back=-1);break}for($.back=0;dt=$.lencode[it&(1<<$.lenbits)-1],ft=dt>>>24,pt=dt>>>16&255,yt=dt&65535,!(ft<=st);){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}if(pt&&(pt&240)===0){for(mt=ft,_t=pt,vt=yt;dt=$.lencode[vt+((it&(1<<mt+_t)-1)>>mt)],ft=dt>>>24,pt=dt>>>16&255,yt=dt&65535,!(mt+ft<=st);){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}it>>>=mt,st-=mt,$.back+=mt}if(it>>>=ft,st-=ft,$.back+=ft,$.length=yt,pt===0){$.mode=LIT;break}if(pt&32){$.back=-1,$.mode=TYPE;break}if(pt&64){_.msg="invalid literal/length code",$.mode=BAD;break}$.extra=pt&15,$.mode=LENEXT;case LENEXT:if($.extra){for(Mt=$.extra;st<Mt;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}$.length+=it&(1<<$.extra)-1,it>>>=$.extra,st-=$.extra,$.back+=$.extra}$.was=$.length,$.mode=DIST;case DIST:for(;dt=$.distcode[it&(1<<$.distbits)-1],ft=dt>>>24,pt=dt>>>16&255,yt=dt&65535,!(ft<=st);){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}if((pt&240)===0){for(mt=ft,_t=pt,vt=yt;dt=$.distcode[vt+((it&(1<<mt+_t)-1)>>mt)],ft=dt>>>24,pt=dt>>>16&255,yt=dt&65535,!(mt+ft<=st);){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}it>>>=mt,st-=mt,$.back+=mt}if(it>>>=ft,st-=ft,$.back+=ft,pt&64){_.msg="invalid distance code",$.mode=BAD;break}$.offset=yt,$.extra=pt&15,$.mode=DISTEXT;case DISTEXT:if($.extra){for(Mt=$.extra;st<Mt;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}$.offset+=it&(1<<$.extra)-1,it>>>=$.extra,st-=$.extra,$.back+=$.extra}if($.offset>$.dmax){_.msg="invalid distance too far back",$.mode=BAD;break}$.mode=MATCH;case MATCH:if(nt===0)break e;if(lt=at-nt,$.offset>lt){if(lt=$.offset-lt,lt>$.whave&&$.sane){_.msg="invalid distance too far back",$.mode=BAD;break}lt>$.wnext?(lt-=$.wnext,ct=$.wsize-lt):ct=$.wnext-lt,lt>$.length&&(lt=$.length),ut=$.window}else ut=_e,ct=tt-$.offset,lt=$.length;lt>nt&&(lt=nt),nt-=lt,$.length-=lt;do _e[tt++]=ut[ct++];while(--lt);$.length===0&&($.mode=LEN);break;case LIT:if(nt===0)break e;_e[tt++]=$.length,nt--,$.mode=LEN;break;case CHECK:if($.wrap){for(;st<32;){if(rt===0)break e;rt--,it|=j[et++]<<st,st+=8}if(at-=nt,_.total_out+=at,$.total+=at,at&&(_.adler=$.check=$.flags?crc32_1($.check,_e,at,tt-at):adler32_1($.check,_e,at,tt-at)),at=nt,($.flags?it:zswap32(it))!==$.check){_.msg="incorrect data check",$.mode=BAD;break}it=0,st=0}$.mode=LENGTH;case LENGTH:if($.wrap&&$.flags){for(;st<32;){if(rt===0)break e;rt--,it+=j[et++]<<st,st+=8}if(it!==($.total&4294967295)){_.msg="incorrect length check",$.mode=BAD;break}it=0,st=0}$.mode=DONE;case DONE:St=Z_STREAM_END$1;break e;case BAD:St=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR$1;case SYNC:default:return Z_STREAM_ERROR$1}return _.next_out=tt,_.avail_out=nt,_.next_in=et,_.avail_in=rt,$.hold=it,$.bits=st,($.wsize||at!==_.avail_out&&$.mode<BAD&&($.mode<CHECK||a!==Z_FINISH$1))&&updatewindow(_,_.output,_.next_out,at-_.avail_out),ot-=_.avail_in,at-=_.avail_out,_.total_in+=ot,_.total_out+=at,$.total+=at,$.wrap&&at&&(_.adler=$.check=$.flags?crc32_1($.check,_e,at,_.next_out-at):adler32_1($.check,_e,at,_.next_out-at)),_.data_type=$.bits+($.last?64:0)+($.mode===TYPE?128:0)+($.mode===LEN_||$.mode===COPY_?256:0),(ot===0&&at===0||a===Z_FINISH$1)&&St===Z_OK$1&&(St=Z_BUF_ERROR),St},inflateEnd=_=>{if(!_||!_.state)return Z_STREAM_ERROR$1;let a=_.state;return a.window&&(a.window=null),_.state=null,Z_OK$1},inflateGetHeader=(_,a)=>{if(!_||!_.state)return Z_STREAM_ERROR$1;const $=_.state;return($.wrap&2)===0?Z_STREAM_ERROR$1:($.head=a,a.done=!1,Z_OK$1)},inflateSetDictionary=(_,a)=>{const $=a.length;let j,_e,et;return!_||!_.state||(j=_.state,j.wrap!==0&&j.mode!==DICT)?Z_STREAM_ERROR$1:j.mode===DICT&&(_e=1,_e=adler32_1(_e,a,$,0),_e!==j.check)?Z_DATA_ERROR$1:(et=updatewindow(_,a,$,$),et?(j.mode=MEM,Z_MEM_ERROR$1):(j.havedict=1,Z_OK$1))};var inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2$1,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader;const toString$4=Object.prototype.toString,{Z_NO_FLUSH,Z_FINISH,Z_OK,Z_STREAM_END,Z_NEED_DICT,Z_STREAM_ERROR,Z_DATA_ERROR,Z_MEM_ERROR}=constants$2;function Inflate$1(_){this.options=common$1.assign({chunkSize:1024*64,windowBits:15,to:""},_||{});const a=this.options;a.raw&&a.windowBits>=0&&a.windowBits<16&&(a.windowBits=-a.windowBits,a.windowBits===0&&(a.windowBits=-15)),a.windowBits>=0&&a.windowBits<16&&!(_&&_.windowBits)&&(a.windowBits+=32),a.windowBits>15&&a.windowBits<48&&(a.windowBits&15)===0&&(a.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let $=inflate_1$2.inflateInit2(this.strm,a.windowBits);if($!==Z_OK)throw new Error(messages$1[$]);if(this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header),a.dictionary&&(typeof a.dictionary=="string"?a.dictionary=strings.string2buf(a.dictionary):toString$4.call(a.dictionary)==="[object ArrayBuffer]"&&(a.dictionary=new Uint8Array(a.dictionary)),a.raw&&($=inflate_1$2.inflateSetDictionary(this.strm,a.dictionary),$!==Z_OK)))throw new Error(messages$1[$])}Inflate$1.prototype.push=function(_,a){const $=this.strm,j=this.options.chunkSize,_e=this.options.dictionary;let et,tt,rt;if(this.ended)return!1;for(a===~~a?tt=a:tt=a===!0?Z_FINISH:Z_NO_FLUSH,toString$4.call(_)==="[object ArrayBuffer]"?$.input=new Uint8Array(_):$.input=_,$.next_in=0,$.avail_in=$.input.length;;){for($.avail_out===0&&($.output=new Uint8Array(j),$.next_out=0,$.avail_out=j),et=inflate_1$2.inflate($,tt),et===Z_NEED_DICT&&_e&&(et=inflate_1$2.inflateSetDictionary($,_e),et===Z_OK?et=inflate_1$2.inflate($,tt):et===Z_DATA_ERROR&&(et=Z_NEED_DICT));$.avail_in>0&&et===Z_STREAM_END&&$.state.wrap>0&&_[$.next_in]!==0;)inflate_1$2.inflateReset($),et=inflate_1$2.inflate($,tt);switch(et){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(et),this.ended=!0,!1}if(rt=$.avail_out,$.next_out&&($.avail_out===0||et===Z_STREAM_END))if(this.options.to==="string"){let nt=strings.utf8border($.output,$.next_out),it=$.next_out-nt,st=strings.buf2string($.output,nt);$.next_out=it,$.avail_out=j-it,it&&$.output.set($.output.subarray(nt,nt+it),0),this.onData(st)}else this.onData($.output.length===$.next_out?$.output:$.output.subarray(0,$.next_out));if(!(et===Z_OK&&rt===0)){if(et===Z_STREAM_END)return et=inflate_1$2.inflateEnd(this.strm),this.onEnd(et),this.ended=!0,!0;if($.avail_in===0)break}}return!0};Inflate$1.prototype.onData=function(_){this.chunks.push(_)};Inflate$1.prototype.onEnd=function(_){_===Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=common$1.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg};function inflate$1(_,a){const $=new Inflate$1(a);if($.push(_),$.err)throw $.msg||messages$1[$.err];return $.result}function inflateRaw$1(_,a){return a=a||{},a.raw=!0,inflate$1(_,a)}var Inflate_1$1=Inflate$1,inflate_2=inflate$1,inflateRaw_1$1=inflateRaw$1,ungzip$1=inflate$1,constants=constants$2,inflate_1$1={Inflate:Inflate_1$1,inflate:inflate_2,inflateRaw:inflateRaw_1$1,ungzip:ungzip$1,constants};const{Deflate,deflate,deflateRaw,gzip}=deflate_1$1,{Inflate,inflate,inflateRaw,ungzip}=inflate_1$1;var Deflate_1=Deflate,deflate_1=deflate,deflateRaw_1=deflateRaw,gzip_1=gzip,Inflate_1=Inflate,inflate_1=inflate,inflateRaw_1=inflateRaw,ungzip_1=ungzip,constants_1=constants$2,pako={Deflate:Deflate_1,deflate:deflate_1,deflateRaw:deflateRaw_1,gzip:gzip_1,Inflate:Inflate_1,inflate:inflate_1,inflateRaw:inflateRaw_1,ungzip:ungzip_1,constants:constants_1};const DEFAULT_COMPRESSION_LEVEL=6;function createGet$8({repo:_,preload:a}){async function*$(j,_e={}){if(_e.compressionLevel!=null&&(_e.compressionLevel<-1||_e.compressionLevel>9))throw errCode(new Error("Compression level must be between -1 and 9"),"ERR_INVALID_PARAMS");if(_e.preload!==!1){let rt;try{rt=normalizeCidPath(j).split("/")}catch(nt){throw errCode(nt,"ERR_INVALID_PATH")}a(CID.parse(rt[0]))}const et=CID.asCID(j)||j,tt=await exporter(et,_.blocks,_e);if(tt.type==="file"||tt.type==="raw"){const rt=[];!_e.compress||_e.archive===!0?rt.push([{header:{name:tt.path,mode:tt.type==="file"&&tt.unixfs.mode,mtime:tt.type==="file"&&tt.unixfs.mtime?new Date(tt.unixfs.mtime.secs*1e3):void 0,size:tt.size,type:"file"},body:tt.content()}],pack()):rt.push(tt.content),_e.compress&&rt.push(async function*(nt){const it=await toBuffer(nt);yield pako.gzip(it,{level:_e.compressionLevel||DEFAULT_COMPRESSION_LEVEL})}),yield*pipe(...rt);return}if(tt.type==="directory"){const rt=[recursive(et,_.blocks,_e),async function*(nt){for await(const it of nt){const st={header:{name:it.path,size:it.size}};if(it.type==="file")st.header.type="file",st.header.mode=it.unixfs.mode!=null?it.unixfs.mode:void 0,st.header.mtime=it.unixfs.mtime?new Date(it.unixfs.mtime.secs*1e3):void 0,st.body=it.content();else if(it.type==="raw")st.header.type="file",st.body=it.content();else if(it.type==="directory")st.header.type="directory",st.header.mode=it.unixfs.mode!=null?it.unixfs.mode:void 0,st.header.mtime=it.unixfs.mtime?new Date(it.unixfs.mtime.secs*1e3):void 0;else throw errCode(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");yield st}},pack()];if(_e.compress){if(!_e.archive)throw errCode(new Error("file is not regular"),"ERR_INVALID_PATH");_e.compress&&rt.push(async function*(nt){const it=await toBuffer(nt);yield pako.gzip(it,{level:_e.compressionLevel||DEFAULT_COMPRESSION_LEVEL})})}yield*pipe(...rt);return}throw errCode(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS")}return withTimeoutOption($)}function createLs$8({repo:_,preload:a}){async function*$(j,_e={}){const et=normalizeCidPath(j),tt=et.split("/");_e.preload!==!1&&a(CID.parse(tt[0]));const rt=CID.asCID(et)||et,nt=await exporter(rt,_.blocks,_e);if(nt.type==="file"){yield mapFile(nt);return}if(nt.type==="directory"){for await(const it of nt.content())yield mapFile(it);return}throw errCode(new Error(`Unknown UnixFS type ${nt.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return withTimeoutOption($)}class RootAPI{constructor({preload:a,repo:$,hashers:j,options:_e}){const et=createAddAll$2({preload:a,repo:$,options:_e,hashers:j});this.addAll=et,this.add=createAdd$5({addAll:et}),this.cat=createCat$1({repo:$,preload:a}),this.get=createGet$8({repo:$,preload:a}),this.ls=createLs$8({repo:$,preload:a})}}const ipfsCore="0.17.0",commit="e8b7b66bfa98c2a1c0d0bfc19f698d7d00b6c888",interfaceIpfsCore="^0.157.0";function createVersion$3({repo:_}){async function a($={}){const j=await _.version.get();return{version:ipfsCore,commit,repo:`${j}`,"ipfs-core":ipfsCore,"interface-ipfs-core":interfaceIpfsCore}}return withTimeoutOption(a)}const log$1p=logger$1("ipfs:components:id");function createId$1({peerId:_,network:a}){async function $(j={}){const _e=a.try();if(!_e){if(j.peerId)throw new NotStartedError;if(_.publicKey==null)throw errCode(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");return{id:_,publicKey:toString$6(_.publicKey,"base64pad"),addresses:[],agentVersion:`js-ipfs/${ipfsCore}`,protocolVersion:"9000",protocols:[]}}const{libp2p:et}=_e,tt=j.peerId?j.peerId:_,rt=await findPeer(tt,et,j),nt=toString$6(rt.metadata.get("AgentVersion")||new Uint8Array),it=toString$6(rt.metadata.get("ProtocolVersion")||new Uint8Array),st=rt.id.toString(),ot=rt.publicKey?toString$6(rt.publicKey,"base64pad"):"";return{id:tt,publicKey:ot,addresses:(rt.addresses||[]).map(at=>{const lt=at.toString();return lt.endsWith(`/p2p/${st}`)?lt:`${lt}/p2p/${st}`}).sort().map(at=>multiaddr(at)),agentVersion:nt,protocolVersion:it,protocols:(rt.protocols||[]).sort()}}return withTimeoutOption($)}async function findPeer(_,a,$){let j=await a.peerStore.get(_);j||(j=await findPeerOnDht(_,a,$));let _e=_.publicKey?_.publicKey:await a.peerStore.keyBook.get(_);if(_e==null)try{_e=await a.getPublicKey(_,$)}catch(et){log$1p.error("Could not load public key for",_.toString(),et)}return{...j,publicKey:_e,metadata:j.metadata||new Map,addresses:j.addresses.map(et=>et.multiaddr)}}async function findPeerOnDht(_,a,$){if(a.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");for await(const _e of a.dht.findPeer(_,$))if(_e.name==="FINAL_PEER")break;const j=await a.peerStore.get(_);if(!j)throw errCode(new Error("Could not find peer"),"ERR_NOT_FOUND");return j}var objectSafeSet=set;function set(_,a,$){var j,_e;if(Array.isArray(a)&&(j=a.slice(0)),typeof a=="string"&&(j=a.split(".")),typeof a=="symbol"&&(j=[a]),!Array.isArray(j))throw new Error("props arg must be an array, a string or a symbol");if(_e=j.pop(),!_e)return!1;prototypeCheck(_e);for(var et;et=j.shift();)if(prototypeCheck(et),typeof _[et]>"u"&&(_[et]={}),_=_[et],!_||typeof _!="object")return!1;return _[_e]=$,!0}function prototypeCheck(_){if(_=="__proto__"||_=="constructor"||_=="prototype")throw new Error("setting of prototype values not supported")}const profiles={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:_=>(objectSafeSet(_,"Discovery.MDNS.Enabled",!1),objectSafeSet(_,"Discovery.webRTCStar.Enabled",!1),_.Swarm={..._.Swarm||{},DisableNatPortMap:!0},_)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:_=>(objectSafeSet(_,"Discovery.MDNS.Enabled",!0),objectSafeSet(_,"Discovery.webRTCStar.Enabled",!0),objectSafeSet(_,"Swarm",{..._.Swarm||{},DisableNatPortMap:!1}),_)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:_=>{const a=getDefaultConfig();return objectSafeSet(_,"Addresses.API",a.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),objectSafeSet(_,"Addresses.Gateway",a.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),objectSafeSet(_,"Addresses.Swarm",a.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),objectSafeSet(_,"Addresses.Delegates",[]),objectSafeSet(_,"Bootstrap",[]),objectSafeSet(_,"Discovery.MDNS.Enabled",!1),objectSafeSet(_,"Discovery.webRTCStar.Enabled",!1),objectSafeSet(_,"Swarm",{..._.Swarm||{},DisableNatPortMap:!0}),_}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:_=>{const a=getDefaultConfig();return objectSafeSet(_,"Addresses.API",a.Addresses.API),objectSafeSet(_,"Addresses.Gateway",a.Addresses.Gateway),objectSafeSet(_,"Addresses.Swarm",a.Addresses.Swarm),objectSafeSet(_,"Addresses.Delegates",a.Addresses.Delegates),objectSafeSet(_,"Bootstrap",a.Bootstrap),objectSafeSet(_,"Discovery.MDNS.Enabled",a.Discovery.MDNS.Enabled),objectSafeSet(_,"Discovery.webRTCStar.Enabled",a.Discovery.webRTCStar.Enabled),objectSafeSet(_,"Swarm",{..._.Swarm||{},DisableNatPortMap:!1}),_}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:_=>{const a=_.Swarm||{},$=a.ConnMgr||{};return $.LowWater=20,$.HighWater=40,a.ConnMgr=$,_.Swarm=a,_}},"default-power":{description:'Inverse of "lowpower" profile.',transform:_=>{const a=getDefaultConfig();return _.Swarm=a.Swarm,_}}},log$1o=logger$1("ipfs:core:config");function createConfig$1({repo:_}){return{getAll:withTimeoutOption(a),get:withTimeoutOption($),set:withTimeoutOption(j),replace:withTimeoutOption(_e),profiles:{apply:withTimeoutOption(et),list:withTimeoutOption(listProfiles)}};async function a(tt={}){return _.config.getAll(tt)}async function $(tt,rt){return tt?_.config.get(tt,rt):Promise.reject(new Error("key argument is required"))}async function j(tt,rt,nt){return _.config.set(tt,rt,nt)}async function _e(tt,rt){return _.config.replace(tt,rt)}async function et(tt,rt={dryRun:!1}){const{dryRun:nt}=rt,it=profiles[tt];if(!it)throw new Error(`No profile with name '${tt}' exists`);try{const st=await _.config.getAll(rt);let ot=JSON.parse(JSON.stringify(st));return ot=it.transform(ot),nt||await _.config.replace(ot,rt),delete st.Identity.PrivKey,delete ot.Identity.PrivKey,{original:st,updated:ot}}catch(st){throw log$1o(st),new Error(`Could not apply profile '${tt}' to config: ${st.message}`)}}}async function listProfiles(_){return Object.keys(profiles).map(a=>({name:a,description:profiles[a].description}))}function readonly({enumerable:_=!0,configurable:a=!1}={}){return{enumerable:_,configurable:a,writable:!1}}function*linksWithin(_,a){if(a!=null&&typeof a=="object")if(Array.isArray(a))for(const[$,j]of a.entries()){const _e=[..._,$],et=CID.asCID(j);et?yield[_e.join("/"),et]:typeof j=="object"&&(yield*links(j,_e))}else{const $=CID.asCID(a);$?yield[_.join("/"),$]:yield*links(a,_)}}function*links(_,a){if(!(_==null||_ instanceof Uint8Array))for(const[$,j]of Object.entries(_)){const _e=[...a,$];yield*linksWithin(_e,j)}}function*treeWithin(_,a){if(Array.isArray(a))for(const[$,j]of a.entries()){const _e=[..._,$];yield _e.join("/"),typeof j=="object"&&!CID.asCID(j)&&(yield*tree(j,_e))}else yield*tree(a,_)}function*tree(_,a){if(!(_==null||typeof _!="object"))for(const[$,j]of Object.entries(_)){const _e=[...a,$];yield _e.join("/"),j!=null&&!(j instanceof Uint8Array)&&typeof j=="object"&&!CID.asCID(j)&&(yield*treeWithin(_e,j))}}function get$1(_,a){let $=_;for(const[j,_e]of a.entries()){if($=$[_e],$==null)throw new Error(`Object has no property at ${a.slice(0,j+1).map(tt=>`[${JSON.stringify(tt)}]`).join("")}`);const et=CID.asCID($);if(et)return{value:et,remaining:a.slice(j+1).join("/")}}return{value:$}}class Block{constructor({cid:a,bytes:$,value:j}){if(!a||!$||typeof j>"u")throw new Error("Missing required argument");this.cid=a,this.bytes=$,this.value=j,this.asBlock=this,Object.defineProperties(this,{cid:readonly(),bytes:readonly(),value:readonly(),asBlock:readonly()})}links(){return links(this.value,[])}tree(){return tree(this.value,[])}get(a="/"){return get$1(this.value,a.split("/").filter(Boolean))}}function createUnsafe({bytes:_,cid:a,value:$,codec:j}){const _e=$!==void 0?$:j&&j.decode(_);if(_e===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new Block({cid:a,bytes:_,value:_e})}function createHeader(_){const a=encode$q({version:1,roots:_}),$=varint$4.encode(a.length),j=new Uint8Array($.length+a.length);return j.set($,0),j.set(a,$.length),j}function createEncoder(_){return{async setRoots(a){const $=createHeader(a);await _.write($)},async writeBlock(a){const{cid:$,bytes:j}=a;await _.write(new Uint8Array(varint$4.encode($.bytes.length+j.length))),await _.write($.bytes),j.length&&await _.write(j)},async close(){await _.end()}}}function noop$5(){}function create$6(){const _=[];let a=null,$=noop$5,j=!1,_e=null,et=noop$5;const tt=()=>(a||(a=new Promise(it=>{$=()=>{a=null,$=noop$5,it()}})),a),rt={write(it){_.push(it);const st=tt();return et(),st},async end(){j=!0;const it=tt();et(),await it}},nt={async next(){const it=_.shift();return it?(_.length===0&&$(),{done:!1,value:it}):j?($(),{done:!0,value:void 0}):(_e||(_e=new Promise(st=>{et=()=>(_e=null,et=noop$5,st(nt.next()))})),_e)}};return{writer:rt,iterator:nt}}const Kinds={Null:_=>_===null,Int:_=>Number.isInteger(_),Float:_=>typeof _=="number"&&Number.isFinite(_),String:_=>typeof _=="string",Bool:_=>typeof _=="boolean",Bytes:_=>_ instanceof Uint8Array,Link:_=>!Kinds.Null(_)&&typeof _=="object"&&_.asCID===_,List:_=>Array.isArray(_),Map:_=>!Kinds.Null(_)&&typeof _=="object"&&_.asCID!==_&&!Kinds.List(_)&&!Kinds.Bytes(_)},Types={Int:Kinds.Int,"CarHeader > version":_=>Types.Int(_),"CarHeader > roots (anon) > valueType (anon)":Kinds.Link,"CarHeader > roots (anon)":_=>Kinds.List(_)&&Array.prototype.every.call(_,Types["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":_=>Types["CarHeader > roots (anon)"](_),CarHeader:_=>{const a=_&&Object.keys(_);return Kinds.Map(_)&&["version"].every($=>a.includes($))&&Object.entries(_).every(([$,j])=>Types["CarHeader > "+$]&&Types["CarHeader > "+$](j))}},CarHeader=Types.CarHeader,CIDV0_BYTES={SHA2_256:18,LENGTH:32,DAG_PB:112},V2_HEADER_LENGTH=16+8+8+8;async function readVarint(_){const a=await _.upTo(8);if(!a.length)throw new Error("Unexpected end of data");const $=varint$4.decode(a);return _.seek(varint$4.decode.bytes),$}async function readV2Header(_){const a=await _.exactly(V2_HEADER_LENGTH),$=new DataView(a.buffer,a.byteOffset,a.byteLength);let j=0;const _e={version:2,characteristics:[$.getBigUint64(j,!0),$.getBigUint64(j+=8,!0)],dataOffset:Number($.getBigUint64(j+=8,!0)),dataSize:Number($.getBigUint64(j+=8,!0)),indexOffset:Number($.getBigUint64(j+=8,!0))};return _.seek(V2_HEADER_LENGTH),_e}async function readHeader$1(_,a){const $=await readVarint(_);if($===0)throw new Error("Invalid CAR header (zero length)");const j=await _.exactly($);_.seek($);const _e=decode$k(j);if(!CarHeader(_e))throw new Error("Invalid CAR header format");if(_e.version!==1&&_e.version!==2||a!==void 0&&_e.version!==a)throw new Error(`Invalid CAR version: ${_e.version}${a!==void 0?` (expected ${a})`:""}`);const et=Array.isArray(_e.roots);if(_e.version===1&&!et||_e.version===2&&et)throw new Error("Invalid CAR header format");if(_e.version===1)return _e;const tt=await readV2Header(_);_.seek(tt.dataOffset-_.pos);const rt=await readHeader$1(_,1);return Object.assign(rt,tt)}async function readMultihash(_){const a=await _.upTo(8);varint$4.decode(a);const $=varint$4.decode.bytes,j=varint$4.decode(a.subarray(varint$4.decode.bytes)),_e=varint$4.decode.bytes,et=$+_e+j,tt=await _.exactly(et);return _.seek(et),tt}async function readCid(_){const a=await _.exactly(2);if(a[0]===CIDV0_BYTES.SHA2_256&&a[1]===CIDV0_BYTES.LENGTH){const tt=await _.exactly(34);_.seek(34);const rt=decode$n(tt);return CID.create(0,CIDV0_BYTES.DAG_PB,rt)}const $=await readVarint(_);if($!==1)throw new Error(`Unexpected CID version (${$})`);const j=await readVarint(_),_e=await readMultihash(_),et=decode$n(_e);return CID.create($,j,et)}async function readBlockHead(_){const a=_.pos;let $=await readVarint(_);if($===0)throw new Error("Invalid CAR section (zero length)");$+=_.pos-a;const j=await readCid(_),_e=$-Number(_.pos-a);return{cid:j,length:$,blockLength:_e}}async function readBlock(_){const{cid:a,blockLength:$}=await readBlockHead(_),j=await _.exactly($);return _.seek($),{bytes:j,cid:a}}async function readBlockIndex(_){const a=_.pos,{cid:$,length:j,blockLength:_e}=await readBlockHead(_),et={cid:$,length:j,blockLength:_e,offset:a,blockOffset:_.pos};return _.seek(et.blockLength),et}function createDecoder(_){const a=(async()=>{const $=await readHeader$1(_);if($.version===2){const j=_.pos-$.dataOffset;_=limitReader(_,$.dataSize-j)}return $})();return{header:()=>a,async*blocks(){for(await a;(await _.upTo(8)).length>0;)yield await readBlock(_)},async*blocksIndex(){for(await a;(await _.upTo(8)).length>0;)yield await readBlockIndex(_)}}}function bytesReader(_){let a=0;return{async upTo($){return _.subarray(a,a+Math.min($,_.length-a))},async exactly($){if($>_.length-a)throw new Error("Unexpected end of data");return _.subarray(a,a+$)},seek($){a+=$},get pos(){return a}}}function chunkReader(_){let a=0,$=0,j=0,_e=new Uint8Array(0);const et=async tt=>{$=_e.length-j;const rt=[_e.subarray(j)];for(;$<tt;){const it=await _();if(it==null)break;$<0?it.length>$&&rt.push(it.subarray(-$)):rt.push(it),$+=it.length}_e=new Uint8Array(rt.reduce((it,st)=>it+st.length,0));let nt=0;for(const it of rt)_e.set(it,nt),nt+=it.length;j=0};return{async upTo(tt){return _e.length-j<tt&&await et(tt),_e.subarray(j,j+Math.min(_e.length-j,tt))},async exactly(tt){if(_e.length-j<tt&&await et(tt),_e.length-j<tt)throw new Error("Unexpected end of data");return _e.subarray(j,j+tt)},seek(tt){a+=tt,j+=tt},get pos(){return a}}}function asyncIterableReader(_){const a=_[Symbol.asyncIterator]();async function $(){const j=await a.next();return j.done?null:j.value}return chunkReader($)}function limitReader(_,a){let $=0;return{async upTo(j){let _e=await _.upTo(j);return _e.length+$>a&&(_e=_e.subarray(0,a-$)),_e},async exactly(j){const _e=await _.exactly(j);if(_e.length+$>a)throw new Error("Unexpected end of data");return _e},seek(j){$+=j,_.seek(j)},get pos(){return _.pos}}}class CarWriter{constructor(a,$){this._encoder=$,this._mutex=$.setRoots(a),this._ended=!1}async put(a){if(!(a.bytes instanceof Uint8Array)||!a.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");const $=CID.asCID(a.cid);if(!$)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:$,bytes:a.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(a){a=toRoots(a);const{encoder:$,iterator:j}=encodeWriter(),_e=new CarWriter(a,$),et=new CarWriterOut(j);return{writer:_e,out:et}}static createAppender(){const{encoder:a,iterator:$}=encodeWriter();a.setRoots=()=>Promise.resolve();const j=new CarWriter([],a),_e=new CarWriterOut($);return{writer:j,out:_e}}static async updateRootsInBytes(a,$){const j=bytesReader(a);await readHeader$1(j);const _e=createHeader($);if(Number(j.pos)!==_e.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${j.pos} bytes, new header is ${_e.length} bytes)`);return a.set(_e,0),a}}class CarWriterOut{constructor(a){this._iterator=a}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}}function encodeWriter(){const _=create$6(),{writer:a,iterator:$}=_;return{encoder:createEncoder(a),iterator:$}}function toRoots(_){if(_===void 0)return[];if(!Array.isArray(_)){const $=CID.asCID(_);if(!$)throw new TypeError("roots must be a single CID or an array of CIDs");return[$]}const a=[];for(const $ of _){const j=CID.asCID($);if(!j)throw new TypeError("roots must be a single CID or an array of CIDs");a.push(j)}return a}const walk=async({cid:_,load:a,seen:$})=>{$=$||new Set;const j=_.toString(base58btc$2);if($.has(j))return;const _e=await a(_);if($.add(j),_e!==null)for(const[,et]of _e.links())await walk({cid:et,load:a,seen:$})},log$1n=logger$1("ipfs:components:dag:import"),NO_LINKS_CODECS=[code$4,code$3];function createExport$3({repo:_,preload:a,codecs:$}){async function*j(_e,et={}){et.preload!==!1&&a(_e);const tt=CID.asCID(_e);if(!tt)throw new Error(`Unexpected error converting CID type: ${_e}`);log$1n(`Exporting ${tt} as car`);const{writer:rt,out:nt}=await CarWriter.create([tt]);let it=null;(async()=>{try{const st=makeLoader(_,rt,{signal:et.signal,timeout:et.timeout},$);await walk({cid:tt,load:st})}catch(st){it=st}finally{rt.close()}})();for await(const st of nt){if(it)break;yield st}if(it)throw it}return withTimeoutOption(j)}function makeLoader(_,a,$,j){return async _e=>{const et=await j.getCodec(_e.code);if(!et)throw new Error(`Can't decode links in block with codec 0x${_e.code.toString(16)} to form complete DAG`);const tt=await _.blocks.get(_e,$);return log$1n(`Adding block ${_e} to car`),await a.put({cid:_e,bytes:tt}),NO_LINKS_CODECS.includes(_e.code)?null:createUnsafe({bytes:tt,cid:_e,codec:et})}}async function first$2(_){for await(const a of _)return a}function createGet$7({codecs:_,repo:a,preload:$}){return withTimeoutOption(async function(et,tt={}){if(tt.preload!==!1&&$(et),tt.path){const ot=tt.localResolve?await first$2(resolve$5(et,tt.path,_,a,tt)):await last(resolve$5(et,tt.path,_,a,tt));if(!ot)throw errCode(new Error("Not found"),"ERR_NOT_FOUND");return ot}const rt=await _.getCodec(et.code),nt=await a.blocks.get(et,tt);return{value:rt.decode(nt),remainderPath:""}})}class CarIteratorBase{constructor(a,$,j){this._version=a,this._roots=$,this._iterable=j,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}}class CarBlockIterator extends CarIteratorBase{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(a){const{version:$,roots:j,iterator:_e}=await fromBytes(a);return new CarBlockIterator($,j,_e)}static async fromIterable(a){const{version:$,roots:j,iterator:_e}=await fromIterable(a);return new CarBlockIterator($,j,_e)}}async function fromBytes(_){if(!(_ instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return decodeIterator(bytesReader(_))}async function fromIterable(_){if(!_||typeof _[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return decodeIterator(asyncIterableReader(_))}async function decodeIterator(_){const a=createDecoder(_),{version:$,roots:j}=await a.header();return{version:$,roots:j,iterator:a.blocks()}}const log$1m=logger$1("ipfs:components:dag:import");function createImport$3({repo:_}){async function*a($,j={}){const _e=await _.gcLock.readLock();try{const et={signal:j.signal,timeout:j.timeout},tt=peekableIterator($),{value:rt,done:nt}=await tt.peek();if(nt)return;rt&&tt.push(rt);let it;rt instanceof Uint8Array?it=[tt]:it=tt;for await(const st of it){const ot=await importCar(_,et,st);if(j.pinRoots!==!1)for(const at of ot){let lt="";try{await _.blocks.has(at)?(log$1m(`Pinning root ${at}`),await _.pins.pinRecursively(at)):lt="blockstore: block not found"}catch(ct){lt=ct.message}yield{root:{cid:at,pinErrorMsg:lt}}}}}finally{_e()}}return withTimeoutOption(a)}async function importCar(_,a,$){const j=await CarBlockIterator.fromIterable($),_e=await j.getRoots();return await drain$3(_.blocks.putMany(map$6(j,({cid:et,bytes:tt})=>(log$1m(`Import block ${et}`),{key:et,value:tt})),{signal:a.signal})),_e}function createPut$5({repo:_,codecs:a,hashers:$,preload:j}){async function _e(et,tt={}){const rt=tt.pin?await _.gcLock.readLock():null;try{const nt=await a.getCodec(tt.storeCodec||"dag-cbor");if(!nt)throw new Error(`Unknown storeCodec ${tt.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(tt.inputCodec){if(!(et instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");const ct=await a.getCodec(tt.inputCodec);if(!ct)throw new Error(`Unknown inputCodec ${tt.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);et=ct.decode(et)}const it=tt.version!=null?tt.version:1,st=await $.getHasher(tt.hashAlg||"sha2-256");if(!st)throw new Error(`Unknown hash algorithm ${tt.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);const ot=nt.encode(et),at=await st.digest(ot),lt=CID.create(it,nt.code,at);return await _.blocks.put(lt,ot,{signal:tt.signal}),tt.pin&&await _.pins.pinRecursively(lt),tt.preload!==!1&&j(lt),lt}finally{rt&&rt()}}return withTimeoutOption(_e)}function createResolve$3({repo:_,codecs:a,preload:$}){async function j(_e,et={}){const{cid:tt}=toCidAndPath(_e);return et.preload!==!1&&$(tt),resolvePath$1(_,a,_e,et)}return withTimeoutOption(j)}class DagAPI{constructor({repo:a,codecs:$,hashers:j,preload:_e}){this.export=createExport$3({repo:a,preload:_e,codecs:$}),this.get=createGet$7({codecs:$,repo:a,preload:_e}),this.import=createImport$3({repo:a}),this.resolve=createResolve$3({repo:a,codecs:$,preload:_e}),this.put=createPut$5({repo:a,codecs:$,hashers:j,preload:_e})}}const reduceValue=(_,a)=>a,tcpUri=(_,a,$,j)=>{if(j!=null&&j.assumeHttp===!1)return`tcp://${_}:${a}`;let _e="tcp",et=`:${a}`;return $[$.length-1].protocol==="tcp"&&(_e=a==="443"?"https":"http",et=a==="443"||a==="80"?"":et),`${_e}://${_}${et}`},Reducers={ip4:reduceValue,ip6:(_,a,$,j)=>j.length===1&&j[0].protocol==="ip6"?a:`[${a}]`,tcp:(_,a,$,j,_e)=>j.some(et=>["http","https","ws","wss"].includes(et.protocol))?`${_}:${a}`:tcpUri(_,a,j,_e),udp:(_,a)=>`udp://${_}:${a}`,dnsaddr:reduceValue,dns4:reduceValue,dns6:reduceValue,ipfs:(_,a)=>`${_}/ipfs/${a}`,p2p:(_,a)=>`${_}/p2p/${a}`,http:_=>`http://${_}`,https:_=>`https://${_}`,ws:_=>`ws://${_}`,wss:_=>`wss://${_}`,"p2p-websocket-star":_=>`${_}/p2p-websocket-star`,"p2p-webrtc-star":_=>`${_}/p2p-webrtc-star`,"p2p-webrtc-direct":_=>`${_}/p2p-webrtc-direct`};function multiaddrToUri(_,a){const $=multiaddr(_),j=$.toString().split("/").slice(1);return $.tuples().map(_e=>({protocol:j.shift()??"",content:_e[1]!=null?j.shift()??"":""})).reduce((_e,et,tt,rt)=>{const nt=Reducers[et.protocol];if(nt==null)throw new Error(`Unsupported protocol ${et.protocol}`);return nt(_e,et.content,tt,rt,a)},"")}function arrayShuffle(_){if(!Array.isArray(_))throw new TypeError(`Expected an array, got ${typeof _}`);_=[..._];for(let a=_.length-1;a>0;a--){const $=Math.floor(Math.random()*(a+1));[_[a],_[$]]=[_[$],_[a]]}return _}const log$1l=logger$1("ipfs:preload"),Queue$2=PQueue.default?PQueue.default:PQueue,httpQueue=new Queue$2({concurrency:4});function preload(_,a={}){return log$1l(_),httpQueue.add(async()=>{const j=(await http.post(_,{signal:a.signal})).body.getReader();try{for(;;){const{done:_e}=await j.read();if(_e)return}}finally{j.releaseLock()}})}const log$1k=logger$1("ipfs:preload");function createPreloader(_={}){if(_.enabled=Boolean(_.enabled),_.addresses=_.addresses||[],_.cache=_.cache||1e3,!_.enabled||!_.addresses.length)return log$1k("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let a=!0,$=[];const j=_.addresses.map(tt=>multiaddrToUri(tt)),_e=hashlru(_.cache),et=async tt=>{try{if(a)throw new Error(`preload ${tt} but preloader is not started`);const rt=tt.toString();if(_e.has(rt))return;_e.set(rt,!0);const nt=arrayShuffle(j);let it=!1;const st=Date.now();for(const ot of nt){if(a)throw new Error(`preload aborted for ${rt}`);let at;try{at=new AbortController,$=$.concat(at),await preload(`${ot}/api/v0/refs?r=true&arg=${encodeURIComponent(rt)}`,{signal:at.signal}),it=!0}catch(lt){lt.type!=="aborted"&&log$1k.error(lt)}finally{$=$.filter(lt=>lt!==at)}if(it)break}log$1k(`${it?"":"un"}successfully preloaded ${rt} in ${Date.now()-st}ms`)}catch(rt){log$1k.error(rt)}};return et.start=()=>{a=!1},et.stop=()=>{a=!0,log$1k(`aborting ${$.length} pending preload request(s)`),$.forEach(tt=>tt.abort()),$=[]},et}const log$1j=logger$1("ipfs:mfs-preload");function createMfsPreloader({preload:_,files:a,options:$={}}){if($.interval=$.interval||30*1e3,!$.enabled){log$1j("MFS preload disabled");const tt=async()=>{};return{start:tt,stop:tt}}let j="",_e;const et=async()=>{try{const tt=await a.stat("/"),rt=tt.cid.toString();j!==rt&&(log$1j(`preloading updated MFS root ${j} -> ${tt.cid}`),await _(tt.cid),j=rt)}catch(tt){log$1j.error("failed to preload MFS root",tt)}finally{_e=setTimeout(et,$.interval)}};return{async start(){const tt=await a.stat("/");j=tt.cid.toString(),log$1j(`monitoring MFS root ${tt.cid}`),_e=setTimeout(et,$.interval)},stop(){clearTimeout(_e)}}}class TimeoutError$1 extends Error{constructor(a){super(a),this.name="TimeoutError"}}class AbortError$3 extends Error{constructor(a){super(),this.name="AbortError",this.message=a}}const getDOMException$1=_=>globalThis.DOMException===void 0?new AbortError$3(_):new DOMException(_),getAbortedReason$1=_=>{const a=_.reason===void 0?getDOMException$1("This operation was aborted."):_.reason;return a instanceof Error?a:getDOMException$1(a)};function pTimeout$1(_,a){const{milliseconds:$,fallback:j,message:_e,customTimers:et={setTimeout,clearTimeout}}=a;let tt;const rt=new Promise((nt,it)=>{if(typeof $!="number"||Math.sign($)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${$}\``);if($===Number.POSITIVE_INFINITY){nt(_);return}if(a.signal){const{signal:st}=a;st.aborted&&it(getAbortedReason$1(st)),st.addEventListener("abort",()=>{it(getAbortedReason$1(st))})}tt=et.setTimeout.call(void 0,()=>{if(j){try{nt(j())}catch(at){it(at)}return}const st=typeof _e=="string"?_e:`Promise timed out after ${$} milliseconds`,ot=_e instanceof Error?_e:new TimeoutError$1(st);typeof _.cancel=="function"&&_.cancel(),it(ot)},$),(async()=>{try{nt(await _)}catch(st){it(st)}finally{et.clearTimeout.call(void 0,tt)}})()});return rt.clear=()=>{et.clearTimeout.call(void 0,tt),tt=void 0},rt}const WORKER_REQUEST_READ_LOCK="lock:worker:request-read",WORKER_RELEASE_READ_LOCK="lock:worker:release-read",MASTER_GRANT_READ_LOCK="lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK="lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK="lock:worker:release-write",MASTER_GRANT_WRITE_LOCK="lock:master:grant-write",events$1={},observable=_=>{_.addEventListener("message",a=>{observable.dispatchEvent("message",_,a)}),_.port!=null&&_.port.addEventListener("message",a=>{observable.dispatchEvent("message",_,a)})};observable.addEventListener=(_,a)=>{events$1[_]==null&&(events$1[_]=[]),events$1[_].push(a)};observable.removeEventListener=(_,a)=>{events$1[_]!=null&&(events$1[_]=events$1[_].filter($=>$===a))};observable.dispatchEvent=function(_,a,$){events$1[_]!=null&&events$1[_].forEach(j=>j(a,$))};const handleWorkerLockRequest=(_,a,$,j,_e)=>(et,tt)=>{if(tt.data.type!==$)return;const rt={type:tt.data.type,name:tt.data.name,identifier:tt.data.identifier};_.dispatchEvent(new MessageEvent(a,{data:{name:rt.name,handler:async()=>(et.postMessage({type:_e,name:rt.name,identifier:rt.identifier}),await new Promise(nt=>{const it=st=>{if(st==null||st.data==null)return;const ot={type:st.data.type,name:st.data.name,identifier:st.data.identifier};ot.type===j&&ot.identifier===rt.identifier&&(et.removeEventListener("message",it),nt())};et.addEventListener("message",it)}))}}))},makeWorkerLockRequest=(_,a,$,j)=>async()=>{const _e=nanoid();return globalThis.postMessage({type:a,identifier:_e,name:_}),await new Promise(et=>{const tt=rt=>{if(rt==null||rt.data==null)return;const nt={type:rt.data.type,identifier:rt.data.identifier};nt.type===$&&nt.identifier===_e&&(globalThis.removeEventListener("message",tt),et(()=>{globalThis.postMessage({type:j,identifier:_e,name:_})}))};globalThis.addEventListener("message",tt)})},defaultOptions$j={singleProcess:!1},impl=_=>{if(_=Object.assign({},defaultOptions$j,_),Boolean(globalThis.document)||_.singleProcess){const $=new EventTarget;return observable.addEventListener("message",handleWorkerLockRequest($,"requestReadLock",WORKER_REQUEST_READ_LOCK,WORKER_RELEASE_READ_LOCK,MASTER_GRANT_READ_LOCK)),observable.addEventListener("message",handleWorkerLockRequest($,"requestWriteLock",WORKER_REQUEST_WRITE_LOCK,WORKER_RELEASE_WRITE_LOCK,MASTER_GRANT_WRITE_LOCK)),$}return{isWorker:!0,readLock:$=>makeWorkerLockRequest($,WORKER_REQUEST_READ_LOCK,MASTER_GRANT_READ_LOCK,WORKER_RELEASE_READ_LOCK),writeLock:$=>makeWorkerLockRequest($,WORKER_REQUEST_WRITE_LOCK,MASTER_GRANT_WRITE_LOCK,WORKER_RELEASE_WRITE_LOCK)}},mutexes={};let implementation;async function createReleaseable(_,a){let $;const j=new Promise(_e=>{$=_e});return _.add(async()=>await pTimeout$1((async()=>await new Promise(_e=>{$(()=>{_e()})}))(),{milliseconds:a.timeout})),await j}const createMutex=(_,a)=>{if(implementation.isWorker===!0)return{readLock:implementation.readLock(_,a),writeLock:implementation.writeLock(_,a)};const $=new PQueue({concurrency:1});let j;return{async readLock(){if(j!=null)return await createReleaseable(j,a);j=new PQueue({concurrency:a.concurrency,autoStart:!1});const _e=j,et=createReleaseable(j,a);return $.add(async()=>(_e.start(),await _e.onIdle().then(()=>{j===_e&&(j=null)}))),await et},async writeLock(){return j=null,await createReleaseable($,a)}}},defaultOptions$i={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function createMortice(_){const a=Object.assign({},defaultOptions$i,_);return implementation==null&&(implementation=impl(a),implementation.isWorker!==!0&&(implementation.addEventListener("requestReadLock",$=>{mutexes[$.data.name]!=null&&mutexes[$.data.name].readLock().then(async j=>await $.data.handler().finally(()=>j()))}),implementation.addEventListener("requestWriteLock",async $=>{mutexes[$.data.name]!=null&&mutexes[$.data.name].writeLock().then(async j=>await $.data.handler().finally(()=>j()))}))),mutexes[a.name]==null&&(mutexes[a.name]=createMutex(a.name,a)),mutexes[a.name]}let lock$1;function createLock(_=!1){if(lock$1)return lock$1;const a=createMortice({singleProcess:_});return lock$1={readLock:$=>async(...j)=>{const _e=await a.readLock();try{return await $.apply(null,j)}finally{_e()}},writeLock:$=>async(...j)=>{const _e=await a.writeLock();try{return await $.apply(null,j)}finally{_e()}}},lock$1}const log$1i=logger$1("ipfs:mfs:utils:with-mfs-root");async function loadMfsRoot(_,a){if(a&&a.signal&&a.signal.aborted)throw errCode(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await _.repo.datastore.open();let $;try{const j=await _.repo.datastore.get(MFS_ROOT_KEY$2);$=CID.decode(j)}catch(j){if(j.code!=="ERR_NOT_FOUND")throw j;log$1i("Creating new MFS root");const _e=encode$s({Data:new UnixFS({type:"directory"}).marshal(),Links:[]}),et=await sha256$4.digest(_e);if($=CID.createV0(et),await _.repo.blocks.put($,_e),a&&a.signal&&a.signal.aborted)throw errCode(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await _.repo.datastore.put(MFS_ROOT_KEY$2,$.bytes)}return log$1i(`Loaded MFS root /ipfs/${$}`),$}function toPathComponents(_=""){return(_.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}const IPFS_PREFIX="ipfs",toMfsPath=async(_,a,$)=>{const j=await loadMfsRoot(_,$);let _e={entryType:"file"},et="";if(CID.asCID(a)?et=`/ipfs/${a}`:et=a.toString(),et=et.trim(),et=et.replace(/(\/\/+)/g,"/"),et.endsWith("/")&&et.length>1&&(et=et.substring(0,et.length-1)),!et)throw errCode(new Error("paths must not be empty"),"ERR_NO_PATH");if(et.substring(0,1)!=="/")throw errCode(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");et.substring(et.length-1)==="/"&&(et=et.substring(0,et.length-1));const tt=toPathComponents(et);if(tt[0]===IPFS_PREFIX){let nt;tt.length===2?nt=`/${tt.join("/")}`:nt=`/${tt.slice(0,tt.length-1).join("/")}`,_e={type:"ipfs",depth:tt.length-2,entryType:"file",mfsPath:`/${tt.join("/")}`,mfsDirectory:nt,parts:tt,path:`/${tt.join("/")}`,name:tt[tt.length-1]}}else{const nt=`/${IPFS_PREFIX}/${j}${tt.length?"/"+tt.join("/"):""}`,it=`/${IPFS_PREFIX}/${j}/${tt.slice(0,tt.length-1).join("/")}`;_e={type:"mfs",depth:tt.length,entryType:"file",mfsDirectory:it,mfsPath:nt,parts:tt,path:`/${tt.join("/")}`,name:tt[tt.length-1]}}const rt=_e.type==="mfs"?_e.mfsPath:_e.path;try{const nt=await exporter(rt,_.repo.blocks,$);_e.cid=nt.cid,_e.mfsPath=`/ipfs/${nt.path}`,_e.entryType=nt.type,_e.content=nt.content,(_e.entryType==="file"||_e.entryType==="directory")&&(nt.type==="file"||nt.type==="directory")&&(_e.unixfs=nt.unixfs)}catch(nt){if(nt.code!=="ERR_NOT_FOUND")throw nt}return _e.exists=Boolean(_e.cid),_e},mergeOptions$c=mergeOptions$g.bind({ignoreUndefined:!0}),log$1h=logger$1("ipfs:mfs:stat"),defaultOptions$h={withLocal:!1};function createStat$7(_){async function a($,j={}){j=mergeOptions$c(defaultOptions$h,j),log$1h(`Fetching stats for ${$}`);const{type:_e,cid:et,mfsPath:tt}=await toMfsPath(_,$,j),rt=_e==="ipfs"&&et?et:tt;let nt;try{nt=await exporter(rt,_.repo.blocks)}catch(it){throw it.code==="ERR_NOT_FOUND"?errCode(new Error(`${$} does not exist`),"ERR_NOT_FOUND"):it}if(!statters[nt.type])throw new Error(`Cannot stat codec ${nt.cid.code}`);return statters[nt.type](nt)}return withTimeoutOption(a)}const statters={raw:_=>({cid:_.cid,size:_.node.length,cumulativeSize:_.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:_=>{const a={cid:_.cid,type:"file",size:_.unixfs.fileSize(),cumulativeSize:encode$s(_.node).length+(_.node.Links||[]).reduce(($,j)=>$+(j.Tsize||0),0),blocks:_.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:_.unixfs.mode};return _.unixfs.mtime&&(a.mtime=_.unixfs.mtime),a},directory:_=>{const a={cid:_.cid,type:"directory",size:0,cumulativeSize:encode$s(_.node).length+(_.node.Links||[]).reduce(($,j)=>$+(j.Tsize||0),0),blocks:_.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:_.unixfs.mode};return _.unixfs.mtime&&(a.mtime=_.unixfs.mtime),a},object:_=>({cid:_.cid,size:_.node.length,cumulativeSize:_.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:_=>({cid:_.cid,size:_.node.length,cumulativeSize:_.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})},log$1g=logger$1("ipfs:mfs:utils:to-trail");async function toTrail(_,a){log$1g(`Creating trail for path ${a}`);const $=[];for await(const j of walkPath(a,_.repo.blocks))$.push({name:j.name,cid:j.cid,size:j.size,type:j.type});return $}const persist=async(_,a,$)=>{$.codec||($.codec=dagPB),$.hasher||($.hasher=sha256$4),$.cidVersion===void 0&&($.cidVersion=1),$.codec===dagPB&&$.hasher!==sha256$4&&($.cidVersion=1);const j=await $.hasher.digest(_),_e=CID.create($.cidVersion,$.codec.code,j);return $.onlyHash||await a.put(_e,_,{signal:$.signal}),_e},hamtHashCode=murmur3128.code,hamtBucketBits=8;async function hamtHashFn(_){return(await murmur3128.encode(_)).subarray(0,8).reverse()}class Dir{constructor(a,$){this.options=$||{},this.root=a.root,this.dir=a.dir,this.path=a.path,this.dirty=a.dirty,this.flat=a.flat,this.parent=a.parent,this.parentKey=a.parentKey,this.unixfs=a.unixfs,this.mode=a.mode,this.mtime=a.mtime,this.cid=void 0,this.size=void 0}async put(a,$){}get(a){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(a){}}class DirSharded extends Dir{constructor(a,$){super(a,$),this._bucket=createHAMT({hashFn:hamtHashFn,bits:hamtBucketBits})}async put(a,$){await this._bucket.put(a,$)}get(a){return this._bucket.get(a)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:a,value:$}of this._bucket.eachLeafSeries())yield{key:a,child:$}}async*flush(a){yield*flush(this._bucket,a,this,this.options)}}async function*flush(_,a,$,j){const _e=_._children,et=[];let tt=0;for(let lt=0;lt<_e.length;lt++){const ct=_e.get(lt);if(!ct)continue;const ut=lt.toString(16).toUpperCase().padStart(2,"0");if(ct instanceof Bucket){let dt;for await(const ft of await flush(ct,a,null,j))dt=ft;if(!dt)throw new Error("Could not flush sharded directory, no subshard found");et.push({Name:ut,Tsize:dt.size,Hash:dt.cid}),tt+=dt.size}else if(typeof ct.value.flush=="function"){const dt=ct.value;let ft;for await(const yt of dt.flush(a))ft=yt,yield ft;const pt=ut+ct.key;et.push({Name:pt,Tsize:ft.size,Hash:ft.cid}),tt+=ft.size}else{const dt=ct.value;if(!dt.cid)continue;const ft=ut+ct.key,pt=dt.size;et.push({Name:ft,Tsize:pt,Hash:dt.cid}),tt+=pt}}const rt=Uint8Array.from(_e.bitField().reverse()),it={Data:new UnixFS({type:"hamt-sharded-directory",data:rt,fanout:_.tableSize(),hashType:hamtHashCode,mtime:$&&$.mtime,mode:$&&$.mode}).marshal(),Links:et},st=encode$s(prepare(it)),ot=await persist(st,a,j),at=st.length+tt;yield{cid:ot,node:it,size:at}}const log$1f=logger$1("ipfs:mfs:core:utils:hamt-utils"),updateHamtDirectory=async(_,a,$,j)=>{if(!j.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");const _e=Uint8Array.from($._children.bitField().reverse()),et=UnixFS.unmarshal(j.parent.Data),tt=new UnixFS({type:"hamt-sharded-directory",data:_e,fanout:$.tableSize(),hashType:hamtHashCode,mode:et.mode,mtime:et.mtime}),rt=await _.hashers.getHasher(j.hashAlg),nt={Data:tt.marshal(),Links:a.sort((at,lt)=>(at.Name||"").localeCompare(lt.Name||""))},it=encode$s(nt),st=await rt.digest(it),ot=CID.create(j.cidVersion,code$9,st);return j.flush&&await _.repo.blocks.put(ot,it),{node:nt,cid:ot,size:a.reduce((at,lt)=>at+(lt.Tsize||0),it.length)}},recreateHamtLevel=async(_,a,$,j,_e)=>{const et=new Bucket({hash:$._options.hash,bits:$._options.bits},j,_e);return j._putObjectAt(_e,et),await addLinksToHamtBucket(_,a,et,$),et},recreateInitialHamtLevel=async _=>{const a=createHAMT({hashFn:hamtHashFn,bits:hamtBucketBits});return await Promise.all(_.map(async $=>{const j=$.Name||"";if(j.length===2){const _e=parseInt(j,16),et=new Bucket({hash:a._options.hash,bits:a._options.bits},a,_e);return a._putObjectAt(_e,et),Promise.resolve()}return a.put(j.substring(2),{size:$.Tsize,cid:$.Hash})})),a},addLinksToHamtBucket=async(_,a,$,j)=>{await Promise.all(a.map(async _e=>{const et=_e.Name||"";if(et.length===2){log$1f("Populating sub bucket",et);const tt=parseInt(et,16),rt=await _.repo.blocks.get(_e.Hash),nt=decode$m(rt),it=new Bucket({hash:j._options.hash,bits:j._options.bits},$,tt);return $._putObjectAt(tt,it),await addLinksToHamtBucket(_,nt.Links,it,j),Promise.resolve()}return j.put(et.substring(2),{size:_e.Tsize,cid:_e.Hash})}))},toPrefix=_=>_.toString(16).toUpperCase().padStart(2,"0").substring(0,2),generatePath=async(_,a,$)=>{const j=await recreateInitialHamtLevel($.Links),_e=await j._findNewBucketAndPos(a),et=[{bucket:_e.bucket,prefix:toPrefix(_e.pos)}];let tt=_e.bucket;for(;tt!==j;)et.push({bucket:tt,prefix:toPrefix(tt._posAtParent)}),tt=tt._parent;et.reverse(),et[0].node=$;for(let rt=0;rt<et.length;rt++){const nt=et[rt];if(!nt.node)throw new Error("Could not generate HAMT path");const it=nt.node.Links.filter(lt=>(lt.Name||"").substring(0,2)===nt.prefix).pop();if(!it){log$1f(`Link ${nt.prefix}${a} will be added`);continue}if(it.Name===`${nt.prefix}${a}`){log$1f(`Link ${nt.prefix}${a} will be replaced`);continue}log$1f(`Found subshard ${nt.prefix}`);const st=await _.repo.blocks.get(it.Hash),ot=decode$m(st);if(!et[rt+1]){log$1f(`Loaded new subshard ${nt.prefix}`),await recreateHamtLevel(_,ot.Links,j,nt.bucket,parseInt(nt.prefix,16));const lt=await j._findNewBucketAndPos(a);et.push({bucket:lt.bucket,prefix:toPrefix(lt.pos),node:ot});continue}const at=et[rt+1];await addLinksToHamtBucket(_,ot.Links,at.bucket,j),at.node=ot}return await j.put(a,!0),et.reverse(),{rootBucket:j,path:et}},createShard=async(_,a,$={})=>{const j=new DirSharded({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:$.mtime,mode:$.mode},$);for(let et=0;et<a.length;et++)await j._bucket.put(a[et].name,{size:a[et].size,cid:a[et].cid});const _e=await last(j.flush(_.repo.blocks));if(!_e)throw new Error("Flushing shard yielded no result");return _e},log$1e=logger$1("ipfs:mfs:core:utils:add-link");async function addLink(_,a){let $=a.parent;if(a.parentCid){const _e=CID.asCID(a.parentCid);if(_e===null)throw errCode(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(_e.code!==code$9)throw errCode(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");log$1e(`Loading parent node ${_e}`);const et=await _.repo.blocks.get(_e);$=decode$m(et)}if(!$)throw errCode(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!a.cid)throw errCode(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!a.name)throw errCode(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!a.size&&a.size!==0)throw errCode(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!$.Data)throw errCode(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");const j=UnixFS.unmarshal($.Data);return j.type==="hamt-sharded-directory"?(log$1e("Adding link to sharded directory"),addToShardedDirectory(_,{...a,parent:$})):$.Links.length>=a.shardSplitThreshold?(log$1e("Converting directory to sharded directory"),convertToShardedDirectory(_,{...a,parent:$,mtime:j.mtime,mode:j.mode})):(log$1e(`Adding ${a.name} (${a.cid}) to regular directory`),addToDirectory(_,{...a,parent:$}))}const convertToShardedDirectory=async(_,a)=>{const $=await createShard(_,a.parent.Links.map(j=>({name:j.Name||"",size:j.Tsize||0,cid:j.Hash})).concat({name:a.name,size:a.size,cid:a.cid}),a);return log$1e(`Converted directory to sharded directory ${$.cid}`),$},addToDirectory=async(_,a)=>{const $=a.parent.Links.filter(it=>it.Name!==a.name);if($.push({Name:a.name,Tsize:a.size,Hash:a.cid}),!a.parent.Data)throw errCode(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");const j=UnixFS.unmarshal(a.parent.Data);let _e;if(j.mtime){const it=Date.now(),st=Math.floor(it/1e3);j.mtime={secs:st,nsecs:(it-st*1e3)*1e3},_e=j.marshal()}else _e=a.parent.Data;a.parent=prepare({Data:_e,Links:$});const et=await _.hashers.getHasher(a.hashAlg),tt=encode$s(a.parent),rt=await et.digest(tt),nt=CID.create(a.cidVersion,code$9,rt);return a.flush&&await _.repo.blocks.put(nt,tt),{node:a.parent,cid:nt,size:tt.length}},addToShardedDirectory=async(_,a)=>{const{shard:$,path:j}=await addFileToShardedDirectory(_,a),_e=await last($.flush(_.repo.blocks));if(!_e)throw new Error("No result from flushing shard");const et=await _.repo.blocks.get(_e.cid),tt=decode$m(et),rt=a.parent.Links.filter(it=>(it.Name||"").substring(0,2)!==j[0].prefix),nt=tt.Links.find(it=>(it.Name||"").substring(0,2)===j[0].prefix);if(!nt)throw new Error(`No link found with prefix ${j[0].prefix}`);return rt.push(nt),updateHamtDirectory(_,rt,j[0].bucket,a)},addFileToShardedDirectory=async(_,a)=>{const $={name:a.name,cid:a.cid,size:a.size};if(!a.parent.Data)throw errCode(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");const j=await recreateInitialHamtLevel(a.parent.Links),_e=UnixFS.unmarshal(a.parent.Data),et=new DirSharded({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:_e.mode},a);et._bucket=j,_e.mtime&&(et.mtime={secs:Math.round(Date.now()/1e3)});const tt=await j._findNewBucketAndPos($.name),rt=toBucketPath(tt);rt[0].node=a.parent;let nt=0;for(;nt<rt.length;){const it=rt[nt];nt++;const st=it.node;if(!st)throw new Error("Segment had no node");const ot=st.Links.find(ut=>(ut.Name||"").substring(0,2)===it.prefix);if(!ot){log$1e(`Link ${it.prefix}${$.name} will be added`),nt=rt.length;break}if(ot.Name===`${it.prefix}${$.name}`){log$1e(`Link ${it.prefix}${$.name} will be replaced`),nt=rt.length;break}if((ot.Name||"").length>2){log$1e(`Link ${ot.Name} ${ot.Hash} will be replaced with a subshard`),nt=rt.length;break}log$1e(`Found subshard ${it.prefix}`);const at=await _.repo.blocks.get(ot.Hash),lt=decode$m(at);if(!rt[nt]){log$1e(`Loaded new subshard ${it.prefix}`),await recreateHamtLevel(_,lt.Links,j,it.bucket,parseInt(it.prefix,16));const ut=await j._findNewBucketAndPos($.name);rt.push({bucket:ut.bucket,prefix:toPrefix(ut.pos),node:lt});break}const ct=rt[nt];await addLinksToHamtBucket(_,lt.Links,ct.bucket,j),ct.node=lt}return await et._bucket.put($.name,{size:$.size,cid:$.cid}),{shard:et,path:rt}},toBucketPath=_=>{const a=[{bucket:_.bucket,prefix:toPrefix(_.pos)}];let $=_.bucket._parent,j=_.bucket._posAtParent;for(;$;)a.push({bucket:$,prefix:toPrefix(j)}),j=$._posAtParent,$=$._parent;return a.reverse(),a},log$1d=logger$1("ipfs:mfs:utils:update-tree"),defaultOptions$g={shardSplitThreshold:1e3};async function updateTree(_,a,$){$=Object.assign({},defaultOptions$g,$),log$1d("Trail",a),a=a.slice().reverse();let j=0,_e;for await(const tt of _.repo.blocks.getMany(a.map(rt=>rt.cid))){const rt=decode$m(tt),nt=a[j].cid,it=a[j].name;if(j++,!_e){_e={cid:nt,name:it,size:tt.length};continue}const st=await addLink(_,{parent:rt,name:_e.name,cid:_e.cid,size:_e.size,flush:$.flush,shardSplitThreshold:$.shardSplitThreshold,hashAlg:$.hashAlg,cidVersion:$.cidVersion});_e={cid:st.cid,name:it,size:st.size}}const{cid:et}=_e;return log$1d(`Final CID ${et}`),et}const log$1c=logger$1("ipfs:mfs:utils:update-mfs-root");async function updateMfsRoot(_,a,$){if($&&$.signal&&$.signal.aborted)throw errCode(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return log$1c(`New MFS root will be ${a}`),await _.repo.datastore.put(MFS_ROOT_KEY$2,a.bytes),a}async function createNode$1(_,a,$){const j=new UnixFS({type:a,mode:$.mode,mtime:$.mtime}),_e=await _.hashers.getHasher($.hashAlg),et={Data:j.marshal(),Links:[]},tt=encode$s(et),rt=await _e.digest(tt),nt=CID.create($.cidVersion,code$9,rt);return $.flush&&await _.repo.blocks.put(nt,tt),{cid:nt,node:et}}const mergeOptions$b=mergeOptions$g.bind({ignoreUndefined:!0}),log$1b=logger$1("ipfs:mfs:mkdir"),defaultOptions$f={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};function createMkdir$1(_){async function a($,j={}){const _e=mergeOptions$b(defaultOptions$f,j);if(!$)throw new Error("no path given to Mkdir");if($=$.trim(),$==="/"){if(_e.parents)return;throw errCode(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if($.substring(0,1)!=="/")throw errCode(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");log$1b(`Creating ${$}`);const et=toPathComponents($);if(et[0]==="ipfs")throw errCode(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");const tt=await loadMfsRoot(_,_e);let rt;const nt=[],it=await createNode$1(_,"directory",_e);for(let ot=0;ot<=et.length;ot++){const at=et.slice(0,ot),lt=`/ipfs/${tt}/${at.join("/")}`;try{if(rt=await exporter(lt,_.repo.blocks),rt.type!=="file"&&rt.type!=="directory")throw errCode(new Error(`${$} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(ot===et.length){if(_e.parents)return;throw errCode(new Error("file already exists"),"ERR_ALREADY_EXISTS")}nt.push({name:rt.name,cid:rt.cid})}catch(ct){if(ct.code==="ERR_NOT_FOUND"){if(ot<et.length&&!_e.parents)throw errCode(new Error(`Intermediate directory path ${lt} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await addEmptyDir$1(_,at[at.length-1],it,nt[nt.length-1],nt,_e)}else throw ct}}const st=await updateTree(_,nt,_e);await updateMfsRoot(_,st,_e)}return withTimeoutOption(a)}const addEmptyDir$1=async(_,a,$,j,_e,et)=>{log$1b(`Adding empty dir called ${a} to ${j.cid}`);const tt=await addLink(_,{parent:j.node,parentCid:j.cid,size:0,cid:$.cid,name:a,hashAlg:et.hashAlg,cidVersion:et.cidVersion,flush:et.flush,shardSplitThreshold:et.shardSplitThreshold});_e[_e.length-1].cid=tt.cid,_e.push({name:a,cid:$.cid})},mergeOptions$a=mergeOptions$g.bind({ignoreUndefined:!0}),log$1a=logger$1("ipfs:mfs:cp"),defaultOptions$e={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};function createCp$1(_){async function a($,j,_e={}){const et=mergeOptions$a(defaultOptions$e,_e);Array.isArray($)||($=[$]);const tt=await Promise.all($.map(at=>toMfsPath(_,at,et)));let rt=await toMfsPath(_,j,et);if(!tt.length||!rt)throw errCode(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");const nt=tt.find(at=>!at.exists);if(nt)throw errCode(new Error(`${nt.path} does not exist`),"ERR_INVALID_PARAMS");const it=isDirectory(rt);if(rt.exists){if(log$1a("Destination exists"),tt.length===1&&!it)throw errCode(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(log$1a("Destination does not exist"),tt.length>1){if(!et.parents)throw errCode(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await createMkdir$1(_)(rt.path,et),rt=await toMfsPath(_,rt.path,et)}else if(rt.parts.length>1){const at=`/${rt.parts.slice(0,-1).join("/")}`;try{await createStat$7(_)(at,et)}catch(lt){if(lt.code!=="ERR_NOT_FOUND")throw lt;if(!et.parents)throw errCode(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await createMkdir$1(_)(at,et),rt=await toMfsPath(_,rt.path,et)}}const st=isDirectory(rt)?rt.mfsPath:rt.mfsDirectory,ot=await toTrail(_,st);if(tt.length===1){const at=tt.pop();if(!at)throw errCode(new Error("could not find source"),"ERR_INVALID_PARAMS");const lt=it?at.name:rt.name;return log$1a(`Only one source, copying to destination ${it?"directory":"file"} ${lt}`),copyToFile(_,at,lt,ot,et)}return log$1a("Multiple sources, wrapping in a directory"),copyToDirectory(_,tt,rt,ot,et)}return withTimeoutOption(a)}const isDirectory=_=>_.unixfs&&_.unixfs.type&&_.unixfs.type.includes("directory"),copyToFile=async(_,a,$,j,_e)=>{let et=j.pop();if(!et)throw errCode(new Error("destination had no parent"),"ERR_INVALID_PARAMS");et=await addSourceToParent(_,a,$,et,_e),j.push(et);const tt=await updateTree(_,j,_e);await updateMfsRoot(_,tt,_e)},copyToDirectory=async(_,a,$,j,_e)=>{for(let tt=0;tt<a.length;tt++){const rt=a[tt];$=await addSourceToParent(_,rt,rt.name,$,_e)}j[j.length-1]=$;const et=await updateTree(_,j,_e);await updateMfsRoot(_,et,_e)},addSourceToParent=async(_,a,$,j,_e)=>{const et=await _.repo.blocks.get(a.cid),{node:tt,cid:rt,size:nt}=await addLink(_,{parentCid:j.cid,size:et.length,cid:a.cid,name:$,hashAlg:_e.hashAlg,cidVersion:_e.cidVersion,flush:_e.flush,shardSplitThreshold:_e.shardSplitThreshold});return j.node=tt,j.cid=rt,j.size=nt,j},log$19=logger$1("ipfs:mfs:core:utils:remove-link");async function removeLink(_,a){let $=a.parent;if(a.parentCid){const _e=CID.asCID(a.parentCid);if(_e===null)throw errCode(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");log$19(`Loading parent node ${_e}`);const et=await _.repo.blocks.get(_e);$=decode$m(et)}if(!$)throw errCode(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!a.name)throw errCode(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!$.Data)throw errCode(new Error("Parent node had no data"),"ERR_INVALID_NODE");return UnixFS.unmarshal($.Data).type==="hamt-sharded-directory"?(log$19(`Removing ${a.name} from sharded directory`),removeFromShardedDirectory(_,{...a,parent:$})):(log$19(`Removing link ${a.name} regular directory`),removeFromDirectory(_,{...a,parent:$}))}const removeFromDirectory=async(_,a)=>{a.parent.Links=a.parent.Links.filter(tt=>tt.Name!==a.name);const $=await encode$s(a.parent),_e=await(await _.hashers.getHasher(a.hashAlg)).digest($),et=CID.create(a.cidVersion,code$9,_e);return await _.repo.blocks.put(et,$),log$19(`Updated regular directory ${et}`),{node:a.parent,cid:et}},removeFromShardedDirectory=async(_,a)=>{const{rootBucket:$,path:j}=await generatePath(_,a.name,a.parent);await $.del(a.name);const{node:_e}=await updateShard(_,j,a.name,a);return updateHamtDirectory(_,_e.Links,$,a)},updateShard=async(_,a,$,j)=>{const _e=a.pop();if(!_e)throw errCode(new Error("Could not find parent"),"EINVALIDPARENT");const{bucket:et,prefix:tt,node:rt}=_e;if(!rt)throw errCode(new Error("Could not find parent"),"EINVALIDPARENT");const nt=rt.Links.find(lt=>(lt.Name||"").substring(0,2)===tt);if(!nt)throw errCode(new Error(`No link found with prefix ${tt} for file ${$}`),"ERR_NOT_FOUND");if(nt.Name===`${tt}${$}`){log$19(`Removing existing link ${nt.Name}`);const lt=rt.Links.filter(ct=>ct.Name!==nt.Name);return await et.del($),updateHamtDirectory(_,lt,et,j)}log$19(`Descending into sub-shard ${nt.Name} for ${tt}${$}`);const it=await updateShard(_,a,$,j);let st=it.cid,ot=it.size,at=tt;if(it.node.Links.length===1){log$19(`Removing subshard for ${tt}`);const lt=it.node.Links[0];at=`${tt}${(lt.Name||"").substring(2)}`,st=lt.Hash,ot=lt.Tsize||0}return log$19(`Updating shard ${tt} with name ${at}`),updateShardParent(_,et,rt,tt,at,ot,st,j)},updateShardParent=(_,a,$,j,_e,et,tt,rt)=>{const nt=$.Links.filter(it=>it.Name!==j);return nt.push({Name:_e,Tsize:et,Hash:tt}),updateHamtDirectory(_,nt,a,rt)},mergeOptions$9=mergeOptions$g.bind({ignoreUndefined:!0}),defaultOptions$d={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};function createRm$8(_){async function a($,j={}){const _e=mergeOptions$9(defaultOptions$d,j);Array.isArray($)||($=[$]);const et=await Promise.all($.map(tt=>toMfsPath(_,tt,_e)));if(!et.length)throw errCode(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");et.forEach(tt=>{if(tt.path==="/")throw errCode(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(const tt of et)await removePath(_,tt.path,_e)}return withTimeoutOption(a)}const removePath=async(_,a,$)=>{const j=await toMfsPath(_,a,$),_e=await toTrail(_,j.mfsPath),et=_e[_e.length-1];_e.pop();const tt=_e[_e.length-1];if(!tt)throw errCode(new Error(`${a} does not exist`),"ERR_NOT_FOUND");if(et.type==="directory"&&!$.recursive)throw errCode(new Error(`${a} is a directory, use -r to remove directories`),"ERR_WAS_DIR");const{cid:rt}=await removeLink(_,{parentCid:tt.cid,name:et.name,hashAlg:$.hashAlg,cidVersion:$.cidVersion,flush:$.flush,shardSplitThreshold:$.shardSplitThreshold});tt.cid=rt;const nt=await updateTree(_,_e,$);await updateMfsRoot(_,nt,$)},mergeOptions$8=mergeOptions$g.bind({ignoreUndefined:!0}),log$18=logger$1("ipfs:mfs:touch"),defaultOptions$c={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function calculateModification(_,a,$){let j=0;return(_.includes("x")||_.includes("X")&&($||a&1||a&8||a&64))&&(j+=1),_.includes("w")&&(j+=2),_.includes("r")&&(j+=4),j}function calculateUGO(_,a){let $=0;return _.includes("u")&&($+=a<<6),_.includes("g")&&($+=a<<3),_.includes("o")&&($+=a),$}function calculateSpecial(_,a,$){return a.includes("t")&&($+=parseInt("1000",8)),a.includes("s")&&(_.includes("u")&&($+=parseInt("4000",8)),_.includes("g")&&($+=parseInt("2000",8))),$}function parseSymbolicMode(_,a,$){a||(a=0);const j=_.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!j)throw new Error(`Invalid file mode: ${_}`);let[,_e,et,tt]=j;(_e==="a"||!_e)&&(_e="ugo");let rt=calculateModification(tt,a,$);return rt=calculateUGO(_e,rt),rt=calculateSpecial(_e,tt,rt),et==="="?(_e.includes("u")&&(a=a&parseInt("7077",8),a=a|rt),_e.includes("g")&&(a=a&parseInt("7707",8),a=a|rt),_e.includes("o")&&(a=a&parseInt("7770",8),a=a|rt),a):et==="+"?rt|a:et==="-"?rt^a:a}function calculateMode(_,a){if(_ instanceof String||typeof _=="string"){const $=`${_}`;$.match(/^\d+$/g)?_=parseInt($,8):_=0+$.split(",").reduce((j,_e)=>parseSymbolicMode(_e,j,a.isDirectory()),a.mode||0)}return _}function createChmod$1(_){async function a($,j,_e={}){const et=mergeOptions$8(defaultOptions$c,_e);log$18(`Fetching stats for ${$}`);const{cid:tt,mfsDirectory:rt,name:nt}=await toMfsPath(_,$,et);if(tt.code!==code$9)throw errCode(new Error(`${$} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(et.recursive){const St=await pipe(async function*(){for await(const It of recursive(tt,_.repo.blocks)){if(It.type!=="file"&&It.type!=="directory")throw errCode(new Error(`${$} was not a UnixFS node`),"ERR_NOT_UNIXFS");It.unixfs.mode=calculateMode(j,It.unixfs);const Lt=prepare({Data:It.unixfs.marshal(),Links:It.node.Links});yield{path:It.path,content:Lt}}},It=>importer(It,_.repo.blocks,{...et,pin:!1,dagBuilder:async function*(Lt,Mt,Kt){for await(const kt of Lt)yield async function(){const gt=kt.content,Et=encode$s(gt),xt=await persist(Et,Mt,Kt);if(!gt.Data)throw errCode(new Error(`${xt} had no data`),"ERR_INVALID_NODE");const Tt=UnixFS.unmarshal(gt.Data);return{cid:xt,size:Et.length,path:kt.path,unixfs:Tt}}}}),It=>last(It));if(!St)throw errCode(new Error(`Could not chmod ${$}`),"ERR_COULD_NOT_CHMOD");await createRm$8(_)($,et),await createCp$1(_)(`/ipfs/${St.cid}`,$,et);return}const it=await _.repo.blocks.get(tt),st=decode$m(it);if(!st.Data)throw errCode(new Error(`${tt} had no data`),"ERR_INVALID_NODE");const ot=UnixFS.unmarshal(st.Data);ot.mode=calculateMode(j,ot);const at=encode$s({Data:ot.marshal(),Links:st.Links}),lt=et.hashAlg||defaultOptions$c.hashAlg,ut=await(await _.hashers.getHasher(lt)).digest(at),dt=CID.create(et.cidVersion,code$9,ut);et.flush&&await _.repo.blocks.put(dt,at);const ft=await toTrail(_,rt),pt=ft[ft.length-1],yt=CID.decode(pt.cid.bytes),mt=await _.repo.blocks.get(yt),_t=decode$m(mt),vt=await addLink(_,{parent:_t,name:nt,cid:dt,size:at.length,flush:et.flush,hashAlg:lt,cidVersion:tt.version,shardSplitThreshold:1/0});pt.cid=vt.cid;const ht=await updateTree(_,ft,et);await updateMfsRoot(_,ht,et)}return withTimeoutOption(a)}const mergeOptions$7=mergeOptions$g.bind({ignoreUndefined:!0}),defaultOptions$b={};function createFlush$1(_){async function a($,j={}){j=mergeOptions$7(defaultOptions$b,j);const{cid:_e}=await createStat$7(_)($,j);return _e}return withTimeoutOption(a)}const mergeOptions$6=mergeOptions$g.bind({ignoreUndefined:!0}),defaultOptions$a={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};function createMv$1(_){async function a($,j,_e={}){const et=mergeOptions$6(defaultOptions$a,_e);await createCp$1(_)($,j,et),await createRm$8(_)($,{...et,recursive:!0})}return withTimeoutOption(a)}const mergeOptions$5=mergeOptions$g.bind({ignoreUndefined:!0}),log$17=logger$1("ipfs:mfs:touch"),defaultOptions$9={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};function createTouch$1(_){async function a($,j={}){const _e=mergeOptions$5(defaultOptions$9,j);_e.mtime=_e.mtime||new Date,log$17(`Touching ${$} mtime: ${_e.mtime}`);const{cid:et,mfsDirectory:tt,name:rt,exists:nt}=await toMfsPath(_,$,_e),it=j.hashAlg||defaultOptions$9.hashAlg,st=await _.hashers.getHasher(it);let ot,at,lt=_e.cidVersion;if(nt){if(et.code!==code$9)throw errCode(new Error(`${$} was not a UnixFS node`),"ERR_NOT_UNIXFS");lt=et.version;const _t=await _.repo.blocks.get(et),vt=decode$m(_t);if(!vt.Data)throw errCode(new Error(`${$} had no data`),"ERR_INVALID_NODE");const ht=UnixFS.unmarshal(vt.Data);ht.mtime=_e.mtime,ot=encode$s({Data:ht.marshal(),Links:vt.Links});const St=await st.digest(ot);at=CID.create(_e.cidVersion,code$9,St),_e.flush&&await _.repo.blocks.put(at,ot)}else{const _t=new UnixFS({type:"file",mtime:_e.mtime});ot=encode$s({Data:_t.marshal(),Links:[]});const vt=await st.digest(ot);at=CID.create(_e.cidVersion,code$9,vt),_e.flush&&await _.repo.blocks.put(at,ot)}const ct=await toTrail(_,tt),ut=ct[ct.length-1],dt=ut.cid,ft=await _.repo.blocks.get(dt),pt=decode$m(ft),yt=await addLink(_,{parent:pt,name:rt,cid:at,size:ot.length,flush:_e.flush,shardSplitThreshold:_e.shardSplitThreshold,hashAlg:_e.hashAlg,cidVersion:lt});ut.cid=yt.cid;const mt=await updateTree(_,ct,_e);await updateMfsRoot(_,mt,_e)}return withTimeoutOption(a)}const mergeOptions$4=mergeOptions$g.bind({ignoreUndefined:!0}),defaultOptions$8={offset:0,length:1/0};function createRead$1(_){function a($,j={}){return j=mergeOptions$4(defaultOptions$8,j),{[Symbol.asyncIterator]:async function*(){const et=await toMfsPath(_,$,j),tt=await exporter(et.mfsPath,_.repo.blocks);if(tt.type!=="file")throw errCode(new Error(`${$} was not a file`),"ERR_NOT_FILE");if(!tt.content)throw errCode(new Error(`Could not load content stream from ${$}`),"ERR_NO_CONTENT");for await(const rt of tt.content({offset:j.offset,length:j.length}))yield rt}}}return withTimeoutOption(a)}const log$16=logger$1("ipfs:mfs:utils:to-async-iterator");function toAsyncIterator(_){if(!_)throw errCode(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if((typeof _=="string"||_ instanceof String)&&(log$16("Content was a string"),_=fromString$5(_.toString())),_.length)return log$16("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield _}};if(_[Symbol.asyncIterator])return log$16("Content was an async iterator"),_;if(_[Symbol.iterator])return log$16("Content was an iterator"),_;if({}.Blob&&_ instanceof{}.Blob){log$16("Content was an HTML5 Blob");let a=0;const $={next:()=>a>_.size?{done:!0}:new Promise((j,_e)=>{const et=_.slice(a,MFS_MAX_CHUNK_SIZE);a+=MFS_MAX_CHUNK_SIZE;const tt=new{}.FileReader,rt=nt=>{if(tt.removeEventListener("loadend",rt,!1),nt.error)return _e(nt.error);j({done:!1,value:new Uint8Array(tt.result)})};tt.addEventListener("loadend",rt),tt.readAsArrayBuffer(et)})};return{[Symbol.asyncIterator]:()=>$}}throw errCode(new Error(`Don't know how to convert ${_} into an async iterator`),"ERR_INVALID_PARAMS")}const mergeOptions$3=mergeOptions$g.bind({ignoreUndefined:!0}),log$15=logger$1("ipfs:mfs:write"),defaultOptions$7={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(_,a)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};function createWrite$1(_){async function a($,j,_e={}){const et=mergeOptions$3(defaultOptions$7,_e);let tt,rt,nt;if(log$15("Reading source, destination and parent"),await createLock().readLock(async()=>{tt=await toAsyncIterator(j),rt=await toMfsPath(_,$,et),nt=await toMfsPath(_,rt.mfsDirectory,et)})(),log$15("Read source, destination and parent"),!et.parents&&!nt.exists)throw errCode(new Error("directory does not exist"),"ERR_NO_EXIST");if(tt==null)throw errCode(new Error("could not create source"),"ERR_NO_SOURCE");if(rt==null)throw errCode(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!et.create&&!rt.exists)throw errCode(new Error("file does not exist"),"ERR_NO_EXIST");if(rt.entryType!=="file")throw errCode(new Error("not a file"),"ERR_NOT_A_FILE");return updateOrImport(_,$,tt,rt,et)}return withTimeoutOption(a)}const updateOrImport=async(_,a,$,j,_e)=>{const et=await write$1(_,$,j,_e);await createLock().writeLock(async()=>{const tt=toPathComponents(a),rt=tt.pop();if(rt==null)throw errCode(new Error("source does not exist"),"ERR_NO_EXIST");let nt=!1;try{await createStat$7(_)(`/${tt.join("/")}`,_e),nt=!0}catch(dt){if(dt.code!=="ERR_NOT_FOUND")throw dt}nt||await createMkdir$1(_)(`/${tt.join("/")}`,_e);const it=await toMfsPath(_,a,_e),st=await toTrail(_,it.mfsDirectory),ot=st[st.length-1];if(!ot)throw errCode(new Error("directory does not exist"),"ERR_NO_EXIST");if(!ot.type||!ot.type.includes("directory"))throw errCode(new Error(`cannot write to ${ot.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");const at=await _.repo.blocks.get(ot.cid),lt=decode$m(at),ct=await addLink(_,{parent:lt,name:rt,cid:et.cid,size:et.size,flush:_e.flush,shardSplitThreshold:_e.shardSplitThreshold,hashAlg:_e.hashAlg,cidVersion:_e.cidVersion});ot.cid=ct.cid;const ut=await updateTree(_,st,_e);await updateMfsRoot(_,ut,_e)})()},write$1=async(_,a,$,j)=>{$.exists?log$15(`Overwriting file ${$.cid} offset ${j.offset} length ${j.length}`):log$15(`Writing file offset ${j.offset} length ${j.length}`);const _e=[];if(j.offset>0)if($.unixfs){if(log$15(`Writing first ${j.offset} bytes of original file`),_e.push(()=>$.content({offset:0,length:j.offset})),$.unixfs.fileSize()<j.offset){const st=j.offset-$.unixfs.fileSize();log$15(`Writing zeros for extra ${st} bytes`),_e.push(asyncZeroes(st))}}else log$15(`Writing zeros for first ${j.offset} bytes`),_e.push(asyncZeroes(j.offset));_e.push(limitAsyncStreamBytes(a,j.length));const et=countBytesStreamed(catAsyncIterators(_e),st=>{if($.unixfs&&!j.truncate){const ot=$.unixfs.fileSize();if(ot>st)return log$15(`Writing last ${ot-st} of ${ot} bytes from original file starting at offset ${st}`),$.content({offset:st});log$15("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}});let tt;j.mode!==void 0&&j.mode!==null?tt=parseMode(j.mode):$&&$.unixfs&&(tt=$.unixfs.mode);let rt;j.mtime!=null?rt=parseMtime$1(j.mtime):$&&$.unixfs&&(rt=$.unixfs.mtime);const nt=await _.hashers.getHasher(j.hashAlg),it=await last(importer([{content:et,mode:tt,mtime:rt}],_.repo.blocks,{progress:j.progress,hasher:nt,cidVersion:j.cidVersion,strategy:j.strategy,rawLeaves:j.rawLeaves,reduceSingleLeafToSelf:j.reduceSingleLeafToSelf,leafType:j.leafType}));if(!it)throw errCode(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return log$15(`Wrote ${it.cid}`),{cid:it.cid,size:it.size}},limitAsyncStreamBytes=(_,a)=>async function*(){let j=0;for await(const _e of _){if(j+=_e.length,j>a){yield _e.subarray(0,a-j);return}yield _e}},asyncZeroes=(_,a=MFS_MAX_CHUNK_SIZE)=>{const $=new Uint8Array(a);async function*j(){for(;;)yield $}return limitAsyncStreamBytes(j(),_)},catAsyncIterators=async function*(_){for(let a=0;a<_.length;a++)yield*_[a]()},countBytesStreamed=async function*(_,a){let $=0;for await(const j of _)$+=j.length,yield j;for await(const j of a($))$+=j.length,yield j},toOutput=_=>{const a={cid:_.cid,name:_.name,type:_.type==="directory"?"directory":"file",size:_.size};return(_.type==="file"||_.type==="directory")&&(a.mode=_.unixfs.mode,a.mtime=_.unixfs.mtime),a};function createLs$7(_){async function*a($,j={}){const _e=await toMfsPath(_,$,j),et=await exporter(_e.mfsPath,_.repo.blocks);if(et.type==="directory"){yield*map$6(et.content(j),toOutput);return}yield toOutput(et)}return withTimeoutOption(a)}const readOperations={stat:createStat$7},writeOperations={chmod:createChmod$1,cp:createCp$1,flush:createFlush$1,mkdir:createMkdir$1,mv:createMv$1,rm:createRm$8,touch:createTouch$1},unwrappedOperations={write:createWrite$1,read:createRead$1,ls:createLs$7},wrap=({options:_,mfs:a,operations:$,lock:j})=>{Object.keys($).forEach(_e=>{a[_e]=j($[_e](_))})},defaultOptions$6={repoOwner:!0,repo:null};function createMfs(_){const{repoOwner:a}=Object.assign({},defaultOptions$6||{},_),$=createLock(a),j=tt=>$.readLock(tt),_e=tt=>$.writeLock(tt),et={};return wrap({options:_,mfs:et,operations:readOperations,lock:j}),wrap({options:_,mfs:et,operations:writeOperations,lock:_e}),Object.keys(unwrappedOperations).forEach(tt=>{et[tt]=unwrappedOperations[tt](_)}),et}function createFiles$1({repo:_,preload:a,hashers:$,options:j}){const _e=createMfs({repo:_,repoOwner:j.repoOwner!==!1,hashers:$}),et=tt=>(...nt)=>{const it=nt.filter(st=>ipfsPath$1(st)||isCID(st));if(it.length){const st=nt[nt.length-1];st&&st.preload!==!1&&it.forEach(ot=>a(ot))}return tt(...nt)};return{..._e,chmod:_e.chmod,cp:et(_e.cp),mkdir:_e.mkdir,stat:et(_e.stat),rm:_e.rm,read:et(_e.read),touch:_e.touch,write:_e.write,mv:et(_e.mv),flush:_e.flush,ls:et(async function*(...tt){for await(const rt of _e.ls(...tt))yield{...rt,size:rt.size||0}})}}function createExport$2({keychain:_}){return withTimeoutOption(($,j)=>_.exportKey($,j))}const DEFAULT_KEY_TYPE="Ed25519",DEFAULT_KEY_SIZE=2048;function createGen$1({keychain:_}){return withTimeoutOption(($,j={type:DEFAULT_KEY_TYPE,size:DEFAULT_KEY_SIZE})=>_.createKey($,j.type||DEFAULT_KEY_TYPE,j.size||DEFAULT_KEY_SIZE))}function createImport$2({keychain:_}){return withTimeoutOption(($,j,_e)=>_.importKey($,j,_e))}function createInfo$1({keychain:_}){return withTimeoutOption($=>_.findKeyByName($))}function createList$3({keychain:_}){return withTimeoutOption(()=>_.listKeys())}function createRename$1({keychain:_}){return withTimeoutOption(async($,j)=>{const _e=await _.renameKey($,j);return{was:$,now:_e.name,id:_e.id,overwrite:!1}})}function createRm$7({keychain:_}){return withTimeoutOption($=>_.removeKey($))}class KeyAPI{constructor({keychain:a}){this.gen=createGen$1({keychain:a}),this.list=createList$3({keychain:a}),this.rm=createRm$7({keychain:a}),this.rename=createRename$1({keychain:a}),this.export=createExport$2({keychain:a}),this.import=createImport$2({keychain:a}),this.info=createInfo$1({keychain:a})}}function createGet$6({repo:_,preload:a}){async function $(j,_e={}){_e.preload!==!1&&a(j);const et=await _.blocks.get(j,_e);return decode$m(et)}return withTimeoutOption($)}function createData$1({repo:_,preload:a}){const $=createGet$6({repo:_,preload:a});async function j(_e,et={}){return(await $(_e,et)).Data||new Uint8Array(0)}return withTimeoutOption(j)}function findLinks(_,a=[]){for(const $ in _){const j=_[$];if($==="/"&&Object.keys(_).length===1)try{a.push({Name:"",Tsize:0,Hash:CID.parse(j)});continue}catch{}const _e=CID.asCID(j);if(_e){a.push({Name:"",Tsize:0,Hash:_e});continue}Array.isArray(j)&&findLinks(j,a),j&&typeof j=="object"&&findLinks(j,a)}return a}function createLinks$1({repo:_,codecs:a}){async function $(j,_e={}){const et=await a.getCodec(j.code),tt=await _.blocks.get(j,_e),rt=et.decode(tt);switch(j.code){case code$4:return[];case code$9:return rt.Links;case code$8:case code$7:return findLinks(rt);default:throw new Error(`Cannot resolve links from codec ${j.code}`)}}return withTimeoutOption($)}function createNew$1({repo:_,preload:a}){async function $(j={}){let _e;if(j.template)if(j.template==="unixfs-dir")_e=new UnixFS({type:"directory"}).marshal();else throw new Error("unknown template");const et=encode$s({Data:_e,Links:[]}),tt=await sha256$4.digest(et),rt=CID.createV0(tt);return await _.blocks.put(rt,et,{signal:j.signal}),j.preload!==!1&&a(rt),rt}return withTimeoutOption($)}function createPut$4({repo:_,preload:a}){async function $(j,_e={}){const et=await _.gcLock.readLock();try{const tt=encode$s(j),rt=await sha256$4.digest(tt),nt=CID.createV1(code$9,rt);return await _.blocks.put(nt,tt,{signal:_e.signal}),_e.preload!==!1&&a(nt),_e.pin&&await _.pins.pinRecursively(nt,{signal:_e.signal}),nt}finally{et()}}return withTimeoutOption($)}function createStat$6({repo:_,preload:a}){const $=createGet$6({repo:_,preload:a});async function j(_e,et={}){const tt=await $(_e,et),nt=encode$s(tt).length,it=tt.Links.reduce((st,ot)=>st+(ot.Tsize||0),0);return{Hash:_e,NumLinks:tt.Links.length,BlockSize:nt,LinksSize:nt-(tt.Data||[]).length,DataSize:(tt.Data||[]).length,CumulativeSize:nt+it}}return withTimeoutOption(j)}function createAddLink$1({repo:_,preload:a}){const $=createGet$6({repo:_,preload:a}),j=createPut$4({repo:_,preload:a});async function _e(et,tt,rt={}){const nt=await $(et,rt);return j({...nt,Links:nt.Links.concat([tt])},rt)}return withTimeoutOption(_e)}function createAppendData$1({repo:_,preload:a}){const $=createGet$6({repo:_,preload:a}),j=createPut$4({repo:_,preload:a});async function _e(et,tt,rt={}){const nt=await $(et,rt),it=concat$1([nt.Data||[],tt]);return j({...nt,Data:it},rt)}return withTimeoutOption(_e)}function createRmLink$1({repo:_,preload:a}){const $=createGet$6({repo:_,preload:a}),j=createPut$4({repo:_,preload:a});async function _e(et,tt,rt={}){const nt=await $(et,rt),it=(typeof tt=="string"?tt:tt.Name)||"";return nt.Links=nt.Links.filter(st=>st.Name!==it),j(nt,rt)}return withTimeoutOption(_e)}function createSetData$1({repo:_,preload:a}){const $=createGet$6({repo:_,preload:a}),j=createPut$4({repo:_,preload:a});async function _e(et,tt,rt={}){const nt=await $(et,rt);return j({...nt,Data:tt},rt)}return withTimeoutOption(_e)}class ObjectPatchAPI{constructor({repo:a,preload:$}){this.addLink=createAddLink$1({repo:a,preload:$}),this.appendData=createAppendData$1({repo:a,preload:$}),this.rmLink=createRmLink$1({repo:a,preload:$}),this.setData=createSetData$1({repo:a,preload:$})}}class ObjectAPI{constructor({repo:a,codecs:$,preload:j}){this.data=createData$1({repo:a,preload:j}),this.get=createGet$6({repo:a,preload:j}),this.links=createLinks$1({repo:a,codecs:$}),this.new=createNew$1({repo:a,preload:j}),this.put=createPut$4({repo:a,preload:j}),this.stat=createStat$6({repo:a,preload:j}),this.patch=new ObjectPatchAPI({repo:a,preload:j})}}const log$14=logger$1("ipfs:repo:gc");function createGc$1({repo:_,hashers:a}){async function*$(j={}){const _e=Date.now();let et;try{et=await loadMfsRoot({repo:_,hashers:a},j),await _.pins.pinRecursively(et),yield*_.gc()}finally{et&&await _.pins.unpin(et)}log$14(`Complete (${Date.now()-_e}ms)`)}return withTimeoutOption($)}function createStat$5({repo:_}){async function a($={}){const j=await _.stat();return{numObjects:BigInt(j.numObjects.toString()),repoSize:BigInt(j.repoSize.toString()),repoPath:j.repoPath,version:`${j.version}`,storageMax:BigInt(j.storageMax.toString())}}return withTimeoutOption(a)}const repoVersion=12;function createVersion$2({repo:_}){async function a($={}){try{await _._checkInitialized($)}catch(j){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(et=>et.test(j.message)))return repoVersion;throw j}return _.version.get()}return withTimeoutOption(a)}class RepoAPI{constructor({repo:a,hashers:$}){this.gc=createGc$1({repo:a,hashers:$}),this.stat=createStat$5({repo:a}),this.version=createVersion$2({repo:a}),this.setApiAddr=j=>a.apiAddr.set(j)}}function getBandwidthStats(_,a){let $;if(_.metrics?a.peer?$=_.metrics.forPeer(a.peer):a.proto?$=_.metrics.forProtocol(a.proto):$=_.metrics.getGlobal():$=void 0,!$)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0};const j=$.getMovingAverages(),_e=$.getSnapshot();return{totalIn:_e.dataReceived,totalOut:_e.dataSent,rateIn:j.dataReceived[6e4].movingAverage/60,rateOut:j.dataSent[6e4].movingAverage/60}}function createBw$1({network:_}){return withTimeoutOption(async function*($={}){const{libp2p:j}=await _.use($);if(!$.poll){yield getBandwidthStats(j,$);return}const _e=$.interval||1e3;let et=-1;try{if(et=typeof _e=="string"?parse$3(_e)||-1:_e,!et||et<0)throw new Error("invalid duration")}catch(rt){throw errCode(rt,"ERR_INVALID_POLL_INTERVAL")}let tt;try{for(;;)yield getBandwidthStats(j,$),await new Promise(rt=>{tt=setTimeout(rt,et)})}finally{clearTimeout(tt)}})}class StatsAPI{constructor({repo:a,network:$}){this.repo=createStat$5({repo:a}),this.bw=createBw$1({network:$}),this.bitswap=createStat$9({network:$})}}var objectSafeGet=get;function get(_,a,$){if(!_)return $;var j,_e;if(Array.isArray(a)&&(j=a.slice(0)),typeof a=="string"&&(j=a.split(".")),typeof a=="symbol"&&(j=[a]),!Array.isArray(j))throw new Error("props arg must be an array, a string or a symbol");for(;j.length;)if(_e=j.shift(),!_||(_=_[_e],_===void 0))return $;return _}async function length$5(_){let a=0;for await(const $ of _)a++;return a}const log$13=debug("ipfs:repo:migrator:migration-8");function unwrap$1(_){return _.child?unwrap$1(_.child):_}function keyToMultihash$1(_){try{const a=base32$4.decode(`b${_.toString().toLowerCase().slice(1)}`),$=CID.decode(a).multihash.bytes,j=base32$4.encode($).slice(1).toUpperCase();return new Key(`/${j}`,!1)}catch{return _}}function keyToCid$1(_){try{const a=base32$4.decode(`b${_.toString().toLowerCase().slice(1)}`),$=decode$n(a),j=base32$4.encode(CID.createV1(code$4,$).bytes).slice(1);return new Key(`/${j.toUpperCase()}`,!1)}catch{return _}}async function process$3(_,a,$){const j=_.blocks;await j.open();const _e=unwrap$1(j),et=await length$5(_e.queryKeys({filters:[tt=>$(tt).toString()!==tt.toString()]}));try{let tt=0;for await(const rt of _e.query({})){const nt=$(rt.key);nt.toString()!==rt.key.toString()&&(tt+=1,log$13(`Migrating Block from ${rt.key} to ${nt}`,await _e.has(rt.key)),await _e.delete(rt.key),await _e.put(nt,rt.value),a(tt/et*100,`Migrated Block from ${rt.key} to ${nt}`))}}finally{await j.close()}}const migration$4={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(_,a=()=>{})=>process$3(_,a,keyToMultihash$1),revert:(_,a=()=>{})=>process$3(_,a,keyToCid$1)},$Reader$6=$protobuf.Reader,$Writer$6=$protobuf.Writer;$protobuf.util;const $root$6=$protobuf.roots.default||($protobuf.roots.default={}),ipfs=$root$6.ipfs=(()=>{const _={};return _.pin=function(){const a={};return a.Set=function(){function $(j){if(j)for(var _e=Object.keys(j),et=0;et<_e.length;++et)j[_e[et]]!=null&&(this[_e[et]]=j[_e[et]])}return $.prototype.version=0,$.prototype.fanout=0,$.prototype.seed=0,$.encode=function(_e,et){return et||(et=$Writer$6.create()),_e.version!=null&&Object.hasOwnProperty.call(_e,"version")&&et.uint32(8).uint32(_e.version),_e.fanout!=null&&Object.hasOwnProperty.call(_e,"fanout")&&et.uint32(16).uint32(_e.fanout),_e.seed!=null&&Object.hasOwnProperty.call(_e,"seed")&&et.uint32(29).fixed32(_e.seed),et},$.decode=function(_e,et){_e instanceof $Reader$6||(_e=$Reader$6.create(_e));for(var tt=et===void 0?_e.len:_e.pos+et,rt=new $root$6.ipfs.pin.Set;_e.pos<tt;){var nt=_e.uint32();switch(nt>>>3){case 1:rt.version=_e.uint32();break;case 2:rt.fanout=_e.uint32();break;case 3:rt.seed=_e.fixed32();break;default:_e.skipType(nt&7);break}}return rt},$.fromObject=function(_e){if(_e instanceof $root$6.ipfs.pin.Set)return _e;var et=new $root$6.ipfs.pin.Set;return _e.version!=null&&(et.version=_e.version>>>0),_e.fanout!=null&&(et.fanout=_e.fanout>>>0),_e.seed!=null&&(et.seed=_e.seed>>>0),et},$.toObject=function(_e,et){et||(et={});var tt={};return et.defaults&&(tt.version=0,tt.fanout=0,tt.seed=0),_e.version!=null&&_e.hasOwnProperty("version")&&(tt.version=_e.version),_e.fanout!=null&&_e.hasOwnProperty("fanout")&&(tt.fanout=_e.fanout),_e.seed!=null&&_e.hasOwnProperty("seed")&&(tt.seed=_e.seed),tt},$.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},$}(),a}(),_})();var fnv1a$1={exports:{}};(function(_,a){Object.defineProperty(a,"__esModule",{value:!0}),$.BASE=2166136261;function $(j,_e=$.BASE){const et=j.length;for(let tt=0;tt<et;tt++)_e^=j.charCodeAt(tt),_e+=(_e<<1)+(_e<<4)+(_e<<7)+(_e<<8)+(_e<<24);return _e>>>0}a.default=$,_.exports=$})(fnv1a$1,fnv1a$1.exports);const fnv1a=getDefaultExportFromCjs(fnv1a$1.exports),PIN_DS_KEY=new Key("/local/pins"),DEFAULT_FANOUT=256,MAX_ITEMS=8192,EMPTY_KEY=CID.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),PinTypes={direct:"direct",recursive:"recursive"};function cidToKey$2(_){return new Key(`/${base32$4.encode(_.multihash.bytes).toUpperCase().substring(1)}`)}const PinSet=ipfs.pin.Set;function readHeader(_){const a=_.Data;if(!a)throw new Error("No data present");const $=varint$4.decode(a),j=varint$4.decode.bytes;if(j<=0)throw new Error("Invalid Set header length");if(j+$>a.length)throw new Error("Impossibly large set header length");const _e=a.slice(j,$+j),et=PinSet.toObject(PinSet.decode(_e),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(et.version!==1)throw new Error(`Unsupported Set version: ${et.version}`);if(et.fanout>_.Links.length)throw new Error("Impossibly large fanout");return{header:et,data:a.slice($+j)}}function hash$1(_,a){const $=new Uint8Array(4);new DataView($.buffer).setUint32(0,_,!0);const _e=fromString$5(a.toString()),et=concat$1([$,_e],$.byteLength+_e.byteLength);return fnv1a(toString$6(et))}async function*walkItems(_,a){const $=readHeader(a);let j=0;for(const _e of a.Links){if(j<$.header.fanout){const et=_e.Hash;if(!EMPTY_KEY.equals(et)){const tt=await _.get(et),rt=decode$m(tt);yield*walkItems(_,rt)}}else yield _e.Hash;j++}}async function*loadSet(_,a,$){const j=a.Links.find(tt=>tt.Name===$);if(!j)throw new Error("No link found with name "+$);const _e=await _.get(j.Hash),et=decode$m(_e);yield*walkItems(_,et)}function storeItems(_,a){return $(a,0);async function $(j,_e){const et=PinSet.encode({version:1,fanout:DEFAULT_FANOUT,seed:_e}).finish(),tt=varint$4.encode(et.length),rt=concat$1([tt,et]),nt=[];for(let st=0;st<DEFAULT_FANOUT;st++)nt.push({Name:"",Tsize:1,Hash:EMPTY_KEY});if(j.length<=MAX_ITEMS){const st=j.map(lt=>({link:{Name:"",Tsize:1,Hash:lt.key},data:lt.data||new Uint8Array})).sort((lt,ct)=>compare$1(lt.link.Hash.bytes,ct.link.Hash.bytes)),ot=nt.concat(st.map(lt=>lt.link));return{Data:concat$1([rt,...st.map(lt=>lt.data)]),Links:ot}}else{const st=j.reduce((at,lt)=>{const ct=hash$1(_e,lt.key)%DEFAULT_FANOUT;return at[ct]=ct in at?at[ct].concat([lt]):[lt],at},[]);let ot=0;for(const at of st){const lt=await $(at,_e+1);await it(lt,ot),ot++}return{Data:rt,Links:nt}}async function it(st,ot){const at=encode$s(st),lt=await sha256$4.digest(at),ct=CID.createV0(lt);await _.put(ct,at);const ut=st.Links.reduce((dt,ft)=>dt+(ft.Tsize||0),0)+at.length;nt[ot]={Name:"",Tsize:ut,Hash:ct}}}}async function storeSet(_,a,$){const j=await storeItems(_,$.map(nt=>({key:nt}))),_e=encode$s(j),et=await sha256$4.digest(_e),tt=CID.createV0(et);await _.put(tt,_e);const rt=j.Links.reduce((nt,it)=>nt+it.Tsize,0)+_e.length;return{Name:a,Tsize:rt,Hash:tt}}async function pinsToDatastore(_,a,$,j){if(!await a.has(PIN_DS_KEY))return;const _e=await a.get(PIN_DS_KEY),et=CID.decode(_e),tt=await _.get(et),rt=decode$m(tt);let nt=0;const it=await length$5(loadSet(_,rt,PinTypes.recursive))+await length$5(loadSet(_,rt,PinTypes.direct));for await(const st of loadSet(_,rt,PinTypes.recursive)){nt++;const ot={depth:1/0};st.version!==0&&(ot.version=st.version),st.code!==code$9&&(ot.codec=st.code),await $.put(cidToKey$2(st),encode$r(ot)),j(nt/it*100,`Migrated recursive pin ${st}`)}for await(const st of loadSet(_,rt,PinTypes.direct)){nt++;const ot={depth:0};st.version!==0&&(ot.version=st.version),st.code!==code$9&&(ot.codec=st.code),await $.put(cidToKey$2(st),encode$r(ot)),j(nt/it*100,`Migrated direct pin ${st}`)}await _.delete(et),await a.delete(PIN_DS_KEY)}async function pinsToDAG(_,a,$,j){const _e=[],et=[];let tt=0;const rt=await length$5($.queryKeys({}));for await(const{key:at,value:lt}of $.query({})){tt++;const ct=decode$l(lt),ut=CID.create(ct.version||0,ct.codec||code$9,decode$n(base32$4.decode("b"+at.toString().toLowerCase().split("/").pop())));ct.depth===0?(j(tt/rt*100,`Reverted direct pin ${ut}`),et.push(ut)):(j(tt/rt*100,`Reverted recursive pin ${ut}`),_e.push(ut))}j(100,"Updating pin root");const nt={Links:[await storeSet(_,PinTypes.direct,et),await storeSet(_,PinTypes.recursive,_e)]},it=encode$s(nt),st=await sha256$4.digest(it),ot=CID.createV0(st);await _.put(ot,it),await a.put(PIN_DS_KEY,ot.bytes)}async function process$2(_,a,$){const j=_.blocks,_e=_.datastore,et=_.pins;await j.open(),await _e.open(),await et.open();try{await $(j,_e,et,a)}finally{await et.close(),await _e.close(),await j.close()}}const migration$3={version:9,description:"Migrates pins to datastore",migrate:(_,a=()=>{})=>process$2(_,a,pinsToDatastore),revert:(_,a=()=>{})=>process$2(_,a,pinsToDAG)},CONFIG_KEY=new Key("/config"),VERSION_KEY=new Key("/version");function findLevelJs$1(_){let a=_;for(;a.db||a.child;)if(a=a.db||a.child,a.type==="level-js"||a.constructor.name==="Level")return a}async function hasWithFallback$1(_,a,$){const j=await a(_);if(j)return j;const _e=findLevelJs$1($);return _e?new Promise((et,tt)=>{const rt=_e.store("readonly").get(_.toString());rt.transaction.onabort=()=>{tt(rt.transaction.error)},rt.transaction.oncomplete=()=>{et(Boolean(rt.result))}}):!1}async function getWithFallback$1(_,a,$,j){if(await $(_))return a(_);const _e=findLevelJs$1(j);if(!_e)throw notFoundError$1();return new Promise((et,tt)=>{const rt=_e.store("readonly").get(_.toString());rt.transaction.onabort=()=>{tt(rt.transaction.error)},rt.transaction.oncomplete=()=>{if(rt.result)return et(rt.result);tt(notFoundError$1())}})}function wrapStore(_){const a=_.get.bind(_),$=_.has.bind(_);return _.get=j=>getWithFallback$1(j,a,$,_),_.has=j=>hasWithFallback$1(j,$,_),_}function wrapBackends(_){return{..._,root:wrapStore(_.root),datastore:wrapStore(_.datastore),pins:wrapStore(_.pins),keys:wrapStore(_.keys)}}async function keysToBinary(_,a,$=()=>{}){const j=findLevelJs$1(a);if(!j){$(`${_} did not need an upgrade`);return}$(`Upgrading ${_}`),await withEach(j,(et,tt)=>[{type:"del",key:et},{type:"put",key:fromString$5(et),value:tt}])}async function keysToStrings(_,a,$=()=>{}){const j=findLevelJs$1(a);if(!j){$(`${_} did not need a downgrade`);return}$(`Downgrading ${_}`),await withEach(j,(et,tt)=>[{type:"del",key:et},{type:"put",key:toString$6(et),value:tt}])}function unwrap(_){return _.child?unwrap(_.child):_}async function process$1(_,a,$){const j=Object.entries(_).map(([tt,rt])=>({key:tt,backend:unwrap(rt)})).filter(({key:tt,backend:rt})=>rt.constructor.name==="LevelDatastore").map(({key:tt,backend:rt})=>({name:tt,store:rt}));a(0,`Migrating ${j.length} dbs`);let _e=0;const et=tt=>{a(Math.round(_e/j.length*100),tt)};for(const{name:tt,store:rt}of j){await rt.open();try{await $(tt,rt,et)}finally{_e++,await rt.close()}}a(100,`Migrated ${j.length} dbs`)}const migration$2={version:10,description:"Migrates datastore-level keys to binary",migrate:(_,a=()=>{})=>process$1(_,a,keysToBinary),revert:(_,a=()=>{})=>process$1(_,a,keysToStrings)};function withEach(_,a){function $(j,_e){const et=_.store("readwrite"),tt=et.transaction;let rt=0,nt;tt.onabort=()=>_e(nt||tt.error||new Error("aborted by user")),tt.oncomplete=()=>_e();function it(){const st=j[rt++],ot=st.key;let at;try{at=st.type==="del"?et.delete(ot):et.put(st.value,ot)}catch(lt){nt=lt,tt.abort();return}rt<j.length&&(at.onsuccess=it)}it()}return new Promise((j,_e)=>{const et=_.iterator(),tt=nt=>nt;et._deserializeKey=et._deserializeValue=tt,rt();function rt(){const nt=(it,st,ot)=>{if(it||st===void 0){const at=lt=>{if(lt){_e(lt);return}j()};et.end(at);return}$(a(st,ot),rt)};et.next(nt)}})}const MFS_ROOT_KEY$1=new Key("/local/filesroot");async function storeMfsRootInDatastore(_,a=()=>{}){if(a(100,"Migrating MFS root to repo datastore"),await _.root.open(),await _.datastore.open(),await _.root.has(MFS_ROOT_KEY$1)){const $=await _.root.get(MFS_ROOT_KEY$1);await _.datastore.put(MFS_ROOT_KEY$1,$),await _.root.delete(MFS_ROOT_KEY$1)}await _.datastore.close(),await _.root.close(),a(100,"Stored MFS root in repo datastore")}async function storeMfsRootInRoot(_,a=()=>{}){if(a(100,"Migrating MFS root to repo root datastore"),await _.root.open(),await _.datastore.open(),await _.datastore.has(MFS_ROOT_KEY$1)){const $=await _.datastore.get(MFS_ROOT_KEY$1);await _.root.put(MFS_ROOT_KEY$1,$),await _.datastore.delete(MFS_ROOT_KEY$1)}await _.datastore.close(),await _.root.close(),a(100,"Stored MFS root in repo root datastore")}const migration$1={version:11,description:"Store mfs root in the datastore",migrate:storeMfsRootInDatastore,revert:storeMfsRootInRoot},$Reader$5=$protobuf.Reader,$Writer$5=$protobuf.Writer,$util$5=$protobuf.util,$root$5=$protobuf.roots.default||($protobuf.roots.default={}),Protocols=$root$5.Protocols=(()=>{function _(a){if(this.protocols=[],a)for(var $=Object.keys(a),j=0;j<$.length;++j)a[$[j]]!=null&&(this[$[j]]=a[$[j]])}return _.prototype.protocols=$util$5.emptyArray,_.encode=function($,j){if(j||(j=$Writer$5.create()),$.protocols!=null&&$.protocols.length)for(var _e=0;_e<$.protocols.length;++_e)j.uint32(10).string($.protocols[_e]);return j},_.decode=function($,j){$ instanceof $Reader$5||($=$Reader$5.create($));for(var _e=j===void 0?$.len:$.pos+j,et=new $root$5.Protocols;$.pos<_e;){var tt=$.uint32();switch(tt>>>3){case 1:et.protocols&&et.protocols.length||(et.protocols=[]),et.protocols.push($.string());break;default:$.skipType(tt&7);break}}return et},_.fromObject=function($){if($ instanceof $root$5.Protocols)return $;var j=new $root$5.Protocols;if($.protocols){if(!Array.isArray($.protocols))throw TypeError(".Protocols.protocols: array expected");j.protocols=[];for(var _e=0;_e<$.protocols.length;++_e)j.protocols[_e]=String($.protocols[_e])}return j},_.toObject=function($,j){j||(j={});var _e={};if((j.arrays||j.defaults)&&(_e.protocols=[]),$.protocols&&$.protocols.length){_e.protocols=[];for(var et=0;et<$.protocols.length;++et)_e.protocols[et]=$.protocols[et]}return _e},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})(),$Reader$4=$protobuf.Reader,$Writer$4=$protobuf.Writer,$util$4=$protobuf.util,$root$4=$protobuf.roots.default||($protobuf.roots.default={}),Addresses=$root$4.Addresses=(()=>{function _(a){if(this.addrs=[],a)for(var $=Object.keys(a),j=0;j<$.length;++j)a[$[j]]!=null&&(this[$[j]]=a[$[j]])}return _.prototype.addrs=$util$4.emptyArray,_.prototype.certifiedRecord=null,_.encode=function($,j){if(j||(j=$Writer$4.create()),$.addrs!=null&&$.addrs.length)for(var _e=0;_e<$.addrs.length;++_e)$root$4.Addresses.Address.encode($.addrs[_e],j.uint32(10).fork()).ldelim();return $.certifiedRecord!=null&&Object.hasOwnProperty.call($,"certifiedRecord")&&$root$4.Addresses.CertifiedRecord.encode($.certifiedRecord,j.uint32(18).fork()).ldelim(),j},_.decode=function($,j){$ instanceof $Reader$4||($=$Reader$4.create($));for(var _e=j===void 0?$.len:$.pos+j,et=new $root$4.Addresses;$.pos<_e;){var tt=$.uint32();switch(tt>>>3){case 1:et.addrs&&et.addrs.length||(et.addrs=[]),et.addrs.push($root$4.Addresses.Address.decode($,$.uint32()));break;case 2:et.certifiedRecord=$root$4.Addresses.CertifiedRecord.decode($,$.uint32());break;default:$.skipType(tt&7);break}}return et},_.fromObject=function($){if($ instanceof $root$4.Addresses)return $;var j=new $root$4.Addresses;if($.addrs){if(!Array.isArray($.addrs))throw TypeError(".Addresses.addrs: array expected");j.addrs=[];for(var _e=0;_e<$.addrs.length;++_e){if(typeof $.addrs[_e]!="object")throw TypeError(".Addresses.addrs: object expected");j.addrs[_e]=$root$4.Addresses.Address.fromObject($.addrs[_e])}}if($.certifiedRecord!=null){if(typeof $.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");j.certifiedRecord=$root$4.Addresses.CertifiedRecord.fromObject($.certifiedRecord)}return j},_.toObject=function($,j){j||(j={});var _e={};if((j.arrays||j.defaults)&&(_e.addrs=[]),j.defaults&&(_e.certifiedRecord=null),$.addrs&&$.addrs.length){_e.addrs=[];for(var et=0;et<$.addrs.length;++et)_e.addrs[et]=$root$4.Addresses.Address.toObject($.addrs[et],j)}return $.certifiedRecord!=null&&$.hasOwnProperty("certifiedRecord")&&(_e.certifiedRecord=$root$4.Addresses.CertifiedRecord.toObject($.certifiedRecord,j)),_e},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_.Address=function(){function a(j){if(j)for(var _e=Object.keys(j),et=0;et<_e.length;++et)j[_e[et]]!=null&&(this[_e[et]]=j[_e[et]])}a.prototype.multiaddr=$util$4.newBuffer([]),a.prototype.isCertified=null;let $;return Object.defineProperty(a.prototype,"_isCertified",{get:$util$4.oneOfGetter($=["isCertified"]),set:$util$4.oneOfSetter($)}),a.encode=function(_e,et){return et||(et=$Writer$4.create()),_e.multiaddr!=null&&Object.hasOwnProperty.call(_e,"multiaddr")&&et.uint32(10).bytes(_e.multiaddr),_e.isCertified!=null&&Object.hasOwnProperty.call(_e,"isCertified")&&et.uint32(16).bool(_e.isCertified),et},a.decode=function(_e,et){_e instanceof $Reader$4||(_e=$Reader$4.create(_e));for(var tt=et===void 0?_e.len:_e.pos+et,rt=new $root$4.Addresses.Address;_e.pos<tt;){var nt=_e.uint32();switch(nt>>>3){case 1:rt.multiaddr=_e.bytes();break;case 2:rt.isCertified=_e.bool();break;default:_e.skipType(nt&7);break}}return rt},a.fromObject=function(_e){if(_e instanceof $root$4.Addresses.Address)return _e;var et=new $root$4.Addresses.Address;return _e.multiaddr!=null&&(typeof _e.multiaddr=="string"?$util$4.base64.decode(_e.multiaddr,et.multiaddr=$util$4.newBuffer($util$4.base64.length(_e.multiaddr)),0):_e.multiaddr.length&&(et.multiaddr=_e.multiaddr)),_e.isCertified!=null&&(et.isCertified=Boolean(_e.isCertified)),et},a.toObject=function(_e,et){et||(et={});var tt={};return et.defaults&&(et.bytes===String?tt.multiaddr="":(tt.multiaddr=[],et.bytes!==Array&&(tt.multiaddr=$util$4.newBuffer(tt.multiaddr)))),_e.multiaddr!=null&&_e.hasOwnProperty("multiaddr")&&(tt.multiaddr=et.bytes===String?$util$4.base64.encode(_e.multiaddr,0,_e.multiaddr.length):et.bytes===Array?Array.prototype.slice.call(_e.multiaddr):_e.multiaddr),_e.isCertified!=null&&_e.hasOwnProperty("isCertified")&&(tt.isCertified=_e.isCertified,et.oneofs&&(tt._isCertified="isCertified")),tt},a.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},a}(),_.CertifiedRecord=function(){function a($){if($)for(var j=Object.keys($),_e=0;_e<j.length;++_e)$[j[_e]]!=null&&(this[j[_e]]=$[j[_e]])}return a.prototype.seq=$util$4.Long?$util$4.Long.fromBits(0,0,!0):0,a.prototype.raw=$util$4.newBuffer([]),a.encode=function(j,_e){return _e||(_e=$Writer$4.create()),j.seq!=null&&Object.hasOwnProperty.call(j,"seq")&&_e.uint32(8).uint64(j.seq),j.raw!=null&&Object.hasOwnProperty.call(j,"raw")&&_e.uint32(18).bytes(j.raw),_e},a.decode=function(j,_e){j instanceof $Reader$4||(j=$Reader$4.create(j));for(var et=_e===void 0?j.len:j.pos+_e,tt=new $root$4.Addresses.CertifiedRecord;j.pos<et;){var rt=j.uint32();switch(rt>>>3){case 1:tt.seq=j.uint64();break;case 2:tt.raw=j.bytes();break;default:j.skipType(rt&7);break}}return tt},a.fromObject=function(j){if(j instanceof $root$4.Addresses.CertifiedRecord)return j;var _e=new $root$4.Addresses.CertifiedRecord;return j.seq!=null&&($util$4.Long?(_e.seq=$util$4.Long.fromValue(j.seq)).unsigned=!0:typeof j.seq=="string"?_e.seq=parseInt(j.seq,10):typeof j.seq=="number"?_e.seq=j.seq:typeof j.seq=="object"&&(_e.seq=new $util$4.LongBits(j.seq.low>>>0,j.seq.high>>>0).toNumber(!0))),j.raw!=null&&(typeof j.raw=="string"?$util$4.base64.decode(j.raw,_e.raw=$util$4.newBuffer($util$4.base64.length(j.raw)),0):j.raw.length&&(_e.raw=j.raw)),_e},a.toObject=function(j,_e){_e||(_e={});var et={};if(_e.defaults){if($util$4.Long){var tt=new $util$4.Long(0,0,!0);et.seq=_e.longs===String?tt.toString():_e.longs===Number?tt.toNumber():tt}else et.seq=_e.longs===String?"0":0;_e.bytes===String?et.raw="":(et.raw=[],_e.bytes!==Array&&(et.raw=$util$4.newBuffer(et.raw)))}return j.seq!=null&&j.hasOwnProperty("seq")&&(typeof j.seq=="number"?et.seq=_e.longs===String?String(j.seq):j.seq:et.seq=_e.longs===String?$util$4.Long.prototype.toString.call(j.seq):_e.longs===Number?new $util$4.LongBits(j.seq.low>>>0,j.seq.high>>>0).toNumber(!0):j.seq),j.raw!=null&&j.hasOwnProperty("raw")&&(et.raw=_e.bytes===String?$util$4.base64.encode(j.raw,0,j.raw.length):_e.bytes===Array?Array.prototype.slice.call(j.raw):j.raw),et},a.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},a}(),_})(),$Reader$3=$protobuf.Reader,$Writer$3=$protobuf.Writer,$util$3=$protobuf.util,$root$3=$protobuf.roots.default||($protobuf.roots.default={}),Peer$1=$root$3.Peer=(()=>{function _($){if(this.addresses=[],this.protocols=[],this.metadata=[],$)for(var j=Object.keys($),_e=0;_e<j.length;++_e)$[j[_e]]!=null&&(this[j[_e]]=$[j[_e]])}_.prototype.addresses=$util$3.emptyArray,_.prototype.protocols=$util$3.emptyArray,_.prototype.metadata=$util$3.emptyArray,_.prototype.pubKey=null,_.prototype.peerRecordEnvelope=null;let a;return Object.defineProperty(_.prototype,"_pubKey",{get:$util$3.oneOfGetter(a=["pubKey"]),set:$util$3.oneOfSetter(a)}),Object.defineProperty(_.prototype,"_peerRecordEnvelope",{get:$util$3.oneOfGetter(a=["peerRecordEnvelope"]),set:$util$3.oneOfSetter(a)}),_.encode=function(j,_e){if(_e||(_e=$Writer$3.create()),j.addresses!=null&&j.addresses.length)for(var et=0;et<j.addresses.length;++et)$root$3.Address.encode(j.addresses[et],_e.uint32(10).fork()).ldelim();if(j.protocols!=null&&j.protocols.length)for(var et=0;et<j.protocols.length;++et)_e.uint32(18).string(j.protocols[et]);if(j.metadata!=null&&j.metadata.length)for(var et=0;et<j.metadata.length;++et)$root$3.Metadata.encode(j.metadata[et],_e.uint32(26).fork()).ldelim();return j.pubKey!=null&&Object.hasOwnProperty.call(j,"pubKey")&&_e.uint32(34).bytes(j.pubKey),j.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(j,"peerRecordEnvelope")&&_e.uint32(42).bytes(j.peerRecordEnvelope),_e},_.decode=function(j,_e){j instanceof $Reader$3||(j=$Reader$3.create(j));for(var et=_e===void 0?j.len:j.pos+_e,tt=new $root$3.Peer;j.pos<et;){var rt=j.uint32();switch(rt>>>3){case 1:tt.addresses&&tt.addresses.length||(tt.addresses=[]),tt.addresses.push($root$3.Address.decode(j,j.uint32()));break;case 2:tt.protocols&&tt.protocols.length||(tt.protocols=[]),tt.protocols.push(j.string());break;case 3:tt.metadata&&tt.metadata.length||(tt.metadata=[]),tt.metadata.push($root$3.Metadata.decode(j,j.uint32()));break;case 4:tt.pubKey=j.bytes();break;case 5:tt.peerRecordEnvelope=j.bytes();break;default:j.skipType(rt&7);break}}return tt},_.fromObject=function(j){if(j instanceof $root$3.Peer)return j;var _e=new $root$3.Peer;if(j.addresses){if(!Array.isArray(j.addresses))throw TypeError(".Peer.addresses: array expected");_e.addresses=[];for(var et=0;et<j.addresses.length;++et){if(typeof j.addresses[et]!="object")throw TypeError(".Peer.addresses: object expected");_e.addresses[et]=$root$3.Address.fromObject(j.addresses[et])}}if(j.protocols){if(!Array.isArray(j.protocols))throw TypeError(".Peer.protocols: array expected");_e.protocols=[];for(var et=0;et<j.protocols.length;++et)_e.protocols[et]=String(j.protocols[et])}if(j.metadata){if(!Array.isArray(j.metadata))throw TypeError(".Peer.metadata: array expected");_e.metadata=[];for(var et=0;et<j.metadata.length;++et){if(typeof j.metadata[et]!="object")throw TypeError(".Peer.metadata: object expected");_e.metadata[et]=$root$3.Metadata.fromObject(j.metadata[et])}}return j.pubKey!=null&&(typeof j.pubKey=="string"?$util$3.base64.decode(j.pubKey,_e.pubKey=$util$3.newBuffer($util$3.base64.length(j.pubKey)),0):j.pubKey.length&&(_e.pubKey=j.pubKey)),j.peerRecordEnvelope!=null&&(typeof j.peerRecordEnvelope=="string"?$util$3.base64.decode(j.peerRecordEnvelope,_e.peerRecordEnvelope=$util$3.newBuffer($util$3.base64.length(j.peerRecordEnvelope)),0):j.peerRecordEnvelope.length&&(_e.peerRecordEnvelope=j.peerRecordEnvelope)),_e},_.toObject=function(j,_e){_e||(_e={});var et={};if((_e.arrays||_e.defaults)&&(et.addresses=[],et.protocols=[],et.metadata=[]),j.addresses&&j.addresses.length){et.addresses=[];for(var tt=0;tt<j.addresses.length;++tt)et.addresses[tt]=$root$3.Address.toObject(j.addresses[tt],_e)}if(j.protocols&&j.protocols.length){et.protocols=[];for(var tt=0;tt<j.protocols.length;++tt)et.protocols[tt]=j.protocols[tt]}if(j.metadata&&j.metadata.length){et.metadata=[];for(var tt=0;tt<j.metadata.length;++tt)et.metadata[tt]=$root$3.Metadata.toObject(j.metadata[tt],_e)}return j.pubKey!=null&&j.hasOwnProperty("pubKey")&&(et.pubKey=_e.bytes===String?$util$3.base64.encode(j.pubKey,0,j.pubKey.length):_e.bytes===Array?Array.prototype.slice.call(j.pubKey):j.pubKey,_e.oneofs&&(et._pubKey="pubKey")),j.peerRecordEnvelope!=null&&j.hasOwnProperty("peerRecordEnvelope")&&(et.peerRecordEnvelope=_e.bytes===String?$util$3.base64.encode(j.peerRecordEnvelope,0,j.peerRecordEnvelope.length):_e.bytes===Array?Array.prototype.slice.call(j.peerRecordEnvelope):j.peerRecordEnvelope,_e.oneofs&&(et._peerRecordEnvelope="peerRecordEnvelope")),et},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})();$root$3.Address=(()=>{function _($){if($)for(var j=Object.keys($),_e=0;_e<j.length;++_e)$[j[_e]]!=null&&(this[j[_e]]=$[j[_e]])}_.prototype.multiaddr=$util$3.newBuffer([]),_.prototype.isCertified=null;let a;return Object.defineProperty(_.prototype,"_isCertified",{get:$util$3.oneOfGetter(a=["isCertified"]),set:$util$3.oneOfSetter(a)}),_.encode=function(j,_e){return _e||(_e=$Writer$3.create()),j.multiaddr!=null&&Object.hasOwnProperty.call(j,"multiaddr")&&_e.uint32(10).bytes(j.multiaddr),j.isCertified!=null&&Object.hasOwnProperty.call(j,"isCertified")&&_e.uint32(16).bool(j.isCertified),_e},_.decode=function(j,_e){j instanceof $Reader$3||(j=$Reader$3.create(j));for(var et=_e===void 0?j.len:j.pos+_e,tt=new $root$3.Address;j.pos<et;){var rt=j.uint32();switch(rt>>>3){case 1:tt.multiaddr=j.bytes();break;case 2:tt.isCertified=j.bool();break;default:j.skipType(rt&7);break}}return tt},_.fromObject=function(j){if(j instanceof $root$3.Address)return j;var _e=new $root$3.Address;return j.multiaddr!=null&&(typeof j.multiaddr=="string"?$util$3.base64.decode(j.multiaddr,_e.multiaddr=$util$3.newBuffer($util$3.base64.length(j.multiaddr)),0):j.multiaddr.length&&(_e.multiaddr=j.multiaddr)),j.isCertified!=null&&(_e.isCertified=Boolean(j.isCertified)),_e},_.toObject=function(j,_e){_e||(_e={});var et={};return _e.defaults&&(_e.bytes===String?et.multiaddr="":(et.multiaddr=[],_e.bytes!==Array&&(et.multiaddr=$util$3.newBuffer(et.multiaddr)))),j.multiaddr!=null&&j.hasOwnProperty("multiaddr")&&(et.multiaddr=_e.bytes===String?$util$3.base64.encode(j.multiaddr,0,j.multiaddr.length):_e.bytes===Array?Array.prototype.slice.call(j.multiaddr):j.multiaddr),j.isCertified!=null&&j.hasOwnProperty("isCertified")&&(et.isCertified=j.isCertified,_e.oneofs&&(et._isCertified="isCertified")),et},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})();$root$3.Metadata=(()=>{function _(a){if(a)for(var $=Object.keys(a),j=0;j<$.length;++j)a[$[j]]!=null&&(this[$[j]]=a[$[j]])}return _.prototype.key="",_.prototype.value=$util$3.newBuffer([]),_.encode=function($,j){return j||(j=$Writer$3.create()),$.key!=null&&Object.hasOwnProperty.call($,"key")&&j.uint32(10).string($.key),$.value!=null&&Object.hasOwnProperty.call($,"value")&&j.uint32(18).bytes($.value),j},_.decode=function($,j){$ instanceof $Reader$3||($=$Reader$3.create($));for(var _e=j===void 0?$.len:$.pos+j,et=new $root$3.Metadata;$.pos<_e;){var tt=$.uint32();switch(tt>>>3){case 1:et.key=$.string();break;case 2:et.value=$.bytes();break;default:$.skipType(tt&7);break}}return et},_.fromObject=function($){if($ instanceof $root$3.Metadata)return $;var j=new $root$3.Metadata;return $.key!=null&&(j.key=String($.key)),$.value!=null&&(typeof $.value=="string"?$util$3.base64.decode($.value,j.value=$util$3.newBuffer($util$3.base64.length($.value)),0):$.value.length&&(j.value=$.value)),j},_.toObject=function($,j){j||(j={});var _e={};return j.defaults&&(_e.key="",j.bytes===String?_e.value="":(_e.value=[],j.bytes!==Array&&(_e.value=$util$3.newBuffer(_e.value)))),$.key!=null&&$.hasOwnProperty("key")&&(_e.key=$.key),$.value!=null&&$.hasOwnProperty("value")&&(_e.value=j.bytes===String?$util$3.base64.encode($.value,0,$.value.length):j.bytes===Array?Array.prototype.slice.call($.value):$.value),_e},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})();const $Reader$2=$protobuf.Reader,$Writer$2=$protobuf.Writer,$util$2=$protobuf.util,$root$2=$protobuf.roots.default||($protobuf.roots.default={}),Envelope$1=$root$2.Envelope=(()=>{function _(a){if(a)for(var $=Object.keys(a),j=0;j<$.length;++j)a[$[j]]!=null&&(this[$[j]]=a[$[j]])}return _.prototype.publicKey=$util$2.newBuffer([]),_.prototype.payloadType=$util$2.newBuffer([]),_.prototype.payload=$util$2.newBuffer([]),_.prototype.signature=$util$2.newBuffer([]),_.encode=function($,j){return j||(j=$Writer$2.create()),$.publicKey!=null&&Object.hasOwnProperty.call($,"publicKey")&&j.uint32(10).bytes($.publicKey),$.payloadType!=null&&Object.hasOwnProperty.call($,"payloadType")&&j.uint32(18).bytes($.payloadType),$.payload!=null&&Object.hasOwnProperty.call($,"payload")&&j.uint32(26).bytes($.payload),$.signature!=null&&Object.hasOwnProperty.call($,"signature")&&j.uint32(42).bytes($.signature),j},_.decode=function($,j){$ instanceof $Reader$2||($=$Reader$2.create($));for(var _e=j===void 0?$.len:$.pos+j,et=new $root$2.Envelope;$.pos<_e;){var tt=$.uint32();switch(tt>>>3){case 1:et.publicKey=$.bytes();break;case 2:et.payloadType=$.bytes();break;case 3:et.payload=$.bytes();break;case 5:et.signature=$.bytes();break;default:$.skipType(tt&7);break}}return et},_.fromObject=function($){if($ instanceof $root$2.Envelope)return $;var j=new $root$2.Envelope;return $.publicKey!=null&&(typeof $.publicKey=="string"?$util$2.base64.decode($.publicKey,j.publicKey=$util$2.newBuffer($util$2.base64.length($.publicKey)),0):$.publicKey.length&&(j.publicKey=$.publicKey)),$.payloadType!=null&&(typeof $.payloadType=="string"?$util$2.base64.decode($.payloadType,j.payloadType=$util$2.newBuffer($util$2.base64.length($.payloadType)),0):$.payloadType.length&&(j.payloadType=$.payloadType)),$.payload!=null&&(typeof $.payload=="string"?$util$2.base64.decode($.payload,j.payload=$util$2.newBuffer($util$2.base64.length($.payload)),0):$.payload.length&&(j.payload=$.payload)),$.signature!=null&&(typeof $.signature=="string"?$util$2.base64.decode($.signature,j.signature=$util$2.newBuffer($util$2.base64.length($.signature)),0):$.signature.length&&(j.signature=$.signature)),j},_.toObject=function($,j){j||(j={});var _e={};return j.defaults&&(j.bytes===String?_e.publicKey="":(_e.publicKey=[],j.bytes!==Array&&(_e.publicKey=$util$2.newBuffer(_e.publicKey))),j.bytes===String?_e.payloadType="":(_e.payloadType=[],j.bytes!==Array&&(_e.payloadType=$util$2.newBuffer(_e.payloadType))),j.bytes===String?_e.payload="":(_e.payload=[],j.bytes!==Array&&(_e.payload=$util$2.newBuffer(_e.payload))),j.bytes===String?_e.signature="":(_e.signature=[],j.bytes!==Array&&(_e.signature=$util$2.newBuffer(_e.signature)))),$.publicKey!=null&&$.hasOwnProperty("publicKey")&&(_e.publicKey=j.bytes===String?$util$2.base64.encode($.publicKey,0,$.publicKey.length):j.bytes===Array?Array.prototype.slice.call($.publicKey):$.publicKey),$.payloadType!=null&&$.hasOwnProperty("payloadType")&&(_e.payloadType=j.bytes===String?$util$2.base64.encode($.payloadType,0,$.payloadType.length):j.bytes===Array?Array.prototype.slice.call($.payloadType):$.payloadType),$.payload!=null&&$.hasOwnProperty("payload")&&(_e.payload=j.bytes===String?$util$2.base64.encode($.payload,0,$.payload.length):j.bytes===Array?Array.prototype.slice.call($.payload):$.payload),$.signature!=null&&$.hasOwnProperty("signature")&&(_e.signature=j.bytes===String?$util$2.base64.encode($.signature,0,$.signature.length):j.bytes===Array?Array.prototype.slice.call($.signature):$.signature),_e},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_})(),$Reader$1=$protobuf.Reader,$Writer$1=$protobuf.Writer,$util$1=$protobuf.util,$root$1=$protobuf.roots.default||($protobuf.roots.default={}),PeerRecord$2=$root$1.PeerRecord=(()=>{function _(a){if(this.addresses=[],a)for(var $=Object.keys(a),j=0;j<$.length;++j)a[$[j]]!=null&&(this[$[j]]=a[$[j]])}return _.prototype.peerId=$util$1.newBuffer([]),_.prototype.seq=$util$1.Long?$util$1.Long.fromBits(0,0,!0):0,_.prototype.addresses=$util$1.emptyArray,_.encode=function($,j){if(j||(j=$Writer$1.create()),$.peerId!=null&&Object.hasOwnProperty.call($,"peerId")&&j.uint32(10).bytes($.peerId),$.seq!=null&&Object.hasOwnProperty.call($,"seq")&&j.uint32(16).uint64($.seq),$.addresses!=null&&$.addresses.length)for(var _e=0;_e<$.addresses.length;++_e)$root$1.PeerRecord.AddressInfo.encode($.addresses[_e],j.uint32(26).fork()).ldelim();return j},_.decode=function($,j){$ instanceof $Reader$1||($=$Reader$1.create($));for(var _e=j===void 0?$.len:$.pos+j,et=new $root$1.PeerRecord;$.pos<_e;){var tt=$.uint32();switch(tt>>>3){case 1:et.peerId=$.bytes();break;case 2:et.seq=$.uint64();break;case 3:et.addresses&&et.addresses.length||(et.addresses=[]),et.addresses.push($root$1.PeerRecord.AddressInfo.decode($,$.uint32()));break;default:$.skipType(tt&7);break}}return et},_.fromObject=function($){if($ instanceof $root$1.PeerRecord)return $;var j=new $root$1.PeerRecord;if($.peerId!=null&&(typeof $.peerId=="string"?$util$1.base64.decode($.peerId,j.peerId=$util$1.newBuffer($util$1.base64.length($.peerId)),0):$.peerId.length&&(j.peerId=$.peerId)),$.seq!=null&&($util$1.Long?(j.seq=$util$1.Long.fromValue($.seq)).unsigned=!0:typeof $.seq=="string"?j.seq=parseInt($.seq,10):typeof $.seq=="number"?j.seq=$.seq:typeof $.seq=="object"&&(j.seq=new $util$1.LongBits($.seq.low>>>0,$.seq.high>>>0).toNumber(!0))),$.addresses){if(!Array.isArray($.addresses))throw TypeError(".PeerRecord.addresses: array expected");j.addresses=[];for(var _e=0;_e<$.addresses.length;++_e){if(typeof $.addresses[_e]!="object")throw TypeError(".PeerRecord.addresses: object expected");j.addresses[_e]=$root$1.PeerRecord.AddressInfo.fromObject($.addresses[_e])}}return j},_.toObject=function($,j){j||(j={});var _e={};if((j.arrays||j.defaults)&&(_e.addresses=[]),j.defaults)if(j.bytes===String?_e.peerId="":(_e.peerId=[],j.bytes!==Array&&(_e.peerId=$util$1.newBuffer(_e.peerId))),$util$1.Long){var et=new $util$1.Long(0,0,!0);_e.seq=j.longs===String?et.toString():j.longs===Number?et.toNumber():et}else _e.seq=j.longs===String?"0":0;if($.peerId!=null&&$.hasOwnProperty("peerId")&&(_e.peerId=j.bytes===String?$util$1.base64.encode($.peerId,0,$.peerId.length):j.bytes===Array?Array.prototype.slice.call($.peerId):$.peerId),$.seq!=null&&$.hasOwnProperty("seq")&&(typeof $.seq=="number"?_e.seq=j.longs===String?String($.seq):$.seq:_e.seq=j.longs===String?$util$1.Long.prototype.toString.call($.seq):j.longs===Number?new $util$1.LongBits($.seq.low>>>0,$.seq.high>>>0).toNumber(!0):$.seq),$.addresses&&$.addresses.length){_e.addresses=[];for(var tt=0;tt<$.addresses.length;++tt)_e.addresses[tt]=$root$1.PeerRecord.AddressInfo.toObject($.addresses[tt],j)}return _e},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_.AddressInfo=function(){function a($){if($)for(var j=Object.keys($),_e=0;_e<j.length;++_e)$[j[_e]]!=null&&(this[j[_e]]=$[j[_e]])}return a.prototype.multiaddr=$util$1.newBuffer([]),a.encode=function(j,_e){return _e||(_e=$Writer$1.create()),j.multiaddr!=null&&Object.hasOwnProperty.call(j,"multiaddr")&&_e.uint32(10).bytes(j.multiaddr),_e},a.decode=function(j,_e){j instanceof $Reader$1||(j=$Reader$1.create(j));for(var et=_e===void 0?j.len:j.pos+_e,tt=new $root$1.PeerRecord.AddressInfo;j.pos<et;){var rt=j.uint32();switch(rt>>>3){case 1:tt.multiaddr=j.bytes();break;default:j.skipType(rt&7);break}}return tt},a.fromObject=function(j){if(j instanceof $root$1.PeerRecord.AddressInfo)return j;var _e=new $root$1.PeerRecord.AddressInfo;return j.multiaddr!=null&&(typeof j.multiaddr=="string"?$util$1.base64.decode(j.multiaddr,_e.multiaddr=$util$1.newBuffer($util$1.base64.length(j.multiaddr)),0):j.multiaddr.length&&(_e.multiaddr=j.multiaddr)),_e},a.toObject=function(j,_e){_e||(_e={});var et={};return _e.defaults&&(_e.bytes===String?et.multiaddr="":(et.multiaddr=[],_e.bytes!==Array&&(et.multiaddr=$util$1.newBuffer(et.multiaddr)))),j.multiaddr!=null&&j.hasOwnProperty("multiaddr")&&(et.multiaddr=_e.bytes===String?$util$1.base64.encode(j.multiaddr,0,j.multiaddr.length):_e.bytes===Array?Array.prototype.slice.call(j.multiaddr):j.multiaddr),et},a.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},a}(),_})();$protobuf.util.Long=void 0;$protobuf.configure();async function storePeerUnderSingleDatastoreKey(_,a=()=>{}){a(0,"Storing each peerstore key under a single datastore key"),await _.datastore.open();const $={},j=[];for await(const{key:_e,value:et}of _.datastore.query({prefix:"/peers"})){j.push(_e);const tt=_e.toString(),[,rt,nt,it,st]=tt.split("/");if(rt==="peers"&&!!["protos","addrs","metadata","keys"].includes(nt)&&!!it)if($[it]=$[it]||{addresses:[],protocols:[],metadata:[]},nt==="protos"){const ot=Protocols.decode(et);$[it].protocols=ot.protocols.sort()}else if(nt==="addrs"){const ot=Addresses.decode(et);$[it].addresses=ot.addrs.sort((at,lt)=>multiaddr(at.multiaddr).toString().localeCompare(multiaddr(lt.multiaddr).toString())),ot.certifiedRecord&&ot.certifiedRecord.raw&&($[it].peerRecordEnvelope=ot.certifiedRecord.raw)}else nt==="metadata"?$[it].metadata.push({key:st,value:et}):nt==="keys"&&($[it].pubKey=et)}a(33,"Read peer data from store");for(const _e of j)await _.datastore.delete(_e);a(66,"Removed existing peer data from store");for(const _e of Object.keys($)){const et=$[_e];et.metadata=et.metadata.sort((rt,nt)=>rt.key.localeCompare(nt.key));const tt=Peer$1.encode(et).finish();await _.datastore.put(new Key(`/peers/${_e}`),tt)}await _.datastore.close(),a(100,"Stored each peerstore key under a single datastore key")}async function storePeerUnderMultipleDatastoreKeys(_,a=()=>{}){a(0,"Storing each peerstore key under a multiple datastore keys"),await _.datastore.open();const $={},j=[];for await(const{key:_e,value:et}of _.datastore.query({prefix:"/peers"})){j.push(_e);const tt=_e.toString(),[,,rt]=tt.split("/");$[rt]=Peer$1.decode(et)}a(33,"Read peer data from store");for(const _e of j)await _.datastore.delete(_e);a(66,"Removed existing peer data from store");for(const[_e,et]of Object.entries($)){if(et.protocols&&et.protocols.length>0&&await _.datastore.put(new Key(`/peers/protos/${_e}`),Protocols.encode({protocols:et.protocols}).finish()),et.addresses&&et.addresses.length>0){const tt=et.peerRecordEnvelope;let rt;if(tt){const nt=Envelope$1.decode(tt),it=PeerRecord$2.decode(nt.payload);rt={raw:tt,seq:it.seq}}await _.datastore.put(new Key(`/peers/addrs/${_e}`),Addresses.encode({addrs:et.addresses,certifiedRecord:rt}).finish())}if(et.metadata&&et.metadata.length>0)for(const{key:tt,value:rt}of et.metadata)await _.datastore.put(new Key(`/peers/metadata/${_e}/${tt}`),rt);et.pubKey&&await _.datastore.put(new Key(`/peers/keys/${_e}`),et.pubKey)}await _.datastore.close(),a(100,"Stored each peerstore key under multiple datastore keys")}const migration={version:12,description:"Store each peerstore peer under a single datastore key",migrate:storePeerUnderSingleDatastoreKey,revert:storePeerUnderMultipleDatastoreKeys},emptyMigration={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},defaultMigrations=[Object.assign({version:1},emptyMigration),Object.assign({version:2},emptyMigration),Object.assign({version:3},emptyMigration),Object.assign({version:4},emptyMigration),Object.assign({version:5},emptyMigration),Object.assign({version:6},emptyMigration),Object.assign({version:7},emptyMigration),migration$4,migration$3,migration$2,migration$1,migration];class NonReversibleMigrationError extends Error{constructor(a){super(a),this.name="NonReversibleMigrationError",this.code=NonReversibleMigrationError.code,this.message=a}}NonReversibleMigrationError.code="ERR_NON_REVERSIBLE_MIGRATION";class NotInitializedRepoError extends Error{constructor(a){super(a),this.name="NotInitializedRepoError",this.code=NotInitializedRepoError.code,this.message=a}}NotInitializedRepoError.code="ERR_NOT_INITIALIZED_REPO";class RequiredParameterError extends Error{constructor(a){super(a),this.name="RequiredParameterError",this.code=RequiredParameterError.code,this.message=a}}RequiredParameterError.code="ERR_REQUIRED_PARAMETER";class InvalidValueError extends Error{constructor(a){super(a),this.name="InvalidValueError",this.code=InvalidValueError.code,this.message=a}}InvalidValueError.code="ERR_INVALID_VALUE";class MissingRepoOptionsError extends Error{constructor(a){super(a),this.name="MissingRepoOptionsError",this.code=MissingRepoOptionsError.code,this.message=a}}MissingRepoOptionsError.code="ERR_MISSING_REPO_OPTIONS";const Errors=Object.freeze(Object.defineProperty({__proto__:null,NonReversibleMigrationError,NotInitializedRepoError,RequiredParameterError,InvalidValueError,MissingRepoOptionsError},Symbol.toStringTag,{value:"Module"})),log$12=debug("ipfs:repo:migrator:repo:init");async function isRepoInitialized(_){if(!_)throw new MissingRepoOptionsError("Please pass repo options when trying to open a repo");const a=_.root;try{await a.open();const $=await a.has(VERSION_KEY),j=await a.has(CONFIG_KEY);return!$||!j?(log$12(`Version entry present: ${$}`),log$12(`Config entry present: ${j}`),!1):!0}catch($){return log$12("While checking if repo is initialized error was thrown: "+$.message),!1}finally{if(a!==void 0)try{await a.close()}catch{}}}async function getVersion(_){if(!await isRepoInitialized(_))throw new NotInitializedRepoError("Repo is not initialized!");const a=_.root;await a.open();try{return parseInt(toString$6(await a.get(VERSION_KEY)))}finally{await a.close()}}async function setVersion(_,a){if(!a)throw new MissingRepoOptionsError("Please pass repo options when trying to open a repo");const $=a.root;await $.open(),await $.put(VERSION_KEY,fromString$5(String(_))),await $.close()}const log$11=debug("ipfs:repo:migrator");function getLatestMigrationVersion(_){return _=_||defaultMigrations,!Array.isArray(_)||_.length===0?0:_[_.length-1].version}async function migrate(_,a,$,j,_e={}){const et=_e.ignoreLock??!1,tt=_e.onProgress,rt=_e.isDryRun??!1,nt=_e.migrations??defaultMigrations;if(!_)throw new errors.RequiredParameterError("Path argument is required!");if(!$)throw new errors.RequiredParameterError("repoOptions argument is required!");if(!j)throw new errors.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(j)||j<=0)throw new errors.InvalidValueError("Version has to be positive integer!");a=wrapBackends(a);const it=await getVersion(a);if(it===j){log$11("Nothing to migrate.");return}if(it>j)throw new errors.InvalidValueError(`Current repo's version (${it}) is higher then toVersion (${j}), you probably wanted to revert it?`);verifyAvailableMigrations(nt,it,j);let st;!rt&&!et&&(st=await $.repoLock.lock(_));try{for(const ot of nt){if(j!==void 0&&ot.version>j)break;if(!(ot.version<=it)){log$11(`Migrating version ${ot.version}`);try{if(!rt){let at=()=>{};tt&&(at=(lt,ct)=>tt(ot.version,lt.toFixed(2),ct)),await ot.migrate(a,at)}}catch(at){const lt=ot.version-1;throw log$11(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${lt}`),await setVersion(lt,a),new Error(`During migration to version ${ot.version} exception was raised: ${at.stack||at.message||at}`)}log$11(`Migrating to version ${ot.version} finished`)}}rt||await setVersion(j||getLatestMigrationVersion(nt),a),log$11("Repo successfully migrated",j!==void 0?`to version ${j}!`:"to latest version!")}finally{!rt&&!et&&st&&await st.close()}}async function revert(_,a,$,j,_e={}){const et=_e.ignoreLock??!1,tt=_e.onProgress,rt=_e.isDryRun??!1,nt=_e.migrations??defaultMigrations;if(!_)throw new errors.RequiredParameterError("Path argument is required!");if(!$)throw new errors.RequiredParameterError("repoOptions argument is required!");if(!j)throw new errors.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(j)||j<=0)throw new errors.InvalidValueError("Version has to be positive integer!");a=wrapBackends(a);const it=await getVersion(a);if(it===j){log$11("Nothing to revert.");return}if(it<j)throw new errors.InvalidValueError(`Current repo's version (${it}) is lower then toVersion (${j}), you probably wanted to migrate it?`);verifyAvailableMigrations(nt,j,it,!0);let st;!rt&&!et&&(st=await $.repoLock.lock(_)),log$11(`Reverting from version ${it} to ${j}`);try{const ot=nt.slice().reverse();for(const at of ot){if(at.version<=j)break;if(!(at.version>it)){log$11(`Reverting migration version ${at.version}`);try{if(!rt){let lt=()=>{};tt&&(lt=(ct,ut)=>tt(at.version,ct.toFixed(2),ut)),await at.revert(a,lt)}}catch(lt){const ct=at.version;throw log$11(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${ct}`),await setVersion(ct,a),lt.message=`During reversion to version ${at.version} exception was raised: ${lt.message}`,lt}log$11(`Reverting to version ${at.version} finished`)}}rt||await setVersion(j,a),log$11(`All migrations successfully reverted to version ${j}!`)}finally{!rt&&!et&&st&&await st.close()}}function verifyAvailableMigrations(_,a,$,j=!1){let _e=0;for(const et of _){if(et.version>$)break;if(et.version>a){if(j&&!et.revert)throw new errors.NonReversibleMigrationError(`It is not possible to revert to version ${a} because migration version ${et.version} is not reversible. Cancelling reversion.`);_e++}}if(_e!==$-a)throw new errors.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${a} to ${$}`)}const errors=Errors;var bytes$1={exports:{}};/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */bytes$1.exports=bytes;bytes$1.exports.format=format;bytes$1.exports.parse=parse$2;var formatThousandsRegExp=/\B(?=(\d{3})+(?!\d))/g,formatDecimalsRegExp=/(?:\.0*|(\.[^0]+)0+)$/,map$5={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},parseRegExp=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function bytes(_,a){return typeof _=="string"?parse$2(_):typeof _=="number"?format(_,a):null}function format(_,a){if(!Number.isFinite(_))return null;var $=Math.abs(_),j=a&&a.thousandsSeparator||"",_e=a&&a.unitSeparator||"",et=a&&a.decimalPlaces!==void 0?a.decimalPlaces:2,tt=Boolean(a&&a.fixedDecimals),rt=a&&a.unit||"";(!rt||!map$5[rt.toLowerCase()])&&($>=map$5.pb?rt="PB":$>=map$5.tb?rt="TB":$>=map$5.gb?rt="GB":$>=map$5.mb?rt="MB":$>=map$5.kb?rt="KB":rt="B");var nt=_/map$5[rt.toLowerCase()],it=nt.toFixed(et);return tt||(it=it.replace(formatDecimalsRegExp,"$1")),j&&(it=it.split(".").map(function(st,ot){return ot===0?st.replace(formatThousandsRegExp,j):st}).join(".")),it+_e+rt}function parse$2(_){if(typeof _=="number"&&!isNaN(_))return _;if(typeof _!="string")return null;var a=parseRegExp.exec(_),$,j="b";return a?($=parseFloat(a[1]),j=a[4].toLowerCase()):($=parseInt(_,10),j="b"),isNaN($)?null:Math.floor(map$5[j]*$)}class LockExistsError extends Error{constructor(a){super(a),this.name="LockExistsError",this.code=LockExistsError.code}}LockExistsError.code="ERR_LOCK_EXISTS";class NotFoundError extends Error{constructor(a){super(a),this.name="NotFoundError",this.code=NotFoundError.code}}NotFoundError.code="ERR_NOT_FOUND";class InvalidRepoVersionError extends Error{constructor(a){super(a),this.name="InvalidRepoVersionError",this.code=InvalidRepoVersionError.code}}InvalidRepoVersionError.code="ERR_INVALID_REPO_VERSION";const ERR_REPO_NOT_INITIALIZED="ERR_REPO_NOT_INITIALIZED",ERR_REPO_ALREADY_OPEN="ERR_REPO_ALREADY_OPEN",ERR_REPO_ALREADY_CLOSED="ERR_REPO_ALREADY_CLOSED";async function hasWithFallback(_,a,$){const j=await a(_);if(j)return j;const _e=findLevelJs($);return _e?new Promise((et,tt)=>{const rt=_e.store("readonly").get(_.toString());rt.transaction.onabort=()=>{tt(rt.transaction.error)},rt.transaction.oncomplete=()=>{et(Boolean(rt.result))}}):!1}async function getWithFallback(_,a,$,j){if(await $(_))return a(_);const _e=findLevelJs(j);if(!_e)throw new NotFoundError;return new Promise((et,tt)=>{const rt=_e.store("readonly").get(_.toString());rt.transaction.onabort=()=>{tt(rt.transaction.error)},rt.transaction.oncomplete=()=>{if(rt.result)return et(rt.result);tt(new NotFoundError)}})}function findLevelJs(_){let a=_;for(;a.db||a.child;)if(a=a.db||a.child,a.type==="level-js"||a.constructor.name==="Level")return a}const log$10=debug("ipfs:repo:version"),versionKey=new Key("version");function version$1(_){return{async exists(){return hasWithFallback(versionKey,_.has.bind(_),_)},async get(){const a=await getWithFallback(versionKey,_.get.bind(_),_.has.bind(_),_);return parseInt(toString$6(a),10)},set(a){return _.put(versionKey,fromString$5(String(a)))},async check(a){const $=await this.get();return log$10("comparing version: %s and %s",$,a),$===a||($===6&&a===7||a===6&&$===7)}}}const Queue$1=PQueue.default?PQueue.default:PQueue,configKey=new Key("config");function config(_){const a=new Queue$1({concurrency:1}),$={async getAll(et={}){const tt=await getWithFallback(configKey,_.get.bind(_),_.has.bind(_),_);return JSON.parse(toString$6(tt))},async get(et,tt={}){if(et==null)throw new NotFoundError(`Key ${et} does not exist in config`);const rt=await this.getAll(tt),nt=objectSafeGet(rt,et);if(nt===void 0)throw new NotFoundError(`Key ${et} does not exist in config`);return nt},set(et,tt,rt={}){if(typeof et!="string"&&!(et instanceof String))throw errCode(new Error("Invalid key type: "+typeof et),"ERR_INVALID_KEY");if(tt===void 0||tt instanceof Uint8Array)throw errCode(new Error("Invalid value type: "+typeof tt),"ERR_INVALID_VALUE");return a.add(()=>j({key:et,value:tt},rt.signal))},replace(et,tt={}){if(!et||et instanceof Uint8Array)throw errCode(new Error("Invalid value type: "+typeof et),"ERR_INVALID_VALUE");return a.add(()=>j({key:void 0,value:et},tt.signal))},async exists(){return hasWithFallback(configKey,_.has.bind(_),_)}};return $;async function j(et,tt){if(tt&&tt.aborted)return;const rt=et.key,nt=et.value;if(rt){const it=await $.getAll();return typeof it=="object"&&it!==null&&objectSafeSet(it,rt,nt),_e(it)}return _e(nt)}function _e(et){const tt=fromString$5(JSON.stringify(et,null,2));return _.put(configKey,tt)}}function isPlainObject(_){if(typeof _!="object"||_===null)return!1;const a=Object.getPrototypeOf(_);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in _)&&!(Symbol.iterator in _)}function sortKeys(_,a={}){if(!isPlainObject(_)&&!Array.isArray(_))throw new TypeError("Expected a plain object or array");const{deep:$,compare:j}=a,_e=[],et=[],tt=nt=>{const it=_e.indexOf(nt);if(it!==-1)return et[it];const st=[];return _e.push(nt),et.push(st),st.push(...nt.map(ot=>Array.isArray(ot)?tt(ot):isPlainObject(ot)?rt(ot):ot)),st},rt=nt=>{const it=_e.indexOf(nt);if(it!==-1)return et[it];const st={},ot=Object.keys(nt).sort(j);_e.push(nt),et.push(st);for(const at of ot){const lt=nt[at];let ct;$&&Array.isArray(lt)?ct=tt(lt):ct=$&&isPlainObject(lt)?rt(lt):lt,Object.defineProperty(st,at,{...Object.getOwnPropertyDescriptor(nt,at),value:ct})}return st};return Array.isArray(_)?$?tt(_):_.slice():rt(_)}const specKey=new Key("datastore_spec");function spec(_){return{exists(){return _.has(specKey)},async get(){const a=await _.get(specKey);return JSON.parse(toString$6(a))},async set(a){return _.put(specKey,fromString$5(JSON.stringify(sortKeys(a,{deep:!0}))))}}}const apiFile=new Key("api");function apiAddr(_){return{async get(){const a=await _.get(apiFile);return a&&a.toString()},set(a){return _.put(apiFile,fromString$5(a.toString()))},delete(){return _.delete(apiFile)}}}async function*filter$2(_,a){for await(const $ of _)await a($)&&(yield $)}function createIdStore(_){return{open(){return _.open()},close(){return _.close()},query(a,$){return _.query(a,$)},queryKeys(a,$){return _.queryKeys(a,$)},async get(a,$){const j=extractContents(a);return j.isIdentity?Promise.resolve(j.digest):_.get(a,$)},async*getMany(a,$){for await(const j of a)yield this.get(j,$)},async put(a,$,j){const{isIdentity:_e}=extractContents(a);_e||await _.put(a,$,j)},async*putMany(a,$){const j=pushable$2({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{await drain$3(_.putMany(async function*(){for await(const{key:et,value:tt}of a)extractContents(et).isIdentity||(yield{key:et,value:tt}),j.push({key:et,value:tt})}())),j.end()}catch(et){j.end(et)}}),yield*j},has(a,$){const{isIdentity:j}=extractContents(a);return j?Promise.resolve(!0):_.has(a,$)},delete(a,$){const{isIdentity:j}=extractContents(a);return j?Promise.resolve():_.delete(a,$)},deleteMany(a,$){return _.deleteMany(filter$2(a,j=>!extractContents(j).isIdentity),$)},batch(){const a=_.batch();return{put($,j){const{isIdentity:_e}=extractContents($);_e||a.put($,j)},delete($){const{isIdentity:j}=extractContents($);j||a.delete($)},commit:$=>a.commit($)}}}}function extractContents(_){const a=CID.asCID(_);if(a==null)throw errCode(new Error("Not a valid cid"),"ERR_INVALID_CID");return a.multihash.code!==identity$8.code?{isIdentity:!1}:{isIdentity:!0,digest:a.multihash.digest}}const log$$=debug("ipfs:repo:lock:memory"),lockFile="repo.lock",LOCKS={};async function lock(_){const a=_+"/"+lockFile;if(log$$("locking %s",a),LOCKS[a]===!0)throw new LockExistsError(`Lock already being held for file: ${a}`);return LOCKS[a]=!0,{async close(){LOCKS[a]&&delete LOCKS[a]}}}async function locked(_){const a=_+"/"+lockFile;return log$$(`checking lock: ${a}`),Boolean(LOCKS[a])}const MemoryLock={lock,locked},defaultOptions$5={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:MemoryLock},defaultDatastore={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};function cidToKey$1(_){const a=CID.asCID(_);if(a==null)throw errCode(new Error("Not a valid cid"),"ERR_INVALID_CID");const $=base32$4.encode(a.multihash.bytes);return new Key("/"+$.slice(1).toUpperCase(),!1)}function keyToMultihash(_){return decode$n(base32$4.decode(`b${_.toString().toLowerCase().substring(1)}`))}const log$_=debug("ipfs:repo:utils:walk-dag");async function*walkDag(_,a,$,j){try{const _e=await a.get(_,j),et=await $(_.code),tt=createUnsafe({bytes:_e,cid:_,codec:et});for(const[,rt]of tt.links())yield rt,yield*walkDag(rt,a,$,j)}catch(_e){throw log$_("Could not walk DAG for CID",_.toString(),_e),_e}}class QuickLRU extends Map{constructor(a={}){if(super(),!(a.maxSize&&a.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof a.maxAge=="number"&&a.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=a.maxSize,this.maxAge=a.maxAge||Number.POSITIVE_INFINITY,this.onEviction=a.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(a){if(typeof this.onEviction=="function")for(const[$,j]of a)this.onEviction($,j.value)}_deleteIfExpired(a,$){return typeof $.expiry=="number"&&$.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(a,$.value),this.delete(a)):!1}_getOrDeleteIfExpired(a,$){if(this._deleteIfExpired(a,$)===!1)return $.value}_getItemValue(a,$){return $.expiry?this._getOrDeleteIfExpired(a,$):$.value}_peek(a,$){const j=$.get(a);return this._getItemValue(a,j)}_set(a,$){this.cache.set(a,$),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(a,$){this.oldCache.delete(a),this._set(a,$)}*_entriesAscending(){for(const a of this.oldCache){const[$,j]=a;this.cache.has($)||this._deleteIfExpired($,j)===!1&&(yield a)}for(const a of this.cache){const[$,j]=a;this._deleteIfExpired($,j)===!1&&(yield a)}}get(a){if(this.cache.has(a)){const $=this.cache.get(a);return this._getItemValue(a,$)}if(this.oldCache.has(a)){const $=this.oldCache.get(a);if(this._deleteIfExpired(a,$)===!1)return this._moveToRecent(a,$),$.value}}set(a,$,{maxAge:j=this.maxAge}={}){const _e=typeof j=="number"&&j!==Number.POSITIVE_INFINITY?Date.now()+j:void 0;this.cache.has(a)?this.cache.set(a,{value:$,expiry:_e}):this._set(a,{value:$,expiry:_e})}has(a){return this.cache.has(a)?!this._deleteIfExpired(a,this.cache.get(a)):this.oldCache.has(a)?!this._deleteIfExpired(a,this.oldCache.get(a)):!1}peek(a){if(this.cache.has(a))return this._peek(a,this.cache);if(this.oldCache.has(a))return this._peek(a,this.oldCache)}delete(a){const $=this.cache.delete(a);return $&&this._size--,this.oldCache.delete(a)||$}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(a){if(!(a&&a>0))throw new TypeError("`maxSize` must be a number greater than 0");const $=[...this._entriesAscending()],j=$.length-a;j<0?(this.cache=new Map($),this.oldCache=new Map,this._size=$.length):(j>0&&this._emitEvictions($.slice(0,j)),this.oldCache=new Map($.slice(j)),this.cache=new Map,this._size=0),this.maxSize=a}*keys(){for(const[a]of this)yield a}*values(){for(const[,a]of this)yield a}*[Symbol.iterator](){for(const a of this.cache){const[$,j]=a;this._deleteIfExpired($,j)===!1&&(yield[$,j.value])}for(const a of this.oldCache){const[$,j]=a;this.cache.has($)||this._deleteIfExpired($,j)===!1&&(yield[$,j.value])}}*entriesDescending(){let a=[...this.cache];for(let $=a.length-1;$>=0;--$){const j=a[$],[_e,et]=j;this._deleteIfExpired(_e,et)===!1&&(yield[_e,et.value])}a=[...this.oldCache];for(let $=a.length-1;$>=0;--$){const j=a[$],[_e,et]=j;this.cache.has(_e)||this._deleteIfExpired(_e,et)===!1&&(yield[_e,et.value])}}*entriesAscending(){for(const[a,$]of this._entriesAscending())yield[a,$.value]}get size(){if(!this._size)return this.oldCache.size;let a=0;for(const $ of this.oldCache.keys())this.cache.has($)||a++;return Math.min(this._size+a,this.maxSize)}entries(){return this.entriesAscending()}forEach(a,$=this){for(const[j,_e]of this.entriesAscending())a.call($,_e,j,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}const CID_CACHE_MAX_SIZE=2048;function invalidPinTypeErr(_){const a=`Invalid type '${_}', must be one of {direct, indirect, recursive, all}`;return errCode(new Error(a),"ERR_INVALID_PIN_TYPE")}class PinManager{constructor({pinstore:a,blockstore:$,loadCodec:j}){this.pinstore=a,this.blockstore=$,this.loadCodec=j,this.log=debug("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(a,$={}){await this.blockstore.get(a,$);const j={depth:0};return a.version!==0&&(j.version=a.version),a.code!==code$9&&(j.codec=a.code),$.metadata&&(j.metadata=$.metadata),this.pinstore.put(cidToKey$1(a),encode$r(j))}unpin(a,$){return this.pinstore.delete(cidToKey$1(a),$)}async pinRecursively(a,$={}){await this.fetchCompleteDag(a,$);const j={depth:1/0};a.version!==0&&(j.version=a.version),a.code!==code$9&&(j.codec=a.code),$.metadata&&(j.metadata=$.metadata),await this.pinstore.put(cidToKey$1(a),encode$r(j))}async*directKeys(a){for await(const $ of this.pinstore.query({filters:[j=>decode$l(j.value).depth===0]})){const j=decode$l($.value),_e=j.version||0,et=j.codec!=null?j.codec:code$9,tt=keyToMultihash($.key);yield{cid:CID.create(_e,et,tt),metadata:j.metadata}}}async*recursiveKeys(a){for await(const $ of this.pinstore.query({filters:[j=>decode$l(j.value).depth===1/0]})){const j=decode$l($.value),_e=j.version||0,et=j.codec!=null?j.codec:code$9,tt=keyToMultihash($.key);yield{cid:CID.create(_e,et,tt),metadata:j.metadata}}}async*indirectKeys(a){for await(const{cid:$}of this.recursiveKeys())for await(const j of walkDag($,this.blockstore,this.loadCodec,a)){const _e=[PinTypes$1.recursive];(await this.isPinnedWithType(j,_e)).pinned||(yield j)}}async isPinnedWithType(a,$,j){Array.isArray($)||($=[$]);const _e=$.includes(PinTypes$1.all),et=$.includes(PinTypes$1.direct),tt=$.includes(PinTypes$1.recursive),rt=$.includes(PinTypes$1.indirect);if(tt||et||_e){const st=await first$2(this.pinstore.query({prefix:cidToKey$1(a).toString(),filters:[ot=>{if(_e)return!0;const at=decode$l(ot.value);return $.includes(at.depth===0?PinTypes$1.direct:PinTypes$1.recursive)}],limit:1}));if(st){const ot=decode$l(st.value);return{cid:a,pinned:!0,reason:ot.depth===0?PinTypes$1.direct:PinTypes$1.recursive,metadata:ot.metadata}}}const nt=this;async function*it(st,ot){for await(const{cid:at}of ot)for await(const lt of walkDag(at,nt.blockstore,nt.loadCodec))if(lt.equals(st)){yield at;return}}if(_e||rt){const st=await first$2(it(a,this.recursiveKeys()));if(st)return{cid:a,pinned:!0,reason:PinTypes$1.indirect,parent:st}}return{cid:a,pinned:!1}}async fetchCompleteDag(a,$={}){const j=new QuickLRU({maxSize:$.cidCacheMaxSize??CID_CACHE_MAX_SIZE}),_e=async(et,tt)=>{if(j.has(et.toString()))return;j.set(et.toString(),!0);const rt=await this.blockstore.get(et,tt),nt=await this.loadCodec(et.code),it=createUnsafe({bytes:rt,cid:et,codec:nt});await Promise.all([...it.links()].map(([,st])=>_e(st,tt)))};await _e(a,$)}static checkPinType(a){if(typeof a!="string"||!Object.keys(PinTypes$1).includes(a))throw invalidPinTypeErr(a);return!0}}function createPinnedBlockstore(_,a){return{open(){return a.open()},close(){return a.close()},query($,j){return a.query($,j)},queryKeys($,j){return a.queryKeys($,j)},async get($,j){return a.get($,j)},async*getMany($,j){yield*a.getMany($,j)},async put($,j,_e){await a.put($,j,_e)},async*putMany($,j){yield*a.putMany($,j)},has($,j){return a.has($,j)},async delete($,j){return await ensureNotPinned($,_),a.delete($,j)},deleteMany($,j){return a.deleteMany(map$6($,async _e=>(await ensureNotPinned(_e,_),_e)),j)},batch(){return a.batch()}}}async function ensureNotPinned(_,a){const{pinned:$,reason:j}=await a.isPinnedWithType(_,PinTypes$1.all);if($)throw errCode(new Error(`pinned: ${j}`),"ERR_BLOCK_PINNED")}async function*merge$2(..._){const a=pushable$2({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(_.map(async $=>{for await(const j of $)a.push(j)})),a.end()}catch($){a.end($)}}),yield*a}const log$Z=debug("ipfs:repo:gc"),ERR_NOT_FOUND=notFoundError$1().code,BLOCK_RM_CONCURRENCY=256,MFS_ROOT_KEY=new Key("/local/filesroot");function gc({gcLock:_,pins:a,blockstore:$,root:j,loadCodec:_e}){async function*et(){const tt=Date.now();log$Z("Creating set of marked blocks");const rt=await _.writeLock();try{const nt=await createMarkedSet({pins:a,blockstore:$,root:j,loadCodec:_e}),it=$.queryKeys({});yield*deleteUnmarkedBlocks({blockstore:$},nt,it),log$Z(`Complete (${Date.now()-tt}ms)`)}finally{rt()}}return et}async function createMarkedSet({pins:_,blockstore:a,loadCodec:$,root:j}){const _e=async function*(){let rt;try{rt=await j.get(MFS_ROOT_KEY)}catch(it){if(it.code===ERR_NOT_FOUND){log$Z("No blocks in MFS");return}throw it}const nt=CID.decode(rt);yield nt,yield*walkDag(nt,a,$)}(),et=merge$2(map$6(_.recursiveKeys(),({cid:rt})=>rt),_.indirectKeys(),map$6(_.directKeys(),({cid:rt})=>rt),_e),tt=new Set;for await(const rt of merge$2(et,_e))tt.add(base32$4.encode(rt.multihash.bytes));return tt}async function*deleteUnmarkedBlocks({blockstore:_},a,$){let j=0,_e=0;yield*pipe(parallelBatch(map$6($,async tt=>async function(){j++;try{const nt=base32$4.encode(tt.multihash.bytes);if(a.has(nt))return null;try{await _.delete(tt),_e++}catch(it){return{err:new Error(`Could not delete block with CID ${tt}: ${it.message}`)}}return{cid:tt}}catch(nt){const it=`Could delete block with CID ${tt}`;return log$Z(it,nt),{err:new Error(it+`: ${nt.message}`)}}}),BLOCK_RM_CONCURRENCY),tt=>filter$2(tt,Boolean)),log$Z(`Marked set has ${a.size} unique blocks. Blockstore has ${j} blocks. Deleted ${_e} blocks.`)}const log$Y=debug("ipfs:repo"),noLimit=Number.MAX_SAFE_INTEGER,AUTO_MIGRATE_CONFIG_KEY="repoAutoMigrate";class Repo{constructor(a,$,j,_e){if(typeof a!="string")throw new Error("missing repo path");if(typeof $!="function")throw new Error("missing codec loader");this.options=mergeOptions$g(defaultOptions$5,_e),this.closed=!0,this.path=a,this.root=j.root,this.datastore=j.datastore,this.keys=j.keys;const et=j.blocks,tt=j.pins;this.pins=new PinManager({pinstore:tt,blockstore:et,loadCodec:$});const rt=createPinnedBlockstore(this.pins,et);this.blocks=createIdStore(rt),this.version=version$1(this.root),this.config=config(this.root),this.spec=spec(this.root),this.apiAddr=apiAddr(this.root),this.gcLock=createMortice({name:a,singleProcess:this.options.repoOwner!==!1}),this.gc=gc({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:$})}async init(a){log$Y("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(buildConfig(a)),await this.spec.set(buildDatastoreSpec(a)),await this.version.set(repoVersion)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch{return!1}}async open(){if(!this.closed)throw errCode(new Error("repo is already open"),ERR_REPO_ALREADY_OPEN);log$Y("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),log$Y("acquired repo.lock"),!await this.version.check(repoVersion))if(await this._isAutoMigrationEnabled())await this._migrate(repoVersion,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new InvalidRepoVersionError("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");log$Y("creating datastore"),await this.datastore.open(),log$Y("creating blocks"),await this.blocks.open(),log$Y("creating keystore"),await this.keys.open(),log$Y("creating pins"),await this.pins.pinstore.open(),this.closed=!1,log$Y("all opened")}catch(a){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch($){log$Y("error removing lock",$)}throw a}}async _openRoot(){try{await this.root.open()}catch(a){if(a.message!=="Already open")throw a}}async _openLock(){const a=await this.options.repoLock.lock(this.path);if(typeof a.close!="function")throw errCode(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return a}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){log$Y("init check");let a;try{[a]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch($){throw $.code==="ERR_NOT_FOUND"?errCode(new Error("repo is not initialized yet"),ERR_REPO_NOT_INITIALIZED,{path:this.path}):$}if(!a)throw errCode(new Error("repo is not initialized yet"),ERR_REPO_NOT_INITIALIZED,{path:this.path})}async close(){if(this.closed)throw errCode(new Error("repo is already closed"),ERR_REPO_ALREADY_CLOSED);log$Y("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(a){if(a.code!==ERR_REPO_NOT_INITIALIZED&&!a.message.startsWith("ENOENT"))throw a}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(a=>a&&a.close())),log$Y("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){const[a,$,j,_e,et]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),getSize(this.datastore),getSize(this.keys)]),tt=$.size+_e+et;return{repoPath:this.path,storageMax:a,version:j,numObjects:$.count,repoSize:tt}}throw errCode(new Error("repo is not initialized yet"),ERR_REPO_NOT_INITIALIZED,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let a;try{a=await this.config.get(AUTO_MIGRATE_CONFIG_KEY)}catch($){if($.code===NotFoundError.code)a=!0;else throw $}return a}async _migrate(a,$){return await this.version.get()>a?(log$Y(`reverting to version ${a}`),revert(this.path,$,this.options,a,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(log$Y(`migrating to version ${a}`),migrate(this.path,$,this.options,a,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{const a=await this.config.get("Datastore.StorageMax");return BigInt(bytes$1.exports(a))}catch{return BigInt(noLimit)}}async _blockStat(){let a=BigInt(0),$=BigInt(0);if(this.blocks)for await(const{key:j,value:_e}of this.blocks.query({}))a+=BigInt(1),$+=BigInt(_e.byteLength),$+=BigInt(j.bytes.byteLength);return{count:a,size:$}}}async function getSize(_){let a=BigInt(0);for await(const $ of _.query({}))a+=BigInt($.value.byteLength),a+=BigInt($.key.uint8Array().byteLength);return a}function createRepo$2(_,a,$,j){return new Repo(_,a,$,j)}function buildConfig(_){return _.Datastore=Object.assign({},defaultDatastore,objectSafeGet(_,"datastore")),_}function buildDatastoreSpec(_){const a={...defaultDatastore.Spec,...objectSafeGet(_,"Datastore.Spec")};return{type:a.type,mounts:a.mounts.map($=>({mountpoint:$.mountpoint,type:$.child.type,path:$.child.path,shardFunc:$.child.shardFunc}))}}const map$4=async function*(_,a){for await(const $ of _)yield a($)};var itMap$2=map$4;const all$4=async _=>{const a=[];for await(const $ of _)a.push($);return a};var itAll$2=all$4;const all$3=itAll$2,sort$1=async function*(_,a){yield*(await all$3(_)).sort(a)};var itSort=sort$1,browserLevel={},abstractLevel$1={},abstractLevel={},levelSupports={};levelSupports.supports=function _(...a){const $=a.reduce((j,_e)=>Object.assign(j,_e),{});return Object.assign($,{snapshots:$.snapshots||!1,permanence:$.permanence||!1,seek:$.seek||!1,clear:$.clear||!1,getMany:$.getMany||!1,keyIterator:$.keyIterator||!1,valueIterator:$.valueIterator||!1,iteratorNextv:$.iteratorNextv||!1,iteratorAll:$.iteratorAll||!1,status:$.status||!1,createIfMissing:$.createIfMissing||!1,errorIfExists:$.errorIfExists||!1,deferredOpen:$.deferredOpen||!1,promises:$.promises||!1,streams:$.streams||!1,encodings:Object.assign({},$.encodings),events:Object.assign({},$.events),additionalMethods:Object.assign({},$.additionalMethods)})};var levelTranscoder={},moduleError=class extends Error{constructor(a,$){super(a||""),typeof $=="object"&&$!==null&&($.code&&(this.code=String($.code)),$.expected&&(this.expected=!0),$.transient&&(this.transient=!0),$.cause&&(this.cause=$.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},encodings$1={},buffer={},base64Js={};base64Js.byteLength=byteLength$1;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup$3=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code$2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i$1=0,len=code$2.length;i$1<len;++i$1)lookup$3[i$1]=code$2[i$1],revLookup[code$2.charCodeAt(i$1)]=i$1;revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(_){var a=_.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var $=_.indexOf("=");$===-1&&($=a);var j=$===a?0:4-$%4;return[$,j]}function byteLength$1(_){var a=getLens(_),$=a[0],j=a[1];return($+j)*3/4-j}function _byteLength(_,a,$){return(a+$)*3/4-$}function toByteArray(_){var a,$=getLens(_),j=$[0],_e=$[1],et=new Arr(_byteLength(_,j,_e)),tt=0,rt=_e>0?j-4:j,nt;for(nt=0;nt<rt;nt+=4)a=revLookup[_.charCodeAt(nt)]<<18|revLookup[_.charCodeAt(nt+1)]<<12|revLookup[_.charCodeAt(nt+2)]<<6|revLookup[_.charCodeAt(nt+3)],et[tt++]=a>>16&255,et[tt++]=a>>8&255,et[tt++]=a&255;return _e===2&&(a=revLookup[_.charCodeAt(nt)]<<2|revLookup[_.charCodeAt(nt+1)]>>4,et[tt++]=a&255),_e===1&&(a=revLookup[_.charCodeAt(nt)]<<10|revLookup[_.charCodeAt(nt+1)]<<4|revLookup[_.charCodeAt(nt+2)]>>2,et[tt++]=a>>8&255,et[tt++]=a&255),et}function tripletToBase64(_){return lookup$3[_>>18&63]+lookup$3[_>>12&63]+lookup$3[_>>6&63]+lookup$3[_&63]}function encodeChunk(_,a,$){for(var j,_e=[],et=a;et<$;et+=3)j=(_[et]<<16&16711680)+(_[et+1]<<8&65280)+(_[et+2]&255),_e.push(tripletToBase64(j));return _e.join("")}function fromByteArray(_){for(var a,$=_.length,j=$%3,_e=[],et=16383,tt=0,rt=$-j;tt<rt;tt+=et)_e.push(encodeChunk(_,tt,tt+et>rt?rt:tt+et));return j===1?(a=_[$-1],_e.push(lookup$3[a>>2]+lookup$3[a<<4&63]+"==")):j===2&&(a=(_[$-2]<<8)+_[$-1],_e.push(lookup$3[a>>10]+lookup$3[a>>4&63]+lookup$3[a<<2&63]+"=")),_e.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(_,a,$,j,_e){var et,tt,rt=_e*8-j-1,nt=(1<<rt)-1,it=nt>>1,st=-7,ot=$?_e-1:0,at=$?-1:1,lt=_[a+ot];for(ot+=at,et=lt&(1<<-st)-1,lt>>=-st,st+=rt;st>0;et=et*256+_[a+ot],ot+=at,st-=8);for(tt=et&(1<<-st)-1,et>>=-st,st+=j;st>0;tt=tt*256+_[a+ot],ot+=at,st-=8);if(et===0)et=1-it;else{if(et===nt)return tt?NaN:(lt?-1:1)*(1/0);tt=tt+Math.pow(2,j),et=et-it}return(lt?-1:1)*tt*Math.pow(2,et-j)};ieee754.write=function(_,a,$,j,_e,et){var tt,rt,nt,it=et*8-_e-1,st=(1<<it)-1,ot=st>>1,at=_e===23?Math.pow(2,-24)-Math.pow(2,-77):0,lt=j?0:et-1,ct=j?1:-1,ut=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(rt=isNaN(a)?1:0,tt=st):(tt=Math.floor(Math.log(a)/Math.LN2),a*(nt=Math.pow(2,-tt))<1&&(tt--,nt*=2),tt+ot>=1?a+=at/nt:a+=at*Math.pow(2,1-ot),a*nt>=2&&(tt++,nt/=2),tt+ot>=st?(rt=0,tt=st):tt+ot>=1?(rt=(a*nt-1)*Math.pow(2,_e),tt=tt+ot):(rt=a*Math.pow(2,ot-1)*Math.pow(2,_e),tt=0));_e>=8;_[$+lt]=rt&255,lt+=ct,rt/=256,_e-=8);for(tt=tt<<_e|rt,it+=_e;it>0;_[$+lt]=tt&255,lt+=ct,tt/=256,it-=8);_[$+lt-ct]|=ut*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(_){const a=base64Js,$=ieee754,j=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;_.Buffer=rt,_.SlowBuffer=pt,_.INSPECT_MAX_BYTES=50;const _e=2147483647;_.kMaxLength=_e,rt.TYPED_ARRAY_SUPPORT=et(),!rt.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function et(){try{const Ct=new Uint8Array(1),wt={foo:function(){return 42}};return Object.setPrototypeOf(wt,Uint8Array.prototype),Object.setPrototypeOf(Ct,wt),Ct.foo()===42}catch{return!1}}Object.defineProperty(rt.prototype,"parent",{enumerable:!0,get:function(){if(!!rt.isBuffer(this))return this.buffer}}),Object.defineProperty(rt.prototype,"offset",{enumerable:!0,get:function(){if(!!rt.isBuffer(this))return this.byteOffset}});function tt(Ct){if(Ct>_e)throw new RangeError('The value "'+Ct+'" is invalid for option "size"');const wt=new Uint8Array(Ct);return Object.setPrototypeOf(wt,rt.prototype),wt}function rt(Ct,wt,$t){if(typeof Ct=="number"){if(typeof wt=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return ot(Ct)}return nt(Ct,wt,$t)}rt.poolSize=8192;function nt(Ct,wt,$t){if(typeof Ct=="string")return at(Ct,wt);if(ArrayBuffer.isView(Ct))return ct(Ct);if(Ct==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ct);if(dr(Ct,ArrayBuffer)||Ct&&dr(Ct.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(dr(Ct,SharedArrayBuffer)||Ct&&dr(Ct.buffer,SharedArrayBuffer)))return ut(Ct,wt,$t);if(typeof Ct=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Dt=Ct.valueOf&&Ct.valueOf();if(Dt!=null&&Dt!==Ct)return rt.from(Dt,wt,$t);const Ut=dt(Ct);if(Ut)return Ut;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Ct[Symbol.toPrimitive]=="function")return rt.from(Ct[Symbol.toPrimitive]("string"),wt,$t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ct)}rt.from=function(Ct,wt,$t){return nt(Ct,wt,$t)},Object.setPrototypeOf(rt.prototype,Uint8Array.prototype),Object.setPrototypeOf(rt,Uint8Array);function it(Ct){if(typeof Ct!="number")throw new TypeError('"size" argument must be of type number');if(Ct<0)throw new RangeError('The value "'+Ct+'" is invalid for option "size"')}function st(Ct,wt,$t){return it(Ct),Ct<=0?tt(Ct):wt!==void 0?typeof $t=="string"?tt(Ct).fill(wt,$t):tt(Ct).fill(wt):tt(Ct)}rt.alloc=function(Ct,wt,$t){return st(Ct,wt,$t)};function ot(Ct){return it(Ct),tt(Ct<0?0:ft(Ct)|0)}rt.allocUnsafe=function(Ct){return ot(Ct)},rt.allocUnsafeSlow=function(Ct){return ot(Ct)};function at(Ct,wt){if((typeof wt!="string"||wt==="")&&(wt="utf8"),!rt.isEncoding(wt))throw new TypeError("Unknown encoding: "+wt);const $t=yt(Ct,wt)|0;let Dt=tt($t);const Ut=Dt.write(Ct,wt);return Ut!==$t&&(Dt=Dt.slice(0,Ut)),Dt}function lt(Ct){const wt=Ct.length<0?0:ft(Ct.length)|0,$t=tt(wt);for(let Dt=0;Dt<wt;Dt+=1)$t[Dt]=Ct[Dt]&255;return $t}function ct(Ct){if(dr(Ct,Uint8Array)){const wt=new Uint8Array(Ct);return ut(wt.buffer,wt.byteOffset,wt.byteLength)}return lt(Ct)}function ut(Ct,wt,$t){if(wt<0||Ct.byteLength<wt)throw new RangeError('"offset" is outside of buffer bounds');if(Ct.byteLength<wt+($t||0))throw new RangeError('"length" is outside of buffer bounds');let Dt;return wt===void 0&&$t===void 0?Dt=new Uint8Array(Ct):$t===void 0?Dt=new Uint8Array(Ct,wt):Dt=new Uint8Array(Ct,wt,$t),Object.setPrototypeOf(Dt,rt.prototype),Dt}function dt(Ct){if(rt.isBuffer(Ct)){const wt=ft(Ct.length)|0,$t=tt(wt);return $t.length===0||Ct.copy($t,0,0,wt),$t}if(Ct.length!==void 0)return typeof Ct.length!="number"||ar(Ct.length)?tt(0):lt(Ct);if(Ct.type==="Buffer"&&Array.isArray(Ct.data))return lt(Ct.data)}function ft(Ct){if(Ct>=_e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+_e.toString(16)+" bytes");return Ct|0}function pt(Ct){return+Ct!=Ct&&(Ct=0),rt.alloc(+Ct)}rt.isBuffer=function(wt){return wt!=null&&wt._isBuffer===!0&&wt!==rt.prototype},rt.compare=function(wt,$t){if(dr(wt,Uint8Array)&&(wt=rt.from(wt,wt.offset,wt.byteLength)),dr($t,Uint8Array)&&($t=rt.from($t,$t.offset,$t.byteLength)),!rt.isBuffer(wt)||!rt.isBuffer($t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(wt===$t)return 0;let Dt=wt.length,Ut=$t.length;for(let zt=0,Ht=Math.min(Dt,Ut);zt<Ht;++zt)if(wt[zt]!==$t[zt]){Dt=wt[zt],Ut=$t[zt];break}return Dt<Ut?-1:Ut<Dt?1:0},rt.isEncoding=function(wt){switch(String(wt).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},rt.concat=function(wt,$t){if(!Array.isArray(wt))throw new TypeError('"list" argument must be an Array of Buffers');if(wt.length===0)return rt.alloc(0);let Dt;if($t===void 0)for($t=0,Dt=0;Dt<wt.length;++Dt)$t+=wt[Dt].length;const Ut=rt.allocUnsafe($t);let zt=0;for(Dt=0;Dt<wt.length;++Dt){let Ht=wt[Dt];if(dr(Ht,Uint8Array))zt+Ht.length>Ut.length?(rt.isBuffer(Ht)||(Ht=rt.from(Ht)),Ht.copy(Ut,zt)):Uint8Array.prototype.set.call(Ut,Ht,zt);else if(rt.isBuffer(Ht))Ht.copy(Ut,zt);else throw new TypeError('"list" argument must be an Array of Buffers');zt+=Ht.length}return Ut};function yt(Ct,wt){if(rt.isBuffer(Ct))return Ct.length;if(ArrayBuffer.isView(Ct)||dr(Ct,ArrayBuffer))return Ct.byteLength;if(typeof Ct!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Ct);const $t=Ct.length,Dt=arguments.length>2&&arguments[2]===!0;if(!Dt&&$t===0)return 0;let Ut=!1;for(;;)switch(wt){case"ascii":case"latin1":case"binary":return $t;case"utf8":case"utf-8":return fr(Ct).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $t*2;case"hex":return $t>>>1;case"base64":return lr(Ct).length;default:if(Ut)return Dt?-1:fr(Ct).length;wt=(""+wt).toLowerCase(),Ut=!0}}rt.byteLength=yt;function mt(Ct,wt,$t){let Dt=!1;if((wt===void 0||wt<0)&&(wt=0),wt>this.length||(($t===void 0||$t>this.length)&&($t=this.length),$t<=0)||($t>>>=0,wt>>>=0,$t<=wt))return"";for(Ct||(Ct="utf8");;)switch(Ct){case"hex":return Nt(this,wt,$t);case"utf8":case"utf-8":return gt(this,wt,$t);case"ascii":return Tt(this,wt,$t);case"latin1":case"binary":return At(this,wt,$t);case"base64":return kt(this,wt,$t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Bt(this,wt,$t);default:if(Dt)throw new TypeError("Unknown encoding: "+Ct);Ct=(Ct+"").toLowerCase(),Dt=!0}}rt.prototype._isBuffer=!0;function _t(Ct,wt,$t){const Dt=Ct[wt];Ct[wt]=Ct[$t],Ct[$t]=Dt}rt.prototype.swap16=function(){const wt=this.length;if(wt%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let $t=0;$t<wt;$t+=2)_t(this,$t,$t+1);return this},rt.prototype.swap32=function(){const wt=this.length;if(wt%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let $t=0;$t<wt;$t+=4)_t(this,$t,$t+3),_t(this,$t+1,$t+2);return this},rt.prototype.swap64=function(){const wt=this.length;if(wt%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let $t=0;$t<wt;$t+=8)_t(this,$t,$t+7),_t(this,$t+1,$t+6),_t(this,$t+2,$t+5),_t(this,$t+3,$t+4);return this},rt.prototype.toString=function(){const wt=this.length;return wt===0?"":arguments.length===0?gt(this,0,wt):mt.apply(this,arguments)},rt.prototype.toLocaleString=rt.prototype.toString,rt.prototype.equals=function(wt){if(!rt.isBuffer(wt))throw new TypeError("Argument must be a Buffer");return this===wt?!0:rt.compare(this,wt)===0},rt.prototype.inspect=function(){let wt="";const $t=_.INSPECT_MAX_BYTES;return wt=this.toString("hex",0,$t).replace(/(.{2})/g,"$1 ").trim(),this.length>$t&&(wt+=" ... "),"<Buffer "+wt+">"},j&&(rt.prototype[j]=rt.prototype.inspect),rt.prototype.compare=function(wt,$t,Dt,Ut,zt){if(dr(wt,Uint8Array)&&(wt=rt.from(wt,wt.offset,wt.byteLength)),!rt.isBuffer(wt))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof wt);if($t===void 0&&($t=0),Dt===void 0&&(Dt=wt?wt.length:0),Ut===void 0&&(Ut=0),zt===void 0&&(zt=this.length),$t<0||Dt>wt.length||Ut<0||zt>this.length)throw new RangeError("out of range index");if(Ut>=zt&&$t>=Dt)return 0;if(Ut>=zt)return-1;if($t>=Dt)return 1;if($t>>>=0,Dt>>>=0,Ut>>>=0,zt>>>=0,this===wt)return 0;let Ht=zt-Ut,er=Dt-$t;const Jt=Math.min(Ht,er),sr=this.slice(Ut,zt),gr=wt.slice($t,Dt);for(let nr=0;nr<Jt;++nr)if(sr[nr]!==gr[nr]){Ht=sr[nr],er=gr[nr];break}return Ht<er?-1:er<Ht?1:0};function vt(Ct,wt,$t,Dt,Ut){if(Ct.length===0)return-1;if(typeof $t=="string"?(Dt=$t,$t=0):$t>2147483647?$t=2147483647:$t<-2147483648&&($t=-2147483648),$t=+$t,ar($t)&&($t=Ut?0:Ct.length-1),$t<0&&($t=Ct.length+$t),$t>=Ct.length){if(Ut)return-1;$t=Ct.length-1}else if($t<0)if(Ut)$t=0;else return-1;if(typeof wt=="string"&&(wt=rt.from(wt,Dt)),rt.isBuffer(wt))return wt.length===0?-1:ht(Ct,wt,$t,Dt,Ut);if(typeof wt=="number")return wt=wt&255,typeof Uint8Array.prototype.indexOf=="function"?Ut?Uint8Array.prototype.indexOf.call(Ct,wt,$t):Uint8Array.prototype.lastIndexOf.call(Ct,wt,$t):ht(Ct,[wt],$t,Dt,Ut);throw new TypeError("val must be string, number or Buffer")}function ht(Ct,wt,$t,Dt,Ut){let zt=1,Ht=Ct.length,er=wt.length;if(Dt!==void 0&&(Dt=String(Dt).toLowerCase(),Dt==="ucs2"||Dt==="ucs-2"||Dt==="utf16le"||Dt==="utf-16le")){if(Ct.length<2||wt.length<2)return-1;zt=2,Ht/=2,er/=2,$t/=2}function Jt(gr,nr){return zt===1?gr[nr]:gr.readUInt16BE(nr*zt)}let sr;if(Ut){let gr=-1;for(sr=$t;sr<Ht;sr++)if(Jt(Ct,sr)===Jt(wt,gr===-1?0:sr-gr)){if(gr===-1&&(gr=sr),sr-gr+1===er)return gr*zt}else gr!==-1&&(sr-=sr-gr),gr=-1}else for($t+er>Ht&&($t=Ht-er),sr=$t;sr>=0;sr--){let gr=!0;for(let nr=0;nr<er;nr++)if(Jt(Ct,sr+nr)!==Jt(wt,nr)){gr=!1;break}if(gr)return sr}return-1}rt.prototype.includes=function(wt,$t,Dt){return this.indexOf(wt,$t,Dt)!==-1},rt.prototype.indexOf=function(wt,$t,Dt){return vt(this,wt,$t,Dt,!0)},rt.prototype.lastIndexOf=function(wt,$t,Dt){return vt(this,wt,$t,Dt,!1)};function St(Ct,wt,$t,Dt){$t=Number($t)||0;const Ut=Ct.length-$t;Dt?(Dt=Number(Dt),Dt>Ut&&(Dt=Ut)):Dt=Ut;const zt=wt.length;Dt>zt/2&&(Dt=zt/2);let Ht;for(Ht=0;Ht<Dt;++Ht){const er=parseInt(wt.substr(Ht*2,2),16);if(ar(er))return Ht;Ct[$t+Ht]=er}return Ht}function It(Ct,wt,$t,Dt){return ir(fr(wt,Ct.length-$t),Ct,$t,Dt)}function Lt(Ct,wt,$t,Dt){return ir(hr(wt),Ct,$t,Dt)}function Mt(Ct,wt,$t,Dt){return ir(lr(wt),Ct,$t,Dt)}function Kt(Ct,wt,$t,Dt){return ir(Or(wt,Ct.length-$t),Ct,$t,Dt)}rt.prototype.write=function(wt,$t,Dt,Ut){if($t===void 0)Ut="utf8",Dt=this.length,$t=0;else if(Dt===void 0&&typeof $t=="string")Ut=$t,Dt=this.length,$t=0;else if(isFinite($t))$t=$t>>>0,isFinite(Dt)?(Dt=Dt>>>0,Ut===void 0&&(Ut="utf8")):(Ut=Dt,Dt=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const zt=this.length-$t;if((Dt===void 0||Dt>zt)&&(Dt=zt),wt.length>0&&(Dt<0||$t<0)||$t>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ut||(Ut="utf8");let Ht=!1;for(;;)switch(Ut){case"hex":return St(this,wt,$t,Dt);case"utf8":case"utf-8":return It(this,wt,$t,Dt);case"ascii":case"latin1":case"binary":return Lt(this,wt,$t,Dt);case"base64":return Mt(this,wt,$t,Dt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Kt(this,wt,$t,Dt);default:if(Ht)throw new TypeError("Unknown encoding: "+Ut);Ut=(""+Ut).toLowerCase(),Ht=!0}},rt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function kt(Ct,wt,$t){return wt===0&&$t===Ct.length?a.fromByteArray(Ct):a.fromByteArray(Ct.slice(wt,$t))}function gt(Ct,wt,$t){$t=Math.min(Ct.length,$t);const Dt=[];let Ut=wt;for(;Ut<$t;){const zt=Ct[Ut];let Ht=null,er=zt>239?4:zt>223?3:zt>191?2:1;if(Ut+er<=$t){let Jt,sr,gr,nr;switch(er){case 1:zt<128&&(Ht=zt);break;case 2:Jt=Ct[Ut+1],(Jt&192)===128&&(nr=(zt&31)<<6|Jt&63,nr>127&&(Ht=nr));break;case 3:Jt=Ct[Ut+1],sr=Ct[Ut+2],(Jt&192)===128&&(sr&192)===128&&(nr=(zt&15)<<12|(Jt&63)<<6|sr&63,nr>2047&&(nr<55296||nr>57343)&&(Ht=nr));break;case 4:Jt=Ct[Ut+1],sr=Ct[Ut+2],gr=Ct[Ut+3],(Jt&192)===128&&(sr&192)===128&&(gr&192)===128&&(nr=(zt&15)<<18|(Jt&63)<<12|(sr&63)<<6|gr&63,nr>65535&&nr<1114112&&(Ht=nr))}}Ht===null?(Ht=65533,er=1):Ht>65535&&(Ht-=65536,Dt.push(Ht>>>10&1023|55296),Ht=56320|Ht&1023),Dt.push(Ht),Ut+=er}return xt(Dt)}const Et=4096;function xt(Ct){const wt=Ct.length;if(wt<=Et)return String.fromCharCode.apply(String,Ct);let $t="",Dt=0;for(;Dt<wt;)$t+=String.fromCharCode.apply(String,Ct.slice(Dt,Dt+=Et));return $t}function Tt(Ct,wt,$t){let Dt="";$t=Math.min(Ct.length,$t);for(let Ut=wt;Ut<$t;++Ut)Dt+=String.fromCharCode(Ct[Ut]&127);return Dt}function At(Ct,wt,$t){let Dt="";$t=Math.min(Ct.length,$t);for(let Ut=wt;Ut<$t;++Ut)Dt+=String.fromCharCode(Ct[Ut]);return Dt}function Nt(Ct,wt,$t){const Dt=Ct.length;(!wt||wt<0)&&(wt=0),(!$t||$t<0||$t>Dt)&&($t=Dt);let Ut="";for(let zt=wt;zt<$t;++zt)Ut+=cr[Ct[zt]];return Ut}function Bt(Ct,wt,$t){const Dt=Ct.slice(wt,$t);let Ut="";for(let zt=0;zt<Dt.length-1;zt+=2)Ut+=String.fromCharCode(Dt[zt]+Dt[zt+1]*256);return Ut}rt.prototype.slice=function(wt,$t){const Dt=this.length;wt=~~wt,$t=$t===void 0?Dt:~~$t,wt<0?(wt+=Dt,wt<0&&(wt=0)):wt>Dt&&(wt=Dt),$t<0?($t+=Dt,$t<0&&($t=0)):$t>Dt&&($t=Dt),$t<wt&&($t=wt);const Ut=this.subarray(wt,$t);return Object.setPrototypeOf(Ut,rt.prototype),Ut};function Ot(Ct,wt,$t){if(Ct%1!==0||Ct<0)throw new RangeError("offset is not uint");if(Ct+wt>$t)throw new RangeError("Trying to access beyond buffer length")}rt.prototype.readUintLE=rt.prototype.readUIntLE=function(wt,$t,Dt){wt=wt>>>0,$t=$t>>>0,Dt||Ot(wt,$t,this.length);let Ut=this[wt],zt=1,Ht=0;for(;++Ht<$t&&(zt*=256);)Ut+=this[wt+Ht]*zt;return Ut},rt.prototype.readUintBE=rt.prototype.readUIntBE=function(wt,$t,Dt){wt=wt>>>0,$t=$t>>>0,Dt||Ot(wt,$t,this.length);let Ut=this[wt+--$t],zt=1;for(;$t>0&&(zt*=256);)Ut+=this[wt+--$t]*zt;return Ut},rt.prototype.readUint8=rt.prototype.readUInt8=function(wt,$t){return wt=wt>>>0,$t||Ot(wt,1,this.length),this[wt]},rt.prototype.readUint16LE=rt.prototype.readUInt16LE=function(wt,$t){return wt=wt>>>0,$t||Ot(wt,2,this.length),this[wt]|this[wt+1]<<8},rt.prototype.readUint16BE=rt.prototype.readUInt16BE=function(wt,$t){return wt=wt>>>0,$t||Ot(wt,2,this.length),this[wt]<<8|this[wt+1]},rt.prototype.readUint32LE=rt.prototype.readUInt32LE=function(wt,$t){return wt=wt>>>0,$t||Ot(wt,4,this.length),(this[wt]|this[wt+1]<<8|this[wt+2]<<16)+this[wt+3]*16777216},rt.prototype.readUint32BE=rt.prototype.readUInt32BE=function(wt,$t){return wt=wt>>>0,$t||Ot(wt,4,this.length),this[wt]*16777216+(this[wt+1]<<16|this[wt+2]<<8|this[wt+3])},rt.prototype.readBigUInt64LE=pr(function(wt){wt=wt>>>0,Xt(wt,"offset");const $t=this[wt],Dt=this[wt+7];($t===void 0||Dt===void 0)&&Zt(wt,this.length-8);const Ut=$t+this[++wt]*2**8+this[++wt]*2**16+this[++wt]*2**24,zt=this[++wt]+this[++wt]*2**8+this[++wt]*2**16+Dt*2**24;return BigInt(Ut)+(BigInt(zt)<<BigInt(32))}),rt.prototype.readBigUInt64BE=pr(function(wt){wt=wt>>>0,Xt(wt,"offset");const $t=this[wt],Dt=this[wt+7];($t===void 0||Dt===void 0)&&Zt(wt,this.length-8);const Ut=$t*2**24+this[++wt]*2**16+this[++wt]*2**8+this[++wt],zt=this[++wt]*2**24+this[++wt]*2**16+this[++wt]*2**8+Dt;return(BigInt(Ut)<<BigInt(32))+BigInt(zt)}),rt.prototype.readIntLE=function(wt,$t,Dt){wt=wt>>>0,$t=$t>>>0,Dt||Ot(wt,$t,this.length);let Ut=this[wt],zt=1,Ht=0;for(;++Ht<$t&&(zt*=256);)Ut+=this[wt+Ht]*zt;return zt*=128,Ut>=zt&&(Ut-=Math.pow(2,8*$t)),Ut},rt.prototype.readIntBE=function(wt,$t,Dt){wt=wt>>>0,$t=$t>>>0,Dt||Ot(wt,$t,this.length);let Ut=$t,zt=1,Ht=this[wt+--Ut];for(;Ut>0&&(zt*=256);)Ht+=this[wt+--Ut]*zt;return zt*=128,Ht>=zt&&(Ht-=Math.pow(2,8*$t)),Ht},rt.prototype.readInt8=function(wt,$t){return wt=wt>>>0,$t||Ot(wt,1,this.length),this[wt]&128?(255-this[wt]+1)*-1:this[wt]},rt.prototype.readInt16LE=function(wt,$t){wt=wt>>>0,$t||Ot(wt,2,this.length);const Dt=this[wt]|this[wt+1]<<8;return Dt&32768?Dt|4294901760:Dt},rt.prototype.readInt16BE=function(wt,$t){wt=wt>>>0,$t||Ot(wt,2,this.length);const Dt=this[wt+1]|this[wt]<<8;return Dt&32768?Dt|4294901760:Dt},rt.prototype.readInt32LE=function(wt,$t){return wt=wt>>>0,$t||Ot(wt,4,this.length),this[wt]|this[wt+1]<<8|this[wt+2]<<16|this[wt+3]<<24},rt.prototype.readInt32BE=function(wt,$t){return wt=wt>>>0,$t||Ot(wt,4,this.length),this[wt]<<24|this[wt+1]<<16|this[wt+2]<<8|this[wt+3]},rt.prototype.readBigInt64LE=pr(function(wt){wt=wt>>>0,Xt(wt,"offset");const $t=this[wt],Dt=this[wt+7];($t===void 0||Dt===void 0)&&Zt(wt,this.length-8);const Ut=this[wt+4]+this[wt+5]*2**8+this[wt+6]*2**16+(Dt<<24);return(BigInt(Ut)<<BigInt(32))+BigInt($t+this[++wt]*2**8+this[++wt]*2**16+this[++wt]*2**24)}),rt.prototype.readBigInt64BE=pr(function(wt){wt=wt>>>0,Xt(wt,"offset");const $t=this[wt],Dt=this[wt+7];($t===void 0||Dt===void 0)&&Zt(wt,this.length-8);const Ut=($t<<24)+this[++wt]*2**16+this[++wt]*2**8+this[++wt];return(BigInt(Ut)<<BigInt(32))+BigInt(this[++wt]*2**24+this[++wt]*2**16+this[++wt]*2**8+Dt)}),rt.prototype.readFloatLE=function(wt,$t){return wt=wt>>>0,$t||Ot(wt,4,this.length),$.read(this,wt,!0,23,4)},rt.prototype.readFloatBE=function(wt,$t){return wt=wt>>>0,$t||Ot(wt,4,this.length),$.read(this,wt,!1,23,4)},rt.prototype.readDoubleLE=function(wt,$t){return wt=wt>>>0,$t||Ot(wt,8,this.length),$.read(this,wt,!0,52,8)},rt.prototype.readDoubleBE=function(wt,$t){return wt=wt>>>0,$t||Ot(wt,8,this.length),$.read(this,wt,!1,52,8)};function bt(Ct,wt,$t,Dt,Ut,zt){if(!rt.isBuffer(Ct))throw new TypeError('"buffer" argument must be a Buffer instance');if(wt>Ut||wt<zt)throw new RangeError('"value" argument is out of bounds');if($t+Dt>Ct.length)throw new RangeError("Index out of range")}rt.prototype.writeUintLE=rt.prototype.writeUIntLE=function(wt,$t,Dt,Ut){if(wt=+wt,$t=$t>>>0,Dt=Dt>>>0,!Ut){const er=Math.pow(2,8*Dt)-1;bt(this,wt,$t,Dt,er,0)}let zt=1,Ht=0;for(this[$t]=wt&255;++Ht<Dt&&(zt*=256);)this[$t+Ht]=wt/zt&255;return $t+Dt},rt.prototype.writeUintBE=rt.prototype.writeUIntBE=function(wt,$t,Dt,Ut){if(wt=+wt,$t=$t>>>0,Dt=Dt>>>0,!Ut){const er=Math.pow(2,8*Dt)-1;bt(this,wt,$t,Dt,er,0)}let zt=Dt-1,Ht=1;for(this[$t+zt]=wt&255;--zt>=0&&(Ht*=256);)this[$t+zt]=wt/Ht&255;return $t+Dt},rt.prototype.writeUint8=rt.prototype.writeUInt8=function(wt,$t,Dt){return wt=+wt,$t=$t>>>0,Dt||bt(this,wt,$t,1,255,0),this[$t]=wt&255,$t+1},rt.prototype.writeUint16LE=rt.prototype.writeUInt16LE=function(wt,$t,Dt){return wt=+wt,$t=$t>>>0,Dt||bt(this,wt,$t,2,65535,0),this[$t]=wt&255,this[$t+1]=wt>>>8,$t+2},rt.prototype.writeUint16BE=rt.prototype.writeUInt16BE=function(wt,$t,Dt){return wt=+wt,$t=$t>>>0,Dt||bt(this,wt,$t,2,65535,0),this[$t]=wt>>>8,this[$t+1]=wt&255,$t+2},rt.prototype.writeUint32LE=rt.prototype.writeUInt32LE=function(wt,$t,Dt){return wt=+wt,$t=$t>>>0,Dt||bt(this,wt,$t,4,4294967295,0),this[$t+3]=wt>>>24,this[$t+2]=wt>>>16,this[$t+1]=wt>>>8,this[$t]=wt&255,$t+4},rt.prototype.writeUint32BE=rt.prototype.writeUInt32BE=function(wt,$t,Dt){return wt=+wt,$t=$t>>>0,Dt||bt(this,wt,$t,4,4294967295,0),this[$t]=wt>>>24,this[$t+1]=wt>>>16,this[$t+2]=wt>>>8,this[$t+3]=wt&255,$t+4};function Rt(Ct,wt,$t,Dt,Ut){Yt(wt,Dt,Ut,Ct,$t,7);let zt=Number(wt&BigInt(4294967295));Ct[$t++]=zt,zt=zt>>8,Ct[$t++]=zt,zt=zt>>8,Ct[$t++]=zt,zt=zt>>8,Ct[$t++]=zt;let Ht=Number(wt>>BigInt(32)&BigInt(4294967295));return Ct[$t++]=Ht,Ht=Ht>>8,Ct[$t++]=Ht,Ht=Ht>>8,Ct[$t++]=Ht,Ht=Ht>>8,Ct[$t++]=Ht,$t}function Gt(Ct,wt,$t,Dt,Ut){Yt(wt,Dt,Ut,Ct,$t,7);let zt=Number(wt&BigInt(4294967295));Ct[$t+7]=zt,zt=zt>>8,Ct[$t+6]=zt,zt=zt>>8,Ct[$t+5]=zt,zt=zt>>8,Ct[$t+4]=zt;let Ht=Number(wt>>BigInt(32)&BigInt(4294967295));return Ct[$t+3]=Ht,Ht=Ht>>8,Ct[$t+2]=Ht,Ht=Ht>>8,Ct[$t+1]=Ht,Ht=Ht>>8,Ct[$t]=Ht,$t+8}rt.prototype.writeBigUInt64LE=pr(function(wt,$t=0){return Rt(this,wt,$t,BigInt(0),BigInt("0xffffffffffffffff"))}),rt.prototype.writeBigUInt64BE=pr(function(wt,$t=0){return Gt(this,wt,$t,BigInt(0),BigInt("0xffffffffffffffff"))}),rt.prototype.writeIntLE=function(wt,$t,Dt,Ut){if(wt=+wt,$t=$t>>>0,!Ut){const Jt=Math.pow(2,8*Dt-1);bt(this,wt,$t,Dt,Jt-1,-Jt)}let zt=0,Ht=1,er=0;for(this[$t]=wt&255;++zt<Dt&&(Ht*=256);)wt<0&&er===0&&this[$t+zt-1]!==0&&(er=1),this[$t+zt]=(wt/Ht>>0)-er&255;return $t+Dt},rt.prototype.writeIntBE=function(wt,$t,Dt,Ut){if(wt=+wt,$t=$t>>>0,!Ut){const Jt=Math.pow(2,8*Dt-1);bt(this,wt,$t,Dt,Jt-1,-Jt)}let zt=Dt-1,Ht=1,er=0;for(this[$t+zt]=wt&255;--zt>=0&&(Ht*=256);)wt<0&&er===0&&this[$t+zt+1]!==0&&(er=1),this[$t+zt]=(wt/Ht>>0)-er&255;return $t+Dt},rt.prototype.writeInt8=function(wt,$t,Dt){return wt=+wt,$t=$t>>>0,Dt||bt(this,wt,$t,1,127,-128),wt<0&&(wt=255+wt+1),this[$t]=wt&255,$t+1},rt.prototype.writeInt16LE=function(wt,$t,Dt){return wt=+wt,$t=$t>>>0,Dt||bt(this,wt,$t,2,32767,-32768),this[$t]=wt&255,this[$t+1]=wt>>>8,$t+2},rt.prototype.writeInt16BE=function(wt,$t,Dt){return wt=+wt,$t=$t>>>0,Dt||bt(this,wt,$t,2,32767,-32768),this[$t]=wt>>>8,this[$t+1]=wt&255,$t+2},rt.prototype.writeInt32LE=function(wt,$t,Dt){return wt=+wt,$t=$t>>>0,Dt||bt(this,wt,$t,4,2147483647,-2147483648),this[$t]=wt&255,this[$t+1]=wt>>>8,this[$t+2]=wt>>>16,this[$t+3]=wt>>>24,$t+4},rt.prototype.writeInt32BE=function(wt,$t,Dt){return wt=+wt,$t=$t>>>0,Dt||bt(this,wt,$t,4,2147483647,-2147483648),wt<0&&(wt=4294967295+wt+1),this[$t]=wt>>>24,this[$t+1]=wt>>>16,this[$t+2]=wt>>>8,this[$t+3]=wt&255,$t+4},rt.prototype.writeBigInt64LE=pr(function(wt,$t=0){return Rt(this,wt,$t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),rt.prototype.writeBigInt64BE=pr(function(wt,$t=0){return Gt(this,wt,$t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Pt(Ct,wt,$t,Dt,Ut,zt){if($t+Dt>Ct.length)throw new RangeError("Index out of range");if($t<0)throw new RangeError("Index out of range")}function Ft(Ct,wt,$t,Dt,Ut){return wt=+wt,$t=$t>>>0,Ut||Pt(Ct,wt,$t,4),$.write(Ct,wt,$t,Dt,23,4),$t+4}rt.prototype.writeFloatLE=function(wt,$t,Dt){return Ft(this,wt,$t,!0,Dt)},rt.prototype.writeFloatBE=function(wt,$t,Dt){return Ft(this,wt,$t,!1,Dt)};function jt(Ct,wt,$t,Dt,Ut){return wt=+wt,$t=$t>>>0,Ut||Pt(Ct,wt,$t,8),$.write(Ct,wt,$t,Dt,52,8),$t+8}rt.prototype.writeDoubleLE=function(wt,$t,Dt){return jt(this,wt,$t,!0,Dt)},rt.prototype.writeDoubleBE=function(wt,$t,Dt){return jt(this,wt,$t,!1,Dt)},rt.prototype.copy=function(wt,$t,Dt,Ut){if(!rt.isBuffer(wt))throw new TypeError("argument should be a Buffer");if(Dt||(Dt=0),!Ut&&Ut!==0&&(Ut=this.length),$t>=wt.length&&($t=wt.length),$t||($t=0),Ut>0&&Ut<Dt&&(Ut=Dt),Ut===Dt||wt.length===0||this.length===0)return 0;if($t<0)throw new RangeError("targetStart out of bounds");if(Dt<0||Dt>=this.length)throw new RangeError("Index out of range");if(Ut<0)throw new RangeError("sourceEnd out of bounds");Ut>this.length&&(Ut=this.length),wt.length-$t<Ut-Dt&&(Ut=wt.length-$t+Dt);const zt=Ut-Dt;return this===wt&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin($t,Dt,Ut):Uint8Array.prototype.set.call(wt,this.subarray(Dt,Ut),$t),zt},rt.prototype.fill=function(wt,$t,Dt,Ut){if(typeof wt=="string"){if(typeof $t=="string"?(Ut=$t,$t=0,Dt=this.length):typeof Dt=="string"&&(Ut=Dt,Dt=this.length),Ut!==void 0&&typeof Ut!="string")throw new TypeError("encoding must be a string");if(typeof Ut=="string"&&!rt.isEncoding(Ut))throw new TypeError("Unknown encoding: "+Ut);if(wt.length===1){const Ht=wt.charCodeAt(0);(Ut==="utf8"&&Ht<128||Ut==="latin1")&&(wt=Ht)}}else typeof wt=="number"?wt=wt&255:typeof wt=="boolean"&&(wt=Number(wt));if($t<0||this.length<$t||this.length<Dt)throw new RangeError("Out of range index");if(Dt<=$t)return this;$t=$t>>>0,Dt=Dt===void 0?this.length:Dt>>>0,wt||(wt=0);let zt;if(typeof wt=="number")for(zt=$t;zt<Dt;++zt)this[zt]=wt;else{const Ht=rt.isBuffer(wt)?wt:rt.from(wt,Ut),er=Ht.length;if(er===0)throw new TypeError('The value "'+wt+'" is invalid for argument "value"');for(zt=0;zt<Dt-$t;++zt)this[zt+$t]=Ht[zt%er]}return this};const Vt={};function Wt(Ct,wt,$t){Vt[Ct]=class extends $t{constructor(){super(),Object.defineProperty(this,"message",{value:wt.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Ct}]`,this.stack,delete this.name}get code(){return Ct}set code(Ut){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Ut,writable:!0})}toString(){return`${this.name} [${Ct}]: ${this.message}`}}}Wt("ERR_BUFFER_OUT_OF_BOUNDS",function(Ct){return Ct?`${Ct} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Wt("ERR_INVALID_ARG_TYPE",function(Ct,wt){return`The "${Ct}" argument must be of type number. Received type ${typeof wt}`},TypeError),Wt("ERR_OUT_OF_RANGE",function(Ct,wt,$t){let Dt=`The value of "${Ct}" is out of range.`,Ut=$t;return Number.isInteger($t)&&Math.abs($t)>2**32?Ut=Qt(String($t)):typeof $t=="bigint"&&(Ut=String($t),($t>BigInt(2)**BigInt(32)||$t<-(BigInt(2)**BigInt(32)))&&(Ut=Qt(Ut)),Ut+="n"),Dt+=` It must be ${wt}. Received ${Ut}`,Dt},RangeError);function Qt(Ct){let wt="",$t=Ct.length;const Dt=Ct[0]==="-"?1:0;for(;$t>=Dt+4;$t-=3)wt=`_${Ct.slice($t-3,$t)}${wt}`;return`${Ct.slice(0,$t)}${wt}`}function qt(Ct,wt,$t){Xt(wt,"offset"),(Ct[wt]===void 0||Ct[wt+$t]===void 0)&&Zt(wt,Ct.length-($t+1))}function Yt(Ct,wt,$t,Dt,Ut,zt){if(Ct>$t||Ct<wt){const Ht=typeof wt=="bigint"?"n":"";let er;throw zt>3?wt===0||wt===BigInt(0)?er=`>= 0${Ht} and < 2${Ht} ** ${(zt+1)*8}${Ht}`:er=`>= -(2${Ht} ** ${(zt+1)*8-1}${Ht}) and < 2 ** ${(zt+1)*8-1}${Ht}`:er=`>= ${wt}${Ht} and <= ${$t}${Ht}`,new Vt.ERR_OUT_OF_RANGE("value",er,Ct)}qt(Dt,Ut,zt)}function Xt(Ct,wt){if(typeof Ct!="number")throw new Vt.ERR_INVALID_ARG_TYPE(wt,"number",Ct)}function Zt(Ct,wt,$t){throw Math.floor(Ct)!==Ct?(Xt(Ct,$t),new Vt.ERR_OUT_OF_RANGE($t||"offset","an integer",Ct)):wt<0?new Vt.ERR_BUFFER_OUT_OF_BOUNDS:new Vt.ERR_OUT_OF_RANGE($t||"offset",`>= ${$t?1:0} and <= ${wt}`,Ct)}const tr=/[^+/0-9A-Za-z-_]/g;function Dr(Ct){if(Ct=Ct.split("=")[0],Ct=Ct.trim().replace(tr,""),Ct.length<2)return"";for(;Ct.length%4!==0;)Ct=Ct+"=";return Ct}function fr(Ct,wt){wt=wt||1/0;let $t;const Dt=Ct.length;let Ut=null;const zt=[];for(let Ht=0;Ht<Dt;++Ht){if($t=Ct.charCodeAt(Ht),$t>55295&&$t<57344){if(!Ut){if($t>56319){(wt-=3)>-1&&zt.push(239,191,189);continue}else if(Ht+1===Dt){(wt-=3)>-1&&zt.push(239,191,189);continue}Ut=$t;continue}if($t<56320){(wt-=3)>-1&&zt.push(239,191,189),Ut=$t;continue}$t=(Ut-55296<<10|$t-56320)+65536}else Ut&&(wt-=3)>-1&&zt.push(239,191,189);if(Ut=null,$t<128){if((wt-=1)<0)break;zt.push($t)}else if($t<2048){if((wt-=2)<0)break;zt.push($t>>6|192,$t&63|128)}else if($t<65536){if((wt-=3)<0)break;zt.push($t>>12|224,$t>>6&63|128,$t&63|128)}else if($t<1114112){if((wt-=4)<0)break;zt.push($t>>18|240,$t>>12&63|128,$t>>6&63|128,$t&63|128)}else throw new Error("Invalid code point")}return zt}function hr(Ct){const wt=[];for(let $t=0;$t<Ct.length;++$t)wt.push(Ct.charCodeAt($t)&255);return wt}function Or(Ct,wt){let $t,Dt,Ut;const zt=[];for(let Ht=0;Ht<Ct.length&&!((wt-=2)<0);++Ht)$t=Ct.charCodeAt(Ht),Dt=$t>>8,Ut=$t%256,zt.push(Ut),zt.push(Dt);return zt}function lr(Ct){return a.toByteArray(Dr(Ct))}function ir(Ct,wt,$t,Dt){let Ut;for(Ut=0;Ut<Dt&&!(Ut+$t>=wt.length||Ut>=Ct.length);++Ut)wt[Ut+$t]=Ct[Ut];return Ut}function dr(Ct,wt){return Ct instanceof wt||Ct!=null&&Ct.constructor!=null&&Ct.constructor.name!=null&&Ct.constructor.name===wt.name}function ar(Ct){return Ct!==Ct}const cr=function(){const Ct="0123456789abcdef",wt=new Array(256);for(let $t=0;$t<16;++$t){const Dt=$t*16;for(let Ut=0;Ut<16;++Ut)wt[Dt+Ut]=Ct[$t]+Ct[Ut]}return wt}();function pr(Ct){return typeof BigInt>"u"?ur:Ct}function ur(){throw new Error("BigInt not supported")}})(buffer);let lazy=null;var textEndec$1=function(){return lazy===null&&(lazy={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),lazy},formats$2={},encoding={};const ModuleError$8=moduleError,formats$1=new Set(["buffer","view","utf8"]);class Encoding$2{constructor(a){if(this.encode=a.encode||this.encode,this.decode=a.decode||this.decode,this.name=a.name||this.name,this.format=a.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!formats$1.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");a.createViewTranscoder&&(this.createViewTranscoder=a.createViewTranscoder),a.createBufferTranscoder&&(this.createBufferTranscoder=a.createBufferTranscoder),a.createUTF8Transcoder&&(this.createUTF8Transcoder=a.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}}encoding.Encoding=Encoding$2;const{Buffer:Buffer$3}=buffer||{},{Encoding:Encoding$1}=encoding,textEndec=textEndec$1;class BufferFormat$2 extends Encoding$1{constructor(a){super({...a,format:"buffer"})}createViewTranscoder(){return new ViewFormat$2({encode:this.encode,decode:a=>this.decode(Buffer$3.from(a.buffer,a.byteOffset,a.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}}class ViewFormat$2 extends Encoding$1{constructor(a){super({...a,format:"view"})}createBufferTranscoder(){return new BufferFormat$2({encode:a=>{const $=this.encode(a);return Buffer$3.from($.buffer,$.byteOffset,$.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}}class UTF8Format$2 extends Encoding$1{constructor(a){super({...a,format:"utf8"})}createBufferTranscoder(){return new BufferFormat$2({encode:a=>Buffer$3.from(this.encode(a),"utf8"),decode:a=>this.decode(a.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:a,textDecoder:$}=textEndec();return new ViewFormat$2({encode:j=>a.encode(this.encode(j)),decode:j=>this.decode($.decode(j)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}}formats$2.BufferFormat=BufferFormat$2;formats$2.ViewFormat=ViewFormat$2;formats$2.UTF8Format=UTF8Format$2;const{Buffer:Buffer$2}=buffer||{Buffer:{isBuffer:()=>!1}},{textEncoder:textEncoder$1,textDecoder}=textEndec$1(),{BufferFormat:BufferFormat$1,ViewFormat:ViewFormat$1,UTF8Format:UTF8Format$1}=formats$2,identity$6=_=>_;encodings$1.utf8=new UTF8Format$1({encode:function(_){return Buffer$2.isBuffer(_)?_.toString("utf8"):ArrayBuffer.isView(_)?textDecoder.decode(_):String(_)},decode:identity$6,name:"utf8",createViewTranscoder(){return new ViewFormat$1({encode:function(_){return ArrayBuffer.isView(_)?_:textEncoder$1.encode(_)},decode:function(_){return textDecoder.decode(_)},name:`${this.name}+view`})},createBufferTranscoder(){return new BufferFormat$1({encode:function(_){return Buffer$2.isBuffer(_)?_:ArrayBuffer.isView(_)?Buffer$2.from(_.buffer,_.byteOffset,_.byteLength):Buffer$2.from(String(_),"utf8")},decode:function(_){return _.toString("utf8")},name:`${this.name}+buffer`})}});encodings$1.json=new UTF8Format$1({encode:JSON.stringify,decode:JSON.parse,name:"json"});encodings$1.buffer=new BufferFormat$1({encode:function(_){return Buffer$2.isBuffer(_)?_:ArrayBuffer.isView(_)?Buffer$2.from(_.buffer,_.byteOffset,_.byteLength):Buffer$2.from(String(_),"utf8")},decode:identity$6,name:"buffer",createViewTranscoder(){return new ViewFormat$1({encode:function(_){return ArrayBuffer.isView(_)?_:Buffer$2.from(String(_),"utf8")},decode:function(_){return Buffer$2.from(_.buffer,_.byteOffset,_.byteLength)},name:`${this.name}+view`})}});encodings$1.view=new ViewFormat$1({encode:function(_){return ArrayBuffer.isView(_)?_:textEncoder$1.encode(_)},decode:identity$6,name:"view",createBufferTranscoder(){return new BufferFormat$1({encode:function(_){return Buffer$2.isBuffer(_)?_:ArrayBuffer.isView(_)?Buffer$2.from(_.buffer,_.byteOffset,_.byteLength):Buffer$2.from(String(_),"utf8")},decode:identity$6,name:`${this.name}+buffer`})}});encodings$1.hex=new BufferFormat$1({encode:function(_){return Buffer$2.isBuffer(_)?_:Buffer$2.from(String(_),"hex")},decode:function(_){return _.toString("hex")},name:"hex"});encodings$1.base64=new BufferFormat$1({encode:function(_){return Buffer$2.isBuffer(_)?_:Buffer$2.from(String(_),"base64")},decode:function(_){return _.toString("base64")},name:"base64"});const ModuleError$7=moduleError,encodings=encodings$1,{Encoding}=encoding,{BufferFormat,ViewFormat,UTF8Format}=formats$2,kFormats=Symbol("formats"),kEncodings=Symbol("encodings"),validFormats=new Set(["buffer","view","utf8"]);class Transcoder$1{constructor(a){if(Array.isArray(a)){if(!a.every($=>validFormats.has($)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[kEncodings]=new Map,this[kFormats]=new Set(a);for(const $ in encodings)try{this.encoding($)}catch(j){if(j.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw j}}encodings(){return Array.from(new Set(this[kEncodings].values()))}encoding(a){let $=this[kEncodings].get(a);if($===void 0){if(typeof a=="string"&&a!==""){if($=lookup$2[a],!$)throw new ModuleError$7(`Encoding '${a}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof a!="object"||a===null)throw new TypeError("First argument 'encoding' must be a string or object");$=from$4(a)}const{name:j,format:_e}=$;if(!this[kFormats].has(_e))if(this[kFormats].has("view"))$=$.createViewTranscoder();else if(this[kFormats].has("buffer"))$=$.createBufferTranscoder();else if(this[kFormats].has("utf8"))$=$.createUTF8Transcoder();else throw new ModuleError$7(`Encoding '${j}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(const et of[a,j,$.name,$.commonName])this[kEncodings].set(et,$)}return $}}levelTranscoder.Transcoder=Transcoder$1;function from$4(_){if(_ instanceof Encoding)return _;const a="type"in _&&typeof _.type=="string"?_.type:void 0,$=_.name||a||`anonymous-${anonymousCount++}`;switch(detectFormat(_)){case"view":return new ViewFormat({..._,name:$});case"utf8":return new UTF8Format({..._,name:$});case"buffer":return new BufferFormat({..._,name:$});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function detectFormat(_){return"format"in _&&_.format!==void 0?_.format:"buffer"in _&&typeof _.buffer=="boolean"?_.buffer?"buffer":"utf8":"code"in _&&Number.isInteger(_.code)?"view":"buffer"}const aliases={binary:encodings.buffer,"utf-8":encodings.utf8},lookup$2={...encodings,...aliases};let anonymousCount=0;var events={exports:{}},R=typeof Reflect=="object"?Reflect:null,ReflectApply=R&&typeof R.apply=="function"?R.apply:function _(a,$,j){return Function.prototype.apply.call(a,$,j)},ReflectOwnKeys;R&&typeof R.ownKeys=="function"?ReflectOwnKeys=R.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))}:ReflectOwnKeys=function(a){return Object.getOwnPropertyNames(a)};function ProcessEmitWarning(_){console&&console.warn&&console.warn(_)}var NumberIsNaN=Number.isNaN||function _(a){return a!==a};function EventEmitter$3(){EventEmitter$3.init.call(this)}events.exports=EventEmitter$3;events.exports.once=once;EventEmitter$3.EventEmitter=EventEmitter$3;EventEmitter$3.prototype._events=void 0;EventEmitter$3.prototype._eventsCount=0;EventEmitter$3.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}Object.defineProperty(EventEmitter$3,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(_){if(typeof _!="number"||_<0||NumberIsNaN(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");defaultMaxListeners=_}});EventEmitter$3.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};EventEmitter$3.prototype.setMaxListeners=function _(a){if(typeof a!="number"||a<0||NumberIsNaN(a))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this};function _getMaxListeners(_){return _._maxListeners===void 0?EventEmitter$3.defaultMaxListeners:_._maxListeners}EventEmitter$3.prototype.getMaxListeners=function _(){return _getMaxListeners(this)};EventEmitter$3.prototype.emit=function _(a){for(var $=[],j=1;j<arguments.length;j++)$.push(arguments[j]);var _e=a==="error",et=this._events;if(et!==void 0)_e=_e&&et.error===void 0;else if(!_e)return!1;if(_e){var tt;if($.length>0&&(tt=$[0]),tt instanceof Error)throw tt;var rt=new Error("Unhandled error."+(tt?" ("+tt.message+")":""));throw rt.context=tt,rt}var nt=et[a];if(nt===void 0)return!1;if(typeof nt=="function")ReflectApply(nt,this,$);else for(var it=nt.length,st=arrayClone(nt,it),j=0;j<it;++j)ReflectApply(st[j],this,$);return!0};function _addListener(_,a,$,j){var _e,et,tt;if(checkListener($),et=_._events,et===void 0?(et=_._events=Object.create(null),_._eventsCount=0):(et.newListener!==void 0&&(_.emit("newListener",a,$.listener?$.listener:$),et=_._events),tt=et[a]),tt===void 0)tt=et[a]=$,++_._eventsCount;else if(typeof tt=="function"?tt=et[a]=j?[$,tt]:[tt,$]:j?tt.unshift($):tt.push($),_e=_getMaxListeners(_),_e>0&&tt.length>_e&&!tt.warned){tt.warned=!0;var rt=new Error("Possible EventEmitter memory leak detected. "+tt.length+" "+String(a)+" listeners added. Use emitter.setMaxListeners() to increase limit");rt.name="MaxListenersExceededWarning",rt.emitter=_,rt.type=a,rt.count=tt.length,ProcessEmitWarning(rt)}return _}EventEmitter$3.prototype.addListener=function _(a,$){return _addListener(this,a,$,!1)};EventEmitter$3.prototype.on=EventEmitter$3.prototype.addListener;EventEmitter$3.prototype.prependListener=function _(a,$){return _addListener(this,a,$,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(_,a,$){var j={fired:!1,wrapFn:void 0,target:_,type:a,listener:$},_e=onceWrapper.bind(j);return _e.listener=$,j.wrapFn=_e,_e}EventEmitter$3.prototype.once=function _(a,$){return checkListener($),this.on(a,_onceWrap(this,a,$)),this};EventEmitter$3.prototype.prependOnceListener=function _(a,$){return checkListener($),this.prependListener(a,_onceWrap(this,a,$)),this};EventEmitter$3.prototype.removeListener=function _(a,$){var j,_e,et,tt,rt;if(checkListener($),_e=this._events,_e===void 0)return this;if(j=_e[a],j===void 0)return this;if(j===$||j.listener===$)--this._eventsCount===0?this._events=Object.create(null):(delete _e[a],_e.removeListener&&this.emit("removeListener",a,j.listener||$));else if(typeof j!="function"){for(et=-1,tt=j.length-1;tt>=0;tt--)if(j[tt]===$||j[tt].listener===$){rt=j[tt].listener,et=tt;break}if(et<0)return this;et===0?j.shift():spliceOne(j,et),j.length===1&&(_e[a]=j[0]),_e.removeListener!==void 0&&this.emit("removeListener",a,rt||$)}return this};EventEmitter$3.prototype.off=EventEmitter$3.prototype.removeListener;EventEmitter$3.prototype.removeAllListeners=function _(a){var $,j,_e;if(j=this._events,j===void 0)return this;if(j.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):j[a]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete j[a]),this;if(arguments.length===0){var et=Object.keys(j),tt;for(_e=0;_e<et.length;++_e)tt=et[_e],tt!=="removeListener"&&this.removeAllListeners(tt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if($=j[a],typeof $=="function")this.removeListener(a,$);else if($!==void 0)for(_e=$.length-1;_e>=0;_e--)this.removeListener(a,$[_e]);return this};function _listeners(_,a,$){var j=_._events;if(j===void 0)return[];var _e=j[a];return _e===void 0?[]:typeof _e=="function"?$?[_e.listener||_e]:[_e]:$?unwrapListeners(_e):arrayClone(_e,_e.length)}EventEmitter$3.prototype.listeners=function _(a){return _listeners(this,a,!0)};EventEmitter$3.prototype.rawListeners=function _(a){return _listeners(this,a,!1)};EventEmitter$3.listenerCount=function(_,a){return typeof _.listenerCount=="function"?_.listenerCount(a):listenerCount.call(_,a)};EventEmitter$3.prototype.listenerCount=listenerCount;function listenerCount(_){var a=this._events;if(a!==void 0){var $=a[_];if(typeof $=="function")return 1;if($!==void 0)return $.length}return 0}EventEmitter$3.prototype.eventNames=function _(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(_,a){for(var $=new Array(a),j=0;j<a;++j)$[j]=_[j];return $}function spliceOne(_,a){for(;a+1<_.length;a++)_[a]=_[a+1];_.pop()}function unwrapListeners(_){for(var a=new Array(_.length),$=0;$<a.length;++$)a[$]=_[$].listener||_[$];return a}function once(_,a){return new Promise(function($,j){function _e(tt){_.removeListener(a,et),j(tt)}function et(){typeof _.removeListener=="function"&&_.removeListener("error",_e),$([].slice.call(arguments))}eventTargetAgnosticAddListener(_,a,et,{once:!0}),a!=="error"&&addErrorHandlerIfEventEmitter(_,_e,{once:!0})})}function addErrorHandlerIfEventEmitter(_,a,$){typeof _.on=="function"&&eventTargetAgnosticAddListener(_,"error",a,$)}function eventTargetAgnosticAddListener(_,a,$,j){if(typeof _.on=="function")j.once?_.once(a,$):_.on(a,$);else if(typeof _.addEventListener=="function")_.addEventListener(a,function _e(et){j.once&&_.removeEventListener(a,_e),$(et)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof _)}var catering={},nextTickBrowser$1=typeof queueMicrotask=="function"?queueMicrotask:_=>Promise.resolve().then(_),nextTick$1=nextTickBrowser$1;catering.fromCallback=function(_,a){if(_===void 0){var $=new Promise(function(j,_e){_=function(et,tt){et?_e(et):j(tt)}});_[a!==void 0?a:"promise"]=$}else if(typeof _!="function")throw new TypeError("Callback must be a function");return _};catering.fromPromise=function(_,a){if(a===void 0)return _;_.then(function($){nextTick$1(()=>a(null,$))}).catch(function($){nextTick$1(()=>a($))})};var abstractIterator={},common={};common.getCallback=function(_,a){return typeof _=="function"?_:a};common.getOptions=function(_,a){return typeof _=="object"&&_!==null?_:a!==void 0?a:{}};const{fromCallback:fromCallback$3}=catering,ModuleError$6=moduleError,{getOptions:getOptions$2,getCallback:getCallback$2}=common,kPromise$3=Symbol("promise"),kCallback$1=Symbol("callback"),kWorking=Symbol("working"),kHandleOne$1=Symbol("handleOne"),kHandleMany$1=Symbol("handleMany"),kAutoClose=Symbol("autoClose"),kFinishWork=Symbol("finishWork"),kReturnMany=Symbol("returnMany"),kClosing=Symbol("closing"),kHandleClose=Symbol("handleClose"),kClosed=Symbol("closed"),kCloseCallbacks$1=Symbol("closeCallbacks"),kKeyEncoding$1=Symbol("keyEncoding"),kValueEncoding$1=Symbol("valueEncoding"),kAbortOnClose=Symbol("abortOnClose"),kLegacy=Symbol("legacy"),kKeys=Symbol("keys"),kValues=Symbol("values"),kLimit=Symbol("limit"),kCount=Symbol("count"),emptyOptions$1=Object.freeze({}),noop$4=()=>{};let warnedEnd=!1;class CommonIterator{constructor(a,$,j){if(typeof a!="object"||a===null){const _e=a===null?"null":typeof a;throw new TypeError(`The first argument must be an abstract-level database, received ${_e}`)}if(typeof $!="object"||$===null)throw new TypeError("The second argument must be an options object");this[kClosed]=!1,this[kCloseCallbacks$1]=[],this[kWorking]=!1,this[kClosing]=!1,this[kAutoClose]=!1,this[kCallback$1]=null,this[kHandleOne$1]=this[kHandleOne$1].bind(this),this[kHandleMany$1]=this[kHandleMany$1].bind(this),this[kHandleClose]=this[kHandleClose].bind(this),this[kKeyEncoding$1]=$[kKeyEncoding$1],this[kValueEncoding$1]=$[kValueEncoding$1],this[kLegacy]=j,this[kLimit]=Number.isInteger($.limit)&&$.limit>=0?$.limit:1/0,this[kCount]=0,this[kAbortOnClose]=!!$.abortOnClose,this.db=a,this.db.attachResource(this),this.nextTick=a.nextTick}get count(){return this[kCount]}get limit(){return this[kLimit]}next(a){let $;if(a===void 0)$=new Promise((j,_e)=>{a=(et,tt,rt)=>{et?_e(et):this[kLegacy]?tt===void 0&&rt===void 0?j():j([tt,rt]):j(tt)}});else if(typeof a!="function")throw new TypeError("Callback must be a function");return this[kClosing]?this.nextTick(a,new ModuleError$6("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(a,new ModuleError$6("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[kWorking]=!0,this[kCallback$1]=a,this[kCount]>=this[kLimit]?this.nextTick(this[kHandleOne$1],null):this._next(this[kHandleOne$1])),$}_next(a){this.nextTick(a)}nextv(a,$,j){return j=getCallback$2($,j),j=fromCallback$3(j,kPromise$3),$=getOptions$2($,emptyOptions$1),Number.isInteger(a)?(this[kClosing]?this.nextTick(j,new ModuleError$6("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(j,new ModuleError$6("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(a<1&&(a=1),this[kLimit]<1/0&&(a=Math.min(a,this[kLimit]-this[kCount])),this[kWorking]=!0,this[kCallback$1]=j,a<=0?this.nextTick(this[kHandleMany$1],null,[]):this._nextv(a,$,this[kHandleMany$1])),j[kPromise$3]):(this.nextTick(j,new TypeError("The first argument 'size' must be an integer")),j[kPromise$3])}_nextv(a,$,j){const _e=[],et=(tt,rt,nt)=>{if(tt)return j(tt);if(this[kLegacy]?rt===void 0&&nt===void 0:rt===void 0)return j(null,_e);_e.push(this[kLegacy]?[rt,nt]:rt),_e.length===a?j(null,_e):this._next(et)};this._next(et)}all(a,$){return $=getCallback$2(a,$),$=fromCallback$3($,kPromise$3),a=getOptions$2(a,emptyOptions$1),this[kClosing]?this.nextTick($,new ModuleError$6("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick($,new ModuleError$6("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[kWorking]=!0,this[kCallback$1]=$,this[kAutoClose]=!0,this[kCount]>=this[kLimit]?this.nextTick(this[kHandleMany$1],null,[]):this._all(a,this[kHandleMany$1])),$[kPromise$3]}_all(a,$){let j=this[kCount];const _e=[],et=()=>{const rt=this[kLimit]<1/0?Math.min(1e3,this[kLimit]-j):1e3;rt<=0?this.nextTick($,null,_e):this._nextv(rt,emptyOptions$1,tt)},tt=(rt,nt)=>{rt?$(rt):nt.length===0?$(null,_e):(_e.push.apply(_e,nt),j+=nt.length,et())};et()}[kFinishWork](){const a=this[kCallback$1];return this[kAbortOnClose]&&a===null?noop$4:(this[kWorking]=!1,this[kCallback$1]=null,this[kClosing]&&this._close(this[kHandleClose]),a)}[kReturnMany](a,$,j){this[kAutoClose]?this.close(a.bind(null,$,j)):a($,j)}seek(a,$){if($=getOptions$2($,emptyOptions$1),!this[kClosing]){if(this[kWorking])throw new ModuleError$6("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const j=this.db.keyEncoding($.keyEncoding||this[kKeyEncoding$1]),_e=j.format;$.keyEncoding!==_e&&($={...$,keyEncoding:_e});const et=this.db.prefixKey(j.encode(a),_e);this._seek(et,$)}}}_seek(a,$){throw new ModuleError$6("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(a){return a=fromCallback$3(a,kPromise$3),this[kClosed]?this.nextTick(a):this[kClosing]?this[kCloseCallbacks$1].push(a):(this[kClosing]=!0,this[kCloseCallbacks$1].push(a),this[kWorking]?this[kAbortOnClose]&&this[kFinishWork]()(new ModuleError$6("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[kHandleClose])),a[kPromise$3]}_close(a){this.nextTick(a)}[kHandleClose](){this[kClosed]=!0,this.db.detachResource(this);const a=this[kCloseCallbacks$1];this[kCloseCallbacks$1]=[];for(const $ of a)$()}async*[Symbol.asyncIterator](){try{let a;for(;(a=await this.next())!==void 0;)yield a}finally{this[kClosed]||await this.close()}}}class AbstractIterator$3 extends CommonIterator{constructor(a,$){super(a,$,!0),this[kKeys]=$.keys!==!1,this[kValues]=$.values!==!1}[kHandleOne$1](a,$,j){const _e=this[kFinishWork]();if(a)return _e(a);try{$=this[kKeys]&&$!==void 0?this[kKeyEncoding$1].decode($):void 0,j=this[kValues]&&j!==void 0?this[kValueEncoding$1].decode(j):void 0}catch(et){return _e(new IteratorDecodeError("entry",et))}$===void 0&&j===void 0||this[kCount]++,_e(null,$,j)}[kHandleMany$1](a,$){const j=this[kFinishWork]();if(a)return this[kReturnMany](j,a);try{for(const _e of $){const et=_e[0],tt=_e[1];_e[0]=this[kKeys]&&et!==void 0?this[kKeyEncoding$1].decode(et):void 0,_e[1]=this[kValues]&&tt!==void 0?this[kValueEncoding$1].decode(tt):void 0}}catch(_e){return this[kReturnMany](j,new IteratorDecodeError("entries",_e))}this[kCount]+=$.length,this[kReturnMany](j,null,$)}end(a){return!warnedEnd&&typeof console<"u"&&(warnedEnd=!0,console.warn(new ModuleError$6("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(a)}}class AbstractKeyIterator$2 extends CommonIterator{constructor(a,$){super(a,$,!1)}[kHandleOne$1](a,$){const j=this[kFinishWork]();if(a)return j(a);try{$=$!==void 0?this[kKeyEncoding$1].decode($):void 0}catch(_e){return j(new IteratorDecodeError("key",_e))}$!==void 0&&this[kCount]++,j(null,$)}[kHandleMany$1](a,$){const j=this[kFinishWork]();if(a)return this[kReturnMany](j,a);try{for(let _e=0;_e<$.length;_e++){const et=$[_e];$[_e]=et!==void 0?this[kKeyEncoding$1].decode(et):void 0}}catch(_e){return this[kReturnMany](j,new IteratorDecodeError("keys",_e))}this[kCount]+=$.length,this[kReturnMany](j,null,$)}}class AbstractValueIterator$2 extends CommonIterator{constructor(a,$){super(a,$,!1)}[kHandleOne$1](a,$){const j=this[kFinishWork]();if(a)return j(a);try{$=$!==void 0?this[kValueEncoding$1].decode($):void 0}catch(_e){return j(new IteratorDecodeError("value",_e))}$!==void 0&&this[kCount]++,j(null,$)}[kHandleMany$1](a,$){const j=this[kFinishWork]();if(a)return this[kReturnMany](j,a);try{for(let _e=0;_e<$.length;_e++){const et=$[_e];$[_e]=et!==void 0?this[kValueEncoding$1].decode(et):void 0}}catch(_e){return this[kReturnMany](j,new IteratorDecodeError("values",_e))}this[kCount]+=$.length,this[kReturnMany](j,null,$)}}class IteratorDecodeError extends ModuleError$6{constructor(a,$){super(`Iterator could not decode ${a}`,{code:"LEVEL_DECODE_ERROR",cause:$})}}for(const _ of["_ended property","_nexting property","_end method"])Object.defineProperty(AbstractIterator$3.prototype,_.split(" ")[0],{get(){throw new ModuleError$6(`The ${_} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new ModuleError$6(`The ${_} has been removed`,{code:"LEVEL_LEGACY"})}});AbstractIterator$3.keyEncoding=kKeyEncoding$1;AbstractIterator$3.valueEncoding=kValueEncoding$1;abstractIterator.AbstractIterator=AbstractIterator$3;abstractIterator.AbstractKeyIterator=AbstractKeyIterator$2;abstractIterator.AbstractValueIterator=AbstractValueIterator$2;var defaultKvIterator={};const{AbstractKeyIterator:AbstractKeyIterator$1,AbstractValueIterator:AbstractValueIterator$1}=abstractIterator,kIterator=Symbol("iterator"),kCallback=Symbol("callback"),kHandleOne=Symbol("handleOne"),kHandleMany=Symbol("handleMany");class DefaultKeyIterator$1 extends AbstractKeyIterator$1{constructor(a,$){super(a,$),this[kIterator]=a.iterator({...$,keys:!0,values:!1}),this[kHandleOne]=this[kHandleOne].bind(this),this[kHandleMany]=this[kHandleMany].bind(this)}}class DefaultValueIterator$1 extends AbstractValueIterator$1{constructor(a,$){super(a,$),this[kIterator]=a.iterator({...$,keys:!1,values:!0}),this[kHandleOne]=this[kHandleOne].bind(this),this[kHandleMany]=this[kHandleMany].bind(this)}}for(const _ of[DefaultKeyIterator$1,DefaultValueIterator$1]){const a=_===DefaultKeyIterator$1,$=a?j=>j[0]:j=>j[1];_.prototype._next=function(j){this[kCallback]=j,this[kIterator].next(this[kHandleOne])},_.prototype[kHandleOne]=function(j,_e,et){const tt=this[kCallback];j?tt(j):tt(null,a?_e:et)},_.prototype._nextv=function(j,_e,et){this[kCallback]=et,this[kIterator].nextv(j,_e,this[kHandleMany])},_.prototype._all=function(j,_e){this[kCallback]=_e,this[kIterator].all(j,this[kHandleMany])},_.prototype[kHandleMany]=function(j,_e){const et=this[kCallback];j?et(j):et(null,_e.map($))},_.prototype._seek=function(j,_e){this[kIterator].seek(j,_e)},_.prototype._close=function(j){this[kIterator].close(j)}}defaultKvIterator.DefaultKeyIterator=DefaultKeyIterator$1;defaultKvIterator.DefaultValueIterator=DefaultValueIterator$1;var deferredIterator={};const{AbstractIterator:AbstractIterator$2,AbstractKeyIterator,AbstractValueIterator}=abstractIterator,ModuleError$5=moduleError,kNut=Symbol("nut"),kUndefer$1=Symbol("undefer"),kFactory=Symbol("factory");class DeferredIterator$1 extends AbstractIterator$2{constructor(a,$){super(a,$),this[kNut]=null,this[kFactory]=()=>a.iterator($),this.db.defer(()=>this[kUndefer$1]())}}class DeferredKeyIterator$1 extends AbstractKeyIterator{constructor(a,$){super(a,$),this[kNut]=null,this[kFactory]=()=>a.keys($),this.db.defer(()=>this[kUndefer$1]())}}class DeferredValueIterator$1 extends AbstractValueIterator{constructor(a,$){super(a,$),this[kNut]=null,this[kFactory]=()=>a.values($),this.db.defer(()=>this[kUndefer$1]())}}for(const _ of[DeferredIterator$1,DeferredKeyIterator$1,DeferredValueIterator$1])_.prototype[kUndefer$1]=function(){this.db.status==="open"&&(this[kNut]=this[kFactory]())},_.prototype._next=function(a){this[kNut]!==null?this[kNut].next(a):this.db.status==="opening"?this.db.defer(()=>this._next(a)):this.nextTick(a,new ModuleError$5("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},_.prototype._nextv=function(a,$,j){this[kNut]!==null?this[kNut].nextv(a,$,j):this.db.status==="opening"?this.db.defer(()=>this._nextv(a,$,j)):this.nextTick(j,new ModuleError$5("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},_.prototype._all=function(a,$){this[kNut]!==null?this[kNut].all($):this.db.status==="opening"?this.db.defer(()=>this._all(a,$)):this.nextTick($,new ModuleError$5("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},_.prototype._seek=function(a,$){this[kNut]!==null?this[kNut]._seek(a,$):this.db.status==="opening"&&this.db.defer(()=>this._seek(a,$))},_.prototype._close=function(a){this[kNut]!==null?this[kNut].close(a):this.db.status==="opening"?this.db.defer(()=>this._close(a)):this.nextTick(a)};deferredIterator.DeferredIterator=DeferredIterator$1;deferredIterator.DeferredKeyIterator=DeferredKeyIterator$1;deferredIterator.DeferredValueIterator=DeferredValueIterator$1;var defaultChainedBatch={},abstractChainedBatch={};const{fromCallback:fromCallback$2}=catering,ModuleError$4=moduleError,{getCallback:getCallback$1,getOptions:getOptions$1}=common,kPromise$2=Symbol("promise"),kStatus$1=Symbol("status"),kOperations$1=Symbol("operations"),kFinishClose=Symbol("finishClose"),kCloseCallbacks=Symbol("closeCallbacks");class AbstractChainedBatch$1{constructor(a){if(typeof a!="object"||a===null){const $=a===null?"null":typeof a;throw new TypeError(`The first argument must be an abstract-level database, received ${$}`)}this[kOperations$1]=[],this[kCloseCallbacks]=[],this[kStatus$1]="open",this[kFinishClose]=this[kFinishClose].bind(this),this.db=a,this.db.attachResource(this),this.nextTick=a.nextTick}get length(){return this[kOperations$1].length}put(a,$,j){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const _e=this.db._checkKey(a)||this.db._checkValue($);if(_e)throw _e;const et=j&&j.sublevel!=null?j.sublevel:this.db,tt=j,rt=et.keyEncoding(j&&j.keyEncoding),nt=et.valueEncoding(j&&j.valueEncoding),it=rt.format;j={...j,keyEncoding:it,valueEncoding:nt.format},et!==this.db&&(j.sublevel=null);const st=et.prefixKey(rt.encode(a),it),ot=nt.encode($);return this._put(st,ot,j),this[kOperations$1].push({...tt,type:"put",key:a,value:$}),this}_put(a,$,j){}del(a,$){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const j=this.db._checkKey(a);if(j)throw j;const _e=$&&$.sublevel!=null?$.sublevel:this.db,et=$,tt=_e.keyEncoding($&&$.keyEncoding),rt=tt.format;return $={...$,keyEncoding:rt},_e!==this.db&&($.sublevel=null),this._del(_e.prefixKey(tt.encode(a),rt),$),this[kOperations$1].push({...et,type:"del",key:a}),this}_del(a,$){}clear(){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[kOperations$1]=[],this}_clear(){}write(a,$){return $=getCallback$1(a,$),$=fromCallback$2($,kPromise$2),a=getOptions$1(a),this[kStatus$1]!=="open"?this.nextTick($,new ModuleError$4("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close($):(this[kStatus$1]="writing",this._write(a,j=>{this[kStatus$1]="closing",this[kCloseCallbacks].push(()=>$(j)),j||this.db.emit("batch",this[kOperations$1]),this._close(this[kFinishClose])})),$[kPromise$2]}_write(a,$){}close(a){return a=fromCallback$2(a,kPromise$2),this[kStatus$1]==="closing"?this[kCloseCallbacks].push(a):this[kStatus$1]==="closed"?this.nextTick(a):(this[kCloseCallbacks].push(a),this[kStatus$1]!=="writing"&&(this[kStatus$1]="closing",this._close(this[kFinishClose]))),a[kPromise$2]}_close(a){this.nextTick(a)}[kFinishClose](){this[kStatus$1]="closed",this.db.detachResource(this);const a=this[kCloseCallbacks];this[kCloseCallbacks]=[];for(const $ of a)$()}}abstractChainedBatch.AbstractChainedBatch=AbstractChainedBatch$1;const{AbstractChainedBatch}=abstractChainedBatch,ModuleError$3=moduleError,kEncoded=Symbol("encoded");class DefaultChainedBatch$1 extends AbstractChainedBatch{constructor(a){super(a),this[kEncoded]=[]}_put(a,$,j){this[kEncoded].push({...j,type:"put",key:a,value:$})}_del(a,$){this[kEncoded].push({...$,type:"del",key:a})}_clear(){this[kEncoded]=[]}_write(a,$){this.db.status==="opening"?this.db.defer(()=>this._write(a,$)):this.db.status==="open"?this[kEncoded].length===0?this.nextTick($):this.db._batch(this[kEncoded],a,$):this.nextTick($,new ModuleError$3("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}}defaultChainedBatch.DefaultChainedBatch=DefaultChainedBatch$1;const ModuleError$2=moduleError,hasOwnProperty=Object.prototype.hasOwnProperty,rangeOptions$1=new Set(["lt","lte","gt","gte"]);var rangeOptions_1=function(_,a){const $={};for(const j in _)if(!!hasOwnProperty.call(_,j)&&!(j==="keyEncoding"||j==="valueEncoding")){if(j==="start"||j==="end")throw new ModuleError$2(`The legacy range option '${j}' has been removed`,{code:"LEVEL_LEGACY"});if(j==="encoding")throw new ModuleError$2("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});rangeOptions$1.has(j)?$[j]=a.encode(_[j]):$[j]=_[j]}return $.reverse=!!$.reverse,$.limit=Number.isInteger($.limit)&&$.limit>=0?$.limit:-1,$};/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let promise;var queueMicrotask_1=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:{}):_=>(promise||(promise=Promise.resolve())).then(_).catch(a=>setTimeout(()=>{throw a},0)),nextTickBrowser,hasRequiredNextTickBrowser;function requireNextTickBrowser(){if(hasRequiredNextTickBrowser)return nextTickBrowser;hasRequiredNextTickBrowser=1;const _=queueMicrotask_1;return nextTickBrowser=function(a,...$){$.length===0?_(a):_(()=>a(...$))},nextTickBrowser}var abstractSublevelIterator={},hasRequiredAbstractSublevelIterator;function requireAbstractSublevelIterator(){if(hasRequiredAbstractSublevelIterator)return abstractSublevelIterator;hasRequiredAbstractSublevelIterator=1;const{AbstractIterator:_,AbstractKeyIterator:a,AbstractValueIterator:$}=abstractIterator,j=Symbol("unfix"),_e=Symbol("iterator"),et=Symbol("handleOne"),tt=Symbol("handleMany"),rt=Symbol("callback");class nt extends _{constructor(at,lt,ct,ut){super(at,lt),this[_e]=ct,this[j]=ut,this[et]=this[et].bind(this),this[tt]=this[tt].bind(this),this[rt]=null}[et](at,lt,ct){const ut=this[rt];if(at)return ut(at);lt!==void 0&&(lt=this[j](lt)),ut(at,lt,ct)}[tt](at,lt){const ct=this[rt];if(at)return ct(at);for(const ut of lt){const dt=ut[0];dt!==void 0&&(ut[0]=this[j](dt))}ct(at,lt)}}class it extends a{constructor(at,lt,ct,ut){super(at,lt),this[_e]=ct,this[j]=ut,this[et]=this[et].bind(this),this[tt]=this[tt].bind(this),this[rt]=null}[et](at,lt){const ct=this[rt];if(at)return ct(at);lt!==void 0&&(lt=this[j](lt)),ct(at,lt)}[tt](at,lt){const ct=this[rt];if(at)return ct(at);for(let ut=0;ut<lt.length;ut++){const dt=lt[ut];dt!==void 0&&(lt[ut]=this[j](dt))}ct(at,lt)}}class st extends ${constructor(at,lt,ct){super(at,lt),this[_e]=ct}}for(const ot of[nt,it])ot.prototype._next=function(at){this[rt]=at,this[_e].next(this[et])},ot.prototype._nextv=function(at,lt,ct){this[rt]=ct,this[_e].nextv(at,lt,this[tt])},ot.prototype._all=function(at,lt){this[rt]=lt,this[_e].all(at,this[tt])};for(const ot of[st])ot.prototype._next=function(at){this[_e].next(at)},ot.prototype._nextv=function(at,lt,ct){this[_e].nextv(at,lt,ct)},ot.prototype._all=function(at,lt){this[_e].all(at,lt)};for(const ot of[nt,it,st])ot.prototype._seek=function(at,lt){this[_e].seek(at,lt)},ot.prototype._close=function(at){this[_e].close(at)};return abstractSublevelIterator.AbstractSublevelIterator=nt,abstractSublevelIterator.AbstractSublevelKeyIterator=it,abstractSublevelIterator.AbstractSublevelValueIterator=st,abstractSublevelIterator}var abstractSublevel,hasRequiredAbstractSublevel;function requireAbstractSublevel(){if(hasRequiredAbstractSublevel)return abstractSublevel;hasRequiredAbstractSublevel=1;const _=moduleError,{Buffer:a}=buffer||{},{AbstractSublevelIterator:$,AbstractSublevelKeyIterator:j,AbstractSublevelValueIterator:_e}=requireAbstractSublevelIterator(),et=Symbol("prefix"),tt=Symbol("upperBound"),rt=Symbol("prefixRange"),nt=Symbol("parent"),it=Symbol("unfix"),st=new TextEncoder,ot={separator:"!"};abstractSublevel=function({AbstractLevel:ft}){class pt extends ft{static defaults(mt){if(typeof mt=="string")throw new _("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(mt&&mt.open)throw new _("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return mt==null?ot:mt.separator?mt:{...mt,separator:"!"}}constructor(mt,_t,vt){const{separator:ht,manifest:St,...It}=pt.defaults(vt);_t=dt(_t,ht);const Lt=ht.charCodeAt(0)+1,Mt=mt[nt]||mt;if(!st.encode(_t).every(gt=>gt>Lt&&gt<127))throw new _(`Prefix must use bytes > ${Lt} < ${127}`,{code:"LEVEL_INVALID_PREFIX"});super(at(Mt,St),It);const Kt=(mt.prefix||"")+ht+_t+ht,kt=Kt.slice(0,-1)+String.fromCharCode(Lt);this[nt]=Mt,this[et]=new ct(Kt),this[tt]=new ct(kt),this[it]=new ut,this.nextTick=Mt.nextTick}prefixKey(mt,_t){if(_t==="utf8")return this[et].utf8+mt;if(mt.byteLength===0)return this[et][_t];if(_t==="view"){const vt=this[et].view,ht=new Uint8Array(vt.byteLength+mt.byteLength);return ht.set(vt,0),ht.set(mt,vt.byteLength),ht}else{const vt=this[et].buffer;return a.concat([vt,mt],vt.byteLength+mt.byteLength)}}[rt](mt,_t){mt.gte!==void 0?mt.gte=this.prefixKey(mt.gte,_t):mt.gt!==void 0?mt.gt=this.prefixKey(mt.gt,_t):mt.gte=this[et][_t],mt.lte!==void 0?mt.lte=this.prefixKey(mt.lte,_t):mt.lt!==void 0?mt.lt=this.prefixKey(mt.lt,_t):mt.lte=this[tt][_t]}get prefix(){return this[et].utf8}get db(){return this[nt]}_open(mt,_t){this[nt].open({passive:!0},_t)}_put(mt,_t,vt,ht){this[nt].put(mt,_t,vt,ht)}_get(mt,_t,vt){this[nt].get(mt,_t,vt)}_getMany(mt,_t,vt){this[nt].getMany(mt,_t,vt)}_del(mt,_t,vt){this[nt].del(mt,_t,vt)}_batch(mt,_t,vt){this[nt].batch(mt,_t,vt)}_clear(mt,_t){this[rt](mt,mt.keyEncoding),this[nt].clear(mt,_t)}_iterator(mt){this[rt](mt,mt.keyEncoding);const _t=this[nt].iterator(mt),vt=this[it].get(this[et].utf8.length,mt.keyEncoding);return new $(this,mt,_t,vt)}_keys(mt){this[rt](mt,mt.keyEncoding);const _t=this[nt].keys(mt),vt=this[it].get(this[et].utf8.length,mt.keyEncoding);return new j(this,mt,_t,vt)}_values(mt){this[rt](mt,mt.keyEncoding);const _t=this[nt].values(mt);return new _e(this,mt,_t)}}return{AbstractSublevel:pt}};const at=function(ft,pt){return{...ft.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...pt,encodings:{utf8:lt(ft,"utf8"),buffer:lt(ft,"buffer"),view:lt(ft,"view")}}},lt=function(ft,pt){return ft.supports.encodings[pt]?ft.keyEncoding(pt).name===pt:!1};class ct{constructor(pt){this.utf8=pt,this.view=st.encode(pt),this.buffer=a?a.from(this.view.buffer,0,this.view.byteLength):{}}}class ut{constructor(){this.cache=new Map}get(pt,yt){let mt=this.cache.get(yt);return mt===void 0&&(yt==="view"?mt=function(_t,vt){return vt.subarray(_t)}.bind(null,pt):mt=function(_t,vt){return vt.slice(_t)}.bind(null,pt),this.cache.set(yt,mt)),mt}}const dt=function(ft,pt){let yt=0,mt=ft.length;for(;yt<mt&&ft[yt]===pt;)yt++;for(;mt>yt&&ft[mt-1]===pt;)mt--;return ft.slice(yt,mt)};return abstractSublevel}const{supports}=levelSupports,{Transcoder}=levelTranscoder,{EventEmitter:EventEmitter$2}=events.exports,{fromCallback:fromCallback$1}=catering,ModuleError$1=moduleError,{AbstractIterator:AbstractIterator$1}=abstractIterator,{DefaultKeyIterator,DefaultValueIterator}=defaultKvIterator,{DeferredIterator,DeferredKeyIterator,DeferredValueIterator}=deferredIterator,{DefaultChainedBatch}=defaultChainedBatch,{getCallback,getOptions}=common,rangeOptions=rangeOptions_1,kPromise$1=Symbol("promise"),kLanded=Symbol("landed"),kResources=Symbol("resources"),kCloseResources=Symbol("closeResources"),kOperations=Symbol("operations"),kUndefer=Symbol("undefer"),kDeferOpen=Symbol("deferOpen"),kOptions$1=Symbol("options"),kStatus=Symbol("status"),kDefaultOptions=Symbol("defaultOptions"),kTranscoder=Symbol("transcoder"),kKeyEncoding=Symbol("keyEncoding"),kValueEncoding=Symbol("valueEncoding"),noop$3=()=>{};class AbstractLevel$1 extends EventEmitter$2{constructor(a,$){if(super(),typeof a!="object"||a===null)throw new TypeError("The first argument 'manifest' must be an object");$=getOptions($);const{keyEncoding:j,valueEncoding:_e,passive:et,...tt}=$;this[kResources]=new Set,this[kOperations]=[],this[kDeferOpen]=!0,this[kOptions$1]=tt,this[kStatus]="opening",this.supports=supports(a,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:a.snapshots!==!1,permanence:a.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:a.encodings||{},events:Object.assign({},a.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[kTranscoder]=new Transcoder(formats(this)),this[kKeyEncoding]=this[kTranscoder].encoding(j||"utf8"),this[kValueEncoding]=this[kTranscoder].encoding(_e||"utf8");for(const rt of this[kTranscoder].encodings())this.supports.encodings[rt.commonName]||(this.supports.encodings[rt.commonName]=!0);this[kDefaultOptions]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[kKeyEncoding].commonName,valueEncoding:this[kValueEncoding].commonName}),key:Object.freeze({keyEncoding:this[kKeyEncoding].commonName})},this.nextTick(()=>{this[kDeferOpen]&&this.open({passive:!1},noop$3)})}get status(){return this[kStatus]}keyEncoding(a){return this[kTranscoder].encoding(a??this[kKeyEncoding])}valueEncoding(a){return this[kTranscoder].encoding(a??this[kValueEncoding])}open(a,$){$=getCallback(a,$),$=fromCallback$1($,kPromise$1),a={...this[kOptions$1],...getOptions(a)},a.createIfMissing=a.createIfMissing!==!1,a.errorIfExists=!!a.errorIfExists;const j=_e=>{this[kStatus]==="closing"||this[kStatus]==="opening"?this.once(kLanded,_e?()=>j(_e):j):this[kStatus]!=="open"?$(new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:_e})):$()};return a.passive?this[kStatus]==="opening"?this.once(kLanded,j):this.nextTick(j):this[kStatus]==="closed"||this[kDeferOpen]?(this[kDeferOpen]=!1,this[kStatus]="opening",this.emit("opening"),this._open(a,_e=>{if(_e){this[kStatus]="closed",this[kCloseResources](()=>{this.emit(kLanded),j(_e)}),this[kUndefer]();return}this[kStatus]="open",this[kUndefer](),this.emit(kLanded),this[kStatus]==="open"&&this.emit("open"),this[kStatus]==="open"&&this.emit("ready"),j()})):this[kStatus]==="open"?this.nextTick(j):this.once(kLanded,()=>this.open(a,$)),$[kPromise$1]}_open(a,$){this.nextTick($)}close(a){a=fromCallback$1(a,kPromise$1);const $=j=>{this[kStatus]==="opening"||this[kStatus]==="closing"?this.once(kLanded,j?$(j):$):this[kStatus]!=="closed"?a(new ModuleError$1("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:j})):a()};if(this[kStatus]==="open"){this[kStatus]="closing",this.emit("closing");const j=_e=>{this[kStatus]="open",this[kUndefer](),this.emit(kLanded),$(_e)};this[kCloseResources](()=>{this._close(_e=>{if(_e)return j(_e);this[kStatus]="closed",this[kUndefer](),this.emit(kLanded),this[kStatus]==="closed"&&this.emit("closed"),$()})})}else this[kStatus]==="closed"?this.nextTick($):this.once(kLanded,()=>this.close(a));return a[kPromise$1]}[kCloseResources](a){if(this[kResources].size===0)return this.nextTick(a);let $=this[kResources].size,j=!0;const _e=()=>{--$===0&&(j?this.nextTick(a):a())};for(const et of this[kResources])et.close(_e);j=!1,this[kResources].clear()}_close(a){this.nextTick(a)}get(a,$,j){if(j=getCallback($,j),j=fromCallback$1(j,kPromise$1),$=getOptions($,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.get(a,$,j)),j[kPromise$1];if(maybeError(this,j))return j[kPromise$1];const _e=this._checkKey(a);if(_e)return this.nextTick(j,_e),j[kPromise$1];const et=this.keyEncoding($.keyEncoding),tt=this.valueEncoding($.valueEncoding),rt=et.format,nt=tt.format;return($.keyEncoding!==rt||$.valueEncoding!==nt)&&($=Object.assign({},$,{keyEncoding:rt,valueEncoding:nt})),this._get(this.prefixKey(et.encode(a),rt),$,(it,st)=>{if(it)return(it.code==="LEVEL_NOT_FOUND"||it.notFound||/NotFound/i.test(it))&&(it.code||(it.code="LEVEL_NOT_FOUND"),it.notFound||(it.notFound=!0),it.status||(it.status=404)),j(it);try{st=tt.decode(st)}catch(ot){return j(new ModuleError$1("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:ot}))}j(null,st)}),j[kPromise$1]}_get(a,$,j){this.nextTick(j,new Error("NotFound"))}getMany(a,$,j){if(j=getCallback($,j),j=fromCallback$1(j,kPromise$1),$=getOptions($,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.getMany(a,$,j)),j[kPromise$1];if(maybeError(this,j))return j[kPromise$1];if(!Array.isArray(a))return this.nextTick(j,new TypeError("The first argument 'keys' must be an array")),j[kPromise$1];if(a.length===0)return this.nextTick(j,null,[]),j[kPromise$1];const _e=this.keyEncoding($.keyEncoding),et=this.valueEncoding($.valueEncoding),tt=_e.format,rt=et.format;($.keyEncoding!==tt||$.valueEncoding!==rt)&&($=Object.assign({},$,{keyEncoding:tt,valueEncoding:rt}));const nt=new Array(a.length);for(let it=0;it<a.length;it++){const st=a[it],ot=this._checkKey(st);if(ot)return this.nextTick(j,ot),j[kPromise$1];nt[it]=this.prefixKey(_e.encode(st),tt)}return this._getMany(nt,$,(it,st)=>{if(it)return j(it);try{for(let ot=0;ot<st.length;ot++)st[ot]!==void 0&&(st[ot]=et.decode(st[ot]))}catch(ot){return j(new ModuleError$1(`Could not decode one or more of ${st.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:ot}))}j(null,st)}),j[kPromise$1]}_getMany(a,$,j){this.nextTick(j,null,new Array(a.length).fill(void 0))}put(a,$,j,_e){if(_e=getCallback(j,_e),_e=fromCallback$1(_e,kPromise$1),j=getOptions(j,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.put(a,$,j,_e)),_e[kPromise$1];if(maybeError(this,_e))return _e[kPromise$1];const et=this._checkKey(a)||this._checkValue($);if(et)return this.nextTick(_e,et),_e[kPromise$1];const tt=this.keyEncoding(j.keyEncoding),rt=this.valueEncoding(j.valueEncoding),nt=tt.format,it=rt.format;(j.keyEncoding!==nt||j.valueEncoding!==it)&&(j=Object.assign({},j,{keyEncoding:nt,valueEncoding:it}));const st=this.prefixKey(tt.encode(a),nt),ot=rt.encode($);return this._put(st,ot,j,at=>{if(at)return _e(at);this.emit("put",a,$),_e()}),_e[kPromise$1]}_put(a,$,j,_e){this.nextTick(_e)}del(a,$,j){if(j=getCallback($,j),j=fromCallback$1(j,kPromise$1),$=getOptions($,this[kDefaultOptions].key),this[kStatus]==="opening")return this.defer(()=>this.del(a,$,j)),j[kPromise$1];if(maybeError(this,j))return j[kPromise$1];const _e=this._checkKey(a);if(_e)return this.nextTick(j,_e),j[kPromise$1];const et=this.keyEncoding($.keyEncoding),tt=et.format;return $.keyEncoding!==tt&&($=Object.assign({},$,{keyEncoding:tt})),this._del(this.prefixKey(et.encode(a),tt),$,rt=>{if(rt)return j(rt);this.emit("del",a),j()}),j[kPromise$1]}_del(a,$,j){this.nextTick(j)}batch(a,$,j){if(!arguments.length){if(this[kStatus]==="opening")return new DefaultChainedBatch(this);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof a=="function"?j=a:j=getCallback($,j),j=fromCallback$1(j,kPromise$1),$=getOptions($,this[kDefaultOptions].empty),this[kStatus]==="opening")return this.defer(()=>this.batch(a,$,j)),j[kPromise$1];if(maybeError(this,j))return j[kPromise$1];if(!Array.isArray(a))return this.nextTick(j,new TypeError("The first argument 'operations' must be an array")),j[kPromise$1];if(a.length===0)return this.nextTick(j),j[kPromise$1];const _e=new Array(a.length),{keyEncoding:et,valueEncoding:tt,...rt}=$;for(let nt=0;nt<a.length;nt++){if(typeof a[nt]!="object"||a[nt]===null)return this.nextTick(j,new TypeError("A batch operation must be an object")),j[kPromise$1];const it=Object.assign({},a[nt]);if(it.type!=="put"&&it.type!=="del")return this.nextTick(j,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),j[kPromise$1];const st=this._checkKey(it.key);if(st)return this.nextTick(j,st),j[kPromise$1];const ot=it.sublevel!=null?it.sublevel:this,at=ot.keyEncoding(it.keyEncoding||et),lt=at.format;if(it.key=ot.prefixKey(at.encode(it.key),lt),it.keyEncoding=lt,it.type==="put"){const ct=this._checkValue(it.value);if(ct)return this.nextTick(j,ct),j[kPromise$1];const ut=ot.valueEncoding(it.valueEncoding||tt);it.value=ut.encode(it.value),it.valueEncoding=ut.format}ot!==this&&(it.sublevel=null),_e[nt]=it}return this._batch(_e,rt,nt=>{if(nt)return j(nt);this.emit("batch",a),j()}),j[kPromise$1]}_batch(a,$,j){this.nextTick(j)}sublevel(a,$){return this._sublevel(a,AbstractSublevel.defaults($))}_sublevel(a,$){return new AbstractSublevel(this,a,$)}prefixKey(a,$){return a}clear(a,$){if($=getCallback(a,$),$=fromCallback$1($,kPromise$1),a=getOptions(a,this[kDefaultOptions].empty),this[kStatus]==="opening")return this.defer(()=>this.clear(a,$)),$[kPromise$1];if(maybeError(this,$))return $[kPromise$1];const j=a,_e=this.keyEncoding(a.keyEncoding);return a=rangeOptions(a,_e),a.keyEncoding=_e.format,a.limit===0?this.nextTick($):this._clear(a,et=>{if(et)return $(et);this.emit("clear",j),$()}),$[kPromise$1]}_clear(a,$){this.nextTick($)}iterator(a){const $=this.keyEncoding(a&&a.keyEncoding),j=this.valueEncoding(a&&a.valueEncoding);if(a=rangeOptions(a,$),a.keys=a.keys!==!1,a.values=a.values!==!1,a[AbstractIterator$1.keyEncoding]=$,a[AbstractIterator$1.valueEncoding]=j,a.keyEncoding=$.format,a.valueEncoding=j.format,this[kStatus]==="opening")return new DeferredIterator(this,a);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(a)}_iterator(a){return new AbstractIterator$1(this,a)}keys(a){const $=this.keyEncoding(a&&a.keyEncoding),j=this.valueEncoding(a&&a.valueEncoding);if(a=rangeOptions(a,$),a[AbstractIterator$1.keyEncoding]=$,a[AbstractIterator$1.valueEncoding]=j,a.keyEncoding=$.format,a.valueEncoding=j.format,this[kStatus]==="opening")return new DeferredKeyIterator(this,a);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(a)}_keys(a){return new DefaultKeyIterator(this,a)}values(a){const $=this.keyEncoding(a&&a.keyEncoding),j=this.valueEncoding(a&&a.valueEncoding);if(a=rangeOptions(a,$),a[AbstractIterator$1.keyEncoding]=$,a[AbstractIterator$1.valueEncoding]=j,a.keyEncoding=$.format,a.valueEncoding=j.format,this[kStatus]==="opening")return new DeferredValueIterator(this,a);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(a)}_values(a){return new DefaultValueIterator(this,a)}defer(a){if(typeof a!="function")throw new TypeError("The first argument must be a function");this[kOperations].push(a)}[kUndefer](){if(this[kOperations].length===0)return;const a=this[kOperations];this[kOperations]=[];for(const $ of a)$()}attachResource(a){if(typeof a!="object"||a===null||typeof a.close!="function")throw new TypeError("The first argument must be a resource object");this[kResources].add(a)}detachResource(a){this[kResources].delete(a)}_chainedBatch(){return new DefaultChainedBatch(this)}_checkKey(a){if(a==null)return new ModuleError$1("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(a){if(a==null)return new ModuleError$1("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}}AbstractLevel$1.prototype.nextTick=requireNextTickBrowser();const{AbstractSublevel}=requireAbstractSublevel()({AbstractLevel:AbstractLevel$1});abstractLevel.AbstractLevel=AbstractLevel$1;abstractLevel.AbstractSublevel=AbstractSublevel;const maybeError=function(_,a){return _[kStatus]!=="open"?(_.nextTick(a,new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},formats=function(_){return Object.keys(_.supports.encodings).filter(a=>!!_.supports.encodings[a])};abstractLevel$1.AbstractLevel=abstractLevel.AbstractLevel;abstractLevel$1.AbstractSublevel=abstractLevel.AbstractSublevel;abstractLevel$1.AbstractIterator=abstractIterator.AbstractIterator;abstractLevel$1.AbstractKeyIterator=abstractIterator.AbstractKeyIterator;abstractLevel$1.AbstractValueIterator=abstractIterator.AbstractValueIterator;abstractLevel$1.AbstractChainedBatch=abstractChainedBatch.AbstractChainedBatch;/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var runParallelLimit_1=runParallelLimit;const queueMicrotask$1=queueMicrotask_1;function runParallelLimit(_,a,$){if(typeof a!="number")throw new Error("second argument must be a Number");let j,_e,et,tt,rt,nt=!0,it;Array.isArray(_)?(j=[],et=_e=_.length):(tt=Object.keys(_),j={},et=_e=tt.length);function st(at){function lt(){$&&$(at,j),$=null}nt?queueMicrotask$1(lt):lt()}function ot(at,lt,ct){if(j[at]=ct,lt&&(rt=!0),--et===0||lt)st(lt);else if(!rt&&it<_e){let ut;tt?(ut=tt[it],it+=1,_[ut](function(dt,ft){ot(ut,dt,ft)})):(ut=it,it+=1,_[ut](function(dt,ft){ot(ut,dt,ft)}))}}it=a,et?tt?tt.some(function(at,lt){return _[at](function(ct,ut){ot(at,ct,ut)}),lt===a-1}):_.some(function(at,lt){return at(function(ct,ut){ot(lt,ct,ut)}),lt===a-1}):st(null),nt=!1}var iterator={},keyRange=function _(a){const $=a.gte!==void 0?a.gte:a.gt!==void 0?a.gt:void 0,j=a.lte!==void 0?a.lte:a.lt!==void 0?a.lt:void 0,_e=a.gte===void 0,et=a.lte===void 0;return $!==void 0&&j!==void 0?IDBKeyRange.bound($,j,_e,et):$!==void 0?IDBKeyRange.lowerBound($,_e):j!==void 0?IDBKeyRange.upperBound(j,et):null};const textEncoder=new TextEncoder;var deserialize$2=function(_){return _ instanceof Uint8Array?_:_ instanceof ArrayBuffer?new Uint8Array(_):textEncoder.encode(_)};const{AbstractIterator}=abstractLevel$1,createKeyRange$1=keyRange,deserialize$1=deserialize$2,kCache=Symbol("cache"),kFinished=Symbol("finished"),kOptions=Symbol("options"),kCurrentOptions=Symbol("currentOptions"),kPosition=Symbol("position"),kLocation$1=Symbol("location"),kFirst=Symbol("first"),emptyOptions={};class Iterator$1 extends AbstractIterator{constructor(a,$,j){super(a,j),this[kCache]=[],this[kFinished]=this.limit===0,this[kOptions]=j,this[kCurrentOptions]={...j},this[kPosition]=void 0,this[kLocation$1]=$,this[kFirst]=!0}_nextv(a,$,j){if(this[kFirst]=!1,this[kFinished])return this.nextTick(j,null,[]);if(this[kCache].length>0)return a=Math.min(a,this[kCache].length),this.nextTick(j,null,this[kCache].splice(0,a));this[kPosition]!==void 0&&(this[kOptions].reverse?(this[kCurrentOptions].lt=this[kPosition],this[kCurrentOptions].lte=void 0):(this[kCurrentOptions].gt=this[kPosition],this[kCurrentOptions].gte=void 0));let _e;try{_e=createKeyRange$1(this[kCurrentOptions])}catch{return this[kFinished]=!0,this.nextTick(j,null,[])}const et=this.db.db.transaction([this[kLocation$1]],"readonly"),tt=et.objectStore(this[kLocation$1]),rt=[];if(this[kOptions].reverse){const nt=!this[kOptions].values&&tt.openKeyCursor?"openKeyCursor":"openCursor";tt[nt](_e,"prev").onsuccess=it=>{const st=it.target.result;if(st){const{key:ot,value:at}=st;this[kPosition]=ot,rt.push([this[kOptions].keys&&ot!==void 0?deserialize$1(ot):void 0,this[kOptions].values&&at!==void 0?deserialize$1(at):void 0]),rt.length<a?st.continue():maybeCommit(et)}else this[kFinished]=!0}}else{let nt,it;const st=()=>{if(nt===void 0||it===void 0)return;const ot=Math.max(nt.length,it.length);ot===0||a===1/0?this[kFinished]=!0:this[kPosition]=nt[ot-1],rt.length=ot;for(let at=0;at<ot;at++){const lt=nt[at],ct=it[at];rt[at]=[this[kOptions].keys&&lt!==void 0?deserialize$1(lt):void 0,this[kOptions].values&&ct!==void 0?deserialize$1(ct):void 0]}maybeCommit(et)};this[kOptions].keys||a<1/0?tt.getAllKeys(_e,a<1/0?a:void 0).onsuccess=ot=>{nt=ot.target.result,st()}:(nt=[],this.nextTick(st)),this[kOptions].values?tt.getAll(_e,a<1/0?a:void 0).onsuccess=ot=>{it=ot.target.result,st()}:(it=[],this.nextTick(st))}et.onabort=()=>{j(et.error||new Error("aborted by user")),j=null},et.oncomplete=()=>{j(null,rt),j=null}}_next(a){if(this[kCache].length>0){const[$,j]=this[kCache].shift();this.nextTick(a,null,$,j)}else if(this[kFinished])this.nextTick(a);else{let $=Math.min(100,this.limit-this.count);this[kFirst]&&(this[kFirst]=!1,$=1),this._nextv($,emptyOptions,(j,_e)=>{if(j)return a(j);this[kCache]=_e,this._next(a)})}}_all(a,$){this[kFirst]=!1;const j=this[kCache].splice(0,this[kCache].length),_e=this.limit-this.count-j.length;if(_e<=0)return this.nextTick($,null,j);this._nextv(_e,emptyOptions,(et,tt)=>{if(et)return $(et);j.length>0&&(tt=j.concat(tt)),$(null,tt)})}_seek(a,$){this[kFirst]=!0,this[kCache]=[],this[kFinished]=!1,this[kPosition]=void 0,this[kCurrentOptions]={...this[kOptions]};let j;try{j=createKeyRange$1(this[kOptions])}catch{this[kFinished]=!0;return}j!==null&&!j.includes(a)?this[kFinished]=!0:this[kOptions].reverse?this[kCurrentOptions].lte=a:this[kCurrentOptions].gte=a}}iterator.Iterator=Iterator$1;function maybeCommit(_){typeof _.commit=="function"&&_.commit()}var clear$1=function _(a,$,j,_e,et){if(_e.limit===0)return a.nextTick(et);const tt=a.db.transaction([$],"readwrite"),rt=tt.objectStore($);let nt=0;tt.oncomplete=function(){et()},tt.onabort=function(){et(tt.error||new Error("aborted by user"))};const it=rt.openKeyCursor?"openKeyCursor":"openCursor",st=_e.reverse?"prev":"next";rt[it](j,st).onsuccess=function(ot){const at=ot.target.result;at&&(rt.delete(at.key).onsuccess=function(){(_e.limit<=0||++nt<_e.limit)&&at.continue()})}};const{AbstractLevel}=abstractLevel$1,ModuleError=moduleError,parallel$1=runParallelLimit_1,{fromCallback}=catering,{Iterator}=iterator,deserialize=deserialize$2,clear=clear$1,createKeyRange=keyRange,DEFAULT_PREFIX="level-js-",kIDB=Symbol("idb"),kNamePrefix=Symbol("namePrefix"),kLocation=Symbol("location"),kVersion=Symbol("version"),kStore=Symbol("store"),kOnComplete=Symbol("onComplete"),kPromise=Symbol("promise");class BrowserLevel extends AbstractLevel{constructor(a,$,j){if(typeof $=="function"||typeof j=="function")throw new ModuleError("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:_e,version:et,...tt}=$||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},tt),typeof a!="string")throw new Error("constructor requires a location string argument");this[kLocation]=a,this[kNamePrefix]=_e??DEFAULT_PREFIX,this[kVersion]=parseInt(et||1,10),this[kIDB]=null}get location(){return this[kLocation]}get namePrefix(){return this[kNamePrefix]}get version(){return this[kVersion]}get db(){return this[kIDB]}get type(){return"browser-level"}_open(a,$){const j=indexedDB.open(this[kNamePrefix]+this[kLocation],this[kVersion]);j.onerror=function(){$(j.error||new Error("unknown error"))},j.onsuccess=()=>{this[kIDB]=j.result,$()},j.onupgradeneeded=_e=>{const et=_e.target.result;et.objectStoreNames.contains(this[kLocation])||et.createObjectStore(this[kLocation])}}[kStore](a){return this[kIDB].transaction([this[kLocation]],a).objectStore(this[kLocation])}[kOnComplete](a,$){const j=a.transaction;j.onabort=function(){$(j.error||new Error("aborted by user"))},j.oncomplete=function(){$(null,a.result)}}_get(a,$,j){const _e=this[kStore]("readonly");let et;try{et=_e.get(a)}catch(tt){return this.nextTick(j,tt)}this[kOnComplete](et,function(tt,rt){if(tt)return j(tt);if(rt===void 0)return j(new ModuleError("Entry not found",{code:"LEVEL_NOT_FOUND"}));j(null,deserialize(rt))})}_getMany(a,$,j){const _e=this[kStore]("readonly"),et=a.map(tt=>rt=>{let nt;try{nt=_e.get(tt)}catch(it){return rt(it)}nt.onsuccess=()=>{const it=nt.result;rt(null,it===void 0?it:deserialize(it))},nt.onerror=it=>{it.stopPropagation(),rt(nt.error)}});parallel$1(et,16,j)}_del(a,$,j){const _e=this[kStore]("readwrite");let et;try{et=_e.delete(a)}catch(tt){return this.nextTick(j,tt)}this[kOnComplete](et,j)}_put(a,$,j,_e){const et=this[kStore]("readwrite");let tt;try{tt=et.put($,a)}catch(rt){return this.nextTick(_e,rt)}this[kOnComplete](tt,_e)}_iterator(a){return new Iterator(this,this[kLocation],a)}_batch(a,$,j){const _e=this[kStore]("readwrite"),et=_e.transaction;let tt=0,rt;et.onabort=function(){j(rt||et.error||new Error("aborted by user"))},et.oncomplete=function(){j()};function nt(){const it=a[tt++],st=it.key;let ot;try{ot=it.type==="del"?_e.delete(st):_e.put(it.value,st)}catch(at){rt=at,et.abort();return}tt<a.length?ot.onsuccess=nt:typeof et.commit=="function"&&et.commit()}nt()}_clear(a,$){let j,_e;try{j=createKeyRange(a)}catch{return this.nextTick($)}if(a.limit>=0)return clear(this,this[kLocation],j,a,$);try{const et=this[kStore]("readwrite");_e=j?et.delete(j):et.clear()}catch(et){return this.nextTick($,et)}this[kOnComplete](_e,$)}_close(a){this[kIDB].close(),this.nextTick(a)}}BrowserLevel.destroy=function(_,a,$){typeof a=="function"&&($=a,a=DEFAULT_PREFIX),$=fromCallback($,kPromise);const j=indexedDB.deleteDatabase(a+_);return j.onsuccess=function(){$()},j.onerror=function(_e){$(_e)},$[kPromise]};browserLevel.BrowserLevel=BrowserLevel;var Level=browserLevel.BrowserLevel;class LevelDatastore extends BaseDatastore{constructor(a,$={}){super(),this.db=typeof a=="string"?new Level(a,{...$,keyEncoding:"utf8",valueEncoding:"view"}):a,this.opts={createIfMissing:!0,compression:!1,...$}}async open(){try{await this.db.open(this.opts)}catch(a){throw dbOpenFailedError(a)}}async put(a,$){try{await this.db.put(a.toString(),$)}catch(j){throw dbWriteFailedError(j)}}async get(a){let $;try{$=await this.db.get(a.toString())}catch(j){throw j.notFound?notFoundError$1(j):dbWriteFailedError(j)}return $}async has(a){try{await this.db.get(a.toString())}catch($){if($.notFound)return!1;throw $}return!0}async delete(a){try{await this.db.del(a.toString())}catch($){throw dbDeleteFailedError($)}}close(){return this.db&&this.db.close()}batch(){const a=[];return{put:($,j)=>{a.push({type:"put",key:$.toString(),value:j})},delete:$=>{a.push({type:"del",key:$.toString()})},commit:()=>this.db.batch(a)}}query(a){let $=this._query({values:!0,prefix:a.prefix});Array.isArray(a.filters)&&($=a.filters.reduce((et,tt)=>itFilter(et,tt),$)),Array.isArray(a.orders)&&($=a.orders.reduce((et,tt)=>itSort(et,tt),$));const{offset:j,limit:_e}=a;if(j){let et=0;$=itFilter($,()=>et++>=j)}return _e&&($=itTake($,_e)),$}queryKeys(a){let $=itMap$2(this._query({values:!1,prefix:a.prefix}),({key:et})=>et);Array.isArray(a.filters)&&($=a.filters.reduce((et,tt)=>itFilter(et,tt),$)),Array.isArray(a.orders)&&($=a.orders.reduce((et,tt)=>itSort(et,tt),$));const{offset:j,limit:_e}=a;if(j){let et=0;$=itFilter($,()=>et++>=j)}return _e&&($=itTake($,_e)),$}_query(a){const $={keys:!0,keyEncoding:"buffer",values:a.values};if(a.prefix!=null){const _e=a.prefix.toString();$.gte=_e,$.lt=_e+"\xFF"}const j=this.db.iterator($);if(j[Symbol.asyncIterator])return levelIteratorToIterator(j);if(j.next!=null&&j.end!=null)return oldLevelIteratorToIterator(j);throw new Error("Level returned incompatible iterator")}}async function*levelIteratorToIterator(_){for await(const[a,$]of _)yield{key:new Key(a,!1),value:$};await _.close()}function oldLevelIteratorToIterator(_){return{[Symbol.asyncIterator](){return{next:()=>new Promise((a,$)=>{_.next((j,_e,et)=>{if(j)return $(j);if(_e==null)return _.end(tt=>{if(tt)return $(tt);a({done:!0,value:void 0})});a({done:!1,value:{key:new Key(_e,!1),value:et}})})}),return:()=>new Promise((a,$)=>{_.end(j=>{if(j)return $(j);a({done:!0,value:void 0})})})}}}}const drain$2=async _=>{for await(const a of _);};var itDrain$2=drain$2;const all$2=async _=>{const a=[];for await(const $ of _)a.push($);return a};var itAll$1=all$2;const sortAll=(_,a)=>async function*(){yield*(await itAll$1(_)).sort(a)}();class BaseBlockstore{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(a,$,j){return Promise.reject(new Error(".put is not implemented"))}get(a,$){return Promise.reject(new Error(".get is not implemented"))}has(a,$){return Promise.reject(new Error(".has is not implemented"))}delete(a,$){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(a,$={}){for await(const{key:j,value:_e}of a)await this.put(j,_e,$),yield{key:j,value:_e}}async*getMany(a,$={}){for await(const j of a)yield this.get(j,$)}async*deleteMany(a,$={}){for await(const j of a)await this.delete(j,$),yield j}batch(){let a=[],$=[];return{put(j,_e){a.push({key:j,value:_e})},delete(j){$.push(j)},commit:async j=>{await itDrain$2(this.putMany(a,j)),a=[],await itDrain$2(this.deleteMany($,j)),$=[]}}}async*_all(a,$){throw new Error("._all is not implemented")}async*_allKeys(a,$){throw new Error("._allKeys is not implemented")}query(a,$){let j=this._all(a,$);if(a.prefix!=null&&(j=itFilter(j,_e=>_e.key.toString().startsWith(a.prefix||""))),Array.isArray(a.filters)&&(j=a.filters.reduce((_e,et)=>itFilter(_e,et),j)),Array.isArray(a.orders)&&(j=a.orders.reduce((_e,et)=>sortAll(_e,et),j)),a.offset!=null){let _e=0;j=itFilter(j,()=>_e++>=(a.offset||0))}return a.limit!=null&&(j=itTake(j,a.limit)),j}queryKeys(a,$){let j=this._allKeys(a,$);if(a.prefix!=null&&(j=itFilter(j,_e=>_e.toString().startsWith(a.prefix||""))),Array.isArray(a.filters)&&(j=a.filters.reduce((_e,et)=>itFilter(_e,et),j)),Array.isArray(a.orders)&&(j=a.orders.reduce((_e,et)=>sortAll(_e,et),j)),a.offset!=null){let _e=0;j=itFilter(j,()=>_e++>=a.offset)}return a.limit!=null&&(j=itTake(j,a.limit)),j}}function cidToKey(_){const a=CID.asCID(_);if(!a)throw errCode(new Error("Not a valid cid"),"ERR_INVALID_CID");return new Key("/"+base32$4.encode(a.multihash.bytes).slice(1).toUpperCase(),!1)}function keyToCid(_){return CID.createV1(code$4,decode$n(base32$4.decode("b"+_.toString().slice(1).toLowerCase())))}function convertPrefix(_){const a=_.substring(0,1);if(a==="/")return convertPrefix(_.substring(1));let $;a.toLowerCase()==="b"?$=et=>base32$4.decode(et.toLowerCase()).subarray(2):a.toLowerCase()==="c"?$=et=>base32pad$2.decode(et.toLowerCase()).subarray(2):a==="z"?$=et=>base58btc$2.decode(et).subarray(2):a==="Q"?$=et=>base58btc$2.decode("z"+et):$=et=>base32$4.decode("b"+et.toLowerCase()).subarray(2);let j;for(let et=1;et<_.length;et++)try{j=$(_.substring(0,et))}catch(tt){if(tt.message!=="Unexpected end of data")throw tt}let _e="/C";return j&&(_e=`/${base32$4.encode(j).slice(1,-1).toUpperCase()||"C"}`),_e}function convertQuery(_){return{..._,prefix:_.prefix?convertPrefix(_.prefix):void 0,filters:_.filters?_.filters.map(a=>$=>a({key:keyToCid($.key),value:$.value})):void 0,orders:_.orders?_.orders.map(a=>($,j)=>a({key:keyToCid($.key),value:$.value},{key:keyToCid(j.key),value:j.value})):void 0}}function convertKeyQuery(_){return{..._,prefix:_.prefix?convertPrefix(_.prefix):void 0,filters:_.filters?_.filters.map(a=>$=>a(keyToCid($))):void 0,orders:_.orders?_.orders.map(a=>($,j)=>a(keyToCid($),keyToCid(j))):void 0}}class BlockstoreDatastoreAdapter extends BaseBlockstore{constructor(a){super(),this.child=a}open(){return this.child.open()}close(){return this.child.close()}async*query(a,$){for await(const{key:j,value:_e}of this.child.query(convertQuery(a),$))yield{key:keyToCid(j),value:_e}}async*queryKeys(a,$){for await(const j of this.child.queryKeys(convertKeyQuery(a),$))yield keyToCid(j)}async get(a,$){return this.child.get(cidToKey(a),$)}async*getMany(a,$){for await(const j of a)yield this.get(j,$)}async put(a,$,j){await this.child.put(cidToKey(a),$,j)}async*putMany(a,$){const j=pushable$2({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{const et=this.child;await drain$3(this.child.putMany(async function*(){for await(const tt of a){const rt=cidToKey(tt.key);await et.has(rt,$)||(yield{key:rt,value:tt.value}),j.push(tt)}}())),j.end()}catch(et){j.end(et)}}),yield*j}has(a,$){return this.child.has(cidToKey(a),$)}delete(a,$){return this.child.delete(cidToKey(a),$)}deleteMany(a,$){const j=pushable$2({objectMode:!0});return drain$3(this.child.deleteMany(async function*(){for await(const _e of a)yield cidToKey(_e),j.push(_e);j.end()}(),$)).catch(_e=>{j.end(_e)}),j}}function createRepo$1(_,a,$){const j=$.path||"ipfs";return createRepo$2(j,_e=>a.getCodec(_e),{root:new LevelDatastore(j,{prefix:"",version:2}),blocks:new BlockstoreDatastoreAdapter(new LevelDatastore(`${j}/blocks`,{prefix:"",version:2})),datastore:new LevelDatastore(`${j}/datastore`,{prefix:"",version:2}),keys:new LevelDatastore(`${j}/keys`,{prefix:"",version:2}),pins:new LevelDatastore(`${j}/pins`,{prefix:"",version:2})},{autoMigrate:$.autoMigrate,onMigrationProgress:$.onMigrationProgress||_,repoLock:MemoryLock})}const codes$2={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};var Envelope;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{_e.lengthDelimited!==!1&&j.fork(),(_e.writeDefaults===!0||$.publicKey!=null&&$.publicKey.byteLength>0)&&(j.uint32(10),j.bytes($.publicKey)),(_e.writeDefaults===!0||$.payloadType!=null&&$.payloadType.byteLength>0)&&(j.uint32(18),j.bytes($.payloadType)),(_e.writeDefaults===!0||$.payload!=null&&$.payload.byteLength>0)&&(j.uint32(26),j.bytes($.payload)),(_e.writeDefaults===!0||$.signature!=null&&$.signature.byteLength>0)&&(j.uint32(42),j.bytes($.signature)),_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.publicKey=$.bytes();break;case 2:_e.payloadType=$.bytes();break;case 3:_e.payload=$.bytes();break;case 5:_e.signature=$.bytes();break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(Envelope||(Envelope={}));function accessor(_){return _ instanceof Uint8Array?{get(a){return _[a]},set(a,$){_[a]=$}}:{get(a){return _.get(a)},set(a,$){_.set(a,$)}}}const TWO_32=4294967296;class LongBits{constructor(a=0,$=0){this.hi=a,this.lo=$}toBigInt(a){if(a===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!==0){const $=~this.lo+1>>>0;let j=~this.hi>>>0;return $===0&&(j=j+1>>>0),-(BigInt($)+(BigInt(j)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(a){return Number(this.toBigInt(a))}zzDecode(){const a=-(this.lo&1),$=((this.lo>>>1|this.hi<<31)^a)>>>0,j=(this.hi>>>1^a)>>>0;return new LongBits(j,$)}zzEncode(){const a=this.hi>>31,$=((this.hi<<1|this.lo>>>31)^a)>>>0,j=(this.lo<<1^a)>>>0;return new LongBits($,j)}toBytes(a,$=0){const j=accessor(a);for(;this.hi>0;)j.set($++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)j.set($++,this.lo&127|128),this.lo=this.lo>>>7;j.set($++,this.lo)}static fromBigInt(a){if(a===0n)return new LongBits;const $=a<0;$&&(a=-a);let j=Number(a>>32n)|0,_e=Number(a-(BigInt(j)<<32n))|0;return $&&(j=~j>>>0,_e=~_e>>>0,++_e>TWO_32&&(_e=0,++j>TWO_32&&(j=0))),new LongBits(j,_e)}static fromNumber(a){if(a===0)return new LongBits;const $=a<0;$&&(a=-a);let j=a>>>0,_e=(a-j)/4294967296>>>0;return $&&(_e=~_e>>>0,j=~j>>>0,++j>4294967295&&(j=0,++_e>4294967295&&(_e=0))),new LongBits(_e,j)}static fromBytes(a,$=0){const j=accessor(a),_e=new LongBits;let et=0;if(a.length-$>4){for(;et<4;++et)if(_e.lo=(_e.lo|(j.get($)&127)<<et*7)>>>0,j.get($++)<128)return _e;if(_e.lo=(_e.lo|(j.get($)&127)<<28)>>>0,_e.hi=(_e.hi|(j.get($)&127)>>4)>>>0,j.get($++)<128)return _e;et=0}else for(;et<4;++et){if($>=a.length)throw RangeError(`index out of range: ${$} > ${a.length}`);if(_e.lo=(_e.lo|(j.get($)&127)<<et*7)>>>0,j.get($++)<128)return _e}if(a.length-$>4){for(;et<5;++et)if(_e.hi=(_e.hi|(j.get($)&127)<<et*7+3)>>>0,j.get($++)<128)return _e}else if($<a.byteLength)for(;et<5;++et){if($>=a.length)throw RangeError(`index out of range: ${$} > ${a.length}`);if(_e.hi=(_e.hi|(j.get($)&127)<<et*7+3)>>>0,j.get($++)<128)return _e}throw RangeError("invalid varint encoding")}}const N1$3=Math.pow(2,7),N2$3=Math.pow(2,14),N3$3=Math.pow(2,21),N4$3=Math.pow(2,28),N5$3=Math.pow(2,35),N6$3=Math.pow(2,42),N7$3=Math.pow(2,49),N8$3=Math.pow(2,56),N9$3=Math.pow(2,63),unsigned={encodingLength(_){return _<N1$3?1:_<N2$3?2:_<N3$3?3:_<N4$3?4:_<N5$3?5:_<N6$3?6:_<N7$3?7:_<N8$3?8:_<N9$3?9:10},encode(_,a,$=0){if(Number.MAX_SAFE_INTEGER!=null&&_>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return a==null&&(a=allocUnsafe$5(unsigned.encodingLength(_))),LongBits.fromNumber(_).toBytes(a,$),a},decode(_,a=0){return LongBits.fromBytes(_,a).toNumber(!0)}};class RecordEnvelope{constructor(a){const{peerId:$,payloadType:j,payload:_e,signature:et}=a;this.peerId=$,this.payloadType=j,this.payload=_e,this.signature=et}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=Envelope.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(a){return equals$1(this.marshal(),a.marshal())}async validate(a){const $=formatSignaturePayload(a,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return await unmarshalPublicKey(this.peerId.publicKey).verify($.subarray(),this.signature)}}RecordEnvelope.createFromProtobuf=async _=>{const a=Envelope.decode(_),$=await peerIdFromKeys(a.publicKey);return new RecordEnvelope({peerId:$,payloadType:a.payloadType,payload:a.payload,signature:a.signature})};RecordEnvelope.seal=async(_,a)=>{if(a.privateKey==null)throw new Error("Missing private key");const $=_.domain,j=_.codec,_e=_.marshal(),et=formatSignaturePayload($,j,_e),rt=await(await unmarshalPrivateKey(a.privateKey)).sign(et.subarray());return new RecordEnvelope({peerId:a,payloadType:j,payload:_e,signature:rt})};RecordEnvelope.openAndCertify=async(_,a)=>{const $=await RecordEnvelope.createFromProtobuf(_);if(!await $.validate(a))throw errCode(new Error("envelope signature is not valid for the given domain"),codes$2.ERR_SIGNATURE_NOT_VALID);return $};const formatSignaturePayload=(_,a,$)=>{const j=fromString$5(_),_e=unsigned.encode(j.byteLength),et=unsigned.encode(a.length),tt=unsigned.encode($.length);return new Uint8ArrayList(_e,j,et,a,tt,$)};function arrayEquals$1(_,a){const $=(j,_e)=>j.toString().localeCompare(_e.toString());return _.length!==a.length?!1:(a.sort($),_.sort($).every((j,_e)=>a[_e].equals(j)))}var PeerRecord$1;(function(_){(function($){let j;$.codec=()=>(j==null&&(j=message((_e,et,tt={})=>{tt.lengthDelimited!==!1&&et.fork(),(tt.writeDefaults===!0||_e.multiaddr!=null&&_e.multiaddr.byteLength>0)&&(et.uint32(10),et.bytes(_e.multiaddr)),tt.lengthDelimited!==!1&&et.ldelim()},(_e,et)=>{const tt={multiaddr:new Uint8Array(0)},rt=et==null?_e.len:_e.pos+et;for(;_e.pos<rt;){const nt=_e.uint32();switch(nt>>>3){case 1:tt.multiaddr=_e.bytes();break;default:_e.skipType(nt&7);break}}return tt})),j),$.encode=_e=>encodeMessage(_e,$.codec()),$.decode=_e=>decodeMessage(_e,$.codec())})(_.AddressInfo||(_.AddressInfo={}));let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{if(_e.lengthDelimited!==!1&&j.fork(),(_e.writeDefaults===!0||$.peerId!=null&&$.peerId.byteLength>0)&&(j.uint32(10),j.bytes($.peerId)),(_e.writeDefaults===!0||$.seq!==0n)&&(j.uint32(16),j.uint64($.seq)),$.addresses!=null)for(const et of $.addresses)j.uint32(26),_.AddressInfo.codec().encode(et,j,{writeDefaults:!0});_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={peerId:new Uint8Array(0),seq:0n,addresses:[]},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.peerId=$.bytes();break;case 2:_e.seq=$.uint64();break;case 3:_e.addresses.push(_.AddressInfo.codec().decode($,$.uint32()));break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(PeerRecord$1||(PeerRecord$1={}));const ENVELOPE_DOMAIN_PEER_RECORD="libp2p-peer-record",ENVELOPE_PAYLOAD_TYPE_PEER_RECORD=Uint8Array.from([3,1]);class PeerRecord{constructor(a){this.domain=PeerRecord.DOMAIN,this.codec=PeerRecord.CODEC;const{peerId:$,multiaddrs:j,seqNumber:_e}=a;this.peerId=$,this.multiaddrs=j??[],this.seqNumber=_e??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=PeerRecord$1.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(a=>({multiaddr:a.bytes}))})),this.marshaled}equals(a){return!(!(a instanceof PeerRecord)||!this.peerId.equals(a.peerId)||this.seqNumber!==a.seqNumber||!arrayEquals$1(this.multiaddrs,a.multiaddrs))}}PeerRecord.createFromProtobuf=_=>{const a=PeerRecord$1.decode(_),$=peerIdFromBytes(a.peerId),j=(a.addresses??[]).map(et=>multiaddr(et.multiaddr)),_e=a.seq;return new PeerRecord({peerId:$,multiaddrs:j,seqNumber:_e})};PeerRecord.DOMAIN=ENVELOPE_DOMAIN_PEER_RECORD;PeerRecord.CODEC=ENVELOPE_PAYLOAD_TYPE_PEER_RECORD;const topologySymbol=Symbol.for("@libp2p/topology");function isTopology(_){return _!=null&&Boolean(_[topologySymbol])}const noop$2=()=>{};class TopologyImpl{constructor(a){this.min=a.min??0,this.max=a.max??1/0,this.peers=new Set,this.onConnect=a.onConnect??noop$2,this.onDisconnect=a.onDisconnect??noop$2}get[Symbol.toStringTag](){return topologySymbol.toString()}get[topologySymbol](){return!0}async setRegistrar(a){this.registrar=a}disconnect(a){this.onDisconnect(a)}}function createTopology(_){return new TopologyImpl(_)}var __classPrivateFieldGet=globalThis&&globalThis.__classPrivateFieldGet||function(_,a,$,j){if($==="a"&&!j)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?_!==a||!j:!a.has(_))throw new TypeError("Cannot read private member from an object whose class did not declare it");return $==="m"?j:$==="a"?j.call(_):j?j.value:a.get(_)},_EventEmitter_listeners;class EventEmitter$1 extends EventTarget{constructor(){super(...arguments),_EventEmitter_listeners.set(this,new Map)}listenerCount(a){const $=__classPrivateFieldGet(this,_EventEmitter_listeners,"f").get(a);return $==null?0:$.length}addEventListener(a,$,j){super.addEventListener(a,$,j);let _e=__classPrivateFieldGet(this,_EventEmitter_listeners,"f").get(a);_e==null&&(_e=[],__classPrivateFieldGet(this,_EventEmitter_listeners,"f").set(a,_e)),_e.push({callback:$,once:(j!==!0&&j!==!1&&j?.once)??!1})}removeEventListener(a,$,j){super.removeEventListener(a.toString(),$??null,j);let _e=__classPrivateFieldGet(this,_EventEmitter_listeners,"f").get(a);_e!=null&&(_e=_e.filter(({callback:et})=>et!==$),__classPrivateFieldGet(this,_EventEmitter_listeners,"f").set(a,_e))}dispatchEvent(a){const $=super.dispatchEvent(a);let j=__classPrivateFieldGet(this,_EventEmitter_listeners,"f").get(a.type);return j==null||(j=j.filter(({once:_e})=>!_e),__classPrivateFieldGet(this,_EventEmitter_listeners,"f").set(a.type,j)),$}}_EventEmitter_listeners=new WeakMap;class CustomEventPolyfill extends Event{constructor(a,$){super(a,$),this.detail=$?.detail}}const CustomEvent$1=globalThis.CustomEvent??CustomEventPolyfill;class MessageCache{constructor(a,$,j){this.gossip=a,this.msgs=new Map,this.history=[],this.msgIdToStrFn=j;for(let _e=0;_e<$;_e++)this.history[_e]=[]}get size(){return this.msgs.size}put(a,$,j=!1){const{msgIdStr:_e}=a;return this.msgs.has(_e)?!1:(this.msgs.set(_e,{message:$,validated:j,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...a,topic:$.topic}),!0)}observeDuplicate(a,$){const j=this.msgs.get(a);j&&!j.validated&&j.originatingPeers.add($)}get(a){return this.msgs.get(this.msgIdToStrFn(a))?.message}getWithIWantCount(a,$){const j=this.msgs.get(a);if(!j)return null;const _e=(j.iwantCounts.get($)??0)+1;return j.iwantCounts.set($,_e),{msg:j.message,count:_e}}getGossipIDs(a){const $=new Map;for(let j=0;j<this.gossip;j++)this.history[j].forEach(_e=>{const et=this.msgs.get(_e.msgIdStr);if(et&&et.validated&&a.has(_e.topic)){let tt=$.get(_e.topic);tt||(tt=[],$.set(_e.topic,tt)),tt.push(_e.msgId)}});return $}validate(a){const $=this.msgs.get(a);if(!$)return null;const{message:j,originatingPeers:_e}=$;return $.validated=!0,$.originatingPeers=new Set,{message:j,originatingPeers:_e}}shift(){this.history[this.history.length-1].forEach($=>{this.msgs.delete($.msgIdStr)}),this.history.pop(),this.history.unshift([])}remove(a){const $=this.msgs.get(a);return $?(this.msgs.delete(a),$):null}}var rpc$1={exports:{}},minimal$1={exports:{}},indexMinimal={},minimal={},longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=a;var _=requireMinimal$1();function a(et,tt){this.lo=et>>>0,this.hi=tt>>>0}var $=a.zero=new a(0,0);$.toNumber=function(){return 0},$.zzEncode=$.zzDecode=function(){return this},$.length=function(){return 1};var j=a.zeroHash="\0\0\0\0\0\0\0\0";a.fromNumber=function(tt){if(tt===0)return $;var rt=tt<0;rt&&(tt=-tt);var nt=tt>>>0,it=(tt-nt)/4294967296>>>0;return rt&&(it=~it>>>0,nt=~nt>>>0,++nt>4294967295&&(nt=0,++it>4294967295&&(it=0))),new a(nt,it)},a.from=function(tt){if(typeof tt=="number")return a.fromNumber(tt);if(_.isString(tt))if(_.Long)tt=_.Long.fromString(tt);else return a.fromNumber(parseInt(tt,10));return tt.low||tt.high?new a(tt.low>>>0,tt.high>>>0):$},a.prototype.toNumber=function(tt){if(!tt&&this.hi>>>31){var rt=~this.lo+1>>>0,nt=~this.hi>>>0;return rt||(nt=nt+1>>>0),-(rt+nt*4294967296)}return this.lo+this.hi*4294967296},a.prototype.toLong=function(tt){return _.Long?new _.Long(this.lo|0,this.hi|0,Boolean(tt)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(tt)}};var _e=String.prototype.charCodeAt;return a.fromHash=function(tt){return tt===j?$:new a((_e.call(tt,0)|_e.call(tt,1)<<8|_e.call(tt,2)<<16|_e.call(tt,3)<<24)>>>0,(_e.call(tt,4)|_e.call(tt,5)<<8|_e.call(tt,6)<<16|_e.call(tt,7)<<24)>>>0)},a.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},a.prototype.zzEncode=function(){var tt=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^tt)>>>0,this.lo=(this.lo<<1^tt)>>>0,this},a.prototype.zzDecode=function(){var tt=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^tt)>>>0,this.hi=(this.hi>>>1^tt)>>>0,this},a.prototype.length=function(){var tt=this.lo,rt=(this.lo>>>28|this.hi<<4)>>>0,nt=this.hi>>>24;return nt===0?rt===0?tt<16384?tt<128?1:2:tt<2097152?3:4:rt<16384?rt<128?5:6:rt<2097152?7:8:nt<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(_){var a=_;a.asPromise=aspromise,a.base64=base64$5,a.EventEmitter=eventemitter,a.float=float,a.inquire=inquire_1,a.utf8=utf8$2,a.pool=pool_1,a.LongBits=requireLongbits(),a.isNode=Boolean(typeof{}<"u"&&{}&&{}.process&&{}.process.versions&&{}.process.versions.node),a.global=a.isNode&&{}||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,a.emptyArray=Object.freeze?Object.freeze([]):[],a.emptyObject=Object.freeze?Object.freeze({}):{},a.isInteger=Number.isInteger||function(et){return typeof et=="number"&&isFinite(et)&&Math.floor(et)===et},a.isString=function(et){return typeof et=="string"||et instanceof String},a.isObject=function(et){return et&&typeof et=="object"},a.isset=a.isSet=function(et,tt){var rt=et[tt];return rt!=null&&et.hasOwnProperty(tt)?typeof rt!="object"||(Array.isArray(rt)?rt.length:Object.keys(rt).length)>0:!1},a.Buffer=function(){try{var _e=a.inquire("buffer").Buffer;return _e.prototype.utf8Write?_e:null}catch{return null}}(),a._Buffer_from=null,a._Buffer_allocUnsafe=null,a.newBuffer=function(et){return typeof et=="number"?a.Buffer?a._Buffer_allocUnsafe(et):new a.Array(et):a.Buffer?a._Buffer_from(et):typeof Uint8Array>"u"?et:new Uint8Array(et)},a.Array=typeof Uint8Array<"u"?Uint8Array:Array,a.Long=a.global.dcodeIO&&a.global.dcodeIO.Long||a.global.Long||a.inquire("long"),a.key2Re=/^true|false|0|1$/,a.key32Re=/^-?(?:0|[1-9][0-9]*)$/,a.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,a.longToHash=function(et){return et?a.LongBits.from(et).toHash():a.LongBits.zeroHash},a.longFromHash=function(et,tt){var rt=a.LongBits.fromHash(et);return a.Long?a.Long.fromBits(rt.lo,rt.hi,tt):rt.toNumber(Boolean(tt))};function $(_e,et,tt){for(var rt=Object.keys(et),nt=0;nt<rt.length;++nt)(_e[rt[nt]]===void 0||!tt)&&(_e[rt[nt]]=et[rt[nt]]);return _e}a.merge=$,a.lcFirst=function(et){return et.charAt(0).toLowerCase()+et.substring(1)};function j(_e){function et(tt,rt){if(!(this instanceof et))return new et(tt,rt);Object.defineProperty(this,"message",{get:function(){return tt}}),Error.captureStackTrace?Error.captureStackTrace(this,et):Object.defineProperty(this,"stack",{value:new Error().stack||""}),rt&&$(this,rt)}return(et.prototype=Object.create(Error.prototype)).constructor=et,Object.defineProperty(et.prototype,"name",{get:function(){return _e}}),et.prototype.toString=function(){return this.name+": "+this.message},et}a.newError=j,a.ProtocolError=j("ProtocolError"),a.oneOfGetter=function(et){for(var tt={},rt=0;rt<et.length;++rt)tt[et[rt]]=1;return function(){for(var nt=Object.keys(this),it=nt.length-1;it>-1;--it)if(tt[nt[it]]===1&&this[nt[it]]!==void 0&&this[nt[it]]!==null)return nt[it]}},a.oneOfSetter=function(et){return function(tt){for(var rt=0;rt<et.length;++rt)et[rt]!==tt&&delete this[et[rt]]}},a.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},a._configure=function(){var _e=a.Buffer;if(!_e){a._Buffer_from=a._Buffer_allocUnsafe=null;return}a._Buffer_from=_e.from!==Uint8Array.from&&_e.from||function(tt,rt){return new _e(tt,rt)},a._Buffer_allocUnsafe=_e.allocUnsafe||function(tt){return new _e(tt)}}}(minimal)),minimal}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=nt;var _=requireMinimal$1(),a,$=_.LongBits,j=_.base64,_e=_.utf8;function et(dt,ft,pt){this.fn=dt,this.len=ft,this.next=void 0,this.val=pt}function tt(){}function rt(dt){this.head=dt.head,this.tail=dt.tail,this.len=dt.len,this.next=dt.states}function nt(){this.len=0,this.head=new et(tt,0,0),this.tail=this.head,this.states=null}var it=function(){return _.Buffer?function(){return(nt.create=function(){return new a})()}:function(){return new nt}};nt.create=it(),nt.alloc=function(ft){return new _.Array(ft)},_.Array!==Array&&(nt.alloc=_.pool(nt.alloc,_.Array.prototype.subarray)),nt.prototype._push=function(ft,pt,yt){return this.tail=this.tail.next=new et(ft,pt,yt),this.len+=pt,this};function st(dt,ft,pt){ft[pt]=dt&255}function ot(dt,ft,pt){for(;dt>127;)ft[pt++]=dt&127|128,dt>>>=7;ft[pt]=dt}function at(dt,ft){this.len=dt,this.next=void 0,this.val=ft}at.prototype=Object.create(et.prototype),at.prototype.fn=ot,nt.prototype.uint32=function(ft){return this.len+=(this.tail=this.tail.next=new at((ft=ft>>>0)<128?1:ft<16384?2:ft<2097152?3:ft<268435456?4:5,ft)).len,this},nt.prototype.int32=function(ft){return ft<0?this._push(lt,10,$.fromNumber(ft)):this.uint32(ft)},nt.prototype.sint32=function(ft){return this.uint32((ft<<1^ft>>31)>>>0)};function lt(dt,ft,pt){for(;dt.hi;)ft[pt++]=dt.lo&127|128,dt.lo=(dt.lo>>>7|dt.hi<<25)>>>0,dt.hi>>>=7;for(;dt.lo>127;)ft[pt++]=dt.lo&127|128,dt.lo=dt.lo>>>7;ft[pt++]=dt.lo}nt.prototype.uint64=function(ft){var pt=$.from(ft);return this._push(lt,pt.length(),pt)},nt.prototype.int64=nt.prototype.uint64,nt.prototype.sint64=function(ft){var pt=$.from(ft).zzEncode();return this._push(lt,pt.length(),pt)},nt.prototype.bool=function(ft){return this._push(st,1,ft?1:0)};function ct(dt,ft,pt){ft[pt]=dt&255,ft[pt+1]=dt>>>8&255,ft[pt+2]=dt>>>16&255,ft[pt+3]=dt>>>24}nt.prototype.fixed32=function(ft){return this._push(ct,4,ft>>>0)},nt.prototype.sfixed32=nt.prototype.fixed32,nt.prototype.fixed64=function(ft){var pt=$.from(ft);return this._push(ct,4,pt.lo)._push(ct,4,pt.hi)},nt.prototype.sfixed64=nt.prototype.fixed64,nt.prototype.float=function(ft){return this._push(_.float.writeFloatLE,4,ft)},nt.prototype.double=function(ft){return this._push(_.float.writeDoubleLE,8,ft)};var ut=_.Array.prototype.set?function(ft,pt,yt){pt.set(ft,yt)}:function(ft,pt,yt){for(var mt=0;mt<ft.length;++mt)pt[yt+mt]=ft[mt]};return nt.prototype.bytes=function(ft){var pt=ft.length>>>0;if(!pt)return this._push(st,1,0);if(_.isString(ft)){var yt=nt.alloc(pt=j.length(ft));j.decode(ft,yt,0),ft=yt}return this.uint32(pt)._push(ut,pt,ft)},nt.prototype.string=function(ft){var pt=_e.length(ft);return pt?this.uint32(pt)._push(_e.write,pt,ft):this._push(st,1,0)},nt.prototype.fork=function(){return this.states=new rt(this),this.head=this.tail=new et(tt,0,0),this.len=0,this},nt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new et(tt,0,0),this.len=0),this},nt.prototype.ldelim=function(){var ft=this.head,pt=this.tail,yt=this.len;return this.reset().uint32(yt),yt&&(this.tail.next=ft.next,this.tail=pt,this.len+=yt),this},nt.prototype.finish=function(){for(var ft=this.head.next,pt=this.constructor.alloc(this.len),yt=0;ft;)ft.fn(ft.val,pt,yt),yt+=ft.len,ft=ft.next;return pt},nt._configure=function(dt){a=dt,nt.create=it(),a._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=$;var _=requireWriter();($.prototype=Object.create(_.prototype)).constructor=$;var a=requireMinimal$1();function $(){_.call(this)}$._configure=function(){$.alloc=a._Buffer_allocUnsafe,$.writeBytesBuffer=a.Buffer&&a.Buffer.prototype instanceof Uint8Array&&a.Buffer.prototype.set.name==="set"?function(et,tt,rt){tt.set(et,rt)}:function(et,tt,rt){if(et.copy)et.copy(tt,rt,0,et.length);else for(var nt=0;nt<et.length;)tt[rt++]=et[nt++]}},$.prototype.bytes=function(et){a.isString(et)&&(et=a._Buffer_from(et,"base64"));var tt=et.length>>>0;return this.uint32(tt),tt&&this._push($.writeBytesBuffer,tt,et),this};function j(_e,et,tt){_e.length<40?a.utf8.write(_e,et,tt):et.utf8Write?et.utf8Write(_e,tt):et.write(_e,tt)}return $.prototype.string=function(et){var tt=a.Buffer.byteLength(et);return this.uint32(tt),tt&&this._push(j,tt,et),this},$._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=et;var _=requireMinimal$1(),a,$=_.LongBits,j=_.utf8;function _e(ot,at){return RangeError("index out of range: "+ot.pos+" + "+(at||1)+" > "+ot.len)}function et(ot){this.buf=ot,this.pos=0,this.len=ot.length}var tt=typeof Uint8Array<"u"?function(at){if(at instanceof Uint8Array||Array.isArray(at))return new et(at);throw Error("illegal buffer")}:function(at){if(Array.isArray(at))return new et(at);throw Error("illegal buffer")},rt=function(){return _.Buffer?function(lt){return(et.create=function(ut){return _.Buffer.isBuffer(ut)?new a(ut):tt(ut)})(lt)}:tt};et.create=rt(),et.prototype._slice=_.Array.prototype.subarray||_.Array.prototype.slice,et.prototype.uint32=function(){var at=4294967295;return function(){if(at=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(at=(at|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(at=(at|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(at=(at|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(at=(at|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return at;if((this.pos+=5)>this.len)throw this.pos=this.len,_e(this,10);return at}}(),et.prototype.int32=function(){return this.uint32()|0},et.prototype.sint32=function(){var at=this.uint32();return at>>>1^-(at&1)|0};function nt(){var ot=new $(0,0),at=0;if(this.len-this.pos>4){for(;at<4;++at)if(ot.lo=(ot.lo|(this.buf[this.pos]&127)<<at*7)>>>0,this.buf[this.pos++]<128)return ot;if(ot.lo=(ot.lo|(this.buf[this.pos]&127)<<28)>>>0,ot.hi=(ot.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return ot;at=0}else{for(;at<3;++at){if(this.pos>=this.len)throw _e(this);if(ot.lo=(ot.lo|(this.buf[this.pos]&127)<<at*7)>>>0,this.buf[this.pos++]<128)return ot}return ot.lo=(ot.lo|(this.buf[this.pos++]&127)<<at*7)>>>0,ot}if(this.len-this.pos>4){for(;at<5;++at)if(ot.hi=(ot.hi|(this.buf[this.pos]&127)<<at*7+3)>>>0,this.buf[this.pos++]<128)return ot}else for(;at<5;++at){if(this.pos>=this.len)throw _e(this);if(ot.hi=(ot.hi|(this.buf[this.pos]&127)<<at*7+3)>>>0,this.buf[this.pos++]<128)return ot}throw Error("invalid varint encoding")}et.prototype.bool=function(){return this.uint32()!==0};function it(ot,at){return(ot[at-4]|ot[at-3]<<8|ot[at-2]<<16|ot[at-1]<<24)>>>0}et.prototype.fixed32=function(){if(this.pos+4>this.len)throw _e(this,4);return it(this.buf,this.pos+=4)},et.prototype.sfixed32=function(){if(this.pos+4>this.len)throw _e(this,4);return it(this.buf,this.pos+=4)|0};function st(){if(this.pos+8>this.len)throw _e(this,8);return new $(it(this.buf,this.pos+=4),it(this.buf,this.pos+=4))}return et.prototype.float=function(){if(this.pos+4>this.len)throw _e(this,4);var at=_.float.readFloatLE(this.buf,this.pos);return this.pos+=4,at},et.prototype.double=function(){if(this.pos+8>this.len)throw _e(this,4);var at=_.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,at},et.prototype.bytes=function(){var at=this.uint32(),lt=this.pos,ct=this.pos+at;if(ct>this.len)throw _e(this,at);return this.pos+=at,Array.isArray(this.buf)?this.buf.slice(lt,ct):lt===ct?new this.buf.constructor(0):this._slice.call(this.buf,lt,ct)},et.prototype.string=function(){var at=this.bytes();return j.read(at,0,at.length)},et.prototype.skip=function(at){if(typeof at=="number"){if(this.pos+at>this.len)throw _e(this,at);this.pos+=at}else do if(this.pos>=this.len)throw _e(this);while(this.buf[this.pos++]&128);return this},et.prototype.skipType=function(ot){switch(ot){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(ot=this.uint32()&7)!==4;)this.skipType(ot);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+ot+" at offset "+this.pos)}return this},et._configure=function(ot){a=ot,et.create=rt(),a._configure();var at=_.Long?"toLong":"toNumber";_.merge(et.prototype,{int64:function(){return nt.call(this)[at](!1)},uint64:function(){return nt.call(this)[at](!0)},sint64:function(){return nt.call(this).zzDecode()[at](!1)},fixed64:function(){return st.call(this)[at](!0)},sfixed64:function(){return st.call(this)[at](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=$;var _=requireReader();($.prototype=Object.create(_.prototype)).constructor=$;var a=requireMinimal$1();function $(j){_.call(this,j)}return $._configure=function(){a.Buffer&&($.prototype._slice=a.Buffer.prototype.slice)},$.prototype.string=function(){var _e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+_e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+_e,this.len))},$._configure(),reader_buffer}var rpc={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=a;var _=requireMinimal$1();(a.prototype=Object.create(_.EventEmitter.prototype)).constructor=a;function a($,j,_e){if(typeof $!="function")throw TypeError("rpcImpl must be a function");_.EventEmitter.call(this),this.rpcImpl=$,this.requestDelimited=Boolean(j),this.responseDelimited=Boolean(_e)}return a.prototype.rpcCall=function $(j,_e,et,tt,rt){if(!tt)throw TypeError("request must be specified");var nt=this;if(!rt)return _.asPromise($,nt,j,_e,et,tt);if(!nt.rpcImpl){setTimeout(function(){rt(Error("already ended"))},0);return}try{return nt.rpcImpl(j,_e[nt.requestDelimited?"encodeDelimited":"encode"](tt).finish(),function(st,ot){if(st)return nt.emit("error",st,j),rt(st);if(ot===null){nt.end(!0);return}if(!(ot instanceof et))try{ot=et[nt.responseDelimited?"decodeDelimited":"decode"](ot)}catch(at){return nt.emit("error",at,j),rt(at)}return nt.emit("data",ot,j),rt(null,ot)})}catch(it){nt.emit("error",it,j),setTimeout(function(){rt(it)},0);return}},a.prototype.end=function(j){return this.rpcImpl&&(j||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,function(_){var a=_;a.Service=requireService()}(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,function(_){var a=_;a.build="minimal",a.Writer=requireWriter(),a.BufferWriter=requireWriter_buffer(),a.Reader=requireReader(),a.BufferReader=requireReader_buffer(),a.util=requireMinimal$1(),a.rpc=requireRpc(),a.roots=requireRoots(),a.configure=$;function $(){a.util._configure(),a.Writer._configure(a.BufferWriter),a.Reader._configure(a.BufferReader)}$()}(indexMinimal)),indexMinimal}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(_){_.exports=requireIndexMinimal()}(minimal$1)),minimal$1.exports}(function(_){(function(a,$){typeof commonjsRequire=="function"&&!0&&_&&_.exports&&(_.exports=$(requireMinimal()))})(commonjsGlobal,function(a){var $=a.Reader,j=a.Writer,_e=a.util,et=a.roots.default||(a.roots.default={});return et.RPC=function(){function tt(nt){if(this.subscriptions=[],this.messages=[],nt)for(var it=Object.keys(nt),st=0;st<it.length;++st)nt[it[st]]!=null&&(this[it[st]]=nt[it[st]])}tt.prototype.subscriptions=_e.emptyArray,tt.prototype.messages=_e.emptyArray,tt.prototype.control=null;var rt;return Object.defineProperty(tt.prototype,"_control",{get:_e.oneOfGetter(rt=["control"]),set:_e.oneOfSetter(rt)}),tt.encode=function(it,st){if(st||(st=j.create()),it.subscriptions!=null&&it.subscriptions.length)for(var ot=0;ot<it.subscriptions.length;++ot)et.RPC.SubOpts.encode(it.subscriptions[ot],st.uint32(10).fork()).ldelim();if(it.messages!=null&&it.messages.length)for(var ot=0;ot<it.messages.length;++ot)et.RPC.Message.encode(it.messages[ot],st.uint32(18).fork()).ldelim();return it.control!=null&&Object.hasOwnProperty.call(it,"control")&&et.RPC.ControlMessage.encode(it.control,st.uint32(26).fork()).ldelim(),st},tt.decode=function(it,st){it instanceof $||(it=$.create(it));for(var ot=st===void 0?it.len:it.pos+st,at=new et.RPC;it.pos<ot;){var lt=it.uint32();switch(lt>>>3){case 1:at.subscriptions&&at.subscriptions.length||(at.subscriptions=[]),at.subscriptions.push(et.RPC.SubOpts.decode(it,it.uint32()));break;case 2:at.messages&&at.messages.length||(at.messages=[]),at.messages.push(et.RPC.Message.decode(it,it.uint32()));break;case 3:at.control=et.RPC.ControlMessage.decode(it,it.uint32());break;default:it.skipType(lt&7);break}}return at},tt.fromObject=function(it){if(it instanceof et.RPC)return it;var st=new et.RPC;if(it.subscriptions){if(!Array.isArray(it.subscriptions))throw TypeError(".RPC.subscriptions: array expected");st.subscriptions=[];for(var ot=0;ot<it.subscriptions.length;++ot){if(typeof it.subscriptions[ot]!="object")throw TypeError(".RPC.subscriptions: object expected");st.subscriptions[ot]=et.RPC.SubOpts.fromObject(it.subscriptions[ot])}}if(it.messages){if(!Array.isArray(it.messages))throw TypeError(".RPC.messages: array expected");st.messages=[];for(var ot=0;ot<it.messages.length;++ot){if(typeof it.messages[ot]!="object")throw TypeError(".RPC.messages: object expected");st.messages[ot]=et.RPC.Message.fromObject(it.messages[ot])}}if(it.control!=null){if(typeof it.control!="object")throw TypeError(".RPC.control: object expected");st.control=et.RPC.ControlMessage.fromObject(it.control)}return st},tt.toObject=function(it,st){st||(st={});var ot={};if((st.arrays||st.defaults)&&(ot.subscriptions=[],ot.messages=[]),it.subscriptions&&it.subscriptions.length){ot.subscriptions=[];for(var at=0;at<it.subscriptions.length;++at)ot.subscriptions[at]=et.RPC.SubOpts.toObject(it.subscriptions[at],st)}if(it.messages&&it.messages.length){ot.messages=[];for(var at=0;at<it.messages.length;++at)ot.messages[at]=et.RPC.Message.toObject(it.messages[at],st)}return it.control!=null&&it.hasOwnProperty("control")&&(ot.control=et.RPC.ControlMessage.toObject(it.control,st),st.oneofs&&(ot._control="control")),ot},tt.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},tt.SubOpts=function(){function nt(st){if(st)for(var ot=Object.keys(st),at=0;at<ot.length;++at)st[ot[at]]!=null&&(this[ot[at]]=st[ot[at]])}nt.prototype.subscribe=null,nt.prototype.topic=null;var it;return Object.defineProperty(nt.prototype,"_subscribe",{get:_e.oneOfGetter(it=["subscribe"]),set:_e.oneOfSetter(it)}),Object.defineProperty(nt.prototype,"_topic",{get:_e.oneOfGetter(it=["topic"]),set:_e.oneOfSetter(it)}),nt.encode=function(ot,at){return at||(at=j.create()),ot.subscribe!=null&&Object.hasOwnProperty.call(ot,"subscribe")&&at.uint32(8).bool(ot.subscribe),ot.topic!=null&&Object.hasOwnProperty.call(ot,"topic")&&at.uint32(18).string(ot.topic),at},nt.decode=function(ot,at){ot instanceof $||(ot=$.create(ot));for(var lt=at===void 0?ot.len:ot.pos+at,ct=new et.RPC.SubOpts;ot.pos<lt;){var ut=ot.uint32();switch(ut>>>3){case 1:ct.subscribe=ot.bool();break;case 2:ct.topic=ot.string();break;default:ot.skipType(ut&7);break}}return ct},nt.fromObject=function(ot){if(ot instanceof et.RPC.SubOpts)return ot;var at=new et.RPC.SubOpts;return ot.subscribe!=null&&(at.subscribe=Boolean(ot.subscribe)),ot.topic!=null&&(at.topic=String(ot.topic)),at},nt.toObject=function(ot,at){at||(at={});var lt={};return ot.subscribe!=null&&ot.hasOwnProperty("subscribe")&&(lt.subscribe=ot.subscribe,at.oneofs&&(lt._subscribe="subscribe")),ot.topic!=null&&ot.hasOwnProperty("topic")&&(lt.topic=ot.topic,at.oneofs&&(lt._topic="topic")),lt},nt.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},nt}(),tt.Message=function(){function nt(st){if(st)for(var ot=Object.keys(st),at=0;at<ot.length;++at)st[ot[at]]!=null&&(this[ot[at]]=st[ot[at]])}nt.prototype.from=null,nt.prototype.data=null,nt.prototype.seqno=null,nt.prototype.topic="",nt.prototype.signature=null,nt.prototype.key=null;var it;return Object.defineProperty(nt.prototype,"_from",{get:_e.oneOfGetter(it=["from"]),set:_e.oneOfSetter(it)}),Object.defineProperty(nt.prototype,"_data",{get:_e.oneOfGetter(it=["data"]),set:_e.oneOfSetter(it)}),Object.defineProperty(nt.prototype,"_seqno",{get:_e.oneOfGetter(it=["seqno"]),set:_e.oneOfSetter(it)}),Object.defineProperty(nt.prototype,"_signature",{get:_e.oneOfGetter(it=["signature"]),set:_e.oneOfSetter(it)}),Object.defineProperty(nt.prototype,"_key",{get:_e.oneOfGetter(it=["key"]),set:_e.oneOfSetter(it)}),nt.encode=function(ot,at){return at||(at=j.create()),ot.from!=null&&Object.hasOwnProperty.call(ot,"from")&&at.uint32(10).bytes(ot.from),ot.data!=null&&Object.hasOwnProperty.call(ot,"data")&&at.uint32(18).bytes(ot.data),ot.seqno!=null&&Object.hasOwnProperty.call(ot,"seqno")&&at.uint32(26).bytes(ot.seqno),at.uint32(34).string(ot.topic),ot.signature!=null&&Object.hasOwnProperty.call(ot,"signature")&&at.uint32(42).bytes(ot.signature),ot.key!=null&&Object.hasOwnProperty.call(ot,"key")&&at.uint32(50).bytes(ot.key),at},nt.decode=function(ot,at){ot instanceof $||(ot=$.create(ot));for(var lt=at===void 0?ot.len:ot.pos+at,ct=new et.RPC.Message;ot.pos<lt;){var ut=ot.uint32();switch(ut>>>3){case 1:ct.from=ot.bytes();break;case 2:ct.data=ot.bytes();break;case 3:ct.seqno=ot.bytes();break;case 4:ct.topic=ot.string();break;case 5:ct.signature=ot.bytes();break;case 6:ct.key=ot.bytes();break;default:ot.skipType(ut&7);break}}if(!ct.hasOwnProperty("topic"))throw _e.ProtocolError("missing required 'topic'",{instance:ct});return ct},nt.fromObject=function(ot){if(ot instanceof et.RPC.Message)return ot;var at=new et.RPC.Message;return ot.from!=null&&(typeof ot.from=="string"?_e.base64.decode(ot.from,at.from=_e.newBuffer(_e.base64.length(ot.from)),0):ot.from.length&&(at.from=ot.from)),ot.data!=null&&(typeof ot.data=="string"?_e.base64.decode(ot.data,at.data=_e.newBuffer(_e.base64.length(ot.data)),0):ot.data.length&&(at.data=ot.data)),ot.seqno!=null&&(typeof ot.seqno=="string"?_e.base64.decode(ot.seqno,at.seqno=_e.newBuffer(_e.base64.length(ot.seqno)),0):ot.seqno.length&&(at.seqno=ot.seqno)),ot.topic!=null&&(at.topic=String(ot.topic)),ot.signature!=null&&(typeof ot.signature=="string"?_e.base64.decode(ot.signature,at.signature=_e.newBuffer(_e.base64.length(ot.signature)),0):ot.signature.length&&(at.signature=ot.signature)),ot.key!=null&&(typeof ot.key=="string"?_e.base64.decode(ot.key,at.key=_e.newBuffer(_e.base64.length(ot.key)),0):ot.key.length&&(at.key=ot.key)),at},nt.toObject=function(ot,at){at||(at={});var lt={};return at.defaults&&(lt.topic=""),ot.from!=null&&ot.hasOwnProperty("from")&&(lt.from=at.bytes===String?_e.base64.encode(ot.from,0,ot.from.length):at.bytes===Array?Array.prototype.slice.call(ot.from):ot.from,at.oneofs&&(lt._from="from")),ot.data!=null&&ot.hasOwnProperty("data")&&(lt.data=at.bytes===String?_e.base64.encode(ot.data,0,ot.data.length):at.bytes===Array?Array.prototype.slice.call(ot.data):ot.data,at.oneofs&&(lt._data="data")),ot.seqno!=null&&ot.hasOwnProperty("seqno")&&(lt.seqno=at.bytes===String?_e.base64.encode(ot.seqno,0,ot.seqno.length):at.bytes===Array?Array.prototype.slice.call(ot.seqno):ot.seqno,at.oneofs&&(lt._seqno="seqno")),ot.topic!=null&&ot.hasOwnProperty("topic")&&(lt.topic=ot.topic),ot.signature!=null&&ot.hasOwnProperty("signature")&&(lt.signature=at.bytes===String?_e.base64.encode(ot.signature,0,ot.signature.length):at.bytes===Array?Array.prototype.slice.call(ot.signature):ot.signature,at.oneofs&&(lt._signature="signature")),ot.key!=null&&ot.hasOwnProperty("key")&&(lt.key=at.bytes===String?_e.base64.encode(ot.key,0,ot.key.length):at.bytes===Array?Array.prototype.slice.call(ot.key):ot.key,at.oneofs&&(lt._key="key")),lt},nt.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},nt}(),tt.ControlMessage=function(){function nt(it){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],it)for(var st=Object.keys(it),ot=0;ot<st.length;++ot)it[st[ot]]!=null&&(this[st[ot]]=it[st[ot]])}return nt.prototype.ihave=_e.emptyArray,nt.prototype.iwant=_e.emptyArray,nt.prototype.graft=_e.emptyArray,nt.prototype.prune=_e.emptyArray,nt.encode=function(st,ot){if(ot||(ot=j.create()),st.ihave!=null&&st.ihave.length)for(var at=0;at<st.ihave.length;++at)et.RPC.ControlIHave.encode(st.ihave[at],ot.uint32(10).fork()).ldelim();if(st.iwant!=null&&st.iwant.length)for(var at=0;at<st.iwant.length;++at)et.RPC.ControlIWant.encode(st.iwant[at],ot.uint32(18).fork()).ldelim();if(st.graft!=null&&st.graft.length)for(var at=0;at<st.graft.length;++at)et.RPC.ControlGraft.encode(st.graft[at],ot.uint32(26).fork()).ldelim();if(st.prune!=null&&st.prune.length)for(var at=0;at<st.prune.length;++at)et.RPC.ControlPrune.encode(st.prune[at],ot.uint32(34).fork()).ldelim();return ot},nt.decode=function(st,ot){st instanceof $||(st=$.create(st));for(var at=ot===void 0?st.len:st.pos+ot,lt=new et.RPC.ControlMessage;st.pos<at;){var ct=st.uint32();switch(ct>>>3){case 1:lt.ihave&&lt.ihave.length||(lt.ihave=[]),lt.ihave.push(et.RPC.ControlIHave.decode(st,st.uint32()));break;case 2:lt.iwant&&lt.iwant.length||(lt.iwant=[]),lt.iwant.push(et.RPC.ControlIWant.decode(st,st.uint32()));break;case 3:lt.graft&&lt.graft.length||(lt.graft=[]),lt.graft.push(et.RPC.ControlGraft.decode(st,st.uint32()));break;case 4:lt.prune&&lt.prune.length||(lt.prune=[]),lt.prune.push(et.RPC.ControlPrune.decode(st,st.uint32()));break;default:st.skipType(ct&7);break}}return lt},nt.fromObject=function(st){if(st instanceof et.RPC.ControlMessage)return st;var ot=new et.RPC.ControlMessage;if(st.ihave){if(!Array.isArray(st.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");ot.ihave=[];for(var at=0;at<st.ihave.length;++at){if(typeof st.ihave[at]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");ot.ihave[at]=et.RPC.ControlIHave.fromObject(st.ihave[at])}}if(st.iwant){if(!Array.isArray(st.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");ot.iwant=[];for(var at=0;at<st.iwant.length;++at){if(typeof st.iwant[at]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");ot.iwant[at]=et.RPC.ControlIWant.fromObject(st.iwant[at])}}if(st.graft){if(!Array.isArray(st.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");ot.graft=[];for(var at=0;at<st.graft.length;++at){if(typeof st.graft[at]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");ot.graft[at]=et.RPC.ControlGraft.fromObject(st.graft[at])}}if(st.prune){if(!Array.isArray(st.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");ot.prune=[];for(var at=0;at<st.prune.length;++at){if(typeof st.prune[at]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");ot.prune[at]=et.RPC.ControlPrune.fromObject(st.prune[at])}}return ot},nt.toObject=function(st,ot){ot||(ot={});var at={};if((ot.arrays||ot.defaults)&&(at.ihave=[],at.iwant=[],at.graft=[],at.prune=[]),st.ihave&&st.ihave.length){at.ihave=[];for(var lt=0;lt<st.ihave.length;++lt)at.ihave[lt]=et.RPC.ControlIHave.toObject(st.ihave[lt],ot)}if(st.iwant&&st.iwant.length){at.iwant=[];for(var lt=0;lt<st.iwant.length;++lt)at.iwant[lt]=et.RPC.ControlIWant.toObject(st.iwant[lt],ot)}if(st.graft&&st.graft.length){at.graft=[];for(var lt=0;lt<st.graft.length;++lt)at.graft[lt]=et.RPC.ControlGraft.toObject(st.graft[lt],ot)}if(st.prune&&st.prune.length){at.prune=[];for(var lt=0;lt<st.prune.length;++lt)at.prune[lt]=et.RPC.ControlPrune.toObject(st.prune[lt],ot)}return at},nt.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},nt}(),tt.ControlIHave=function(){function nt(st){if(this.messageIDs=[],st)for(var ot=Object.keys(st),at=0;at<ot.length;++at)st[ot[at]]!=null&&(this[ot[at]]=st[ot[at]])}nt.prototype.topicID=null,nt.prototype.messageIDs=_e.emptyArray;var it;return Object.defineProperty(nt.prototype,"_topicID",{get:_e.oneOfGetter(it=["topicID"]),set:_e.oneOfSetter(it)}),nt.encode=function(ot,at){if(at||(at=j.create()),ot.topicID!=null&&Object.hasOwnProperty.call(ot,"topicID")&&at.uint32(10).string(ot.topicID),ot.messageIDs!=null&&ot.messageIDs.length)for(var lt=0;lt<ot.messageIDs.length;++lt)at.uint32(18).bytes(ot.messageIDs[lt]);return at},nt.decode=function(ot,at){ot instanceof $||(ot=$.create(ot));for(var lt=at===void 0?ot.len:ot.pos+at,ct=new et.RPC.ControlIHave;ot.pos<lt;){var ut=ot.uint32();switch(ut>>>3){case 1:ct.topicID=ot.string();break;case 2:ct.messageIDs&&ct.messageIDs.length||(ct.messageIDs=[]),ct.messageIDs.push(ot.bytes());break;default:ot.skipType(ut&7);break}}return ct},nt.fromObject=function(ot){if(ot instanceof et.RPC.ControlIHave)return ot;var at=new et.RPC.ControlIHave;if(ot.topicID!=null&&(at.topicID=String(ot.topicID)),ot.messageIDs){if(!Array.isArray(ot.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");at.messageIDs=[];for(var lt=0;lt<ot.messageIDs.length;++lt)typeof ot.messageIDs[lt]=="string"?_e.base64.decode(ot.messageIDs[lt],at.messageIDs[lt]=_e.newBuffer(_e.base64.length(ot.messageIDs[lt])),0):ot.messageIDs[lt].length&&(at.messageIDs[lt]=ot.messageIDs[lt])}return at},nt.toObject=function(ot,at){at||(at={});var lt={};if((at.arrays||at.defaults)&&(lt.messageIDs=[]),ot.topicID!=null&&ot.hasOwnProperty("topicID")&&(lt.topicID=ot.topicID,at.oneofs&&(lt._topicID="topicID")),ot.messageIDs&&ot.messageIDs.length){lt.messageIDs=[];for(var ct=0;ct<ot.messageIDs.length;++ct)lt.messageIDs[ct]=at.bytes===String?_e.base64.encode(ot.messageIDs[ct],0,ot.messageIDs[ct].length):at.bytes===Array?Array.prototype.slice.call(ot.messageIDs[ct]):ot.messageIDs[ct]}return lt},nt.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},nt}(),tt.ControlIWant=function(){function nt(it){if(this.messageIDs=[],it)for(var st=Object.keys(it),ot=0;ot<st.length;++ot)it[st[ot]]!=null&&(this[st[ot]]=it[st[ot]])}return nt.prototype.messageIDs=_e.emptyArray,nt.encode=function(st,ot){if(ot||(ot=j.create()),st.messageIDs!=null&&st.messageIDs.length)for(var at=0;at<st.messageIDs.length;++at)ot.uint32(10).bytes(st.messageIDs[at]);return ot},nt.decode=function(st,ot){st instanceof $||(st=$.create(st));for(var at=ot===void 0?st.len:st.pos+ot,lt=new et.RPC.ControlIWant;st.pos<at;){var ct=st.uint32();switch(ct>>>3){case 1:lt.messageIDs&&lt.messageIDs.length||(lt.messageIDs=[]),lt.messageIDs.push(st.bytes());break;default:st.skipType(ct&7);break}}return lt},nt.fromObject=function(st){if(st instanceof et.RPC.ControlIWant)return st;var ot=new et.RPC.ControlIWant;if(st.messageIDs){if(!Array.isArray(st.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");ot.messageIDs=[];for(var at=0;at<st.messageIDs.length;++at)typeof st.messageIDs[at]=="string"?_e.base64.decode(st.messageIDs[at],ot.messageIDs[at]=_e.newBuffer(_e.base64.length(st.messageIDs[at])),0):st.messageIDs[at].length&&(ot.messageIDs[at]=st.messageIDs[at])}return ot},nt.toObject=function(st,ot){ot||(ot={});var at={};if((ot.arrays||ot.defaults)&&(at.messageIDs=[]),st.messageIDs&&st.messageIDs.length){at.messageIDs=[];for(var lt=0;lt<st.messageIDs.length;++lt)at.messageIDs[lt]=ot.bytes===String?_e.base64.encode(st.messageIDs[lt],0,st.messageIDs[lt].length):ot.bytes===Array?Array.prototype.slice.call(st.messageIDs[lt]):st.messageIDs[lt]}return at},nt.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},nt}(),tt.ControlGraft=function(){function nt(st){if(st)for(var ot=Object.keys(st),at=0;at<ot.length;++at)st[ot[at]]!=null&&(this[ot[at]]=st[ot[at]])}nt.prototype.topicID=null;var it;return Object.defineProperty(nt.prototype,"_topicID",{get:_e.oneOfGetter(it=["topicID"]),set:_e.oneOfSetter(it)}),nt.encode=function(ot,at){return at||(at=j.create()),ot.topicID!=null&&Object.hasOwnProperty.call(ot,"topicID")&&at.uint32(10).string(ot.topicID),at},nt.decode=function(ot,at){ot instanceof $||(ot=$.create(ot));for(var lt=at===void 0?ot.len:ot.pos+at,ct=new et.RPC.ControlGraft;ot.pos<lt;){var ut=ot.uint32();switch(ut>>>3){case 1:ct.topicID=ot.string();break;default:ot.skipType(ut&7);break}}return ct},nt.fromObject=function(ot){if(ot instanceof et.RPC.ControlGraft)return ot;var at=new et.RPC.ControlGraft;return ot.topicID!=null&&(at.topicID=String(ot.topicID)),at},nt.toObject=function(ot,at){at||(at={});var lt={};return ot.topicID!=null&&ot.hasOwnProperty("topicID")&&(lt.topicID=ot.topicID,at.oneofs&&(lt._topicID="topicID")),lt},nt.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},nt}(),tt.ControlPrune=function(){function nt(st){if(this.peers=[],st)for(var ot=Object.keys(st),at=0;at<ot.length;++at)st[ot[at]]!=null&&(this[ot[at]]=st[ot[at]])}nt.prototype.topicID=null,nt.prototype.peers=_e.emptyArray,nt.prototype.backoff=null;var it;return Object.defineProperty(nt.prototype,"_topicID",{get:_e.oneOfGetter(it=["topicID"]),set:_e.oneOfSetter(it)}),Object.defineProperty(nt.prototype,"_backoff",{get:_e.oneOfGetter(it=["backoff"]),set:_e.oneOfSetter(it)}),nt.encode=function(ot,at){if(at||(at=j.create()),ot.topicID!=null&&Object.hasOwnProperty.call(ot,"topicID")&&at.uint32(10).string(ot.topicID),ot.peers!=null&&ot.peers.length)for(var lt=0;lt<ot.peers.length;++lt)et.RPC.PeerInfo.encode(ot.peers[lt],at.uint32(18).fork()).ldelim();return ot.backoff!=null&&Object.hasOwnProperty.call(ot,"backoff")&&at.uint32(24).uint64(ot.backoff),at},nt.decode=function(ot,at){ot instanceof $||(ot=$.create(ot));for(var lt=at===void 0?ot.len:ot.pos+at,ct=new et.RPC.ControlPrune;ot.pos<lt;){var ut=ot.uint32();switch(ut>>>3){case 1:ct.topicID=ot.string();break;case 2:ct.peers&&ct.peers.length||(ct.peers=[]),ct.peers.push(et.RPC.PeerInfo.decode(ot,ot.uint32()));break;case 3:ct.backoff=ot.uint64();break;default:ot.skipType(ut&7);break}}return ct},nt.fromObject=function(ot){if(ot instanceof et.RPC.ControlPrune)return ot;var at=new et.RPC.ControlPrune;if(ot.topicID!=null&&(at.topicID=String(ot.topicID)),ot.peers){if(!Array.isArray(ot.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");at.peers=[];for(var lt=0;lt<ot.peers.length;++lt){if(typeof ot.peers[lt]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");at.peers[lt]=et.RPC.PeerInfo.fromObject(ot.peers[lt])}}return ot.backoff!=null&&(_e.Long?(at.backoff=_e.Long.fromValue(ot.backoff)).unsigned=!0:typeof ot.backoff=="string"?at.backoff=parseInt(ot.backoff,10):typeof ot.backoff=="number"?at.backoff=ot.backoff:typeof ot.backoff=="object"&&(at.backoff=new _e.LongBits(ot.backoff.low>>>0,ot.backoff.high>>>0).toNumber(!0))),at},nt.toObject=function(ot,at){at||(at={});var lt={};if((at.arrays||at.defaults)&&(lt.peers=[]),ot.topicID!=null&&ot.hasOwnProperty("topicID")&&(lt.topicID=ot.topicID,at.oneofs&&(lt._topicID="topicID")),ot.peers&&ot.peers.length){lt.peers=[];for(var ct=0;ct<ot.peers.length;++ct)lt.peers[ct]=et.RPC.PeerInfo.toObject(ot.peers[ct],at)}return ot.backoff!=null&&ot.hasOwnProperty("backoff")&&(typeof ot.backoff=="number"?lt.backoff=at.longs===String?String(ot.backoff):ot.backoff:lt.backoff=at.longs===String?_e.Long.prototype.toString.call(ot.backoff):at.longs===Number?new _e.LongBits(ot.backoff.low>>>0,ot.backoff.high>>>0).toNumber(!0):ot.backoff,at.oneofs&&(lt._backoff="backoff")),lt},nt.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},nt}(),tt.PeerInfo=function(){function nt(st){if(st)for(var ot=Object.keys(st),at=0;at<ot.length;++at)st[ot[at]]!=null&&(this[ot[at]]=st[ot[at]])}nt.prototype.peerID=null,nt.prototype.signedPeerRecord=null;var it;return Object.defineProperty(nt.prototype,"_peerID",{get:_e.oneOfGetter(it=["peerID"]),set:_e.oneOfSetter(it)}),Object.defineProperty(nt.prototype,"_signedPeerRecord",{get:_e.oneOfGetter(it=["signedPeerRecord"]),set:_e.oneOfSetter(it)}),nt.encode=function(ot,at){return at||(at=j.create()),ot.peerID!=null&&Object.hasOwnProperty.call(ot,"peerID")&&at.uint32(10).bytes(ot.peerID),ot.signedPeerRecord!=null&&Object.hasOwnProperty.call(ot,"signedPeerRecord")&&at.uint32(18).bytes(ot.signedPeerRecord),at},nt.decode=function(ot,at){ot instanceof $||(ot=$.create(ot));for(var lt=at===void 0?ot.len:ot.pos+at,ct=new et.RPC.PeerInfo;ot.pos<lt;){var ut=ot.uint32();switch(ut>>>3){case 1:ct.peerID=ot.bytes();break;case 2:ct.signedPeerRecord=ot.bytes();break;default:ot.skipType(ut&7);break}}return ct},nt.fromObject=function(ot){if(ot instanceof et.RPC.PeerInfo)return ot;var at=new et.RPC.PeerInfo;return ot.peerID!=null&&(typeof ot.peerID=="string"?_e.base64.decode(ot.peerID,at.peerID=_e.newBuffer(_e.base64.length(ot.peerID)),0):ot.peerID.length&&(at.peerID=ot.peerID)),ot.signedPeerRecord!=null&&(typeof ot.signedPeerRecord=="string"?_e.base64.decode(ot.signedPeerRecord,at.signedPeerRecord=_e.newBuffer(_e.base64.length(ot.signedPeerRecord)),0):ot.signedPeerRecord.length&&(at.signedPeerRecord=ot.signedPeerRecord)),at},nt.toObject=function(ot,at){at||(at={});var lt={};return ot.peerID!=null&&ot.hasOwnProperty("peerID")&&(lt.peerID=at.bytes===String?_e.base64.encode(ot.peerID,0,ot.peerID.length):at.bytes===Array?Array.prototype.slice.call(ot.peerID):ot.peerID,at.oneofs&&(lt._peerID="peerID")),ot.signedPeerRecord!=null&&ot.hasOwnProperty("signedPeerRecord")&&(lt.signedPeerRecord=at.bytes===String?_e.base64.encode(ot.signedPeerRecord,0,ot.signedPeerRecord.length):at.bytes===Array?Array.prototype.slice.call(ot.signedPeerRecord):ot.signedPeerRecord,at.oneofs&&(lt._signedPeerRecord="signedPeerRecord")),lt},nt.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},nt}(),tt}(),et})})(rpc$1);const cjs=rpc$1.exports,{RPC:RPC$1}=cjs,second$1=1e3,minute$2=60*second$1,FloodsubID="/floodsub/1.0.0",GossipsubIDv10="/meshsub/1.0.0",GossipsubIDv11="/meshsub/1.1.0",GossipsubD=6,GossipsubDlo=4,GossipsubDhi=12,GossipsubDscore=4,GossipsubDout=2,GossipsubHistoryLength=5,GossipsubHistoryGossip=3,GossipsubDlazy=6,GossipsubGossipFactor=.25,GossipsubGossipRetransmission=3,GossipsubHeartbeatInitialDelay=100,GossipsubHeartbeatInterval=second$1,GossipsubFanoutTTL=minute$2,GossipsubPrunePeers=16,GossipsubPruneBackoff=minute$2,GossipsubPruneBackoffTicks=15,GossipsubDirectConnectTicks=300,GossipsubDirectConnectInitialDelay=second$1,GossipsubOpportunisticGraftTicks=60,GossipsubOpportunisticGraftPeers=2,GossipsubGraftFloodThreshold=10*second$1,GossipsubMaxIHaveLength=5e3,GossipsubMaxIHaveMessages=10,GossipsubIWantFollowupTime=3*second$1,GossipsubSeenTTL=2*minute$2,TimeCacheDuration=120*1e3,ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT",ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE",ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE=0,ACCEPT_FROM_WHITELIST_MAX_MESSAGES=128,ACCEPT_FROM_WHITELIST_DURATION_MS=1e3,DEFAULT_METRIC_MESH_MESSAGE_DELIVERIES_WINDOWS=1e3;function createGossipRpc(_=[],a){return{subscriptions:[],messages:_,control:a?{graft:a.graft||[],prune:a.prune||[],ihave:a.ihave||[],iwant:a.iwant||[]}:void 0}}function shuffle(_){if(_.length<=1)return _;const a=()=>Math.floor(Math.random()*Math.floor(_.length));for(let $=0;$<_.length;$++){const j=a(),_e=_[$];_[$]=_[j],_[j]=_e}return _}function base$1(_,a){if(_.length>=255)throw new TypeError("Alphabet too long");for(var $=new Uint8Array(256),j=0;j<$.length;j++)$[j]=255;for(var _e=0;_e<_.length;_e++){var et=_.charAt(_e),tt=et.charCodeAt(0);if($[tt]!==255)throw new TypeError(et+" is ambiguous");$[tt]=_e}var rt=_.length,nt=_.charAt(0),it=Math.log(rt)/Math.log(256),st=Math.log(256)/Math.log(rt);function ot(ct){if(ct instanceof Uint8Array||(ArrayBuffer.isView(ct)?ct=new Uint8Array(ct.buffer,ct.byteOffset,ct.byteLength):Array.isArray(ct)&&(ct=Uint8Array.from(ct))),!(ct instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(ct.length===0)return"";for(var ut=0,dt=0,ft=0,pt=ct.length;ft!==pt&&ct[ft]===0;)ft++,ut++;for(var yt=(pt-ft)*st+1>>>0,mt=new Uint8Array(yt);ft!==pt;){for(var _t=ct[ft],vt=0,ht=yt-1;(_t!==0||vt<dt)&&ht!==-1;ht--,vt++)_t+=256*mt[ht]>>>0,mt[ht]=_t%rt>>>0,_t=_t/rt>>>0;if(_t!==0)throw new Error("Non-zero carry");dt=vt,ft++}for(var St=yt-dt;St!==yt&&mt[St]===0;)St++;for(var It=nt.repeat(ut);St<yt;++St)It+=_.charAt(mt[St]);return It}function at(ct){if(typeof ct!="string")throw new TypeError("Expected String");if(ct.length===0)return new Uint8Array;var ut=0;if(ct[ut]!==" "){for(var dt=0,ft=0;ct[ut]===nt;)dt++,ut++;for(var pt=(ct.length-ut)*it+1>>>0,yt=new Uint8Array(pt);ct[ut];){var mt=$[ct.charCodeAt(ut)];if(mt===255)return;for(var _t=0,vt=pt-1;(mt!==0||_t<ft)&&vt!==-1;vt--,_t++)mt+=rt*yt[vt]>>>0,yt[vt]=mt%256>>>0,mt=mt/256>>>0;if(mt!==0)throw new Error("Non-zero carry");ft=_t,ut++}if(ct[ut]!==" "){for(var ht=pt-ft;ht!==pt&&yt[ht]===0;)ht++;for(var St=new Uint8Array(dt+(pt-ht)),It=dt;ht!==pt;)St[It++]=yt[ht++];return St}}}function lt(ct){var ut=at(ct);if(ut)return ut;throw new Error(`Non-${a} character`)}return{encode:ot,decodeUnsafe:at,decode:lt}}var src$3=base$1,_brrp__multiformats_scope_baseX$1=src$3;const coerce$1=_=>{if(_ instanceof Uint8Array&&_.constructor.name==="Uint8Array")return _;if(_ instanceof ArrayBuffer)return new Uint8Array(_);if(ArrayBuffer.isView(_))return new Uint8Array(_.buffer,_.byteOffset,_.byteLength);throw new Error("Unknown type, must be binary type")},fromString$3=_=>new TextEncoder().encode(_),toString$3=_=>new TextDecoder().decode(_);class Encoder$3{constructor(a,$,j){this.name=a,this.prefix=$,this.baseEncode=j}encode(a){if(a instanceof Uint8Array)return`${this.prefix}${this.baseEncode(a)}`;throw Error("Unknown type, must be binary type")}}class Decoder$3{constructor(a,$,j){if(this.name=a,this.prefix=$,$.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=$.codePointAt(0),this.baseDecode=j}decode(a){if(typeof a=="string"){if(a.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(a)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(a.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(a){return or$1(this,a)}}class ComposedDecoder$1{constructor(a){this.decoders=a}or(a){return or$1(this,a)}decode(a){const $=a[0],j=this.decoders[$];if(j)return j.decode(a);throw RangeError(`Unable to decode multibase string ${JSON.stringify(a)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const or$1=(_,a)=>new ComposedDecoder$1({..._.decoders||{[_.prefix]:_},...a.decoders||{[a.prefix]:a}});class Codec$1{constructor(a,$,j,_e){this.name=a,this.prefix=$,this.baseEncode=j,this.baseDecode=_e,this.encoder=new Encoder$3(a,$,j),this.decoder=new Decoder$3(a,$,_e)}encode(a){return this.encoder.encode(a)}decode(a){return this.decoder.decode(a)}}const from$3=({name:_,prefix:a,encode:$,decode:j})=>new Codec$1(_,a,$,j),baseX$1=({prefix:_,name:a,alphabet:$})=>{const{encode:j,decode:_e}=_brrp__multiformats_scope_baseX$1($,a);return from$3({prefix:_,name:a,encode:j,decode:et=>coerce$1(_e(et))})},decode$a=(_,a,$,j)=>{const _e={};for(let st=0;st<a.length;++st)_e[a[st]]=st;let et=_.length;for(;_[et-1]==="=";)--et;const tt=new Uint8Array(et*$/8|0);let rt=0,nt=0,it=0;for(let st=0;st<et;++st){const ot=_e[_[st]];if(ot===void 0)throw new SyntaxError(`Non-${j} character`);nt=nt<<$|ot,rt+=$,rt>=8&&(rt-=8,tt[it++]=255&nt>>rt)}if(rt>=$||255&nt<<8-rt)throw new SyntaxError("Unexpected end of data");return tt},encode$d=(_,a,$)=>{const j=a[a.length-1]==="=",_e=(1<<$)-1;let et="",tt=0,rt=0;for(let nt=0;nt<_.length;++nt)for(rt=rt<<8|_[nt],tt+=8;tt>$;)tt-=$,et+=a[_e&rt>>tt];if(tt&&(et+=a[_e&rt<<$-tt]),j)for(;et.length*$&7;)et+="=";return et},rfc4648$1=({name:_,prefix:a,bitsPerChar:$,alphabet:j})=>from$3({prefix:a,name:_,encode(_e){return encode$d(_e,j,$)},decode(_e){return decode$a(_e,j,$,_)}}),identity$5=from$3({prefix:"\0",name:"identity",encode:_=>toString$3(_),decode:_=>fromString$3(_)}),identityBase$1=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$5},Symbol.toStringTag,{value:"Module"})),base2$2=rfc4648$1({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$3=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$2},Symbol.toStringTag,{value:"Module"})),base8$2=rfc4648$1({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$3=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$2},Symbol.toStringTag,{value:"Module"})),base10$2=baseX$1({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$3=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$2},Symbol.toStringTag,{value:"Module"})),base16$2=rfc4648$1({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$1=rfc4648$1({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$3=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$2,base16upper:base16upper$1},Symbol.toStringTag,{value:"Module"})),base32$2=rfc4648$1({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$1=rfc4648$1({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$1=rfc4648$1({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$1=rfc4648$1({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$1=rfc4648$1({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$1=rfc4648$1({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$1=rfc4648$1({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$1=rfc4648$1({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$1=rfc4648$1({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$3=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$2,base32upper:base32upper$1,base32pad:base32pad$1,base32padupper:base32padupper$1,base32hex:base32hex$1,base32hexupper:base32hexupper$1,base32hexpad:base32hexpad$1,base32hexpadupper:base32hexpadupper$1,base32z:base32z$1},Symbol.toStringTag,{value:"Module"})),base36$2=baseX$1({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$1=baseX$1({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$3=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$2,base36upper:base36upper$1},Symbol.toStringTag,{value:"Module"})),base58btc$1=baseX$1({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$1=baseX$1({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$1=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$1,base58flickr:base58flickr$1},Symbol.toStringTag,{value:"Module"})),base64$2=rfc4648$1({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$1=rfc4648$1({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$1=rfc4648$1({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$1=rfc4648$1({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$3=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$2,base64pad:base64pad$1,base64url:base64url$1,base64urlpad:base64urlpad$1},Symbol.toStringTag,{value:"Module"})),alphabet$2=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),alphabetBytesToChars$1=alphabet$2.reduce((_,a,$)=>(_[$]=a,_),[]),alphabetCharsToBytes$1=alphabet$2.reduce((_,a,$)=>(_[a.codePointAt(0)]=$,_),[]);function encode$c(_){return _.reduce((a,$)=>(a+=alphabetBytesToChars$1[$],a),"")}function decode$9(_){const a=[];for(const $ of _){const j=alphabetCharsToBytes$1[$.codePointAt(0)];if(j===void 0)throw new Error(`Non-base256emoji character: ${$}`);a.push(j)}return new Uint8Array(a)}const base256emoji$2=from$3({prefix:"\u{1F680}",name:"base256emoji",encode:encode$c,decode:decode$9}),base256emoji$3=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$2},Symbol.toStringTag,{value:"Module"}));var encode_1$2=encode$b,MSB$4=128,REST$4=127,MSBALL$2=~REST$4,INT$2=Math.pow(2,31);function encode$b(_,a,$){a=a||[],$=$||0;for(var j=$;_>=INT$2;)a[$++]=_&255|MSB$4,_/=128;for(;_&MSBALL$2;)a[$++]=_&255|MSB$4,_>>>=7;return a[$]=_|0,encode$b.bytes=$-j+1,a}var decode$8=read$3,MSB$1$2=128,REST$1$2=127;function read$3(_,j){var $=0,j=j||0,_e=0,et=j,tt,rt=_.length;do{if(et>=rt)throw read$3.bytes=0,new RangeError("Could not decode varint");tt=_[et++],$+=_e<28?(tt&REST$1$2)<<_e:(tt&REST$1$2)*Math.pow(2,_e),_e+=7}while(tt>=MSB$1$2);return read$3.bytes=et-j,$}var N1$2=Math.pow(2,7),N2$2=Math.pow(2,14),N3$2=Math.pow(2,21),N4$2=Math.pow(2,28),N5$2=Math.pow(2,35),N6$2=Math.pow(2,42),N7$2=Math.pow(2,49),N8$2=Math.pow(2,56),N9$2=Math.pow(2,63),length$4=function(_){return _<N1$2?1:_<N2$2?2:_<N3$2?3:_<N4$2?4:_<N5$2?5:_<N6$2?6:_<N7$2?7:_<N8$2?8:_<N9$2?9:10},varint$3={encode:encode_1$2,decode:decode$8,encodingLength:length$4},_brrp_varint$1=varint$3;const encodeTo$1=(_,a,$=0)=>(_brrp_varint$1.encode(_,a,$),a),encodingLength$1=_=>_brrp_varint$1.encodingLength(_),create$5=(_,a)=>{const $=a.byteLength,j=encodingLength$1(_),_e=j+encodingLength$1($),et=new Uint8Array(_e+$);return encodeTo$1(_,et,0),encodeTo$1($,et,j),et.set(a,_e),new Digest$1(_,$,a,et)};class Digest$1{constructor(a,$,j,_e){this.code=a,this.size=$,this.digest=j,this.bytes=_e}}const from$2=({name:_,code:a,encode:$})=>new Hasher$1(_,a,$);class Hasher$1{constructor(a,$,j){this.name=a,this.code=$,this.encode=j}digest(a){if(a instanceof Uint8Array){const $=this.encode(a);return $ instanceof Uint8Array?create$5(this.code,$):$.then(j=>create$5(this.code,j))}else throw Error("Unknown type, must be binary type")}}const sha$1=_=>async a=>new Uint8Array(await crypto.subtle.digest(_,a)),sha256$2=from$2({name:"sha2-256",code:18,encode:sha$1("SHA-256")}),sha512$1=from$2({name:"sha2-512",code:19,encode:sha$1("SHA-512")}),sha2$1=Object.freeze(Object.defineProperty({__proto__:null,sha256:sha256$2,sha512:sha512$1},Symbol.toStringTag,{value:"Module"})),code$1=0,name$2="identity",encode$a=coerce$1,digest$1=_=>create$5(code$1,encode$a(_)),identity$3={code:code$1,name:name$2,encode:encode$a,digest:digest$1},identity$4=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$3},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const bases$1={...identityBase$1,...base2$3,...base8$3,...base10$3,...base16$3,...base32$3,...base36$3,...base58$1,...base64$3,...base256emoji$3};({...sha2$1,...identity$4});function asUint8Array$1(_){return globalThis.Buffer!=null?new Uint8Array(_.buffer,_.byteOffset,_.byteLength):_}function allocUnsafe$4(_=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?asUint8Array$1(globalThis.Buffer.allocUnsafe(_)):new Uint8Array(_)}function createCodec$1(_,a,$,j){return{name:_,prefix:a,encoder:{name:_,prefix:a,encode:$},decoder:{decode:j}}}const string$1=createCodec$1("utf8","u",_=>"u"+new TextDecoder("utf8").decode(_),_=>new TextEncoder().encode(_.substring(1))),ascii$1=createCodec$1("ascii","a",_=>{let a="a";for(let $=0;$<_.length;$++)a+=String.fromCharCode(_[$]);return a},_=>{_=_.substring(1);const a=allocUnsafe$4(_.length);for(let $=0;$<_.length;$++)a[$]=_.charCodeAt($);return a}),BASES$1={utf8:string$1,"utf-8":string$1,hex:bases$1.base16,latin1:ascii$1,ascii:ascii$1,binary:ascii$1,...bases$1};function toString$2(_,a="utf8"){const $=BASES$1[a];if(!$)throw new Error(`Unsupported encoding "${a}"`);return(a==="utf8"||a==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(_.buffer,_.byteOffset,_.byteLength).toString("utf8"):$.encoder.encode(_).substring(1)}function messageIdToString(_){return toString$2(_,"base64")}const StrictSign="StrictSign",StrictNoSign="StrictNoSign";var SignaturePolicy;(function(_){_.StrictSign="StrictSign",_.StrictNoSign="StrictNoSign"})(SignaturePolicy||(SignaturePolicy={}));var PublishConfigType;(function(_){_[_.Signing=0]="Signing",_[_.Anonymous=1]="Anonymous"})(PublishConfigType||(PublishConfigType={}));var MessageAcceptance;(function(_){_.Accept="accept",_.Ignore="ignore",_.Reject="reject"})(MessageAcceptance||(MessageAcceptance={}));var RejectReason;(function(_){_.Error="error",_.Ignore="ignore",_.Reject="reject",_.Blacklisted="blacklisted"})(RejectReason||(RejectReason={}));var ValidateError;(function(_){_.InvalidSignature="invalid_signature",_.InvalidSeqno="invalid_seqno",_.InvalidPeerId="invalid_peerid",_.SignaturePresent="signature_present",_.SeqnoPresent="seqno_present",_.FromPresent="from_present",_.TransformFailed="transform_failed"})(ValidateError||(ValidateError={}));var MessageStatus;(function(_){_.duplicate="duplicate",_.invalid="invalid",_.valid="valid"})(MessageStatus||(MessageStatus={}));function rejectReasonFromAcceptance(_){switch(_){case MessageAcceptance.Ignore:return RejectReason.Ignore;case MessageAcceptance.Reject:return RejectReason.Reject}}async function getPublishConfigFromPeerId(_,a){switch(_){case StrictSign:{if(!a)throw Error("Must provide PeerId");if(a.privateKey==null)throw Error("Cannot sign message, no private key present");if(a.publicKey==null)throw Error("Cannot sign message, no public key present");const $=await unmarshalPrivateKey(a.privateKey);return{type:PublishConfigType.Signing,author:a,key:a.publicKey,privateKey:$}}case StrictNoSign:return{type:PublishConfigType.Anonymous};default:throw new Error(`Unknown signature policy "${_}"`)}}const ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS",defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3},defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function createPeerScoreParams(_={}){return{...defaultPeerScoreParams,..._,topics:_.topics?Object.entries(_.topics).reduce((a,[$,j])=>(a[$]=createTopicScoreParams(j),a),{}):{}}}function createTopicScoreParams(_={}){return{...defaultTopicScoreParams,..._}}function validatePeerScoreParams(_){for(const[a,$]of Object.entries(_.topics))try{validateTopicScoreParams($)}catch(j){throw errCode(new Error(`invalid score parameters for topic ${a}: ${j.message}`),ERR_INVALID_PEER_SCORE_PARAMS)}if(_.topicScoreCap<0)throw errCode(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.appSpecificScore===null||_.appSpecificScore===void 0)throw errCode(new Error("missing application specific score function"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.IPColocationFactorWeight>0)throw errCode(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.IPColocationFactorWeight!==0&&_.IPColocationFactorThreshold<1)throw errCode(new Error("invalid IPColocationFactorThreshold; must be at least 1"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.behaviourPenaltyWeight>0)throw errCode(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.behaviourPenaltyWeight!==0&&(_.behaviourPenaltyDecay<=0||_.behaviourPenaltyDecay>=1))throw errCode(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.decayInterval<1e3)throw errCode(new Error("invalid DecayInterval; must be at least 1s"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.decayToZero<=0||_.decayToZero>=1)throw errCode(new Error("invalid DecayToZero; must be between 0 and 1"),ERR_INVALID_PEER_SCORE_PARAMS)}function validateTopicScoreParams(_){if(_.topicWeight<0)throw errCode(new Error("invalid topic weight; must be >= 0"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.timeInMeshQuantum===0)throw errCode(new Error("invalid TimeInMeshQuantum; must be non zero"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.timeInMeshWeight<0)throw errCode(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.timeInMeshWeight!==0&&_.timeInMeshQuantum<=0)throw errCode(new Error("invalid TimeInMeshQuantum; must be positive"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.timeInMeshWeight!==0&&_.timeInMeshCap<=0)throw errCode(new Error("invalid TimeInMeshCap; must be positive"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.firstMessageDeliveriesWeight<0)throw errCode(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.firstMessageDeliveriesWeight!==0&&(_.firstMessageDeliveriesDecay<=0||_.firstMessageDeliveriesDecay>=1))throw errCode(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.firstMessageDeliveriesWeight!==0&&_.firstMessageDeliveriesCap<=0)throw errCode(new Error("invalid FirstMessageDeliveriesCap; must be positive"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshMessageDeliveriesWeight>0)throw errCode(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshMessageDeliveriesWeight!==0&&(_.meshMessageDeliveriesDecay<=0||_.meshMessageDeliveriesDecay>=1))throw errCode(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshMessageDeliveriesWeight!==0&&_.meshMessageDeliveriesCap<=0)throw errCode(new Error("invalid MeshMessageDeliveriesCap; must be positive"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshMessageDeliveriesWeight!==0&&_.meshMessageDeliveriesThreshold<=0)throw errCode(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshMessageDeliveriesWindow<0)throw errCode(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshMessageDeliveriesWeight!==0&&_.meshMessageDeliveriesActivation<1e3)throw errCode(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshFailurePenaltyWeight>0)throw errCode(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.meshFailurePenaltyWeight!==0&&(_.meshFailurePenaltyDecay<=0||_.meshFailurePenaltyDecay>=1))throw errCode(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.invalidMessageDeliveriesWeight>0)throw errCode(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),ERR_INVALID_PEER_SCORE_PARAMS);if(_.invalidMessageDeliveriesDecay<=0||_.invalidMessageDeliveriesDecay>=1)throw errCode(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),ERR_INVALID_PEER_SCORE_PARAMS)}const defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function createPeerScoreThresholds(_={}){return{...defaultPeerScoreThresholds,..._}}function computeScore(_,a,$,j){let _e=0;Object.entries(a.topics).forEach(([tt,rt])=>{const nt=$.topics[tt];if(nt===void 0)return;let it=0;if(rt.inMesh){let lt=rt.meshTime/nt.timeInMeshQuantum;lt>nt.timeInMeshCap&&(lt=nt.timeInMeshCap),it+=lt*nt.timeInMeshWeight}let st=rt.firstMessageDeliveries;if(st>nt.firstMessageDeliveriesCap&&(st=nt.firstMessageDeliveriesCap),it+=st*nt.firstMessageDeliveriesWeight,rt.meshMessageDeliveriesActive&&rt.meshMessageDeliveries<nt.meshMessageDeliveriesThreshold){const lt=nt.meshMessageDeliveriesThreshold-rt.meshMessageDeliveries,ct=lt*lt;it+=ct*nt.meshMessageDeliveriesWeight}const ot=rt.meshFailurePenalty;it+=ot*nt.meshFailurePenaltyWeight;const at=rt.invalidMessageDeliveries*rt.invalidMessageDeliveries;it+=at*nt.invalidMessageDeliveriesWeight,_e+=it*nt.topicWeight}),$.topicScoreCap>0&&_e>$.topicScoreCap&&(_e=$.topicScoreCap);const et=$.appSpecificScore(_);if(_e+=et*$.appSpecificWeight,a.ips.forEach(tt=>{if($.IPColocationFactorWhitelist.has(tt))return;const rt=j.get(tt),nt=rt?rt.size:0;if(nt>$.IPColocationFactorThreshold){const it=nt-$.IPColocationFactorThreshold,st=it*it;_e+=st*$.IPColocationFactorWeight}}),a.behaviourPenalty>$.behaviourPenaltyThreshold){const tt=a.behaviourPenalty-$.behaviourPenaltyThreshold,rt=tt*tt;_e+=rt*$.behaviourPenaltyWeight}return _e}function Denque(_,$){var $=$||{};this._head=0,this._tail=0,this._capacity=$.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(_)&&this._fromArray(_)}Denque.prototype.peekAt=function _(a){var $=a;if($===($|0)){var j=this.size();if(!($>=j||$<-j))return $<0&&($+=j),$=this._head+$&this._capacityMask,this._list[$]}};Denque.prototype.get=function _(a){return this.peekAt(a)};Denque.prototype.peek=function _(){if(this._head!==this._tail)return this._list[this._head]};Denque.prototype.peekFront=function _(){return this.peek()};Denque.prototype.peekBack=function _(){return this.peekAt(-1)};Object.defineProperty(Denque.prototype,"length",{get:function _(){return this.size()}});Denque.prototype.size=function _(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Denque.prototype.unshift=function _(a){if(a===void 0)return this.size();var $=this._list.length;return this._head=this._head-1+$&this._capacityMask,this._list[this._head]=a,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Denque.prototype.shift=function _(){var a=this._head;if(a!==this._tail){var $=this._list[a];return this._list[a]=void 0,this._head=a+1&this._capacityMask,a<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),$}};Denque.prototype.push=function _(a){if(a===void 0)return this.size();var $=this._tail;return this._list[$]=a,this._tail=$+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Denque.prototype.pop=function _(){var a=this._tail;if(a!==this._head){var $=this._list.length;this._tail=a-1+$&this._capacityMask;var j=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&a>1e4&&a<=$>>>2&&this._shrinkArray(),j}};Denque.prototype.removeOne=function _(a){var $=a;if($===($|0)&&this._head!==this._tail){var j=this.size(),_e=this._list.length;if(!($>=j||$<-j)){$<0&&($+=j),$=this._head+$&this._capacityMask;var et=this._list[$],tt;if(a<j/2){for(tt=a;tt>0;tt--)this._list[$]=this._list[$=$-1+_e&this._capacityMask];this._list[$]=void 0,this._head=this._head+1+_e&this._capacityMask}else{for(tt=j-1-a;tt>0;tt--)this._list[$]=this._list[$=$+1+_e&this._capacityMask];this._list[$]=void 0,this._tail=this._tail-1+_e&this._capacityMask}return et}}};Denque.prototype.remove=function _(a,$){var j=a,_e,et=$;if(j===(j|0)&&this._head!==this._tail){var tt=this.size(),rt=this._list.length;if(!(j>=tt||j<-tt||$<1)){if(j<0&&(j+=tt),$===1||!$)return _e=new Array(1),_e[0]=this.removeOne(j),_e;if(j===0&&j+$>=tt)return _e=this.toArray(),this.clear(),_e;j+$>tt&&($=tt-j);var nt;for(_e=new Array($),nt=0;nt<$;nt++)_e[nt]=this._list[this._head+j+nt&this._capacityMask];if(j=this._head+j&this._capacityMask,a+$===tt){for(this._tail=this._tail-$+rt&this._capacityMask,nt=$;nt>0;nt--)this._list[j=j+1+rt&this._capacityMask]=void 0;return _e}if(a===0){for(this._head=this._head+$+rt&this._capacityMask,nt=$-1;nt>0;nt--)this._list[j=j+1+rt&this._capacityMask]=void 0;return _e}if(j<tt/2){for(this._head=this._head+a+$+rt&this._capacityMask,nt=a;nt>0;nt--)this.unshift(this._list[j=j-1+rt&this._capacityMask]);for(j=this._head-1+rt&this._capacityMask;et>0;)this._list[j=j-1+rt&this._capacityMask]=void 0,et--;a<0&&(this._tail=j)}else{for(this._tail=j,j=j+$+rt&this._capacityMask,nt=tt-($+a);nt>0;nt--)this.push(this._list[j++]);for(j=this._tail;et>0;)this._list[j=j+1+rt&this._capacityMask]=void 0,et--}return this._head<2&&this._tail>1e4&&this._tail<=rt>>>2&&this._shrinkArray(),_e}}};Denque.prototype.splice=function _(a,$){var j=a;if(j===(j|0)){var _e=this.size();if(j<0&&(j+=_e),!(j>_e))if(arguments.length>2){var et,tt,rt,nt=arguments.length,it=this._list.length,st=2;if(!_e||j<_e/2){for(tt=new Array(j),et=0;et<j;et++)tt[et]=this._list[this._head+et&this._capacityMask];for($===0?(rt=[],j>0&&(this._head=this._head+j+it&this._capacityMask)):(rt=this.remove(j,$),this._head=this._head+j+it&this._capacityMask);nt>st;)this.unshift(arguments[--nt]);for(et=j;et>0;et--)this.unshift(tt[et-1])}else{tt=new Array(_e-(j+$));var ot=tt.length;for(et=0;et<ot;et++)tt[et]=this._list[this._head+j+$+et&this._capacityMask];for($===0?(rt=[],j!=_e&&(this._tail=this._head+j+it&this._capacityMask)):(rt=this.remove(j,$),this._tail=this._tail-ot+it&this._capacityMask);st<nt;)this.push(arguments[st++]);for(et=0;et<ot;et++)this.push(tt[et])}return rt}else return this.remove(j,$)}};Denque.prototype.clear=function _(){this._head=0,this._tail=0};Denque.prototype.isEmpty=function _(){return this._head===this._tail};Denque.prototype.toArray=function _(){return this._copyArray(!1)};Denque.prototype._fromArray=function _(a){for(var $=0;$<a.length;$++)this.push(a[$])};Denque.prototype._copyArray=function _(a){var $=[],j=this._list,_e=j.length,et;if(a||this._head>this._tail){for(et=this._head;et<_e;et++)$.push(j[et]);for(et=0;et<this._tail;et++)$.push(j[et])}else for(et=this._head;et<this._tail;et++)$.push(j[et]);return $};Denque.prototype._growArray=function _(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};Denque.prototype._shrinkArray=function _(){this._list.length>>>=1,this._capacityMask>>>=1};var denque=Denque,DeliveryRecordStatus;(function(_){_[_.unknown=0]="unknown",_[_.valid=1]="valid",_[_.invalid=2]="invalid",_[_.ignored=3]="ignored"})(DeliveryRecordStatus||(DeliveryRecordStatus={}));class MessageDeliveries{constructor(){this.records=new Map,this.queue=new denque}ensureRecord(a){let $=this.records.get(a);if($)return $;$={status:DeliveryRecordStatus.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(a,$);const j={msgId:a,expire:Date.now()+TimeCacheDuration};return this.queue.push(j),$}gc(){const a=Date.now();let $=this.queue.peekFront();for(;$&&$.expire<a;)this.records.delete($.msgId),this.queue.shift(),$=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}}function isStartable(_){return _!=null&&typeof _.start=="function"&&typeof _.stop=="function"}function isInitializable(_){return _!=null&&typeof _.init=="function"}class Components{constructor(a={}){this.started=!1,a.peerId!=null&&this.setPeerId(a.peerId),a.addressManager!=null&&this.setAddressManager(a.addressManager),a.peerStore!=null&&this.setPeerStore(a.peerStore),a.upgrader!=null&&this.setUpgrader(a.upgrader),a.metrics!=null&&this.setMetrics(a.metrics),a.registrar!=null&&this.setRegistrar(a.registrar),a.connectionManager!=null&&this.setConnectionManager(a.connectionManager),a.transportManager!=null&&this.setTransportManager(a.transportManager),a.connectionGater!=null&&this.setConnectionGater(a.connectionGater),a.contentRouting!=null&&this.setContentRouting(a.contentRouting),a.peerRouting!=null&&this.setPeerRouting(a.peerRouting),a.datastore!=null&&this.setDatastore(a.datastore),a.connectionProtector!=null&&this.setConnectionProtector(a.connectionProtector),a.dht!=null&&this.setDHT(a.dht),a.pubsub!=null&&this.setPubSub(a.pubsub),a.dialer!=null&&this.setDialer(a.dialer)}isStarted(){return this.started}async beforeStart(){await Promise.all(Object.values(this).filter(a=>isStartable(a)).map(async a=>{a.beforeStart!=null&&await a.beforeStart()}))}async start(){await Promise.all(Object.values(this).filter(a=>isStartable(a)).map(async a=>{await a.start()})),this.started=!0}async afterStart(){await Promise.all(Object.values(this).filter(a=>isStartable(a)).map(async a=>{a.afterStart!=null&&await a.afterStart()}))}async beforeStop(){await Promise.all(Object.values(this).filter(a=>isStartable(a)).map(async a=>{a.beforeStop!=null&&await a.beforeStop()}))}async stop(){await Promise.all(Object.values(this).filter(a=>isStartable(a)).map(async a=>{await a.stop()})),this.started=!1}async afterStop(){await Promise.all(Object.values(this).filter(a=>isStartable(a)).map(async a=>{a.afterStop!=null&&await a.afterStop()}))}setPeerId(a){return this.peerId=a,a}getPeerId(){if(this.peerId==null)throw errCode(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this.peerId}setMetrics(a){return this.metrics=a,isInitializable(a)&&a.init(this),a}getMetrics(){return this.metrics}setAddressManager(a){return this.addressManager=a,isInitializable(a)&&a.init(this),a}getAddressManager(){if(this.addressManager==null)throw errCode(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this.addressManager}setPeerStore(a){return this.peerStore=a,isInitializable(a)&&a.init(this),a}getPeerStore(){if(this.peerStore==null)throw errCode(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this.peerStore}setUpgrader(a){return this.upgrader=a,isInitializable(a)&&a.init(this),a}getUpgrader(){if(this.upgrader==null)throw errCode(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this.upgrader}setRegistrar(a){return this.registrar=a,isInitializable(a)&&a.init(this),a}getRegistrar(){if(this.registrar==null)throw errCode(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this.registrar}setConnectionManager(a){return this.connectionManager=a,isInitializable(a)&&a.init(this),a}getConnectionManager(){if(this.connectionManager==null)throw errCode(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this.connectionManager}setTransportManager(a){return this.transportManager=a,isInitializable(a)&&a.init(this),a}getTransportManager(){if(this.transportManager==null)throw errCode(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this.transportManager}setConnectionGater(a){return this.connectionGater=a,isInitializable(a)&&a.init(this),a}getConnectionGater(){if(this.connectionGater==null)throw errCode(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this.connectionGater}setContentRouting(a){return this.contentRouting=a,isInitializable(a)&&a.init(this),a}getContentRouting(){if(this.contentRouting==null)throw errCode(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this.contentRouting}setPeerRouting(a){return this.peerRouting=a,isInitializable(a)&&a.init(this),a}getPeerRouting(){if(this.peerRouting==null)throw errCode(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this.peerRouting}setDatastore(a){return this.datastore=a,isInitializable(a)&&a.init(this),a}getDatastore(){if(this.datastore==null)throw errCode(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this.datastore}setConnectionProtector(a){return this.connectionProtector=a,isInitializable(a)&&a.init(this),a}getConnectionProtector(){return this.connectionProtector}setDHT(a){return this.dht=a,isInitializable(a)&&a.init(this),a}getDHT(){if(this.dht==null)throw errCode(new Error("dht not set"),"ERR_SERVICE_MISSING");return this.dht}setPubSub(a){return this.pubsub=a,isInitializable(a)&&a.init(this),a}getPubSub(){if(this.pubsub==null)throw errCode(new Error("pubsub not set"),"ERR_SERVICE_MISSING");return this.pubsub}setDialer(a){return this.dialer=a,isInitializable(a)&&a.init(this),a}getDialer(){if(this.dialer==null)throw errCode(new Error("dialer not set"),"ERR_SERVICE_MISSING");return this.dialer}}const log$X=logger$1("libp2p:gossipsub:score");class PeerScore{constructor(a,$,j){this.params=a,this.metrics=$,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new MessageDeliveries,this.components=new Components,validatePeerScoreParams(a),this.scoreCacheValidityMs=j.scoreCacheValidityMs,this.computeScore=j.computeScore??computeScore}init(a){this.components=a}get size(){return this.peerStats.size}start(){if(this._backgroundInterval){log$X("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),log$X("started")}stop(){if(!this._backgroundInterval){log$X("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),log$X("stopped")}background(){this.refreshScores(),this.updateIPs(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([a,$])=>[a,$]))}refreshScores(){const a=Date.now(),$=this.params.decayToZero;this.peerStats.forEach((j,_e)=>{if(!j.connected){a>j.expire&&(this.removeIPs(_e,j.ips),this.peerStats.delete(_e),this.scoreCache.delete(_e));return}Object.entries(j.topics).forEach(([et,tt])=>{const rt=this.params.topics[et];rt!==void 0&&(tt.firstMessageDeliveries*=rt.firstMessageDeliveriesDecay,tt.firstMessageDeliveries<$&&(tt.firstMessageDeliveries=0),tt.meshMessageDeliveries*=rt.meshMessageDeliveriesDecay,tt.meshMessageDeliveries<$&&(tt.meshMessageDeliveries=0),tt.meshFailurePenalty*=rt.meshFailurePenaltyDecay,tt.meshFailurePenalty<$&&(tt.meshFailurePenalty=0),tt.invalidMessageDeliveries*=rt.invalidMessageDeliveriesDecay,tt.invalidMessageDeliveries<$&&(tt.invalidMessageDeliveries=0),tt.inMesh&&(tt.meshTime=a-tt.graftTime,tt.meshTime>rt.meshMessageDeliveriesActivation&&(tt.meshMessageDeliveriesActive=!0)))}),j.behaviourPenalty*=this.params.behaviourPenaltyDecay,j.behaviourPenalty<$&&(j.behaviourPenalty=0)})}score(a){this.metrics?.scoreFnCalls.inc();const $=this.peerStats.get(a);if(!$)return 0;const j=Date.now(),_e=this.scoreCache.get(a);if(_e&&_e.cacheUntil>j)return _e.score;this.metrics?.scoreFnRuns.inc();const et=this.computeScore(a,$,this.params,this.peerIPs),tt=j+this.scoreCacheValidityMs;return _e?(this.metrics?.scoreCachedDelta.observe(Math.abs(et-_e.score)),_e.score=et,_e.cacheUntil=tt):this.scoreCache.set(a,{score:et,cacheUntil:tt}),et}addPenalty(a,$,j){const _e=this.peerStats.get(a);_e&&(_e.behaviourPenalty+=$,this.metrics?.onScorePenalty(j))}addPeer(a){const $={connected:!0,expire:0,topics:{},ips:[],behaviourPenalty:0};this.peerStats.set(a,$);const j=this.getIPs(a);this.setIPs(a,j,$.ips),$.ips=j}removePeer(a){const $=this.peerStats.get(a);if(!!$){if(this.score(a)>0){this.removeIPs(a,$.ips),this.peerStats.delete(a);return}Object.entries($.topics).forEach(([j,_e])=>{_e.firstMessageDeliveries=0;const et=this.params.topics[j].meshMessageDeliveriesThreshold;if(_e.inMesh&&_e.meshMessageDeliveriesActive&&_e.meshMessageDeliveries<et){const tt=et-_e.meshMessageDeliveries;_e.meshFailurePenalty+=tt*tt}_e.inMesh=!1,_e.meshMessageDeliveriesActive=!1}),$.connected=!1,$.expire=Date.now()+this.params.retainScore}}graft(a,$){const j=this.peerStats.get(a);if(j){const _e=this.getPtopicStats(j,$);_e&&(_e.inMesh=!0,_e.graftTime=Date.now(),_e.meshTime=0,_e.meshMessageDeliveriesActive=!1)}}prune(a,$){const j=this.peerStats.get(a);if(j){const _e=this.getPtopicStats(j,$);if(_e){const et=this.params.topics[$].meshMessageDeliveriesThreshold;if(_e.meshMessageDeliveriesActive&&_e.meshMessageDeliveries<et){const tt=et-_e.meshMessageDeliveries;_e.meshFailurePenalty+=tt*tt}_e.meshMessageDeliveriesActive=!1,_e.inMesh=!1}}}validateMessage(a){this.deliveryRecords.ensureRecord(a)}deliverMessage(a,$,j){this.markFirstMessageDelivery(a,j);const _e=this.deliveryRecords.ensureRecord($),et=Date.now();if(_e.status!==DeliveryRecordStatus.unknown){log$X("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",a,et-_e.firstSeen,DeliveryRecordStatus[_e.status]);return}_e.status=DeliveryRecordStatus.valid,_e.validated=et,_e.peers.forEach(tt=>{tt!==a.toString()&&this.markDuplicateMessageDelivery(tt,j)})}rejectInvalidMessage(a,$){this.markInvalidMessageDelivery(a,$)}rejectMessage(a,$,j,_e){switch(_e){case RejectReason.Error:this.markInvalidMessageDelivery(a,j);return;case RejectReason.Blacklisted:return}const et=this.deliveryRecords.ensureRecord($);if(et.status!==DeliveryRecordStatus.unknown){log$X("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",a,Date.now()-et.firstSeen,DeliveryRecordStatus[et.status]);return}if(_e===RejectReason.Ignore){et.status=DeliveryRecordStatus.ignored,et.peers.clear();return}et.status=DeliveryRecordStatus.invalid,this.markInvalidMessageDelivery(a,j),et.peers.forEach(tt=>{this.markInvalidMessageDelivery(tt,j)}),et.peers.clear()}duplicateMessage(a,$,j){const _e=this.deliveryRecords.ensureRecord($);if(!_e.peers.has(a))switch(_e.status){case DeliveryRecordStatus.unknown:_e.peers.add(a);break;case DeliveryRecordStatus.valid:_e.peers.add(a),this.markDuplicateMessageDelivery(a,j,_e.validated);break;case DeliveryRecordStatus.invalid:this.markInvalidMessageDelivery(a,j);break;case DeliveryRecordStatus.ignored:break}}markInvalidMessageDelivery(a,$){const j=this.peerStats.get(a);if(j){const _e=this.getPtopicStats(j,$);_e&&(_e.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(a,$){const j=this.peerStats.get(a);if(j){const _e=this.getPtopicStats(j,$);if(_e){let et=this.params.topics[$].firstMessageDeliveriesCap;_e.firstMessageDeliveries=Math.min(et,_e.firstMessageDeliveries+1),_e.inMesh&&(et=this.params.topics[$].meshMessageDeliveriesCap,_e.meshMessageDeliveries=Math.min(et,_e.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(a,$,j){const _e=this.peerStats.get(a);if(_e){const et=j!==void 0?Date.now():0,tt=this.getPtopicStats(_e,$);if(tt&&tt.inMesh){const rt=this.params.topics[$];if(j!==void 0){const it=et-j,st=it>rt.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery($,it,st),st)return}const nt=rt.meshMessageDeliveriesCap;tt.meshMessageDeliveries=Math.min(nt,tt.meshMessageDeliveries+1)}}}getIPs(a){return this.components.getConnectionManager().getConnections(peerIdFromString(a)).map($=>$.remoteAddr.toOptions().host)}setIPs(a,$,j){e:for(const _e of $){for(const tt of j)if(_e===tt)continue e;let et=this.peerIPs.get(_e);et||(et=new Set,this.peerIPs.set(_e,et)),et.add(a)}e:for(const _e of j){for(const tt of $)if(_e===tt)continue e;const et=this.peerIPs.get(_e);!et||(et.delete(a),et.size||this.peerIPs.delete(_e))}}removeIPs(a,$){$.forEach(j=>{const _e=this.peerIPs.get(j);!_e||(_e.delete(a),_e.size||this.peerIPs.delete(j))})}updateIPs(){this.peerStats.forEach((a,$)=>{const j=this.getIPs($);this.setIPs($,j,a.ips),a.ips=j})}getPtopicStats(a,$){let j=a.topics[$];return j!==void 0?j:this.params.topics[$]!==void 0?(j={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},a.topics[$]=j,j):null}}class IWantTracer{constructor(a,$,j){this.gossipsubIWantFollowupMs=a,this.msgIdToStrFn=$,this.metrics=j,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*a}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(a,$){const j=Math.floor(Math.random()*$.length),_e=$[j],et=this.msgIdToStrFn(_e);let tt=this.promises.get(et);tt||(tt=new Map,this.promises.set(et,tt));const rt=Date.now();tt.has(a)||(tt.set(a,rt+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(et)||this.requestMsByMsg.set(et,rt)))}getBrokenPromises(){const a=Date.now(),$=new Map;let j=0;return this.promises.forEach((_e,et)=>{_e.forEach((tt,rt)=>{tt<a&&($.set(rt,($.get(rt)??0)+1),_e.delete(rt),j++)}),_e.size||this.promises.delete(et)}),this.metrics?.iwantPromiseBroken.inc(j),$}deliverMessage(a){this.trackMessage(a);const $=this.promises.get(a);$&&(this.promises.delete(a),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),this.metrics.iwantPromiseResolvedPeers.inc($.size)))}rejectMessage(a,$){switch(this.trackMessage(a),$){case RejectReason.Error:return}this.promises.delete(a)}clear(){this.promises.clear()}prune(){const a=Date.now()-this.requestMsByMsgExpire;for(const[$,j]of this.requestMsByMsg.entries())if(j<a)this.requestMsByMsg.delete($);else break}trackMessage(a){if(this.metrics){const $=this.requestMsByMsg.get(a);$!==void 0&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-$)/1e3),this.requestMsByMsg.delete(a))}}}class SimpleTimeCache{constructor(a){this.entries=new Map,this.validityMs=a.validityMs}get size(){return this.entries.size}put(a,$){this.entries.set(a,{value:$,validUntilMs:Date.now()+this.validityMs})}prune(){const a=Date.now();for(const[$,j]of this.entries.entries())if(j.validUntilMs<a)this.entries.delete($);else break}has(a){return this.entries.has(a)}get(a){const $=this.entries.get(a);return $&&$.validUntilMs>=Date.now()?$.value:void 0}clear(){this.entries.clear()}}var MessageSource;(function(_){_.forward="forward",_.publish="publish"})(MessageSource||(MessageSource={}));var InclusionReason;(function(_){_.Fanout="fanout",_.Random="random",_.Subscribed="subscribed",_.Outbound="outbound",_.NotEnough="not_enough",_.Opportunistic="opportunistic"})(InclusionReason||(InclusionReason={}));var ChurnReason;(function(_){_.Dc="disconnected",_.BadScore="bad_score",_.Prune="prune",_.Unsub="unsubscribed",_.Excess="excess"})(ChurnReason||(ChurnReason={}));var ScorePenalty;(function(_){_.GraftBackoff="graft_backoff",_.BrokenPromise="broken_promise",_.MessageDeficit="message_deficit",_.IPColocation="IP_colocation"})(ScorePenalty||(ScorePenalty={}));var IHaveIgnoreReason;(function(_){_.LowScore="low_score",_.MaxIhave="max_ihave",_.MaxIasked="max_iasked"})(IHaveIgnoreReason||(IHaveIgnoreReason={}));var ScoreThreshold;(function(_){_.graylist="graylist",_.publish="publish",_.gossip="gossip",_.mesh="mesh"})(ScoreThreshold||(ScoreThreshold={}));function getMetrics(_,a,$){return{protocolsEnabled:_.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:_.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:_.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:_.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:_.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:_.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:_.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:_.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:_.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:_.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:_.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:_.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:_.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:_.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:_.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:_.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:_.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:_.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:_.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:_.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:_.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:_.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:_.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:_.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:_.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:_.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:_.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:_.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:_.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:_.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:_.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:_.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:_.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:_.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:_.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:_.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:_.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:_.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:_.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:_.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*$.maxMeshMessageDeliveriesWindowSec,.5*$.maxMeshMessageDeliveriesWindowSec,1*$.maxMeshMessageDeliveriesWindowSec,2*$.maxMeshMessageDeliveriesWindowSec,4*$.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:_.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),scoreFnCalls:_.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:_.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:_.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:_.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:_.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:_.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:_.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:_.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:_.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*$.behaviourPenaltyThreshold,.5*$.behaviourPenaltyThreshold,1*$.behaviourPenaltyThreshold,2*$.behaviourPenaltyThreshold,4*$.behaviourPenaltyThreshold]}),ihaveRcvIgnored:_.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:_.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:_.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:_.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:_.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:_.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:_.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedPeers:_.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:_.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantPromiseDeliveryTime:_.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*$.gossipPromiseExpireSec,1*$.gossipPromiseExpireSec,2*$.gossipPromiseExpireSec,4*$.gossipPromiseExpireSec]}),cacheSize:_.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:_.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),topicStrToLabel:a,toTopic(j){return this.topicStrToLabel.get(j)??j},onJoin(j){this.topicSubscriptionStatus.set({topicStr:j},1),this.meshPeerCounts.set({topicStr:j},0)},onLeave(j){this.topicSubscriptionStatus.set({topicStr:j},0),this.meshPeerCounts.set({topicStr:j},0)},onAddToMesh(j,_e,et){const tt=this.toTopic(j);this.meshPeerInclusionEvents.inc({topic:tt,reason:_e},et)},onRemoveFromMesh(j,_e,et){const tt=this.toTopic(j);this.meshPeerChurnEvents.inc({topic:tt,reason:_e},et)},onReportValidationMcacheHit(j){this.asyncValidationMcacheHit.inc({hit:j?"hit":"miss"})},onReportValidation(j,_e){const et=this.toTopic(j);this.asyncValidationResult.inc({topic:et,acceptance:_e})},onScorePenalty(j){this.scoringPenalties.inc({penalty:j},1)},onIhaveRcv(j,_e,et){const tt=this.toTopic(j);this.ihaveRcvMsgids.inc({topic:tt},_e),this.ihaveRcvNotSeenMsgids.inc({topic:tt},et)},onIwantRcv(j,_e){for(const[et,tt]of j){const rt=this.toTopic(et);this.iwantRcvMsgids.inc({topic:rt},tt)}this.iwantRcvDonthaveMsgids.inc(_e)},onForwardMsg(j,_e){const et=this.toTopic(j);this.msgForwardCount.inc({topic:et},1),this.msgForwardPeers.inc({topic:et},_e)},onPublishMsg(j,_e,et,tt){const rt=this.toTopic(j);this.msgPublishCount.inc({topic:rt},1),this.msgPublishBytes.inc({topic:rt},et*tt),this.msgPublishPeers.inc({topic:rt},et),this.msgPublishPeersByGroup.inc({topic:rt,peerGroup:"direct"},_e.direct),this.msgPublishPeersByGroup.inc({topic:rt,peerGroup:"floodsub"},_e.floodsub),this.msgPublishPeersByGroup.inc({topic:rt,peerGroup:"mesh"},_e.mesh),this.msgPublishPeersByGroup.inc({topic:rt,peerGroup:"fanout"},_e.fanout)},onMsgRecvPreValidation(j){const _e=this.toTopic(j);this.msgReceivedPreValidation.inc({topic:_e},1)},onMsgRecvResult(j,_e){const et=this.toTopic(j);this.msgReceivedStatus.inc({topic:et,status:_e})},onMsgRecvInvalid(j,_e){const et=this.toTopic(j),tt=_e.reason===RejectReason.Error?_e.error:_e.reason;this.msgReceivedInvalid.inc({topic:et,error:tt},1)},onDuplicateMsgDelivery(j,_e,et){if(this.duplicateMsgDeliveryDelay.observe(_e/1e3),et){const tt=this.toTopic(j);this.duplicateMsgLateDelivery.inc({topic:tt},1)}},onRpcRecv(j,_e){this.rpcRecvBytes.inc(_e),this.rpcRecvCount.inc(1),j.subscriptions&&this.rpcRecvSubscription.inc(j.subscriptions.length),j.messages&&this.rpcRecvMessage.inc(j.messages.length),j.control&&(this.rpcRecvControl.inc(1),j.control.ihave&&this.rpcRecvIHave.inc(j.control.ihave.length),j.control.iwant&&this.rpcRecvIWant.inc(j.control.iwant.length),j.control.graft&&this.rpcRecvGraft.inc(j.control.graft.length),j.control.prune&&this.rpcRecvPrune.inc(j.control.prune.length))},onRpcSent(j,_e){if(this.rpcSentBytes.inc(_e),this.rpcSentCount.inc(1),j.subscriptions&&this.rpcSentSubscription.inc(j.subscriptions.length),j.messages&&this.rpcSentMessage.inc(j.messages.length),j.control){const et=j.control.ihave?.length??0,tt=j.control.iwant?.length??0,rt=j.control.graft?.length??0,nt=j.control.prune?.length??0;et>0&&this.rpcSentIHave.inc(et),tt>0&&this.rpcSentIWant.inc(tt),rt>0&&this.rpcSentGraft.inc(rt),nt>0&&this.rpcSentPrune.inc(nt),(et>0||tt>0||rt>0||nt>0)&&this.rpcSentControl.inc(1)}},registerScores(j,_e){let et=0,tt=0,rt=0,nt=0;for(const it of j)it>=_e.graylistThreshold&&et++,it>=_e.publishThreshold&&tt++,it>=_e.gossipThreshold&&rt++,it>=0&&nt++;this.peersByScoreThreshold.set({threshold:ScoreThreshold.graylist},et),this.peersByScoreThreshold.set({threshold:ScoreThreshold.publish},tt),this.peersByScoreThreshold.set({threshold:ScoreThreshold.gossip},rt),this.peersByScoreThreshold.set({threshold:ScoreThreshold.mesh},nt),this.score.set(j)},registerScoreWeights(j){for(const[_e,et]of j.byTopic)this.scoreWeights.set({topic:_e,p:"p1"},et.p1w),this.scoreWeights.set({topic:_e,p:"p2"},et.p2w),this.scoreWeights.set({topic:_e,p:"p3"},et.p3w),this.scoreWeights.set({topic:_e,p:"p3b"},et.p3bw),this.scoreWeights.set({topic:_e,p:"p4"},et.p4w);this.scoreWeights.set({p:"p5"},j.p5w),this.scoreWeights.set({p:"p6"},j.p6w),this.scoreWeights.set({p:"p7"},j.p7w)},registerScorePerMesh(j,_e){const et=new Map;j.forEach((tt,rt)=>{const nt=this.topicStrToLabel.get(rt)??"unknown";let it=et.get(nt);it||(it=new Set,et.set(nt,it)),tt.forEach(st=>it?.add(st))});for(const[tt,rt]of et){const nt=[];rt.forEach(it=>{nt.push(_e.get(it)??0)}),this.scorePerMesh.set({topic:tt},nt)}}}}function concat(_,a){a||(a=_.reduce((_e,et)=>_e+et.length,0));const $=allocUnsafe$4(a);let j=0;for(const _e of _)$.set(_e,j),j+=_e.length;return asUint8Array$1($)}function fromString$2(_,a="utf8"){const $=BASES$1[a];if(!$)throw new Error(`Unsupported encoding "${a}"`);return(a==="utf8"||a==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array$1(globalThis.Buffer.from(_,"utf-8")):$.decoder.decode(`${$.prefix}${_}`)}const hashName={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function pbkdf2(_,a,$,j,_e){if(_e!=="sha1"&&_e!=="sha2-256"&&_e!=="sha2-512"){const rt=Object.keys(hashName).join(" / ");throw errCode(new Error(`Hash '${_e}' is unknown or not supported. Must be ${rt}`),"ERR_UNSUPPORTED_HASH_TYPE")}const et=hashName[_e],tt=pbkdf2$1(_,a,$,j,et);return util$2.exports.encode64(tt,null)}function equals(_,a){if(_===a)return!0;if(_.byteLength!==a.byteLength)return!1;for(let $=0;$<_.byteLength;$++)if(_[$]!==a[$])return!1;return!0}const SignPrefix=fromString$2("libp2p-pubsub:");async function buildRawMessage(_,a,$,j){switch(_.type){case PublishConfigType.Signing:{const _e={from:_.author.toBytes(),data:j,seqno:randomBytes$3(8),topic:a,signature:void 0,key:void 0},et=concat([SignPrefix,RPC$1.Message.encode(_e).finish()]);_e.signature=await _.privateKey.sign(et),_e.key=_.key;const tt={type:"signed",from:_.author,data:$,sequenceNumber:BigInt(`0x${toString$2(_e.seqno,"base16")}`),topic:a,signature:_e.signature,key:_e.key};return{raw:_e,msg:tt}}case PublishConfigType.Anonymous:return{raw:{from:void 0,data:j,seqno:void 0,topic:a,signature:void 0,key:void 0},msg:{type:"unsigned",data:$,topic:a}}}}async function validateToRawMessage(_,a){switch(_){case StrictNoSign:return a.signature!=null?{valid:!1,error:ValidateError.SignaturePresent}:a.seqno!=null?{valid:!1,error:ValidateError.SeqnoPresent}:a.key!=null?{valid:!1,error:ValidateError.FromPresent}:{valid:!0,message:{type:"unsigned",topic:a.topic,data:a.data??new Uint8Array(0)}};case StrictSign:{if(a.seqno==null)return{valid:!1,error:ValidateError.InvalidSeqno};if(a.seqno.length!==8)return{valid:!1,error:ValidateError.InvalidSeqno};if(a.signature==null)return{valid:!1,error:ValidateError.InvalidSignature};if(a.from==null)return{valid:!1,error:ValidateError.InvalidPeerId};let $;try{$=peerIdFromBytes(a.from)}catch{return{valid:!1,error:ValidateError.InvalidPeerId}}let j;if(a.key){if(j=unmarshalPublicKey(a.key),$.publicKey!==void 0&&!equals(j.bytes,$.publicKey))return{valid:!1,error:ValidateError.InvalidPeerId}}else{if($.publicKey==null)return{valid:!1,error:ValidateError.InvalidPeerId};j=unmarshalPublicKey($.publicKey)}const _e={from:a.from,data:a.data,seqno:a.seqno,topic:a.topic,signature:void 0,key:void 0},et=concat([SignPrefix,RPC$1.Message.encode(_e).finish()]);return await j.verify(et,a.signature)?{valid:!0,message:{type:"signed",from:$,data:a.data??new Uint8Array(0),sequenceNumber:BigInt(`0x${toString$2(a.seqno,"base16")}`),topic:a.topic,signature:a.signature,key:a.key??marshalPublicKey(j)}}:{valid:!1,error:ValidateError.InvalidSignature}}}}function base(_,a){if(_.length>=255)throw new TypeError("Alphabet too long");for(var $=new Uint8Array(256),j=0;j<$.length;j++)$[j]=255;for(var _e=0;_e<_.length;_e++){var et=_.charAt(_e),tt=et.charCodeAt(0);if($[tt]!==255)throw new TypeError(et+" is ambiguous");$[tt]=_e}var rt=_.length,nt=_.charAt(0),it=Math.log(rt)/Math.log(256),st=Math.log(256)/Math.log(rt);function ot(ct){if(ct instanceof Uint8Array||(ArrayBuffer.isView(ct)?ct=new Uint8Array(ct.buffer,ct.byteOffset,ct.byteLength):Array.isArray(ct)&&(ct=Uint8Array.from(ct))),!(ct instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(ct.length===0)return"";for(var ut=0,dt=0,ft=0,pt=ct.length;ft!==pt&&ct[ft]===0;)ft++,ut++;for(var yt=(pt-ft)*st+1>>>0,mt=new Uint8Array(yt);ft!==pt;){for(var _t=ct[ft],vt=0,ht=yt-1;(_t!==0||vt<dt)&&ht!==-1;ht--,vt++)_t+=256*mt[ht]>>>0,mt[ht]=_t%rt>>>0,_t=_t/rt>>>0;if(_t!==0)throw new Error("Non-zero carry");dt=vt,ft++}for(var St=yt-dt;St!==yt&&mt[St]===0;)St++;for(var It=nt.repeat(ut);St<yt;++St)It+=_.charAt(mt[St]);return It}function at(ct){if(typeof ct!="string")throw new TypeError("Expected String");if(ct.length===0)return new Uint8Array;var ut=0;if(ct[ut]!==" "){for(var dt=0,ft=0;ct[ut]===nt;)dt++,ut++;for(var pt=(ct.length-ut)*it+1>>>0,yt=new Uint8Array(pt);ct[ut];){var mt=$[ct.charCodeAt(ut)];if(mt===255)return;for(var _t=0,vt=pt-1;(mt!==0||_t<ft)&&vt!==-1;vt--,_t++)mt+=rt*yt[vt]>>>0,yt[vt]=mt%256>>>0,mt=mt/256>>>0;if(mt!==0)throw new Error("Non-zero carry");ft=_t,ut++}if(ct[ut]!==" "){for(var ht=pt-ft;ht!==pt&&yt[ht]===0;)ht++;for(var St=new Uint8Array(dt+(pt-ht)),It=dt;ht!==pt;)St[It++]=yt[ht++];return St}}}function lt(ct){var ut=at(ct);if(ut)return ut;throw new Error(`Non-${a} character`)}return{encode:ot,decodeUnsafe:at,decode:lt}}var src$2=base,_brrp__multiformats_scope_baseX=src$2;const coerce=_=>{if(_ instanceof Uint8Array&&_.constructor.name==="Uint8Array")return _;if(_ instanceof ArrayBuffer)return new Uint8Array(_);if(ArrayBuffer.isView(_))return new Uint8Array(_.buffer,_.byteOffset,_.byteLength);throw new Error("Unknown type, must be binary type")},fromString$1=_=>new TextEncoder().encode(_),toString$1=_=>new TextDecoder().decode(_);class Encoder$2{constructor(a,$,j){this.name=a,this.prefix=$,this.baseEncode=j}encode(a){if(a instanceof Uint8Array)return`${this.prefix}${this.baseEncode(a)}`;throw Error("Unknown type, must be binary type")}}class Decoder$2{constructor(a,$,j){if(this.name=a,this.prefix=$,$.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=$.codePointAt(0),this.baseDecode=j}decode(a){if(typeof a=="string"){if(a.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(a)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(a.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(a){return or(this,a)}}class ComposedDecoder{constructor(a){this.decoders=a}or(a){return or(this,a)}decode(a){const $=a[0],j=this.decoders[$];if(j)return j.decode(a);throw RangeError(`Unable to decode multibase string ${JSON.stringify(a)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const or=(_,a)=>new ComposedDecoder({..._.decoders||{[_.prefix]:_},...a.decoders||{[a.prefix]:a}});class Codec{constructor(a,$,j,_e){this.name=a,this.prefix=$,this.baseEncode=j,this.baseDecode=_e,this.encoder=new Encoder$2(a,$,j),this.decoder=new Decoder$2(a,$,_e)}encode(a){return this.encoder.encode(a)}decode(a){return this.decoder.decode(a)}}const from$1=({name:_,prefix:a,encode:$,decode:j})=>new Codec(_,a,$,j),baseX=({prefix:_,name:a,alphabet:$})=>{const{encode:j,decode:_e}=_brrp__multiformats_scope_baseX($,a);return from$1({prefix:_,name:a,encode:j,decode:et=>coerce(_e(et))})},decode$7=(_,a,$,j)=>{const _e={};for(let st=0;st<a.length;++st)_e[a[st]]=st;let et=_.length;for(;_[et-1]==="=";)--et;const tt=new Uint8Array(et*$/8|0);let rt=0,nt=0,it=0;for(let st=0;st<et;++st){const ot=_e[_[st]];if(ot===void 0)throw new SyntaxError(`Non-${j} character`);nt=nt<<$|ot,rt+=$,rt>=8&&(rt-=8,tt[it++]=255&nt>>rt)}if(rt>=$||255&nt<<8-rt)throw new SyntaxError("Unexpected end of data");return tt},encode$9=(_,a,$)=>{const j=a[a.length-1]==="=",_e=(1<<$)-1;let et="",tt=0,rt=0;for(let nt=0;nt<_.length;++nt)for(rt=rt<<8|_[nt],tt+=8;tt>$;)tt-=$,et+=a[_e&rt>>tt];if(tt&&(et+=a[_e&rt<<$-tt]),j)for(;et.length*$&7;)et+="=";return et},rfc4648=({name:_,prefix:a,bitsPerChar:$,alphabet:j})=>from$1({prefix:a,name:_,encode(_e){return encode$9(_e,j,$)},decode(_e){return decode$7(_e,j,$,_)}}),identity$2=from$1({prefix:"\0",name:"identity",encode:_=>toString$1(_),decode:_=>fromString$1(_)}),identityBase=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$2},Symbol.toStringTag,{value:"Module"})),base2=rfc4648({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$1=Object.freeze(Object.defineProperty({__proto__:null,base2},Symbol.toStringTag,{value:"Module"})),base8=rfc4648({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$1=Object.freeze(Object.defineProperty({__proto__:null,base8},Symbol.toStringTag,{value:"Module"})),base10=baseX({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$1=Object.freeze(Object.defineProperty({__proto__:null,base10},Symbol.toStringTag,{value:"Module"})),base16=rfc4648({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper=rfc4648({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$1=Object.freeze(Object.defineProperty({__proto__:null,base16,base16upper},Symbol.toStringTag,{value:"Module"})),base32=rfc4648({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper=rfc4648({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad=rfc4648({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper=rfc4648({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex=rfc4648({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper=rfc4648({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad=rfc4648({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper=rfc4648({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z=rfc4648({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$1=Object.freeze(Object.defineProperty({__proto__:null,base32,base32upper,base32pad,base32padupper,base32hex,base32hexupper,base32hexpad,base32hexpadupper,base32z},Symbol.toStringTag,{value:"Module"})),base36=baseX({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper=baseX({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$1=Object.freeze(Object.defineProperty({__proto__:null,base36,base36upper},Symbol.toStringTag,{value:"Module"})),base58btc=baseX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr=baseX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58=Object.freeze(Object.defineProperty({__proto__:null,base58btc,base58flickr},Symbol.toStringTag,{value:"Module"})),base64=rfc4648({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad=rfc4648({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url=rfc4648({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad=rfc4648({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$1=Object.freeze(Object.defineProperty({__proto__:null,base64,base64pad,base64url,base64urlpad},Symbol.toStringTag,{value:"Module"})),alphabet$1=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),alphabetBytesToChars=alphabet$1.reduce((_,a,$)=>(_[$]=a,_),[]),alphabetCharsToBytes=alphabet$1.reduce((_,a,$)=>(_[a.codePointAt(0)]=$,_),[]);function encode$8(_){return _.reduce((a,$)=>(a+=alphabetBytesToChars[$],a),"")}function decode$6(_){const a=[];for(const $ of _){const j=alphabetCharsToBytes[$.codePointAt(0)];if(j===void 0)throw new Error(`Non-base256emoji character: ${$}`);a.push(j)}return new Uint8Array(a)}const base256emoji=from$1({prefix:"\u{1F680}",name:"base256emoji",encode:encode$8,decode:decode$6}),base256emoji$1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji},Symbol.toStringTag,{value:"Module"}));var encode_1$1=encode$7,MSB$3=128,REST$3=127,MSBALL$1=~REST$3,INT$1=Math.pow(2,31);function encode$7(_,a,$){a=a||[],$=$||0;for(var j=$;_>=INT$1;)a[$++]=_&255|MSB$3,_/=128;for(;_&MSBALL$1;)a[$++]=_&255|MSB$3,_>>>=7;return a[$]=_|0,encode$7.bytes=$-j+1,a}var decode$5=read$2,MSB$1$1=128,REST$1$1=127;function read$2(_,j){var $=0,j=j||0,_e=0,et=j,tt,rt=_.length;do{if(et>=rt)throw read$2.bytes=0,new RangeError("Could not decode varint");tt=_[et++],$+=_e<28?(tt&REST$1$1)<<_e:(tt&REST$1$1)*Math.pow(2,_e),_e+=7}while(tt>=MSB$1$1);return read$2.bytes=et-j,$}var N1$1=Math.pow(2,7),N2$1=Math.pow(2,14),N3$1=Math.pow(2,21),N4$1=Math.pow(2,28),N5$1=Math.pow(2,35),N6$1=Math.pow(2,42),N7$1=Math.pow(2,49),N8$1=Math.pow(2,56),N9$1=Math.pow(2,63),length$3=function(_){return _<N1$1?1:_<N2$1?2:_<N3$1?3:_<N4$1?4:_<N5$1?5:_<N6$1?6:_<N7$1?7:_<N8$1?8:_<N9$1?9:10},varint$2={encode:encode_1$1,decode:decode$5,encodingLength:length$3},_brrp_varint=varint$2;const encodeTo=(_,a,$=0)=>(_brrp_varint.encode(_,a,$),a),encodingLength=_=>_brrp_varint.encodingLength(_),create$4=(_,a)=>{const $=a.byteLength,j=encodingLength(_),_e=j+encodingLength($),et=new Uint8Array(_e+$);return encodeTo(_,et,0),encodeTo($,et,j),et.set(a,_e),new Digest(_,$,a,et)};class Digest{constructor(a,$,j,_e){this.code=a,this.size=$,this.digest=j,this.bytes=_e}}const from=({name:_,code:a,encode:$})=>new Hasher(_,a,$);class Hasher{constructor(a,$,j){this.name=a,this.code=$,this.encode=j}digest(a){if(a instanceof Uint8Array){const $=this.encode(a);return $ instanceof Uint8Array?create$4(this.code,$):$.then(j=>create$4(this.code,j))}else throw Error("Unknown type, must be binary type")}}const sha=_=>async a=>new Uint8Array(await crypto.subtle.digest(_,a)),sha256$1=from({name:"sha2-256",code:18,encode:sha("SHA-256")}),sha512=from({name:"sha2-512",code:19,encode:sha("SHA-512")}),sha2=Object.freeze(Object.defineProperty({__proto__:null,sha256:sha256$1,sha512},Symbol.toStringTag,{value:"Module"})),code=0,name$1="identity",encode$6=coerce,digest=_=>create$4(code,encode$6(_)),identity={code,name:name$1,encode:encode$6,digest},identity$1=Object.freeze(Object.defineProperty({__proto__:null,identity},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const bases={...identityBase,...base2$1,...base8$1,...base10$1,...base16$1,...base32$1,...base36$1,...base58,...base64$1,...base256emoji$1};({...sha2,...identity$1});function asUint8Array(_){return globalThis.Buffer!=null?new Uint8Array(_.buffer,_.byteOffset,_.byteLength):_}function allocUnsafe$3(_=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?asUint8Array(globalThis.Buffer.allocUnsafe(_)):new Uint8Array(_)}function createCodec(_,a,$,j){return{name:_,prefix:a,encoder:{name:_,prefix:a,encode:$},decoder:{decode:j}}}const string=createCodec("utf8","u",_=>"u"+new TextDecoder("utf8").decode(_),_=>new TextEncoder().encode(_.substring(1))),ascii=createCodec("ascii","a",_=>{let a="a";for(let $=0;$<_.length;$++)a+=String.fromCharCode(_[$]);return a},_=>{_=_.substring(1);const a=allocUnsafe$3(_.length);for(let $=0;$<_.length;$++)a[$]=_.charCodeAt($);return a}),BASES={utf8:string,"utf-8":string,hex:bases.base16,latin1:ascii,ascii,binary:ascii,...bases};function fromString(_,a="utf8"){const $=BASES[a];if(!$)throw new Error(`Unsupported encoding "${a}"`);return(a==="utf8"||a==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array(globalThis.Buffer.from(_,"utf-8")):$.decoder.decode(`${$.prefix}${_}`)}const msgId=(_,a)=>{const $=fromString(a.toString(16).padStart(16,"0"),"base16"),j=new Uint8Array(_.length+$.length);return j.set(_,0),j.set($,_.length),j};function msgIdFnStrictSign(_){if(_.type!=="signed")throw new Error("expected signed message type");if(_.sequenceNumber==null)throw Error("missing seqno field");return msgId(_.from.toBytes(),_.sequenceNumber)}async function msgIdFnStrictNoSign(_){return await sha256$2.encode(_.data)}function computeScoreWeights(_,a,$,j,_e){let et=0;const tt=new Map;if(Object.entries(a.topics).forEach(([at,lt])=>{const ct=_e.get(at)??"unknown",ut=$.topics[at];if(ut===void 0)return;let dt=tt.get(ct);dt||(dt={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},tt.set(ct,dt));let ft=0,pt=0,yt=0,mt=0,_t=0;if(lt.inMesh){const It=Math.max(lt.meshTime/ut.timeInMeshQuantum,ut.timeInMeshCap);ft+=It*ut.timeInMeshWeight}let vt=lt.firstMessageDeliveries;if(vt>ut.firstMessageDeliveriesCap&&(vt=ut.firstMessageDeliveriesCap),pt+=vt*ut.firstMessageDeliveriesWeight,lt.meshMessageDeliveriesActive&&lt.meshMessageDeliveries<ut.meshMessageDeliveriesThreshold){const It=ut.meshMessageDeliveriesThreshold-lt.meshMessageDeliveries,Lt=It*It;yt+=Lt*ut.meshMessageDeliveriesWeight}const ht=lt.meshFailurePenalty;mt+=ht*ut.meshFailurePenaltyWeight;const St=lt.invalidMessageDeliveries*lt.invalidMessageDeliveries;_t+=St*ut.invalidMessageDeliveriesWeight,et+=(ft+pt+yt+mt+_t)*ut.topicWeight,dt.p1w+=ft,dt.p2w+=pt,dt.p3w+=yt,dt.p3bw+=mt,dt.p4w+=_t}),$.topicScoreCap>0&&et>$.topicScoreCap){et=$.topicScoreCap;const at=$.topicScoreCap/et;for(const lt of tt.values())lt.p1w*=at,lt.p2w*=at,lt.p3w*=at,lt.p3bw*=at,lt.p4w*=at}let rt=0,nt=0,it=0;const st=$.appSpecificScore(_);rt+=st*$.appSpecificWeight,a.ips.forEach(at=>{if($.IPColocationFactorWhitelist.has(at))return;const lt=j.get(at),ct=lt?lt.size:0;if(ct>$.IPColocationFactorThreshold){const ut=ct-$.IPColocationFactorThreshold,dt=ut*ut;nt+=dt*$.IPColocationFactorWeight}});const ot=a.behaviourPenalty*a.behaviourPenalty;return it+=ot*$.behaviourPenaltyWeight,et+=rt+nt+it,{byTopic:tt,p5w:rt,p6w:nt,p7w:it,score:et}}function computeAllPeersScoreWeights(_,a,$,j,_e){const et={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(const tt of _){const rt=a.get(tt);if(rt){const nt=computeScoreWeights(tt,rt,$,j,_e);for(const[it,st]of nt.byTopic){let ot=et.byTopic.get(it);ot||(ot={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},et.byTopic.set(it,ot)),ot.p1w.push(st.p1w),ot.p2w.push(st.p2w),ot.p3w.push(st.p3w),ot.p3bw.push(st.p3bw),ot.p4w.push(st.p4w)}et.p5w.push(nt.p5w),et.p6w.push(nt.p6w),et.p7w.push(nt.p7w),et.score.push(nt.score)}else et.p5w.push(0),et.p6w.push(0),et.p7w.push(0),et.score.push(0)}return et}function removeItemsFromSet(_,a,$=()=>!0){const j=new Set;if(a<=0)return j;for(const _e of _){if(j.size>=a)break;$(_e)&&(j.add(_e),_.delete(_e))}return j}function removeFirstNItemsFromSet(_,a){return removeItemsFromSet(_,a,()=>!0)}class AbortError$2 extends Error{constructor(a,$){super(a??"The operation was aborted"),this.type="aborted",this.code=$??"ABORT_ERR"}}function getIterator(_){if(_!=null){if(typeof _[Symbol.iterator]=="function")return _[Symbol.iterator]();if(typeof _[Symbol.asyncIterator]=="function")return _[Symbol.asyncIterator]();if(typeof _.next=="function")return _}throw new Error("argument is not an iterator or iterable")}function abortableSource(_,a,$){const j=$??{},_e=getIterator(_);async function*et(){let tt;const rt=()=>{tt?.()};for(a.addEventListener("abort",rt);;){let nt;try{if(a.aborted){const{abortMessage:st,abortCode:ot}=j;throw new AbortError$2(st,ot)}const it=new Promise((st,ot)=>{tt=()=>{const{abortMessage:at,abortCode:lt}=j;ot(new AbortError$2(at,lt))}});nt=await Promise.race([it,_e.next()]),tt=null}catch(it){a.removeEventListener("abort",rt);const st=it.type==="aborted"&&a.aborted;if(st&&j.onAbort!=null&&await j.onAbort(_),typeof _e.return=="function")try{const ot=_e.return();ot instanceof Promise&&ot.catch(at=>{j.onReturnError!=null&&j.onReturnError(at)})}catch(ot){j.onReturnError!=null&&j.onReturnError(ot)}if(st&&j.returnOnAbort===!0)return;throw it}if(nt.done===!0)break;yield nt.value}a.removeEventListener("abort",rt)}return et()}function abortableSink(_,a,$){return j=>_(abortableSource(j,a,$))}function abortableDuplex(_,a,$){return{sink:abortableSink(_.sink,a,{...$,onAbort:void 0}),source:abortableSource(_.source,a,$)}}function allocUnsafe$2(_){return globalThis?.Buffer?.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(_):new Uint8Array(_)}const defaultEncoder=_=>{const a=unsigned.encodingLength(_),$=allocUnsafe$2(a);return unsigned.encode(_,$),defaultEncoder.bytes=a,$};defaultEncoder.bytes=0;function encode$5(_){_=_??{};const a=_.lengthEncoder??defaultEncoder;return async function*(j){for await(const _e of j){const et=a(_e.byteLength);et instanceof Uint8Array?yield et:yield*et,_e instanceof Uint8Array?yield _e:yield*_e}}}encode$5.single=(_,a)=>{a=a??{};const $=a.lengthEncoder??defaultEncoder;return new Uint8ArrayList($(_.byteLength),_)};const MAX_LENGTH_LENGTH=8,MAX_DATA_LENGTH=1024*1024*4;var ReadMode;(function(_){_[_.LENGTH=0]="LENGTH",_[_.DATA=1]="DATA"})(ReadMode||(ReadMode={}));const defaultDecoder=_=>{const a=unsigned.decode(_);return defaultDecoder.bytes=unsigned.encodingLength(a),a};defaultDecoder.bytes=0;function decode$4(_){return async function*($){const j=new Uint8ArrayList;let _e=ReadMode.LENGTH,et=-1;const tt=_?.lengthDecoder??defaultDecoder,rt=_?.maxLengthLength??MAX_LENGTH_LENGTH,nt=_?.maxDataLength??MAX_DATA_LENGTH;for await(const it of $)for(j.append(it);j.byteLength>0;){if(_e===ReadMode.LENGTH)try{if(et=tt(j),et<0)throw errCode(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(et>nt)throw errCode(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const st=tt.bytes;j.consume(st),_?.onLength!=null&&_.onLength(et),_e=ReadMode.DATA}catch(st){if(st instanceof RangeError){if(j.byteLength>rt)throw errCode(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw st}if(_e===ReadMode.DATA){if(j.byteLength<et)break;const st=j.sublist(0,et);j.consume(et),_?.onData!=null&&_.onData(st),yield st,_e=ReadMode.LENGTH}}if(j.byteLength>0)throw errCode(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}}decode$4.fromReader=(_,a)=>{let $=1;const j=async function*(){for(;;)try{const{done:et,value:tt}=await _.next($);if(et===!0)return;tt!=null&&(yield tt)}catch(et){if(et.code==="ERR_UNDER_READ")return{done:!0,value:null};throw et}finally{$=1}}();return decode$4({...a??{},onLength:et=>{$=et}})(j)};class OutboundStream{constructor(a,$,j){this.rawStream=a,this.pushable=pushable$2({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=j.maxBufferSize??1/0,pipe(abortableSource(this.pushable,this.closeController.signal,{returnOnAbort:!0}),encode$5(),this.rawStream).catch($)}get protocol(){return this.rawStream.stat.protocol}push(a){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(a)}close(){this.closeController.abort(),this.pushable.return(),this.rawStream.close()}}class InboundStream{constructor(a){this.rawStream=a,this.closeController=new AbortController,this.source=abortableSource(pipe(this.rawStream,decode$4()),this.closeController.signal,{returnOnAbort:!0})}close(){this.closeController.abort(),this.rawStream.close()}}var GossipStatusCode;(function(_){_[_.started=0]="started",_[_.stopped=1]="stopped"})(GossipStatusCode||(GossipStatusCode={}));class GossipSub extends EventEmitter$1{constructor(a={}){super(),this.multicodecs=[GossipsubIDv11,GossipsubIDv10],this.peers=new Set,this.streamsInbound=new Map,this.streamsOutbound=new Map,this.outboundInflightQueue=pushable$2({objectMode:!0}),this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.components=new Components,this.directPeerInitial=null,this.status={code:GossipStatusCode.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{const j=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch(_e=>{this.log("Error running heartbeat",_e)}).finally(()=>{if(j?.(),this.status.code===GossipStatusCode.started){clearTimeout(this.status.heartbeatTimeout);let _e=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;_e<this.opts.heartbeatInterval*.25&&(_e+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,_e)}})};const $={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:GossipsubD,Dlo:GossipsubDlo,Dhi:GossipsubDhi,Dscore:GossipsubDscore,Dout:GossipsubDout,Dlazy:GossipsubDlazy,heartbeatInterval:GossipsubHeartbeatInterval,fanoutTTL:GossipsubFanoutTTL,mcacheLength:GossipsubHistoryLength,mcacheGossip:GossipsubHistoryGossip,seenTTL:GossipsubSeenTTL,gossipsubIWantFollowupMs:GossipsubIWantFollowupTime,prunePeers:GossipsubPrunePeers,pruneBackoff:GossipsubPruneBackoff,graftFloodThreshold:GossipsubGraftFloodThreshold,opportunisticGraftPeers:GossipsubOpportunisticGraftPeers,opportunisticGraftTicks:GossipsubOpportunisticGraftTicks,directConnectTicks:GossipsubDirectConnectTicks,...a,scoreParams:createPeerScoreParams(a.scoreParams),scoreThresholds:createPeerScoreThresholds(a.scoreThresholds)};if(this.globalSignaturePolicy=$.globalSignaturePolicy??StrictSign,$.fallbackToFloodsub&&this.multicodecs.push(FloodsubID),this.log=logger$1($.debugName??"libp2p:gossipsub"),this.opts=$,this.direct=new Set($.directPeers.map(j=>j.id.toString())),this.seenCache=new SimpleTimeCache({validityMs:$.seenTTL}),this.publishedMessageIds=new SimpleTimeCache({validityMs:$.seenTTL}),a.msgIdFn)this.msgIdFn=a.msgIdFn;else switch(this.globalSignaturePolicy){case StrictSign:this.msgIdFn=msgIdFnStrictSign;break;case StrictNoSign:this.msgIdFn=msgIdFnStrictNoSign;break}if(a.fastMsgIdFn&&(this.fastMsgIdFn=a.fastMsgIdFn,this.fastMsgIdCache=new SimpleTimeCache({validityMs:$.seenTTL})),this.msgIdToStrFn=a.msgIdToStrFn??messageIdToString,this.mcache=a.messageCache||new MessageCache($.mcacheGossip,$.mcacheLength,this.msgIdToStrFn),a.dataTransform&&(this.dataTransform=a.dataTransform),a.metricsRegister){if(!a.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");const j=Math.max(...Object.values($.scoreParams.topics).map(et=>et.meshMessageDeliveriesWindow),DEFAULT_METRIC_MESH_MESSAGE_DELIVERIES_WINDOWS),_e=getMetrics(a.metricsRegister,a.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:$.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:j/1e3});_e.mcacheSize.addCollect(()=>this.onScrapeMetrics(_e));for(const et of this.multicodecs)_e.protocolsEnabled.set({protocol:et},1);this.metrics=_e}else this.metrics=null;this.gossipTracer=new IWantTracer(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new PeerScore(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:$.heartbeatInterval}),this.maxInboundStreams=a.maxInboundStreams,this.maxOutboundStreams=a.maxOutboundStreams}getPeers(){return[...this.peers.keys()].map(a=>peerIdFromString(a))}isStarted(){return this.status.code===GossipStatusCode.started}async init(a){this.components=a,this.score.init(a)}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await getPublishConfigFromPeerId(this.globalSignaturePolicy,this.components.getPeerId()),this.outboundInflightQueue=pushable$2({objectMode:!0}),pipe(this.outboundInflightQueue,async et=>{for await(const{peerId:tt,connection:rt}of et)await this.createOutboundStream(tt,rt)}).catch(et=>this.log.error("outbound inflight queue error",et)),await Promise.all(this.opts.directPeers.map(async et=>{await this.components.getPeerStore().addressBook.add(et.id,et.addrs)}));const a=this.components.getRegistrar();await Promise.all(this.multicodecs.map(et=>a.handle(et,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams})));const $=createTopology({onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}),j=await Promise.all(this.multicodecs.map(et=>a.register(et,$))),_e=setTimeout(this.runHeartbeat,GossipsubHeartbeatInitialDelay);this.status={code:GossipStatusCode.started,registrarTopologyIds:j,heartbeatTimeout:_e,hearbeatStartMs:Date.now()+GossipsubHeartbeatInitialDelay},this.score.start(),this.directPeerInitial=setTimeout(()=>{Promise.resolve().then(async()=>{await Promise.all(Array.from(this.direct).map(async et=>await this.connect(et)))}).catch(et=>{this.log(et)})},GossipsubDirectConnectInitialDelay),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==GossipStatusCode.started)return;const{registrarTopologyIds:a}=this.status;this.status={code:GossipStatusCode.stopped};const $=this.components.getRegistrar();a.forEach(j=>$.unregister(j)),this.outboundInflightQueue.end();for(const j of this.streamsOutbound.values())j.close();this.streamsOutbound.clear();for(const j of this.streamsInbound.values())j.close();this.streamsInbound.clear(),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:a,connection:$}){if(!this.isStarted())return;const j=$.remotePeer;this.addPeer(j,$.stat.direction),this.createInboundStream(j,a),this.outboundInflightQueue.push({peerId:j,connection:$})}onPeerConnected(a,$){!this.isStarted()||(this.addPeer(a,$.stat.direction),this.outboundInflightQueue.push({peerId:a,connection:$}))}onPeerDisconnected(a){this.log("connection ended %p",a),this.removePeer(a)}async createOutboundStream(a,$){if(!this.isStarted())return;const j=a.toString();if(!!this.peers.has(j)&&!this.streamsOutbound.has(j))try{const _e=new OutboundStream(await $.newStream(this.multicodecs),tt=>this.log.error("outbound pipe error",tt),{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",a),this.streamsOutbound.set(j,_e);const et=_e.protocol;et===FloodsubID&&this.floodsubPeers.add(j),this.metrics?.peersPerProtocol.inc({protocol:et},1),this.subscriptions.size>0&&(this.log("send subscriptions to",j),this.sendSubscriptions(j,Array.from(this.subscriptions),!0))}catch(_e){this.log.error("createOutboundStream error",_e)}}async createInboundStream(a,$){if(!this.isStarted())return;const j=a.toString();if(!this.peers.has(j))return;const _e=this.streamsInbound.get(j);_e!==void 0&&(this.log("replacing existing inbound steam %s",j),_e.close()),this.log("create inbound stream %s",j);const et=new InboundStream($);this.streamsInbound.set(j,et),this.pipePeerReadStream(a,et.source).catch(tt=>this.log(tt))}addPeer(a,$){const j=a.toString();this.peers.has(j)||(this.log("new peer %p",a),this.peers.add(j),this.score.addPeer(j),this.outbound.has(j)||this.outbound.set(j,$==="outbound"))}removePeer(a){const $=a.toString();if(!this.peers.has($))return;this.log("delete peer %p",a),this.peers.delete($);const j=this.streamsOutbound.get($),_e=this.streamsInbound.get($);j&&this.metrics?.peersPerProtocol.inc({protocol:j.protocol},-1),j?.close(),_e?.close(),this.streamsOutbound.delete($),this.streamsInbound.delete($);for(const et of this.topics.values())et.delete($);for(const[et,tt]of this.mesh)tt.delete($)===!0&&this.metrics?.onRemoveFromMesh(et,ChurnReason.Dc,1);for(const et of this.fanout.values())et.delete($);this.floodsubPeers.delete($),this.gossip.delete($),this.control.delete($),this.outbound.delete($),this.score.removePeer($),this.acceptFromWhitelist.delete($)}get started(){return this.status.code===GossipStatusCode.started}getMeshPeers(a){const $=this.mesh.get(a);return $?Array.from($):[]}getSubscribers(a){const $=this.topics.get(a);return($?Array.from($):[]).map(j=>peerIdFromString(j))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(a,$){try{await pipe($,async j=>{for await(const _e of j)try{const et=_e.subarray(),tt=RPC$1.decode(et);this.metrics?.onRpcRecv(tt,et.length),this.opts.awaitRpcHandler?await this.handleReceivedRpc(a,tt):this.handleReceivedRpc(a,tt).catch(rt=>this.log(rt))}catch(et){this.log(et)}})}catch(j){this.log.error(j),this.onPeerDisconnected(a)}}async handleReceivedRpc(a,$){if(!this.acceptFrom(a.toString())){this.log("received message from unacceptable peer %p",a),this.metrics?.rpcRecvNotAccepted.inc();return}if(this.log("rpc from %p",a),$.subscriptions&&$.subscriptions.length>0&&($.subscriptions.forEach(j=>{this.handleReceivedSubscription(a,j)}),this.dispatchEvent(new CustomEvent$1("subscription-change",{detail:{peerId:a,subscriptions:$.subscriptions.filter(j=>j.topic!==null).map(j=>({topic:j.topic??"",subscribe:Boolean(j.subscribe)}))}}))),$.messages)for(const j of $.messages){const _e=this.handleReceivedMessage(a,j).catch(et=>this.log(et));this.opts.awaitRpcMessageHandler&&await _e}$.control&&await this.handleControlMessage(a.toString(),$.control)}handleReceivedSubscription(a,$){if($.topic==null)return;this.log("subscription update from %p topic %s",a,$.topic);let j=this.topics.get($.topic);j==null&&(j=new Set,this.topics.set($.topic,j)),$.subscribe?j.add(a.toString()):j.delete(a.toString())}async handleReceivedMessage(a,$){this.metrics?.onMsgRecvPreValidation($.topic);const j=await this.validateReceivedMessage(a,$);switch(this.metrics?.onMsgRecvResult($.topic,j.code),j.code){case MessageStatus.duplicate:this.score.duplicateMessage(a.toString(),j.msgIdStr,$.topic),this.mcache.observeDuplicate(j.msgIdStr,a.toString());return;case MessageStatus.invalid:if(j.msgIdStr){const _e=j.msgIdStr;this.score.rejectMessage(a.toString(),_e,$.topic,j.reason),this.gossipTracer.rejectMessage(_e,j.reason)}else this.score.rejectInvalidMessage(a.toString(),$.topic);this.metrics?.onMsgRecvInvalid($.topic,j);return;case MessageStatus.valid:this.score.validateMessage(j.messageId.msgIdStr),this.gossipTracer.deliverMessage(j.messageId.msgIdStr),this.mcache.put(j.messageId,$,!this.opts.asyncValidation),this.subscriptions.has($.topic)&&(!this.components.getPeerId().equals(a)||this.opts.emitSelf)&&(super.dispatchEvent(new CustomEvent$1("gossipsub:message",{detail:{propagationSource:a,msgId:j.messageId.msgIdStr,msg:j.msg}})),super.dispatchEvent(new CustomEvent$1("message",{detail:j.msg}))),this.opts.asyncValidation||this.forwardMessage(j.messageId.msgIdStr,$,a.toString())}}async validateReceivedMessage(a,$){const j=this.fastMsgIdFn?.($),_e=j?this.fastMsgIdCache?.get(j):void 0;if(_e)return{code:MessageStatus.duplicate,msgIdStr:_e};const et=await validateToRawMessage(this.globalSignaturePolicy,$);if(!et.valid)return{code:MessageStatus.invalid,reason:RejectReason.Error,error:et.error};const tt=et.message;try{this.dataTransform&&(tt.data=this.dataTransform.inboundTransform($.topic,tt.data))}catch(ot){return this.log("Invalid message, transform failed",ot),{code:MessageStatus.invalid,reason:RejectReason.Error,error:ValidateError.TransformFailed}}const rt=await this.msgIdFn(tt),nt=this.msgIdToStrFn(rt),it={msgId:rt,msgIdStr:nt};if(j&&this.fastMsgIdCache?.put(j,nt),this.seenCache.has(nt))return{code:MessageStatus.duplicate,msgIdStr:nt};this.seenCache.put(nt);const st=this.topicValidators.get($.topic);if(st!=null){let ot;try{ot=await st(tt.topic,tt,a)}catch(at){const lt=at.code;lt===ERR_TOPIC_VALIDATOR_IGNORE&&(ot=MessageAcceptance.Ignore),lt===ERR_TOPIC_VALIDATOR_REJECT?ot=MessageAcceptance.Reject:ot=MessageAcceptance.Ignore}if(ot!==MessageAcceptance.Accept)return{code:MessageStatus.invalid,reason:rejectReasonFromAcceptance(ot),msgIdStr:nt}}return{code:MessageStatus.valid,messageId:it,msg:tt}}getScore(a){return this.score.score(a)}sendSubscriptions(a,$,j){this.sendRpc(a,{subscriptions:$.map(_e=>({topic:_e,subscribe:j})),messages:[]})}async handleControlMessage(a,$){if($===void 0)return;const j=$.ihave?this.handleIHave(a,$.ihave):[],_e=$.iwant?this.handleIWant(a,$.iwant):[],et=$.graft?await this.handleGraft(a,$.graft):[];$.prune&&await this.handlePrune(a,$.prune),!(!j.length&&!_e.length&&!et.length)&&this.sendRpc(a,createGossipRpc(_e,{iwant:j,prune:et}))}acceptFrom(a){if(this.direct.has(a))return!0;const $=Date.now(),j=this.acceptFromWhitelist.get(a);if(j&&j.messagesAccepted<ACCEPT_FROM_WHITELIST_MAX_MESSAGES&&j.acceptUntil>=$)return j.messagesAccepted+=1,!0;const _e=this.score.score(a);return _e>=ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE?this.acceptFromWhitelist.set(a,{messagesAccepted:0,acceptUntil:$+ACCEPT_FROM_WHITELIST_DURATION_MS}):this.acceptFromWhitelist.delete(a),_e>=this.opts.scoreThresholds.graylistThreshold}handleIHave(a,$){if(!$.length)return[];const j=this.score.score(a);if(j<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",a,j),this.metrics?.ihaveRcvIgnored.inc({reason:IHaveIgnoreReason.LowScore}),[];const _e=(this.peerhave.get(a)??0)+1;if(this.peerhave.set(a,_e),_e>GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",a,_e),this.metrics?.ihaveRcvIgnored.inc({reason:IHaveIgnoreReason.MaxIhave}),[];const et=this.iasked.get(a)??0;if(et>=GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",a,et),this.metrics?.ihaveRcvIgnored.inc({reason:IHaveIgnoreReason.MaxIasked}),[];const tt=new Map;if($.forEach(({topicID:it,messageIDs:st})=>{if(!it||!st||!this.mesh.has(it))return;let ot=0;st.forEach(at=>{const lt=this.msgIdToStrFn(at);this.seenCache.has(lt)||(tt.set(lt,at),ot++)}),this.metrics?.onIhaveRcv(it,st.length,ot)}),!tt.size)return[];let rt=tt.size;rt+et>GossipsubMaxIHaveLength&&(rt=GossipsubMaxIHaveLength-et),this.log("IHAVE: Asking for %d out of %d messages from %s",rt,tt.size,a);let nt=Array.from(tt.values());return shuffle(nt),nt=nt.slice(0,rt),this.iasked.set(a,et+rt),this.gossipTracer.addPromise(a,nt),[{messageIDs:nt}]}handleIWant(a,$){if(!$.length)return[];const j=this.score.score(a);if(j<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",a,j),[];const _e=new Map,et=new Map;let tt=0;return $.forEach(({messageIDs:rt})=>{rt&&rt.forEach(nt=>{const it=this.msgIdToStrFn(nt),st=this.mcache.getWithIWantCount(it,a);if(st==null){tt++;return}if(et.set(st.msg.topic,1+(et.get(st.msg.topic)??0)),st.count>GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",a,nt);return}_e.set(it,st.msg)})}),this.metrics?.onIwantRcv(et,tt),_e.size?(this.log("IWANT: Sending %d messages to %s",_e.size,a),Array.from(_e.values())):(this.log("IWANT: Could not provide any wanted messages to %s",a),[])}async handleGraft(a,$){const j=[],_e=this.score.score(a),et=Date.now();let tt=this.opts.doPX;return $.forEach(({topicID:rt})=>{if(!rt)return;const nt=this.mesh.get(rt);if(!nt){tt=!1;return}if(nt.has(a))return;if(this.direct.has(a)){this.log("GRAFT: ignoring request from direct peer %s",a),j.push(rt),tt=!1;return}const it=this.backoff.get(rt)?.get(a);if(typeof it=="number"&&et<it){this.log("GRAFT: ignoring backed off peer %s",a),this.score.addPenalty(a,1,ScorePenalty.GraftBackoff),tt=!1;const st=it+this.opts.graftFloodThreshold-this.opts.pruneBackoff;et<st&&this.score.addPenalty(a,1,ScorePenalty.GraftBackoff),this.addBackoff(a,rt),j.push(rt);return}if(_e<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",a,_e,rt),j.push(rt),tt=!1,this.addBackoff(a,rt);return}if(nt.size>=this.opts.Dhi&&!this.outbound.get(a)){j.push(rt),this.addBackoff(a,rt);return}this.log("GRAFT: Add mesh link from %s in %s",a,rt),this.score.graft(a,rt),nt.add(a),this.metrics?.onAddToMesh(rt,InclusionReason.Subscribed,1)}),j.length?await Promise.all(j.map(rt=>this.makePrune(a,rt,tt))):[]}async handlePrune(a,$){const j=this.score.score(a);for(const{topicID:_e,backoff:et,peers:tt}of $){if(_e==null)continue;const rt=this.mesh.get(_e);if(!rt)return;if(this.log("PRUNE: Remove mesh link to %s in %s",a,_e),this.score.prune(a,_e),rt.has(a)&&(rt.delete(a),this.metrics?.onRemoveFromMesh(_e,ChurnReason.Unsub,1)),typeof et=="number"&&et>0?this.doAddBackoff(a,_e,et*1e3):this.addBackoff(a,_e),tt&&tt.length){if(j<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",a,j,_e);continue}await this.pxConnect(tt)}}}addBackoff(a,$){this.doAddBackoff(a,$,this.opts.pruneBackoff)}doAddBackoff(a,$,j){let _e=this.backoff.get($);_e||(_e=new Map,this.backoff.set($,_e));const et=Date.now()+j;(_e.get(a)??0)<et&&_e.set(a,et)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((a,$)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",$,a),this.score.addPenalty($,a,ScorePenalty.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%GossipsubPruneBackoffTicks!==0)return;const a=Date.now();this.backoff.forEach(($,j)=>{$.forEach((_e,et)=>{_e<a&&$.delete(et)}),$.size===0&&this.backoff.delete(j)})}async directConnect(){const a=[];this.direct.forEach($=>{this.streamsOutbound.has($)||a.push($)}),await Promise.all(a.map(async $=>await this.connect($)))}async pxConnect(a){a.length>this.opts.prunePeers&&(shuffle(a),a=a.slice(0,this.opts.prunePeers));const $=[];await Promise.all(a.map(async j=>{if(!j.peerID)return;const _e=peerIdFromBytes(j.peerID).toString();if(!this.peers.has(_e)){if(!j.signedPeerRecord){$.push(_e);return}try{const et=await RecordEnvelope.openAndCertify(j.signedPeerRecord,"libp2p-peer-record"),tt=et.peerId;if(!et.peerId.equals(_e)){this.log("bogus peer record obtained through px: peer ID %p doesn't match expected peer %p",tt,_e);return}if(!await this.components.getPeerStore().addressBook.consumePeerRecord(et)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}$.push(_e)}catch{this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}})),$.length&&await Promise.all($.map(async j=>await this.connect(j)))}async connect(a){this.log("Initiating connection with %s",a);const $=peerIdFromString(a),j=await this.components.getConnectionManager().openConnection($);for(const _e of this.multicodecs)for(const et of this.components.getRegistrar().getTopologies(_e))et.onConnect($,j)}subscribe(a){if(this.status.code!==GossipStatusCode.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(a)){this.subscriptions.add(a);for(const $ of this.peers.keys())this.sendSubscriptions($,[a],!0)}this.join(a)}unsubscribe(a){if(this.status.code!==GossipStatusCode.started)throw new Error("Pubsub is not started");const $=this.subscriptions.delete(a);if(this.log("unsubscribe from %s - am subscribed %s",a,$),$)for(const j of this.peers.keys())this.sendSubscriptions(j,[a],!1);this.leave(a).catch(j=>{this.log(j)})}join(a){if(this.status.code!==GossipStatusCode.started)throw new Error("Gossipsub has not started");if(this.mesh.has(a))return;this.log("JOIN %s",a),this.metrics?.onJoin(a);const $=new Set,j=this.fanout.get(a);if(j&&(this.fanout.delete(a),this.fanoutLastpub.delete(a),j.forEach(_e=>{!this.direct.has(_e)&&this.score.score(_e)>=0&&$.add(_e)}),this.metrics?.onAddToMesh(a,InclusionReason.Fanout,$.size)),$.size<this.opts.D){const _e=$.size;this.getRandomGossipPeers(a,this.opts.D,tt=>!$.has(tt)&&!this.direct.has(tt)&&this.score.score(tt)>=0).forEach(tt=>{$.add(tt)}),this.metrics?.onAddToMesh(a,InclusionReason.Random,$.size-_e)}this.mesh.set(a,$),$.forEach(_e=>{this.log("JOIN: Add mesh link to %s in %s",_e,a),this.sendGraft(_e,a)})}async leave(a){if(this.status.code!==GossipStatusCode.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",a),this.metrics?.onLeave(a);const $=this.mesh.get(a);$&&(await Promise.all(Array.from($).map(async j=>(this.log("LEAVE: Remove mesh link to %s in %s",j,a),await this.sendPrune(j,a)))),this.mesh.delete(a))}selectPeersToForward(a,$,j){const _e=new Set,et=this.topics.get(a);et&&(this.direct.forEach(rt=>{et.has(rt)&&$!==rt&&!j?.has(rt)&&_e.add(rt)}),this.floodsubPeers.forEach(rt=>{et.has(rt)&&$!==rt&&!j?.has(rt)&&this.score.score(rt)>=this.opts.scoreThresholds.publishThreshold&&_e.add(rt)}));const tt=this.mesh.get(a);return tt&&tt.size>0&&tt.forEach(rt=>{$!==rt&&!j?.has(rt)&&_e.add(rt)}),_e}selectPeersToPublish(a){const $=new Set,j={direct:0,floodsub:0,mesh:0,fanout:0},_e=this.topics.get(a);if(_e)if(this.opts.floodPublish)_e.forEach(et=>{this.direct.has(et)?($.add(et),j.direct++):this.score.score(et)>=this.opts.scoreThresholds.publishThreshold&&($.add(et),j.floodsub++)});else{this.direct.forEach(tt=>{_e.has(tt)&&($.add(tt),j.direct++)}),this.floodsubPeers.forEach(tt=>{_e.has(tt)&&this.score.score(tt)>=this.opts.scoreThresholds.publishThreshold&&($.add(tt),j.floodsub++)});const et=this.mesh.get(a);if(et&&et.size>0)et.forEach(tt=>{$.add(tt),j.mesh++});else{const tt=this.fanout.get(a);if(tt&&tt.size>0)tt.forEach(rt=>{$.add(rt),j.fanout++});else{const rt=this.getRandomGossipPeers(a,this.opts.D,nt=>this.score.score(nt)>=this.opts.scoreThresholds.publishThreshold);rt.size>0&&(this.fanout.set(a,rt),rt.forEach(nt=>{$.add(nt),j.fanout++}))}this.fanoutLastpub.set(a,Date.now())}}return{tosend:$,tosendCount:j}}forwardMessage(a,$,j,_e){j&&this.score.deliverMessage(j,a,$.topic);const et=this.selectPeersToForward($.topic,j,_e),tt=createGossipRpc([$]);et.forEach(rt=>{this.sendRpc(rt,tt)}),this.metrics?.onForwardMsg($.topic,et.size)}async publish(a,$){const j=this.dataTransform?this.dataTransform.outboundTransform(a,$):$;if(this.publishConfig==null)throw Error("PublishError.Uninitialized");const{raw:_e,msg:et}=await buildRawMessage(this.publishConfig,a,$,j),tt=await this.msgIdFn(et),rt=this.msgIdToStrFn(tt);if(this.seenCache.has(rt))throw Error("PublishError.Duplicate");const{tosend:nt,tosendCount:it}=this.selectPeersToPublish(a),st=this.opts.emitSelf===!0&&this.subscriptions.has(a);if(nt.size===0&&!this.opts.allowPublishToZeroPeers&&!st)throw Error("PublishError.InsufficientPeers");this.seenCache.put(rt),this.mcache.put({msgId:tt,msgIdStr:rt},_e,!0),this.publishedMessageIds.put(rt);const ot=createGossipRpc([_e]);for(const at of nt)this.sendRpc(at,ot)||nt.delete(at);return this.metrics?.onPublishMsg(a,it,nt.size,_e.data!=null?_e.data.length:0),st&&(nt.add(this.components.getPeerId().toString()),super.dispatchEvent(new CustomEvent$1("gossipsub:message",{detail:{propagationSource:this.components.getPeerId(),msgId:rt,msg:et}})),super.dispatchEvent(new CustomEvent$1("message",{detail:et}))),{recipients:Array.from(nt.values()).map(at=>peerIdFromString(at))}}reportMessageValidationResult(a,$,j){if(j===MessageAcceptance.Accept){const _e=this.mcache.validate(a);if(this.metrics?.onReportValidationMcacheHit(_e!==null),_e!=null){const{message:et,originatingPeers:tt}=_e;this.score.deliverMessage($.toString(),a,et.topic),this.forwardMessage(a,_e.message,$.toString(),tt),this.metrics?.onReportValidation(et.topic,j)}}else{const _e=this.mcache.remove(a);if(this.metrics?.onReportValidationMcacheHit(_e!==null),_e){const et=rejectReasonFromAcceptance(j),{message:tt,originatingPeers:rt}=_e;this.score.rejectMessage($.toString(),a,tt.topic,et);for(const nt of rt)this.score.rejectMessage(nt,a,tt.topic,et);this.metrics?.onReportValidation(tt.topic,j)}}}sendGraft(a,$){const _e=createGossipRpc([],{graft:[{topicID:$}]});this.sendRpc(a,_e)}async sendPrune(a,$){const j=[await this.makePrune(a,$,this.opts.doPX)],_e=createGossipRpc([],{prune:j});this.sendRpc(a,_e)}sendRpc(a,$){const j=this.streamsOutbound.get(a);if(!j)return this.log(`Cannot send RPC to ${a} as there is no open stream to it available`),!1;const _e=this.control.get(a);_e&&(this.piggybackControl(a,$,_e),this.control.delete(a));const et=this.gossip.get(a);et&&(this.piggybackGossip(a,$,et),this.gossip.delete(a));const tt=RPC$1.encode($).finish();try{j.push(tt)}catch(rt){return this.log.error(`Cannot send rpc to ${a}`,rt),_e&&this.control.set(a,_e),et&&this.gossip.set(a,et),!1}return this.metrics?.onRpcSent($,tt.length),!0}piggybackControl(a,$,j){const _e=(j.graft||[]).filter(({topicID:tt})=>(tt&&this.mesh.get(tt)||new Set).has(a)),et=(j.prune||[]).filter(({topicID:tt})=>!(tt&&this.mesh.get(tt)||new Set).has(a));!_e.length&&!et.length||($.control?($.control.graft=$.control.graft&&$.control.graft.concat(_e),$.control.prune=$.control.prune&&$.control.prune.concat(et)):$.control={graft:_e,prune:et,ihave:[],iwant:[]})}piggybackGossip(a,$,j){$.control||($.control={ihave:[],iwant:[],graft:[],prune:[]}),$.control.ihave=j}async sendGraftPrune(a,$,j){const _e=this.opts.doPX;for(const[et,tt]of a){const rt=tt.map(ot=>({topicID:ot}));let nt=[];const it=$.get(et);it&&(nt=await Promise.all(it.map(async ot=>await this.makePrune(et,ot,_e&&!(j.get(et)??!1)))),$.delete(et));const st=createGossipRpc([],{graft:rt,prune:nt});this.sendRpc(et,st)}for(const[et,tt]of $){const rt=await Promise.all(tt.map(async it=>await this.makePrune(et,it,_e&&!(j.get(et)??!1)))),nt=createGossipRpc([],{prune:rt});this.sendRpc(et,nt)}}emitGossip(a){const $=this.mcache.getGossipIDs(new Set(a.keys()));for(const[j,_e]of a)this.doEmitGossip(j,_e,$.get(j)??[])}doEmitGossip(a,$,j){if(!j.length||(shuffle(j),j.length>GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",j.length),!$.size))return;let _e=this.opts.Dlazy;const et=GossipsubGossipFactor*$.size;let tt=$;et>_e&&(_e=et),_e>tt.size?_e=tt.size:tt=shuffle(Array.from(tt)).slice(0,_e),tt.forEach(rt=>{let nt=j;j.length>GossipsubMaxIHaveLength&&(nt=shuffle(nt.slice()).slice(0,GossipsubMaxIHaveLength)),this.pushGossip(rt,{topicID:a,messageIDs:nt})})}flush(){for(const[a,$]of this.gossip.entries())this.gossip.delete(a),this.sendRpc(a,createGossipRpc([],{ihave:$}));for(const[a,$]of this.control.entries())this.control.delete(a),this.sendRpc(a,createGossipRpc([],{graft:$.graft,prune:$.prune}))}pushGossip(a,$){this.log("Add gossip to %s",a);const j=this.gossip.get(a)||[];this.gossip.set(a,j.concat($))}async makePrune(a,$,j){if(this.score.prune(a,$),this.streamsOutbound.get(a).protocol===GossipsubIDv10)return{topicID:$,peers:[]};const _e=this.opts.pruneBackoff/1e3;if(!j)return{topicID:$,peers:[],backoff:_e};const et=this.getRandomGossipPeers($,this.opts.prunePeers,rt=>rt!==a&&this.score.score(rt)>=0),tt=await Promise.all(Array.from(et).map(async rt=>{const nt=peerIdFromString(rt);return{peerID:nt.toBytes(),signedPeerRecord:await this.components.getPeerStore().addressBook.getRawEnvelope(nt)}}));return{topicID:$,peers:tt,backoff:_e}}async heartbeat(){const{D:a,Dlo:$,Dhi:j,Dscore:_e,Dout:et,fanoutTTL:tt}=this.opts;this.heartbeatTicks++;const rt=new Map,nt=ct=>{let ut=rt.get(ct);return ut===void 0&&(ut=this.score.score(ct),rt.set(ct,ut)),ut},it=new Map,st=new Map,ot=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();const at=new Map;this.mesh.forEach((ct,ut)=>{const dt=this.topics.get(ut),ft=new Set,pt=new Set;if(at.set(ut,pt),dt){const _t=shuffle(Array.from(dt)),vt=this.backoff.get(ut);for(const ht of _t){const St=this.streamsOutbound.get(ht);if(St&&this.multicodecs.includes(St.protocol)&&!ct.has(ht)&&!this.direct.has(ht)){const It=nt(ht);(!vt||!vt.has(ht))&&It>=0&&ft.add(ht),It>=this.opts.scoreThresholds.gossipThreshold&&pt.add(ht)}}}const yt=(_t,vt)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",_t,ut),this.addBackoff(_t,ut),ct.delete(_t),nt(_t)>=this.opts.scoreThresholds.gossipThreshold&&pt.add(_t),this.metrics?.onRemoveFromMesh(ut,vt,1);const ht=st.get(_t);ht?ht.push(ut):st.set(_t,[ut])},mt=(_t,vt)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",_t,ut),this.score.graft(_t,ut),ct.add(_t),pt.delete(_t),this.metrics?.onAddToMesh(ut,vt,1);const ht=it.get(_t);ht?ht.push(ut):it.set(_t,[ut])};if(ct.forEach(_t=>{const vt=nt(_t);vt<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",_t,vt,ut),yt(_t,ChurnReason.BadScore),ot.set(_t,!0))}),ct.size<$){const _t=a-ct.size;removeFirstNItemsFromSet(ft,_t).forEach(ht=>{mt(ht,InclusionReason.NotEnough)})}if(ct.size>j){let _t=Array.from(ct);_t.sort((ht,St)=>nt(St)-nt(ht)),_t=_t.slice(0,_e).concat(shuffle(_t.slice(_e)));let vt=0;if(_t.slice(0,a).forEach(ht=>{this.outbound.get(ht)&&vt++}),vt<et){const ht=It=>{const Lt=_t[It];for(let Mt=It;Mt>0;Mt--)_t[Mt]=_t[Mt-1];_t[0]=Lt};if(vt>0){let It=vt;for(let Lt=1;Lt<a&&It>0;Lt++)this.outbound.get(_t[Lt])&&(ht(Lt),It--)}let St=a-vt;for(let It=a;It<_t.length&&St>0;It++)this.outbound.get(_t[It])&&(ht(It),St--)}_t.slice(a).forEach(ht=>{yt(ht,ChurnReason.Excess)})}if(ct.size>=$){let _t=0;if(ct.forEach(vt=>{this.outbound.get(vt)&&_t++}),_t<et){const vt=et-_t;removeItemsFromSet(ft,vt,St=>this.outbound.get(St)===!0).forEach(St=>{mt(St,InclusionReason.Outbound)})}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&ct.size>1){const _t=Array.from(ct).sort((St,It)=>nt(St)-nt(It)),vt=Math.floor(ct.size/2),ht=nt(_t[vt]);if(ht<this.opts.scoreThresholds.opportunisticGraftThreshold){const St=this.opts.opportunisticGraftPeers,It=removeItemsFromSet(ft,St,Lt=>nt(Lt)>ht);for(const Lt of It)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",Lt,ut),mt(Lt,InclusionReason.Opportunistic)}}});const lt=Date.now();this.fanoutLastpub.forEach((ct,ut)=>{ct+tt<lt&&(this.fanout.delete(ut),this.fanoutLastpub.delete(ut))}),this.fanout.forEach((ct,ut)=>{const dt=this.topics.get(ut);ct.forEach(mt=>{(!dt.has(mt)||nt(mt)<this.opts.scoreThresholds.publishThreshold)&&ct.delete(mt)});const ft=this.topics.get(ut),pt=[],yt=new Set;if(at.set(ut,yt),ft){const mt=shuffle(Array.from(ft));for(const _t of mt){const vt=this.streamsOutbound.get(_t);if(vt&&this.multicodecs.includes(vt.protocol)&&!ct.has(_t)&&!this.direct.has(_t)){const ht=nt(_t);ht>=this.opts.scoreThresholds.publishThreshold&&pt.push(_t),ht>=this.opts.scoreThresholds.gossipThreshold&&yt.add(_t)}}}if(ct.size<a){const mt=a-ct.size;pt.slice(0,mt).forEach(_t=>{ct.add(_t),yt?.delete(_t)})}}),this.emitGossip(at),await this.sendGraftPrune(it,st,ot),this.flush(),this.mcache.shift(),this.dispatchEvent(new CustomEvent$1("gossipsub:heartbeat"))}getRandomGossipPeers(a,$,j=()=>!0){const _e=this.topics.get(a);if(!_e)return new Set;let et=[];return _e.forEach(tt=>{const rt=this.streamsOutbound.get(tt);!rt||this.multicodecs.includes(rt.protocol)&&j(tt)&&et.push(tt)}),et=shuffle(et),$>0&&et.length>$&&(et=et.slice(0,$)),new Set(et)}onScrapeMetrics(a){a.mcacheSize.set(this.mcache.size),a.cacheSize.set({cache:"direct"},this.direct.size),a.cacheSize.set({cache:"seenCache"},this.seenCache.size),a.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),a.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),a.cacheSize.set({cache:"mcache"},this.mcache.size),a.cacheSize.set({cache:"score"},this.score.size),a.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),a.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),a.cacheSize.set({cache:"topics"},this.topics.size),a.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),a.cacheSize.set({cache:"mesh"},this.mesh.size),a.cacheSize.set({cache:"fanout"},this.fanout.size),a.cacheSize.set({cache:"peers"},this.peers.size),a.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),a.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),a.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),a.cacheSize.set({cache:"gossip"},this.gossip.size),a.cacheSize.set({cache:"control"},this.control.size),a.cacheSize.set({cache:"peerhave"},this.peerhave.size),a.cacheSize.set({cache:"outbound"},this.outbound.size);let $=0;for(const tt of this.backoff.values())$+=tt.size;a.cacheSize.set({cache:"backoff"},$);for(const[tt,rt]of this.topics)a.topicPeersCount.set({topicStr:tt},rt.size);for(const[tt,rt]of this.mesh)a.meshPeerCounts.set({topicStr:tt},rt.size);const j=[],_e=new Map;a.behaviourPenalty.reset();for(const tt of this.peers.keys()){const rt=this.score.score(tt);j.push(rt),_e.set(tt,rt),a.behaviourPenalty.observe(this.score.peerStats.get(tt)?.behaviourPenalty??0)}a.registerScores(j,this.opts.scoreThresholds),a.registerScorePerMesh(this.mesh,_e);const et=computeAllPeersScoreWeights(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,a.topicStrToLabel);a.registerScoreWeights(et)}}GossipSub.multicodec=GossipsubIDv11;const routers=()=>({gossipsub:_=>{const a=new GossipSub({allowPublishToZeroPeers:!0,fallbackToFloodsub:!0,emitSelf:!0,maxInboundStreams:64,maxOutboundStreams:128});return a.init({getPeerId(){return _.peerId},getPeerStore(){return _.peerStore},getRegistrar(){return _.registrar},getConnectionManager(){return _.connectionManager}}),a}}),log$W=logger$1("libp2p-delegated-peer-routing"),DEFAULT_TIMEOUT$1=3e4,CONCURRENT_HTTP_REQUESTS$1=4;var EventTypes$1;(function(_){_[_.SENDING_QUERY=0]="SENDING_QUERY",_[_.PEER_RESPONSE=1]="PEER_RESPONSE",_[_.FINAL_PEER=2]="FINAL_PEER",_[_.QUERY_ERROR=3]="QUERY_ERROR",_[_.PROVIDER=4]="PROVIDER",_[_.VALUE=5]="VALUE",_[_.ADDING_PEER=6]="ADDING_PEER",_[_.DIALING_PEER=7]="DIALING_PEER"})(EventTypes$1||(EventTypes$1={}));var MessageType$1;(function(_){_[_.PUT_VALUE=0]="PUT_VALUE",_[_.GET_VALUE=1]="GET_VALUE",_[_.ADD_PROVIDER=2]="ADD_PROVIDER",_[_.GET_PROVIDERS=3]="GET_PROVIDERS",_[_.FIND_NODE=4]="FIND_NODE",_[_.PING=5]="PING"})(MessageType$1||(MessageType$1={}));class DelegatedPeerRouting{constructor(a){if(a==null)throw new Error("missing ipfs http client");this.client=a,this.started=!1,this.abortController=new AbortController,this.httpQueue=new PQueue({concurrency:CONCURRENT_HTTP_REQUESTS$1});const{protocol:$,host:j,port:_e}=a.getEndpointConfig();log$W(`enabled DelegatedPeerRouting via ${$}://${j}:${_e}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async findPeer(a,$={}){log$W("findPeer starts: %p",a),$.timeout=$.timeout??DEFAULT_TIMEOUT$1,$.signal=anySignal$2.exports([this.abortController.signal].concat($.signal!=null?[$.signal]:[]));const j=pDefer$2(),_e=pDefer$2();this.httpQueue.add(async()=>(j.resolve(),await _e.promise));try{await j.promise;for await(const et of this.client.dht.findPeer(a,$))if(et.name==="FINAL_PEER")return{id:et.peer.id,multiaddrs:et.peer.multiaddrs,protocols:[]}}catch(et){throw log$W.error("findPeer errored: %o",et),et}finally{_e.resolve(),log$W("findPeer finished: %p",a)}throw errCode(new Error("Not found"),"ERR_NOT_FOUND")}async*getClosestPeers(a,$={}){let j;const _e=CID.asCID(a);_e!=null?j=_e:j=peerIdFromBytes(a),log$W("getClosestPeers starts: %s",j),$.timeout=$.timeout??DEFAULT_TIMEOUT$1,$.signal=anySignal$2.exports([this.abortController.signal].concat($.signal!=null?[$.signal]:[]));const et=pDefer$2(),tt=pDefer$2();this.httpQueue.add(async()=>(et.resolve(),await tt.promise));try{await et.promise;for await(const rt of this.client.dht.query(j,$))rt.name==="PEER_RESPONSE"&&(yield*rt.closer.map(nt=>({id:nt.id,multiaddrs:nt.multiaddrs,protocols:[]})))}catch(rt){throw log$W.error("getClosestPeers errored:",rt),rt}finally{tt.resolve(),log$W("getClosestPeers finished: %b",a)}}}function delegatedPeerRouting(_){return()=>new DelegatedPeerRouting(_)}const drain$1=async _=>{for await(const a of _);};var itDrain$1=drain$1;const log$V=logger$1("libp2p:delegated-content-routing"),DEFAULT_TIMEOUT=3e4,CONCURRENT_HTTP_REQUESTS=4,CONCURRENT_HTTP_REFS_REQUESTS=2;var EventTypes;(function(_){_[_.SENDING_QUERY=0]="SENDING_QUERY",_[_.PEER_RESPONSE=1]="PEER_RESPONSE",_[_.FINAL_PEER=2]="FINAL_PEER",_[_.QUERY_ERROR=3]="QUERY_ERROR",_[_.PROVIDER=4]="PROVIDER",_[_.VALUE=5]="VALUE",_[_.ADDING_PEER=6]="ADDING_PEER",_[_.DIALING_PEER=7]="DIALING_PEER"})(EventTypes||(EventTypes={}));var MessageType;(function(_){_[_.PUT_VALUE=0]="PUT_VALUE",_[_.GET_VALUE=1]="GET_VALUE",_[_.ADD_PROVIDER=2]="ADD_PROVIDER",_[_.GET_PROVIDERS=3]="GET_PROVIDERS",_[_.FIND_NODE=4]="FIND_NODE",_[_.PING=5]="PING"})(MessageType||(MessageType={}));class DelegatedContentRouting{constructor(a){if(a==null)throw new Error("missing ipfs http client");this.client=a,this.started=!1,this.abortController=new AbortController,this.httpQueue=new PQueue({concurrency:CONCURRENT_HTTP_REQUESTS}),this.httpQueueRefs=new PQueue({concurrency:CONCURRENT_HTTP_REFS_REQUESTS});const{protocol:$,host:j,port:_e}=a.getEndpointConfig();log$V(`enabled DelegatedContentRouting via ${$}://${j}:${_e}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.httpQueueRefs.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async*findProviders(a,$={}){log$V("findProviders starts: %c",a),$.timeout=$.timeout??DEFAULT_TIMEOUT,$.signal=anySignal$2.exports([this.abortController.signal].concat($.signal!=null?[$.signal]:[]));const j=pDefer$2(),_e=pDefer$2();this.httpQueue.add(async()=>(j.resolve(),await _e.promise));try{await j.promise;for await(const et of this.client.dht.findProvs(a,$))et.name==="PROVIDER"&&(yield*et.providers.map(tt=>({id:tt.id,protocols:[],multiaddrs:tt.multiaddrs})))}catch(et){throw log$V.error("findProviders errored:",et),et}finally{_e.resolve(),log$V("findProviders finished: %c",a)}}async provide(a,$={}){log$V("provide starts: %c",a),$.timeout=$.timeout??DEFAULT_TIMEOUT,$.signal=anySignal$2.exports([this.abortController.signal].concat($.signal!=null?[$.signal]:[])),await this.httpQueueRefs.add(async()=>{await this.client.block.stat(a,$),await itDrain$1(this.client.dht.provide(a,$))}),log$V("provide finished: %c",a)}async put(a,$,j={}){log$V("put value start: %b",a),j.timeout=j.timeout??DEFAULT_TIMEOUT,j.signal=anySignal$2.exports([this.abortController.signal].concat(j.signal!=null?[j.signal]:[])),await this.httpQueue.add(async()=>{await itDrain$1(this.client.dht.put(a,$,j))}),log$V("put value finished: %b",a)}async get(a,$={}){return log$V("get value start: %b",a),$.timeout=$.timeout??DEFAULT_TIMEOUT,$.signal=anySignal$2.exports([this.abortController.signal].concat($.signal!=null?[$.signal]:[])),await this.httpQueue.add(async()=>{for await(const j of this.client.dht.get(a,$))if(j.name==="VALUE")return log$V("get value finished: %b",a),j.value;throw errCode(new Error("Not found"),"ERR_NOT_FOUND")})}}function delegatedContentRouting(_){return()=>new DelegatedContentRouting(_)}const LOAD_BASE=_=>Promise.reject(new Error(`No base found for "${_}"`));class Multibases{constructor(a){this._basesByName={},this._basesByPrefix={},this._loadBase=a.loadBase||LOAD_BASE;for(const $ of a.bases)this.addBase($)}addBase(a){if(this._basesByName[a.name]||this._basesByPrefix[a.prefix])throw new Error(`Codec already exists for codec "${a.name}"`);this._basesByName[a.name]=a,this._basesByPrefix[a.prefix]=a}removeBase(a){delete this._basesByName[a.name],delete this._basesByPrefix[a.prefix]}async getBase(a){if(this._basesByName[a])return this._basesByName[a];if(this._basesByPrefix[a])return this._basesByPrefix[a];const $=await this._loadBase(a);return this._basesByName[$.name]==null&&this._basesByPrefix[$.prefix]==null&&this.addBase($),$}listBases(){return Object.values(this._basesByName)}}const LOAD_CODEC=_=>Promise.reject(new Error(`No codec found for "${_}"`));class Multicodecs{constructor(a){this._codecsByName={},this._codecsByCode={},this._loadCodec=a.loadCodec||LOAD_CODEC;for(const $ of a.codecs)this.addCodec($)}addCodec(a){if(this._codecsByName[a.name]||this._codecsByCode[a.code])throw new Error(`Resolver already exists for codec "${a.name}"`);this._codecsByName[a.name]=a,this._codecsByCode[a.code]=a}removeCodec(a){delete this._codecsByName[a.name],delete this._codecsByCode[a.code]}async getCodec(a){const $=typeof a=="string"?this._codecsByName:this._codecsByCode;if($[a])return $[a];const j=await this._loadCodec(a);return $[a]==null&&this.addCodec(j),j}listCodecs(){return Object.values(this._codecsByName)}}const LOAD_HASHER=_=>Promise.reject(new Error(`No hasher found for "${_}"`));class Multihashes{constructor(a){this._hashersByName={},this._hashersByCode={},this._loadHasher=a.loadHasher||LOAD_HASHER;for(const $ of a.hashers)this.addHasher($)}addHasher(a){if(this._hashersByName[a.name]||this._hashersByCode[a.code])throw new Error(`Resolver already exists for codec "${a.name}"`);this._hashersByName[a.name]=a,this._hashersByCode[a.code]=a}removeHasher(a){delete this._hashersByName[a.name],delete this._hashersByCode[a.code]}async getHasher(a){const $=typeof a=="string"?this._hashersByName:this._hashersByCode;if($[a])return $[a];const j=await this._loadHasher(a);return $[a]==null&&this.addHasher(j),j}listHashers(){return Object.values(this._hashersByName)}}function toUrlString(_){try{_=multiaddrToUri(multiaddr(_))}catch{}return _=_.toString(),_}const getAgent=()=>{},log$U=logger$1("ipfs-http-client:lib:error-handler"),merge$1=mergeOptions$g.bind({ignoreUndefined:!0}),DEFAULT_PROTOCOL=env.isBrowser||env.isWebWorker?location.protocol:"http",DEFAULT_HOST=env.isBrowser||env.isWebWorker?location.hostname:"localhost",DEFAULT_PORT=env.isBrowser||env.isWebWorker?location.port:"5001",normalizeOptions=(_={})=>{let a,$={},j;if(typeof _=="string"||isMultiaddr(_))a=new URL(toUrlString(_));else if(_ instanceof URL)a=_;else if(typeof _.url=="string"||isMultiaddr(_.url))a=new URL(toUrlString(_.url)),$=_;else if(_.url instanceof URL)a=_.url,$=_;else{$=_||{};const _e=($.protocol||DEFAULT_PROTOCOL).replace(":",""),et=($.host||DEFAULT_HOST).split(":")[0],tt=$.port||DEFAULT_PORT;a=new URL(`${_e}://${et}:${tt}`)}if($.apiPath?a.pathname=$.apiPath:(a.pathname==="/"||a.pathname===void 0)&&(a.pathname="api/v0"),env.isNode){const _e=getAgent();j=$.agent||new _e({keepAlive:!0,maxSockets:6})}return{...$,host:a.host,protocol:a.protocol.replace(":",""),port:Number(a.port),apiPath:a.pathname,url:a,agent:j}},errorHandler=async _=>{let a;try{if((_.headers.get("Content-Type")||"").startsWith("application/json")){const j=await _.json();log$U(j),a=j.Message||j.message}else a=await _.text()}catch(j){log$U("Failed to parse error response",j),a=j.message}let $=new http.HTTPError(_);throw a&&(a.includes("deadline has elapsed")&&($=new http.TimeoutError),a&&a.includes("context deadline exceeded")&&($=new http.TimeoutError)),a&&a.includes("request timed out")&&($=new http.TimeoutError),a&&($.message=a),$},KEBAB_REGEX=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,kebabCase=_=>_.replace(KEBAB_REGEX,function(a){return"-"+a.toLowerCase()}),parseTimeout=_=>typeof _=="string"?parse$3(_):_;class Client extends http{constructor(a={}){const $=normalizeOptions(a);super({timeout:parseTimeout($.timeout||0)||void 0,headers:$.headers,base:`${$.url}`,handleError:errorHandler,transformSearchParams:_e=>{const et=new URLSearchParams;for(const[tt,rt]of _e)rt!=="undefined"&&rt!=="null"&&tt!=="signal"&&et.append(kebabCase(tt),rt),tt==="timeout"&&!isNaN(rt)&&et.append(kebabCase(tt),rt);return et},agent:$.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;const j=this.fetch;this.fetch=(_e,et={})=>(typeof _e=="string"&&!_e.startsWith("/")&&(_e=`${$.url}/${_e}`),j.call(this,_e,merge$1(et,{method:"POST"})))}}http.HTTPError;const configure=_=>a=>_(new Client(a),a);function modeToString$1(_){if(_!=null)return typeof _=="string"?_:_.toString(8).padStart(4,"0")}function parseMtime(_){if(_==null)return;let a;if(_.secs!=null&&(a={secs:_.secs,nsecs:_.nsecs}),_.Seconds!=null&&(a={secs:_.Seconds,nsecs:_.FractionalNanoseconds}),Array.isArray(_)&&(a={secs:_[0],nsecs:_[1]}),_ instanceof Date){const $=_.getTime(),j=Math.floor($/1e3);a={secs:j,nsecs:($-j*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(a,"secs")){if(a!=null&&a.nsecs!=null&&(a.nsecs<0||a.nsecs>999999999))throw errCode(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return a}}function toUrlSearchParams({arg:_,searchParams:a,hashAlg:$,mtime:j,mode:_e,...et}={}){a&&(et={...et,...a}),$&&(et.hash=$),j!=null&&(j=parseMtime(j),et.mtime=j.secs,et.mtimeNsecs=j.nsecs),_e!=null&&(et.mode=modeToString$1(_e)),et.timeout&&!isNaN(et.timeout)&&(et.timeout=`${et.timeout}ms`),_==null?_=[]:Array.isArray(_)||(_=[_]);const tt=new URLSearchParams(et);return _.forEach(rt=>tt.append("arg",rt)),tt}const createWantlist=configure(_=>{async function a($={}){return((await(await _.post("bitswap/wantlist",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()).Keys||[]).map(_e=>CID.parse(_e["/"]))}return a}),createWantlistForPeer=configure(_=>{async function a($,j={}){return((await(await _.post("bitswap/wantlist",{signal:j.signal,searchParams:toUrlSearchParams({...j,peer:$.toString()}),headers:j.headers})).json()).Keys||[]).map(et=>CID.parse(et["/"]))}return a}),createStat$4=configure(_=>{async function a($={}){const j=await _.post("bitswap/stat",{searchParams:toUrlSearchParams($),signal:$.signal,headers:$.headers});return toCoreInterface$4(await j.json())}return a});function toCoreInterface$4(_){return{provideBufLen:_.ProvideBufLen,wantlist:(_.Wantlist||[]).map(a=>CID.parse(a["/"])),peers:(_.Peers||[]).map(a=>peerIdFromString(a)),blocksReceived:BigInt(_.BlocksReceived),dataReceived:BigInt(_.DataReceived),blocksSent:BigInt(_.BlocksSent),dataSent:BigInt(_.DataSent),dupBlksReceived:BigInt(_.DupBlksReceived),dupDataReceived:BigInt(_.DupDataReceived)}}const createUnwant=configure(_=>{async function a($,j={}){return(await _.post("bitswap/unwant",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString(),...j}),headers:j.headers})).json()}return a});function createBitswap$1(_){return{wantlist:createWantlist(_),wantlistForPeer:createWantlistForPeer(_),unwant:createUnwant(_),stat:createStat$4(_)}}const createGet$5=configure(_=>{async function a($,j={}){const _e=await _.post("block/get",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString(),...j}),headers:j.headers});return new Uint8Array(await _e.arrayBuffer())}return a});async function normaliseContent(_){if(isBytes(_))return new Blob([_]);if(typeof _=="string"||_ instanceof String)return new Blob([_.toString()]);if(isBlob(_))return _;if(isReadableStream(_)&&(_=browserReadableStreamToIt(_)),Symbol.iterator in _||Symbol.asyncIterator in _){const a=peekableIterator(_),{value:$,done:j}=await a.peek();if(j)return itToBlob(a);if(a.push($),Number.isInteger($))return new Blob([Uint8Array.from(await all$5(a))]);if(isBytes($)||typeof $=="string"||$ instanceof String)return itToBlob(a)}throw errCode(new Error(`Unexpected input: ${_}`),"ERR_UNEXPECTED_INPUT")}async function itToBlob(_){const a=[];for await(const $ of _)a.push($);return new Blob(a)}function normaliseInput(_){return normaliseCandidateMultiple(_,normaliseContent)}function modeToString(_){if(_!=null)return typeof _=="string"?_:_.toString(8).padStart(4,"0")}async function multipartRequest(_,a,$={}){const j=[],_e=new FormData;let et=0,tt=0;for await(const{content:rt,path:nt,mode:it,mtime:st}of normaliseInput(_)){let ot="";const at=rt?"file":"dir";et>0&&(ot=`-${et}`);let lt=at+ot;const ct=[];if(it!=null&&ct.push(`mode=${modeToString(it)}`),st!=null){const{secs:ut,nsecs:dt}=st;ct.push(`mtime=${ut}`),dt!=null&&ct.push(`mtime-nsecs=${dt}`)}if(ct.length&&(lt=`${lt}?${ct.join("&")}`),rt){_e.set(lt,rt,nt!=null?encodeURIComponent(nt):void 0);const ut=tt+rt.size;j.push({name:nt,start:tt,end:ut}),tt=ut}else if(nt!=null)_e.set(lt,new File([""],encodeURIComponent(nt),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");et++}return{total:tt,parts:j,headers:$,body:_e}}function filter$1(_){return _.filter(Boolean)}function abortSignal(..._){return anySignal_2(filter$1(_))}const createPut$3=configure(_=>{async function a($,j={}){const _e=new AbortController,et=abortSignal(_e.signal,j.signal);let tt;try{tt=await(await _.post("block/put",{signal:et,searchParams:toUrlSearchParams(j),...await multipartRequest([$],_e,j.headers)})).json()}catch(rt){if(j.format==="dag-pb")return a($,{...j,format:"protobuf"});if(j.format==="dag-cbor")return a($,{...j,format:"cbor"});throw rt}return CID.parse(tt.Key)}return a}),createRm$6=configure(_=>{async function*a($,j={}){Array.isArray($)||($=[$]);const _e=await _.post("block/rm",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.map(et=>et.toString()),"stream-channels":!0,...j}),headers:j.headers});for await(const et of _e.ndjson())yield toCoreInterface$3(et)}return a});function toCoreInterface$3(_){const a={cid:CID.parse(_.Hash)};return _.Error&&(a.error=new Error(_.Error)),a}const createStat$3=configure(_=>{async function a($,j={}){const et=await(await _.post("block/stat",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString(),...j}),headers:j.headers})).json();return{cid:CID.parse(et.Key),size:et.Size}}return a});function createBlock(_){return{get:createGet$5(_),put:createPut$3(_),rm:createRm$6(_),stat:createStat$3(_)}}const createAdd$4=configure(_=>{async function a($,j={}){const _e=await _.post("bootstrap/add",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers}),{Peers:et}=await _e.json();return{Peers:et.map(tt=>multiaddr(tt))}}return a}),createClear=configure(_=>{async function a($={}){const j=await _.post("bootstrap/rm",{signal:$.signal,searchParams:toUrlSearchParams({...$,all:!0}),headers:$.headers}),{Peers:_e}=await j.json();return{Peers:_e.map(et=>multiaddr(et))}}return a}),createList$2=configure(_=>{async function a($={}){const j=await _.post("bootstrap/list",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers}),{Peers:_e}=await j.json();return{Peers:_e.map(et=>multiaddr(et))}}return a}),createReset=configure(_=>{async function a($={}){const j=await _.post("bootstrap/add",{signal:$.signal,searchParams:toUrlSearchParams({...$,default:!0}),headers:$.headers}),{Peers:_e}=await j.json();return{Peers:_e.map(et=>multiaddr(et))}}return a}),createRm$5=configure(_=>{async function a($,j={}){const _e=await _.post("bootstrap/rm",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers}),{Peers:et}=await _e.json();return{Peers:et.map(tt=>multiaddr(tt))}}return a});function createBootstrap(_){return{add:createAdd$4(_),clear:createClear(_),list:createList$2(_),reset:createReset(_),rm:createRm$5(_)}}const createApply=configure(_=>{async function a($,j={}){const et=await(await _.post("config/profile/apply",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).json();return{original:et.OldCfg,updated:et.NewCfg}}return a});function objectToCamel(_){if(_==null)return _;const a=/^[A-Z]+$/,$={};return Object.keys(_).reduce((j,_e)=>(a.test(_e)?j[_e.toLowerCase()]=_[_e]:a.test(_e[0])?j[_e[0].toLowerCase()+_e.slice(1)]=_[_e]:j[_e]=_[_e],j),$)}const createList$1=configure(_=>{async function a($={}){return(await(await _.post("config/profile/list",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()).map(et=>objectToCamel(et))}return a});function createProfiles(_){return{apply:createApply(_),list:createList$1(_)}}const createGet$4=configure(_=>async($,j={})=>{if(!$)throw new Error("key argument is required");return(await(await _.post("config",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).json()).Value}),createGetAll=configure(_=>async($={})=>await(await _.post("config/show",{signal:$.signal,searchParams:toUrlSearchParams({...$}),headers:$.headers})).json()),createReplace=configure(_=>async($,j={})=>{const _e=new AbortController,et=abortSignal(_e.signal,j.signal);await(await _.post("config/replace",{signal:et,searchParams:toUrlSearchParams(j),...await multipartRequest([fromString$5(JSON.stringify($))],_e,j.headers)})).text()}),createSet=configure(_=>async($,j,_e={})=>{if(typeof $!="string")throw new Error("Invalid key type");const et={..._e,...encodeParam($,j)};await(await _.post("config",{signal:_e.signal,searchParams:toUrlSearchParams(et),headers:_e.headers})).text()}),encodeParam=(_,a)=>{switch(typeof a){case"boolean":return{arg:[_,a.toString()],bool:!0};case"string":return{arg:[_,a]};default:return{arg:[_,JSON.stringify(a)],json:!0}}};function createConfig(_){return{getAll:createGetAll(_),get:createGet$4(_),set:createSet(_),replace:createReplace(_),profiles:createProfiles(_)}}const createExport$1=configure(_=>{async function*a($,j={}){yield*(await _.post("dag/export",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString()}),headers:j.headers})).iterator()}return a});async function*resolve(_,a,$,j,_e){const et=async it=>{const st=await $.getCodec(it.code),ot=await j(it,_e);return st.decode(ot)},tt=a.split("/").filter(Boolean);let rt=await et(_),nt=_;for(;tt.length;){const it=tt.shift();if(!it)throw errCode(new Error(`Could not resolve path "${a}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(rt,it))rt=rt[it],yield{value:rt,remainderPath:tt.join("/")};else throw errCode(new Error(`no link named "${it}" under ${nt}`),"ERR_NO_LINK");const st=CID.asCID(rt);st&&(nt=st,rt=await et(rt))}yield{value:rt,remainderPath:""}}const createGet$3=(_,a)=>configure((j,_e)=>{const et=createGet$5(_e);return async(rt,nt={})=>{if(nt.path){const lt=nt.localResolve?await first$2(resolve(rt,nt.path,_,et,nt)):await last(resolve(rt,nt.path,_,et,nt));if(!lt)throw errCode(new Error("Not found"),"ERR_NOT_FOUND");return lt}const it=await _.getCodec(rt.code),st=await et(rt,nt);return{value:it.decode(st),remainderPath:""}}})(a),createImport$1=configure(_=>{async function*a($,j={}){const _e=new AbortController,et=abortSignal(_e.signal,j.signal),{headers:tt,body:rt}=await multipartRequest($,_e,j.headers),nt=await _.post("dag/import",{signal:et,headers:tt,body:rt,searchParams:toUrlSearchParams({"pin-roots":j.pinRoots})});for await(const{Root:it}of nt.ndjson())if(it!==void 0){const{Cid:{"/":st},PinErrorMsg:ot}=it;yield{root:{cid:CID.parse(st),pinErrorMsg:ot}}}}return a}),createPut$2=(_,a)=>configure(j=>async(et,tt={})=>{const rt={storeCodec:"dag-cbor",hashAlg:"sha2-256",...tt};let nt;if(rt.inputCodec){if(!(et instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");nt=et}else nt=(await _.getCodec(rt.storeCodec)).encode(et),rt.inputCodec=rt.storeCodec;const it=new AbortController,st=abortSignal(it.signal,rt.signal),at=await(await j.post("dag/put",{timeout:rt.timeout,signal:st,searchParams:toUrlSearchParams(rt),...await multipartRequest([nt],it,rt.headers)})).json();return CID.parse(at.Cid["/"])})(a),createResolve$2=configure(_=>async($,j={})=>{const et=await(await _.post("dag/resolve",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$}${j.path?`/${j.path}`.replace(/\/[/]+/g,"/"):""}`,...j}),headers:j.headers})).json();return{cid:CID.parse(et.Cid["/"]),remainderPath:et.RemPath}});function createDag(_,a){return{export:createExport$1(a),get:createGet$3(_,a),import:createImport$1(a),put:createPut$2(_,a),resolve:createResolve$2(a)}}const SendingQuery=0,PeerResponse=1,FinalPeer=2,QueryError=3,Provider=4,Value=5,AddingPeer=6,DialingPeer=7,mapEvent=_=>{if(_.Type===SendingQuery)return{name:"SENDING_QUERY",type:_.Type};if(_.Type===PeerResponse)return{from:peerIdFromString(_.ID),name:"PEER_RESPONSE",type:_.Type,messageType:0,messageName:"PUT_VALUE",closer:(_.Responses||[]).map(({ID:a,Addrs:$})=>({id:peerIdFromString(a),multiaddrs:$.map(j=>multiaddr(j)),protocols:[]})),providers:(_.Responses||[]).map(({ID:a,Addrs:$})=>({id:peerIdFromString(a),multiaddrs:$.map(j=>multiaddr(j)),protocols:[]}))};if(_.Type===FinalPeer){let a={id:_.ID??peerIdFromString(_.ID),multiaddrs:[],protocols:[]};return _.Responses&&_.Responses.length&&(a={id:peerIdFromString(_.Responses[0].ID),multiaddrs:_.Responses[0].Addrs.map($=>multiaddr($)),protocols:[]}),{name:"FINAL_PEER",type:_.Type,peer:a}}if(_.Type===QueryError)return{name:"QUERY_ERROR",type:_.Type,error:new Error(_.Extra)};if(_.Type===Provider)return{name:"PROVIDER",type:_.Type,providers:_.Responses.map(({ID:a,Addrs:$})=>({id:peerIdFromString(a),multiaddrs:$.map(j=>multiaddr(j)),protocols:[]}))};if(_.Type===Value)return{name:"VALUE",type:_.Type,value:fromString$5(_.Extra,"base64pad")};if(_.Type===AddingPeer){const a=_.Responses.map(({ID:$})=>peerIdFromString($));if(!a.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:_.Type,peer:a[0]}}if(_.Type===DialingPeer)return{name:"DIALING_PEER",type:_.Type,peer:peerIdFromString(_.ID)};throw new Error("Unknown DHT event type")},createFindPeer=configure(_=>{async function*a($,j={}){const _e=await _.post("dht/findpeer",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers});for await(const et of _e.ndjson())yield mapEvent(et)}return a}),createFindProvs=configure(_=>{async function*a($,j={}){const _e=await _.post("dht/findprovs",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString(),...j}),headers:j.headers});for await(const et of _e.ndjson())yield mapEvent(et)}return a}),createGet$2=configure(_=>{async function*a($,j={}){const _e=await _.post("dht/get",{signal:j.signal,searchParams:toUrlSearchParams({arg:$ instanceof Uint8Array?toString$6($):$.toString(),...j}),headers:j.headers});for await(const et of _e.ndjson())yield mapEvent(et)}return a}),createProvide=configure(_=>{async function*a($,j={recursive:!1}){const _e=Array.isArray($)?$:[$],et=await _.post("dht/provide",{signal:j.signal,searchParams:toUrlSearchParams({arg:_e.map(tt=>tt.toString()),...j}),headers:j.headers});for await(const tt of et.ndjson())yield mapEvent(tt)}return a}),createPut$1=configure(_=>{async function*a($,j,_e={}){const et=new AbortController,tt=abortSignal(et.signal,_e.signal),rt=await _.post("dht/put",{signal:tt,searchParams:toUrlSearchParams({arg:$ instanceof Uint8Array?toString$6($):$.toString(),..._e}),...await multipartRequest([j],et,_e.headers)});for await(const nt of rt.ndjson())yield mapEvent(nt)}return a}),createQuery=configure(_=>{async function*a($,j={}){const _e=await _.post("dht/query",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString(),...j}),headers:j.headers});for await(const et of _e.ndjson())yield mapEvent(et)}return a});function createDht$1(_){return{findPeer:createFindPeer(_),findProvs:createFindProvs(_),get:createGet$2(_),provide:createProvide(_),put:createPut$1(_),query:createQuery(_)}}const createCmds=configure(_=>{async function a($={}){return(await _.post("diag/cmds",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()}return a}),createNet=configure(_=>{async function a($={}){return(await _.post("diag/net",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()}return a}),createSys=configure(_=>{async function a($={}){return(await _.post("diag/sys",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()}return a});function createDiag(_){return{cmds:createCmds(_),net:createNet(_),sys:createSys(_)}}const createChmod=configure(_=>{async function a($,j,_e={}){await(await _.post("files/chmod",{signal:_e.signal,searchParams:toUrlSearchParams({arg:$,mode:j,..._e}),headers:_e.headers})).text()}return a}),createCp=configure(_=>{async function a($,j,_e={}){const et=Array.isArray($)?$:[$];await(await _.post("files/cp",{signal:_e.signal,searchParams:toUrlSearchParams({arg:et.concat(j).map(rt=>CID.asCID(rt)?`/ipfs/${rt}`:rt),..._e}),headers:_e.headers})).text()}return a}),createFlush=configure(_=>{async function a($,j={}){if(!$||typeof $!="string")throw new Error("ipfs.files.flush requires a path");const et=await(await _.post("files/flush",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).json();return CID.parse(et.Cid)}return a});function objectToCamelWithMetadata(_){const a=objectToCamel(_);return Object.prototype.hasOwnProperty.call(a,"mode")&&(a.mode=parseInt(a.mode,8)),Object.prototype.hasOwnProperty.call(a,"mtime")&&(a.mtime={secs:a.mtime,nsecs:a.mtimeNsecs||0},delete a.mtimeNsecs),a}const createLs$6=configure(_=>{async function*a($,j={}){if(!$)throw new Error("ipfs.files.ls requires a path");const _e=await _.post("files/ls",{signal:j.signal,searchParams:toUrlSearchParams({arg:CID.asCID($)?`/ipfs/${$}`:$,long:!0,...j,stream:!0}),headers:j.headers});for await(const et of _e.ndjson())if("Entries"in et)for(const tt of et.Entries||[])yield toCoreInterface$2(objectToCamelWithMetadata(tt));else yield toCoreInterface$2(objectToCamelWithMetadata(et))}return a});function toCoreInterface$2(_){return _.hash&&(_.cid=CID.parse(_.hash)),delete _.hash,_.type=_.type===1?"directory":"file",_}const createMkdir=configure(_=>{async function a($,j={}){await(await _.post("files/mkdir",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).text()}return a}),createMv=configure(_=>{async function a($,j,_e={}){Array.isArray($)||($=[$]),await(await _.post("files/mv",{signal:_e.signal,searchParams:toUrlSearchParams({arg:$.concat(j),..._e}),headers:_e.headers})).text()}return a});var source$1=_=>{if(_[Symbol.asyncIterator])return _;if(_.getReader)return async function*(){const a=_.getReader();try{for(;;){const{done:$,value:j}=await a.read();if($)return;yield j}}finally{a.releaseLock()}}();throw new Error("unknown stream")};const createRead=configure(_=>{async function*a($,j={}){const _e=await _.post("files/read",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,count:j.length,...j}),headers:j.headers});yield*source$1(_e.body)}return a}),createRm$4=configure(_=>{async function a($,j={}){const _e=await _.post("files/rm",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers}),et=await _e.text();if(et!==""){const tt=new http.HTTPError(_e);throw tt.message=et,tt}}return a}),createStat$2=configure(_=>{async function a($,j={}){const et=await(await _.post("files/stat",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).json();return et.WithLocality=et.WithLocality||!1,toCoreInterface$1(objectToCamelWithMetadata(et))}return a});function toCoreInterface$1(_){return _.cid=CID.parse(_.hash),delete _.hash,_}const createTouch=configure(_=>{async function a($,j={}){await(await _.post("files/touch",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).text()}return a}),createWrite=configure(_=>{async function a($,j,_e={}){const et=new AbortController,tt=abortSignal(et.signal,_e.signal);await(await _.post("files/write",{signal:tt,searchParams:toUrlSearchParams({arg:$,streamChannels:!0,count:_e.length,..._e}),...await multipartRequest([{content:j,path:"arg",mode:modeToString$1(_e.mode),mtime:parseMtime(_e.mtime)}],et,_e.headers)})).text()}return a});function createFiles(_){return{chmod:createChmod(_),cp:createCp(_),flush:createFlush(_),ls:createLs$6(_),mkdir:createMkdir(_),mv:createMv(_),read:createRead(_),rm:createRm$4(_),stat:createStat$2(_),touch:createTouch(_),write:createWrite(_)}}const createExport=configure(_=>async($,j,_e={})=>{throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),createGen=configure(_=>{async function a($,j={type:"Ed25519"}){const et=await(await _.post("key/gen",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).json();return objectToCamel(et)}return a}),createImport=configure(_=>{async function a($,j,_e,et={}){const rt=await(await _.post("key/import",{signal:et.signal,searchParams:toUrlSearchParams({arg:$,pem:j,password:_e,...et}),headers:et.headers})).json();return objectToCamel(rt)}return a}),createInfo=configure(_=>async($,j={})=>{throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),createList=configure(_=>{async function a($={}){return((await(await _.post("key/list",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()).Keys||[]).map(et=>objectToCamel(et))}return a}),createRename=configure(_=>{async function a($,j,_e={}){const et=await _.post("key/rename",{signal:_e.signal,searchParams:toUrlSearchParams({arg:[$,j],..._e}),headers:_e.headers});return objectToCamel(await et.json())}return a}),createRm$3=configure(_=>{async function a($,j={}){const et=await(await _.post("key/rm",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).json();return objectToCamel(et.Keys[0])}return a});function createKey(_){return{export:createExport(_),gen:createGen(_),import:createImport(_),info:createInfo(_),list:createList(_),rename:createRename(_),rm:createRm$3(_)}}const createLevel=configure(_=>{async function a($,j,_e={}){const et=await _.post("log/level",{signal:_e.signal,searchParams:toUrlSearchParams({arg:[$,j],..._e}),headers:_e.headers});return objectToCamel(await et.json())}return a}),createLs$5=configure(_=>{async function a($={}){return(await(await _.post("log/ls",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()).Strings}return a}),createTail=configure(_=>{async function*a($={}){yield*(await _.post("log/tail",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).ndjson()}return a});function createLog(_){return{level:createLevel(_),ls:createLs$5(_),tail:createTail(_)}}const createPublish$1=configure(_=>{async function a($,j={}){const _e=await _.post("name/publish",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$}`,...j}),headers:j.headers});return objectToCamel(await _e.json())}return a}),createResolve$1=configure(_=>{async function*a($,j={}){const _e=await _.post("name/resolve",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,stream:!0,...j}),headers:j.headers});for await(const et of _e.ndjson())yield et.Path}return a}),createCancel=configure(_=>{async function a($,j={}){const _e=await _.post("name/pubsub/cancel",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers});return objectToCamel(await _e.json())}return a}),createState=configure(_=>{async function a($={}){const j=await _.post("name/pubsub/state",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers});return objectToCamel(await j.json())}return a}),createSubs=configure(_=>{async function a($={}){return(await(await _.post("name/pubsub/subs",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()).Strings||[]}return a});function createPubsub$2(_){return{cancel:createCancel(_),state:createState(_),subs:createSubs(_)}}function createName(_){return{publish:createPublish$1(_),resolve:createResolve$1(_),pubsub:createPubsub$2(_)}}const createData=configure(_=>{async function a($,j={}){const et=await(await _.post("object/data",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$ instanceof Uint8Array?CID.decode($):$}`,...j}),headers:j.headers})).arrayBuffer();return new Uint8Array(et,0,et.byteLength)}return a}),createGet$1=configure(_=>{async function a($,j={}){const et=await(await _.post("object/get",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$ instanceof Uint8Array?CID.decode($):$}`,dataEncoding:"base64",...j}),headers:j.headers})).json();return{Data:fromString$5(et.Data,"base64pad"),Links:(et.Links||[]).map(tt=>({Name:tt.Name,Hash:CID.parse(tt.Hash),Tsize:tt.Size}))}}return a}),createLinks=configure(_=>{async function a($,j={}){return((await(await _.post("object/links",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$ instanceof Uint8Array?CID.decode($):$}`,...j}),headers:j.headers})).json()).Links||[]).map(tt=>({Name:tt.Name,Tsize:tt.Size,Hash:CID.parse(tt.Hash)}))}return a}),createNew=configure(_=>{async function a($={}){const j=await _.post("object/new",{signal:$.signal,searchParams:toUrlSearchParams({arg:$.template,...$}),headers:$.headers}),{Hash:_e}=await j.json();return CID.parse(_e)}return a}),createPut=(_,a)=>configure(j=>{const _e=createPut$2(_,a);async function et(tt,rt={}){return _e(tt,{...rt,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return et})(a),createStat$1=configure(_=>{async function a($,j={}){const et=await(await _.post("object/stat",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$}`,...j}),headers:j.headers})).json();return{...et,Hash:CID.parse(et.Hash)}}return a}),createAddLink=configure(_=>{async function a($,j,_e={}){const et=await _.post("object/patch/add-link",{signal:_e.signal,searchParams:toUrlSearchParams({arg:[`${$}`,j.Name||j.name||"",(j.Hash||j.cid||"").toString()||null],..._e}),headers:_e.headers}),{Hash:tt}=await et.json();return CID.parse(tt)}return a}),createAppendData=configure(_=>{async function a($,j,_e={}){const et=new AbortController,tt=abortSignal(et.signal,_e.signal),rt=await _.post("object/patch/append-data",{signal:tt,searchParams:toUrlSearchParams({arg:`${$}`,..._e}),...await multipartRequest([j],et,_e.headers)}),{Hash:nt}=await rt.json();return CID.parse(nt)}return a}),createRmLink=configure(_=>{async function a($,j,_e={}){const et=await _.post("object/patch/rm-link",{signal:_e.signal,searchParams:toUrlSearchParams({arg:[`${$}`,j.Name||j.name||null],..._e}),headers:_e.headers}),{Hash:tt}=await et.json();return CID.parse(tt)}return a}),createSetData=configure(_=>{async function a($,j,_e={}){const et=new AbortController,tt=abortSignal(et.signal,_e.signal),rt=await _.post("object/patch/set-data",{signal:tt,searchParams:toUrlSearchParams({arg:[`${$}`],..._e}),...await multipartRequest([j],et,_e.headers)}),{Hash:nt}=await rt.json();return CID.parse(nt)}return a});function createPatch(_){return{addLink:createAddLink(_),appendData:createAppendData(_),rmLink:createRmLink(_),setData:createSetData(_)}}function createObject(_,a){return{data:createData(a),get:createGet$1(a),links:createLinks(a),new:createNew(a),put:createPut(_,a),stat:createStat$1(a),patch:createPatch(a)}}const createAddAll$1=configure(_=>{async function*a($,j={}){for await(const{path:_e,recursive:et,metadata:tt}of normaliseInput$3($)){const rt=await _.post("pin/add",{signal:j.signal,searchParams:toUrlSearchParams({...j,arg:_e,recursive:et,metadata:tt?JSON.stringify(tt):void 0,stream:!0}),headers:j.headers});for await(const nt of rt.ndjson()){if(nt.Pins){for(const it of nt.Pins)yield CID.parse(it);continue}yield CID.parse(nt)}}}return a});function createAdd$3(_){const a=createAddAll$1(_);return configure(()=>{async function $(j,_e={}){return last(a([{path:j,..._e}],_e))}return $})(_)}function toPin(_,a,$){const j={type:_,cid:CID.parse(a)};return $&&(j.metadata=$),j}const createLs$4=configure(_=>{async function*a($={}){let j=[];$.paths&&(j=Array.isArray($.paths)?$.paths:[$.paths]);const _e=await _.post("pin/ls",{signal:$.signal,searchParams:toUrlSearchParams({...$,arg:j.map(et=>`${et}`),stream:!0}),headers:$.headers});for await(const et of _e.ndjson()){if(et.Keys){for(const tt of Object.keys(et.Keys))yield toPin(et.Keys[tt].Type,tt,et.Keys[tt].Metadata);return}yield toPin(et.Type,et.Cid,et.Metadata)}}return a}),createRmAll$1=configure(_=>{async function*a($,j={}){for await(const{path:_e,recursive:et}of normaliseInput$3($)){const tt=new URLSearchParams(j.searchParams);tt.append("arg",`${_e}`),et!=null&&tt.set("recursive",String(et));const rt=await _.post("pin/rm",{signal:j.signal,headers:j.headers,searchParams:toUrlSearchParams({...j,arg:`${_e}`,recursive:et})});for await(const nt of rt.ndjson()){if(nt.Pins){yield*nt.Pins.map(it=>CID.parse(it));continue}yield CID.parse(nt)}}}return a}),createRm$2=_=>{const a=createRmAll$1(_);return configure(()=>{async function $(j,_e={}){return last(a([{path:j,..._e}],_e))}return $})(_)},decodePin=({Name:_,Status:a,Cid:$})=>({cid:CID.parse($),name:_,status:a}),encodeService=_=>{if(typeof _=="string"&&_!=="")return _;throw new TypeError("service name must be passed")},encodeCID=_=>{if(CID.asCID(_))return _.toString();throw new TypeError(`CID instance expected instead of ${typeof _}`)},encodeQuery=({service:_,cid:a,name:$,status:j,all:_e})=>{const et=toUrlSearchParams({service:encodeService(_),name:$,force:_e?!0:void 0});if(a)for(const tt of a)et.append("cid",encodeCID(tt));if(j)for(const tt of j)et.append("status",tt);return et},encodeAddParams=({cid:_,service:a,background:$,name:j,origins:_e})=>{const et=toUrlSearchParams({arg:encodeCID(_),service:encodeService(a),name:j,background:$?!0:void 0});if(_e)for(const tt of _e)et.append("origin",tt.toString());return et};function createAdd$2(_){async function a($,{timeout:j,signal:_e,headers:et,...tt}){const rt=await _.post("pin/remote/add",{timeout:j,signal:_e,headers:et,searchParams:encodeAddParams({cid:$,...tt})});return decodePin(await rt.json())}return a}function createLs$3(_){async function*a({timeout:$,signal:j,headers:_e,...et}){const tt=await _.post("pin/remote/ls",{timeout:$,signal:j,headers:_e,searchParams:encodeQuery(et)});for await(const rt of tt.ndjson())yield decodePin(rt)}return a}function createRm$1(_){async function a({timeout:$,signal:j,headers:_e,...et}){await _.post("pin/remote/rm",{timeout:$,signal:j,headers:_e,searchParams:encodeQuery({...et,all:!1})})}return a}function createRmAll(_){async function a({timeout:$,signal:j,headers:_e,...et}){await _.post("pin/remote/rm",{timeout:$,signal:j,headers:_e,searchParams:encodeQuery({...et,all:!0})})}return a}function encodeEndpoint(_){const a=String(_);if(a==="undefined")throw Error("endpoint is required");return a[a.length-1]==="/"?a.slice(0,-1):a}function decodeRemoteService(_){return{service:_.Service,endpoint:new URL(_.ApiEndpoint),..._.Stat&&{stat:decodeStat(_.Stat)}}}function decodeStat(_){switch(_.Status){case"valid":{const{Pinning:a,Pinned:$,Queued:j,Failed:_e}=_.PinCount;return{status:"valid",pinCount:{queued:j,pinning:a,pinned:$,failed:_e}}}case"invalid":return{status:"invalid"};default:return{status:_.Status}}}function createAdd$1(_){async function a($,j){const{endpoint:_e,key:et,headers:tt,timeout:rt,signal:nt}=j;await _.post("pin/remote/service/add",{timeout:rt,signal:nt,searchParams:toUrlSearchParams({arg:[$,encodeEndpoint(_e),et]}),headers:tt})}return a}function createLs$2(_){async function a($={}){const{stat:j,headers:_e,timeout:et,signal:tt}=$,rt=await _.post("pin/remote/service/ls",{timeout:et,signal:tt,headers:_e,searchParams:j===!0?toUrlSearchParams({stat:j}):void 0}),{RemoteServices:nt}=await rt.json();return nt.map(decodeRemoteService)}return a}function createRm(_){async function a($,j={}){await _.post("pin/remote/service/rm",{signal:j.signal,headers:j.headers,searchParams:toUrlSearchParams({arg:$})})}return a}function createService(_){const a=new Client(_);return{add:createAdd$1(a),ls:createLs$2(a),rm:createRm(a)}}function createRemote(_){const a=new Client(_);return{add:createAdd$2(a),ls:createLs$3(a),rm:createRm$1(a),rmAll:createRmAll(a),service:createService(_)}}function createPin(_){return{addAll:createAddAll$1(_),add:createAdd$3(_),ls:createLs$4(_),rmAll:createRmAll$1(_),rm:createRm$2(_),remote:createRemote(_)}}const rpcArrayToTextArray=_=>Array.isArray(_)?_.map(rpcToText):_,rpcToText=_=>toString$6(rpcToBytes(_)),rpcToBytes=_=>base64url$2.decode(_),rpcToBigInt=_=>BigInt(`0x${toString$6(base64url$2.decode(_),"base16")}`),textToUrlSafeRpc=_=>base64url$2.encode(fromString$5(_)),createLs$1=configure(_=>{async function a($={}){const{Strings:j}=await(await _.post("pubsub/ls",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json();return rpcArrayToTextArray(j)||[]}return a}),createPeers$2=configure(_=>{async function a($,j={}){const _e=await _.post("pubsub/peers",{signal:j.signal,searchParams:toUrlSearchParams({arg:textToUrlSafeRpc($),...j}),headers:j.headers}),{Strings:et}=await _e.json();return et||[]}return a}),createPublish=configure(_=>{async function a($,j,_e={}){const et=toUrlSearchParams({arg:textToUrlSafeRpc($),..._e}),tt=new AbortController,rt=abortSignal(tt.signal,_e.signal);await(await _.post("pubsub/pub",{signal:rt,searchParams:et,...await multipartRequest([j],tt,_e.headers)})).text()}return a}),log$T=logger$1("ipfs-http-client:pubsub:subscribe"),createSubscribe=(_,a)=>configure($=>{async function j(_e,et,tt={}){tt.signal=a.subscribe(_e,et,tt.signal);let rt,nt;const it=new Promise((ot,at)=>{rt=ot,nt=at}),st=setTimeout(()=>rt(),1e3);return $.post("pubsub/sub",{signal:tt.signal,searchParams:toUrlSearchParams({arg:textToUrlSafeRpc(_e),...tt}),headers:tt.headers}).catch(ot=>{a.unsubscribe(_e,et),nt(ot)}).then(ot=>{clearTimeout(st),ot&&(readMessages(ot,{onMessage:at=>{if(!!et){if(typeof et=="function"){et(at);return}typeof et.handleEvent=="function"&&et.handleEvent(at)}},onEnd:()=>a.unsubscribe(_e,et),onError:tt.onError}),rt())}),it}return j})(_);async function readMessages(_,{onMessage:a,onEnd:$,onError:j}){j=j||log$T;try{for await(const _e of _.ndjson())try{if(!_e.from)continue;_e.from!=null&&_e.seqno!=null?a({type:"signed",from:peerIdFromString(_e.from),data:rpcToBytes(_e.data),sequenceNumber:rpcToBigInt(_e.seqno),topic:rpcToText(_e.topicIDs[0]),key:rpcToBytes(_e.key??"u"),signature:rpcToBytes(_e.signature??"u")}):a({type:"unsigned",data:rpcToBytes(_e.data),topic:rpcToText(_e.topicIDs[0])})}catch(et){et.message=`Failed to parse pubsub message: ${et.message}`,j(et,!1,_e)}}catch(_e){isAbortError(_e)||j(_e,!0)}finally{$()}}const isAbortError=_=>{switch(_.type){case"aborted":return!0;case"abort":return!0;default:return _.name==="AbortError"}},createUnsubscribe=(_,a)=>{async function $(j,_e){a.unsubscribe(j,_e)}return $};class SubscriptionTracker{constructor(){this._subs=new Map}subscribe(a,$,j){const _e=this._subs.get(a)||[];if(_e.find(tt=>tt.handler===$))throw new Error(`Already subscribed to ${a} with this handler`);const et=new AbortController;return this._subs.set(a,[{handler:$,controller:et}].concat(_e)),j&&j.addEventListener("abort",()=>this.unsubscribe(a,$)),et.signal}unsubscribe(a,$){const j=this._subs.get(a)||[];let _e;$?(this._subs.set(a,j.filter(et=>et.handler!==$)),_e=j.filter(et=>et.handler===$)):(this._subs.set(a,[]),_e=j),(this._subs.get(a)||[]).length||this._subs.delete(a),_e.forEach(et=>et.controller.abort())}}function createPubsub$1(_){const a=new SubscriptionTracker;return{ls:createLs$1(_),peers:createPeers$2(_),publish:createPublish(_),subscribe:createSubscribe(_,a),unsubscribe:createUnsubscribe(_,a)}}const createLocal=configure(_=>{async function*a($={}){yield*(await _.post("refs/local",{signal:$.signal,transform:objectToCamel,searchParams:toUrlSearchParams($),headers:$.headers})).ndjson()}return a}),createRefs=configure((_,a)=>Object.assign(async function*(j,_e={}){const et=Array.isArray(j)?j:[j];yield*(await _.post("refs",{signal:_e.signal,searchParams:toUrlSearchParams({arg:et.map(rt=>`${rt instanceof Uint8Array?CID.decode(rt):rt}`),..._e}),headers:_e.headers,transform:objectToCamel})).ndjson()},{local:createLocal(a)})),createGc=configure(_=>{async function*a($={}){yield*(await _.post("repo/gc",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers,transform:_e=>({err:_e.Error?new Error(_e.Error):null,cid:(_e.Key||{})["/"]?CID.parse(_e.Key["/"]):null})})).ndjson()}return a}),createStat=configure(_=>{async function a($={}){const _e=await(await _.post("repo/stat",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json();return{numObjects:BigInt(_e.NumObjects),repoSize:BigInt(_e.RepoSize),repoPath:_e.RepoPath,version:_e.Version,storageMax:BigInt(_e.StorageMax)}}return a}),createVersion$1=configure(_=>{async function a($={}){return(await(await _.post("repo/version",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()).Version}return a});function createRepo(_){return{gc:createGc(_),stat:createStat(_),version:createVersion$1(_)}}const createBw=configure(_=>{async function*a($={}){yield*(await _.post("stats/bw",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers,transform:_e=>({totalIn:BigInt(_e.TotalIn),totalOut:BigInt(_e.TotalOut),rateIn:parseFloat(_e.RateIn),rateOut:parseFloat(_e.RateOut)})})).ndjson()}return a});function createStats(_){return{bitswap:createStat$4(_),repo:createStat(_),bw:createBw(_)}}const createAddrs$1=configure(_=>{async function a($={}){const j=await _.post("swarm/addrs",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers}),{Addrs:_e}=await j.json();return Object.keys(_e).map(et=>({id:peerIdFromString(et),addrs:(_e[et]||[]).map(tt=>multiaddr(tt))}))}return a}),createConnect$1=configure(_=>{async function a($,j={}){const _e=await _.post("swarm/connect",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers}),{Strings:et}=await _e.json();return et||[]}return a}),createDisconnect$1=configure(_=>{async function a($,j={}){const _e=await _.post("swarm/disconnect",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers}),{Strings:et}=await _e.json();return et||[]}return a}),createLocalAddrs$1=configure(_=>{async function a($={}){const j=await _.post("swarm/addrs/local",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers}),{Strings:_e}=await j.json();return(_e||[]).map(et=>multiaddr(et))}return a}),createPeers$1=configure(_=>{async function a($={}){const j=await _.post("swarm/peers",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers}),{Peers:_e}=await j.json();return(_e||[]).map(et=>({addr:multiaddr(et.Addr),peer:peerIdFromString(et.Peer),muxer:et.Muxer,latency:et.Latency,streams:et.Streams,direction:et.Direction==null?void 0:et.Direction===0?"inbound":"outbound"}))}return a});function createSwarm(_){return{addrs:createAddrs$1(_),connect:createConnect$1(_),disconnect:createDisconnect$1(_),localAddrs:createLocalAddrs$1(_),peers:createPeers$1(_)}}const createAddAll=configure(_=>{async function*a($,j={}){const _e=new AbortController,et=abortSignal(_e.signal,j.signal),{headers:tt,body:rt,total:nt,parts:it}=await multipartRequest($,_e,j.headers),[st,ot]=typeof j.progress=="function"?createProgressHandler(nt,it,j.progress):[void 0,void 0],at=await _.post("add",{searchParams:toUrlSearchParams({"stream-channels":!0,...j,progress:Boolean(st)}),onUploadProgress:ot,signal:et,headers:tt,body:rt});for await(let lt of at.ndjson())lt=objectToCamel(lt),lt.hash!==void 0?yield toCoreInterface(lt):st&&st(lt.bytes||0,lt.name)}return a}),createProgressHandler=(_,a,$)=>a?[void 0,createOnUploadProgress(_,a,$)]:[$,void 0],createOnUploadProgress=(_,a,$)=>{let j=0;const _e=a.length;return({loaded:et,total:tt})=>{const rt=Math.floor(et/tt*_);for(;j<_e;){const{start:nt,end:it,name:st}=a[j];if(rt<it){$(rt-nt,st);break}else $(it-nt,st),j+=1}}};function toCoreInterface({name:_,hash:a,size:$,mode:j,mtime:_e,mtimeNsecs:et}){const tt={path:_,cid:CID.parse(a),size:parseInt($)};return j!=null&&(tt.mode=parseInt(j,8)),_e!=null&&(tt.mtime={secs:_e,nsecs:et||0}),tt}function createAdd(_){const a=createAddAll(_);return configure(()=>{async function $(j,_e={}){return await last(a(normaliseInput$2(j),_e))}return $})(_)}const createCat=configure(_=>{async function*a($,j={}){yield*(await _.post("cat",{signal:j.signal,searchParams:toUrlSearchParams({arg:$.toString(),...j}),headers:j.headers})).iterator()}return a}),createCommands=configure(_=>async($={})=>(await _.post("commands",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).json()),createDns=configure(_=>async($,j={})=>(await(await _.post("dns",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers})).json()).Path),createGetEndpointConfig=configure(_=>()=>{const a=new URL(_.opts.base||"");return{host:a.hostname,port:a.port,protocol:a.protocol,pathname:a.pathname,"api-path":a.pathname}}),createGet=configure(_=>{async function*a($,j={}){const _e={arg:`${$ instanceof Uint8Array?CID.decode($):$}`,...j};_e.compressionLevel&&(_e["compression-level"]=_e.compressionLevel,delete _e.compressionLevel),yield*(await _.post("get",{signal:j.signal,searchParams:toUrlSearchParams(_e),headers:j.headers})).iterator()}return a}),createId=configure(_=>{async function a($={}){const _e=await(await _.post("id",{signal:$.signal,searchParams:toUrlSearchParams({arg:$.peerId?$.peerId.toString():void 0,...$}),headers:$.headers})).json(),et={...objectToCamel(_e)};return et.id=peerIdFromString(et.id),et.addresses&&(et.addresses=et.addresses.map(tt=>multiaddr(tt))),et}return a}),createIsOnline=_=>{const a=createId(_);async function $(j={}){const _e=await a(j);return Boolean(_e&&_e.addresses&&_e.addresses.length)}return $},createLs=configure((_,a)=>{async function*$(j,_e={}){const et=`${j instanceof Uint8Array?CID.decode(j):j}`;async function tt(nt){let it=nt.Hash;if(it.includes("/")){const ot=it.startsWith("/ipfs/")?it:`/ipfs/${it}`;it=(await createStat$2(a)(ot)).cid}else it=CID.parse(it);const st={name:nt.Name,path:et+(nt.Name?`/${nt.Name}`:""),size:nt.Size,cid:it,type:typeOf(nt)};return nt.Mode&&(st.mode=parseInt(nt.Mode,8)),nt.Mtime!==void 0&&nt.Mtime!==null&&(st.mtime={secs:nt.Mtime},nt.MtimeNsecs!==void 0&&nt.MtimeNsecs!==null&&(st.mtime.nsecs=nt.MtimeNsecs)),st}const rt=await _.post("ls",{signal:_e.signal,searchParams:toUrlSearchParams({arg:et,..._e}),headers:_e.headers});for await(let nt of rt.ndjson()){if(nt=nt.Objects,!nt)throw new Error("expected .Objects in results");if(nt=nt[0],!nt)throw new Error("expected one array in results.Objects");const it=nt.Links;if(!Array.isArray(it))throw new Error("expected one array in results.Objects[0].Links");if(!it.length){yield tt(nt);return}yield*it.map(tt)}}return $});function typeOf(_){switch(_.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}const createMount=configure(_=>{async function a($={}){const j=await _.post("dns",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers});return objectToCamel(await j.json())}return a}),createPing$1=configure(_=>{async function*a($,j={}){yield*(await _.post("ping",{signal:j.signal,searchParams:toUrlSearchParams({arg:`${$}`,...j}),headers:j.headers,transform:objectToCamel})).ndjson()}return a}),createResolve=configure(_=>{async function a($,j={}){const _e=await _.post("resolve",{signal:j.signal,searchParams:toUrlSearchParams({arg:$,...j}),headers:j.headers}),{Path:et}=await _e.json();return et}return a}),createStart=configure(_=>async($={})=>{throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),createStop=configure(_=>{async function a($={}){await(await _.post("shutdown",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers})).text()}return a}),createVersion=configure(_=>{async function a($={}){const j=await _.post("version",{signal:$.signal,searchParams:toUrlSearchParams($),headers:$.headers});return{...objectToCamel(await j.json()),"ipfs-http-client":"1.0.0"}}return a});function create$3(_={}){const a={name:identity$8.name,code:identity$8.code,encode:it=>it,decode:it=>it},$=Object.values(bases$2);(_.ipld&&_.ipld.bases?_.ipld.bases:[]).forEach(it=>$.push(it));const j=new Multibases({bases:$,loadBase:_.ipld&&_.ipld.loadBase}),_e=Object.values(codecs);[dagPB,dagCBOR,dagJSON,dagJOSE,a].concat(_.ipld&&_.ipld.codecs||[]).forEach(it=>_e.push(it));const et=new Multicodecs({codecs:_e,loadCodec:_.ipld&&_.ipld.loadCodec}),tt=Object.values(hashes);(_.ipld&&_.ipld.hashers?_.ipld.hashers:[]).forEach(it=>tt.push(it));const rt=new Multihashes({hashers:tt,loadHasher:_.ipld&&_.ipld.loadHasher});return{add:createAdd(_),addAll:createAddAll(_),bitswap:createBitswap$1(_),block:createBlock(_),bootstrap:createBootstrap(_),cat:createCat(_),commands:createCommands(_),config:createConfig(_),dag:createDag(et,_),dht:createDht$1(_),diag:createDiag(_),dns:createDns(_),files:createFiles(_),get:createGet(_),getEndpointConfig:createGetEndpointConfig(_),id:createId(_),isOnline:createIsOnline(_),key:createKey(_),log:createLog(_),ls:createLs(_),mount:createMount(_),name:createName(_),object:createObject(et,_),pin:createPin(_),ping:createPing$1(_),pubsub:createPubsub$1(_),refs:createRefs(_),repo:createRepo(_),resolve:createResolve(_),start:createStart(_),stats:createStats(_),stop:createStop(_),swarm:createSwarm(_),version:createVersion(_),bases:j,codecs:et,hashers:rt}}const CODE_P2P$1=421,CODE_CIRCUIT$1=290,CLOSE_TIMEOUT$1=2e3,PACKET_TYPES=Object.create(null);PACKET_TYPES.open="0";PACKET_TYPES.close="1";PACKET_TYPES.ping="2";PACKET_TYPES.pong="3";PACKET_TYPES.message="4";PACKET_TYPES.upgrade="5";PACKET_TYPES.noop="6";const PACKET_TYPES_REVERSE=Object.create(null);Object.keys(PACKET_TYPES).forEach(_=>{PACKET_TYPES_REVERSE[PACKET_TYPES[_]]=_});const ERROR_PACKET={type:"error",data:"parser error"},withNativeBlob$1=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",withNativeArrayBuffer$2=typeof ArrayBuffer=="function",isView$1=_=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(_):_&&_.buffer instanceof ArrayBuffer,encodePacket=({type:_,data:a},$,j)=>withNativeBlob$1&&a instanceof Blob?$?j(a):encodeBlobAsBase64(a,j):withNativeArrayBuffer$2&&(a instanceof ArrayBuffer||isView$1(a))?$?j(a):encodeBlobAsBase64(new Blob([a]),j):j(PACKET_TYPES[_]+(a||"")),encodeBlobAsBase64=(_,a)=>{const $=new FileReader;return $.onload=function(){const j=$.result.split(",")[1];a("b"+j)},$.readAsDataURL(_)},chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let _=0;_<chars.length;_++)lookup$1[chars.charCodeAt(_)]=_;const decode$3=_=>{let a=_.length*.75,$=_.length,j,_e=0,et,tt,rt,nt;_[_.length-1]==="="&&(a--,_[_.length-2]==="="&&a--);const it=new ArrayBuffer(a),st=new Uint8Array(it);for(j=0;j<$;j+=4)et=lookup$1[_.charCodeAt(j)],tt=lookup$1[_.charCodeAt(j+1)],rt=lookup$1[_.charCodeAt(j+2)],nt=lookup$1[_.charCodeAt(j+3)],st[_e++]=et<<2|tt>>4,st[_e++]=(tt&15)<<4|rt>>2,st[_e++]=(rt&3)<<6|nt&63;return it},withNativeArrayBuffer$1=typeof ArrayBuffer=="function",decodePacket=(_,a)=>{if(typeof _!="string")return{type:"message",data:mapBinary(_,a)};const $=_.charAt(0);return $==="b"?{type:"message",data:decodeBase64Packet(_.substring(1),a)}:PACKET_TYPES_REVERSE[$]?_.length>1?{type:PACKET_TYPES_REVERSE[$],data:_.substring(1)}:{type:PACKET_TYPES_REVERSE[$]}:ERROR_PACKET},decodeBase64Packet=(_,a)=>{if(withNativeArrayBuffer$1){const $=decode$3(_);return mapBinary($,a)}else return{base64:!0,data:_}},mapBinary=(_,a)=>{switch(a){case"blob":return _ instanceof ArrayBuffer?new Blob([_]):_;case"arraybuffer":default:return _}},SEPARATOR=String.fromCharCode(30),encodePayload=(_,a)=>{const $=_.length,j=new Array($);let _e=0;_.forEach((et,tt)=>{encodePacket(et,!1,rt=>{j[tt]=rt,++_e===$&&a(j.join(SEPARATOR))})})},decodePayload$1=(_,a)=>{const $=_.split(SEPARATOR),j=[];for(let _e=0;_e<$.length;_e++){const et=decodePacket($[_e],a);if(j.push(et),et.type==="error")break}return j},protocol$1=4;function Emitter(_){if(_)return mixin(_)}function mixin(_){for(var a in Emitter.prototype)_[a]=Emitter.prototype[a];return _}Emitter.prototype.on=Emitter.prototype.addEventListener=function(_,a){return this._callbacks=this._callbacks||{},(this._callbacks["$"+_]=this._callbacks["$"+_]||[]).push(a),this};Emitter.prototype.once=function(_,a){function $(){this.off(_,$),a.apply(this,arguments)}return $.fn=a,this.on(_,$),this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(_,a){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var $=this._callbacks["$"+_];if(!$)return this;if(arguments.length==1)return delete this._callbacks["$"+_],this;for(var j,_e=0;_e<$.length;_e++)if(j=$[_e],j===a||j.fn===a){$.splice(_e,1);break}return $.length===0&&delete this._callbacks["$"+_],this};Emitter.prototype.emit=function(_){this._callbacks=this._callbacks||{};for(var a=new Array(arguments.length-1),$=this._callbacks["$"+_],j=1;j<arguments.length;j++)a[j-1]=arguments[j];if($){$=$.slice(0);for(var j=0,_e=$.length;j<_e;++j)$[j].apply(this,a)}return this};Emitter.prototype.emitReserved=Emitter.prototype.emit;Emitter.prototype.listeners=function(_){return this._callbacks=this._callbacks||{},this._callbacks["$"+_]||[]};Emitter.prototype.hasListeners=function(_){return!!this.listeners(_).length};const globalThisShim=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function pick(_,...a){return a.reduce(($,j)=>(_.hasOwnProperty(j)&&($[j]=_[j]),$),{})}const NATIVE_SET_TIMEOUT=setTimeout,NATIVE_CLEAR_TIMEOUT=clearTimeout;function installTimerFunctions(_,a){a.useNativeTimers?(_.setTimeoutFn=NATIVE_SET_TIMEOUT.bind(globalThisShim),_.clearTimeoutFn=NATIVE_CLEAR_TIMEOUT.bind(globalThisShim)):(_.setTimeoutFn=setTimeout.bind(globalThisShim),_.clearTimeoutFn=clearTimeout.bind(globalThisShim))}const BASE64_OVERHEAD=1.33;function byteLength(_){return typeof _=="string"?utf8Length(_):Math.ceil((_.byteLength||_.size)*BASE64_OVERHEAD)}function utf8Length(_){let a=0,$=0;for(let j=0,_e=_.length;j<_e;j++)a=_.charCodeAt(j),a<128?$+=1:a<2048?$+=2:a<55296||a>=57344?$+=3:(j++,$+=4);return $}class TransportError extends Error{constructor(a,$,j){super(a),this.description=$,this.context=j,this.type="TransportError"}}class Transport extends Emitter{constructor(a){super(),this.writable=!1,installTimerFunctions(this,a),this.opts=a,this.query=a.query,this.readyState="",this.socket=a.socket}onError(a,$,j){return super.emitReserved("error",new TransportError(a,$,j)),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(a){this.readyState==="open"&&this.write(a)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(a){const $=decodePacket(a,this.socket.binaryType);this.onPacket($)}onPacket(a){super.emitReserved("packet",a)}onClose(a){this.readyState="closed",super.emitReserved("close",a)}}const alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length$2=64,map$3={};let seed=0,i=0,prev;function encode$4(_){let a="";do a=alphabet[_%length$2]+a,_=Math.floor(_/length$2);while(_>0);return a}function yeast(){const _=encode$4(+new Date);return _!==prev?(seed=0,prev=_):_+"."+encode$4(seed++)}for(;i<length$2;i++)map$3[alphabet[i]]=i;function encode$3(_){let a="";for(let $ in _)_.hasOwnProperty($)&&(a.length&&(a+="&"),a+=encodeURIComponent($)+"="+encodeURIComponent(_[$]));return a}function decode$2(_){let a={},$=_.split("&");for(let j=0,_e=$.length;j<_e;j++){let et=$[j].split("=");a[decodeURIComponent(et[0])]=decodeURIComponent(et[1])}return a}let value=!1;try{value=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch(_){}const hasCORS=value;function XHR(_){const a=_.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!a||hasCORS))return new XMLHttpRequest}catch{}if(!a)try{return new globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function empty(){}const hasXHR2=function(){return new XHR({xdomain:!1}).responseType!=null}();class Polling extends Transport{constructor(a){if(super(a),this.polling=!1,typeof location<"u"){const j=location.protocol==="https:";let _e=location.port;_e||(_e=j?"443":"80"),this.xd=typeof location<"u"&&a.hostname!==location.hostname||_e!==a.port,this.xs=a.secure!==j}const $=a&&a.forceBase64;this.supportsBinary=hasXHR2&&!$}get name(){return"polling"}doOpen(){this.poll()}pause(a){this.readyState="pausing";const $=()=>{this.readyState="paused",a()};if(this.polling||!this.writable){let j=0;this.polling&&(j++,this.once("pollComplete",function(){--j||$()})),this.writable||(j++,this.once("drain",function(){--j||$()}))}else $()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(a){const $=j=>{if(this.readyState==="opening"&&j.type==="open"&&this.onOpen(),j.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(j)};decodePayload$1(a,this.socket.binaryType).forEach($),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const a=()=>{this.write([{type:"close"}])};this.readyState==="open"?a():this.once("open",a)}write(a){this.writable=!1,encodePayload(a,$=>{this.doWrite($,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let a=this.query||{};const $=this.opts.secure?"https":"http";let j="";this.opts.timestampRequests!==!1&&(a[this.opts.timestampParam]=yeast()),!this.supportsBinary&&!a.sid&&(a.b64=1),this.opts.port&&($==="https"&&Number(this.opts.port)!==443||$==="http"&&Number(this.opts.port)!==80)&&(j=":"+this.opts.port);const _e=encode$3(a),et=this.opts.hostname.indexOf(":")!==-1;return $+"://"+(et?"["+this.opts.hostname+"]":this.opts.hostname)+j+this.opts.path+(_e.length?"?"+_e:"")}request(a={}){return Object.assign(a,{xd:this.xd,xs:this.xs},this.opts),new Request(this.uri(),a)}doWrite(a,$){const j=this.request({method:"POST",data:a});j.on("success",$),j.on("error",(_e,et)=>{this.onError("xhr post error",_e,et)})}doPoll(){const a=this.request();a.on("data",this.onData.bind(this)),a.on("error",($,j)=>{this.onError("xhr poll error",$,j)}),this.pollXhr=a}}class Request extends Emitter{constructor(a,$){super(),installTimerFunctions(this,$),this.opts=$,this.method=$.method||"GET",this.uri=a,this.async=$.async!==!1,this.data=$.data!==void 0?$.data:null,this.create()}create(){const a=pick(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");a.xdomain=!!this.opts.xd,a.xscheme=!!this.opts.xs;const $=this.xhr=new XHR(a);try{$.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){$.setDisableHeaderCheck&&$.setDisableHeaderCheck(!0);for(let j in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(j)&&$.setRequestHeader(j,this.opts.extraHeaders[j])}}catch{}if(this.method==="POST")try{$.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{$.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in $&&($.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&($.timeout=this.opts.requestTimeout),$.onreadystatechange=()=>{$.readyState===4&&($.status===200||$.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof $.status=="number"?$.status:0)},0))},$.send(this.data)}catch(j){this.setTimeoutFn(()=>{this.onError(j)},0);return}typeof document<"u"&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)}onError(a){this.emitReserved("error",a,this.xhr),this.cleanup(!0)}cleanup(a){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=empty,a)try{this.xhr.abort()}catch{}typeof document<"u"&&delete Request.requests[this.index],this.xhr=null}}onLoad(){const a=this.xhr.responseText;a!==null&&(this.emitReserved("data",a),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}Request.requestsCount=0;Request.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",unloadHandler);else if(typeof addEventListener=="function"){const _="onpagehide"in globalThisShim?"pagehide":"unload";addEventListener(_,unloadHandler,!1)}}function unloadHandler(){for(let _ in Request.requests)Request.requests.hasOwnProperty(_)&&Request.requests[_].abort()}const nextTick=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?a=>Promise.resolve().then(a):(a,$)=>$(a,0))(),WebSocket$2=globalThisShim.WebSocket||globalThisShim.MozWebSocket,usingBrowserWebSocket=!0,defaultBinaryType="arraybuffer",isReactNative$1=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class WS extends Transport{constructor(a){super(a),this.supportsBinary=!a.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const a=this.uri(),$=this.opts.protocols,j=isReactNative$1?{}:pick(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(j.headers=this.opts.extraHeaders);try{this.ws=usingBrowserWebSocket&&!isReactNative$1?$?new WebSocket$2(a,$):new WebSocket$2(a):new WebSocket$2(a,$,j)}catch(_e){return this.emitReserved("error",_e)}this.ws.binaryType=this.socket.binaryType||defaultBinaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=a=>this.onClose({description:"websocket connection closed",context:a}),this.ws.onmessage=a=>this.onData(a.data),this.ws.onerror=a=>this.onError("websocket error",a)}write(a){this.writable=!1;for(let $=0;$<a.length;$++){const j=a[$],_e=$===a.length-1;encodePacket(j,this.supportsBinary,et=>{const tt={};try{usingBrowserWebSocket&&this.ws.send(et)}catch{}_e&&nextTick(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let a=this.query||{};const $=this.opts.secure?"wss":"ws";let j="";this.opts.port&&($==="wss"&&Number(this.opts.port)!==443||$==="ws"&&Number(this.opts.port)!==80)&&(j=":"+this.opts.port),this.opts.timestampRequests&&(a[this.opts.timestampParam]=yeast()),this.supportsBinary||(a.b64=1);const _e=encode$3(a),et=this.opts.hostname.indexOf(":")!==-1;return $+"://"+(et?"["+this.opts.hostname+"]":this.opts.hostname)+j+this.opts.path+(_e.length?"?"+_e:"")}check(){return!!WebSocket$2}}const transports={websocket:WS,polling:Polling},re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function parse$1(_){const a=_,$=_.indexOf("["),j=_.indexOf("]");$!=-1&&j!=-1&&(_=_.substring(0,$)+_.substring($,j).replace(/:/g,";")+_.substring(j,_.length));let _e=re.exec(_||""),et={},tt=14;for(;tt--;)et[parts[tt]]=_e[tt]||"";return $!=-1&&j!=-1&&(et.source=a,et.host=et.host.substring(1,et.host.length-1).replace(/;/g,":"),et.authority=et.authority.replace("[","").replace("]","").replace(/;/g,":"),et.ipv6uri=!0),et.pathNames=pathNames(et,et.path),et.queryKey=queryKey(et,et.query),et}function pathNames(_,a){const $=/\/{2,9}/g,j=a.replace($,"/").split("/");return(a.slice(0,1)=="/"||a.length===0)&&j.splice(0,1),a.slice(-1)=="/"&&j.splice(j.length-1,1),j}function queryKey(_,a){const $={};return a.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(j,_e,et){_e&&($[_e]=et)}),$}class Socket$1 extends Emitter{constructor(a,$={}){super(),a&&typeof a=="object"&&($=a,a=null),a?(a=parse$1(a),$.hostname=a.host,$.secure=a.protocol==="https"||a.protocol==="wss",$.port=a.port,a.query&&($.query=a.query)):$.host&&($.hostname=parse$1($.host).host),installTimerFunctions(this,$),this.secure=$.secure!=null?$.secure:typeof location<"u"&&location.protocol==="https:",$.hostname&&!$.port&&($.port=this.secure?"443":"80"),this.hostname=$.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=$.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=$.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},$),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=decode$2(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(a){const $=Object.assign({},this.opts.query);$.EIO=protocol$1,$.transport=a,this.id&&($.sid=this.id);const j=Object.assign({},this.opts.transportOptions[a],this.opts,{query:$,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new transports[a](j)}open(){let a;if(this.opts.rememberUpgrade&&Socket$1.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)a="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else a=this.transports[0];this.readyState="opening";try{a=this.createTransport(a)}catch{this.transports.shift(),this.open();return}a.open(),this.setTransport(a)}setTransport(a){this.transport&&this.transport.removeAllListeners(),this.transport=a,a.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",$=>this.onClose("transport close",$))}probe(a){let $=this.createTransport(a),j=!1;Socket$1.priorWebsocketSuccess=!1;const _e=()=>{j||($.send([{type:"ping",data:"probe"}]),$.once("packet",ot=>{if(!j)if(ot.type==="pong"&&ot.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",$),!$)return;Socket$1.priorWebsocketSuccess=$.name==="websocket",this.transport.pause(()=>{j||this.readyState!=="closed"&&(st(),this.setTransport($),$.send([{type:"upgrade"}]),this.emitReserved("upgrade",$),$=null,this.upgrading=!1,this.flush())})}else{const at=new Error("probe error");at.transport=$.name,this.emitReserved("upgradeError",at)}}))};function et(){j||(j=!0,st(),$.close(),$=null)}const tt=ot=>{const at=new Error("probe error: "+ot);at.transport=$.name,et(),this.emitReserved("upgradeError",at)};function rt(){tt("transport closed")}function nt(){tt("socket closed")}function it(ot){$&&ot.name!==$.name&&et()}const st=()=>{$.removeListener("open",_e),$.removeListener("error",tt),$.removeListener("close",rt),this.off("close",nt),this.off("upgrading",it)};$.once("open",_e),$.once("error",tt),$.once("close",rt),this.once("close",nt),this.once("upgrading",it),$.open()}onOpen(){if(this.readyState="open",Socket$1.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){let a=0;const $=this.upgrades.length;for(;a<$;a++)this.probe(this.upgrades[a])}}onPacket(a){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",a),this.emitReserved("heartbeat"),a.type){case"open":this.onHandshake(JSON.parse(a.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const $=new Error("server error");$.code=a.data,this.onError($);break;case"message":this.emitReserved("data",a.data),this.emitReserved("message",a.data);break}}onHandshake(a){this.emitReserved("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this.upgrades=this.filterUpgrades(a.upgrades),this.pingInterval=a.pingInterval,this.pingTimeout=a.pingTimeout,this.maxPayload=a.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const a=this.getWritablePackets();this.transport.send(a),this.prevBufferLen=a.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let $=1;for(let j=0;j<this.writeBuffer.length;j++){const _e=this.writeBuffer[j].data;if(_e&&($+=byteLength(_e)),j>0&&$>this.maxPayload)return this.writeBuffer.slice(0,j);$+=2}return this.writeBuffer}write(a,$,j){return this.sendPacket("message",a,$,j),this}send(a,$,j){return this.sendPacket("message",a,$,j),this}sendPacket(a,$,j,_e){if(typeof $=="function"&&(_e=$,$=void 0),typeof j=="function"&&(_e=j,j=null),this.readyState==="closing"||this.readyState==="closed")return;j=j||{},j.compress=j.compress!==!1;const et={type:a,data:$,options:j};this.emitReserved("packetCreate",et),this.writeBuffer.push(et),_e&&this.once("flush",_e),this.flush()}close(){const a=()=>{this.onClose("forced close"),this.transport.close()},$=()=>{this.off("upgrade",$),this.off("upgradeError",$),a()},j=()=>{this.once("upgrade",$),this.once("upgradeError",$)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?j():a()}):this.upgrading?j():a()),this}onError(a){Socket$1.priorWebsocketSuccess=!1,this.emitReserved("error",a),this.onClose("transport error",a)}onClose(a,$){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",a,$),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(a){const $=[];let j=0;const _e=a.length;for(;j<_e;j++)~this.transports.indexOf(a[j])&&$.push(a[j]);return $}}Socket$1.protocol=protocol$1;function url(_,a="",$){let j=_;$=$||typeof location<"u"&&location,_==null&&(_=$.protocol+"//"+$.host),typeof _=="string"&&(_.charAt(0)==="/"&&(_.charAt(1)==="/"?_=$.protocol+_:_=$.host+_),/^(https?|wss?):\/\//.test(_)||(typeof $<"u"?_=$.protocol+"//"+_:_="https://"+_),j=parse$1(_)),j.port||(/^(http|ws)$/.test(j.protocol)?j.port="80":/^(http|ws)s$/.test(j.protocol)&&(j.port="443")),j.path=j.path||"/";const et=j.host.indexOf(":")!==-1?"["+j.host+"]":j.host;return j.id=j.protocol+"://"+et+":"+j.port+a,j.href=j.protocol+"://"+et+($&&$.port===j.port?"":":"+j.port),j}const withNativeArrayBuffer=typeof ArrayBuffer=="function",isView=_=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(_):_.buffer instanceof ArrayBuffer,toString=Object.prototype.toString,withNativeBlob=typeof Blob=="function"||typeof Blob<"u"&&toString.call(Blob)==="[object BlobConstructor]",withNativeFile=typeof File=="function"||typeof File<"u"&&toString.call(File)==="[object FileConstructor]";function isBinary(_){return withNativeArrayBuffer&&(_ instanceof ArrayBuffer||isView(_))||withNativeBlob&&_ instanceof Blob||withNativeFile&&_ instanceof File}function hasBinary(_,a){if(!_||typeof _!="object")return!1;if(Array.isArray(_)){for(let $=0,j=_.length;$<j;$++)if(hasBinary(_[$]))return!0;return!1}if(isBinary(_))return!0;if(_.toJSON&&typeof _.toJSON=="function"&&arguments.length===1)return hasBinary(_.toJSON(),!0);for(const $ in _)if(Object.prototype.hasOwnProperty.call(_,$)&&hasBinary(_[$]))return!0;return!1}function deconstructPacket(_){const a=[],$=_.data,j=_;return j.data=_deconstructPacket($,a),j.attachments=a.length,{packet:j,buffers:a}}function _deconstructPacket(_,a){if(!_)return _;if(isBinary(_)){const $={_placeholder:!0,num:a.length};return a.push(_),$}else if(Array.isArray(_)){const $=new Array(_.length);for(let j=0;j<_.length;j++)$[j]=_deconstructPacket(_[j],a);return $}else if(typeof _=="object"&&!(_ instanceof Date)){const $={};for(const j in _)Object.prototype.hasOwnProperty.call(_,j)&&($[j]=_deconstructPacket(_[j],a));return $}return _}function reconstructPacket(_,a){return _.data=_reconstructPacket(_.data,a),_.attachments=void 0,_}function _reconstructPacket(_,a){if(!_)return _;if(_&&_._placeholder===!0){if(typeof _.num=="number"&&_.num>=0&&_.num<a.length)return a[_.num];throw new Error("illegal attachments")}else if(Array.isArray(_))for(let $=0;$<_.length;$++)_[$]=_reconstructPacket(_[$],a);else if(typeof _=="object")for(const $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(_[$]=_reconstructPacket(_[$],a));return _}const protocol=5;var PacketType;(function(_){_[_.CONNECT=0]="CONNECT",_[_.DISCONNECT=1]="DISCONNECT",_[_.EVENT=2]="EVENT",_[_.ACK=3]="ACK",_[_.CONNECT_ERROR=4]="CONNECT_ERROR",_[_.BINARY_EVENT=5]="BINARY_EVENT",_[_.BINARY_ACK=6]="BINARY_ACK"})(PacketType||(PacketType={}));class Encoder$1{constructor(a){this.replacer=a}encode(a){return(a.type===PacketType.EVENT||a.type===PacketType.ACK)&&hasBinary(a)?(a.type=a.type===PacketType.EVENT?PacketType.BINARY_EVENT:PacketType.BINARY_ACK,this.encodeAsBinary(a)):[this.encodeAsString(a)]}encodeAsString(a){let $=""+a.type;return(a.type===PacketType.BINARY_EVENT||a.type===PacketType.BINARY_ACK)&&($+=a.attachments+"-"),a.nsp&&a.nsp!=="/"&&($+=a.nsp+","),a.id!=null&&($+=a.id),a.data!=null&&($+=JSON.stringify(a.data,this.replacer)),$}encodeAsBinary(a){const $=deconstructPacket(a),j=this.encodeAsString($.packet),_e=$.buffers;return _e.unshift(j),_e}}class Decoder$1 extends Emitter{constructor(a){super(),this.reviver=a}add(a){let $;if(typeof a=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");$=this.decodeString(a),$.type===PacketType.BINARY_EVENT||$.type===PacketType.BINARY_ACK?(this.reconstructor=new BinaryReconstructor($),$.attachments===0&&super.emitReserved("decoded",$)):super.emitReserved("decoded",$)}else if(isBinary(a)||a.base64)if(this.reconstructor)$=this.reconstructor.takeBinaryData(a),$&&(this.reconstructor=null,super.emitReserved("decoded",$));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+a)}decodeString(a){let $=0;const j={type:Number(a.charAt(0))};if(PacketType[j.type]===void 0)throw new Error("unknown packet type "+j.type);if(j.type===PacketType.BINARY_EVENT||j.type===PacketType.BINARY_ACK){const et=$+1;for(;a.charAt(++$)!=="-"&&$!=a.length;);const tt=a.substring(et,$);if(tt!=Number(tt)||a.charAt($)!=="-")throw new Error("Illegal attachments");j.attachments=Number(tt)}if(a.charAt($+1)==="/"){const et=$+1;for(;++$&&!(a.charAt($)===","||$===a.length););j.nsp=a.substring(et,$)}else j.nsp="/";const _e=a.charAt($+1);if(_e!==""&&Number(_e)==_e){const et=$+1;for(;++$;){const tt=a.charAt($);if(tt==null||Number(tt)!=tt){--$;break}if($===a.length)break}j.id=Number(a.substring(et,$+1))}if(a.charAt(++$)){const et=this.tryParse(a.substr($));if(Decoder$1.isPayloadValid(j.type,et))j.data=et;else throw new Error("invalid payload")}return j}tryParse(a){try{return JSON.parse(a,this.reviver)}catch{return!1}}static isPayloadValid(a,$){switch(a){case PacketType.CONNECT:return typeof $=="object";case PacketType.DISCONNECT:return $===void 0;case PacketType.CONNECT_ERROR:return typeof $=="string"||typeof $=="object";case PacketType.EVENT:case PacketType.BINARY_EVENT:return Array.isArray($)&&$.length>0;case PacketType.ACK:case PacketType.BINARY_ACK:return Array.isArray($)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class BinaryReconstructor{constructor(a){this.packet=a,this.buffers=[],this.reconPack=a}takeBinaryData(a){if(this.buffers.push(a),this.buffers.length===this.reconPack.attachments){const $=reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),$}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const parser=Object.freeze(Object.defineProperty({__proto__:null,protocol,get PacketType(){return PacketType},Encoder:Encoder$1,Decoder:Decoder$1},Symbol.toStringTag,{value:"Module"}));function on(_,a,$){return _.on(a,$),function(){_.off(a,$)}}const RESERVED_EVENTS=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Socket extends Emitter{constructor(a,$,j){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=a,this.nsp=$,j&&j.auth&&(this.auth=j.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const a=this.io;this.subs=[on(a,"open",this.onopen.bind(this)),on(a,"packet",this.onpacket.bind(this)),on(a,"error",this.onerror.bind(this)),on(a,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...a){return a.unshift("message"),this.emit.apply(this,a),this}emit(a,...$){if(RESERVED_EVENTS.hasOwnProperty(a))throw new Error('"'+a.toString()+'" is a reserved event name');$.unshift(a);const j={type:PacketType.EVENT,data:$};if(j.options={},j.options.compress=this.flags.compress!==!1,typeof $[$.length-1]=="function"){const tt=this.ids++,rt=$.pop();this._registerAckCallback(tt,rt),j.id=tt}const _e=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!_e||!this.connected)||(this.connected?(this.notifyOutgoingListeners(j),this.packet(j)):this.sendBuffer.push(j)),this.flags={},this}_registerAckCallback(a,$){const j=this.flags.timeout;if(j===void 0){this.acks[a]=$;return}const _e=this.io.setTimeoutFn(()=>{delete this.acks[a];for(let et=0;et<this.sendBuffer.length;et++)this.sendBuffer[et].id===a&&this.sendBuffer.splice(et,1);$.call(this,new Error("operation has timed out"))},j);this.acks[a]=(...et)=>{this.io.clearTimeoutFn(_e),$.apply(this,[null,...et])}}packet(a){a.nsp=this.nsp,this.io._packet(a)}onopen(){typeof this.auth=="function"?this.auth(a=>{this.packet({type:PacketType.CONNECT,data:a})}):this.packet({type:PacketType.CONNECT,data:this.auth})}onerror(a){this.connected||this.emitReserved("connect_error",a)}onclose(a,$){this.connected=!1,delete this.id,this.emitReserved("disconnect",a,$)}onpacket(a){if(a.nsp===this.nsp)switch(a.type){case PacketType.CONNECT:if(a.data&&a.data.sid){const _e=a.data.sid;this.onconnect(_e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case PacketType.EVENT:case PacketType.BINARY_EVENT:this.onevent(a);break;case PacketType.ACK:case PacketType.BINARY_ACK:this.onack(a);break;case PacketType.DISCONNECT:this.ondisconnect();break;case PacketType.CONNECT_ERROR:this.destroy();const j=new Error(a.data.message);j.data=a.data.data,this.emitReserved("connect_error",j);break}}onevent(a){const $=a.data||[];a.id!=null&&$.push(this.ack(a.id)),this.connected?this.emitEvent($):this.receiveBuffer.push(Object.freeze($))}emitEvent(a){if(this._anyListeners&&this._anyListeners.length){const $=this._anyListeners.slice();for(const j of $)j.apply(this,a)}super.emit.apply(this,a)}ack(a){const $=this;let j=!1;return function(..._e){j||(j=!0,$.packet({type:PacketType.ACK,id:a,data:_e}))}}onack(a){const $=this.acks[a.id];typeof $=="function"&&($.apply(this,a.data),delete this.acks[a.id])}onconnect(a){this.id=a,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(a=>this.emitEvent(a)),this.receiveBuffer=[],this.sendBuffer.forEach(a=>{this.notifyOutgoingListeners(a),this.packet(a)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(a=>a()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:PacketType.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(a){return this.flags.compress=a,this}get volatile(){return this.flags.volatile=!0,this}timeout(a){return this.flags.timeout=a,this}onAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(a),this}prependAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(a),this}offAny(a){if(!this._anyListeners)return this;if(a){const $=this._anyListeners;for(let j=0;j<$.length;j++)if(a===$[j])return $.splice(j,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(a),this}prependAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(a),this}offAnyOutgoing(a){if(!this._anyOutgoingListeners)return this;if(a){const $=this._anyOutgoingListeners;for(let j=0;j<$.length;j++)if(a===$[j])return $.splice(j,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(a){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const $=this._anyOutgoingListeners.slice();for(const j of $)j.apply(this,a.data)}}}function Backoff(_){_=_||{},this.ms=_.min||100,this.max=_.max||1e4,this.factor=_.factor||2,this.jitter=_.jitter>0&&_.jitter<=1?_.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var _=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var a=Math.random(),$=Math.floor(a*this.jitter*_);_=(Math.floor(a*10)&1)==0?_-$:_+$}return Math.min(_,this.max)|0};Backoff.prototype.reset=function(){this.attempts=0};Backoff.prototype.setMin=function(_){this.ms=_};Backoff.prototype.setMax=function(_){this.max=_};Backoff.prototype.setJitter=function(_){this.jitter=_};class Manager extends Emitter{constructor(a,$){var j;super(),this.nsps={},this.subs=[],a&&typeof a=="object"&&($=a,a=void 0),$=$||{},$.path=$.path||"/socket.io",this.opts=$,installTimerFunctions(this,$),this.reconnection($.reconnection!==!1),this.reconnectionAttempts($.reconnectionAttempts||1/0),this.reconnectionDelay($.reconnectionDelay||1e3),this.reconnectionDelayMax($.reconnectionDelayMax||5e3),this.randomizationFactor((j=$.randomizationFactor)!==null&&j!==void 0?j:.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout($.timeout==null?2e4:$.timeout),this._readyState="closed",this.uri=a;const _e=$.parser||parser;this.encoder=new _e.Encoder,this.decoder=new _e.Decoder,this._autoConnect=$.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection}reconnectionAttempts(a){return a===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=a,this)}reconnectionDelay(a){var $;return a===void 0?this._reconnectionDelay:(this._reconnectionDelay=a,($=this.backoff)===null||$===void 0||$.setMin(a),this)}randomizationFactor(a){var $;return a===void 0?this._randomizationFactor:(this._randomizationFactor=a,($=this.backoff)===null||$===void 0||$.setJitter(a),this)}reconnectionDelayMax(a){var $;return a===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=a,($=this.backoff)===null||$===void 0||$.setMax(a),this)}timeout(a){return arguments.length?(this._timeout=a,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(a){if(~this._readyState.indexOf("open"))return this;this.engine=new Socket$1(this.uri,this.opts);const $=this.engine,j=this;this._readyState="opening",this.skipReconnect=!1;const _e=on($,"open",function(){j.onopen(),a&&a()}),et=on($,"error",tt=>{j.cleanup(),j._readyState="closed",this.emitReserved("error",tt),a?a(tt):j.maybeReconnectOnOpen()});if(this._timeout!==!1){const tt=this._timeout;tt===0&&_e();const rt=this.setTimeoutFn(()=>{_e(),$.close(),$.emit("error",new Error("timeout"))},tt);this.opts.autoUnref&&rt.unref(),this.subs.push(function(){clearTimeout(rt)})}return this.subs.push(_e),this.subs.push(et),this}connect(a){return this.open(a)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const a=this.engine;this.subs.push(on(a,"ping",this.onping.bind(this)),on(a,"data",this.ondata.bind(this)),on(a,"error",this.onerror.bind(this)),on(a,"close",this.onclose.bind(this)),on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(a){try{this.decoder.add(a)}catch($){this.onclose("parse error",$)}}ondecoded(a){nextTick(()=>{this.emitReserved("packet",a)},this.setTimeoutFn)}onerror(a){this.emitReserved("error",a)}socket(a,$){let j=this.nsps[a];return j||(j=new Socket(this,a,$),this.nsps[a]=j),j}_destroy(a){const $=Object.keys(this.nsps);for(const j of $)if(this.nsps[j].active)return;this._close()}_packet(a){const $=this.encoder.encode(a);for(let j=0;j<$.length;j++)this.engine.write($[j],a.options)}cleanup(){this.subs.forEach(a=>a()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(a,$){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",a,$),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const a=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const $=this.backoff.duration();this._reconnecting=!0;const j=this.setTimeoutFn(()=>{a.skipReconnect||(this.emitReserved("reconnect_attempt",a.backoff.attempts),!a.skipReconnect&&a.open(_e=>{_e?(a._reconnecting=!1,a.reconnect(),this.emitReserved("reconnect_error",_e)):a.onreconnect()}))},$);this.opts.autoUnref&&j.unref(),this.subs.push(function(){clearTimeout(j)})}}onreconnect(){const a=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",a)}}const cache$1={};function lookup(_,a){typeof _=="object"&&(a=_,_=void 0),a=a||{};const $=url(_,a.path||"/socket.io"),j=$.source,_e=$.id,et=$.path,tt=cache$1[_e]&&et in cache$1[_e].nsps,rt=a.forceNew||a["force new connection"]||a.multiplex===!1||tt;let nt;return rt?nt=new Manager(j,a):(cache$1[_e]||(cache$1[_e]=new Manager(j,a)),nt=cache$1[_e]),$.query&&!a.query&&(a.query=$.queryKey),nt.socket($.path,a)}Object.assign(lookup,{Manager,Socket,io:lookup,connect:lookup});const MAX_BYTES$1=65536;function randomBytes$2(_){const a=new Uint8Array(_);let $=0;if(_>0)if(_>MAX_BYTES$1)for(;$<_;)$+MAX_BYTES$1>_?(crypto.getRandomValues(a.subarray($,$+(_-$))),$+=_-$):(crypto.getRandomValues(a.subarray($,$+MAX_BYTES$1)),$+=MAX_BYTES$1);else crypto.getRandomValues(a);return a}var random_browser=randomBytes$2;const MAX_BUFFERED_AMOUNT=64*1024,CHANNEL_CLOSING_TIMEOUT=5*1e3;class WebRTCDataChannel{constructor(a,$){this.label=a.label,this.open=pDefer$2(),this.channel=a,this.channel.binaryType="arraybuffer",this.log=$.log,typeof this.channel.bufferedAmountLowThreshold=="number"&&(this.channel.bufferedAmountLowThreshold=MAX_BUFFERED_AMOUNT),a.addEventListener("message",_e=>{$.onMessage(_e)}),a.addEventListener("bufferedamountlow",()=>{this.log("stop backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open.resolve()}),a.addEventListener("open",()=>{this.open.resolve(),$.onOpen()}),a.addEventListener("close",()=>{$.onClose()}),a.addEventListener("error",_e=>{if(_e.error?.message==="Transport channel closed")return this.close();$.log.error('channel encounter an error in state "%s" message: "%s" detail: "%s',a.readyState,_e.error?.message,_e.error?.errorDetail);const et=_e.error instanceof Error?_e.error:new Error(`datachannel error: ${_e.error?.message} ${_e.error?.errorDetail}`);$.onError(errCode(et,"ERR_DATA_CHANNEL"))});let j=!1;this.closingInterval=setInterval(()=>{a.readyState==="closing"?(j&&$.onClose(),j=!0):j=!1},CHANNEL_CLOSING_TIMEOUT)}async send(a){await this.open.promise,this.channel.send(a),this.channel.bufferedAmount>MAX_BUFFERED_AMOUNT&&(this.log("start backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open=pDefer$2())}close(){clearInterval(this.closingInterval),this.channel.close()}get bufferedAmount(){return this.channel.bufferedAmount}}var delay$1={exports:{}};const randomInteger=(_,a)=>Math.floor(Math.random()*(a-_+1)+_),createAbortError=()=>{const _=new Error("Delay aborted");return _.name="AbortError",_},createDelay=({clearTimeout:_,setTimeout:a,willResolve:$})=>(j,{value:_e,signal:et}={})=>{if(et&&et.aborted)return Promise.reject(createAbortError());let tt,rt,nt;const it=_||clearTimeout,st=()=>{it(tt),nt(createAbortError())},ot=()=>{et&&et.removeEventListener("abort",st)},at=new Promise((lt,ct)=>{rt=()=>{ot(),$?lt(_e):ct(_e)},nt=ct,tt=(a||setTimeout)(rt,j)});return et&&et.addEventListener("abort",st,{once:!0}),at.clear=()=>{it(tt),tt=null,rt()},at},createWithTimers=_=>{const a=createDelay({..._,willResolve:!0});return a.reject=createDelay({..._,willResolve:!1}),a.range=($,j,_e)=>a(randomInteger($,j),_e),a},delay=createWithTimers();delay.createWithTimers=createWithTimers;delay$1.exports=delay;delay$1.exports.default=delay;const DEFAULT_PEER_CONNECTION_CONFIG={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:({}).stun.twilio.com:3478"]}]};function getBrowserRTC(){if(typeof globalThis>"u")throw errCode(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");const _={RTCPeerConnection:globalThis.RTCPeerConnection??globalThis.mozRTCPeerConnection??globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription??globalThis.mozRTCSessionDescription??globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate??globalThis.mozRTCIceCandidate??globalThis.webkitRTCIceCandidate};if(_.RTCPeerConnection==null)throw errCode(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");return _}class WebRTCPeer extends EventEmitter$1{constructor(a){super(),this.id=a.id??toString$6(random_browser(4),"hex").slice(0,7),this.log=logger$1(`libp2p:webrtc-peer:${a.logPrefix}:${this.id}`),this.wrtc=a.wrtc??getBrowserRTC(),this.peerConnection=new this.wrtc.RTCPeerConnection(Object.assign({},DEFAULT_PEER_CONNECTION_CONFIG,a.peerConnectionConfig)),this.closed=!1,this.connected=pDefer$2(),this.source=pushable$2(),this.sink=async $=>{if(await this.connected.promise,this.channel==null)throw errCode(new Error("Connected but no channel?!"),"ERR_DATA_CHANNEL");for await(const j of $)await this.channel.send(j);await this.close()}}handleDataChannelEvent(a){const $=a.channel;if($==null){this.close(errCode(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL")).catch(j=>{this.log("Error closing after event channel was found to be null",j)});return}this.channel=new WebRTCDataChannel($,{log:this.log,onMessage:j=>{this.source.push(new Uint8Array(j.data))},onOpen:()=>{this.connected.resolve(),this.dispatchEvent(new CustomEvent$1("ready"))},onClose:()=>{this.close().catch(j=>{this.log("error closing connection after channel close",j)})},onError:j=>{this.close(j).catch(_e=>{this.log("error closing connection after channel error",_e)})}})}async close(a){if(this.closed=!0,a==null&&this.channel!=null)for(;this.channel.bufferedAmount>0;)await delay$1.exports(100);this.channel?.close(),this.peerConnection.close(),this.source.end(a),this.dispatchEvent(new CustomEvent$1("close"))}}class WebRTCHandshake extends EventEmitter$1{constructor(a){super(),this.log=a.log,this.peerConnection=a.peerConnection,this.wrtc=a.wrtc,this.status="idle",this.peerConnection.addEventListener("negotiationneeded",()=>{this.log("peer connection negotiation needed"),this.handleRenegotiate({type:"renegotiate"}).catch($=>{this.log.error("could not renegotiate %o",$)})})}async handleSignal(a){if(this.log('incoming signal "%s"',a.type),a.type==="offer")return await this.handleOffer(a);if(a.type==="answer")return await this.handleAnswer(a);if(a.type==="candidate")return await this.handleCandidate(a);if(a.type==="renegotiate")return await this.handleRenegotiate(a);if(a.type==="goodbye")return await this.handleGoodye(a);this.log(`Unknown signal type ${a.type}`)}async handleOffer(a){}async handleAnswer(a){}async handleRenegotiate(a){}async handleGoodye(a){this.peerConnection.close()}async handleCandidate(a){const $=new this.wrtc.RTCIceCandidate(a.candidate);try{await this.peerConnection.addIceCandidate($)}catch(j){if($.address==null||$.address.endsWith(".local"))this.log("ignoring unsupported ICE candidate.");else throw errCode(j,"ERR_ADD_ICE_CANDIDATE")}}}const log$S=logger$1("libp2p:webrtc-peer:receiver");class WebRTCReceiver extends WebRTCPeer{constructor(a={}){super({...a,logPrefix:"receiver"}),this.handshake=new WebRTCReceiverHandshake({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,answerOptions:a.answerOptions}),this.handshake.addEventListener("signal",$=>this.dispatchEvent(new CustomEvent$1("signal",{detail:$.detail}))),this.peerConnection.addEventListener("datachannel",$=>{this.handleDataChannelEvent($)})}handleSignal(a){this.handshake.handleSignal(a).catch($=>{this.log("error handling signal %o %o",a,$)})}}class WebRTCReceiverHandshake extends WebRTCHandshake{constructor(a){super(a),this.options=a,this.status="idle",this.iceCandidates=[]}async handleRenegotiate(){log$S.trace("renegotiate"),this.dispatchEvent(new CustomEvent$1("signal",{detail:{type:"renegotiate"}}))}async handleOffer(a){await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(a));for(const j of this.iceCandidates)await this.handleCandidate(j);this.iceCandidates=[];const $=await this.peerConnection.createAnswer(this.options.answerOptions);await this.peerConnection.setLocalDescription($),log$S.trace("handle offer",this.peerConnection.localDescription),this.dispatchEvent(new CustomEvent$1("signal",{detail:this.peerConnection.localDescription??$}))}async handleCandidate(a){if(this.peerConnection.remoteDescription==null||this.peerConnection.remoteDescription.type==null){this.iceCandidates.push(a);return}await super.handleCandidate(a)}}const normalizeEmitter=_=>{const a=_.on||_.addListener||_.addEventListener,$=_.off||_.removeListener||_.removeEventListener;if(!a||!$)throw new TypeError("Emitter is not compatible");return{addListener:a.bind(_),removeListener:$.bind(_)}};function pEventMultiple(_,a,$){let j;const _e=new Promise((et,tt)=>{if($={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...$},!($.count>=0&&($.count===Number.POSITIVE_INFINITY||Number.isInteger($.count))))throw new TypeError("The `count` option should be at least 0 or more");const rt=[a].flat(),nt=[],{addListener:it,removeListener:st}=normalizeEmitter(_),ot=(...lt)=>{const ct=$.multiArgs?lt:lt[0];$.filter&&!$.filter(ct)||(nt.push(ct),$.count===nt.length&&(j(),et(nt)))},at=lt=>{j(),tt(lt)};j=()=>{for(const lt of rt)st(lt,ot);for(const lt of $.rejectionEvents)st(lt,at)};for(const lt of rt)it(lt,ot);for(const lt of $.rejectionEvents)it(lt,at);$.resolveImmediately&&et(nt)});if(_e.cancel=j,typeof $.timeout=="number"){const et=pTimeout$2(_e,$.timeout);return et.cancel=j,et}return _e}function pEvent(_,a,$){typeof $=="function"&&($={filter:$}),$={...$,count:1,resolveImmediately:!1};const j=pEventMultiple(_,a,$),_e=j.then(et=>et[0]);return _e.cancel=j.cancel,_e}const log$R=logger$1("libp2p:webrtc-peer:initator"),ICECOMPLETE_TIMEOUT=1e3;class WebRTCInitiator extends WebRTCPeer{constructor(a={}){super({...a,logPrefix:"initiator"}),this.handleDataChannelEvent({channel:this.peerConnection.createDataChannel(a.dataChannelLabel??toString$6(random_browser(20),"hex").slice(0,7),a.dataChannelInit)}),this.handshake=new WebRTCInitiatorHandshake({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,offerOptions:a.offerOptions}),this.handshake.addEventListener("signal",$=>{this.dispatchEvent(new CustomEvent$1("signal",{detail:$.detail}))})}handleSignal(a){this.handshake.handleSignal(a).catch($=>{this.log("error handling signal %o %o",a,$)})}}class WebRTCInitiatorHandshake extends WebRTCHandshake{constructor(a){super(a),this.options=a,this.status="idle",this.peerConnection.addEventListener("icecandidate",$=>{if($.candidate==null)return;const j={type:"candidate",candidate:{candidate:$.candidate.candidate,sdpMLineIndex:$.candidate.sdpMLineIndex,sdpMid:$.candidate.sdpMid}};log$R.trace("create candidate",j),this.dispatchEvent(new CustomEvent$1("signal",{detail:j})),this.dispatchEvent(new CustomEvent$1("ice-candidate"))})}async handleRenegotiate(){if(this.status==="negotiating"){this.log("already negotiating, queueing");return}this.status="negotiating";const a=await this.peerConnection.createOffer(this.options.offerOptions);await this.peerConnection.setLocalDescription(a),await pEvent(this,"ice-candidate"),await delay$1.exports(ICECOMPLETE_TIMEOUT),log$R.trace("renegotiate",this.peerConnection.localDescription),this.dispatchEvent(new CustomEvent$1("signal",{detail:this.peerConnection.localDescription??a}))}async handleAnswer(a){log$R.trace("handle answer",a),await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(a)),this.status="idle"}}const log$Q=logger$1("libp2p:webrtc-star:socket");function toMultiaddrConnection(_,a){const{sink:$,source:j}=_,_e={remoteAddr:a.remoteAddr,async sink(et){a.signal!=null&&(et=abortableSource(et,a.signal));try{await $(et)}catch(tt){tt.type!=="aborted"&&log$Q.error(tt)}},source:a.signal!=null?abortableSource(j,a.signal):j,timeline:{open:Date.now()},async close(){if(_.closed)return;const et=Date.now(),tt=setTimeout(()=>{if(_e.remoteAddr!=null){const{host:rt,port:nt}=_e.remoteAddr.toOptions();log$Q("timeout closing socket to %s:%s after %dms, destroying it manually",rt,nt,Date.now()-et)}_.closed||_.close().catch(rt=>{log$Q.error("could not close socket",rt)})},CLOSE_TIMEOUT$1);try{await _.close()}finally{clearTimeout(tt)}}};return _.addEventListener("close",()=>{_e.timeline.close==null&&(_e.timeline.close=Date.now())},{once:!0}),_e}function cleanUrlSIO(_){const a=_.toString().split("/"),$=_.protos()[1].name,j=_.protos()[2].name,_e=_.stringTuples()[1][1];if($!=="tcp"||j!=="ws"&&j!=="wss")throw new Error(`invalid multiaddr: ${_.toString()}`);if(!isName(_))return`http://${a[2]}:${a[4]}`;if(j==="ws")return`http://${a[2]}${_e==null||_e==="80"?"":`:${_e}`}`;if(j==="wss")return`https://${a[2]}${_e==null||_e==="443"?"":`:${_e}`}`;throw new Error("invalid multiaddr: "+_.toString())}function cleanMultiaddr(_){const a="/libp2p-webrtc-star";if(_.startsWith(a)){_=_.substring(a.length,_.length);let $=multiaddr(_);const j=$.stringTuples().filter(_e=>_e[0]===421)[0];if(j[1]==null)throw new Error("invalid multiaddr: "+_);$=$.decapsulate("p2p"),$=$.encapsulate("/p2p-webrtc-star"),$=$.encapsulate(`/p2p/${j[1]}`),_=$.toString()}return _}const log$P=logger$1("libp2p:webrtc-star:listener"),sioOptions={transports:["websocket"],path:"/socket.io-next/"};class SigServer extends EventEmitter$1{constructor(a,$,j,_e,et){super(),this.signallingAddr=$,this.socket=lookup(a,sioOptions),this.connections=[],this.channels=new Map,this.pendingSignals=new Map,this.upgrader=j,this.handler=_e,this.channelOptions=et,this.handleWsHandshake=this.handleWsHandshake.bind(this);let tt=!1;this.socket.on("connect_error",rt=>{tt&&rt.type==="TransportError"||this.dispatchEvent(new CustomEvent$1("error",{detail:rt}))}),this.socket.on("error",rt=>{this.dispatchEvent(new CustomEvent$1("error",{detail:rt}))}),this.socket.on("ws-handshake",this.handleWsHandshake),this.socket.on("ws-peer",rt=>{this.dispatchEvent(new CustomEvent$1("peer",{detail:rt}))}),this.socket.on("connect",()=>{this.socket.emit("ss-join",this.signallingAddr.toString()),tt&&this.dispatchEvent(new CustomEvent$1("reconnect"))}),this.socket.once("connect",()=>{tt=!0,this.dispatchEvent(new CustomEvent$1("listening"))}),this.socket.on("disconnect",()=>{this.dispatchEvent(new CustomEvent$1("disconnect"))})}_createChannel(a,$,j){const _e={...this.channelOptions},et=new WebRTCReceiver(_e),tt=rt=>{const nt=rt.detail;log$P.error("incoming connection errored",nt)};return et.addEventListener("error",tt),et.addEventListener("close",()=>{et.removeEventListener("error",tt)},{once:!0}),et.addEventListener("signal",rt=>{const nt=rt.detail;this.socket.emit("ss-handshake",{intentId:a,srcMultiaddr:$,dstMultiaddr:j,answer:!0,signal:nt})}),et.addEventListener("ready",()=>{const rt=toMultiaddrConnection(et,{remoteAddr:this.signallingAddr});log$P("new inbound connection %s",rt.remoteAddr);try{this.upgrader.upgradeInbound(rt).then(nt=>{log$P("inbound connection %s upgraded",rt.remoteAddr),this.connections.push(rt);const it=()=>{this.connections=this.connections.filter(st=>st!==rt),this.channels.delete(a),this.pendingSignals.delete(a)};et.addEventListener("close",it,{once:!0}),this.dispatchEvent(new CustomEvent$1("connection",{detail:nt})),this.handler(nt)}).catch(nt=>{log$P.error("inbound connection failed to upgrade",nt),rt.close().catch(it=>{log$P.error("inbound connection failed to close after failing to upgrade",it)})})}catch(nt){log$P.error("inbound connection failed to upgrade",nt),rt.close().catch(it=>{log$P.error("inbound connection failed to close after failing to upgrade",it)})}},{once:!0}),et}handleWsHandshake(a){if(log$P('incoming handshake. signal type "%s" is answer %s',a.signal.type,a.answer),a.answer===!0||a.err!=null||a.intentId==null)return;const $=a.intentId;let j=this.pendingSignals.get($);j==null&&(j=[],this.pendingSignals.set($,j)),j.push(a);let _e=this.channels.get($);if(_e==null){if(a.signal.type!=="offer"){log$P("handshake is not an offer and channel does not exist, buffering until we receive an offer");return}log$P("creating new channel to handle offer handshake"),_e=this._createChannel(a.intentId,a.srcMultiaddr,a.dstMultiaddr),this.channels.set($,_e)}else log$P("channel already exists, using it to handle handshake");for(;j.length>0;){const et=j.shift();et?.signal!=null&&_e.handleSignal(et.signal)}}async close(){this.socket.emit("ss-leave",this.signallingAddr.toString()),this.socket.removeAllListeners(),this.socket.close(),await Promise.all([...this.connections.map(async a=>await a.close()),...Array.from(this.channels.values()).map(async a=>await a.close())]),this.dispatchEvent(new CustomEvent$1("close"))}}class WebRTCListener extends EventEmitter$1{constructor(a,$,j,_e,et){super(),this.upgrader=a,this.handler=$,this.peerId=j,this.transport=_e,this.options=et}async listen(a){if(this.listeningAddr!=null)throw errCode(new Error("listener already in use"),"ERR_ALREADY_LISTENING");const $=pDefer$2();this.listeningAddr=a;let j;a.protoCodes().includes(CODE_P2P$1)?j=a:j=a.encapsulate(`/p2p/${this.peerId.toString()}`);const _e=this.signallingUrl=cleanUrlSIO(a);log$P("connecting to signalling server on: %s",this.signallingUrl);const et=new SigServer(this.signallingUrl,j,this.upgrader,this.handler,this.options.channelOptions);return et.addEventListener("error",tt=>{const rt=tt.detail;log$P("error connecting to signalling server %o",rt),et.close().catch(nt=>{log$P.error("error closing server after error",nt)}),$.reject(rt)}),et.addEventListener("listening",()=>{log$P("connected to signalling server"),this.dispatchEvent(new CustomEvent$1("listening")),$.resolve()}),et.addEventListener("peer",tt=>{this.transport.peerDiscovered(tt.detail)}),et.addEventListener("connection",tt=>{const rt=tt.detail;if(rt.remoteAddr==null)try{rt.remoteAddr=a.decapsulateCode(CODE_P2P$1).encapsulate(`/p2p/${rt.remotePeer.toString()}`)}catch(nt){log$P.error("could not determine remote address",nt)}this.dispatchEvent(new CustomEvent$1("connection",{detail:rt}))}),et.addEventListener("disconnect",()=>{this.transport.sigServers.delete(_e)}),et.addEventListener("reconnect",()=>{this.transport.sigServers.set(_e,et)}),this.transport.sigServers.set(this.signallingUrl,et),await $.promise}async close(){if(this.signallingUrl!=null){const a=this.transport.sigServers.get(this.signallingUrl);a!=null&&(await a.close(),this.transport.sigServers.delete(this.signallingUrl))}this.dispatchEvent(new CustomEvent$1("close")),this.listeningAddr=void 0}getAddrs(){return this.listeningAddr!=null?[this.listeningAddr]:[]}}function createListener$2(_,a,$,j,_e){return new WebRTCListener(_,a,$,j,_e)}function xor(_,a){if(_.length!==a.length)throw new Error("Inputs should have the same length");const $=allocUnsafe$5(_.length);for(let j=0;j<_.length;j++)$[j]=_[j]^a[j];return asUint8Array$2($)}const symbol$2=Symbol.for("@libp2p/transport"),symbol$1=Symbol.for("@libp2p/peer-discovery"),webrtcSupport="RTCPeerConnection"in globalThis,log$O=logger$1("libp2p:webrtc-star"),noop$1=()=>{};class WebRTCStarDiscovery extends EventEmitter$1{constructor(){super(...arguments),this.started=!1}get[symbol$1](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star-discovery"}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}dispatchEvent(a){return this.isStarted()?super.dispatchEvent(a):!1}}class WebRTCStar{constructor(a){a?.wrtc!=null&&(this.wrtc=a.wrtc),this.sigServers=new Map,this._discovery=new WebRTCStarDiscovery,this.discovery=()=>this._discovery,this.peerDiscovered=this.peerDiscovered.bind(this)}get[symbol$2](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star"}async dial(a,$){const j=await this._connect(a,$),_e=toMultiaddrConnection(j,{remoteAddr:a,signal:$.signal});log$O("new outbound connection %s",_e.remoteAddr);const et=await $.upgrader.upgradeOutbound(_e);return log$O("outbound connection %s upgraded",_e.remoteAddr),et}async _connect(a,$){if($.signal?.aborted===!0)throw new AbortError$2;const j={...$.channelOptions??{}};this.wrtc!=null&&(j.wrtc=this.wrtc);const _e=a.toOptions(),et=toString$6(random_browser(36),"hex");return await new Promise((tt,rt)=>{const nt=this.sigServers.get(cleanUrlSIO(a));if(nt?.socket==null)return rt(errCode(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let it=!1;log$O("dialing %s:%s",_e.host,_e.port);const st=new WebRTCInitiator(j),ot=ut=>{const dt=ut.detail;if(!it){const ft=`connection error ${_e.host}:${_e.port}: ${dt.message}`;log$O.error(ft),ct(dt)}},at=()=>{it=!0,log$O("connection opened %s:%s",_e.host,_e.port),ct()},lt=()=>{log$O.error("connection aborted %s:%s",_e.host,_e.port),st.close().finally(()=>{ct(new AbortError$2)})},ct=ut=>{st.removeEventListener("ready",at),$.signal?.removeEventListener("abort",lt),ut==null?tt(st):rt(ut)};st.addEventListener("ready",at,{once:!0}),st.addEventListener("close",()=>{st.removeEventListener("error",ot)}),$.signal?.addEventListener("abort",lt),st.addEventListener("signal",ut=>{const dt=ut.detail;nt.socket.emit("ss-handshake",{intentId:et,srcMultiaddr:nt.signallingAddr.toString(),dstMultiaddr:a.toString(),signal:dt})}),nt.socket.on("ws-handshake",ut=>{ut.intentId===et&&ut.err!=null&&st.close().finally(()=>{rt(errCode(new Error(ut.err),"ERR_SIGNALLING_FAILED"))}),!(ut.intentId!==et||ut.answer==null||st.closed)&&st.handleSignal(ut.signal)})})}createListener(a){if(!webrtcSupport&&this.wrtc==null)throw errCode(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");if(a.channelOptions=a.channelOptions??{},this.wrtc!=null&&(a.channelOptions.wrtc=this.wrtc),this.peerId==null)throw errCode(new Error("PeerId not set"),"ERR_MISSING_PEER_ID");return createListener$2(a.upgrader,a.handler??noop$1,this.peerId,this,a)}filter(a){return a=Array.isArray(a)?a:[a],a.filter($=>$.protoCodes().includes(CODE_CIRCUIT$1)?!1:WebRTCStar$1.matches($))}peerDiscovered(a){log$O("peer discovered: %s",a),a=cleanMultiaddr(a);const $=multiaddr(a),j=$.getPeerId();if(j==null)return;const _e=peerIdFromString(j);this._discovery.dispatchEvent(new CustomEvent$1("peer",{detail:{id:_e,multiaddrs:[$],protocols:[]}}))}}function webRTCStar(_={}){const a=new WebRTCStar(_);return{transport:$=>(a.peerId=$.peerId,a),discovery:a.discovery}}function libp2pConfig(){const _=webRTCStar();return{transports:[_.transport],peerDiscovery:[_.discovery],connectionManager:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4,autoDial:!0},nat:{enabled:!1},metrics:{enabled:!0}}}var messages;(function(_){_.NOT_STARTED_YET="The libp2p node is not started yet",_.DHT_DISABLED="DHT is not available",_.PUBSUB_DISABLED="PubSub is not available",_.CONN_ENCRYPTION_REQUIRED="At least one connection encryption module is required",_.ERR_TRANSPORTS_REQUIRED="At least one transport module is required",_.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",_.NOT_FOUND="Not found"})(messages||(messages={}));var codes$1;(function(_){_.DHT_DISABLED="ERR_DHT_DISABLED",_.ERR_PUBSUB_DISABLED="ERR_PUBSUB_DISABLED",_.PUBSUB_NOT_STARTED="ERR_PUBSUB_NOT_STARTED",_.DHT_NOT_STARTED="ERR_DHT_NOT_STARTED",_.CONN_ENCRYPTION_REQUIRED="ERR_CONN_ENCRYPTION_REQUIRED",_.ERR_TRANSPORTS_REQUIRED="ERR_TRANSPORTS_REQUIRED",_.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",_.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",_.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",_.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",_.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",_.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",_.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",_.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",_.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",_.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",_.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",_.ERR_DIALED_SELF="ERR_DIALED_SELF",_.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",_.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",_.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",_.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",_.ERR_INVALID_KEY="ERR_INVALID_KEY",_.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",_.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",_.ERR_INVALID_PEER="ERR_INVALID_PEER",_.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",_.ERR_NOT_FOUND="ERR_NOT_FOUND",_.ERR_TIMEOUT="ERR_TIMEOUT",_.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",_.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",_.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",_.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",_.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",_.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",_.ERR_FIND_SELF="ERR_FIND_SELF",_.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",_.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",_.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",_.ERR_KEYCHAIN_REQUIRED="ERR_KEYCHAIN_REQUIRED",_.ERR_INVALID_CMS="ERR_INVALID_CMS",_.ERR_MISSING_KEYS="ERR_MISSING_KEYS",_.ERR_NO_KEY="ERR_NO_KEY",_.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",_.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",_.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",_.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",_.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",_.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",_.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",_.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",_.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",_.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",_.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",_.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",_.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",_.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",_.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",_.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",_.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",_.ERR_INVALID_RECORD="ERR_INVALID_RECORD",_.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED",_.ERR_NO_HANDLER_FOR_PROTOCOL="ERR_NO_HANDLER_FOR_PROTOCOL",_.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",_.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",_.ERR_CONNECTION_DENIED="ERR_CONNECTION_DENIED"})(codes$1||(codes$1={}));async function*filter(_,a){for await(const $ of _)await a($)&&(yield $)}async function*storeAddresses(_,a){yield*map$6(_,async $=>(await a.addressBook.add($.id,$.multiaddrs),$))}function uniquePeers(_){const a=new Set;return filter(_,$=>a.has($.id.toString())?!1:(a.add($.id.toString()),!0))}async function*requirePeers(_,a=1){let $=0;for await(const j of _)$++,yield j;if($<a)throw errCode(new Error("not found"),"NOT_FOUND")}const intervals=new Map,_generateId=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function _runPeriodically(_,a,$){for(;intervals.get($);){try{await _()}catch(j){setTimeout(()=>{throw j},1);break}if(!intervals.get($))break;await new Promise(j=>{const _e=setTimeout(j,a);intervals.set($,_e)})}}function setDelayedInterval(_,a,$){$=$||a;const j=_generateId(),_e=setTimeout(()=>{_runPeriodically(_,a,j)},$);return intervals.set(j,_e),j}function clearDelayedInterval(_){const a=intervals.get(_);a&&(clearTimeout(a),intervals.delete(_))}var src$1={setDelayedInterval,clearDelayedInterval};const log$N=logger$1("libp2p:peer-routing");class DefaultPeerRouting{constructor(a,$){this.components=a,this.routers=$.routers,this.refreshManagerInit=$.refreshManager??{},this.started=!1,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}isStarted(){return this.started}async start(){this.started||this.routers.length===0||this.timeoutId!=null||this.refreshManagerInit.enabled===!1||(this.timeoutId=src$1.setDelayedInterval(this._findClosestPeersTask,this.refreshManagerInit.interval,this.refreshManagerInit.bootDelay),this.started=!0)}async _findClosestPeersTask(){if(this.abortController==null)try{this.abortController=new timeoutAbortController.TimeoutController(this.refreshManagerInit.timeout??1e4);try{events.exports.setMaxListeners?.(1/0,this.abortController.signal)}catch{}await drain$3(this.getClosestPeers(this.components.peerId.toBytes(),{signal:this.abortController.signal}))}catch(a){log$N.error(a)}finally{this.abortController?.clear(),this.abortController=void 0}}async stop(){src$1.clearDelayedInterval(this.timeoutId),this.abortController?.abort(),this.started=!1}async findPeer(a,$){if(this.routers.length===0)throw errCode(new Error("No peer routers available"),codes$1.ERR_NO_ROUTERS_AVAILABLE);if(a.toString()===this.components.peerId.toString())throw errCode(new Error("Should not try to find self"),codes$1.ERR_FIND_SELF);const j=await pipe(merge$2(...this.routers.map(_e=>async function*(){try{yield await _e.findPeer(a,$)}catch(et){log$N.error(et)}}())),_e=>filter(_e,Boolean),_e=>storeAddresses(_e,this.components.peerStore),async _e=>await first$2(_e));if(j!=null)return j;throw errCode(new Error(messages.NOT_FOUND),codes$1.ERR_NOT_FOUND)}async*getClosestPeers(a,$){if(this.routers.length===0)throw errCode(new Error("No peer routers available"),codes$1.ERR_NO_ROUTERS_AVAILABLE);yield*pipe(merge$2(...this.routers.map(j=>j.getClosestPeers(a,$))),j=>storeAddresses(j,this.components.peerStore),j=>uniquePeers(j),j=>requirePeers(j))}}class CompoundContentRouting{constructor(a,$){this.routers=$.routers??[],this.started=!1,this.components=a}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}async*findProviders(a,$={}){if(this.routers.length===0)throw errCode(new Error("No content this.routers available"),codes$1.ERR_NO_ROUTERS_AVAILABLE);yield*pipe(merge$2(...this.routers.map(j=>j.findProviders(a,$))),j=>storeAddresses(j,this.components.peerStore),j=>uniquePeers(j),j=>requirePeers(j))}async provide(a,$={}){if(this.routers.length===0)throw errCode(new Error("No content routers available"),codes$1.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map(async j=>await j.provide(a,$)))}async put(a,$,j){if(!this.isStarted())throw errCode(new Error(messages.NOT_STARTED_YET),codes$1.DHT_NOT_STARTED);const _e=this.components.dht;_e!=null&&await drain$3(_e.put(a,$,j))}async get(a,$){if(!this.isStarted())throw errCode(new Error(messages.NOT_STARTED_YET),codes$1.DHT_NOT_STARTED);const j=this.components.dht;if(j!=null){for await(const _e of j.get(a,$))if(_e.name==="VALUE")return _e.value}throw errCode(new Error(messages.NOT_FOUND),codes$1.ERR_NOT_FOUND)}async*getMany(a,$,j){if(!this.isStarted())throw errCode(new Error(messages.NOT_STARTED_YET),codes$1.DHT_NOT_STARTED);if($==null||$===0)return;let _e=0;const et=this.components.dht;if(et!=null){for await(const tt of et.get(a,j))if(tt.name==="VALUE"&&(yield{from:tt.from,val:tt.value},_e++,_e===$))break}if(_e===0)throw errCode(new Error(messages.NOT_FOUND),codes$1.ERR_NOT_FOUND)}}function peerIdFromMultiaddr(_){const a=_.getPeerId();if(a==null)throw errCode(new Error(`${_.toString()} does not have a valid peer type`),codes$1.ERR_INVALID_MULTIADDR);try{return peerIdFromString(a)}catch{throw errCode(new Error(`${_.toString()} is not a valid peer type`),codes$1.ERR_INVALID_MULTIADDR)}}function getPeer(_){if(isPeerId(_))return{id:_,multiaddrs:[],protocols:[]};typeof _=="string"&&(_=multiaddr(_));let a;return isMultiaddr(_)&&(a=_,_=peerIdFromMultiaddr(_)),{id:_,multiaddrs:a!=null?[a]:[],protocols:[]}}const defaultAddressFilter=_=>_;class DefaultAddressManager extends EventEmitter$1{constructor(a,$){super();const{listen:j=[],announce:_e=[]}=$;this.components=a,this.listen=new Set(j.map(et=>et.toString())),this.announce=new Set(_e.map(et=>et.toString())),this.observed=new Set,this.announceFilter=$.announceFilter??defaultAddressFilter}getListenAddrs(){return Array.from(this.listen).map(a=>multiaddr(a))}getAnnounceAddrs(){return Array.from(this.announce).map(a=>multiaddr(a))}getObservedAddrs(){return Array.from(this.observed).map(a=>multiaddr(a))}confirmObservedAddr(a){}removeObservedAddr(a){}addObservedAddr(a){let $=multiaddr(a);const j=$.getPeerId();j!=null&&peerIdFromString(j).equals(this.components.peerId)&&($=$.decapsulate(multiaddr(`/p2p/${this.components.peerId.toString()}`)));const _e=$.toString();this.observed.has(_e)||(this.observed.add(_e),this.dispatchEvent(new CustomEvent$1("change:addresses")))}getAddresses(){let a=this.getAnnounceAddrs().map(j=>j.toString());a.length===0&&(a=this.components.transportManager.getAddrs().map(j=>j.toString())),a=a.concat(this.getObservedAddrs().map(j=>j.toString()));const $=new Set(a);return this.announceFilter(Array.from($).map(j=>multiaddr(j))).map(j=>j.getPeerId()===this.components.peerId.toString()?j:j.encapsulate(`/p2p/${this.components.peerId.toString()}`))}}const log$M=logger$1("libp2p:connection-manager:latency-monitor:visibility-change-emitter");class VisibilityChangeEmitter extends EventEmitter$1{constructor(){super(),this.hidden="hidden",this.visibilityChange="visibilityChange",globalThis.document!=null&&(this._initializeVisibilityVarNames(),this._addVisibilityChangeListener())}_initializeVisibilityVarNames(){let a="hidden",$="visibilitychange";typeof globalThis.document.hidden<"u"?(a="hidden",$="visibilitychange"):typeof globalThis.document.mozHidden<"u"?(a="mozHidden",$="mozvisibilitychange"):typeof globalThis.document.msHidden<"u"?(a="msHidden",$="msvisibilitychange"):typeof globalThis.document.webkitHidden<"u"&&(a="webkitHidden",$="webkitvisibilitychange"),this.hidden=a,this.visibilityChange=$}_addVisibilityChangeListener(){typeof globalThis.document.addEventListener>"u"||typeof document[this.hidden]>"u"?log$M("Checking page visibility requires a browser that supports the Page Visibility API."):globalThis.document.addEventListener(this.visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this.hidden===void 0||document[this.hidden]===void 0))return document[this.hidden]==null}_handleVisibilityChange(){const a=globalThis.document[this.hidden]===!1;log$M(a?"Page Visible":"Page Hidden"),this.dispatchEvent(new CustomEvent$1("visibilityChange",{detail:a}))}}const log$L=logger$1("libp2p:connection-manager:latency-monitor");class LatencyMonitor extends EventEmitter$1{constructor(a={}){super();const{latencyCheckIntervalMs:$,dataEmitIntervalMs:j,asyncTestFn:_e,latencyRandomPercentage:et}=a;this.latencyCheckIntervalMs=$??500,this.latencyRandomPercentage=et??10,this.latencyCheckMultiply=2*(this.latencyRandomPercentage/100)*this.latencyCheckIntervalMs,this.latencyCheckSubtract=this.latencyCheckMultiply/2,this.dataEmitIntervalMs=j===null||j===0?void 0:j??5*1e3,log$L("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",this.latencyCheckIntervalMs,this.dataEmitIntervalMs),this.dataEmitIntervalMs!=null?log$L("Expecting ~%s events per summary",this.latencyCheckIntervalMs/this.dataEmitIntervalMs):log$L("Not emitting summaries"),this.asyncTestFn=_e,globalThis.process?.hrtime!=null?(log$L("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=tt=>{const rt=this.now(tt);return rt[0]*1e3+rt[1]/1e6}):typeof window<"u"&&window.performance?.now!=null?(log$L("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=tt=>Math.round(this.now()-tt)):(log$L("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=tt=>this.now()-tt),this.latencyData=this.initLatencyData()}start(){isBrowser$1()&&(this.visibilityChangeEmitter=new VisibilityChangeEmitter,this.visibilityChangeEmitter.addEventListener("visibilityChange",a=>{const{detail:$}=a;$?this._startTimers():(this._emitSummary(),this._stopTimers())})),this.visibilityChangeEmitter?.isVisible()===!0&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this.checkLatencyID==null&&(this.checkLatency(),this.dataEmitIntervalMs!=null&&(this.emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this.emitIntervalID.unref=="function"&&this.emitIntervalID.unref()))}_stopTimers(){this.checkLatencyID!=null&&(clearTimeout(this.checkLatencyID),this.checkLatencyID=void 0),this.emitIntervalID!=null&&(clearInterval(this.emitIntervalID),this.emitIntervalID=void 0)}_emitSummary(){const a=this.getSummary();a.events>0&&this.dispatchEvent(new CustomEvent$1("data",{detail:a}))}getSummary(){const a={events:this.latencyData.events,minMs:this.latencyData.minMs,maxMs:this.latencyData.maxMs,avgMs:this.latencyData.events>0?this.latencyData.totalMs/this.latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this.latencyData.startTime)};return this.latencyData=this.initLatencyData(),log$L.trace("Summary: %O",a),a}checkLatency(){const a=Math.random()*this.latencyCheckMultiply-this.latencyCheckSubtract,$={deltaOffset:Math.ceil(this.latencyCheckIntervalMs+a),startTime:this.now()},j=()=>{if(this.checkLatencyID==null)return;const _e=this.getDeltaMS($.startTime)-$.deltaOffset;this.checkLatency(),this.latencyData.events++,this.latencyData.minMs=Math.min(this.latencyData.minMs,_e),this.latencyData.maxMs=Math.max(this.latencyData.maxMs,_e),this.latencyData.totalMs+=_e,log$L.trace("MS: %s Data: %O",_e,this.latencyData)};log$L.trace("localData: %O",$),this.checkLatencyID=setTimeout(()=>{this.asyncTestFn!=null?($.deltaOffset=0,$.startTime=this.now(),this.asyncTestFn(j)):($.deltaOffset-=1,j())},$.deltaOffset),typeof this.checkLatencyID.unref=="function"&&this.checkLatencyID.unref()}initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}}function isBrowser$1(){return typeof globalThis.window<"u"}const OPEN="OPEN",CLOSING="CLOSING",CLOSED="CLOSED";function mapIterable(_,a){const $={[Symbol.iterator]:()=>$,next:()=>{const j=_.next(),_e=j.value;return j.done===!0||_e==null?{done:!0,value:void 0}:{done:!1,value:a(_e)}}};return $}class PeerMap{constructor(a){if(this.map=new Map,a!=null)for(const[$,j]of a.entries())this.map.set($.toString(),j)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(a){this.map.delete(a.toString())}entries(){return mapIterable(this.map.entries(),a=>[peerIdFromString(a[0]),a[1]])}forEach(a){this.map.forEach(($,j)=>{a($,peerIdFromString(j),this)})}get(a){return this.map.get(a.toString())}has(a){return this.map.has(a.toString())}set(a,$){this.map.set(a.toString(),$)}keys(){return mapIterable(this.map.keys(),a=>peerIdFromString(a))}values(){return this.map.values()}get size(){return this.map.size}}class PeerSet{constructor(a){if(this.set=new Set,a!=null)for(const $ of a)this.set.add($.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(a){this.set.add(a.toString())}clear(){this.set.clear()}delete(a){this.set.delete(a.toString())}entries(){return mapIterable(this.set.entries(),a=>{const $=peerIdFromString(a[0]);return[$,$]})}forEach(a){this.set.forEach($=>{const j=peerIdFromString($);a(j,j,this)})}has(a){return this.set.has(a.toString())}values(){return mapIterable(this.set.values(),a=>peerIdFromString(a))}intersection(a){const $=new PeerSet;for(const j of a)this.has(j)&&$.add(j);return $}difference(a){const $=new PeerSet;for(const j of this)a.has(j)||$.add(j);return $}union(a){const $=new PeerSet;for(const j of a)$.add(j);for(const j of this)$.add(j);return $}}const KEEP_ALIVE="keep-alive";var RateLimiterAbstract_1=class{constructor(a={}){this.points=a.points,this.duration=a.duration,this.blockDuration=a.blockDuration,this.execEvenly=a.execEvenly,this.execEvenlyMinDelayMs=a.execEvenlyMinDelayMs,this.keyPrefix=a.keyPrefix}get points(){return this._points}set points(a){this._points=a>=0?a:4}get duration(){return this._duration}set duration(a){this._duration=typeof a>"u"?1:a}get msDuration(){return this.duration*1e3}get blockDuration(){return this._blockDuration}set blockDuration(a){this._blockDuration=typeof a>"u"?0:a}get msBlockDuration(){return this.blockDuration*1e3}get execEvenly(){return this._execEvenly}set execEvenly(a){this._execEvenly=typeof a>"u"?!1:Boolean(a)}get execEvenlyMinDelayMs(){return this._execEvenlyMinDelayMs}set execEvenlyMinDelayMs(a){this._execEvenlyMinDelayMs=typeof a>"u"?Math.ceil(this.msDuration/this.points):a}get keyPrefix(){return this._keyPrefix}set keyPrefix(a){if(typeof a>"u"&&(a="rlflx"),typeof a!="string")throw new Error("keyPrefix must be string");this._keyPrefix=a}_getKeySecDuration(a={}){return a&&a.customDuration>=0?a.customDuration:this.duration}getKey(a){return this.keyPrefix.length>0?`${this.keyPrefix}:${a}`:a}parseKey(a){return a.substring(this.keyPrefix.length)}consume(){throw new Error("You have to implement the method 'consume'!")}penalty(){throw new Error("You have to implement the method 'penalty'!")}reward(){throw new Error("You have to implement the method 'reward'!")}get(){throw new Error("You have to implement the method 'get'!")}set(){throw new Error("You have to implement the method 'set'!")}block(){throw new Error("You have to implement the method 'block'!")}delete(){throw new Error("You have to implement the method 'delete'!")}},BlockedKeys_1$1=class{constructor(){this._keys={},this._addedKeysAmount=0}collectExpired(){const a=Date.now();Object.keys(this._keys).forEach($=>{this._keys[$]<=a&&delete this._keys[$]}),this._addedKeysAmount=Object.keys(this._keys).length}add(a,$){this.addMs(a,$*1e3)}addMs(a,$){this._keys[a]=Date.now()+$,this._addedKeysAmount++,this._addedKeysAmount>999&&this.collectExpired()}msBeforeExpire(a){const $=this._keys[a];if($&&$>=Date.now()){this.collectExpired();const j=Date.now();return $>=j?$-j:0}return 0}delete(a){a?delete this._keys[a]:Object.keys(this._keys).forEach($=>{delete this._keys[$]})}};const BlockedKeys$1=BlockedKeys_1$1;var BlockedKeys_1=BlockedKeys$1,RateLimiterRes_1=class{constructor(a,$,j,_e){this.remainingPoints=typeof a>"u"?0:a,this.msBeforeNext=typeof $>"u"?0:$,this.consumedPoints=typeof j>"u"?0:j,this.isFirstInDuration=typeof _e>"u"?!1:_e}get msBeforeNext(){return this._msBeforeNext}set msBeforeNext(a){return this._msBeforeNext=a,this}get remainingPoints(){return this._remainingPoints}set remainingPoints(a){return this._remainingPoints=a,this}get consumedPoints(){return this._consumedPoints}set consumedPoints(a){return this._consumedPoints=a,this}get isFirstInDuration(){return this._isFirstInDuration}set isFirstInDuration(a){this._isFirstInDuration=Boolean(a)}_getDecoratedProperties(){return{remainingPoints:this.remainingPoints,msBeforeNext:this.msBeforeNext,consumedPoints:this.consumedPoints,isFirstInDuration:this.isFirstInDuration}}[Symbol.for("nodejs.util.inspect.custom")](){return this._getDecoratedProperties()}toString(){return JSON.stringify(this._getDecoratedProperties())}toJSON(){return this._getDecoratedProperties()}};const RateLimiterAbstract$3=RateLimiterAbstract_1,BlockedKeys=BlockedKeys_1,RateLimiterRes$b=RateLimiterRes_1;var RateLimiterStoreAbstract_1=class extends RateLimiterAbstract$3{constructor(a={}){super(a),this.inMemoryBlockOnConsumed=a.inMemoryBlockOnConsumed||a.inmemoryBlockOnConsumed,this.inMemoryBlockDuration=a.inMemoryBlockDuration||a.inmemoryBlockDuration,this.insuranceLimiter=a.insuranceLimiter,this._inMemoryBlockedKeys=new BlockedKeys}get client(){return this._client}set client(a){if(typeof a>"u")throw new Error("storeClient is not set");this._client=a}_afterConsume(a,$,j,_e,et,tt={}){const rt=this._getRateLimiterRes(j,_e,et);if(this.inMemoryBlockOnConsumed>0&&!(this.inMemoryBlockDuration>0)&&rt.consumedPoints>=this.inMemoryBlockOnConsumed)return this._inMemoryBlockedKeys.addMs(j,rt.msBeforeNext),rt.consumedPoints>this.points?$(rt):a(rt);if(rt.consumedPoints>this.points){let nt=Promise.resolve();this.blockDuration>0&&rt.consumedPoints<=this.points+_e&&(rt.msBeforeNext=this.msBlockDuration,nt=this._block(j,rt.consumedPoints,this.msBlockDuration,tt)),this.inMemoryBlockOnConsumed>0&&rt.consumedPoints>=this.inMemoryBlockOnConsumed&&(this._inMemoryBlockedKeys.add(j,this.inMemoryBlockDuration),rt.msBeforeNext=this.msInMemoryBlockDuration),nt.then(()=>{$(rt)}).catch(it=>{$(it)})}else if(this.execEvenly&&rt.msBeforeNext>0&&!rt.isFirstInDuration){let nt=Math.ceil(rt.msBeforeNext/(rt.remainingPoints+2));nt<this.execEvenlyMinDelayMs&&(nt=rt.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(a,nt,rt)}else a(rt)}_handleError(a,$,j,_e,et,tt=!1,rt={}){this.insuranceLimiter instanceof RateLimiterAbstract$3?this.insuranceLimiter[$](et,tt,rt).then(nt=>{j(nt)}).catch(nt=>{_e(nt)}):_e(a)}get _inmemoryBlockedKeys(){return this._inMemoryBlockedKeys}getInmemoryBlockMsBeforeExpire(a){return this.getInMemoryBlockMsBeforeExpire(a)}get inmemoryBlockOnConsumed(){return this.inMemoryBlockOnConsumed}set inmemoryBlockOnConsumed(a){this.inMemoryBlockOnConsumed=a}get inmemoryBlockDuration(){return this.inMemoryBlockDuration}set inmemoryBlockDuration(a){this.inMemoryBlockDuration=a}get msInmemoryBlockDuration(){return this.inMemoryBlockDuration*1e3}getInMemoryBlockMsBeforeExpire(a){return this.inMemoryBlockOnConsumed>0?this._inMemoryBlockedKeys.msBeforeExpire(a):0}get inMemoryBlockOnConsumed(){return this._inMemoryBlockOnConsumed}set inMemoryBlockOnConsumed(a){if(this._inMemoryBlockOnConsumed=a?parseInt(a):0,this.inMemoryBlockOnConsumed>0&&this.points>this.inMemoryBlockOnConsumed)throw new Error('inMemoryBlockOnConsumed option must be greater or equal "points" option')}get inMemoryBlockDuration(){return this._inMemoryBlockDuration}set inMemoryBlockDuration(a){if(this._inMemoryBlockDuration=a?parseInt(a):0,this.inMemoryBlockDuration>0&&this.inMemoryBlockOnConsumed===0)throw new Error("inMemoryBlockOnConsumed option must be set up")}get msInMemoryBlockDuration(){return this._inMemoryBlockDuration*1e3}get insuranceLimiter(){return this._insuranceLimiter}set insuranceLimiter(a){if(typeof a<"u"&&!(a instanceof RateLimiterAbstract$3))throw new Error("insuranceLimiter must be instance of RateLimiterAbstract");this._insuranceLimiter=a,this._insuranceLimiter&&(this._insuranceLimiter.blockDuration=this.blockDuration,this._insuranceLimiter.execEvenly=this.execEvenly)}block(a,$,j={}){const _e=$*1e3;return this._block(this.getKey(a),this.points+1,_e,j)}set(a,$,j,_e={}){const et=(j>=0?j:this.duration)*1e3;return this._block(this.getKey(a),$,et,_e)}consume(a,$=1,j={}){return new Promise((_e,et)=>{const tt=this.getKey(a),rt=this.getInMemoryBlockMsBeforeExpire(tt);if(rt>0)return et(new RateLimiterRes$b(0,rt));this._upsert(tt,$,this._getKeySecDuration(j)*1e3,!1,j).then(nt=>{this._afterConsume(_e,et,tt,$,nt)}).catch(nt=>{this._handleError(nt,"consume",_e,et,a,$,j)})})}penalty(a,$=1,j={}){const _e=this.getKey(a);return new Promise((et,tt)=>{this._upsert(_e,$,this._getKeySecDuration(j)*1e3,!1,j).then(rt=>{et(this._getRateLimiterRes(_e,$,rt))}).catch(rt=>{this._handleError(rt,"penalty",et,tt,a,$,j)})})}reward(a,$=1,j={}){const _e=this.getKey(a);return new Promise((et,tt)=>{this._upsert(_e,-$,this._getKeySecDuration(j)*1e3,!1,j).then(rt=>{et(this._getRateLimiterRes(_e,-$,rt))}).catch(rt=>{this._handleError(rt,"reward",et,tt,a,$,j)})})}get(a,$={}){const j=this.getKey(a);return new Promise((_e,et)=>{this._get(j,$).then(tt=>{_e(tt===null||typeof tt>"u"?null:this._getRateLimiterRes(j,0,tt))}).catch(tt=>{this._handleError(tt,"get",_e,et,a,$)})})}delete(a,$={}){const j=this.getKey(a);return new Promise((_e,et)=>{this._delete(j,$).then(tt=>{this._inMemoryBlockedKeys.delete(j),_e(tt)}).catch(tt=>{this._handleError(tt,"delete",_e,et,a,$)})})}deleteInMemoryBlockedAll(){this._inMemoryBlockedKeys.delete()}_getRateLimiterRes(a,$,j){throw new Error("You have to implement the method '_getRateLimiterRes'!")}_block(a,$,j,_e={}){return new Promise((et,tt)=>{this._upsert(a,$,j,!0,_e).then(()=>{et(new RateLimiterRes$b(0,j>0?j:-1,$))}).catch(rt=>{this._handleError(rt,"block",et,tt,this.parseKey(a),j/1e3,_e)})})}_get(a,$={}){throw new Error("You have to implement the method '_get'!")}_delete(a,$={}){throw new Error("You have to implement the method '_delete'!")}_upsert(a,$,j,_e=!1,et={}){throw new Error("You have to implement the method '_upsert'!")}};const RateLimiterStoreAbstract$4=RateLimiterStoreAbstract_1,RateLimiterRes$a=RateLimiterRes_1,incrTtlLuaScript="redis.call('set', KEYS[1], 0, 'EX', ARGV[2], 'NX') local consumed = redis.call('incrby', KEYS[1], ARGV[1]) local ttl = redis.call('pttl', KEYS[1]) if ttl == -1 then   redis.call('expire', KEYS[1], ARGV[2])   ttl = 1000 * ARGV[2] end return {consumed, ttl} ";class RateLimiterRedis$1 extends RateLimiterStoreAbstract$4{constructor(a){super(a),a.redis?this.client=a.redis:this.client=a.storeClient,this._rejectIfRedisNotReady=!!a.rejectIfRedisNotReady,typeof this.client.defineCommand=="function"&&this.client.defineCommand("rlflxIncr",{numberOfKeys:1,lua:incrTtlLuaScript})}_isRedisReady(){return this._rejectIfRedisNotReady?!(this.client.status&&this.client.status!=="ready"||typeof this.client.isReady=="function"&&!this.client.isReady()):!0}_getRateLimiterRes(a,$,j){let[_e,et]=j;Array.isArray(_e)&&([,_e]=_e,[,et]=et);const tt=new RateLimiterRes$a;return tt.consumedPoints=parseInt(_e),tt.isFirstInDuration=tt.consumedPoints===$,tt.remainingPoints=Math.max(this.points-tt.consumedPoints,0),tt.msBeforeNext=et,tt}_upsert(a,$,j,_e=!1){return new Promise((et,tt)=>{if(!this._isRedisReady())return tt(new Error("Redis connection is not ready"));const rt=Math.floor(j/1e3),nt=this.client.multi();if(_e)rt>0?nt.set(a,$,"EX",rt):nt.set(a,$),nt.pttl(a).exec((it,st)=>it?tt(it):et(st));else if(rt>0){const it=function(st,ot){return st?tt(st):et(ot)};typeof this.client.rlflxIncr=="function"?this.client.rlflxIncr(a,$,rt,it):this.client.eval(incrTtlLuaScript,1,a,$,rt,it)}else nt.incrby(a,$).pttl(a).exec((it,st)=>it?tt(it):et(st))})}_get(a){return new Promise(($,j)=>{if(!this._isRedisReady())return j(new Error("Redis connection is not ready"));this.client.multi().get(a).pttl(a).exec((_e,et)=>{if(_e)j(_e);else{const[tt]=et;if(tt===null)return $(null);$(et)}})})}_delete(a){return new Promise(($,j)=>{this.client.del(a,(_e,et)=>{_e?j(_e):$(et>0)})})}}var RateLimiterRedis_1=RateLimiterRedis$1;const RateLimiterStoreAbstract$3=RateLimiterStoreAbstract_1,RateLimiterRes$9=RateLimiterRes_1;function getDriverVersion(_){try{const a=_.client?_.client:_,{version:$}=a.topology.s.options.metadata.driver,j=$.split(".").map(_e=>parseInt(_e));return{major:j[0],feature:j[1],patch:j[2]}}catch{return{major:0,feature:0,patch:0}}}class RateLimiterMongo$1 extends RateLimiterStoreAbstract$3{constructor(a){super(a),this.dbName=a.dbName,this.tableName=a.tableName,this.indexKeyPrefix=a.indexKeyPrefix,a.mongo?this.client=a.mongo:this.client=a.storeClient,typeof this.client.then=="function"?this.client.then($=>{this.client=$,this._initCollection(),this._driverVersion=getDriverVersion(this.client)}):(this._initCollection(),this._driverVersion=getDriverVersion(this.client))}get dbName(){return this._dbName}set dbName(a){this._dbName=typeof a>"u"?RateLimiterMongo$1.getDbName():a}static getDbName(){return"node-rate-limiter-flexible"}get tableName(){return this._tableName}set tableName(a){this._tableName=typeof a>"u"?this.keyPrefix:a}get client(){return this._client}set client(a){if(typeof a>"u")throw new Error("mongo is not set");this._client=a}get indexKeyPrefix(){return this._indexKeyPrefix}set indexKeyPrefix(a){this._indexKeyPrefix=a||{}}_initCollection(){const $=(typeof this.client.db=="function"?this.client.db(this.dbName):this.client).collection(this.tableName);$.createIndex({expire:-1},{expireAfterSeconds:0}),$.createIndex(Object.assign({},this.indexKeyPrefix,{key:1}),{unique:!0}),this._collection=$}_getRateLimiterRes(a,$,j){const _e=new RateLimiterRes$9;let et;return typeof j.value>"u"?et=j:et=j.value,_e.isFirstInDuration=et.points===$,_e.consumedPoints=et.points,_e.remainingPoints=Math.max(this.points-_e.consumedPoints,0),_e.msBeforeNext=et.expire!==null?Math.max(new Date(et.expire).getTime()-Date.now(),0):-1,_e}_upsert(a,$,j,_e=!1,et={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const tt=et.attrs||{};let rt,nt;_e?(rt={key:a},rt=Object.assign(rt,tt),nt={$set:{key:a,points:$,expire:j>0?new Date(Date.now()+j):null}},nt.$set=Object.assign(nt.$set,tt)):(rt={$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}],key:a},rt=Object.assign(rt,tt),nt={$setOnInsert:{key:a,expire:j>0?new Date(Date.now()+j):null},$inc:{points:$}},nt.$setOnInsert=Object.assign(nt.$setOnInsert,tt));const it={upsert:!0};return this._driverVersion.major>=4||this._driverVersion.major===3&&this._driverVersion.feature>=7||this._driverVersion.feature>=6&&this._driverVersion.patch>=7?it.returnDocument="after":it.returnOriginal=!1,new Promise((st,ot)=>{this._collection.findOneAndUpdate(rt,nt,it).then(at=>{st(at)}).catch(at=>{if(at&&at.code===11e3){const lt=Object.assign({$or:[{expire:{$lte:new Date}},{expire:{$eq:null}}],key:a},tt),ct={$set:Object.assign({key:a,points:$,expire:j>0?new Date(Date.now()+j):null},tt)};this._collection.findOneAndUpdate(lt,ct,it).then(ut=>{st(ut)}).catch(ut=>{ut&&ut.code===11e3?this._upsert(a,$,j,_e).then(dt=>st(dt)).catch(dt=>ot(dt)):ot(ut)})}else ot(at)})})}_get(a,$={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const j=$.attrs||{},_e=Object.assign({key:a,$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}]},j);return this._collection.findOne(_e)}_delete(a,$={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const j=$.attrs||{},_e=Object.assign({key:a},j);return this._collection.deleteOne(_e).then(et=>et.deletedCount>0)}}var RateLimiterMongo_1=RateLimiterMongo$1;const RateLimiterStoreAbstract$2=RateLimiterStoreAbstract_1,RateLimiterRes$8=RateLimiterRes_1;class RateLimiterMySQL$1 extends RateLimiterStoreAbstract$2{constructor(a,$=null){super(a),this.client=a.storeClient,this.clientType=a.storeType,this.dbName=a.dbName,this.tableName=a.tableName,this.clearExpiredByTimeout=a.clearExpiredByTimeout,this.tableCreated=a.tableCreated,this.tableCreated?(this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),typeof $=="function"&&$()):this._createDbAndTable().then(()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),typeof $=="function"&&$()}).catch(j=>{if(typeof $=="function")$(j);else throw j})}clearExpired(a){return new Promise($=>{this._getConnection().then(j=>{j.query("DELETE FROM ??.?? WHERE expire < ?",[this.dbName,this.tableName,a],()=>{this._releaseConnection(j),$()})}).catch(()=>{$()})})}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout(()=>{this.clearExpired(Date.now()-36e5).then(()=>{this._clearExpiredHourAgo()})},3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return new Promise((a,$)=>{this.client.getConnection((j,_e)=>{if(j)return $(j);a(_e)})});case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();default:return Promise.resolve(this.client)}}_releaseConnection(a){switch(this.clientType){case"pool":return a.release();case"sequelize":return this.client.connectionManager.releaseConnection(a);case"knex":return this.client.client.releaseConnection(a);default:return!0}}_createDbAndTable(){return new Promise((a,$)=>{this._getConnection().then(j=>{j.query(`CREATE DATABASE IF NOT EXISTS \`${this.dbName}\`;`,_e=>{if(_e)return this._releaseConnection(j),$(_e);j.query(this._getCreateTableStmt(),et=>{if(et)return this._releaseConnection(j),$(et);this._releaseConnection(j),a()})})}).catch(j=>{$(j)})})}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS \`${this.dbName}\`.\`${this.tableName}\` (\`key\` VARCHAR(255) CHARACTER SET utf8 NOT NULL,\`points\` INT(9) NOT NULL default 0,\`expire\` BIGINT UNSIGNED,PRIMARY KEY (\`key\`)) ENGINE = INNODB;`}get clientType(){return this._clientType}set clientType(a){if(typeof a>"u")if(this.client.constructor.name==="Connection")a="connection";else if(this.client.constructor.name==="Pool")a="pool";else if(this.client.constructor.name==="Sequelize")a="sequelize";else throw new Error("storeType is not defined");this._clientType=a.toLowerCase()}get dbName(){return this._dbName}set dbName(a){this._dbName=typeof a>"u"?"rtlmtrflx":a}get tableName(){return this._tableName}set tableName(a){this._tableName=typeof a>"u"?this.keyPrefix:a}get tableCreated(){return this._tableCreated}set tableCreated(a){this._tableCreated=typeof a>"u"?!1:!!a}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(a){this._clearExpiredByTimeout=typeof a>"u"?!0:Boolean(a)}_getRateLimiterRes(a,$,j){const _e=new RateLimiterRes$8,[et]=j;return _e.isFirstInDuration=$===et.points,_e.consumedPoints=_e.isFirstInDuration?$:et.points,_e.remainingPoints=Math.max(this.points-_e.consumedPoints,0),_e.msBeforeNext=et.expire?Math.max(et.expire-Date.now(),0):-1,_e}_upsertTransaction(a,$,j,_e,et){return new Promise((tt,rt)=>{a.query("BEGIN",nt=>{if(nt)return a.rollback(),rt(nt);const it=Date.now(),st=_e>0?it+_e:null;let ot,at;et?(ot=`INSERT INTO ??.?? VALUES (?, ?, ?)
          ON DUPLICATE KEY UPDATE 
            points = ?, 
            expire = ?;`,at=[this.dbName,this.tableName,$,j,st,j,st]):(ot=`INSERT INTO ??.?? VALUES (?, ?, ?)
          ON DUPLICATE KEY UPDATE 
            points = IF(expire <= ?, ?, points + (?)), 
            expire = IF(expire <= ?, ?, expire);`,at=[this.dbName,this.tableName,$,j,st,it,j,j,it,st]),a.query(ot,at,lt=>{if(lt)return a.rollback(),rt(lt);a.query("SELECT points, expire FROM ??.?? WHERE `key` = ?;",[this.dbName,this.tableName,$],(ct,ut)=>{if(ct)return a.rollback(),rt(ct);a.query("COMMIT",dt=>{if(dt)return a.rollback(),rt(dt);tt(ut)})})})})})}_upsert(a,$,j,_e=!1){return this.tableCreated?new Promise((et,tt)=>{this._getConnection().then(rt=>{this._upsertTransaction(rt,a,$,j,_e).then(nt=>{et(nt),this._releaseConnection(rt)}).catch(nt=>{tt(nt),this._releaseConnection(rt)})}).catch(rt=>{tt(rt)})}):Promise.reject(Error("Table is not created yet"))}_get(a){return this.tableCreated?new Promise(($,j)=>{this._getConnection().then(_e=>{_e.query("SELECT points, expire FROM ??.?? WHERE `key` = ? AND (`expire` > ? OR `expire` IS NULL)",[this.dbName,this.tableName,a,Date.now()],(et,tt)=>{et?j(et):tt.length===0?$(null):$(tt),this._releaseConnection(_e)})}).catch(_e=>{j(_e)})}):Promise.reject(Error("Table is not created yet"))}_delete(a){return this.tableCreated?new Promise(($,j)=>{this._getConnection().then(_e=>{_e.query("DELETE FROM ??.?? WHERE `key` = ?",[this.dbName,this.tableName,a],(et,tt)=>{et?j(et):$(tt.affectedRows>0),this._releaseConnection(_e)})}).catch(_e=>{j(_e)})}):Promise.reject(Error("Table is not created yet"))}}var RateLimiterMySQL_1=RateLimiterMySQL$1;const RateLimiterStoreAbstract$1=RateLimiterStoreAbstract_1,RateLimiterRes$7=RateLimiterRes_1;class RateLimiterPostgres$1 extends RateLimiterStoreAbstract$1{constructor(a,$=null){super(a),this.client=a.storeClient,this.clientType=a.storeType,this.tableName=a.tableName,this.clearExpiredByTimeout=a.clearExpiredByTimeout,this.tableCreated=a.tableCreated,this.tableCreated?typeof $=="function"&&$():this._createTable().then(()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),typeof $=="function"&&$()}).catch(j=>{if(typeof $=="function")$(j);else throw j})}clearExpired(a){return new Promise($=>{const j={name:"rlflx-clear-expired",text:`DELETE FROM ${this.tableName} WHERE expire < $1`,values:[a]};this._query(j).then(()=>{$()}).catch(()=>{$()})})}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout(()=>{this.clearExpired(Date.now()-36e5).then(()=>{this._clearExpiredHourAgo()})},3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return Promise.resolve(this.client);case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();case"typeorm":return Promise.resolve(this.client.driver.master);default:return Promise.resolve(this.client)}}_releaseConnection(a){switch(this.clientType){case"pool":return!0;case"sequelize":return this.client.connectionManager.releaseConnection(a);case"knex":return this.client.client.releaseConnection(a);case"typeorm":return!0;default:return!0}}_createTable(){return new Promise((a,$)=>{this._query({text:this._getCreateTableStmt()}).then(()=>{a()}).catch(j=>{j.code==="23505"?a():$(j)})})}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS ${this.tableName} ( 
      key varchar(255) PRIMARY KEY,
      points integer NOT NULL DEFAULT 0,
      expire bigint
    );`}get clientType(){return this._clientType}set clientType(a){const $=this.client.constructor.name;if(typeof a>"u")if($==="Client")a="client";else if($==="Pool"||$==="BoundPool")a="pool";else if($==="Sequelize")a="sequelize";else throw new Error("storeType is not defined");this._clientType=a.toLowerCase()}get tableName(){return this._tableName}set tableName(a){this._tableName=typeof a>"u"?this.keyPrefix:a}get tableCreated(){return this._tableCreated}set tableCreated(a){this._tableCreated=typeof a>"u"?!1:!!a}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(a){this._clearExpiredByTimeout=typeof a>"u"?!0:Boolean(a)}_getRateLimiterRes(a,$,j){const _e=new RateLimiterRes$7,et=j.rows[0];return _e.isFirstInDuration=$===et.points,_e.consumedPoints=_e.isFirstInDuration?$:et.points,_e.remainingPoints=Math.max(this.points-_e.consumedPoints,0),_e.msBeforeNext=et.expire?Math.max(et.expire-Date.now(),0):-1,_e}_query(a){const j={name:`${this.tableName.toLowerCase()}:${a.name}`,text:a.text,values:a.values};return new Promise((_e,et)=>{this._getConnection().then(tt=>{tt.query(j).then(rt=>{_e(rt),this._releaseConnection(tt)}).catch(rt=>{et(rt),this._releaseConnection(tt)})}).catch(tt=>{et(tt)})})}_upsert(a,$,j,_e=!1){if(!this.tableCreated)return Promise.reject(Error("Table is not created yet"));const et=j>0?Date.now()+j:null,tt=_e?" $3 ":` CASE
             WHEN ${this.tableName}.expire <= $4 THEN $3
             ELSE ${this.tableName}.expire
            END `;return this._query({name:_e?"rlflx-upsert-force":"rlflx-upsert",text:`
            INSERT INTO ${this.tableName} VALUES ($1, $2, $3)
              ON CONFLICT(key) DO UPDATE SET
                points = CASE
                          WHEN (${this.tableName}.expire <= $4 OR 1=${_e?1:0}) THEN $2
                          ELSE ${this.tableName}.points + ($2)
                         END,
                expire = ${tt}
            RETURNING points, expire;`,values:[a,$,et,Date.now()]})}_get(a){return this.tableCreated?new Promise(($,j)=>{this._query({name:"rlflx-get",text:`
            SELECT points, expire FROM ${this.tableName} WHERE key = $1 AND (expire > $2 OR expire IS NULL);`,values:[a,Date.now()]}).then(_e=>{_e.rowCount===0&&(_e=null),$(_e)}).catch(_e=>{j(_e)})}):Promise.reject(Error("Table is not created yet"))}_delete(a){return this.tableCreated?this._query({name:"rlflx-delete",text:`DELETE FROM ${this.tableName} WHERE key = $1`,values:[a]}).then($=>$.rowCount>0):Promise.reject(Error("Table is not created yet"))}}var RateLimiterPostgres_1=RateLimiterPostgres$1,Record_1=class{constructor(a,$,j=null){this.value=a,this.expiresAt=$,this.timeoutId=j}get value(){return this._value}set value(a){this._value=parseInt(a)}get expiresAt(){return this._expiresAt}set expiresAt(a){!(a instanceof Date)&&Number.isInteger(a)&&(a=new Date(a)),this._expiresAt=a}get timeoutId(){return this._timeoutId}set timeoutId(a){this._timeoutId=a}};const Record$1=Record_1,RateLimiterRes$6=RateLimiterRes_1;var MemoryStorage_1=class{constructor(){this._storage={}}incrby(a,$,j){if(this._storage[a]){const _e=this._storage[a].expiresAt?this._storage[a].expiresAt.getTime()-new Date().getTime():-1;return _e!==0?(this._storage[a].value=this._storage[a].value+$,new RateLimiterRes$6(0,_e,this._storage[a].value,!1)):this.set(a,$,j)}return this.set(a,$,j)}set(a,$,j){const _e=j*1e3;return this._storage[a]&&this._storage[a].timeoutId&&clearTimeout(this._storage[a].timeoutId),this._storage[a]=new Record$1($,_e>0?new Date(Date.now()+_e):null),_e>0&&(this._storage[a].timeoutId=setTimeout(()=>{delete this._storage[a]},_e),this._storage[a].timeoutId.unref&&this._storage[a].timeoutId.unref()),new RateLimiterRes$6(0,_e===0?-1:_e,this._storage[a].value,!0)}get(a){if(this._storage[a]){const $=this._storage[a].expiresAt?this._storage[a].expiresAt.getTime()-new Date().getTime():-1;return new RateLimiterRes$6(0,$,this._storage[a].value,!1)}return null}delete(a){return this._storage[a]?(this._storage[a].timeoutId&&clearTimeout(this._storage[a].timeoutId),delete this._storage[a],!0):!1}};const RateLimiterAbstract$2=RateLimiterAbstract_1,MemoryStorage=MemoryStorage_1,RateLimiterRes$5=RateLimiterRes_1;class RateLimiterMemory$2 extends RateLimiterAbstract$2{constructor(a={}){super(a),this._memoryStorage=new MemoryStorage}consume(a,$=1,j={}){return new Promise((_e,et)=>{const tt=this.getKey(a),rt=this._getKeySecDuration(j);let nt=this._memoryStorage.incrby(tt,$,rt);if(nt.remainingPoints=Math.max(this.points-nt.consumedPoints,0),nt.consumedPoints>this.points)this.blockDuration>0&&nt.consumedPoints<=this.points+$&&(nt=this._memoryStorage.set(tt,nt.consumedPoints,this.blockDuration)),et(nt);else if(this.execEvenly&&nt.msBeforeNext>0&&!nt.isFirstInDuration){let it=Math.ceil(nt.msBeforeNext/(nt.remainingPoints+2));it<this.execEvenlyMinDelayMs&&(it=nt.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(_e,it,nt)}else _e(nt)})}penalty(a,$=1,j={}){const _e=this.getKey(a);return new Promise(et=>{const tt=this._getKeySecDuration(j),rt=this._memoryStorage.incrby(_e,$,tt);rt.remainingPoints=Math.max(this.points-rt.consumedPoints,0),et(rt)})}reward(a,$=1,j={}){const _e=this.getKey(a);return new Promise(et=>{const tt=this._getKeySecDuration(j),rt=this._memoryStorage.incrby(_e,-$,tt);rt.remainingPoints=Math.max(this.points-rt.consumedPoints,0),et(rt)})}block(a,$){const j=$*1e3,_e=this.points+1;return this._memoryStorage.set(this.getKey(a),_e,$),Promise.resolve(new RateLimiterRes$5(0,j===0?-1:j,_e))}set(a,$,j){const _e=(j>=0?j:this.duration)*1e3;return this._memoryStorage.set(this.getKey(a),$,j),Promise.resolve(new RateLimiterRes$5(0,_e===0?-1:_e,$))}get(a){const $=this._memoryStorage.get(this.getKey(a));return $!==null&&($.remainingPoints=Math.max(this.points-$.consumedPoints,0)),Promise.resolve($)}delete(a){return Promise.resolve(this._memoryStorage.delete(this.getKey(a)))}}var RateLimiterMemory_1=RateLimiterMemory$2;const cluster=require$$1,crypto$2=require$$1,RateLimiterAbstract$1=RateLimiterAbstract_1,RateLimiterMemory$1=RateLimiterMemory_1,RateLimiterRes$4=RateLimiterRes_1,channel="rate_limiter_flexible";let masterInstance=null;const masterSendToWorker=function(_,a,$,j){let _e;j===null||j===!0||j===!1?_e=j:_e={remainingPoints:j.remainingPoints,msBeforeNext:j.msBeforeNext,consumedPoints:j.consumedPoints,isFirstInDuration:j.isFirstInDuration},_.send({channel,keyPrefix:a.keyPrefix,promiseId:a.promiseId,type:$,data:_e})},workerWaitInit=function(_){setTimeout(()=>{this._initiated?process.send(_):typeof this._promises[_.promiseId]<"u"&&workerWaitInit.call(this,_)},30)},workerSendToMaster=function(_,a,$,j,_e){const et={channel,keyPrefix:this.keyPrefix,func:_,promiseId:a,data:{key:$,arg:j,opts:_e}};this._initiated?process.send(et):workerWaitInit.call(this,et)},masterProcessMsg=function(_,a){if(!a||a.channel!==channel||typeof this._rateLimiters[a.keyPrefix]>"u")return!1;let $;switch(a.func){case"consume":$=this._rateLimiters[a.keyPrefix].consume(a.data.key,a.data.arg,a.data.opts);break;case"penalty":$=this._rateLimiters[a.keyPrefix].penalty(a.data.key,a.data.arg,a.data.opts);break;case"reward":$=this._rateLimiters[a.keyPrefix].reward(a.data.key,a.data.arg,a.data.opts);break;case"block":$=this._rateLimiters[a.keyPrefix].block(a.data.key,a.data.arg,a.data.opts);break;case"get":$=this._rateLimiters[a.keyPrefix].get(a.data.key,a.data.opts);break;case"delete":$=this._rateLimiters[a.keyPrefix].delete(a.data.key,a.data.opts);break;default:return!1}$&&$.then(j=>{masterSendToWorker(_,a,"resolve",j)}).catch(j=>{masterSendToWorker(_,a,"reject",j)})},workerProcessMsg=function(_){if(!_||_.channel!==channel||_.keyPrefix!==this.keyPrefix)return!1;if(this._promises[_.promiseId]){clearTimeout(this._promises[_.promiseId].timeoutId);let a;switch(_.data===null||_.data===!0||_.data===!1?a=_.data:a=new RateLimiterRes$4(_.data.remainingPoints,_.data.msBeforeNext,_.data.consumedPoints,_.data.isFirstInDuration),_.type){case"resolve":this._promises[_.promiseId].resolve(a);break;case"reject":this._promises[_.promiseId].reject(a);break;default:throw new Error(`RateLimiterCluster: no such message type '${_.type}'`)}delete this._promises[_.promiseId]}},getOpts=function(){return{points:this.points,duration:this.duration,blockDuration:this.blockDuration,execEvenly:this.execEvenly,execEvenlyMinDelayMs:this.execEvenlyMinDelayMs,keyPrefix:this.keyPrefix}},savePromise=function(_,a){const $=process.hrtime();let j=$[0].toString()+$[1].toString();return typeof this._promises[j]<"u"&&(j+=crypto$2.randomBytes(12).toString("base64")),this._promises[j]={resolve:_,reject:a,timeoutId:setTimeout(()=>{delete this._promises[j],a(new Error("RateLimiterCluster timeout: no answer from master in time"))},this.timeoutMs)},j};class RateLimiterClusterMaster$1{constructor(){if(masterInstance)return masterInstance;this._rateLimiters={},cluster.setMaxListeners(0),cluster.on("message",(a,$)=>{$&&$.channel===channel&&$.type==="init"?(typeof this._rateLimiters[$.opts.keyPrefix]>"u"&&(this._rateLimiters[$.opts.keyPrefix]=new RateLimiterMemory$1($.opts)),a.send({channel,type:"init",keyPrefix:$.opts.keyPrefix})):masterProcessMsg.call(this,a,$)}),masterInstance=this}}class RateLimiterClusterMasterPM2$1{constructor(a){if(masterInstance)return masterInstance;this._rateLimiters={},a.launchBus(($,j)=>{j.on("process:msg",_e=>{const et=_e.raw;if(et&&et.channel===channel&&et.type==="init")typeof this._rateLimiters[et.opts.keyPrefix]>"u"&&(this._rateLimiters[et.opts.keyPrefix]=new RateLimiterMemory$1(et.opts)),a.sendDataToProcessId(_e.process.pm_id,{data:{},topic:channel,channel,type:"init",keyPrefix:et.opts.keyPrefix},(tt,rt)=>{tt&&console.log(tt,rt)});else{const tt={send:rt=>{const nt=rt;nt.topic=channel,typeof nt.data>"u"&&(nt.data={}),a.sendDataToProcessId(_e.process.pm_id,nt,(it,st)=>{it&&console.log(it,st)})}};masterProcessMsg.call(this,tt,et)}})}),masterInstance=this}}class RateLimiterClusterWorker extends RateLimiterAbstract$1{get timeoutMs(){return this._timeoutMs}set timeoutMs(a){this._timeoutMs=typeof a>"u"?5e3:Math.abs(parseInt(a))}constructor(a={}){super(a),process.setMaxListeners(0),this.timeoutMs=a.timeoutMs,this._initiated=!1,process.on("message",$=>{$&&$.channel===channel&&$.type==="init"&&$.keyPrefix===this.keyPrefix?this._initiated=!0:workerProcessMsg.call(this,$)}),process.send({channel,type:"init",opts:getOpts.call(this)}),this._promises={}}consume(a,$=1,j={}){return new Promise((_e,et)=>{const tt=savePromise.call(this,_e,et);workerSendToMaster.call(this,"consume",tt,a,$,j)})}penalty(a,$=1,j={}){return new Promise((_e,et)=>{const tt=savePromise.call(this,_e,et);workerSendToMaster.call(this,"penalty",tt,a,$,j)})}reward(a,$=1,j={}){return new Promise((_e,et)=>{const tt=savePromise.call(this,_e,et);workerSendToMaster.call(this,"reward",tt,a,$,j)})}block(a,$,j={}){return new Promise((_e,et)=>{const tt=savePromise.call(this,_e,et);workerSendToMaster.call(this,"block",tt,a,$,j)})}get(a,$={}){return new Promise((j,_e)=>{const et=savePromise.call(this,j,_e);workerSendToMaster.call(this,"get",et,a,$)})}delete(a,$={}){return new Promise((j,_e)=>{const et=savePromise.call(this,j,_e);workerSendToMaster.call(this,"delete",et,a,$)})}}var RateLimiterCluster$1={RateLimiterClusterMaster:RateLimiterClusterMaster$1,RateLimiterClusterMasterPM2:RateLimiterClusterMasterPM2$1,RateLimiterCluster:RateLimiterClusterWorker};const RateLimiterStoreAbstract=RateLimiterStoreAbstract_1,RateLimiterRes$3=RateLimiterRes_1;class RateLimiterMemcache$1 extends RateLimiterStoreAbstract{constructor(a){super(a),this.client=a.storeClient}_getRateLimiterRes(a,$,j){const _e=new RateLimiterRes$3;return _e.consumedPoints=parseInt(j.consumedPoints),_e.isFirstInDuration=j.consumedPoints===$,_e.remainingPoints=Math.max(this.points-_e.consumedPoints,0),_e.msBeforeNext=j.msBeforeNext,_e}_upsert(a,$,j,_e=!1,et={}){return new Promise((tt,rt)=>{const nt=Date.now(),it=Math.floor(j/1e3);_e?this.client.set(a,$,it,st=>{st?rt(st):this.client.set(`${a}_expire`,it>0?nt+it*1e3:-1,it,()=>{const ot={consumedPoints:$,msBeforeNext:it>0?it*1e3:-1};tt(ot)})}):this.client.incr(a,$,(st,ot)=>{st||ot===!1?this.client.add(a,$,it,(at,lt)=>{if(at||!lt)if(typeof et.attemptNumber>"u"||et.attemptNumber<3){const ct=Object.assign({},et);ct.attemptNumber=ct.attemptNumber?ct.attemptNumber+1:1,this._upsert(a,$,j,_e,ct).then(ut=>tt(ut)).catch(ut=>rt(ut))}else rt(new Error("Can not add key"));else this.client.add(`${a}_expire`,it>0?nt+it*1e3:-1,it,()=>{const ct={consumedPoints:$,msBeforeNext:it>0?it*1e3:-1};tt(ct)})}):this.client.get(`${a}_expire`,(at,lt)=>{if(at)rt(at);else{const ct=lt===!1?0:lt,ut={consumedPoints:ot,msBeforeNext:ct>=0?Math.max(ct-nt,0):-1};tt(ut)}})})})}_get(a){return new Promise(($,j)=>{const _e=Date.now();this.client.get(a,(et,tt)=>{tt?this.client.get(`${a}_expire`,(rt,nt)=>{if(rt)j(rt);else{const it=nt===!1?0:nt,st={consumedPoints:tt,msBeforeNext:it>=0?Math.max(it-_e,0):-1};$(st)}}):$(null)})})}_delete(a){return new Promise(($,j)=>{this.client.del(a,(_e,et)=>{_e?j(_e):et===!1?$(et):this.client.del(`${a}_expire`,tt=>{tt?j(tt):$(et)})})})}}var RateLimiterMemcache_1=RateLimiterMemcache$1;const RateLimiterRes$2=RateLimiterRes_1;var RLWrapperBlackAndWhite_1=class{constructor(a={}){this.limiter=a.limiter,this.blackList=a.blackList,this.whiteList=a.whiteList,this.isBlackListed=a.isBlackListed,this.isWhiteListed=a.isWhiteListed,this.runActionAnyway=a.runActionAnyway}get limiter(){return this._limiter}set limiter(a){if(typeof a>"u")throw new Error("limiter is not set");this._limiter=a}get runActionAnyway(){return this._runActionAnyway}set runActionAnyway(a){this._runActionAnyway=typeof a>"u"?!1:a}get blackList(){return this._blackList}set blackList(a){this._blackList=Array.isArray(a)?a:[]}get isBlackListed(){return this._isBlackListed}set isBlackListed(a){if(typeof a>"u"&&(a=()=>!1),typeof a!="function")throw new Error("isBlackListed must be function");this._isBlackListed=a}get whiteList(){return this._whiteList}set whiteList(a){this._whiteList=Array.isArray(a)?a:[]}get isWhiteListed(){return this._isWhiteListed}set isWhiteListed(a){if(typeof a>"u"&&(a=()=>!1),typeof a!="function")throw new Error("isWhiteListed must be function");this._isWhiteListed=a}isBlackListedSomewhere(a){return this.blackList.indexOf(a)>=0||this.isBlackListed(a)}isWhiteListedSomewhere(a){return this.whiteList.indexOf(a)>=0||this.isWhiteListed(a)}getBlackRes(){return new RateLimiterRes$2(0,Number.MAX_SAFE_INTEGER,0,!1)}getWhiteRes(){return new RateLimiterRes$2(Number.MAX_SAFE_INTEGER,0,0,!1)}rejectBlack(){return Promise.reject(this.getBlackRes())}resolveBlack(){return Promise.resolve(this.getBlackRes())}resolveWhite(){return Promise.resolve(this.getWhiteRes())}consume(a,$=1){let j;return this.isWhiteListedSomewhere(a)?j=this.resolveWhite():this.isBlackListedSomewhere(a)&&(j=this.rejectBlack()),typeof j>"u"?this.limiter.consume(a,$):(this.runActionAnyway&&this.limiter.consume(a,$).catch(()=>{}),j)}block(a,$){let j;return this.isWhiteListedSomewhere(a)?j=this.resolveWhite():this.isBlackListedSomewhere(a)&&(j=this.resolveBlack()),typeof j>"u"?this.limiter.block(a,$):(this.runActionAnyway&&this.limiter.block(a,$).catch(()=>{}),j)}penalty(a,$){let j;return this.isWhiteListedSomewhere(a)?j=this.resolveWhite():this.isBlackListedSomewhere(a)&&(j=this.resolveBlack()),typeof j>"u"?this.limiter.penalty(a,$):(this.runActionAnyway&&this.limiter.penalty(a,$).catch(()=>{}),j)}reward(a,$){let j;return this.isWhiteListedSomewhere(a)?j=this.resolveWhite():this.isBlackListedSomewhere(a)&&(j=this.resolveBlack()),typeof j>"u"?this.limiter.reward(a,$):(this.runActionAnyway&&this.limiter.reward(a,$).catch(()=>{}),j)}get(a){let $;return this.isWhiteListedSomewhere(a)?$=this.resolveWhite():this.isBlackListedSomewhere(a)&&($=this.resolveBlack()),typeof $>"u"||this.runActionAnyway?this.limiter.get(a):$}delete(a){return this.limiter.delete(a)}};const RateLimiterAbstract=RateLimiterAbstract_1;var RateLimiterUnion_1=class{constructor(...a){if(a.length<1)throw new Error("RateLimiterUnion: at least one limiter have to be passed");a.forEach($=>{if(!($ instanceof RateLimiterAbstract))throw new Error("RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract")}),this._limiters=a}consume(a,$=1){return new Promise((j,_e)=>{const et=[];this._limiters.forEach(tt=>{et.push(tt.consume(a,$).catch(rt=>({rejected:!0,rej:rt})))}),Promise.all(et).then(tt=>{const rt={};let nt=!1;tt.forEach(it=>{it.rejected===!0&&(nt=!0)});for(let it=0;it<tt.length;it++)nt&&tt[it].rejected===!0?rt[this._limiters[it].keyPrefix]=tt[it].rej:nt||(rt[this._limiters[it].keyPrefix]=tt[it]);nt?_e(rt):j(rt)})})}},RateLimiterQueueError_1=class extends Error{constructor(a,$){super(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="CustomError",this.message=a,$&&(this.extra=$)}};const RateLimiterQueueError=RateLimiterQueueError_1,MAX_QUEUE_SIZE=4294967295,KEY_DEFAULT="limiter";var RateLimiterQueue_1=class{constructor(a,$={maxQueueSize:MAX_QUEUE_SIZE}){this._queueLimiters={KEY_DEFAULT:new RateLimiterQueueInternal(a,$)},this._limiterFlexible=a,this._maxQueueSize=$.maxQueueSize}getTokensRemaining(a=KEY_DEFAULT){return this._queueLimiters[a]?this._queueLimiters[a].getTokensRemaining():Promise.resolve(this._limiterFlexible.points)}removeTokens(a,$=KEY_DEFAULT){return this._queueLimiters[$]||(this._queueLimiters[$]=new RateLimiterQueueInternal(this._limiterFlexible,{key:$,maxQueueSize:this._maxQueueSize})),this._queueLimiters[$].removeTokens(a)}};class RateLimiterQueueInternal{constructor(a,$={maxQueueSize:MAX_QUEUE_SIZE,key:KEY_DEFAULT}){this._key=$.key,this._waitTimeout=null,this._queue=[],this._limiterFlexible=a,this._maxQueueSize=$.maxQueueSize}getTokensRemaining(){return this._limiterFlexible.get(this._key).then(a=>a!==null?a.remainingPoints:this._limiterFlexible.points)}removeTokens(a){const $=this;return new Promise((j,_e)=>{if(a>$._limiterFlexible.points){_e(new RateLimiterQueueError(`Requested tokens ${a} exceeds maximum ${$._limiterFlexible.points} tokens per interval`));return}$._queue.length>0?$._queueRequest.call($,j,_e,a):$._limiterFlexible.consume($._key,a).then(et=>{j(et.remainingPoints)}).catch(et=>{et instanceof Error?_e(et):($._queueRequest.call($,j,_e,a),$._waitTimeout===null&&($._waitTimeout=setTimeout($._processFIFO.bind($),et.msBeforeNext)))})})}_queueRequest(a,$,j){const _e=this;_e._queue.length<_e._maxQueueSize?_e._queue.push({resolve:a,reject:$,tokens:j}):$(new RateLimiterQueueError(`Number of requests reached it's maximum ${_e._maxQueueSize}`))}_processFIFO(){const a=this;if(a._waitTimeout!==null&&(clearTimeout(a._waitTimeout),a._waitTimeout=null),a._queue.length===0)return;const $=a._queue.shift();a._limiterFlexible.consume(a._key,$.tokens).then(j=>{$.resolve(j.remainingPoints),a._processFIFO.call(a)}).catch(j=>{j instanceof Error?($.reject(j),a._processFIFO.call(a)):(a._queue.unshift($),a._waitTimeout===null&&(a._waitTimeout=setTimeout(a._processFIFO.bind(a),j.msBeforeNext)))})}}const RateLimiterRes$1=RateLimiterRes_1;var BurstyRateLimiter_1=class{constructor(a,$){this._rateLimiter=a,this._burstLimiter=$}_combineRes(a,$){return new RateLimiterRes$1(a.remainingPoints,Math.min(a.msBeforeNext,$.msBeforeNext),a.consumedPoints,a.isFirstInDuration)}consume(a,$=1,j={}){return this._rateLimiter.consume(a,$,j).catch(_e=>_e instanceof RateLimiterRes$1?this._burstLimiter.consume(a,$,j).then(et=>Promise.resolve(this._combineRes(_e,et))).catch(et=>et instanceof RateLimiterRes$1?Promise.reject(this._combineRes(_e,et)):Promise.reject(et)):Promise.reject(_e))}get(a){return Promise.all([this._rateLimiter.get(a),this._burstLimiter.get(a)]).then(([$,j])=>this._combineRes($,j))}get points(){return this._rateLimiter.points}};const RateLimiterRedis=RateLimiterRedis_1,RateLimiterMongo=RateLimiterMongo_1,RateLimiterMySQL=RateLimiterMySQL_1,RateLimiterPostgres=RateLimiterPostgres_1,{RateLimiterClusterMaster,RateLimiterClusterMasterPM2,RateLimiterCluster}=RateLimiterCluster$1,RateLimiterMemory=RateLimiterMemory_1,RateLimiterMemcache=RateLimiterMemcache_1,RLWrapperBlackAndWhite=RLWrapperBlackAndWhite_1,RateLimiterUnion=RateLimiterUnion_1,RateLimiterQueue=RateLimiterQueue_1,BurstyRateLimiter=BurstyRateLimiter_1,RateLimiterRes=RateLimiterRes_1;var rateLimiterFlexible={RateLimiterRedis,RateLimiterMongo,RateLimiterMySQL,RateLimiterPostgres,RateLimiterMemory,RateLimiterMemcache,RateLimiterClusterMaster,RateLimiterClusterMasterPM2,RateLimiterCluster,RLWrapperBlackAndWhite,RateLimiterUnion,RateLimiterQueue,BurstyRateLimiter,RateLimiterRes};const log$K=logger$1("libp2p:connection-manager"),defaultOptions$4={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,inboundConnectionThreshold:5,maxIncomingPendingConnections:10},METRICS_SYSTEM="libp2p",METRICS_COMPONENT$1="connection-manager",STARTUP_RECONNECT_TIMEOUT=6e4;class DefaultConnectionManager extends EventEmitter$1{constructor(a,$){if(super(),this.opts=mergeOptions$g.call({ignoreUndefined:!0},defaultOptions$4,$),this.opts.maxConnections<this.opts.minConnections)throw errCode(new Error("Connection Manager maxConnections must be greater than minConnections"),codes$1.ERR_INVALID_PARAMETERS);log$K("options: %o",this.opts),this.components=a,this.connections=new Map,this.started=!1,this._checkMetrics=this._checkMetrics.bind(this),this.latencyMonitor=new LatencyMonitor({latencyCheckIntervalMs:$.pollInterval,dataEmitIntervalMs:$.pollInterval});try{events.exports.setMaxListeners?.(1/0,this)}catch{}this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.startupReconnectTimeout=$.startupReconnectTimeout??STARTUP_RECONNECT_TIMEOUT,this.dialTimeout=$.dialTimeout??3e4,this.allow=($.allow??[]).map(j=>multiaddr(j)),this.deny=($.deny??[]).map(j=>multiaddr(j)),this.inboundConnectionRateLimiter=new rateLimiterFlexible.RateLimiterMemory({points:this.opts.inboundConnectionThreshold,duration:1}),this.incomingPendingConnections=0}isStarted(){return this.started}async start(){this.components.metrics!=null&&(this.timer=this.timer??retimer_1(this._checkMetrics,this.opts.pollInterval)),this.components.metrics?.updateComponentMetric({system:METRICS_SYSTEM,component:METRICS_COMPONENT$1,metric:"connections",label:"direction",value:()=>{const a={inbound:0,outbound:0};for(const $ of this.connections.values())for(const j of $)j.stat.direction==="inbound"?a.inbound++:a.outbound++;return a}}),this.components.metrics?.updateComponentMetric({system:METRICS_SYSTEM,component:METRICS_COMPONENT$1,metric:"protocol-streams-total",label:"protocol",value:()=>{const a={};for(const $ of this.connections.values())for(const j of $)for(const _e of j.streams){const et=`${_e.stat.direction} ${_e.stat.protocol??"unnegotiated"}`;a[et]=(a[et]??0)+1}return a}}),this.components.metrics?.updateComponentMetric({system:METRICS_SYSTEM,component:METRICS_COMPONENT$1,metric:"protocol-streams-per-connection-90th-percentile",label:"protocol",value:()=>{const a={};for(const j of this.connections.values())for(const _e of j){const et={};for(const tt of _e.streams){const rt=`${tt.stat.direction} ${tt.stat.protocol??"unnegotiated"}`;et[rt]=(et[rt]??0)+1}for(const[tt,rt]of Object.entries(et))a[tt]=a[tt]??[],a[tt].push(rt)}const $={};for(let[j,_e]of Object.entries(a)){_e=_e.sort((tt,rt)=>tt-rt);const et=Math.floor(_e.length*.9);$[j]=_e[et]}return $}}),this.latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this.latencyMonitor.addEventListener("data",this._onLatencyMeasure),this.started=!0,log$K("started")}async afterStart(){this.components.upgrader.addEventListener("connection",this.onConnect),this.components.upgrader.addEventListener("connectionEnd",this.onDisconnect),Promise.resolve().then(async()=>{const a=[];for(const $ of await this.components.peerStore.all())(await this.components.peerStore.getTags($.id)).filter(et=>et.name===KEEP_ALIVE).length>0&&a.push($.id);this.connectOnStartupController?.clear(),this.connectOnStartupController=new timeoutAbortController.TimeoutController(this.startupReconnectTimeout);try{events.exports.setMaxListeners?.(1/0,this.connectOnStartupController.signal)}catch{}await Promise.all(a.map(async $=>{await this.openConnection($,{signal:this.connectOnStartupController?.signal}).catch(j=>{log$K.error(j)})}))}).catch(a=>{log$K.error(a)}).finally(()=>{this.connectOnStartupController?.clear()})}async beforeStop(){this.connectOnStartupController?.abort(),this.components.upgrader.removeEventListener("connection",this.onConnect),this.components.upgrader.removeEventListener("connectionEnd",this.onDisconnect)}async stop(){this.timer?.clear(),this.latencyMonitor.removeEventListener("data",this._onLatencyMeasure),this.latencyMonitor.stop(),this.started=!1,await this._close(),log$K("stopped")}async _close(){const a=[];for(const $ of this.connections.values())for(const j of $)a.push((async()=>{try{await j.close()}catch(_e){log$K.error(_e)}})());log$K("closing %d connections",a.length),await Promise.all(a),this.connections.clear()}async _checkMetrics(){const a=this.components.metrics;if(a!=null)try{const $=a.getGlobal().getMovingAverages(),j=$.dataReceived[this.opts.movingAverageInterval].movingAverage;await this._checkMaxLimit("maxReceivedData",j);const _e=$.dataSent[this.opts.movingAverageInterval].movingAverage;await this._checkMaxLimit("maxSentData",_e);const et=j+_e;await this._checkMaxLimit("maxData",et),log$K.trace("metrics update",et)}finally{this.timer=retimer_1(this._checkMetrics,this.opts.pollInterval)}}onConnect(a){this._onConnect(a).catch($=>{log$K.error($)})}async _onConnect(a){const{detail:$}=a;if(!this.started){await $.close();return}const j=$.remotePeer,_e=j.toString(),et=this.connections.get(_e);et!=null?et.push($):this.connections.set(_e,[$]),j.publicKey!=null&&await this.components.peerStore.keyBook.set(j,j.publicKey);const tt=this.getConnections().length,rt=tt-this.opts.maxConnections;await this._checkMaxLimit("maxConnections",tt,rt),this.dispatchEvent(new CustomEvent$1("peer:connect",{detail:$}))}onDisconnect(a){const{detail:$}=a;if(!this.started)return;const j=$.remotePeer.toString();let _e=this.connections.get(j);_e!=null&&_e.length>1?(_e=_e.filter(et=>et.id!==$.id),this.connections.set(j,_e)):_e!=null&&(this.connections.delete(j),this.dispatchEvent(new CustomEvent$1("peer:disconnect",{detail:$})),this.components.metrics?.onPeerDisconnected($.remotePeer))}getConnections(a){if(a!=null)return this.connections.get(a.toString())??[];let $=[];for(const j of this.connections.values())$=$.concat(j);return $}async openConnection(a,$={}){log$K("dial to %p",a);const j=this.getConnections(a);if(j.length>0)return log$K("had an existing connection to %p",a),j[0];let _e;if($?.signal==null){_e=new timeoutAbortController.TimeoutController(this.dialTimeout),$.signal=_e.signal;try{events.exports.setMaxListeners?.(1/0,_e.signal)}catch{}}try{const et=await this.components.dialer.dial(a,$);let tt=this.connections.get(a.toString());tt==null&&(tt=[],this.connections.set(a.toString(),tt));let rt=!1;for(const nt of tt)nt.id===et.id&&(rt=!0);return rt||tt.push(et),et}finally{_e?.clear()}}async closeConnections(a){const $=this.connections.get(a.toString())??[];await Promise.all($.map(async j=>await j.close()))}getAll(a){if(!isPeerId(a))throw errCode(new Error("peerId must be an instance of peer-id"),codes$1.ERR_INVALID_PARAMETERS);const $=a.toString(),j=this.connections.get($);return j!=null?j.filter(_e=>_e.stat.status===OPEN):[]}_onLatencyMeasure(a){const{detail:$}=a;this._checkMaxLimit("maxEventLoopDelay",$.avgMs,1).catch(j=>{log$K.error(j)})}async _checkMaxLimit(a,$,j=1){const _e=this.opts[a];log$K.trace("checking limit of %s. current value: %d of %d",a,$,_e),$>_e&&(log$K("%s: limit exceeded: %p, %d/%d, pruning %d connection(s)",this.components.peerId,a,$,_e,j),await this._pruneConnections(j))}async _pruneConnections(a){const $=this.getConnections(),j=new PeerMap;for(const tt of $){const rt=tt.remotePeer;if(j.has(rt))continue;const nt=await this.components.peerStore.getTags(rt);j.set(rt,nt.reduce((it,st)=>it+st.value,0))}const _e=$.sort((tt,rt)=>{const nt=j.get(tt.remotePeer)??0,it=j.get(rt.remotePeer)??0;return nt>it?1:nt<it?-1:0}),et=[];for(const tt of _e)if(log$K("too many connections open - closing a connection to %p",tt.remotePeer),et.push(tt),et.length===a)break;await Promise.all(et.map(async tt=>{try{await tt.close()}catch(rt){log$K.error(rt)}this.onDisconnect(new CustomEvent$1("connectionEnd",{detail:tt}))}))}async acceptIncomingConnection(a){if(this.deny.some(_e=>a.remoteAddr.toString().startsWith(_e.toString())))return log$K("connection from %s refused - connection remote address was in deny list",a.remoteAddr),!1;if(this.allow.some(_e=>a.remoteAddr.toString().startsWith(_e.toString())))return this.incomingPendingConnections++,!0;if(this.incomingPendingConnections===this.opts.maxIncomingPendingConnections)return log$K("connection from %s refused - incomingPendingConnections exceeded by peer %s",a.remoteAddr),!1;if(a.remoteAddr.isThinWaistAddress()){const _e=a.remoteAddr.nodeAddress().address;try{await this.inboundConnectionRateLimiter.consume(_e,1)}catch{return log$K("connection from %s refused - inboundConnectionThreshold exceeded by host %s",_e,a.remoteAddr),!1}}return this.getConnections().length<this.opts.maxConnections?(this.incomingPendingConnections++,!0):(log$K("connection from %s refused - maxConnections exceeded",a.remoteAddr),!1)}afterUpgradeInbound(){this.incomingPendingConnections--}}async function*sort(_,a){yield*(await all$5(_)).sort(a)}const log$J=logger$1("libp2p:connection-manager:auto-dialler"),defaultOptions$3={enabled:!0,minConnections:0,autoDialInterval:1e4};class AutoDialler{constructor(a,$){this.components=a,this.options=mergeOptions$g.call({ignoreUndefined:!0},defaultOptions$3,$),this.running=!1,this._autoDial=this._autoDial.bind(this),log$J("options: %j",this.options)}isStarted(){return this.running}async start(){if(!this.options.enabled){log$J("not enabled");return}this.running=!0,this._autoDial().catch(a=>{log$J.error("could start autodial",a)}),log$J("started")}async stop(){if(!this.options.enabled){log$J("not enabled");return}this.running=!1,this.autoDialTimeout!=null&&this.autoDialTimeout.clear(),log$J("stopped")}async _autoDial(){this.autoDialTimeout!=null&&this.autoDialTimeout.clear();const a=this.options.minConnections;if(this.components.connectionManager.getConnections().length>=a){this.autoDialTimeout=retimer_1(this._autoDial,this.options.autoDialInterval);return}const $=await this.components.peerStore.all(),j=await pipe($.sort(()=>Math.random()>.5?1:-1),_e=>filter(_e,et=>!et.id.equals(this.components.peerId)),_e=>sort(_e,(et,tt)=>tt.protocols.length>et.protocols.length||tt.id.publicKey!=null&&et.id.publicKey==null?1:-1),async _e=>await all$5(_e));for(let _e=0;this.running&&_e<j.length&&this.components.connectionManager.getConnections().length<a;_e++){if(!this.running)return;const et=j[_e];if(this.components.connectionManager.getConnections(et.id).length===0){log$J("connecting to a peerStore stored peer %p",et.id);try{await this.components.connectionManager.openConnection(et.id)}catch(tt){log$J.error("could not connect to peerStore stored peer",tt)}}}!this.running||(this.autoDialTimeout=retimer_1(this._autoDial,this.options.autoDialInterval))}}var CircuitRelay;(function(_){(function(_e){_e.SUCCESS="SUCCESS",_e.HOP_SRC_ADDR_TOO_LONG="HOP_SRC_ADDR_TOO_LONG",_e.HOP_DST_ADDR_TOO_LONG="HOP_DST_ADDR_TOO_LONG",_e.HOP_SRC_MULTIADDR_INVALID="HOP_SRC_MULTIADDR_INVALID",_e.HOP_DST_MULTIADDR_INVALID="HOP_DST_MULTIADDR_INVALID",_e.HOP_NO_CONN_TO_DST="HOP_NO_CONN_TO_DST",_e.HOP_CANT_DIAL_DST="HOP_CANT_DIAL_DST",_e.HOP_CANT_OPEN_DST_STREAM="HOP_CANT_OPEN_DST_STREAM",_e.HOP_CANT_SPEAK_RELAY="HOP_CANT_SPEAK_RELAY",_e.HOP_CANT_RELAY_TO_SELF="HOP_CANT_RELAY_TO_SELF",_e.STOP_SRC_ADDR_TOO_LONG="STOP_SRC_ADDR_TOO_LONG",_e.STOP_DST_ADDR_TOO_LONG="STOP_DST_ADDR_TOO_LONG",_e.STOP_SRC_MULTIADDR_INVALID="STOP_SRC_MULTIADDR_INVALID",_e.STOP_DST_MULTIADDR_INVALID="STOP_DST_MULTIADDR_INVALID",_e.STOP_RELAY_REFUSED="STOP_RELAY_REFUSED",_e.MALFORMED_MESSAGE="MALFORMED_MESSAGE"})(_.Status||(_.Status={}));let a;(function(_e){_e[_e.SUCCESS=100]="SUCCESS",_e[_e.HOP_SRC_ADDR_TOO_LONG=220]="HOP_SRC_ADDR_TOO_LONG",_e[_e.HOP_DST_ADDR_TOO_LONG=221]="HOP_DST_ADDR_TOO_LONG",_e[_e.HOP_SRC_MULTIADDR_INVALID=250]="HOP_SRC_MULTIADDR_INVALID",_e[_e.HOP_DST_MULTIADDR_INVALID=251]="HOP_DST_MULTIADDR_INVALID",_e[_e.HOP_NO_CONN_TO_DST=260]="HOP_NO_CONN_TO_DST",_e[_e.HOP_CANT_DIAL_DST=261]="HOP_CANT_DIAL_DST",_e[_e.HOP_CANT_OPEN_DST_STREAM=262]="HOP_CANT_OPEN_DST_STREAM",_e[_e.HOP_CANT_SPEAK_RELAY=270]="HOP_CANT_SPEAK_RELAY",_e[_e.HOP_CANT_RELAY_TO_SELF=280]="HOP_CANT_RELAY_TO_SELF",_e[_e.STOP_SRC_ADDR_TOO_LONG=320]="STOP_SRC_ADDR_TOO_LONG",_e[_e.STOP_DST_ADDR_TOO_LONG=321]="STOP_DST_ADDR_TOO_LONG",_e[_e.STOP_SRC_MULTIADDR_INVALID=350]="STOP_SRC_MULTIADDR_INVALID",_e[_e.STOP_DST_MULTIADDR_INVALID=351]="STOP_DST_MULTIADDR_INVALID",_e[_e.STOP_RELAY_REFUSED=390]="STOP_RELAY_REFUSED",_e[_e.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE"})(a||(a={})),function(_e){_e.codec=()=>enumeration(a)}(_.Status||(_.Status={})),function(_e){_e.HOP="HOP",_e.STOP="STOP",_e.STATUS="STATUS",_e.CAN_HOP="CAN_HOP"}(_.Type||(_.Type={}));let $;(function(_e){_e[_e.HOP=1]="HOP",_e[_e.STOP=2]="STOP",_e[_e.STATUS=3]="STATUS",_e[_e.CAN_HOP=4]="CAN_HOP"})($||($={})),function(_e){_e.codec=()=>enumeration($)}(_.Type||(_.Type={})),function(_e){let et;_e.codec=()=>(et==null&&(et=message((tt,rt,nt={})=>{if(nt.lengthDelimited!==!1&&rt.fork(),(nt.writeDefaults===!0||tt.id!=null&&tt.id.byteLength>0)&&(rt.uint32(10),rt.bytes(tt.id)),tt.addrs!=null)for(const it of tt.addrs)rt.uint32(18),rt.bytes(it);nt.lengthDelimited!==!1&&rt.ldelim()},(tt,rt)=>{const nt={id:new Uint8Array(0),addrs:[]},it=rt==null?tt.len:tt.pos+rt;for(;tt.pos<it;){const st=tt.uint32();switch(st>>>3){case 1:nt.id=tt.bytes();break;case 2:nt.addrs.push(tt.bytes());break;default:tt.skipType(st&7);break}}return nt})),et),_e.encode=tt=>encodeMessage(tt,_e.codec()),_e.decode=tt=>decodeMessage(tt,_e.codec())}(_.Peer||(_.Peer={}));let j;_.codec=()=>(j==null&&(j=message((_e,et,tt={})=>{tt.lengthDelimited!==!1&&et.fork(),_e.type!=null&&(et.uint32(8),_.Type.codec().encode(_e.type,et)),_e.srcPeer!=null&&(et.uint32(18),_.Peer.codec().encode(_e.srcPeer,et,{writeDefaults:!1})),_e.dstPeer!=null&&(et.uint32(26),_.Peer.codec().encode(_e.dstPeer,et,{writeDefaults:!1})),_e.code!=null&&(et.uint32(32),_.Status.codec().encode(_e.code,et)),tt.lengthDelimited!==!1&&et.ldelim()},(_e,et)=>{const tt={},rt=et==null?_e.len:_e.pos+et;for(;_e.pos<rt;){const nt=_e.uint32();switch(nt>>>3){case 1:tt.type=_.Type.codec().decode(_e);break;case 2:tt.srcPeer=_.Peer.codec().decode(_e,_e.uint32());break;case 3:tt.dstPeer=_.Peer.codec().decode(_e,_e.uint32());break;case 4:tt.code=_.Status.codec().decode(_e);break;default:_e.skipType(nt&7);break}}return tt})),j),_.encode=_e=>encodeMessage(_e,_.codec()),_.decode=_e=>decodeMessage(_e,_.codec())})(CircuitRelay||(CircuitRelay={}));const log$I=logger$1("libp2p:stream:converter");function streamToMaConnection(_,a={}){const{stream:$,remoteAddr:j}=_,{sink:_e,source:et}=$,tt=async function*(){for await(const it of et)yield*it}(),rt={async sink(it){a.signal!=null&&(it=abortableSource(it,a.signal));try{await _e(it),await nt()}catch(st){st.type!=="aborted"&&log$I(st)}},source:a.signal!=null?abortableSource(tt,a.signal):tt,remoteAddr:j,timeline:{open:Date.now(),close:void 0},async close(){await _e(async function*(){yield new Uint8Array(0)}()),await nt()}};async function nt(){return rt.timeline.close==null&&(rt.timeline.close=Date.now()),await Promise.resolve()}return rt}const RELAY_CODEC="/libp2p/circuit/relay/0.1.0";function createListener$1(_){const a=new Map;async function $(et){const tt=et.toString().split("/p2p-circuit").find(at=>at!==""),rt=multiaddr(tt),nt=rt.getPeerId();if(nt==null)throw new Error("Could not determine relay peer from multiaddr");const it=peerIdFromString(nt);await _.peerStore.addressBook.add(it,[rt]);const st=await _.connectionManager.openConnection(it),ot=st.remoteAddr.encapsulate("/p2p-circuit");a.set(st.remotePeer.toString(),ot),_e.dispatchEvent(new CustomEvent$1("listening"))}function j(){const et=[];for(const tt of a.values())et.push(tt);return et}const _e=Object.assign(new EventEmitter$1,{close:async()=>await Promise.resolve(),listen:$,getAddrs:j});return _.connectionManager.addEventListener("peer:disconnect",et=>{const{detail:tt}=et;a.delete(tt.remotePeer.toString())&&_e.dispatchEvent(new CustomEvent$1("close"))}),_e}function writeResponse(_,a){_.write({type:CircuitRelay.Type.STATUS,code:a})}function validateAddrs(_,a){try{_.dstPeer?.addrs!=null&&_.dstPeer.addrs.forEach($=>multiaddr($))}catch($){throw writeResponse(a,_.type===CircuitRelay.Type.HOP?CircuitRelay.Status.HOP_DST_MULTIADDR_INVALID:CircuitRelay.Status.STOP_DST_MULTIADDR_INVALID),$}try{_.srcPeer?.addrs!=null&&_.srcPeer.addrs.forEach($=>multiaddr($))}catch($){throw writeResponse(a,_.type===CircuitRelay.Type.HOP?CircuitRelay.Status.HOP_SRC_MULTIADDR_INVALID:CircuitRelay.Status.STOP_SRC_MULTIADDR_INVALID),$}}function handshake(_){const a=pushable$2(),$=reader$1(_.source),j=pDefer$2();let _e;const et=_.sink(async function*(){yield*a,yield*await j.promise}());return et.catch(rt=>{_e=rt}),{reader:$,writer:a,stream:{sink:async rt=>_e!=null?await Promise.reject(_e):(j.resolve(rt),await et),source:$},rest:()=>a.end(),write:a.push,read:async()=>{const rt=await $.next();if(rt.value!=null)return rt.value}}}const log$H=logger$1("libp2p:circuit:stream-handler");class StreamHandler{constructor(a){const{stream:$,maxLength:j=4096}=a;this.stream=$,this.shake=handshake(this.stream),this.decoder=decode$4.fromReader(this.shake.reader,{maxDataLength:j})}async read(){const a=await this.decoder.next();if(a.value!=null){const $=CircuitRelay.decode(a.value);return log$H("read message type",$.type),$}log$H("read received no value, closing stream"),this.close()}write(a){log$H("write message type %s",a.type),this.shake.write(encode$5.single(CircuitRelay.encode(a)))}rest(){return this.shake.rest(),this.shake.stream}end(a){this.write(a),this.close()}close(){log$H("closing the stream"),this.rest().sink([]).catch(a=>{log$H.error(a)})}}const log$G=logger$1("libp2p:circuit:stop");function handleStop(_){const{connection:a,request:$,streamHandler:j}=_;try{validateAddrs($,j)}catch(_e){log$G.error("invalid stop request via peer %p %o",a.remotePeer,_e);return}return log$G("stop request is valid"),j.write({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.SUCCESS}),j.rest()}async function stop(_){const{connection:a,request:$,signal:j}=_,_e=await a.newStream(RELAY_CODEC,{signal:j});log$G("starting stop request to %p",a.remotePeer);const et=new StreamHandler({stream:_e});et.write($);const tt=await et.read();if(tt==null){et.close();return}if(tt.code===CircuitRelay.Status.SUCCESS)return log$G("stop request to %p was successful",a.remotePeer),et.rest();log$G("stop request failed with code %d",tt.code),et.close()}const log$F=logger$1("libp2p:circuit:hop");async function handleHop(_){const{connection:a,request:$,streamHandler:j,circuit:_e,connectionManager:et}=_;if(!_e.hopEnabled())return log$F("HOP request received but we are not acting as a relay"),j.end({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.HOP_CANT_SPEAK_RELAY});try{validateAddrs($,j)}catch(ot){log$F.error("invalid hop request via peer %p %o",a.remotePeer,ot);return}if($.dstPeer==null){log$F("HOP request received but we do not receive a dstPeer");return}const tt=peerIdFromBytes($.dstPeer.id),rt=et.getConnections(tt);if(rt.length===0&&!_e.hopActive())return log$F("HOP request received but we are not connected to the destination peer"),j.end({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.HOP_NO_CONN_TO_DST});if(rt.length===0)return log$F("did not have connection to remote peer"),j.end({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.HOP_NO_CONN_TO_DST});const nt={type:CircuitRelay.Type.STOP,dstPeer:$.dstPeer,srcPeer:$.srcPeer};let it;try{log$F("performing STOP request");const ot=await stop({connection:rt[0],request:nt});if(ot==null)throw new Error("Could not stop");it=ot}catch(ot){log$F.error(ot);return}log$F("hop request from %p is valid",a.remotePeer),j.write({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.SUCCESS});const st=j.rest();return log$F("creating related connections"),await pipe(st,it,st)}async function hop(_){const{connection:a,request:$,signal:j}=_,_e=await a.newStream(RELAY_CODEC,{signal:j}),et=new StreamHandler({stream:_e});et.write($);const tt=await et.read();if(tt==null)throw errCode(new Error("HOP request had no response"),codes$1.ERR_HOP_REQUEST_FAILED);if(tt.code===CircuitRelay.Status.SUCCESS)return log$F("hop request was successful"),et.rest();throw log$F("hop request failed with code %d, closing stream",tt.code),et.close(),errCode(new Error(`HOP request failed with code "${tt.code??"unknown"}"`),codes$1.ERR_HOP_REQUEST_FAILED)}async function canHop(_){const{connection:a,signal:$}=_,j=await a.newStream(RELAY_CODEC,{signal:$}),_e=new StreamHandler({stream:j});_e.write({type:CircuitRelay.Type.CAN_HOP});const et=await _e.read();return await _e.close(),!(et==null||et.code!==CircuitRelay.Status.SUCCESS)}function handleCanHop(_){const{connection:a,streamHandler:$,circuit:j}=_,_e=j.hopEnabled();log$F("can hop (%s) request from %p",_e,a.remotePeer),$.end({type:CircuitRelay.Type.STATUS,code:_e?CircuitRelay.Status.SUCCESS:CircuitRelay.Status.HOP_CANT_SPEAK_RELAY})}const log$E=logger$1("libp2p:circuit");class Circuit{constructor(a,$){this._init=$,this.components=a,this._started=!1}isStarted(){return this._started}async start(){this._started||(this._started=!0,await this.components.registrar.handle(RELAY_CODEC,a=>{this._onProtocol(a).catch($=>{log$E.error($)})}).catch(a=>{log$E.error(a)}))}async stop(){await this.components.registrar.unhandle(RELAY_CODEC)}hopEnabled(){return!0}hopActive(){return!0}get[symbol$2](){return!0}get[Symbol.toStringTag](){return"libp2p/circuit-relay-v1"}async _onProtocol(a){const{connection:$,stream:j}=a,_e=new timeoutAbortController.TimeoutController(this._init.hop.timeout);try{events.exports.setMaxListeners?.(1/0,_e.signal)}catch{}try{const et=abortableDuplex(j,_e.signal),tt=new StreamHandler({stream:{...j,...et}}),rt=await tt.read();if(rt==null){log$E("request was invalid, could not read from stream"),tt.write({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.MALFORMED_MESSAGE}),tt.close();return}let nt;switch(rt.type){case CircuitRelay.Type.CAN_HOP:{log$E("received CAN_HOP request from %p",$.remotePeer),await handleCanHop({circuit:this,connection:$,streamHandler:tt});break}case CircuitRelay.Type.HOP:{log$E("received HOP request from %p",$.remotePeer),await handleHop({connection:$,request:rt,streamHandler:tt,circuit:this,connectionManager:this.components.connectionManager});break}case CircuitRelay.Type.STOP:{log$E("received STOP request from %p",$.remotePeer),nt=await handleStop({connection:$,request:rt,streamHandler:tt});break}default:{log$E("Request of type %s not supported",rt.type),tt.write({type:CircuitRelay.Type.STATUS,code:CircuitRelay.Status.MALFORMED_MESSAGE}),tt.close();return}}if(nt!=null){const it=$.remoteAddr.encapsulate("/p2p-circuit").encapsulate(multiaddr(rt.dstPeer?.addrs[0])),st=multiaddr(rt.srcPeer?.addrs[0]),ot=streamToMaConnection({stream:nt,remoteAddr:it,localAddr:st}),at=rt.type===CircuitRelay.Type.HOP?"relay":"inbound";log$E("new %s connection %s",at,ot.remoteAddr);const lt=await this.components.upgrader.upgradeInbound(ot);log$E("%s connection %s upgraded",at,ot.remoteAddr),this.handler!=null&&this.handler(lt)}}finally{_e.clear()}}async dial(a,$={}){const j=a.toString().split("/p2p-circuit"),_e=multiaddr(j[0]),et=multiaddr(j[j.length-1]),tt=_e.getPeerId(),rt=et.getPeerId();if(tt==null||rt==null){const lt="Circuit relay dial failed as addresses did not have peer id";throw log$E.error(lt),errCode(new Error(lt),codes$1.ERR_RELAYED_DIAL)}const nt=peerIdFromString(tt),it=peerIdFromString(rt);let st=!1,at=this.components.connectionManager.getConnections(nt)[0];at==null&&(await this.components.peerStore.addressBook.add(nt,[_e]),at=await this.components.connectionManager.openConnection(nt,$),st=!0);try{const lt=await hop({...$,connection:at,request:{type:CircuitRelay.Type.HOP,srcPeer:{id:this.components.peerId.toBytes(),addrs:this.components.addressManager.getAddresses().map(dt=>dt.bytes)},dstPeer:{id:it.toBytes(),addrs:[multiaddr(et).bytes]}}}),ct=_e.encapsulate(`/p2p-circuit/p2p/${this.components.peerId.toString()}`),ut=streamToMaConnection({stream:lt,remoteAddr:a,localAddr:ct});return log$E("new outbound connection %s",ut.remoteAddr),await this.components.upgrader.upgradeOutbound(ut)}catch(lt){throw log$E.error("Circuit relay dial failed",lt),st&&await at.close(),lt}}createListener(a){return this.handler=a.handler,createListener$1({connectionManager:this.components.connectionManager,peerStore:this.components.peerStore})}filter(a){return a=Array.isArray(a)?a:[a],a.filter($=>Circuit$1.matches($))}}async function namespaceToCid(_){const a=new TextEncoder().encode(_),$=await sha256$4.digest(a);return CID.createV0($)}const minute$1=60*1e3,ADVERTISE_BOOT_DELAY=15*minute$1,ADVERTISE_TTL=30*minute$1,CIRCUIT_PROTO_CODE=290,HOP_METADATA_KEY="hop_relay",HOP_METADATA_VALUE="true",RELAY_RENDEZVOUS_NS="/libp2p/relay";var lib={},netmask={};(function(){var _,a,$,j,_e,et,tt,rt;rt=function(nt){var it,st,ot,at;return it=(nt&255<<24)>>>24,st=(nt&255<<16)>>>16,ot=(nt&255<<8)>>>8,at=nt&255,[it,st,ot,at].join(".")},tt=function(nt){var it,st,ot,at,lt,ct;for(it=[],ot=at=0;at<=3&&nt.length!==0;ot=++at){if(ot>0){if(nt[0]!==".")throw new Error("Invalid IP");nt=nt.substring(1)}ct=a(nt),lt=ct[0],st=ct[1],nt=nt.substring(st),it.push(lt)}if(nt.length!==0)throw new Error("Invalid IP");switch(it.length){case 1:if(it[0]>4294967295)throw new Error("Invalid IP");return it[0]>>>0;case 2:if(it[0]>255||it[1]>16777215)throw new Error("Invalid IP");return(it[0]<<24|it[1])>>>0;case 3:if(it[0]>255||it[1]>255||it[2]>65535)throw new Error("Invalid IP");return(it[0]<<24|it[1]<<16|it[2])>>>0;case 4:if(it[0]>255||it[1]>255||it[2]>255||it[3]>255)throw new Error("Invalid IP");return(it[0]<<24|it[1]<<16|it[2]<<8|it[3])>>>0;default:throw new Error("Invalid IP")}},$=function(nt){return nt.charCodeAt(0)},j=$("0"),et=$("a"),_e=$("A"),a=function(nt){var it,st,ot,at,lt;for(at=0,it=10,st="9",ot=0,nt.length>1&&nt[ot]==="0"&&(nt[ot+1]==="x"||nt[ot+1]==="X"?(ot+=2,it=16):"0"<=nt[ot+1]&&nt[ot+1]<="9"&&(ot++,it=8,st="7")),lt=ot;ot<nt.length;){if("0"<=nt[ot]&&nt[ot]<=st)at=at*it+($(nt[ot])-j)>>>0;else if(it===16)if("a"<=nt[ot]&&nt[ot]<="f")at=at*it+(10+$(nt[ot])-et)>>>0;else if("A"<=nt[ot]&&nt[ot]<="F")at=at*it+(10+$(nt[ot])-_e)>>>0;else break;else break;if(at>4294967295)throw new Error("too large");ot++}if(ot===lt)throw new Error("empty octet");return[at,ot]},_=function(){function nt(it,st){var ot,at,lt;if(typeof it!="string")throw new Error("Missing `net' parameter");if(st||(lt=it.split("/",2),it=lt[0],st=lt[1]),st||(st=32),typeof st=="string"&&st.indexOf(".")>-1){try{this.maskLong=tt(st)}catch{throw new Error("Invalid mask: "+st)}for(ot=at=32;at>=0;ot=--at)if(this.maskLong===4294967295<<32-ot>>>0){this.bitmask=ot;break}}else if(st||st===0)this.bitmask=parseInt(st,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(tt(it)&this.maskLong)>>>0}catch{throw new Error("Invalid net address: "+it)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+st);this.size=Math.pow(2,32-this.bitmask),this.base=rt(this.netLong),this.mask=rt(this.maskLong),this.hostmask=rt(~this.maskLong),this.first=this.bitmask<=30?rt(this.netLong+1):this.base,this.last=this.bitmask<=30?rt(this.netLong+this.size-2):rt(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?rt(this.netLong+this.size-1):void 0}return nt.prototype.contains=function(it){return typeof it=="string"&&(it.indexOf("/")>0||it.split(".").length!==4)&&(it=new nt(it)),it instanceof nt?this.contains(it.base)&&this.contains(it.broadcast||it.last):(tt(it)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},nt.prototype.next=function(it){return it==null&&(it=1),new nt(rt(this.netLong+this.size*it),this.mask)},nt.prototype.forEach=function(it){var st,ot,at;for(at=tt(this.first),ot=tt(this.last),st=0;at<=ot;)it(rt(at),at,st),st++,at++},nt.prototype.toString=function(){return this.base+"/"+this.bitmask},nt}(),netmask.ip2long=tt,netmask.long2ip=rt,netmask.Netmask=_}).call(commonjsGlobal);const word="[a-fA-F\\d:]",b=_=>_&&_.includeBoundaries?`(?:(?<=\\s|^)(?=${word})|(?<=${word})(?=\\s|$))`:"",v4="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",v6seg="[a-fA-F\\d]{1,4}",v6=`
(?:
(?:${v6seg}:){7}(?:${v6seg}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${v6seg}:){6}(?:${v4}|:${v6seg}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${v6seg}:){5}(?::${v4}|(?::${v6seg}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${v6seg}:){4}(?:(?::${v6seg}){0,1}:${v4}|(?::${v6seg}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${v6seg}:){3}(?:(?::${v6seg}){0,2}:${v4}|(?::${v6seg}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${v6seg}:){2}(?:(?::${v6seg}){0,3}:${v4}|(?::${v6seg}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${v6seg}:){1}(?:(?::${v6seg}){0,4}:${v4}|(?::${v6seg}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${v6seg}){0,5}:${v4}|(?::${v6seg}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),v46Exact=new RegExp(`(?:^${v4}$)|(?:^${v6}$)`),v4exact=new RegExp(`^${v4}$`),v6exact=new RegExp(`^${v6}$`),ip=_=>_&&_.exact?v46Exact:new RegExp(`(?:${b(_)}${v4}${b(_)})|(?:${b(_)}${v6}${b(_)})`,"g");ip.v4=_=>_&&_.exact?v4exact:new RegExp(`${b(_)}${v4}${b(_)}`,"g");ip.v6=_=>_&&_.exact?v6exact:new RegExp(`${b(_)}${v6}${b(_)}`,"g");var ipRegex$1=ip;const ipRegex=ipRegex$1,isIp=_=>ipRegex({exact:!0}).test(_);isIp.v4=_=>ipRegex.v4({exact:!0}).test(_);isIp.v6=_=>ipRegex.v6({exact:!0}).test(_);isIp.version=_=>isIp(_)?isIp.v4(_)?4:6:void 0;var isIp_1=isIp,ipaddr={exports:{}};(function(_){(function(a){const $="(0?\\d+|0x[a-f0-9]+)",j={fourOctet:new RegExp(`^${$}\\.${$}\\.${$}\\.${$}$`,"i"),threeOctet:new RegExp(`^${$}\\.${$}\\.${$}$`,"i"),twoOctet:new RegExp(`^${$}\\.${$}$`,"i"),longValue:new RegExp(`^${$}$`,"i")},_e=new RegExp("^0[0-7]+$","i"),et=new RegExp("^0x[a-f0-9]+$","i"),tt="%[0-9a-z]{1,}",rt="(?:[0-9a-f]+::?)+",nt={zoneIndex:new RegExp(tt,"i"),native:new RegExp(`^(::)?(${rt})?([0-9a-f]+)?(::)?(${tt})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${$}\\.${$}\\.${$}\\.${$}(${tt})?)$`,"i"),transitional:new RegExp(`^((?:${rt})|(?:::)(?:${rt})?)${$}\\.${$}\\.${$}\\.${$}(${tt})?$`,"i")};function it(ct,ut){if(ct.indexOf("::")!==ct.lastIndexOf("::"))return null;let dt=0,ft=-1,pt=(ct.match(nt.zoneIndex)||[])[0],yt,mt;for(pt&&(pt=pt.substring(1),ct=ct.replace(/%.+$/,""));(ft=ct.indexOf(":",ft+1))>=0;)dt++;if(ct.substr(0,2)==="::"&&dt--,ct.substr(-2,2)==="::"&&dt--,dt>ut)return null;for(mt=ut-dt,yt=":";mt--;)yt+="0:";return ct=ct.replace("::",yt),ct[0]===":"&&(ct=ct.slice(1)),ct[ct.length-1]===":"&&(ct=ct.slice(0,-1)),ut=function(){const _t=ct.split(":"),vt=[];for(let ht=0;ht<_t.length;ht++)vt.push(parseInt(_t[ht],16));return vt}(),{parts:ut,zoneId:pt}}function st(ct,ut,dt,ft){if(ct.length!==ut.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let pt=0,yt;for(;ft>0;){if(yt=dt-ft,yt<0&&(yt=0),ct[pt]>>yt!==ut[pt]>>yt)return!1;ft-=dt,pt+=1}return!0}function ot(ct){if(et.test(ct))return parseInt(ct,16);if(ct[0]==="0"&&!isNaN(parseInt(ct[1],10))){if(_e.test(ct))return parseInt(ct,8);throw new Error(`ipaddr: cannot parse ${ct} as octal`)}return parseInt(ct,10)}function at(ct,ut){for(;ct.length<ut;)ct=`0${ct}`;return ct}const lt={};lt.IPv4=function(){function ct(ut){if(ut.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let dt,ft;for(dt=0;dt<ut.length;dt++)if(ft=ut[dt],!(0<=ft&&ft<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=ut}return ct.prototype.SpecialRanges={unspecified:[[new ct([0,0,0,0]),8]],broadcast:[[new ct([255,255,255,255]),32]],multicast:[[new ct([224,0,0,0]),4]],linkLocal:[[new ct([169,254,0,0]),16]],loopback:[[new ct([127,0,0,0]),8]],carrierGradeNat:[[new ct([100,64,0,0]),10]],private:[[new ct([10,0,0,0]),8],[new ct([172,16,0,0]),12],[new ct([192,168,0,0]),16]],reserved:[[new ct([192,0,0,0]),24],[new ct([192,0,2,0]),24],[new ct([192,88,99,0]),24],[new ct([198,51,100,0]),24],[new ct([203,0,113,0]),24],[new ct([240,0,0,0]),4]]},ct.prototype.kind=function(){return"ipv4"},ct.prototype.match=function(ut,dt){let ft;if(dt===void 0&&(ft=ut,ut=ft[0],dt=ft[1]),ut.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return st(this.octets,ut.octets,8,dt)},ct.prototype.prefixLengthFromSubnetMask=function(){let ut=0,dt=!1;const ft={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let pt,yt,mt;for(pt=3;pt>=0;pt-=1)if(yt=this.octets[pt],yt in ft){if(mt=ft[yt],dt&&mt!==0)return null;mt!==8&&(dt=!0),ut+=mt}else return null;return 32-ut},ct.prototype.range=function(){return lt.subnetMatch(this,this.SpecialRanges)},ct.prototype.toByteArray=function(){return this.octets.slice(0)},ct.prototype.toIPv4MappedAddress=function(){return lt.IPv6.parse(`::ffff:${this.toString()}`)},ct.prototype.toNormalizedString=function(){return this.toString()},ct.prototype.toString=function(){return this.octets.join(".")},ct}(),lt.IPv4.broadcastAddressFromCIDR=function(ct){try{const ut=this.parseCIDR(ct),dt=ut[0].toByteArray(),ft=this.subnetMaskFromPrefixLength(ut[1]).toByteArray(),pt=[];let yt=0;for(;yt<4;)pt.push(parseInt(dt[yt],10)|parseInt(ft[yt],10)^255),yt++;return new this(pt)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},lt.IPv4.isIPv4=function(ct){return this.parser(ct)!==null},lt.IPv4.isValid=function(ct){try{return new this(this.parser(ct)),!0}catch{return!1}},lt.IPv4.isValidFourPartDecimal=function(ct){return!!(lt.IPv4.isValid(ct)&&ct.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},lt.IPv4.networkAddressFromCIDR=function(ct){let ut,dt,ft,pt,yt;try{for(ut=this.parseCIDR(ct),ft=ut[0].toByteArray(),yt=this.subnetMaskFromPrefixLength(ut[1]).toByteArray(),pt=[],dt=0;dt<4;)pt.push(parseInt(ft[dt],10)&parseInt(yt[dt],10)),dt++;return new this(pt)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},lt.IPv4.parse=function(ct){const ut=this.parser(ct);if(ut===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(ut)},lt.IPv4.parseCIDR=function(ct){let ut;if(ut=ct.match(/^(.+)\/(\d+)$/)){const dt=parseInt(ut[2]);if(dt>=0&&dt<=32){const ft=[this.parse(ut[1]),dt];return Object.defineProperty(ft,"toString",{value:function(){return this.join("/")}}),ft}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},lt.IPv4.parser=function(ct){let ut,dt,ft;if(ut=ct.match(j.fourOctet))return function(){const pt=ut.slice(1,6),yt=[];for(let mt=0;mt<pt.length;mt++)dt=pt[mt],yt.push(ot(dt));return yt}();if(ut=ct.match(j.longValue)){if(ft=ot(ut[1]),ft>4294967295||ft<0)throw new Error("ipaddr: address outside defined range");return function(){const pt=[];let yt;for(yt=0;yt<=24;yt+=8)pt.push(ft>>yt&255);return pt}().reverse()}else return(ut=ct.match(j.twoOctet))?function(){const pt=ut.slice(1,4),yt=[];if(ft=ot(pt[1]),ft>16777215||ft<0)throw new Error("ipaddr: address outside defined range");return yt.push(ot(pt[0])),yt.push(ft>>16&255),yt.push(ft>>8&255),yt.push(ft&255),yt}():(ut=ct.match(j.threeOctet))?function(){const pt=ut.slice(1,5),yt=[];if(ft=ot(pt[2]),ft>65535||ft<0)throw new Error("ipaddr: address outside defined range");return yt.push(ot(pt[0])),yt.push(ot(pt[1])),yt.push(ft>>8&255),yt.push(ft&255),yt}():null},lt.IPv4.subnetMaskFromPrefixLength=function(ct){if(ct=parseInt(ct),ct<0||ct>32)throw new Error("ipaddr: invalid IPv4 prefix length");const ut=[0,0,0,0];let dt=0;const ft=Math.floor(ct/8);for(;dt<ft;)ut[dt]=255,dt++;return ft<4&&(ut[ft]=Math.pow(2,ct%8)-1<<8-ct%8),new this(ut)},lt.IPv6=function(){function ct(ut,dt){let ft,pt;if(ut.length===16)for(this.parts=[],ft=0;ft<=14;ft+=2)this.parts.push(ut[ft]<<8|ut[ft+1]);else if(ut.length===8)this.parts=ut;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(ft=0;ft<this.parts.length;ft++)if(pt=this.parts[ft],!(0<=pt&&pt<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");dt&&(this.zoneId=dt)}return ct.prototype.SpecialRanges={unspecified:[new ct([0,0,0,0,0,0,0,0]),128],linkLocal:[new ct([65152,0,0,0,0,0,0,0]),10],multicast:[new ct([65280,0,0,0,0,0,0,0]),8],loopback:[new ct([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new ct([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new ct([0,0,0,0,0,65535,0,0]),96],rfc6145:[new ct([0,0,0,0,65535,0,0,0]),96],rfc6052:[new ct([100,65435,0,0,0,0,0,0]),96],"6to4":[new ct([8194,0,0,0,0,0,0,0]),16],teredo:[new ct([8193,0,0,0,0,0,0,0]),32],reserved:[[new ct([8193,3512,0,0,0,0,0,0]),32]]},ct.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},ct.prototype.kind=function(){return"ipv6"},ct.prototype.match=function(ut,dt){let ft;if(dt===void 0&&(ft=ut,ut=ft[0],dt=ft[1]),ut.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return st(this.parts,ut.parts,16,dt)},ct.prototype.prefixLengthFromSubnetMask=function(){let ut=0,dt=!1;const ft={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let pt,yt;for(let mt=7;mt>=0;mt-=1)if(pt=this.parts[mt],pt in ft){if(yt=ft[pt],dt&&yt!==0)return null;yt!==16&&(dt=!0),ut+=yt}else return null;return 128-ut},ct.prototype.range=function(){return lt.subnetMatch(this,this.SpecialRanges)},ct.prototype.toByteArray=function(){let ut;const dt=[],ft=this.parts;for(let pt=0;pt<ft.length;pt++)ut=ft[pt],dt.push(ut>>8),dt.push(ut&255);return dt},ct.prototype.toFixedLengthString=function(){const ut=function(){const ft=[];for(let pt=0;pt<this.parts.length;pt++)ft.push(at(this.parts[pt].toString(16),4));return ft}.call(this).join(":");let dt="";return this.zoneId&&(dt=`%${this.zoneId}`),ut+dt},ct.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const ut=this.parts.slice(-2),dt=ut[0],ft=ut[1];return new lt.IPv4([dt>>8,dt&255,ft>>8,ft&255])},ct.prototype.toNormalizedString=function(){const ut=function(){const ft=[];for(let pt=0;pt<this.parts.length;pt++)ft.push(this.parts[pt].toString(16));return ft}.call(this).join(":");let dt="";return this.zoneId&&(dt=`%${this.zoneId}`),ut+dt},ct.prototype.toRFC5952String=function(){const ut=/((^|:)(0(:|$)){2,})/g,dt=this.toNormalizedString();let ft=0,pt=-1,yt;for(;yt=ut.exec(dt);)yt[0].length>pt&&(ft=yt.index,pt=yt[0].length);return pt<0?dt:`${dt.substring(0,ft)}::${dt.substring(ft+pt)}`},ct.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},ct}(),lt.IPv6.broadcastAddressFromCIDR=function(ct){try{const ut=this.parseCIDR(ct),dt=ut[0].toByteArray(),ft=this.subnetMaskFromPrefixLength(ut[1]).toByteArray(),pt=[];let yt=0;for(;yt<16;)pt.push(parseInt(dt[yt],10)|parseInt(ft[yt],10)^255),yt++;return new this(pt)}catch(ut){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${ut})`)}},lt.IPv6.isIPv6=function(ct){return this.parser(ct)!==null},lt.IPv6.isValid=function(ct){if(typeof ct=="string"&&ct.indexOf(":")===-1)return!1;try{const ut=this.parser(ct);return new this(ut.parts,ut.zoneId),!0}catch{return!1}},lt.IPv6.networkAddressFromCIDR=function(ct){let ut,dt,ft,pt,yt;try{for(ut=this.parseCIDR(ct),ft=ut[0].toByteArray(),yt=this.subnetMaskFromPrefixLength(ut[1]).toByteArray(),pt=[],dt=0;dt<16;)pt.push(parseInt(ft[dt],10)&parseInt(yt[dt],10)),dt++;return new this(pt)}catch(mt){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${mt})`)}},lt.IPv6.parse=function(ct){const ut=this.parser(ct);if(ut.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(ut.parts,ut.zoneId)},lt.IPv6.parseCIDR=function(ct){let ut,dt,ft;if((dt=ct.match(/^(.+)\/(\d+)$/))&&(ut=parseInt(dt[2]),ut>=0&&ut<=128))return ft=[this.parse(dt[1]),ut],Object.defineProperty(ft,"toString",{value:function(){return this.join("/")}}),ft;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},lt.IPv6.parser=function(ct){let ut,dt,ft,pt,yt,mt;if(ft=ct.match(nt.deprecatedTransitional))return this.parser(`::ffff:${ft[1]}`);if(nt.native.test(ct))return it(ct,8);if((ft=ct.match(nt.transitional))&&(mt=ft[6]||"",ut=it(ft[1].slice(0,-1)+mt,6),ut.parts)){for(yt=[parseInt(ft[2]),parseInt(ft[3]),parseInt(ft[4]),parseInt(ft[5])],dt=0;dt<yt.length;dt++)if(pt=yt[dt],!(0<=pt&&pt<=255))return null;return ut.parts.push(yt[0]<<8|yt[1]),ut.parts.push(yt[2]<<8|yt[3]),{parts:ut.parts,zoneId:ut.zoneId}}return null},lt.IPv6.subnetMaskFromPrefixLength=function(ct){if(ct=parseInt(ct),ct<0||ct>128)throw new Error("ipaddr: invalid IPv6 prefix length");const ut=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let dt=0;const ft=Math.floor(ct/8);for(;dt<ft;)ut[dt]=255,dt++;return ft<16&&(ut[ft]=Math.pow(2,ct%8)-1<<8-ct%8),new this(ut)},lt.fromByteArray=function(ct){const ut=ct.length;if(ut===4)return new lt.IPv4(ct);if(ut===16)return new lt.IPv6(ct);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},lt.isValid=function(ct){return lt.IPv6.isValid(ct)||lt.IPv4.isValid(ct)},lt.parse=function(ct){if(lt.IPv6.isValid(ct))return lt.IPv6.parse(ct);if(lt.IPv4.isValid(ct))return lt.IPv4.parse(ct);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},lt.parseCIDR=function(ct){try{return lt.IPv6.parseCIDR(ct)}catch{try{return lt.IPv4.parseCIDR(ct)}catch{throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},lt.process=function(ct){const ut=this.parse(ct);return ut.kind()==="ipv6"&&ut.isIPv4MappedAddress()?ut.toIPv4Address():ut},lt.subnetMatch=function(ct,ut,dt){let ft,pt,yt,mt;dt==null&&(dt="unicast");for(pt in ut)if(Object.prototype.hasOwnProperty.call(ut,pt)){for(yt=ut[pt],yt[0]&&!(yt[0]instanceof Array)&&(yt=[yt]),ft=0;ft<yt.length;ft++)if(mt=yt[ft],ct.kind()===mt[0].kind()&&ct.match.apply(ct,mt))return pt}return dt},_.exports?_.exports=lt:a.ipaddr=lt})(commonjsGlobal)})(ipaddr);var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(lib,"__esModule",{value:!0});const netmask_1=netmask,ip_regex_1=__importDefault(ipRegex$1),is_ip_1=__importDefault(isIp_1),ipaddr_js_1=ipaddr.exports,PRIVATE_IP_RANGES=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],NETMASK_RANGES=PRIVATE_IP_RANGES.map(_=>new netmask_1.Netmask(_));function ipv4_check(_){for(let a of NETMASK_RANGES)if(a.contains(_))return!0;return!1}function ipv6_check(_){return/^::$/.test(_)||/^::1$/.test(_)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(_)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(_)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(_)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(_)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(_)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(_)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(_)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(_)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(_)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(_)||/^ff([0-9a-fA-F]{2,2}):/i.test(_)}lib.default=_=>{if((0,ipaddr_js_1.isValid)(_)){const a=(0,ipaddr_js_1.parse)(_);if(a.kind()==="ipv4")return ipv4_check(a.toNormalizedString());if(a.kind()==="ipv6")return ipv6_check(_)}else if((0,is_ip_1.default)(_)&&ip_regex_1.default.v6().test(_))return ipv6_check(_)};var privateIp=lib.default;function isPrivate(_){const{address:a}=_.nodeAddress();return Boolean(privateIp(a))}function publicAddressesFirst(_,a){const $=isPrivate(_.multiaddr),j=isPrivate(a.multiaddr);return $&&!j?1:!$&&j||_.isCertified&&!a.isCertified?-1:!_.isCertified&&a.isCertified?1:0}const log$D=logger$1("libp2p:auto-relay"),noop=()=>{};class AutoRelay{constructor(a,$){this.components=a,this.addressSorter=$.addressSorter??publicAddressesFirst,this.maxListeners=$.maxListeners??1,this.listenRelays=new Set,this.onError=$.onError??noop,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this.components.peerStore.addEventListener("change:protocols",j=>{this._onProtocolChange(j).catch(_e=>{log$D.error(_e)})}),this.components.connectionManager.addEventListener("peer:disconnect",this._onPeerDisconnected)}async _onProtocolChange(a){const{peerId:$,protocols:j}=a.detail,_e=$.toString();if(j.find(tt=>tt===RELAY_CODEC)==null){this.listenRelays.has(_e)&&await this._removeListenRelay(_e);return}if(!this.listenRelays.has(_e))try{const tt=this.components.connectionManager.getConnections($);if(tt.length===0)return;const rt=tt[0];if(rt.remoteAddr.protoCodes().includes(CIRCUIT_PROTO_CODE)){log$D(`relayed connection to ${_e} will not be used to hop on`);return}await canHop({connection:rt})&&(await this.components.peerStore.metadataBook.setValue($,HOP_METADATA_KEY,fromString$5(HOP_METADATA_VALUE)),await this._addListenRelay(rt,_e))}catch(tt){this.onError(tt)}}_onPeerDisconnected(a){const _e=a.detail.remotePeer.toString();!this.listenRelays.has(_e)||this._removeListenRelay(_e).catch(et=>{log$D.error(et)})}async _addListenRelay(a,$){try{if(this.listenRelays.size>=this.maxListeners)return;const j=await pipe(await this.components.peerStore.addressBook.get(a.remotePeer),et=>sort(et,this.addressSorter),async et=>await all$5(et));(await Promise.all(j.map(async et=>{try{let tt=et.multiaddr;return tt.getPeerId()==null&&(tt=tt.encapsulate(`/p2p/${a.remotePeer.toString()}`)),tt=tt.encapsulate("/p2p-circuit"),await this.components.transportManager.listen([tt]),!0}catch(tt){log$D.error("error listening on circuit address",tt),this.onError(tt)}return!1}))).includes(!0)&&this.listenRelays.add($)}catch(j){this.onError(j),this.listenRelays.delete($)}}async _removeListenRelay(a){this.listenRelays.delete(a)&&await this._listenOnAvailableHopRelays([a])}async _listenOnAvailableHopRelays(a=[]){if(this.listenRelays.size>=this.maxListeners)return;const $=[],j=await this.components.peerStore.all();for(const{id:_e,metadata:et}of j){const tt=_e.toString();if(this.listenRelays.has(tt)||a.includes(tt))continue;const rt=et.get(HOP_METADATA_KEY);if(rt==null||toString$6(rt)!==HOP_METADATA_VALUE)continue;const nt=this.components.connectionManager.getConnections(_e);if(nt.length===0){$.push(_e);continue}if(await this._addListenRelay(nt[0],tt),this.listenRelays.size>=this.maxListeners)return}for(const _e of $)if(await this._tryToListenOnRelay(_e),this.listenRelays.size>=this.maxListeners)return;try{const _e=await namespaceToCid(RELAY_RENDEZVOUS_NS);for await(const et of this.components.contentRouting.findProviders(_e)){if(et.multiaddrs.length===0)continue;const tt=et.id;if(!tt.equals(this.components.peerId)&&(await this.components.peerStore.addressBook.add(tt,et.multiaddrs),await this._tryToListenOnRelay(tt),this.listenRelays.size>=this.maxListeners))return}}catch(_e){this.onError(_e)}}async _tryToListenOnRelay(a){try{const $=await this.components.connectionManager.openConnection(a);await this._addListenRelay($,a.toString())}catch($){log$D.error("Could not use %p as relay",a,$),this.onError($,`could not connect and listen on known hop relay ${a.toString()}`)}}}const log$C=logger$1("libp2p:relay");class Relay{constructor(a,$){this.components=a,this.autoRelay=$.autoRelay?.enabled!==!1?new AutoRelay(a,{addressSorter:$.addressSorter,...$.autoRelay}):void 0,this.started=!1,this.init=$,this._advertiseService=this._advertiseService.bind(this)}isStarted(){return this.started}async start(){this.init.hop.enabled!==!1&&this.init.advertise.enabled!==!1&&(this.timeout=src$1.setDelayedInterval(this._advertiseService,this.init.advertise.ttl,this.init.advertise.bootDelay)),this.started=!0}async stop(){this.timeout!=null&&src$1.clearDelayedInterval(this.timeout),this.started=!1}async _advertiseService(){try{const a=await namespaceToCid(RELAY_RENDEZVOUS_NS);await this.components.contentRouting.provide(a)}catch(a){a.code===codes$1.ERR_NO_ROUTERS_AVAILABLE?(log$C.error("a content router, such as a DHT, must be provided in order to advertise the relay service",a),await this.stop()):log$C.error(a)}}}function isHighSurrogate$1(_){return _>=55296&&_<=56319}function isLowSurrogate$1(_){return _>=56320&&_<=57343}var truncate$2=function _(a,$,j){if(typeof $!="string")throw new Error("Input must be string");for(var _e=$.length,et=0,tt,rt,nt=0;nt<_e;nt+=1){if(tt=$.charCodeAt(nt),rt=$[nt],isHighSurrogate$1(tt)&&isLowSurrogate$1($.charCodeAt(nt+1))&&(nt+=1,rt+=$[nt]),et+=a(rt),et===j)return $.slice(0,nt+1);if(et>j)return $.slice(0,nt-rt.length+1)}return $};function isHighSurrogate(_){return _>=55296&&_<=56319}function isLowSurrogate(_){return _>=56320&&_<=57343}var browser$3=function _(a){if(typeof a!="string")throw new Error("Input must be string");for(var $=a.length,j=0,_e=null,et=null,tt=0;tt<$;tt++)_e=a.charCodeAt(tt),isLowSurrogate(_e)?et!=null&&isHighSurrogate(et)?j+=1:j+=3:_e<=127?j+=1:_e>=128&&_e<=2047?j+=2:_e>=2048&&_e<=65535&&(j+=3),et=_e;return j},truncate$1=truncate$2,getLength=browser$3,browser$2=truncate$1.bind(null,getLength),truncate=browser$2,illegalRe=/[\/\?<>\\:\*\|"]/g,controlRe=/[\x00-\x1f\x80-\x9f]/g,reservedRe=/^\.+$/,windowsReservedRe=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,windowsTrailingRe=/[\. ]+$/;function sanitize(_,a){if(typeof _!="string")throw new Error("Input must be string");var $=_.replace(illegalRe,a).replace(controlRe,a).replace(reservedRe,a).replace(windowsReservedRe,a).replace(windowsTrailingRe,a);return truncate($,255)}var sanitizeFilename=function(_,a){var $=a&&a.replacement||"",j=sanitize(_,$);return $===""?j:sanitize(j,"")},forge$5=forge$s,asn1$2=forge$5.asn1,p7v=forge$5.pkcs7asn1=forge$5.pkcs7asn1||{};forge$5.pkcs7=forge$5.pkcs7||{};forge$5.pkcs7.asn1=p7v;var contentInfoValidator={name:"ContentInfo",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:asn1$2.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};p7v.contentInfoValidator=contentInfoValidator;var encryptedContentInfoValidator={name:"EncryptedContentInfo",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:asn1$2.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:asn1$2.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};p7v.envelopedDataValidator={name:"EnvelopedData",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(encryptedContentInfoValidator)};p7v.encryptedDataValidator={name:"EncryptedData",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1,capture:"version"}].concat(encryptedContentInfoValidator)};var signerValidator={name:"SignerInfo",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:asn1$2.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:asn1$2.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:asn1$2.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};p7v.signedDataValidator={name:"SignedData",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},contentInfoValidator,{name:"SignedData.Certificates",tagClass:asn1$2.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:asn1$2.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SET,capture:"signerInfos",optional:!0,value:[signerValidator]}]};p7v.recipientInfoValidator={name:"RecipientInfo",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:asn1$2.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:asn1$2.Class.UNIVERSAL,type:asn1$2.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]};var forge$4=forge$s;forge$4.mgf=forge$4.mgf||{};var mgf1=forge$4.mgf.mgf1=forge$4.mgf1=forge$4.mgf1||{};mgf1.create=function(_){var a={generate:function($,j){for(var _e=new forge$4.util.ByteBuffer,et=Math.ceil(j/_.digestLength),tt=0;tt<et;tt++){var rt=new forge$4.util.ByteBuffer;rt.putInt32(tt),_.start(),_.update($+rt.getBytes()),_e.putBuffer(_.digest())}return _e.truncate(_e.length()-j),_e.getBytes()}};return a};var forge$3=forge$s;forge$3.mgf=forge$3.mgf||{};forge$3.mgf.mgf1=forge$3.mgf1;var forge$2=forge$s,pss=forge$2.pss=forge$2.pss||{};pss.create=function(_){arguments.length===3&&(_={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var a=_.md,$=_.mgf,j=a.digestLength,_e=_.salt||null;typeof _e=="string"&&(_e=forge$2.util.createBuffer(_e));var et;if("saltLength"in _)et=_.saltLength;else if(_e!==null)et=_e.length();else throw new Error("Salt length not specified or specific salt not given.");if(_e!==null&&_e.length()!==et)throw new Error("Given salt length does not match length of given salt.");var tt=_.prng||forge$2.random,rt={};return rt.encode=function(nt,it){var st,ot=it-1,at=Math.ceil(ot/8),lt=nt.digest().getBytes();if(at<j+et+2)throw new Error("Message is too long to encrypt.");var ct;_e===null?ct=tt.getBytesSync(et):ct=_e.bytes();var ut=new forge$2.util.ByteBuffer;ut.fillWithByte(0,8),ut.putBytes(lt),ut.putBytes(ct),a.start(),a.update(ut.getBytes());var dt=a.digest().getBytes(),ft=new forge$2.util.ByteBuffer;ft.fillWithByte(0,at-et-j-2),ft.putByte(1),ft.putBytes(ct);var pt=ft.getBytes(),yt=at-j-1,mt=$.generate(dt,yt),_t="";for(st=0;st<yt;st++)_t+=String.fromCharCode(pt.charCodeAt(st)^mt.charCodeAt(st));var vt=65280>>8*at-ot&255;return _t=String.fromCharCode(_t.charCodeAt(0)&~vt)+_t.substr(1),_t+dt+String.fromCharCode(188)},rt.verify=function(nt,it,st){var ot,at=st-1,lt=Math.ceil(at/8);if(it=it.substr(-lt),lt<j+et+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(it.charCodeAt(lt-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var ct=lt-j-1,ut=it.substr(0,ct),dt=it.substr(ct,j),ft=65280>>8*lt-at&255;if((ut.charCodeAt(0)&ft)!==0)throw new Error("Bits beyond keysize not zero as expected.");var pt=$.generate(dt,ct),yt="";for(ot=0;ot<ct;ot++)yt+=String.fromCharCode(ut.charCodeAt(ot)^pt.charCodeAt(ot));yt=String.fromCharCode(yt.charCodeAt(0)&~ft)+yt.substr(1);var mt=lt-j-et-2;for(ot=0;ot<mt;ot++)if(yt.charCodeAt(ot)!==0)throw new Error("Leftmost octets not zero as expected");if(yt.charCodeAt(mt)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var _t=yt.substr(-et),vt=new forge$2.util.ByteBuffer;vt.fillWithByte(0,8),vt.putBytes(nt),vt.putBytes(_t),a.start(),a.update(vt.getBytes());var ht=a.digest().getBytes();return dt===ht},rt};var forge$1=forge$s,asn1$1=forge$1.asn1,pki$1=forge$1.pki=forge$1.pki||{},oids=pki$1.oids,_shortNames={};_shortNames.CN=oids.commonName;_shortNames.commonName="CN";_shortNames.C=oids.countryName;_shortNames.countryName="C";_shortNames.L=oids.localityName;_shortNames.localityName="L";_shortNames.ST=oids.stateOrProvinceName;_shortNames.stateOrProvinceName="ST";_shortNames.O=oids.organizationName;_shortNames.organizationName="O";_shortNames.OU=oids.organizationalUnitName;_shortNames.organizationalUnitName="OU";_shortNames.E=oids.emailAddress;_shortNames.emailAddress="E";var publicKeyValidator=forge$1.pki.rsa.publicKeyValidator,x509CertificateValidator={name:"Certificate",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:asn1$1.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},publicKeyValidator,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:asn1$1.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},rsassaPssParameterValidator={name:"rsapss",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},certificationRequestInfoValidator={name:"CertificationRequestInfo",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},publicKeyValidator,{name:"CertificationRequestInfo.attributes",tagClass:asn1$1.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SET,constructed:!0}]}]}]},certificationRequestValidator={name:"CertificationRequest",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[certificationRequestInfoValidator,{name:"CertificationRequest.signatureAlgorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:asn1$1.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};pki$1.RDNAttributesAsArray=function(_,a){for(var $=[],j,_e,et,tt=0;tt<_.value.length;++tt){j=_.value[tt];for(var rt=0;rt<j.value.length;++rt)et={},_e=j.value[rt],et.type=asn1$1.derToOid(_e.value[0].value),et.value=_e.value[1].value,et.valueTagClass=_e.value[1].type,et.type in oids&&(et.name=oids[et.type],et.name in _shortNames&&(et.shortName=_shortNames[et.name])),a&&(a.update(et.type),a.update(et.value)),$.push(et)}return $};pki$1.CRIAttributesAsArray=function(_){for(var a=[],$=0;$<_.length;++$)for(var j=_[$],_e=asn1$1.derToOid(j.value[0].value),et=j.value[1].value,tt=0;tt<et.length;++tt){var rt={};if(rt.type=_e,rt.value=et[tt].value,rt.valueTagClass=et[tt].type,rt.type in oids&&(rt.name=oids[rt.type],rt.name in _shortNames&&(rt.shortName=_shortNames[rt.name])),rt.type===oids.extensionRequest){rt.extensions=[];for(var nt=0;nt<rt.value.length;++nt)rt.extensions.push(pki$1.certificateExtensionFromAsn1(rt.value[nt]))}a.push(rt)}return a};function _getAttribute(_,a){typeof a=="string"&&(a={shortName:a});for(var $=null,j,_e=0;$===null&&_e<_.attributes.length;++_e)j=_.attributes[_e],(a.type&&a.type===j.type||a.name&&a.name===j.name||a.shortName&&a.shortName===j.shortName)&&($=j);return $}var _readSignatureParameters=function(_,a,$){var j={};if(_!==oids["RSASSA-PSS"])return j;$&&(j={hash:{algorithmOid:oids.sha1},mgf:{algorithmOid:oids.mgf1,hash:{algorithmOid:oids.sha1}},saltLength:20});var _e={},et=[];if(!asn1$1.validate(a,rsassaPssParameterValidator,_e,et)){var tt=new Error("Cannot read RSASSA-PSS parameter block.");throw tt.errors=et,tt}return _e.hashOid!==void 0&&(j.hash=j.hash||{},j.hash.algorithmOid=asn1$1.derToOid(_e.hashOid)),_e.maskGenOid!==void 0&&(j.mgf=j.mgf||{},j.mgf.algorithmOid=asn1$1.derToOid(_e.maskGenOid),j.mgf.hash=j.mgf.hash||{},j.mgf.hash.algorithmOid=asn1$1.derToOid(_e.maskGenHashOid)),_e.saltLength!==void 0&&(j.saltLength=_e.saltLength.charCodeAt(0)),j},_createSignatureDigest=function(_){switch(oids[_.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return forge$1.md.sha1.create();case"md5WithRSAEncryption":return forge$1.md.md5.create();case"sha256WithRSAEncryption":return forge$1.md.sha256.create();case"sha384WithRSAEncryption":return forge$1.md.sha384.create();case"sha512WithRSAEncryption":return forge$1.md.sha512.create();case"RSASSA-PSS":return forge$1.md.sha256.create();default:var a=new Error("Could not compute "+_.type+" digest. Unknown signature OID.");throw a.signatureOid=_.signatureOid,a}},_verifySignature=function(_){var a=_.certificate,$;switch(a.signatureOid){case oids.sha1WithRSAEncryption:case oids.sha1WithRSASignature:break;case oids["RSASSA-PSS"]:var j,_e;if(j=oids[a.signatureParameters.mgf.hash.algorithmOid],j===void 0||forge$1.md[j]===void 0){var et=new Error("Unsupported MGF hash function.");throw et.oid=a.signatureParameters.mgf.hash.algorithmOid,et.name=j,et}if(_e=oids[a.signatureParameters.mgf.algorithmOid],_e===void 0||forge$1.mgf[_e]===void 0){var et=new Error("Unsupported MGF function.");throw et.oid=a.signatureParameters.mgf.algorithmOid,et.name=_e,et}if(_e=forge$1.mgf[_e].create(forge$1.md[j].create()),j=oids[a.signatureParameters.hash.algorithmOid],j===void 0||forge$1.md[j]===void 0){var et=new Error("Unsupported RSASSA-PSS hash function.");throw et.oid=a.signatureParameters.hash.algorithmOid,et.name=j,et}$=forge$1.pss.create(forge$1.md[j].create(),_e,a.signatureParameters.saltLength);break}return a.publicKey.verify(_.md.digest().getBytes(),_.signature,$)};pki$1.certificateFromPem=function(_,a,$){var j=forge$1.pem.decode(_)[0];if(j.type!=="CERTIFICATE"&&j.type!=="X509 CERTIFICATE"&&j.type!=="TRUSTED CERTIFICATE"){var _e=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw _e.headerType=j.type,_e}if(j.procType&&j.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var et=asn1$1.fromDer(j.body,$);return pki$1.certificateFromAsn1(et,a)};pki$1.certificateToPem=function(_,a){var $={type:"CERTIFICATE",body:asn1$1.toDer(pki$1.certificateToAsn1(_)).getBytes()};return forge$1.pem.encode($,{maxline:a})};pki$1.publicKeyFromPem=function(_){var a=forge$1.pem.decode(_)[0];if(a.type!=="PUBLIC KEY"&&a.type!=="RSA PUBLIC KEY"){var $=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw $.headerType=a.type,$}if(a.procType&&a.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var j=asn1$1.fromDer(a.body);return pki$1.publicKeyFromAsn1(j)};pki$1.publicKeyToPem=function(_,a){var $={type:"PUBLIC KEY",body:asn1$1.toDer(pki$1.publicKeyToAsn1(_)).getBytes()};return forge$1.pem.encode($,{maxline:a})};pki$1.publicKeyToRSAPublicKeyPem=function(_,a){var $={type:"RSA PUBLIC KEY",body:asn1$1.toDer(pki$1.publicKeyToRSAPublicKey(_)).getBytes()};return forge$1.pem.encode($,{maxline:a})};pki$1.getPublicKeyFingerprint=function(_,a){a=a||{};var $=a.md||forge$1.md.sha1.create(),j=a.type||"RSAPublicKey",_e;switch(j){case"RSAPublicKey":_e=asn1$1.toDer(pki$1.publicKeyToRSAPublicKey(_)).getBytes();break;case"SubjectPublicKeyInfo":_e=asn1$1.toDer(pki$1.publicKeyToAsn1(_)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+a.type+'".')}$.start(),$.update(_e);var et=$.digest();if(a.encoding==="hex"){var tt=et.toHex();return a.delimiter?tt.match(/.{2}/g).join(a.delimiter):tt}else{if(a.encoding==="binary")return et.getBytes();if(a.encoding)throw new Error('Unknown encoding "'+a.encoding+'".')}return et};pki$1.certificationRequestFromPem=function(_,a,$){var j=forge$1.pem.decode(_)[0];if(j.type!=="CERTIFICATE REQUEST"){var _e=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw _e.headerType=j.type,_e}if(j.procType&&j.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var et=asn1$1.fromDer(j.body,$);return pki$1.certificationRequestFromAsn1(et,a)};pki$1.certificationRequestToPem=function(_,a){var $={type:"CERTIFICATE REQUEST",body:asn1$1.toDer(pki$1.certificationRequestToAsn1(_)).getBytes()};return forge$1.pem.encode($,{maxline:a})};pki$1.createCertificate=function(){var _={};return _.version=2,_.serialNumber="00",_.signatureOid=null,_.signature=null,_.siginfo={},_.siginfo.algorithmOid=null,_.validity={},_.validity.notBefore=new Date,_.validity.notAfter=new Date,_.issuer={},_.issuer.getField=function(a){return _getAttribute(_.issuer,a)},_.issuer.addField=function(a){_fillMissingFields([a]),_.issuer.attributes.push(a)},_.issuer.attributes=[],_.issuer.hash=null,_.subject={},_.subject.getField=function(a){return _getAttribute(_.subject,a)},_.subject.addField=function(a){_fillMissingFields([a]),_.subject.attributes.push(a)},_.subject.attributes=[],_.subject.hash=null,_.extensions=[],_.publicKey=null,_.md=null,_.setSubject=function(a,$){_fillMissingFields(a),_.subject.attributes=a,delete _.subject.uniqueId,$&&(_.subject.uniqueId=$),_.subject.hash=null},_.setIssuer=function(a,$){_fillMissingFields(a),_.issuer.attributes=a,delete _.issuer.uniqueId,$&&(_.issuer.uniqueId=$),_.issuer.hash=null},_.setExtensions=function(a){for(var $=0;$<a.length;++$)_fillMissingExtensionFields(a[$],{cert:_});_.extensions=a},_.getExtension=function(a){typeof a=="string"&&(a={name:a});for(var $=null,j,_e=0;$===null&&_e<_.extensions.length;++_e)j=_.extensions[_e],(a.id&&j.id===a.id||a.name&&j.name===a.name)&&($=j);return $},_.sign=function(a,$){_.md=$||forge$1.md.sha1.create();var j=oids[_.md.algorithm+"WithRSAEncryption"];if(!j){var _e=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw _e.algorithm=_.md.algorithm,_e}_.signatureOid=_.siginfo.algorithmOid=j,_.tbsCertificate=pki$1.getTBSCertificate(_);var et=asn1$1.toDer(_.tbsCertificate);_.md.update(et.getBytes()),_.signature=a.sign(_.md)},_.verify=function(a){var $=!1;if(!_.issued(a)){var j=a.issuer,_e=_.subject,et=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw et.expectedIssuer=_e.attributes,et.actualIssuer=j.attributes,et}var tt=a.md;if(tt===null){tt=_createSignatureDigest({signatureOid:a.signatureOid,type:"certificate"});var rt=a.tbsCertificate||pki$1.getTBSCertificate(a),nt=asn1$1.toDer(rt);tt.update(nt.getBytes())}return tt!==null&&($=_verifySignature({certificate:_,md:tt,signature:a.signature})),$},_.isIssuer=function(a){var $=!1,j=_.issuer,_e=a.subject;if(j.hash&&_e.hash)$=j.hash===_e.hash;else if(j.attributes.length===_e.attributes.length){$=!0;for(var et,tt,rt=0;$&&rt<j.attributes.length;++rt)et=j.attributes[rt],tt=_e.attributes[rt],(et.type!==tt.type||et.value!==tt.value)&&($=!1)}return $},_.issued=function(a){return a.isIssuer(_)},_.generateSubjectKeyIdentifier=function(){return pki$1.getPublicKeyFingerprint(_.publicKey,{type:"RSAPublicKey"})},_.verifySubjectKeyIdentifier=function(){for(var a=oids.subjectKeyIdentifier,$=0;$<_.extensions.length;++$){var j=_.extensions[$];if(j.id===a){var _e=_.generateSubjectKeyIdentifier().getBytes();return forge$1.util.hexToBytes(j.subjectKeyIdentifier)===_e}}return!1},_};pki$1.certificateFromAsn1=function(_,a){var $={},j=[];if(!asn1$1.validate(_,x509CertificateValidator,$,j)){var _e=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw _e.errors=j,_e}var et=asn1$1.derToOid($.publicKeyOid);if(et!==pki$1.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var tt=pki$1.createCertificate();tt.version=$.certVersion?$.certVersion.charCodeAt(0):0;var rt=forge$1.util.createBuffer($.certSerialNumber);tt.serialNumber=rt.toHex(),tt.signatureOid=forge$1.asn1.derToOid($.certSignatureOid),tt.signatureParameters=_readSignatureParameters(tt.signatureOid,$.certSignatureParams,!0),tt.siginfo.algorithmOid=forge$1.asn1.derToOid($.certinfoSignatureOid),tt.siginfo.parameters=_readSignatureParameters(tt.siginfo.algorithmOid,$.certinfoSignatureParams,!1),tt.signature=$.certSignature;var nt=[];if($.certValidity1UTCTime!==void 0&&nt.push(asn1$1.utcTimeToDate($.certValidity1UTCTime)),$.certValidity2GeneralizedTime!==void 0&&nt.push(asn1$1.generalizedTimeToDate($.certValidity2GeneralizedTime)),$.certValidity3UTCTime!==void 0&&nt.push(asn1$1.utcTimeToDate($.certValidity3UTCTime)),$.certValidity4GeneralizedTime!==void 0&&nt.push(asn1$1.generalizedTimeToDate($.certValidity4GeneralizedTime)),nt.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(nt.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(tt.validity.notBefore=nt[0],tt.validity.notAfter=nt[1],tt.tbsCertificate=$.tbsCertificate,a){tt.md=_createSignatureDigest({signatureOid:tt.signatureOid,type:"certificate"});var it=asn1$1.toDer(tt.tbsCertificate);tt.md.update(it.getBytes())}var st=forge$1.md.sha1.create(),ot=asn1$1.toDer($.certIssuer);st.update(ot.getBytes()),tt.issuer.getField=function(ct){return _getAttribute(tt.issuer,ct)},tt.issuer.addField=function(ct){_fillMissingFields([ct]),tt.issuer.attributes.push(ct)},tt.issuer.attributes=pki$1.RDNAttributesAsArray($.certIssuer),$.certIssuerUniqueId&&(tt.issuer.uniqueId=$.certIssuerUniqueId),tt.issuer.hash=st.digest().toHex();var at=forge$1.md.sha1.create(),lt=asn1$1.toDer($.certSubject);return at.update(lt.getBytes()),tt.subject.getField=function(ct){return _getAttribute(tt.subject,ct)},tt.subject.addField=function(ct){_fillMissingFields([ct]),tt.subject.attributes.push(ct)},tt.subject.attributes=pki$1.RDNAttributesAsArray($.certSubject),$.certSubjectUniqueId&&(tt.subject.uniqueId=$.certSubjectUniqueId),tt.subject.hash=at.digest().toHex(),$.certExtensions?tt.extensions=pki$1.certificateExtensionsFromAsn1($.certExtensions):tt.extensions=[],tt.publicKey=pki$1.publicKeyFromAsn1($.subjectPublicKeyInfo),tt};pki$1.certificateExtensionsFromAsn1=function(_){for(var a=[],$=0;$<_.value.length;++$)for(var j=_.value[$],_e=0;_e<j.value.length;++_e)a.push(pki$1.certificateExtensionFromAsn1(j.value[_e]));return a};pki$1.certificateExtensionFromAsn1=function(_){var a={};if(a.id=asn1$1.derToOid(_.value[0].value),a.critical=!1,_.value[1].type===asn1$1.Type.BOOLEAN?(a.critical=_.value[1].value.charCodeAt(0)!==0,a.value=_.value[2].value):a.value=_.value[1].value,a.id in oids){if(a.name=oids[a.id],a.name==="keyUsage"){var $=asn1$1.fromDer(a.value),j=0,_e=0;$.value.length>1&&(j=$.value.charCodeAt(1),_e=$.value.length>2?$.value.charCodeAt(2):0),a.digitalSignature=(j&128)===128,a.nonRepudiation=(j&64)===64,a.keyEncipherment=(j&32)===32,a.dataEncipherment=(j&16)===16,a.keyAgreement=(j&8)===8,a.keyCertSign=(j&4)===4,a.cRLSign=(j&2)===2,a.encipherOnly=(j&1)===1,a.decipherOnly=(_e&128)===128}else if(a.name==="basicConstraints"){var $=asn1$1.fromDer(a.value);$.value.length>0&&$.value[0].type===asn1$1.Type.BOOLEAN?a.cA=$.value[0].value.charCodeAt(0)!==0:a.cA=!1;var et=null;$.value.length>0&&$.value[0].type===asn1$1.Type.INTEGER?et=$.value[0].value:$.value.length>1&&(et=$.value[1].value),et!==null&&(a.pathLenConstraint=asn1$1.derToInteger(et))}else if(a.name==="extKeyUsage")for(var $=asn1$1.fromDer(a.value),tt=0;tt<$.value.length;++tt){var rt=asn1$1.derToOid($.value[tt].value);rt in oids?a[oids[rt]]=!0:a[rt]=!0}else if(a.name==="nsCertType"){var $=asn1$1.fromDer(a.value),j=0;$.value.length>1&&(j=$.value.charCodeAt(1)),a.client=(j&128)===128,a.server=(j&64)===64,a.email=(j&32)===32,a.objsign=(j&16)===16,a.reserved=(j&8)===8,a.sslCA=(j&4)===4,a.emailCA=(j&2)===2,a.objCA=(j&1)===1}else if(a.name==="subjectAltName"||a.name==="issuerAltName"){a.altNames=[];for(var nt,$=asn1$1.fromDer(a.value),it=0;it<$.value.length;++it){nt=$.value[it];var st={type:nt.type,value:nt.value};switch(a.altNames.push(st),nt.type){case 1:case 2:case 6:break;case 7:st.ip=forge$1.util.bytesToIP(nt.value);break;case 8:st.oid=asn1$1.derToOid(nt.value);break}}}else if(a.name==="subjectKeyIdentifier"){var $=asn1$1.fromDer(a.value);a.subjectKeyIdentifier=forge$1.util.bytesToHex($.value)}}return a};pki$1.certificationRequestFromAsn1=function(_,a){var $={},j=[];if(!asn1$1.validate(_,certificationRequestValidator,$,j)){var _e=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw _e.errors=j,_e}var et=asn1$1.derToOid($.publicKeyOid);if(et!==pki$1.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var tt=pki$1.createCertificationRequest();if(tt.version=$.csrVersion?$.csrVersion.charCodeAt(0):0,tt.signatureOid=forge$1.asn1.derToOid($.csrSignatureOid),tt.signatureParameters=_readSignatureParameters(tt.signatureOid,$.csrSignatureParams,!0),tt.siginfo.algorithmOid=forge$1.asn1.derToOid($.csrSignatureOid),tt.siginfo.parameters=_readSignatureParameters(tt.siginfo.algorithmOid,$.csrSignatureParams,!1),tt.signature=$.csrSignature,tt.certificationRequestInfo=$.certificationRequestInfo,a){tt.md=_createSignatureDigest({signatureOid:tt.signatureOid,type:"certification request"});var rt=asn1$1.toDer(tt.certificationRequestInfo);tt.md.update(rt.getBytes())}var nt=forge$1.md.sha1.create();return tt.subject.getField=function(it){return _getAttribute(tt.subject,it)},tt.subject.addField=function(it){_fillMissingFields([it]),tt.subject.attributes.push(it)},tt.subject.attributes=pki$1.RDNAttributesAsArray($.certificationRequestInfoSubject,nt),tt.subject.hash=nt.digest().toHex(),tt.publicKey=pki$1.publicKeyFromAsn1($.subjectPublicKeyInfo),tt.getAttribute=function(it){return _getAttribute(tt,it)},tt.addAttribute=function(it){_fillMissingFields([it]),tt.attributes.push(it)},tt.attributes=pki$1.CRIAttributesAsArray($.certificationRequestInfoAttributes||[]),tt};pki$1.createCertificationRequest=function(){var _={};return _.version=0,_.signatureOid=null,_.signature=null,_.siginfo={},_.siginfo.algorithmOid=null,_.subject={},_.subject.getField=function(a){return _getAttribute(_.subject,a)},_.subject.addField=function(a){_fillMissingFields([a]),_.subject.attributes.push(a)},_.subject.attributes=[],_.subject.hash=null,_.publicKey=null,_.attributes=[],_.getAttribute=function(a){return _getAttribute(_,a)},_.addAttribute=function(a){_fillMissingFields([a]),_.attributes.push(a)},_.md=null,_.setSubject=function(a){_fillMissingFields(a),_.subject.attributes=a,_.subject.hash=null},_.setAttributes=function(a){_fillMissingFields(a),_.attributes=a},_.sign=function(a,$){_.md=$||forge$1.md.sha1.create();var j=oids[_.md.algorithm+"WithRSAEncryption"];if(!j){var _e=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw _e.algorithm=_.md.algorithm,_e}_.signatureOid=_.siginfo.algorithmOid=j,_.certificationRequestInfo=pki$1.getCertificationRequestInfo(_);var et=asn1$1.toDer(_.certificationRequestInfo);_.md.update(et.getBytes()),_.signature=a.sign(_.md)},_.verify=function(){var a=!1,$=_.md;if($===null){$=_createSignatureDigest({signatureOid:_.signatureOid,type:"certification request"});var j=_.certificationRequestInfo||pki$1.getCertificationRequestInfo(_),_e=asn1$1.toDer(j);$.update(_e.getBytes())}return $!==null&&(a=_verifySignature({certificate:_,md:$,signature:_.signature})),a},_};function _dnToAsn1(_){for(var a=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]),$,j,_e=_.attributes,et=0;et<_e.length;++et){$=_e[et];var tt=$.value,rt=asn1$1.Type.PRINTABLESTRING;"valueTagClass"in $&&(rt=$.valueTagClass,rt===asn1$1.Type.UTF8&&(tt=forge$1.util.encodeUtf8(tt))),j=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SET,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer($.type).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,rt,!1,tt)])]),a.value.push(j)}return a}function _fillMissingFields(_){for(var a,$=0;$<_.length;++$){if(a=_[$],typeof a.name>"u"&&(a.type&&a.type in pki$1.oids?a.name=pki$1.oids[a.type]:a.shortName&&a.shortName in _shortNames&&(a.name=pki$1.oids[_shortNames[a.shortName]])),typeof a.type>"u")if(a.name&&a.name in pki$1.oids)a.type=pki$1.oids[a.name];else{var j=new Error("Attribute type not specified.");throw j.attribute=a,j}if(typeof a.shortName>"u"&&a.name&&a.name in _shortNames&&(a.shortName=_shortNames[a.name]),a.type===oids.extensionRequest&&(a.valueConstructed=!0,a.valueTagClass=asn1$1.Type.SEQUENCE,!a.value&&a.extensions)){a.value=[];for(var _e=0;_e<a.extensions.length;++_e)a.value.push(pki$1.certificateExtensionToAsn1(_fillMissingExtensionFields(a.extensions[_e])))}if(typeof a.value>"u"){var j=new Error("Attribute value not specified.");throw j.attribute=a,j}}}function _fillMissingExtensionFields(_,a){if(a=a||{},typeof _.name>"u"&&_.id&&_.id in pki$1.oids&&(_.name=pki$1.oids[_.id]),typeof _.id>"u")if(_.name&&_.name in pki$1.oids)_.id=pki$1.oids[_.name];else{var $=new Error("Extension ID not specified.");throw $.extension=_,$}if(typeof _.value<"u")return _;if(_.name==="keyUsage"){var j=0,_e=0,et=0;_.digitalSignature&&(_e|=128,j=7),_.nonRepudiation&&(_e|=64,j=6),_.keyEncipherment&&(_e|=32,j=5),_.dataEncipherment&&(_e|=16,j=4),_.keyAgreement&&(_e|=8,j=3),_.keyCertSign&&(_e|=4,j=2),_.cRLSign&&(_e|=2,j=1),_.encipherOnly&&(_e|=1,j=0),_.decipherOnly&&(et|=128,j=7);var tt=String.fromCharCode(j);et!==0?tt+=String.fromCharCode(_e)+String.fromCharCode(et):_e!==0&&(tt+=String.fromCharCode(_e)),_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,tt)}else if(_.name==="basicConstraints")_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]),_.cA&&_.value.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in _&&_.value.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,asn1$1.integerToDer(_.pathLenConstraint).getBytes()));else if(_.name==="extKeyUsage"){_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);var rt=_.value.value;for(var nt in _)_[nt]===!0&&(nt in oids?rt.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(oids[nt]).getBytes())):nt.indexOf(".")!==-1&&rt.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(nt).getBytes())))}else if(_.name==="nsCertType"){var j=0,_e=0;_.client&&(_e|=128,j=7),_.server&&(_e|=64,j=6),_.email&&(_e|=32,j=5),_.objsign&&(_e|=16,j=4),_.reserved&&(_e|=8,j=3),_.sslCA&&(_e|=4,j=2),_.emailCA&&(_e|=2,j=1),_.objCA&&(_e|=1,j=0);var tt=String.fromCharCode(j);_e!==0&&(tt+=String.fromCharCode(_e)),_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,tt)}else if(_.name==="subjectAltName"||_.name==="issuerAltName"){_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);for(var it,st=0;st<_.altNames.length;++st){it=_.altNames[st];var tt=it.value;if(it.type===7&&it.ip){if(tt=forge$1.util.bytesFromIP(it.ip),tt===null){var $=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw $.extension=_,$}}else it.type===8&&(it.oid?tt=asn1$1.oidToDer(asn1$1.oidToDer(it.oid)):tt=asn1$1.oidToDer(tt));_.value.value.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,it.type,!1,tt))}}else if(_.name==="nsComment"&&a.cert){if(!/^[\x00-\x7F]*$/.test(_.comment)||_.comment.length<1||_.comment.length>128)throw new Error('Invalid "nsComment" content.');_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.IA5STRING,!1,_.comment)}else if(_.name==="subjectKeyIdentifier"&&a.cert){var ot=a.cert.generateSubjectKeyIdentifier();_.subjectKeyIdentifier=ot.toHex(),_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OCTETSTRING,!1,ot.getBytes())}else if(_.name==="authorityKeyIdentifier"&&a.cert){_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);var rt=_.value.value;if(_.keyIdentifier){var at=_.keyIdentifier===!0?a.cert.generateSubjectKeyIdentifier().getBytes():_.keyIdentifier;rt.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,0,!1,at))}if(_.authorityCertIssuer){var lt=[asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,4,!0,[_dnToAsn1(_.authorityCertIssuer===!0?a.cert.issuer:_.authorityCertIssuer)])];rt.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,1,!0,lt))}if(_.serialNumber){var ct=forge$1.util.hexToBytes(_.serialNumber===!0?a.cert.serialNumber:_.serialNumber);rt.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,2,!1,ct))}}else if(_.name==="cRLDistributionPoints"){_.value=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);for(var rt=_.value.value,ut=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]),dt=asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,0,!0,[]),it,st=0;st<_.altNames.length;++st){it=_.altNames[st];var tt=it.value;if(it.type===7&&it.ip){if(tt=forge$1.util.bytesFromIP(it.ip),tt===null){var $=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw $.extension=_,$}}else it.type===8&&(it.oid?tt=asn1$1.oidToDer(asn1$1.oidToDer(it.oid)):tt=asn1$1.oidToDer(tt));dt.value.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,it.type,!1,tt))}ut.value.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,0,!0,[dt])),rt.push(ut)}if(typeof _.value>"u"){var $=new Error("Extension value not specified.");throw $.extension=_,$}return _}function _signatureParametersToAsn1(_,a){switch(_){case oids["RSASSA-PSS"]:var $=[];return a.hash.algorithmOid!==void 0&&$.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,0,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(a.hash.algorithmOid).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.NULL,!1,"")])])),a.mgf.algorithmOid!==void 0&&$.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,1,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(a.mgf.algorithmOid).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(a.mgf.hash.algorithmOid).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.NULL,!1,"")])])])),a.saltLength!==void 0&&$.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,2,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,asn1$1.integerToDer(a.saltLength).getBytes())])),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,$);default:return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.NULL,!1,"")}}function _CRIAttributesToAsn1(_){var a=asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,0,!0,[]);if(_.attributes.length===0)return a;for(var $=_.attributes,j=0;j<$.length;++j){var _e=$[j],et=_e.value,tt=asn1$1.Type.UTF8;"valueTagClass"in _e&&(tt=_e.valueTagClass),tt===asn1$1.Type.UTF8&&(et=forge$1.util.encodeUtf8(et));var rt=!1;"valueConstructed"in _e&&(rt=_e.valueConstructed);var nt=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(_e.type).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SET,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,tt,rt,et)])]);a.value.push(nt)}return a}var jan_1_1950=new Date("1950-01-01T00:00:00Z"),jan_1_2050=new Date("2050-01-01T00:00:00Z");function _dateToAsn1(_){return _>=jan_1_1950&&_<jan_1_2050?asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.UTCTIME,!1,asn1$1.dateToUtcTime(_)):asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.GENERALIZEDTIME,!1,asn1$1.dateToGeneralizedTime(_))}pki$1.getTBSCertificate=function(_){var a=_dateToAsn1(_.validity.notBefore),$=_dateToAsn1(_.validity.notAfter),j=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,0,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,asn1$1.integerToDer(_.version).getBytes())]),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,forge$1.util.hexToBytes(_.serialNumber)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(_.siginfo.algorithmOid).getBytes()),_signatureParametersToAsn1(_.siginfo.algorithmOid,_.siginfo.parameters)]),_dnToAsn1(_.issuer),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[a,$]),_dnToAsn1(_.subject),pki$1.publicKeyToAsn1(_.publicKey)]);return _.issuer.uniqueId&&j.value.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,1,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,String.fromCharCode(0)+_.issuer.uniqueId)])),_.subject.uniqueId&&j.value.push(asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,2,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,String.fromCharCode(0)+_.subject.uniqueId)])),_.extensions.length>0&&j.value.push(pki$1.certificateExtensionsToAsn1(_.extensions)),j};pki$1.getCertificationRequestInfo=function(_){var a=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,asn1$1.integerToDer(_.version).getBytes()),_dnToAsn1(_.subject),pki$1.publicKeyToAsn1(_.publicKey),_CRIAttributesToAsn1(_)]);return a};pki$1.distinguishedNameToAsn1=function(_){return _dnToAsn1(_)};pki$1.certificateToAsn1=function(_){var a=_.tbsCertificate||pki$1.getTBSCertificate(_);return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[a,asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(_.signatureOid).getBytes()),_signatureParametersToAsn1(_.signatureOid,_.signatureParameters)]),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,String.fromCharCode(0)+_.signature)])};pki$1.certificateExtensionsToAsn1=function(_){var a=asn1$1.create(asn1$1.Class.CONTEXT_SPECIFIC,3,!0,[]),$=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);a.value.push($);for(var j=0;j<_.length;++j)$.value.push(pki$1.certificateExtensionToAsn1(_[j]));return a};pki$1.certificateExtensionToAsn1=function(_){var a=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);a.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(_.id).getBytes())),_.critical&&a.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BOOLEAN,!1,String.fromCharCode(255)));var $=_.value;return typeof _.value!="string"&&($=asn1$1.toDer($).getBytes()),a.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OCTETSTRING,!1,$)),a};pki$1.certificationRequestToAsn1=function(_){var a=_.certificationRequestInfo||pki$1.getCertificationRequestInfo(_);return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[a,asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(_.signatureOid).getBytes()),_signatureParametersToAsn1(_.signatureOid,_.signatureParameters)]),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,String.fromCharCode(0)+_.signature)])};pki$1.createCaStore=function(_){var a={certs:{}};a.getIssuer=function(tt){var rt=$(tt.issuer);return rt},a.addCertificate=function(tt){if(typeof tt=="string"&&(tt=forge$1.pki.certificateFromPem(tt)),j(tt.subject),!a.hasCertificate(tt))if(tt.subject.hash in a.certs){var rt=a.certs[tt.subject.hash];forge$1.util.isArray(rt)||(rt=[rt]),rt.push(tt),a.certs[tt.subject.hash]=rt}else a.certs[tt.subject.hash]=tt},a.hasCertificate=function(tt){typeof tt=="string"&&(tt=forge$1.pki.certificateFromPem(tt));var rt=$(tt.subject);if(!rt)return!1;forge$1.util.isArray(rt)||(rt=[rt]);for(var nt=asn1$1.toDer(pki$1.certificateToAsn1(tt)).getBytes(),it=0;it<rt.length;++it){var st=asn1$1.toDer(pki$1.certificateToAsn1(rt[it])).getBytes();if(nt===st)return!0}return!1},a.listAllCertificates=function(){var tt=[];for(var rt in a.certs)if(a.certs.hasOwnProperty(rt)){var nt=a.certs[rt];if(!forge$1.util.isArray(nt))tt.push(nt);else for(var it=0;it<nt.length;++it)tt.push(nt[it])}return tt},a.removeCertificate=function(tt){var rt;if(typeof tt=="string"&&(tt=forge$1.pki.certificateFromPem(tt)),j(tt.subject),!a.hasCertificate(tt))return null;var nt=$(tt.subject);if(!forge$1.util.isArray(nt))return rt=a.certs[tt.subject.hash],delete a.certs[tt.subject.hash],rt;for(var it=asn1$1.toDer(pki$1.certificateToAsn1(tt)).getBytes(),st=0;st<nt.length;++st){var ot=asn1$1.toDer(pki$1.certificateToAsn1(nt[st])).getBytes();it===ot&&(rt=nt[st],nt.splice(st,1))}return nt.length===0&&delete a.certs[tt.subject.hash],rt};function $(tt){return j(tt),a.certs[tt.hash]||null}function j(tt){if(!tt.hash){var rt=forge$1.md.sha1.create();tt.attributes=pki$1.RDNAttributesAsArray(_dnToAsn1(tt),rt),tt.hash=rt.digest().toHex()}}if(_)for(var _e=0;_e<_.length;++_e){var et=_[_e];a.addCertificate(et)}return a};pki$1.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};pki$1.verifyCertificateChain=function(_,a,$){typeof $=="function"&&($={verify:$}),$=$||{},a=a.slice(0);var j=a.slice(0),_e=$.validityCheckDate;typeof _e>"u"&&(_e=new Date);var et=!0,tt=null,rt=0;do{var nt=a.shift(),it=null,st=!1;if(_e&&(_e<nt.validity.notBefore||_e>nt.validity.notAfter)&&(tt={message:"Certificate is not valid yet or has expired.",error:pki$1.certificateError.certificate_expired,notBefore:nt.validity.notBefore,notAfter:nt.validity.notAfter,now:_e}),tt===null){if(it=a[0]||_.getIssuer(nt),it===null&&nt.isIssuer(nt)&&(st=!0,it=nt),it){var ot=it;forge$1.util.isArray(ot)||(ot=[ot]);for(var at=!1;!at&&ot.length>0;){it=ot.shift();try{at=it.verify(nt)}catch{}}at||(tt={message:"Certificate signature is invalid.",error:pki$1.certificateError.bad_certificate})}tt===null&&(!it||st)&&!_.hasCertificate(nt)&&(tt={message:"Certificate is not trusted.",error:pki$1.certificateError.unknown_ca})}if(tt===null&&it&&!nt.isIssuer(it)&&(tt={message:"Certificate issuer is invalid.",error:pki$1.certificateError.bad_certificate}),tt===null)for(var lt={keyUsage:!0,basicConstraints:!0},ct=0;tt===null&&ct<nt.extensions.length;++ct){var ut=nt.extensions[ct];ut.critical&&!(ut.name in lt)&&(tt={message:"Certificate has an unsupported critical extension.",error:pki$1.certificateError.unsupported_certificate})}if(tt===null&&(!et||a.length===0&&(!it||st))){var dt=nt.getExtension("basicConstraints"),ft=nt.getExtension("keyUsage");if(ft!==null&&(!ft.keyCertSign||dt===null)&&(tt={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:pki$1.certificateError.bad_certificate}),tt===null&&dt!==null&&!dt.cA&&(tt={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:pki$1.certificateError.bad_certificate}),tt===null&&ft!==null&&"pathLenConstraint"in dt){var pt=rt-1;pt>dt.pathLenConstraint&&(tt={message:"Certificate basicConstraints pathLenConstraint violated.",error:pki$1.certificateError.bad_certificate})}}var yt=tt===null?!0:tt.error,mt=$.verify?$.verify(yt,rt,j):yt;if(mt===!0)tt=null;else throw yt===!0&&(tt={message:"The application rejected the certificate.",error:pki$1.certificateError.bad_certificate}),(mt||mt===0)&&(typeof mt=="object"&&!forge$1.util.isArray(mt)?(mt.message&&(tt.message=mt.message),mt.error&&(tt.error=mt.error)):typeof mt=="string"&&(tt.error=mt)),tt;et=!1,++rt}while(a.length>0);return!0};var forge=forge$s,asn1=forge.asn1,p7=forge.pkcs7=forge.pkcs7||{};p7.messageFromPem=function(_){var a=forge.pem.decode(_)[0];if(a.type!=="PKCS7"){var $=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw $.headerType=a.type,$}if(a.procType&&a.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var j=asn1.fromDer(a.body);return p7.messageFromAsn1(j)};p7.messageToPem=function(_,a){var $={type:"PKCS7",body:asn1.toDer(_.toAsn1()).getBytes()};return forge.pem.encode($,{maxline:a})};p7.messageFromAsn1=function(_){var a={},$=[];if(!asn1.validate(_,p7.asn1.contentInfoValidator,a,$)){var j=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw j.errors=$,j}var _e=asn1.derToOid(a.contentType),et;switch(_e){case forge.pki.oids.envelopedData:et=p7.createEnvelopedData();break;case forge.pki.oids.encryptedData:et=p7.createEncryptedData();break;case forge.pki.oids.signedData:et=p7.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+_e+" is not (yet) supported.")}return et.fromAsn1(a.content.value[0]),et};p7.createSignedData=function(){var _=null;return _={type:forge.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(j){if(_fromAsn1(_,j,p7.asn1.signedDataValidator),_.certificates=[],_.crls=[],_.digestAlgorithmIdentifiers=[],_.contentInfo=null,_.signerInfos=[],_.rawCapture.certificates)for(var _e=_.rawCapture.certificates.value,et=0;et<_e.length;++et)_.certificates.push(forge.pki.certificateFromAsn1(_e[et]))},toAsn1:function(){_.contentInfo||_.sign();for(var j=[],_e=0;_e<_.certificates.length;++_e)j.push(forge.pki.certificateToAsn1(_.certificates[_e]));var et=[],tt=asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(_.version).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,_.digestAlgorithmIdentifiers),_.contentInfo])]);return j.length>0&&tt.value[0].value.push(asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,j)),et.length>0&&tt.value[0].value.push(asn1.create(asn1.Class.CONTEXT_SPECIFIC,1,!0,et)),tt.value[0].value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,_.signerInfos)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.type).getBytes()),tt])},addSigner:function(j){var _e=j.issuer,et=j.serialNumber;if(j.certificate){var tt=j.certificate;typeof tt=="string"&&(tt=forge.pki.certificateFromPem(tt)),_e=tt.issuer.attributes,et=tt.serialNumber}var rt=j.key;if(!rt)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof rt=="string"&&(rt=forge.pki.privateKeyFromPem(rt));var nt=j.digestAlgorithm||forge.pki.oids.sha1;switch(nt){case forge.pki.oids.sha1:case forge.pki.oids.sha256:case forge.pki.oids.sha384:case forge.pki.oids.sha512:case forge.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+nt)}var it=j.authenticatedAttributes||[];if(it.length>0){for(var st=!1,ot=!1,at=0;at<it.length;++at){var lt=it[at];if(!st&&lt.type===forge.pki.oids.contentType){if(st=!0,ot)break;continue}if(!ot&&lt.type===forge.pki.oids.messageDigest){if(ot=!0,st)break;continue}}if(!st||!ot)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}_.signers.push({key:rt,version:1,issuer:_e,serialNumber:et,digestAlgorithm:nt,signatureAlgorithm:forge.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:it,unauthenticatedAttributes:[]})},sign:function(j){if(j=j||{},(typeof _.content!="object"||_.contentInfo===null)&&(_.contentInfo=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(forge.pki.oids.data).getBytes())]),"content"in _)){var _e;_.content instanceof forge.util.ByteBuffer?_e=_.content.bytes():typeof _.content=="string"&&(_e=forge.util.encodeUtf8(_.content)),j.detached?_.detachedContent=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,_e):_.contentInfo.value.push(asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,_e)]))}if(_.signers.length!==0){var et=a();$(et)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(j){typeof j=="string"&&(j=forge.pki.certificateFromPem(j)),_.certificates.push(j)},addCertificateRevokationList:function(j){throw new Error("PKCS#7 CRL support not yet implemented.")}},_;function a(){for(var j={},_e=0;_e<_.signers.length;++_e){var et=_.signers[_e],tt=et.digestAlgorithm;tt in j||(j[tt]=forge.md[forge.pki.oids[tt]].create()),et.authenticatedAttributes.length===0?et.md=j[tt]:et.md=forge.md[forge.pki.oids[tt]].create()}_.digestAlgorithmIdentifiers=[];for(var tt in j)_.digestAlgorithmIdentifiers.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(tt).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")]));return j}function $(j){var _e;if(_.detachedContent?_e=_.detachedContent:(_e=_.contentInfo.value[1],_e=_e.value[0]),!_e)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var et=asn1.derToOid(_.contentInfo.value[0].value),tt=asn1.toDer(_e);tt.getByte(),asn1.getBerValueLength(tt),tt=tt.getBytes();for(var rt in j)j[rt].start().update(tt);for(var nt=new Date,it=0;it<_.signers.length;++it){var st=_.signers[it];if(st.authenticatedAttributes.length===0){if(et!==forge.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{st.authenticatedAttributesAsn1=asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var ot=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,[]),at=0;at<st.authenticatedAttributes.length;++at){var lt=st.authenticatedAttributes[at];lt.type===forge.pki.oids.messageDigest?lt.value=j[st.digestAlgorithm].digest():lt.type===forge.pki.oids.signingTime&&(lt.value||(lt.value=nt)),ot.value.push(_attributeToAsn1(lt)),st.authenticatedAttributesAsn1.value.push(_attributeToAsn1(lt))}tt=asn1.toDer(ot).getBytes(),st.md.start().update(tt)}st.signature=st.key.sign(st.md,"RSASSA-PKCS1-V1_5")}_.signerInfos=_signersToAsn1(_.signers)}};p7.createEncryptedData=function(){var _=null;return _={type:forge.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:forge.pki.oids["aes256-CBC"]},fromAsn1:function(a){_fromAsn1(_,a,p7.asn1.encryptedDataValidator)},decrypt:function(a){a!==void 0&&(_.encryptedContent.key=a),_decryptContent(_)}},_};p7.createEnvelopedData=function(){var _=null;return _={type:forge.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:forge.pki.oids["aes256-CBC"]},fromAsn1:function(a){var $=_fromAsn1(_,a,p7.asn1.envelopedDataValidator);_.recipients=_recipientsFromAsn1($.recipientInfos.value)},toAsn1:function(){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.type).getBytes()),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(_.version).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,_recipientsToAsn1(_.recipients)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,_encryptedContentToAsn1(_.encryptedContent))])])])},findRecipient:function(a){for(var $=a.issuer.attributes,j=0;j<_.recipients.length;++j){var _e=_.recipients[j],et=_e.issuer;if(_e.serialNumber===a.serialNumber&&et.length===$.length){for(var tt=!0,rt=0;rt<$.length;++rt)if(et[rt].type!==$[rt].type||et[rt].value!==$[rt].value){tt=!1;break}if(tt)return _e}}return null},decrypt:function(a,$){if(_.encryptedContent.key===void 0&&a!==void 0&&$!==void 0)switch(a.encryptedContent.algorithm){case forge.pki.oids.rsaEncryption:case forge.pki.oids.desCBC:var j=$.decrypt(a.encryptedContent.content);_.encryptedContent.key=forge.util.createBuffer(j);break;default:throw new Error("Unsupported asymmetric cipher, OID "+a.encryptedContent.algorithm)}_decryptContent(_)},addRecipient:function(a){_.recipients.push({version:0,issuer:a.issuer.attributes,serialNumber:a.serialNumber,encryptedContent:{algorithm:forge.pki.oids.rsaEncryption,key:a.publicKey}})},encrypt:function(a,$){if(_.encryptedContent.content===void 0){$=$||_.encryptedContent.algorithm,a=a||_.encryptedContent.key;var j,_e,et;switch($){case forge.pki.oids["aes128-CBC"]:j=16,_e=16,et=forge.aes.createEncryptionCipher;break;case forge.pki.oids["aes192-CBC"]:j=24,_e=16,et=forge.aes.createEncryptionCipher;break;case forge.pki.oids["aes256-CBC"]:j=32,_e=16,et=forge.aes.createEncryptionCipher;break;case forge.pki.oids["des-EDE3-CBC"]:j=24,_e=8,et=forge.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+$)}if(a===void 0)a=forge.util.createBuffer(forge.random.getBytes(j));else if(a.length()!=j)throw new Error("Symmetric key has wrong length; got "+a.length()+" bytes, expected "+j+".");_.encryptedContent.algorithm=$,_.encryptedContent.key=a,_.encryptedContent.parameter=forge.util.createBuffer(forge.random.getBytes(_e));var tt=et(a);if(tt.start(_.encryptedContent.parameter.copy()),tt.update(_.content),!tt.finish())throw new Error("Symmetric encryption failed.");_.encryptedContent.content=tt.output}for(var rt=0;rt<_.recipients.length;++rt){var nt=_.recipients[rt];if(nt.encryptedContent.content===void 0)switch(nt.encryptedContent.algorithm){case forge.pki.oids.rsaEncryption:nt.encryptedContent.content=nt.encryptedContent.key.encrypt(_.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+nt.encryptedContent.algorithm)}}}},_};function _recipientFromAsn1(_){var a={},$=[];if(!asn1.validate(_,p7.asn1.recipientInfoValidator,a,$)){var j=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw j.errors=$,j}return{version:a.version.charCodeAt(0),issuer:forge.pki.RDNAttributesAsArray(a.issuer),serialNumber:forge.util.createBuffer(a.serial).toHex(),encryptedContent:{algorithm:asn1.derToOid(a.encAlgorithm),parameter:a.encParameter?a.encParameter.value:void 0,content:a.encKey}}}function _recipientToAsn1(_){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(_.version).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[forge.pki.distinguishedNameToAsn1({attributes:_.issuer}),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,forge.util.hexToBytes(_.serialNumber))]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.encryptedContent.algorithm).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,_.encryptedContent.content)])}function _recipientsFromAsn1(_){for(var a=[],$=0;$<_.length;++$)a.push(_recipientFromAsn1(_[$]));return a}function _recipientsToAsn1(_){for(var a=[],$=0;$<_.length;++$)a.push(_recipientToAsn1(_[$]));return a}function _signerToAsn1(_){var a=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(_.version).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[forge.pki.distinguishedNameToAsn1({attributes:_.issuer}),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,forge.util.hexToBytes(_.serialNumber))]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.digestAlgorithm).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")])]);if(_.authenticatedAttributesAsn1&&a.value.push(_.authenticatedAttributesAsn1),a.value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.signatureAlgorithm).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")])),a.value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,_.signature)),_.unauthenticatedAttributes.length>0){for(var $=asn1.create(asn1.Class.CONTEXT_SPECIFIC,1,!0,[]),j=0;j<_.unauthenticatedAttributes.length;++j){var _e=_.unauthenticatedAttributes[j];$.values.push(_attributeToAsn1(_e))}a.value.push($)}return a}function _signersToAsn1(_){for(var a=[],$=0;$<_.length;++$)a.push(_signerToAsn1(_[$]));return a}function _attributeToAsn1(_){var a;if(_.type===forge.pki.oids.contentType)a=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.value).getBytes());else if(_.type===forge.pki.oids.messageDigest)a=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,_.value.bytes());else if(_.type===forge.pki.oids.signingTime){var $=new Date("1950-01-01T00:00:00Z"),j=new Date("2050-01-01T00:00:00Z"),_e=_.value;if(typeof _e=="string"){var et=Date.parse(_e);isNaN(et)?_e.length===13?_e=asn1.utcTimeToDate(_e):_e=asn1.generalizedTimeToDate(_e):_e=new Date(et)}_e>=$&&_e<j?a=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.UTCTIME,!1,asn1.dateToUtcTime(_e)):a=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.GENERALIZEDTIME,!1,asn1.dateToGeneralizedTime(_e))}return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.type).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,[a])])}function _encryptedContentToAsn1(_){return[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(forge.pki.oids.data).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(_.algorithm).getBytes()),_.parameter?asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,_.parameter.getBytes()):void 0]),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,_.content.getBytes())])]}function _fromAsn1(_,a,$){var j={},_e=[];if(!asn1.validate(a,$,j,_e)){var et=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw et.errors=et,et}var tt=asn1.derToOid(j.contentType);if(tt!==forge.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(j.encryptedContent){var rt="";if(forge.util.isArray(j.encryptedContent))for(var nt=0;nt<j.encryptedContent.length;++nt){if(j.encryptedContent[nt].type!==asn1.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");rt+=j.encryptedContent[nt].value}else rt=j.encryptedContent;_.encryptedContent={algorithm:asn1.derToOid(j.encAlgorithm),parameter:forge.util.createBuffer(j.encParameter.value),content:forge.util.createBuffer(rt)}}if(j.content){var rt="";if(forge.util.isArray(j.content))for(var nt=0;nt<j.content.length;++nt){if(j.content[nt].type!==asn1.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");rt+=j.content[nt].value}else rt=j.content;_.content=forge.util.createBuffer(rt)}return _.version=j.version.charCodeAt(0),_.rawCapture=j,j}function _decryptContent(_){if(_.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(_.content===void 0){var a;switch(_.encryptedContent.algorithm){case forge.pki.oids["aes128-CBC"]:case forge.pki.oids["aes192-CBC"]:case forge.pki.oids["aes256-CBC"]:a=forge.aes.createDecryptionCipher(_.encryptedContent.key);break;case forge.pki.oids.desCBC:case forge.pki.oids["des-EDE3-CBC"]:a=forge.des.createDecryptionCipher(_.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+_.encryptedContent.algorithm)}if(a.start(_.encryptedContent.parameter),a.update(_.encryptedContent.content),!a.finish())throw new Error("Symmetric decryption failed.");_.content=a.output}}const pki=forge$s.pki,certificateForKey=(_,a)=>{const $=pki.rsa.setPublicKey(a.n,a.e),j=pki.createCertificate();j.publicKey=$,j.serialNumber="01",j.validity.notBefore=new Date,j.validity.notAfter=new Date,j.validity.notAfter.setFullYear(j.validity.notBefore.getFullYear()+10);const _e=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:_.id}];return j.setSubject(_e),j.setIssuer(_e),j.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),j.sign(a),j};async function findAsync(_,a){const $=_.map(a),_e=(await Promise.all($)).findIndex(et=>et);return _[_e]}const log$B=logger$1("libp2p:keychain:cms"),privates$1=new WeakMap;class CMS{constructor(a,$){if(a==null)throw errCode(new Error("keychain is required"),codes$1.ERR_KEYCHAIN_REQUIRED);this.keychain=a,privates$1.set(this,{dek:$})}async encrypt(a,$){if(!($ instanceof Uint8Array))throw errCode(new Error("Plain data must be a Uint8Array"),codes$1.ERR_INVALID_PARAMETERS);const j=await this.keychain.findKeyByName(a),_e=await this.keychain.getPrivateKey(a),et=privates$1.get(this);if(et==null)throw errCode(new Error("dek missing"),codes$1.ERR_INVALID_PARAMETERS);const tt=et.dek,rt=forge$s.pki.decryptRsaPrivateKey(_e,tt),nt=await certificateForKey(j,rt),it=forge$s.pkcs7.createEnvelopedData();it.addRecipient(nt),it.content=forge$s.util.createBuffer($),it.encrypt();const st=forge$s.asn1.toDer(it.toAsn1()).getBytes();return fromString$5(st,"ascii")}async decrypt(a){if(!(a instanceof Uint8Array))throw errCode(new Error("CMS data is required"),codes$1.ERR_INVALID_PARAMETERS);let $;try{const st=forge$s.util.createBuffer(toString$6(a,"ascii")),ot=forge$s.asn1.fromDer(st);$=forge$s.pkcs7.messageFromAsn1(ot)}catch(st){throw log$B.error(st),errCode(new Error("Invalid CMS"),codes$1.ERR_INVALID_CMS)}const j=$.recipients.filter(st=>st.issuer.find(ot=>ot.shortName==="O"&&ot.value==="ipfs")).filter(st=>st.issuer.find(ot=>ot.shortName==="CN")).map(st=>({recipient:st,keyId:st.issuer.find(ot=>ot.shortName==="CN").value})),_e=await findAsync(j,async st=>{try{if(await this.keychain.findKeyById(st.keyId)!=null)return!0}catch{return!1}return!1});if(_e==null){const st=j.map(ot=>ot.keyId);throw errCode(new Error(`Decryption needs one of the key(s): ${st.join(", ")}`),codes$1.ERR_MISSING_KEYS,{missingKeys:st})}const et=await this.keychain.findKeyById(_e.keyId);if(et==null)throw errCode(new Error("No key available to decrypto"),codes$1.ERR_NO_KEY);const tt=await this.keychain.getPrivateKey(et.name),rt=privates$1.get(this);if(rt==null)throw errCode(new Error("dek missing"),codes$1.ERR_INVALID_PARAMETERS);const nt=rt.dek,it=forge$s.pki.decryptRsaPrivateKey(tt,nt);return $.decrypt(_e.recipient,it),fromString$5($.content.getBytes(),"ascii")}}const log$A=logger$1("libp2p:keychain"),keyPrefix="/pkcs8/",infoPrefix="/info/",privates=new WeakMap,NIST={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},defaultOptions$2={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function validateKeyName(_){return _==null||typeof _!="string"?!1:_===sanitizeFilename(_.trim())&&_.length>0}async function randomDelay(){const $=Math.random()*800+200;await new Promise(j=>setTimeout(j,$))}function DsName(_){return new Key(keyPrefix+_)}function DsInfoName(_){return new Key(infoPrefix+_)}class KeyChain{constructor(a,$){if(this.components=a,this.init=mergeOptions$g(defaultOptions$2,$),this.init.pass!=null&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(this.init.dek?.keyLength!=null&&this.init.dek.keyLength<NIST.minKeyLength)throw new Error(`dek.keyLength must be least ${NIST.minKeyLength} bytes`);if(this.init.dek?.salt?.length!=null&&this.init.dek.salt.length<NIST.minSaltLength)throw new Error(`dek.saltLength must be least ${NIST.minSaltLength} bytes`);if(this.init.dek?.iterationCount!=null&&this.init.dek.iterationCount<NIST.minIterationCount)throw new Error(`dek.iterationCount must be least ${NIST.minIterationCount}`);const j=this.init.pass!=null&&this.init.dek?.salt!=null?pbkdf2(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";privates.set(this,{dek:j}),this.started=!1}isStarted(){return this.started}async start(){const a=DsInfoName("self");await this.components.datastore.has(a)||await this.importPeer("self",this.components.peerId),this.started=!0}stop(){this.started=!1}get cms(){const a=privates.get(this);if(a==null)throw errCode(new Error("dek missing"),codes$1.ERR_INVALID_PARAMETERS);const $=a.dek;return new CMS(this,$)}static generateOptions(){const a=Object.assign({},defaultOptions$2),$=Math.ceil(NIST.minSaltLength/3)*3;return a.dek.salt=toString$6(randomBytes$3($),"base64"),a}static get options(){return defaultOptions$2}async createKey(a,$,j=2048){if(!validateKeyName(a)||a==="self")throw await randomDelay(),errCode(new Error("Invalid key name"),codes$1.ERR_INVALID_KEY_NAME);if(typeof $!="string")throw await randomDelay(),errCode(new Error("Invalid key type"),codes$1.ERR_INVALID_KEY_TYPE);const _e=DsName(a);if(await this.components.datastore.has(_e))throw await randomDelay(),errCode(new Error("Key name already exists"),codes$1.ERR_KEY_ALREADY_EXISTS);switch($.toLowerCase()){case"rsa":if(!Number.isSafeInteger(j)||j<2048)throw await randomDelay(),errCode(new Error("Invalid RSA key size"),codes$1.ERR_INVALID_KEY_SIZE);break}let tt;try{const rt=await generateKeyPair($,j),nt=await rt.id(),it=privates.get(this);if(it==null)throw errCode(new Error("dek missing"),codes$1.ERR_INVALID_PARAMETERS);const st=it.dek,ot=await rt.export(st);tt={name:a,id:nt};const at=this.components.datastore.batch();at.put(_e,fromString$5(ot)),at.put(DsInfoName(a),fromString$5(JSON.stringify(tt))),await at.commit()}catch(rt){throw await randomDelay(),rt}return tt}async listKeys(){const a={prefix:infoPrefix},$=[];for await(const j of this.components.datastore.query(a))$.push(JSON.parse(toString$6(j.value)));return $}async findKeyById(a){try{return(await this.listKeys()).find(j=>j.id===a)}catch($){throw await randomDelay(),$}}async findKeyByName(a){if(!validateKeyName(a))throw await randomDelay(),errCode(new Error(`Invalid key name '${a}'`),codes$1.ERR_INVALID_KEY_NAME);const $=DsInfoName(a);try{const j=await this.components.datastore.get($);return JSON.parse(toString$6(j))}catch(j){throw await randomDelay(),log$A.error(j),errCode(new Error(`Key '${a}' does not exist.`),codes$1.ERR_KEY_NOT_FOUND)}}async removeKey(a){if(!validateKeyName(a)||a==="self")throw await randomDelay(),errCode(new Error(`Invalid key name '${a}'`),codes$1.ERR_INVALID_KEY_NAME);const $=DsName(a),j=await this.findKeyByName(a),_e=this.components.datastore.batch();return _e.delete($),_e.delete(DsInfoName(a)),await _e.commit(),j}async renameKey(a,$){if(!validateKeyName(a)||a==="self")throw await randomDelay(),errCode(new Error(`Invalid old key name '${a}'`),codes$1.ERR_OLD_KEY_NAME_INVALID);if(!validateKeyName($)||$==="self")throw await randomDelay(),errCode(new Error(`Invalid new key name '${$}'`),codes$1.ERR_NEW_KEY_NAME_INVALID);const j=DsName(a),_e=DsName($),et=DsInfoName(a),tt=DsInfoName($);if(await this.components.datastore.has(_e))throw await randomDelay(),errCode(new Error(`Key '${$}' already exists`),codes$1.ERR_KEY_ALREADY_EXISTS);try{const nt=await this.components.datastore.get(j),it=await this.components.datastore.get(et),st=JSON.parse(toString$6(it));st.name=$;const ot=this.components.datastore.batch();return ot.put(_e,nt),ot.put(tt,fromString$5(JSON.stringify(st))),ot.delete(j),ot.delete(et),await ot.commit(),st}catch(nt){throw await randomDelay(),nt}}async exportKey(a,$){if(!validateKeyName(a))throw await randomDelay(),errCode(new Error(`Invalid key name '${a}'`),codes$1.ERR_INVALID_KEY_NAME);if($==null)throw await randomDelay(),errCode(new Error("Password is required"),codes$1.ERR_PASSWORD_REQUIRED);const j=DsName(a);try{const _e=await this.components.datastore.get(j),et=toString$6(_e),tt=privates.get(this);if(tt==null)throw errCode(new Error("dek missing"),codes$1.ERR_INVALID_PARAMETERS);const rt=tt.dek;return await(await importKey(et,rt)).export($)}catch(_e){throw await randomDelay(),_e}}async importKey(a,$,j){if(!validateKeyName(a)||a==="self")throw await randomDelay(),errCode(new Error(`Invalid key name '${a}'`),codes$1.ERR_INVALID_KEY_NAME);if($==null)throw await randomDelay(),errCode(new Error("PEM encoded key is required"),codes$1.ERR_PEM_REQUIRED);const _e=DsName(a);if(await this.components.datastore.has(_e))throw await randomDelay(),errCode(new Error(`Key '${a}' already exists`),codes$1.ERR_KEY_ALREADY_EXISTS);let tt;try{tt=await importKey($,j)}catch{throw await randomDelay(),errCode(new Error("Cannot read the key, most likely the password is wrong"),codes$1.ERR_CANNOT_READ_KEY)}let rt;try{rt=await tt.id();const st=privates.get(this);if(st==null)throw errCode(new Error("dek missing"),codes$1.ERR_INVALID_PARAMETERS);const ot=st.dek;$=await tt.export(ot)}catch(st){throw await randomDelay(),st}const nt={name:a,id:rt},it=this.components.datastore.batch();return it.put(_e,fromString$5($)),it.put(DsInfoName(a),fromString$5(JSON.stringify(nt))),await it.commit(),nt}async importPeer(a,$){try{if(!validateKeyName(a))throw errCode(new Error(`Invalid key name '${a}'`),codes$1.ERR_INVALID_KEY_NAME);if($==null)throw errCode(new Error("PeerId is required"),codes$1.ERR_MISSING_PRIVATE_KEY);if($.privateKey==null)throw errCode(new Error("PeerId.privKey is required"),codes$1.ERR_MISSING_PRIVATE_KEY);const j=await unmarshalPrivateKey($.privateKey),_e=DsName(a);if(await this.components.datastore.has(_e))throw await randomDelay(),errCode(new Error(`Key '${a}' already exists`),codes$1.ERR_KEY_ALREADY_EXISTS);const tt=privates.get(this);if(tt==null)throw errCode(new Error("dek missing"),codes$1.ERR_INVALID_PARAMETERS);const rt=tt.dek,nt=await j.export(rt),it={name:a,id:$.toString()},st=this.components.datastore.batch();return st.put(_e,fromString$5(nt)),st.put(DsInfoName(a),fromString$5(JSON.stringify(it))),await st.commit(),it}catch(j){throw await randomDelay(),j}}async getPrivateKey(a){if(!validateKeyName(a))throw await randomDelay(),errCode(new Error(`Invalid key name '${a}'`),codes$1.ERR_INVALID_KEY_NAME);try{const $=DsName(a),j=await this.components.datastore.get($);return toString$6(j)}catch($){throw await randomDelay(),log$A.error($),errCode(new Error(`Key '${a}' does not exist.`),codes$1.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(a,$){if(typeof a!="string")throw await randomDelay(),errCode(new Error(`Invalid old pass type '${typeof a}'`),codes$1.ERR_INVALID_OLD_PASS_TYPE);if(typeof $!="string")throw await randomDelay(),errCode(new Error(`Invalid new pass type '${typeof $}'`),codes$1.ERR_INVALID_NEW_PASS_TYPE);if($.length<20)throw await randomDelay(),errCode(new Error(`Invalid pass length ${$.length}`),codes$1.ERR_INVALID_PASS_LENGTH);log$A("recreating keychain");const j=privates.get(this);if(j==null)throw errCode(new Error("dek missing"),codes$1.ERR_INVALID_PARAMETERS);const _e=j.dek;this.init.pass=$;const et=$!=null&&this.init.dek?.salt!=null?pbkdf2($,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";privates.set(this,{dek:et});const tt=await this.listKeys();for(const rt of tt){const nt=await this.components.datastore.get(DsName(rt.name)),it=toString$6(nt),st=await importKey(it,_e),ot=et.toString(),at=await st.export(ot),lt=this.components.datastore.batch(),ct={name:rt.name,id:rt.id};lt.put(DsName(rt.name),fromString$5(at)),lt.put(DsInfoName(rt.name),fromString$5(JSON.stringify(ct))),await lt.commit()}log$A("keychain reconstructed")}}async function*forEach(_,a){for await(const $ of _)await a($),yield $}const DIAL_TIMEOUT=3e4,INBOUND_UPGRADE_TIMEOUT=3e4,MAX_PARALLEL_DIALS=100,MAX_PER_PEER_DIALS=4,MAX_ADDRS_TO_DIAL=25,METRICS={computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50};class DefaultMovingAverage{constructor(a){if(typeof a!="number")throw new Error("must provide a timespan to the moving average constructor");if(a<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");this.timespan=a,this.movingAverage=0,this.variance=0,this.deviation=0,this.forecast=0}alpha(a,$){return 1-Math.exp(-(a-$)/this.timespan)}push(a,$){if(this.previousTime!=null){const j=this.alpha(a,this.previousTime),_e=$-this.movingAverage,et=j*_e;this.movingAverage=j*$+(1-j)*this.movingAverage,this.variance=(1-j)*(this.variance+_e*et),this.deviation=Math.sqrt(this.variance),this.forecast=this.movingAverage+j*_e}else this.movingAverage=$;this.previousTime=a}}function createMovingAverage(_){return new DefaultMovingAverage(_)}class DefaultStats extends EventEmitter$1{constructor(a){super(),this.enabled=a.enabled,this.queue=[],this.stats={dataReceived:0n,dataSent:0n},this.frequencyLastTime=Date.now(),this.frequencyAccumulators={},this.movingAverages={dataReceived:[],dataSent:[]},this.computeThrottleMaxQueueSize=a.computeThrottleMaxQueueSize,this.computeThrottleTimeout=a.computeThrottleTimeout,this._update=this._update.bind(this),this.movingAverageIntervals=a.movingAverageIntervals;for(let $=0;$<a.initialCounters.length;$++){const j=a.initialCounters[$];this.stats[j]=0n,this.movingAverages[j]=[];for(let _e=0;_e<this.movingAverageIntervals.length;_e++){const et=this.movingAverageIntervals[_e];(this.movingAverages[j][et]=createMovingAverage(et)).push(this.frequencyLastTime,0)}}}start(){!this.enabled||this.queue.length>0&&this._resetComputeTimeout()}stop(){this.timeout!=null&&(this.timeout.clear(),this.timeout=null)}getSnapshot(){return Object.assign({},this.stats)}getMovingAverages(){return Object.assign({},this.movingAverages)}push(a,$){this.queue.push([a,$,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this.timeout=retimer_1(this._update,this._nextTimeout())}_nextTimeout(){const a=this.queue.length/this.computeThrottleMaxQueueSize;return Math.max(this.computeThrottleTimeout*(1-a),0)}_update(){if(this.timeout=null,this.queue.length>0){let a=["",0,0];for(a of this.queue)this._applyOp(a);this.queue=[],a.length>2&&a[0]!==""&&this._updateFrequency(a[2]),this.dispatchEvent(new CustomEvent$1("update",{detail:this.stats}))}}_updateFrequency(a){const $=a-this.frequencyLastTime;this._updateFrequencyFor("dataReceived",$,a),this._updateFrequencyFor("dataSent",$,a),this.frequencyLastTime=a}_updateFrequencyFor(a,$,j){const _e=this.frequencyAccumulators[a]??0;this.frequencyAccumulators[a]=0;const tt=_e/($??1)*1e3;let rt=this.movingAverages[a];rt==null&&(rt=this.movingAverages[a]=[]);const nt=this.movingAverageIntervals;for(let it=0;it<nt.length;it++){const st=nt[it];let ot=rt[st];ot==null&&(ot=rt[st]=createMovingAverage(st)),ot.push(j,tt)}}_applyOp(a){const $=a[0],j=a[1];if(typeof j!="number")throw new Error("invalid increment number");let _e;Object.prototype.hasOwnProperty.call(this.stats,$)?_e=this.stats[$]:_e=this.stats[$]=0n,this.stats[$]=_e+BigInt(j),this.frequencyAccumulators[$]==null&&(this.frequencyAccumulators[$]=0),this.frequencyAccumulators[$]+=j}}const initialCounters=["dataReceived","dataSent"],directionToEvent={in:"dataReceived",out:"dataSent"};class DefaultMetrics{constructor(a){this.enabled=a.enabled,this.statsInit={...a,initialCounters},this.globalStats=new DefaultStats(this.statsInit),this.peerStats=new Map,this.protocolStats=new Map,this.oldPeers=hashlru(a.maxOldPeersRetention??METRICS.maxOldPeersRetention),this.running=!1,this._onMessage=this._onMessage.bind(this),this.systems=new Map}isStarted(){return this.running}async start(){!this.enabled||(this.running=!0)}async stop(){if(!!this.running){this.running=!1,this.globalStats.stop();for(const a of this.peerStats.values())a.stop();for(const a of this.protocolStats.values())a.stop()}}getGlobal(){return this.globalStats}getPeers(){return Array.from(this.peerStats.keys())}getComponentMetrics(){return this.systems}updateComponentMetric(a){const{system:$="libp2p",component:j,metric:_e,value:et,label:tt,help:rt}=a;this.systems.has($)||this.systems.set($,new Map);const nt=this.systems.get($);if(nt==null)throw new Error("Unknown metric system");nt.has(j)||nt.set(j,new Map);const it=nt.get(j);if(it==null)throw new Error("Unknown metric component");it.set(_e,{label:tt,help:rt,calculate:typeof et!="function"?()=>et:et})}forPeer(a){const $=a.toString();return this.peerStats.get($)??this.oldPeers.get($)}getProtocols(){return Array.from(this.protocolStats.keys())}forProtocol(a){return this.protocolStats.get(a)}onPeerDisconnected(a){const $=a.toString(),j=this.peerStats.get($);j!=null&&(j.stop(),this.peerStats.delete($),this.oldPeers.set($,j))}_onMessage(a){if(!this.running)return;const{remotePeer:$,protocol:j,direction:_e,dataLength:et}=a,tt=directionToEvent[_e];let rt=this.forPeer($);if(rt==null){const nt=new DefaultStats(this.statsInit);this.peerStats.set($.toString(),nt),rt=nt}if(rt.push(tt,et),this.globalStats.push(tt,et),j!=null){let nt=this.forProtocol(j);if(nt==null){const it=new DefaultStats(this.statsInit);this.protocolStats.set(j,it),nt=it}nt.push(tt,et)}}updatePlaceholder(a,$){if(!this.running)return;const j=a.toString(),_e=this.peerStats.get(j)??this.oldPeers.get(j),et=$.toString(),tt=this.peerStats.get(et)??this.oldPeers.get(et);let rt=_e;tt!=null&&(rt=mergeStats(tt,rt),this.oldPeers.remove(et)),this.peerStats.delete(a.toString()),this.peerStats.set(et,rt),rt.start()}trackStream(a){const{stream:$,remotePeer:j,protocol:_e}=a;if(!this.running)return;const et=$.source;$.source=forEach(et,rt=>this._onMessage({remotePeer:j,protocol:_e,direction:"in",dataLength:rt.byteLength}));const tt=$.sink;$.sink=async rt=>await pipe(rt,nt=>forEach(nt,it=>{this._onMessage({remotePeer:j,protocol:_e,direction:"out",dataLength:it.byteLength})}),tt)}}function mergeStats(_,a){return _.stop(),a.stop(),_.queue=[..._.queue,...a.queue],_}async function pReflect(_){try{return{status:"fulfilled",value:await _,isFulfilled:!0,isRejected:!1}}catch(a){return{status:"rejected",reason:a,isFulfilled:!1,isRejected:!0}}}class Node{constructor(a){en(this,"value");en(this,"next");this.value=a}}var Nr,Xr,Jr;class Queue{constructor(){tn(this,Nr,void 0);tn(this,Xr,void 0);tn(this,Jr,void 0);this.clear()}enqueue(a){const $=new Node(a);Vr(this,Nr)?(Vr(this,Xr).next=$,Lr(this,Xr,$)):(Lr(this,Nr,$),Lr(this,Xr,$)),_n(this,Jr)._++}dequeue(){const a=Vr(this,Nr);if(!!a)return Lr(this,Nr,Vr(this,Nr).next),_n(this,Jr)._--,a.value}clear(){Lr(this,Nr,void 0),Lr(this,Xr,void 0),Lr(this,Jr,0)}get size(){return Vr(this,Jr)}*[Symbol.iterator](){let a=Vr(this,Nr);for(;a;)yield a.value,a=a.next}}Nr=new WeakMap,Xr=new WeakMap,Jr=new WeakMap;function pLimit(_){if(!((Number.isInteger(_)||_===Number.POSITIVE_INFINITY)&&_>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const a=new Queue;let $=0;const j=()=>{$--,a.size>0&&a.dequeue()()},_e=async(rt,nt,it)=>{$++;const st=(async()=>rt(...it))();nt(st);try{await st}catch{}j()},et=(rt,nt,it)=>{a.enqueue(_e.bind(void 0,rt,nt,it)),(async()=>(await Promise.resolve(),$<_&&a.size>0&&a.dequeue()()))()},tt=(rt,...nt)=>new Promise(it=>{et(rt,it,nt)});return Object.defineProperties(tt,{activeCount:{get:()=>$},pendingCount:{get:()=>a.size},clearQueue:{value:()=>{a.clear()}}}),tt}async function pSettle(_,a={}){const{concurrency:$=Number.POSITIVE_INFINITY}=a,j=pLimit($);return Promise.all(_.map(_e=>_e&&typeof _e.then=="function"?pReflect(_e):pReflect(typeof _e=="function"?j(()=>_e()):Promise.resolve(_e))))}class TrackedMap extends Map{constructor(a){super();const{system:$,component:j,metric:_e,metrics:et}=a;this.system=$??"libp2p",this.component=j,this.metric=_e,this.metrics=et,this.updateComponentMetric()}set(a,$){return super.set(a,$),this.updateComponentMetric(),this}delete(a){const $=super.delete(a);return this.updateComponentMetric(),$}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metrics.updateComponentMetric({system:this.system,component:this.component,metric:this.metric,value:this.size})}}function trackedMap(_){const{system:a,component:$,metric:j,metrics:_e}=_;let et;return _e!=null?et=new TrackedMap({system:a,component:$,metric:j,metrics:_e}):et=new Map,et}const log$z=logger$1("libp2p:transports");class DefaultTransportManager extends EventEmitter$1{constructor(a,$={}){super(),this.components=a,this.started=!1,this.transports=new Map,this.listeners=trackedMap({component:"transport-manager",metric:"listeners",metrics:this.components.metrics}),this.faultTolerance=$.faultTolerance??FaultTolerance.FATAL_ALL}add(a){const $=a[Symbol.toStringTag];if($==null)throw errCode(new Error("Transport must have a valid tag"),codes$1.ERR_INVALID_KEY);if(this.transports.has($))throw errCode(new Error("There is already a transport with this tag"),codes$1.ERR_DUPLICATE_TRANSPORT);log$z("adding transport %s",$),this.transports.set($,a),this.listeners.has($)||this.listeners.set($,[])}isStarted(){return this.started}async start(){const a=this.components.addressManager.getListenAddrs();await this.listen(a),this.started=!0}async stop(){const a=[];for(const[$,j]of this.listeners)for(log$z("closing listeners for %s",$);j.length>0;){const _e=j.pop();_e!=null&&a.push(_e.close())}await Promise.all(a),log$z("all listeners closed");for(const $ of this.listeners.keys())this.listeners.set($,[]);this.started=!1}async dial(a,$){const j=this.transportForMultiaddr(a);if(j==null)throw errCode(new Error(`No transport available for address ${String(a)}`),codes$1.ERR_TRANSPORT_UNAVAILABLE);try{return await j.dial(a,{...$,upgrader:this.components.upgrader})}catch(_e){throw _e.code==null&&(_e.code=codes$1.ERR_TRANSPORT_DIAL_FAILED),_e}}getAddrs(){let a=[];for(const $ of this.listeners.values())for(const j of $)a=[...a,...j.getAddrs()];return a}getTransports(){return Array.of(...this.transports.values())}transportForMultiaddr(a){for(const $ of this.transports.values())if($.filter([a]).length>0)return $}async listen(a){if(a==null||a.length===0){log$z("no addresses were provided for listening, this node is dial only");return}const $=[];for(const[j,_e]of this.transports.entries()){const et=_e.filter(a),tt=[];for(const it of et){log$z("creating listener for %s on %s",j,it);const st=_e.createListener({upgrader:this.components.upgrader});let ot=this.listeners.get(j);ot==null&&(ot=[],this.listeners.set(j,ot)),ot.push(st),st.addEventListener("listening",()=>{this.dispatchEvent(new CustomEvent$1("listener:listening",{detail:st}))}),st.addEventListener("close",()=>{this.dispatchEvent(new CustomEvent$1("listener:close",{detail:st}))}),tt.push(st.listen(it))}if(tt.length===0){$.push(j);continue}if((await pSettle(tt)).find(it=>it.isFulfilled)==null&&this.faultTolerance!==FaultTolerance.NO_FATAL)throw errCode(new Error(`Transport (${j}) could not listen on any available address`),codes$1.ERR_NO_VALID_ADDRESSES)}if($.length===this.transports.size){const j=`no valid addresses were provided for transports [${$.join(", ")}]`;if(this.faultTolerance===FaultTolerance.FATAL_ALL)throw errCode(new Error(j),codes$1.ERR_NO_VALID_ADDRESSES);log$z(`libp2p in dial mode only: ${j}`)}}async remove(a){log$z("removing %s",a);for(const $ of this.listeners.get(a)??[])await $.close();this.transports.delete(a),this.listeners.delete(a)}async removeAll(){const a=[];for(const $ of this.transports.keys())a.push(this.remove($));await Promise.all(a)}}var FaultTolerance;(function(_){_[_.FATAL_ALL=0]="FATAL_ALL",_[_.NO_FATAL=1]="NO_FATAL"})(FaultTolerance||(FaultTolerance={}));const PROTOCOL_ID="/multistream/1.0.0",first$1=async _=>{for await(const a of _)return a};var itFirst$1=first$1;const NewLine=fromString$5(`
`);function encode$2(_){const a=new Uint8ArrayList(_,NewLine);return encode$5.single(a)}function write(_,a,$={}){const j=encode$2(a);$.writeBytes===!0?_.push(j.subarray()):_.push(j)}function writeAll(_,a,$={}){const j=new Uint8ArrayList;for(const _e of a)j.append(encode$2(_e));$.writeBytes===!0?_.push(j.subarray()):_.push(j)}async function read$1(_,a){let $=1;const j={[Symbol.asyncIterator]:()=>j,next:async()=>await _.next($)};let _e=j;a?.signal!=null&&(_e=abortableSource(j,a.signal));const tt=await pipe(_e,decode$4({onLength:rt=>{$=rt}}),async rt=>await itFirst$1(rt));if(tt==null)throw errCode(new Error("no buffer returned"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");if(tt.get(tt.byteLength-1)!==NewLine[0])throw errCode(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return tt.sublist(0,-1)}async function readString(_,a){const $=await read$1(_,a);return toString$6($.subarray())}const log$y=logger$1("libp2p:mss:select");async function select$1(_,a,$={}){a=Array.isArray(a)?[...a]:[a];const{reader:j,writer:_e,rest:et,stream:tt}=handshake(_),rt=a.shift();if(rt==null)throw new Error("At least one protocol must be specified");log$y('select: write ["%s", "%s"]',PROTOCOL_ID,rt);const nt=fromString$5(PROTOCOL_ID),it=fromString$5(rt);writeAll(_e,[nt,it],$);let st=await readString(j,$);if(log$y('select: read "%s"',st),st===PROTOCOL_ID&&(st=await readString(j,$),log$y('select: read "%s"',st)),st===rt)return et(),{stream:tt,protocol:rt};for(const ot of a){log$y('select: write "%s"',ot),write(_e,fromString$5(ot),$);const at=await readString(j,$);if(log$y('select: read "%s" for "%s"',at,ot),at===ot)return et(),{stream:tt,protocol:ot}}throw et(),errCode(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}const log$x=logger$1("libp2p:mss:handle");async function handle(_,a,$){a=Array.isArray(a)?a:[a];const{writer:j,reader:_e,rest:et,stream:tt}=handshake(_);for(;;){const rt=await readString(_e,$);if(log$x('read "%s"',rt),rt===PROTOCOL_ID){log$x('respond with "%s" for "%s"',PROTOCOL_ID,rt),write(j,fromString$5(PROTOCOL_ID),$);continue}if(a.includes(rt))return write(j,fromString$5(rt),$),log$x('respond with "%s" for "%s"',rt,rt),et(),{stream:tt,protocol:rt};if(rt==="ls"){write(j,new Uint8ArrayList(...a.map(nt=>encode$2(fromString$5(nt)))),$),log$x('respond with "%s" for %s',a,rt);continue}write(j,fromString$5("na"),$),log$x('respond with "na" for "%s"',rt)}}function _toConsumableArray(_){if(Array.isArray(_)){for(var a=0,$=Array(_.length);a<_.length;a++)$[a]=_[a];return $}else return Array.from(_)}var build=function _(a){var $=void 0,j=void 0;function _e(rt){if(!(rt instanceof Object))throw new Error('Target "'+rt+'" is not an object');j=rt}function et(rt){Object.keys(rt).forEach(function(nt){var it=rt[nt];if(typeof it!="function")throw new Error('Trap "'+nt+": "+it+'" is not a function');if(!Reflect[nt])throw new Error('Trap "'+nt+": "+it+'" is not a valid trap')}),$=rt}_e(function(){}),a&&_e(a),et(Reflect);var tt=new Proxy({},{get:function(nt,it){return function(){for(var st=arguments.length,ot=Array(st),at=0;at<st;at++)ot[at]=arguments[at];return $[it].apply(null,[j].concat(_toConsumableArray(ot.slice(1))))}}});return{setTarget:_e,setHandler:et,getTarget:function(){return j},getHandler:function(){return $},proxy:new Proxy(j,tt)}};const symbol=Symbol.for("@libp2p/connection"),log$w=logger$1("libp2p:connection");class ConnectionImpl{constructor(a){const{remoteAddr:$,remotePeer:j,newStream:_e,close:et,getStreams:tt,stat:rt}=a;this.id=`${parseInt(String(Math.random()*1e9)).toString(36)}${Date.now()}`,this.remoteAddr=$,this.remotePeer=j,this.stat={...rt,status:OPEN},this._newStream=_e,this._close=et,this._getStreams=tt,this.tags=[],this._closing=!1}get[Symbol.toStringTag](){return"Connection"}get[symbol](){return!0}get streams(){return this._getStreams()}async newStream(a,$){if(this.stat.status===CLOSING)throw errCode(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===CLOSED)throw errCode(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(a)||(a=[a]);const j=await this._newStream(a,$);return j.stat.direction="outbound",j}addStream(a){a.stat.direction="inbound"}removeStream(a){}async close(){if(!(this.stat.status===CLOSED||this._closing)){this.stat.status=CLOSING;try{this.streams.forEach(a=>a.close())}catch(a){log$w.error(a)}this._closing=!0,await this._close(),this._closing=!1,this.stat.timeline.close=Date.now(),this.stat.status=CLOSED}}}function createConnection(_){return new ConnectionImpl(_)}const log$v=logger$1("libp2p:registrar"),DEFAULT_MAX_INBOUND_STREAMS$2=32,DEFAULT_MAX_OUTBOUND_STREAMS$2=64;class DefaultRegistrar{constructor(a){this.topologies=new Map,this.handlers=new Map,this.components=a,this._onDisconnect=this._onDisconnect.bind(this),this._onProtocolChange=this._onProtocolChange.bind(this),this.components.connectionManager.addEventListener("peer:disconnect",this._onDisconnect),this.components.peerStore.addEventListener("change:protocols",this._onProtocolChange)}getProtocols(){return Array.from(new Set([...this.topologies.keys(),...this.handlers.keys()])).sort()}getHandler(a){const $=this.handlers.get(a);if($==null)throw errCode(new Error(`No handler registered for protocol ${a}`),codes$1.ERR_NO_HANDLER_FOR_PROTOCOL);return $}getTopologies(a){const $=this.topologies.get(a);return $==null?[]:[...$.values()]}async handle(a,$,j){if(this.handlers.has(a))throw errCode(new Error(`Handler already registered for protocol ${a}`),codes$1.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);const _e=mergeOptions$g.bind({ignoreUndefined:!0})({maxInboundStreams:DEFAULT_MAX_INBOUND_STREAMS$2,maxOutboundStreams:DEFAULT_MAX_OUTBOUND_STREAMS$2},j);this.handlers.set(a,{handler:$,options:_e}),await this.components.peerStore.protoBook.add(this.components.peerId,[a])}async unhandle(a){const $=Array.isArray(a)?a:[a];$.forEach(j=>{this.handlers.delete(j)}),await this.components.peerStore.protoBook.remove(this.components.peerId,$)}async register(a,$){if(!isTopology($))throw log$v.error("topology must be an instance of interfaces/topology"),errCode(new Error("topology must be an instance of interfaces/topology"),codes$1.ERR_INVALID_PARAMETERS);const j=`${(Math.random()*1e9).toString(36)}${Date.now()}`;let _e=this.topologies.get(a);return _e==null&&(_e=new Map,this.topologies.set(a,_e)),_e.set(j,$),await $.setRegistrar(this),j}unregister(a){for(const[$,j]of this.topologies.entries())j.has(a)&&(j.delete(a),j.size===0&&this.topologies.delete($))}_onDisconnect(a){const $=a.detail;this.components.peerStore.protoBook.get($.remotePeer).then(j=>{for(const _e of j){const et=this.topologies.get(_e);if(et!=null)for(const tt of et.values())tt.onDisconnect($.remotePeer)}}).catch(j=>{log$v.error(j)})}_onProtocolChange(a){const{peerId:$,protocols:j,oldProtocols:_e}=a.detail,et=_e.filter(rt=>!j.includes(rt)),tt=j.filter(rt=>!_e.includes(rt));for(const rt of et){const nt=this.topologies.get(rt);if(nt!=null)for(const it of nt.values())it.onDisconnect($)}for(const rt of tt){const nt=this.topologies.get(rt);if(nt!=null)for(const it of nt.values()){const st=this.components.connectionManager.getConnections($)[0];st!=null&&it.onConnect($,st)}}}}const log$u=logger$1("libp2p:upgrader");function findIncomingStreamLimit(_,a){try{const{options:$}=a.getHandler(_);return $.maxInboundStreams}catch($){if($.code!==codes$1.ERR_NO_HANDLER_FOR_PROTOCOL)throw $}return DEFAULT_MAX_INBOUND_STREAMS$2}function findOutgoingStreamLimit(_,a){try{const{options:$}=a.getHandler(_);return $.maxOutboundStreams}catch($){if($.code!==codes$1.ERR_NO_HANDLER_FOR_PROTOCOL)throw $}return DEFAULT_MAX_OUTBOUND_STREAMS$2}function countStreams(_,a,$){let j=0;return $.streams.forEach(_e=>{_e.stat.direction===a&&_e.stat.protocol===_&&j++}),j}class DefaultUpgrader extends EventEmitter$1{constructor(a,$){super(),this.components=a,this.connectionEncryption=new Map,$.connectionEncryption.forEach(j=>{this.connectionEncryption.set(j.protocol,j)}),this.muxers=new Map,$.muxers.forEach(j=>{this.muxers.set(j.protocol,j)}),this.inboundUpgradeTimeout=$.inboundUpgradeTimeout}async upgradeInbound(a){if(!await this.components.connectionManager.acceptIncomingConnection(a))throw errCode(new Error("connection denied"),codes$1.ERR_CONNECTION_DENIED);let j,_e,et,tt,rt,nt,it;const st=this.components.metrics,ot=new timeoutAbortController.TimeoutController(this.inboundUpgradeTimeout);try{events.exports.setMaxListeners?.(1/0,ot.signal)}catch{}try{const at=abortableDuplex(a,ot.signal);if(a.source=at.source,a.sink=at.sink,await this.components.connectionGater.denyInboundConnection(a))throw errCode(new Error("The multiaddr connection is blocked by gater.acceptConnection"),codes$1.ERR_CONNECTION_INTERCEPTED);if(st!=null){({setTarget:nt,proxy:it}=build());const ut=`${(Math.random()*1e9).toString(36)}${Date.now()}`;nt({toString:()=>ut}),st.trackStream({stream:a,remotePeer:it})}log$u("starting the inbound connection upgrade");let lt=a;const ct=this.components.connectionProtector;ct!=null&&(log$u("protecting the inbound connection"),lt=await ct.protect(a));try{if({conn:j,remotePeer:_e,protocol:rt}=await this._encryptInbound(lt),await this.components.connectionGater.denyInboundEncryptedConnection(_e,{...lt,...j}))throw errCode(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),codes$1.ERR_CONNECTION_INTERCEPTED);if(this.muxers.size>0){const ut=await this._multiplexInbound({...lt,...j},this.muxers);tt=ut.muxerFactory,et=ut.stream}else et=j}catch(ut){throw log$u.error("Failed to upgrade inbound connection",ut),ut}if(await this.components.connectionGater.denyInboundUpgradedConnection(_e,{...lt,...j}))throw errCode(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),codes$1.ERR_CONNECTION_INTERCEPTED);return st!=null&&(st.updatePlaceholder(it,_e),nt(_e)),log$u("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:rt,direction:"inbound",maConn:a,upgradedConn:et,muxerFactory:tt,remotePeer:_e})}finally{this.components.connectionManager.afterUpgradeInbound(),ot.clear()}}async upgradeOutbound(a,$){const j=a.remoteAddr.getPeerId();if(j==null)throw errCode(new Error("outbound connection must have a peer id"),codes$1.ERR_INVALID_MULTIADDR);const _e=peerIdFromString(j);if(await this.components.connectionGater.denyOutboundConnection(_e,a))throw errCode(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),codes$1.ERR_CONNECTION_INTERCEPTED);let et,tt,rt,nt,it,st,ot;const at=this.components.metrics;if(at!=null){({setTarget:st,proxy:ot}=build());const ct=`${(Math.random()*1e9).toString(36)}${Date.now()}`;st({toB58String:()=>ct}),at.trackStream({stream:a,remotePeer:ot})}log$u("Starting the outbound connection upgrade");let lt=a;if($?.skipProtection!==!0){const ct=this.components.connectionProtector;ct!=null&&(lt=await ct.protect(a))}try{if(et=lt,$?.skipEncryption!==!0){if({conn:et,remotePeer:tt,protocol:nt}=await this._encryptOutbound(lt,_e),await this.components.connectionGater.denyOutboundEncryptedConnection(tt,{...lt,...et}))throw errCode(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),codes$1.ERR_CONNECTION_INTERCEPTED)}else nt="native",tt=_e;if(rt=et,$?.muxerFactory!=null)it=$.muxerFactory;else if(this.muxers.size>0){const ct=await this._multiplexOutbound({...lt,...et},this.muxers);it=ct.muxerFactory,rt=ct.stream}}catch(ct){throw log$u.error("Failed to upgrade outbound connection",ct),await a.close(ct),ct}if(await this.components.connectionGater.denyOutboundUpgradedConnection(tt,{...lt,...et}))throw errCode(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),codes$1.ERR_CONNECTION_INTERCEPTED);return at!=null&&(at.updatePlaceholder(ot,tt),st(tt)),log$u("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:nt,direction:"outbound",maConn:a,upgradedConn:rt,muxerFactory:it,remotePeer:tt})}_createConnection(a){const{cryptoProtocol:$,direction:j,maConn:_e,upgradedConn:et,remotePeer:tt,muxerFactory:rt}=a;let nt,it,st;rt!=null&&(nt=rt.createStreamMuxer({direction:j,onIncomingStream:lt=>{st!=null&&Promise.resolve().then(async()=>{const ct=this.components.registrar.getProtocols(),{stream:ut,protocol:dt}=await handle(lt,ct);log$u("%s: incoming stream opened on %s",j,dt);const ft=this.components.metrics;if(ft?.trackStream({stream:ut,remotePeer:tt,protocol:dt}),st==null)return;const pt=findIncomingStreamLimit(dt,this.components.registrar);if(countStreams(dt,"inbound",st)===pt){lt.abort(errCode(new Error(`Too many inbound protocol streams for protocol "${dt}" - limit ${pt}`),codes$1.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS));return}lt.source=ut.source,lt.sink=ut.sink,lt.stat.protocol=dt,this.components.peerStore.protoBook.add(tt,[dt]).catch(mt=>log$u.error(mt)),st.addStream(lt),this._onStream({connection:st,stream:lt,protocol:dt})}).catch(ct=>{log$u.error(ct),lt.stat.timeline.close==null&&lt.close()})},onStreamEnd:lt=>{st?.removeStream(lt.id)}}),it=async(lt,ct={})=>{if(nt==null)throw errCode(new Error("Stream is not multiplexed"),codes$1.ERR_MUXER_UNAVAILABLE);log$u("%s: starting new stream on %s",j,lt);const ut=await nt.newStream(),dt=this.components.metrics;let ft;try{if(ct.signal==null){log$u("No abort signal was passed while trying to negotiate protocols %s falling back to default timeout",lt),ft=new timeoutAbortController.TimeoutController(3e4),ct.signal=ft.signal;try{events.exports.setMaxListeners?.(1/0,ft.signal)}catch{}}const{stream:pt,protocol:yt}=await select$1(ut,lt,ct);dt?.trackStream({stream:pt,remotePeer:tt,protocol:yt});const mt=findOutgoingStreamLimit(yt,this.components.registrar);if(countStreams(yt,"outbound",st)===mt){const vt=errCode(new Error(`Too many outbound protocol streams for protocol "${yt}" - limit ${mt}`),codes$1.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS);throw ut.abort(vt),vt}return this.components.peerStore.protoBook.add(tt,[yt]).catch(vt=>log$u.error(vt)),ut.source=pt.source,ut.sink=pt.sink,ut.stat.protocol=yt,ut}catch(pt){throw log$u.error("could not create new stream",pt),ut.stat.timeline.close==null&&ut.close(),pt.code!=null?pt:errCode(pt,codes$1.ERR_UNSUPPORTED_PROTOCOL)}finally{ft?.clear()}},pipe(et,nt,et).catch(log$u.error));const ot=_e.timeline;_e.timeline=new Proxy(ot,{set:(...lt)=>(st!=null&&lt[1]==="close"&&lt[2]!=null&&ot.close==null&&(async()=>{try{st.stat.status==="OPEN"&&await st.close()}catch(ct){log$u.error(ct)}finally{this.dispatchEvent(new CustomEvent$1("connectionEnd",{detail:st}))}})().catch(ct=>{log$u.error(ct)}),Reflect.set(...lt))}),_e.timeline.upgraded=Date.now();const at=()=>{throw errCode(new Error("connection is not multiplexed"),codes$1.ERR_CONNECTION_NOT_MULTIPLEXED)};return st=createConnection({remoteAddr:_e.remoteAddr,remotePeer:tt,stat:{status:"OPEN",direction:j,timeline:_e.timeline,multiplexer:nt?.protocol,encryption:$},newStream:it??at,getStreams:()=>nt!=null?nt.streams:at(),close:async()=>{await _e.close(),nt?.close()}}),this.dispatchEvent(new CustomEvent$1("connection",{detail:st})),st}_onStream(a){const{connection:$,stream:j,protocol:_e}=a,{handler:et}=this.components.registrar.getHandler(_e);et({connection:$,stream:j})}async _encryptInbound(a){const $=Array.from(this.connectionEncryption.keys());log$u("handling inbound crypto protocol selection",$);try{const{stream:j,protocol:_e}=await handle(a,$,{writeBytes:!0}),et=this.connectionEncryption.get(_e);if(et==null)throw new Error(`no crypto module found for ${_e}`);return log$u("encrypting inbound connection..."),{...await et.secureInbound(this.components.peerId,j),protocol:_e}}catch(j){throw errCode(j,codes$1.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(a,$){const j=Array.from(this.connectionEncryption.keys());log$u("selecting outbound crypto protocol",j);try{const{stream:_e,protocol:et}=await select$1(a,j,{writeBytes:!0}),tt=this.connectionEncryption.get(et);if(tt==null)throw new Error(`no crypto module found for ${et}`);return log$u("encrypting outbound connection to %p",$),{...await tt.secureOutbound(this.components.peerId,_e,$),protocol:et}}catch(_e){throw errCode(_e,codes$1.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(a,$){const j=Array.from($.keys());log$u("outbound selecting muxer %s",j);try{const{stream:_e,protocol:et}=await select$1(a,j,{writeBytes:!0});log$u("%s selected as muxer protocol",et);const tt=$.get(et);return{stream:_e,muxerFactory:tt}}catch(_e){throw log$u.error("error multiplexing outbound stream",_e),errCode(_e,codes$1.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(a,$){const j=Array.from($.keys());log$u("inbound handling muxers %s",j);try{const{stream:_e,protocol:et}=await handle(a,j,{writeBytes:!0}),tt=$.get(et);return{stream:_e,muxerFactory:tt}}catch(_e){throw log$u.error("error multiplexing inbound stream",_e),errCode(_e,codes$1.ERR_MUXER_UNAVAILABLE)}}}var Identify;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{if(_e.lengthDelimited!==!1&&j.fork(),$.protocolVersion!=null&&(j.uint32(42),j.string($.protocolVersion)),$.agentVersion!=null&&(j.uint32(50),j.string($.agentVersion)),$.publicKey!=null&&(j.uint32(10),j.bytes($.publicKey)),$.listenAddrs!=null)for(const et of $.listenAddrs)j.uint32(18),j.bytes(et);if($.observedAddr!=null&&(j.uint32(34),j.bytes($.observedAddr)),$.protocols!=null)for(const et of $.protocols)j.uint32(26),j.string(et);$.signedPeerRecord!=null&&(j.uint32(66),j.bytes($.signedPeerRecord)),_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={listenAddrs:[],protocols:[]},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 5:_e.protocolVersion=$.string();break;case 6:_e.agentVersion=$.string();break;case 1:_e.publicKey=$.bytes();break;case 2:_e.listenAddrs.push($.bytes());break;case 4:_e.observedAddr=$.bytes();break;case 3:_e.protocols.push($.string());break;case 8:_e.signedPeerRecord=$.bytes();break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(Identify||(Identify={}));const version="0.0.0",name="libp2p",AGENT_VERSION=`js-libp2p/${version}`,IDENTIFY_PROTOCOL_VERSION="0.1.0",MULTICODEC_IDENTIFY_PROTOCOL_NAME="id",MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME="id/push",MULTICODEC_IDENTIFY_PROTOCOL_VERSION="1.0.0",MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION="1.0.0",log$t=logger$1("libp2p:identify"),MAX_IDENTIFY_MESSAGE_SIZE=1024*8;class IdentifyService{constructor(a,$){this.components=a,this.started=!1,this.init=$,this.identifyProtocolStr=`/${$.protocolPrefix}/${MULTICODEC_IDENTIFY_PROTOCOL_NAME}/${MULTICODEC_IDENTIFY_PROTOCOL_VERSION}`,this.identifyPushProtocolStr=`/${$.protocolPrefix}/${MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME}/${MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION}`,this.host={protocolVersion:`${$.protocolPrefix}/${IDENTIFY_PROTOCOL_VERSION}`,...$.host},this.components.connectionManager.addEventListener("peer:connect",j=>{const _e=j.detail;this.identify(_e).catch(log$t.error)}),this.components.peerStore.addEventListener("change:multiaddrs",j=>{const{peerId:_e}=j.detail;this.components.peerId.equals(_e)&&this.pushToPeerStore().catch(et=>log$t.error(et))}),this.components.peerStore.addEventListener("change:protocols",j=>{const{peerId:_e}=j.detail;this.components.peerId.equals(_e)&&this.pushToPeerStore().catch(et=>log$t.error(et))})}isStarted(){return this.started}async start(){this.started||(await this.components.peerStore.metadataBook.setValue(this.components.peerId,"AgentVersion",fromString$5(this.host.agentVersion)),await this.components.peerStore.metadataBook.setValue(this.components.peerId,"ProtocolVersion",fromString$5(this.host.protocolVersion)),await this.components.registrar.handle(this.identifyProtocolStr,a=>{this._handleIdentify(a).catch($=>{log$t.error($)})},{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),await this.components.registrar.handle(this.identifyPushProtocolStr,a=>{this._handlePush(a).catch($=>{log$t.error($)})},{maxInboundStreams:this.init.maxPushIncomingStreams,maxOutboundStreams:this.init.maxPushOutgoingStreams}),this.started=!0)}async stop(){await this.components.registrar.unhandle(this.identifyProtocolStr),await this.components.registrar.unhandle(this.identifyPushProtocolStr),this.started=!1}async push(a){const $=await this.components.peerStore.addressBook.getRawEnvelope(this.components.peerId),j=this.components.addressManager.getAddresses().map(tt=>tt.bytes),_e=await this.components.peerStore.protoBook.get(this.components.peerId),et=a.map(async tt=>{let rt;const nt=new timeoutAbortController.TimeoutController(this.init.timeout);try{events.exports.setMaxListeners?.(1/0,nt.signal)}catch{}try{rt=await tt.newStream([this.identifyPushProtocolStr],{signal:nt.signal}),await abortableDuplex(rt,nt.signal).sink(pipe([Identify.encode({listenAddrs:j,signedPeerRecord:$,protocols:_e})],encode$5()))}catch(it){log$t.error("could not push identify update to peer",it)}finally{rt?.close(),nt.clear()}});await Promise.all(et)}async pushToPeerStore(){if(!this.isStarted())return;const a=[];for(const $ of this.components.connectionManager.getConnections()){const j=$.remotePeer;!(await this.components.peerStore.get(j)).protocols.includes(this.identifyPushProtocolStr)||a.push($)}await this.push(a)}async _identify(a,$={}){let j,_e=$.signal,et;if(_e==null){j=new timeoutAbortController.TimeoutController(this.init.timeout),_e=j.signal;try{events.exports.setMaxListeners?.(1/0,j.signal)}catch{}}try{et=await a.newStream([this.identifyProtocolStr],{signal:_e});const tt=abortableDuplex(et,_e),rt=await pipe([],tt,decode$4({maxDataLength:this.init.maxIdentifyMessageSize??MAX_IDENTIFY_MESSAGE_SIZE}),async nt=>await first$2(nt));if(rt==null)throw errCode(new Error("No data could be retrieved"),codes$1.ERR_CONNECTION_ENDED);try{return Identify.decode(rt)}catch(nt){throw errCode(nt,codes$1.ERR_INVALID_MESSAGE)}}finally{j?.clear(),et?.close()}}async identify(a,$={}){const j=await this._identify(a,$),{publicKey:_e,listenAddrs:et,protocols:tt,observedAddr:rt,signedPeerRecord:nt,agentVersion:it,protocolVersion:st}=j;if(_e==null)throw errCode(new Error("public key was missing from identify message"),codes$1.ERR_MISSING_PUBLIC_KEY);const ot=await peerIdFromKeys(_e);if(!a.remotePeer.equals(ot))throw errCode(new Error("identified peer does not match the expected peer"),codes$1.ERR_INVALID_PEER);if(this.components.peerId.equals(ot))throw errCode(new Error("identified peer is our own peer id?"),codes$1.ERR_INVALID_PEER);const at=IdentifyService.getCleanMultiaddr(rt);if(nt!=null){log$t("received signed peer record from %p",ot);try{const lt=await RecordEnvelope.openAndCertify(nt,PeerRecord.DOMAIN);if(!lt.peerId.equals(ot))throw errCode(new Error("identified peer does not match the expected peer"),codes$1.ERR_INVALID_PEER);if(await this.components.peerStore.addressBook.consumePeerRecord(lt)){await this.components.peerStore.protoBook.set(ot,tt),it!=null&&await this.components.peerStore.metadataBook.setValue(ot,"AgentVersion",fromString$5(it)),st!=null&&await this.components.peerStore.metadataBook.setValue(ot,"ProtocolVersion",fromString$5(st)),log$t("identify completed for peer %p and protocols %o",ot,tt);return}}catch(lt){log$t("received invalid envelope, discard it and fallback to listenAddrs is available",lt)}}else log$t("no signed peer record received from %p",ot);log$t("falling back to legacy addresses from %p",ot);try{await this.components.peerStore.addressBook.set(ot,et.map(lt=>multiaddr(lt)))}catch(lt){log$t.error("received invalid addrs",lt)}await this.components.peerStore.protoBook.set(ot,tt),it!=null&&await this.components.peerStore.metadataBook.setValue(ot,"AgentVersion",fromString$5(it)),st!=null&&await this.components.peerStore.metadataBook.setValue(ot,"ProtocolVersion",fromString$5(st)),log$t("identify completed for peer %p and protocols %o",ot,tt),log$t("received observed address of %s",at?.toString())}async _handleIdentify(a){const{connection:$,stream:j}=a,_e=new timeoutAbortController.TimeoutController(this.init.timeout);try{events.exports.setMaxListeners?.(1/0,_e.signal)}catch{}try{const et=this.components.peerId.publicKey??new Uint8Array(0),tt=await this.components.peerStore.get(this.components.peerId),rt=this.components.addressManager.getAddresses().map(at=>at.decapsulateCode(getProtocol("p2p").code));let nt=tt.peerRecordEnvelope;if(rt.length>0&&nt==null){const at=new PeerRecord({peerId:this.components.peerId,multiaddrs:rt}),lt=await RecordEnvelope.seal(at,this.components.peerId);await this.components.peerStore.addressBook.consumePeerRecord(lt),nt=lt.marshal().subarray()}const it=Identify.encode({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:et,listenAddrs:rt.map(at=>at.bytes),signedPeerRecord:nt,observedAddr:$.remoteAddr.bytes,protocols:tt.protocols}),st=abortableDuplex(j,_e.signal),ot=pipe([it],encode$5());await st.sink(ot)}catch(et){log$t.error("could not respond to identify request",et)}finally{j.close(),_e.clear()}}async _handlePush(a){const{connection:$,stream:j}=a,_e=new timeoutAbortController.TimeoutController(this.init.timeout);try{events.exports.setMaxListeners?.(1/0,_e.signal)}catch{}let et;try{const rt=abortableDuplex(j,_e.signal),nt=await pipe([],rt,decode$4({maxDataLength:this.init.maxIdentifyMessageSize??MAX_IDENTIFY_MESSAGE_SIZE}),async it=>await first$2(it));nt!=null&&(et=Identify.decode(nt))}catch(rt){return log$t.error("received invalid message",rt)}finally{j.close(),_e.clear()}if(et==null)return log$t.error("received invalid message");const tt=$.remotePeer;if(this.components.peerId.equals(tt)){log$t("received push from ourselves?");return}if(log$t("received push from %p",tt),et.signedPeerRecord!=null){log$t("received signedPeerRecord in push");try{const rt=await RecordEnvelope.openAndCertify(et.signedPeerRecord,PeerRecord.DOMAIN);if(await this.components.peerStore.addressBook.consumePeerRecord(rt)){log$t("consumed signedPeerRecord sent in push"),await this.components.peerStore.protoBook.set(tt,et.protocols);return}else log$t("failed to consume signedPeerRecord sent in push")}catch(rt){log$t("received invalid envelope, discard it and fallback to listenAddrs is available",rt)}}else log$t("did not receive signedPeerRecord in push");try{await this.components.peerStore.addressBook.set(tt,et.listenAddrs.map(rt=>multiaddr(rt)))}catch(rt){log$t.error("received invalid addrs",rt)}try{await this.components.peerStore.protoBook.set(tt,et.protocols)}catch(rt){log$t.error("received invalid protocols",rt)}log$t("handled push from %p",tt)}static getCleanMultiaddr(a){if(a!=null&&a.length>0)try{return multiaddr(a)}catch{}}}var FetchRequest;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{_e.lengthDelimited!==!1&&j.fork(),(_e.writeDefaults===!0||$.identifier!=="")&&(j.uint32(10),j.string($.identifier)),_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={identifier:""},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.identifier=$.string();break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(FetchRequest||(FetchRequest={}));var FetchResponse;(function(_){let a;(function(_e){_e.OK="OK",_e.NOT_FOUND="NOT_FOUND",_e.ERROR="ERROR"})(a=_.StatusCode||(_.StatusCode={}));let $;(function(_e){_e[_e.OK=0]="OK",_e[_e.NOT_FOUND=1]="NOT_FOUND",_e[_e.ERROR=2]="ERROR"})($||($={})),function(_e){_e.codec=()=>enumeration($)}(a=_.StatusCode||(_.StatusCode={}));let j;_.codec=()=>(j==null&&(j=message((_e,et,tt={})=>{tt.lengthDelimited!==!1&&et.fork(),(tt.writeDefaults===!0||_e.status!=null&&$[_e.status]!==0)&&(et.uint32(8),_.StatusCode.codec().encode(_e.status,et)),(tt.writeDefaults===!0||_e.data!=null&&_e.data.byteLength>0)&&(et.uint32(18),et.bytes(_e.data)),tt.lengthDelimited!==!1&&et.ldelim()},(_e,et)=>{const tt={status:a.OK,data:new Uint8Array(0)},rt=et==null?_e.len:_e.pos+et;for(;_e.pos<rt;){const nt=_e.uint32();switch(nt>>>3){case 1:tt.status=_.StatusCode.codec().decode(_e);break;case 2:tt.data=_e.bytes();break;default:_e.skipType(nt&7);break}}return tt})),j),_.encode=_e=>encodeMessage(_e,_.codec()),_.decode=_e=>decodeMessage(_e,_.codec())})(FetchResponse||(FetchResponse={}));const PROTOCOL_VERSION$1="0.0.1",PROTOCOL_NAME$1="fetch",log$s=logger$1("libp2p:fetch");class FetchService{constructor(a,$){this.started=!1,this.components=a,this.protocol=`/${$.protocolPrefix??"libp2p"}/${PROTOCOL_NAME$1}/${PROTOCOL_VERSION$1}`,this.lookupFunctions=new Map,this.handleMessage=this.handleMessage.bind(this),this.init=$}async start(){await this.components.registrar.handle(this.protocol,a=>{this.handleMessage(a).catch($=>{log$s.error($)}).finally(()=>{a.stream.close()})},{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}async fetch(a,$,j={}){log$s("dialing %s to %p",this.protocol,a);const _e=await this.components.connectionManager.openConnection(a,j);let et,tt=j.signal,rt;if(tt==null){et=new timeoutAbortController.TimeoutController(this.init.timeout),tt=et.signal;try{events.exports.setMaxListeners?.(1/0,et.signal)}catch{}}try{rt=await _e.newStream([this.protocol],{signal:tt});const nt=abortableDuplex(rt,tt);return await pipe([FetchRequest.encode({identifier:$})],encode$5(),nt,decode$4(),async function(st){const ot=await first$2(st);if(ot==null)throw errCode(new Error("No data received"),codes$1.ERR_INVALID_MESSAGE);const at=FetchResponse.decode(ot);switch(at.status){case FetchResponse.StatusCode.OK:return at.data;case FetchResponse.StatusCode.NOT_FOUND:return null;case FetchResponse.StatusCode.ERROR:{const lt=new TextDecoder().decode(at.data);throw errCode(new Error("Error in fetch protocol response: "+lt),codes$1.ERR_INVALID_PARAMETERS)}default:throw errCode(new Error("Unknown response status"),codes$1.ERR_INVALID_MESSAGE)}})??null}finally{et?.clear(),rt?.close()}}async handleMessage(a){const{stream:$}=a,j=this;await pipe($,decode$4(),async function*(_e){const et=await first$2(_e);if(et==null)throw errCode(new Error("No data received"),codes$1.ERR_INVALID_MESSAGE);const tt=FetchRequest.decode(et);let rt;const nt=j._getLookupFunction(tt.identifier);if(nt!=null){const it=await nt(tt.identifier);it!=null?rt={status:FetchResponse.StatusCode.OK,data:it}:rt={status:FetchResponse.StatusCode.NOT_FOUND,data:new Uint8Array(0)}}else{const it=new TextEncoder().encode("No lookup function registered for key: "+tt.identifier);rt={status:FetchResponse.StatusCode.ERROR,data:it}}yield FetchResponse.encode(rt)},encode$5(),$)}_getLookupFunction(a){for(const $ of this.lookupFunctions.keys())if(a.startsWith($))return this.lookupFunctions.get($)}registerLookupFunction(a,$){if(this.lookupFunctions.has(a))throw errCode(new Error("Fetch protocol handler for key prefix '"+a+"' already registered"),codes$1.ERR_KEY_ALREADY_EXISTS);this.lookupFunctions.set(a,$)}unregisterLookupFunction(a,$){$!=null&&this.lookupFunctions.get(a)!==$||this.lookupFunctions.delete(a)}}const PING_LENGTH=32,PROTOCOL_VERSION="1.0.0",PROTOCOL_NAME="ping",log$r=logger$1("libp2p:ping");class PingService{constructor(a,$){this.components=a,this.started=!1,this.protocol=`/${$.protocolPrefix}/${PROTOCOL_NAME}/${PROTOCOL_VERSION}`,this.init=$}async start(){await this.components.registrar.handle(this.protocol,this.handleMessage,{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(a){const{stream:$}=a;pipe($,$).catch(j=>{log$r.error(j)})}async ping(a,$={}){log$r("dialing %s to %p",this.protocol,a);const j=Date.now(),_e=randomBytes$3(PING_LENGTH),et=await this.components.connectionManager.openConnection(a,$);let tt,rt=$.signal,nt;if(rt==null){tt=new timeoutAbortController.TimeoutController(this.init.timeout),rt=tt.signal;try{events.exports.setMaxListeners?.(1/0,tt.signal)}catch{}}try{nt=await et.newStream([this.protocol],{signal:rt});const it=abortableDuplex(nt,rt),st=await pipe([_e],it,async at=>await first$2(at)),ot=Date.now();if(st==null||!equals$1(_e,st.subarray()))throw errCode(new Error("Received wrong ping ack"),codes$1.ERR_WRONG_PING_ACK);return ot-j}finally{tt?.clear(),nt?.close()}}}async function upnpNat(){throw new Error("Not supported in browsers")}const isEnvWithDom=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,isElectron=isElectron_1(),isBrowser=isEnvWithDom&&!isElectron,isElectronMain=isElectron&&!isEnvWithDom,isElectronRenderer=isElectron&&isEnvWithDom,isNode=typeof globalThis.process<"u"&&typeof globalThis.process.release<"u"&&globalThis.process.release.name==="node"&&!isElectron,isWebWorker=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope;typeof globalThis.process<"u"&&typeof globalThis.process.env<"u"&&globalThis.process.env["NODE"+(()=>"_")()+"ENV"];const isReactNative=typeof navigator<"u"&&navigator.product==="ReactNative";function isLoopbackAddr(_){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(_)||/^::1$/.test(_)}function isLoopback(_){const{address:a}=_.nodeAddress();return isLoopbackAddr(a)}const log$q=logger$1("libp2p:nat"),DEFAULT_TTL=7200;function highPort(_=1024,a=65535){return Math.floor(Math.random()*(a-_+1)+_)}class NatManager{constructor(a,$){if(this.components=a,this.started=!1,this.enabled=$.enabled,this.externalAddress=$.externalAddress,this.localAddress=$.localAddress,this.description=$.description??`${name}@${version} ${this.components.peerId.toString()}`,this.ttl=$.ttl??DEFAULT_TTL,this.keepAlive=$.keepAlive??!0,this.gateway=$.gateway,this.ttl<DEFAULT_TTL)throw errCode(new Error(`NatManager ttl should be at least ${DEFAULT_TTL} seconds`),codes$1.ERR_INVALID_PARAMETERS)}isStarted(){return this.started}start(){}afterStart(){isBrowser||!this.enabled||this.started||(this.started=!0,this._start().catch(a=>{log$q.error(a)}))}async _start(){const a=this.components.transportManager.getAddrs();for(const $ of a){const{family:j,host:_e,port:et,transport:tt}=$.toOptions();if(!$.isThinWaistAddress()||tt!=="tcp"||isLoopback($)||j!==4)continue;const rt=await this._getClient(),nt=this.externalAddress??await rt.externalIp();if(privateIp(nt))throw new Error(`${nt} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);const it=highPort();log$q(`opening uPnP connection from ${nt}:${it} to ${_e}:${et}`),await rt.map({publicPort:it,localPort:et,localAddress:this.localAddress,protocol:tt.toUpperCase()==="TCP"?"TCP":"UDP"}),this.components.addressManager.addObservedAddr(fromNodeAddress({family:4,address:nt,port:it},tt))}}async _getClient(){return this.client!=null?this.client:(this.client=await upnpNat({description:this.description,ttl:this.ttl,keepAlive:this.keepAlive,gateway:this.gateway}),this.client)}async stop(){if(!(isBrowser||this.client==null))try{await this.client.close(),this.client=void 0}catch(a){log$q.error(a)}}}const log$p=logger$1("libp2p:peer-record-updater");class PeerRecordUpdater{constructor(a){this.components=a,this.started=!1,this.update=this.update.bind(this)}isStarted(){return this.started}async start(){this.started=!0,this.components.transportManager.addEventListener("listener:listening",this.update),this.components.transportManager.addEventListener("listener:close",this.update),this.components.addressManager.addEventListener("change:addresses",this.update)}async stop(){this.started=!1,this.components.transportManager.removeEventListener("listener:listening",this.update),this.components.transportManager.removeEventListener("listener:close",this.update),this.components.addressManager.removeEventListener("change:addresses",this.update)}update(){Promise.resolve().then(async()=>{const a=new PeerRecord({peerId:this.components.peerId,multiaddrs:this.components.addressManager.getAddresses().map(j=>j.decapsulateCode(getProtocol("p2p").code))}),$=await RecordEnvelope.seal(a,this.components.peerId);await this.components.peerStore.addressBook.consumePeerRecord($)}).catch(a=>{log$p.error("Could not update self peer record: %o",a)})}}class DHTPeerRouting{constructor(a){this.dht=a}async findPeer(a,$={}){for await(const j of this.dht.findPeer(a,$))if(j.name==="FINAL_PEER")return j.peer;throw errCode(new Error(messages.NOT_FOUND),codes$1.ERR_NOT_FOUND)}async*getClosestPeers(a,$={}){for await(const j of this.dht.getClosestPeers(a,$))j.name==="FINAL_PEER"&&(yield j.peer)}}const codes={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_NOT_FOUND:"ERR_NOT_FOUND"},all$1=async _=>{const a=[];for await(const $ of _)a.push($);return a};var itAll=all$1;const map$2=async function*(_,a){for await(const $ of _)yield a($)};var itMap$1=map$2;const each=async function*(_,a){for await(const $ of _)await a($),yield $};var itForeach=each;const log$o=logger$1("libp2p:peer-store:address-book"),EVENT_NAME$3="change:multiaddrs";async function allowAll(){return!0}class PeerStoreAddressBook{constructor(a,$,j){this.dispatchEvent=a,this.store=$,this.addressFilter=j??allowAll}async consumePeerRecord(a){log$o.trace("consumePeerRecord await write lock");const $=await this.store.lock.writeLock();log$o.trace("consumePeerRecord got write lock");let j,_e,et;try{let tt;try{tt=PeerRecord.createFromProtobuf(a.payload)}catch{return log$o.error("invalid peer record received"),!1}j=tt.peerId;const rt=tt.multiaddrs;if(!j.equals(a.peerId))return log$o("signing key does not match PeerId in the PeerRecord"),!1;if(rt==null||rt.length===0)return!1;if(await this.store.has(j)&&(_e=await this.store.load(j),_e.peerRecordEnvelope!=null)){const it=await RecordEnvelope.createFromProtobuf(_e.peerRecordEnvelope),st=PeerRecord.createFromProtobuf(it.payload);if(st.seqNumber>=tt.seqNumber)return log$o("sequence number was lower or equal to existing sequence number - stored: %d received: %d",st.seqNumber,tt.seqNumber),!1}const nt=await filterMultiaddrs(j,rt,this.addressFilter,!0);et=await this.store.patchOrCreate(j,{addresses:nt,peerRecordEnvelope:a.marshal().subarray()}),log$o("stored provided peer record for %p",tt.peerId)}finally{log$o.trace("consumePeerRecord release write lock"),$()}return this.dispatchEvent(new CustomEvent$1(EVENT_NAME$3,{detail:{peerId:j,multiaddrs:et.addresses.map(({multiaddr:tt})=>tt),oldMultiaddrs:_e==null?[]:_e.addresses.map(({multiaddr:tt})=>tt)}})),!0}async getRawEnvelope(a){log$o.trace("getRawEnvelope await read lock");const $=await this.store.lock.readLock();log$o.trace("getRawEnvelope got read lock");try{return(await this.store.load(a)).peerRecordEnvelope}catch(j){if(j.code!==codes.ERR_NOT_FOUND)throw j}finally{log$o.trace("getRawEnvelope release read lock"),$()}}async getPeerRecord(a){const $=await this.getRawEnvelope(a);if($!=null)return await RecordEnvelope.createFromProtobuf($)}async get(a){a=peerIdFromPeerId(a),log$o.trace("get wait for read lock");const $=await this.store.lock.readLock();log$o.trace("get got read lock");try{return(await this.store.load(a)).addresses}catch(j){if(j.code!==codes.ERR_NOT_FOUND)throw j}finally{log$o.trace("get release read lock"),$()}return[]}async set(a,$){if(a=peerIdFromPeerId(a),!Array.isArray($))throw log$o.error("multiaddrs must be an array of Multiaddrs"),errCode(new Error("multiaddrs must be an array of Multiaddrs"),codes.ERR_INVALID_PARAMETERS);log$o.trace("set await write lock");const j=await this.store.lock.writeLock();log$o.trace("set got write lock");let _e=!1,et,tt;try{const rt=await filterMultiaddrs(a,$,this.addressFilter);if(rt.length===0)return;try{if(et=await this.store.load(a),_e=!0,new Set([...rt.map(({multiaddr:nt})=>nt.toString()),...et.addresses.map(({multiaddr:nt})=>nt.toString())]).size===et.addresses.length&&rt.length===et.addresses.length)return}catch(nt){if(nt.code!==codes.ERR_NOT_FOUND)throw nt}tt=await this.store.patchOrCreate(a,{addresses:rt}),log$o("set multiaddrs for %p",a)}finally{log$o.trace("set multiaddrs for %p",a),log$o("set release write lock"),j()}this.dispatchEvent(new CustomEvent$1(EVENT_NAME$3,{detail:{peerId:a,multiaddrs:tt.addresses.map(rt=>rt.multiaddr),oldMultiaddrs:et==null?[]:et.addresses.map(({multiaddr:rt})=>rt)}})),_e||this.dispatchEvent(new CustomEvent$1("peer",{detail:{id:a,multiaddrs:tt.addresses.map(rt=>rt.multiaddr),protocols:tt.protocols}}))}async add(a,$){if(a=peerIdFromPeerId(a),!Array.isArray($))throw log$o.error("multiaddrs must be an array of Multiaddrs"),errCode(new Error("multiaddrs must be an array of Multiaddrs"),codes.ERR_INVALID_PARAMETERS);log$o.trace("add await write lock");const j=await this.store.lock.writeLock();log$o.trace("add got write lock");let _e,et,tt;try{const rt=await filterMultiaddrs(a,$,this.addressFilter);if(rt.length===0)return;try{if(et=await this.store.load(a),_e=!0,new Set([...rt.map(({multiaddr:nt})=>nt.toString()),...et.addresses.map(({multiaddr:nt})=>nt.toString())]).size===et.addresses.length)return}catch(nt){if(nt.code!==codes.ERR_NOT_FOUND)throw nt}tt=await this.store.mergeOrCreate(a,{addresses:rt}),log$o("added multiaddrs for %p",a)}finally{log$o.trace("set release write lock"),j()}this.dispatchEvent(new CustomEvent$1(EVENT_NAME$3,{detail:{peerId:a,multiaddrs:tt.addresses.map(rt=>rt.multiaddr),oldMultiaddrs:et==null?[]:et.addresses.map(({multiaddr:rt})=>rt)}})),_e===!0&&this.dispatchEvent(new CustomEvent$1("peer",{detail:{id:a,multiaddrs:tt.addresses.map(rt=>rt.multiaddr),protocols:tt.protocols}}))}async delete(a){a=peerIdFromPeerId(a),log$o.trace("delete await write lock");const $=await this.store.lock.writeLock();log$o.trace("delete got write lock");let j;try{try{j=await this.store.load(a)}catch(_e){if(_e.code!==codes.ERR_NOT_FOUND)throw _e}await this.store.patchOrCreate(a,{addresses:[]})}finally{log$o.trace("delete release write lock"),$()}j!=null&&this.dispatchEvent(new CustomEvent$1(EVENT_NAME$3,{detail:{peerId:a,multiaddrs:[],oldMultiaddrs:j==null?[]:j.addresses.map(({multiaddr:_e})=>_e)}}))}}async function filterMultiaddrs(_,a,$,j=!1){return await pipe(a,_e=>itForeach(_e,et=>{if(!isMultiaddr(et))throw log$o.error("multiaddr must be an instance of Multiaddr"),errCode(new Error("multiaddr must be an instance of Multiaddr"),codes.ERR_INVALID_PARAMETERS)}),_e=>itFilter(_e,async et=>await $(_,et)),_e=>itMap$1(_e,et=>({multiaddr:et,isCertified:j})),async _e=>await itAll(_e))}const log$n=logger$1("libp2p:peer-store:key-book"),EVENT_NAME$2="change:pubkey";class PeerStoreKeyBook{constructor(a,$){this.dispatchEvent=a,this.store=$}async set(a,$){if(a=peerIdFromPeerId(a),!($ instanceof Uint8Array))throw log$n.error("publicKey must be an instance of Uint8Array to store data"),errCode(new Error("publicKey must be an instance of PublicKey"),codes.ERR_INVALID_PARAMETERS);log$n.trace("set await write lock");const j=await this.store.lock.writeLock();log$n.trace("set got write lock");let _e=!1,et;try{try{if(et=await this.store.load(a),et.pubKey!=null&&equals$1(et.pubKey,$))return}catch(tt){if(tt.code!==codes.ERR_NOT_FOUND)throw tt}await this.store.patchOrCreate(a,{pubKey:$}),_e=!0}finally{log$n.trace("set release write lock"),j()}_e&&this.dispatchEvent(new CustomEvent$1(EVENT_NAME$2,{detail:{peerId:a,publicKey:$,oldPublicKey:et?.pubKey}}))}async get(a){a=peerIdFromPeerId(a),log$n.trace("get await write lock");const $=await this.store.lock.readLock();log$n.trace("get got write lock");try{return(await this.store.load(a)).pubKey}catch(j){if(j.code!==codes.ERR_NOT_FOUND)throw j}finally{log$n("get release write lock"),$()}}async delete(a){a=peerIdFromPeerId(a),log$n.trace("delete await write lock");const $=await this.store.lock.writeLock();log$n.trace("delete got write lock");let j;try{try{j=await this.store.load(a)}catch(_e){if(_e.code!==codes.ERR_NOT_FOUND)throw _e}await this.store.patchOrCreate(a,{pubKey:void 0})}catch(_e){if(_e.code!==codes.ERR_NOT_FOUND)throw _e}finally{log$n.trace("delete release write lock"),$()}this.dispatchEvent(new CustomEvent$1(EVENT_NAME$2,{detail:{peerId:a,publicKey:void 0,oldPublicKey:j?.pubKey}}))}}const log$m=logger$1("libp2p:peer-store:metadata-book"),EVENT_NAME$1="change:metadata";class PeerStoreMetadataBook{constructor(a,$){this.dispatchEvent=a,this.store=$}async get(a){a=peerIdFromPeerId(a),log$m.trace("get await read lock");const $=await this.store.lock.readLock();log$m.trace("get got read lock");try{return(await this.store.load(a)).metadata}catch(j){if(j.code!==codes.ERR_NOT_FOUND)throw j}finally{log$m.trace("get release read lock"),$()}return new Map}async getValue(a,$){a=peerIdFromPeerId(a),log$m.trace("getValue await read lock");const j=await this.store.lock.readLock();log$m.trace("getValue got read lock");try{return(await this.store.load(a)).metadata.get($)}catch(_e){if(_e.code!==codes.ERR_NOT_FOUND)throw _e}finally{log$m.trace("getValue release write lock"),j()}}async set(a,$){if(a=peerIdFromPeerId(a),!($ instanceof Map))throw log$m.error("valid metadata must be provided to store data"),errCode(new Error("valid metadata must be provided"),codes.ERR_INVALID_PARAMETERS);log$m.trace("set await write lock");const j=await this.store.lock.writeLock();log$m.trace("set got write lock");let _e;try{try{_e=await this.store.load(a)}catch(et){if(et.code!==codes.ERR_NOT_FOUND)throw et}await this.store.mergeOrCreate(a,{metadata:$})}finally{log$m.trace("set release write lock"),j()}this.dispatchEvent(new CustomEvent$1(EVENT_NAME$1,{detail:{peerId:a,metadata:$,oldMetadata:_e==null?new Map:_e.metadata}}))}async setValue(a,$,j){if(a=peerIdFromPeerId(a),typeof $!="string"||!(j instanceof Uint8Array))throw log$m.error("valid key and value must be provided to store data"),errCode(new Error("valid key and value must be provided"),codes.ERR_INVALID_PARAMETERS);log$m.trace("setValue await write lock");const _e=await this.store.lock.writeLock();log$m.trace("setValue got write lock");let et,tt;try{try{et=await this.store.load(a);const rt=et.metadata.get($);if(rt!=null&&equals$1(j,rt))return}catch(rt){if(rt.code!==codes.ERR_NOT_FOUND)throw rt}tt=await this.store.mergeOrCreate(a,{metadata:new Map([[$,j]])})}finally{log$m.trace("setValue release write lock"),_e()}this.dispatchEvent(new CustomEvent$1(EVENT_NAME$1,{detail:{peerId:a,metadata:tt.metadata,oldMetadata:et==null?new Map:et.metadata}}))}async delete(a){a=peerIdFromPeerId(a),log$m.trace("delete await write lock");const $=await this.store.lock.writeLock();log$m.trace("delete got write lock");let j;try{try{j=await this.store.load(a)}catch(_e){if(_e.code!==codes.ERR_NOT_FOUND)throw _e}j!=null&&await this.store.patch(a,{metadata:new Map})}finally{log$m.trace("delete release write lock"),$()}j!=null&&this.dispatchEvent(new CustomEvent$1(EVENT_NAME$1,{detail:{peerId:a,metadata:new Map,oldMetadata:j.metadata}}))}async deleteValue(a,$){a=peerIdFromPeerId(a),log$m.trace("deleteValue await write lock");const j=await this.store.lock.writeLock();log$m.trace("deleteValue got write lock");let _e,et;try{et=await this.store.load(a),_e=et.metadata,_e.delete($),await this.store.patch(a,{metadata:_e})}catch(tt){if(tt.code!==codes.ERR_NOT_FOUND)throw tt}finally{log$m.trace("deleteValue release write lock"),j()}_e!=null&&this.dispatchEvent(new CustomEvent$1(EVENT_NAME$1,{detail:{peerId:a,metadata:_e,oldMetadata:et==null?new Map:et.metadata}}))}}const log$l=logger$1("libp2p:peer-store:proto-book"),EVENT_NAME="change:protocols";class PeerStoreProtoBook{constructor(a,$){this.dispatchEvent=a,this.store=$}async get(a){log$l.trace("get wait for read lock");const $=await this.store.lock.readLock();log$l.trace("get got read lock");try{return(await this.store.load(a)).protocols}catch(j){if(j.code!==codes.ERR_NOT_FOUND)throw j}finally{log$l.trace("get release read lock"),$()}return[]}async set(a,$){if(a=peerIdFromPeerId(a),!Array.isArray($))throw log$l.error("protocols must be provided to store data"),errCode(new Error("protocols must be provided"),codes.ERR_INVALID_PARAMETERS);log$l.trace("set await write lock");const j=await this.store.lock.writeLock();log$l.trace("set got write lock");let _e,et;try{try{if(_e=await this.store.load(a),new Set([...$]).size===_e.protocols.length)return}catch(tt){if(tt.code!==codes.ERR_NOT_FOUND)throw tt}et=await this.store.patchOrCreate(a,{protocols:$}),log$l("stored provided protocols for %p",a)}finally{log$l.trace("set release write lock"),j()}this.dispatchEvent(new CustomEvent$1(EVENT_NAME,{detail:{peerId:a,protocols:et.protocols,oldProtocols:_e==null?[]:_e.protocols}}))}async add(a,$){if(a=peerIdFromPeerId(a),!Array.isArray($))throw log$l.error("protocols must be provided to store data"),errCode(new Error("protocols must be provided"),codes.ERR_INVALID_PARAMETERS);log$l.trace("add await write lock");const j=await this.store.lock.writeLock();log$l.trace("add got write lock");let _e,et;try{try{if(_e=await this.store.load(a),new Set([..._e.protocols,...$]).size===_e.protocols.length)return}catch(tt){if(tt.code!==codes.ERR_NOT_FOUND)throw tt}et=await this.store.mergeOrCreate(a,{protocols:$}),log$l("added provided protocols for %p",a)}finally{log$l.trace("add release write lock"),j()}this.dispatchEvent(new CustomEvent$1(EVENT_NAME,{detail:{peerId:a,protocols:et.protocols,oldProtocols:_e==null?[]:_e.protocols}}))}async remove(a,$){if(a=peerIdFromPeerId(a),!Array.isArray($))throw log$l.error("protocols must be provided to store data"),errCode(new Error("protocols must be provided"),codes.ERR_INVALID_PARAMETERS);log$l.trace("remove await write lock");const j=await this.store.lock.writeLock();log$l.trace("remove got write lock");let _e,et;try{try{_e=await this.store.load(a);const tt=new Set(_e.protocols);for(const rt of $)tt.delete(rt);if(_e.protocols.length===tt.size)return;$=Array.from(tt)}catch(tt){if(tt.code!==codes.ERR_NOT_FOUND)throw tt}et=await this.store.patchOrCreate(a,{protocols:$})}finally{log$l.trace("remove release write lock"),j()}this.dispatchEvent(new CustomEvent$1(EVENT_NAME,{detail:{peerId:a,protocols:et.protocols,oldProtocols:_e==null?[]:_e.protocols}}))}async delete(a){a=peerIdFromPeerId(a),log$l.trace("delete await write lock");const $=await this.store.lock.writeLock();log$l.trace("delete got write lock");let j;try{try{j=await this.store.load(a)}catch(_e){if(_e.code!==codes.ERR_NOT_FOUND)throw _e}await this.store.patchOrCreate(a,{protocols:[]})}finally{log$l.trace("delete release write lock"),$()}j!=null&&this.dispatchEvent(new CustomEvent$1(EVENT_NAME,{detail:{peerId:a,protocols:[],oldProtocols:j.protocols}}))}}var Peer;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{if(_e.lengthDelimited!==!1&&j.fork(),$.addresses!=null)for(const et of $.addresses)j.uint32(10),Address.codec().encode(et,j,{writeDefaults:!0});if($.protocols!=null)for(const et of $.protocols)j.uint32(18),j.string(et);if($.metadata!=null)for(const et of $.metadata)j.uint32(26),Metadata.codec().encode(et,j,{writeDefaults:!0});$.pubKey!=null&&(j.uint32(34),j.bytes($.pubKey)),$.peerRecordEnvelope!=null&&(j.uint32(42),j.bytes($.peerRecordEnvelope)),_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={addresses:[],protocols:[],metadata:[]},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.addresses.push(Address.codec().decode($,$.uint32()));break;case 2:_e.protocols.push($.string());break;case 3:_e.metadata.push(Metadata.codec().decode($,$.uint32()));break;case 4:_e.pubKey=$.bytes();break;case 5:_e.peerRecordEnvelope=$.bytes();break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(Peer||(Peer={}));var Address;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{_e.lengthDelimited!==!1&&j.fork(),(_e.writeDefaults===!0||$.multiaddr!=null&&$.multiaddr.byteLength>0)&&(j.uint32(10),j.bytes($.multiaddr)),$.isCertified!=null&&(j.uint32(16),j.bool($.isCertified)),_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={multiaddr:new Uint8Array(0)},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.multiaddr=$.bytes();break;case 2:_e.isCertified=$.bool();break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(Address||(Address={}));var Metadata;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{_e.lengthDelimited!==!1&&j.fork(),(_e.writeDefaults===!0||$.key!=="")&&(j.uint32(10),j.string($.key)),(_e.writeDefaults===!0||$.value!=null&&$.value.byteLength>0)&&(j.uint32(18),j.bytes($.value)),_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={key:"",value:new Uint8Array(0)},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.key=$.string();break;case 2:_e.value=$.bytes();break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(Metadata||(Metadata={}));const log$k=logger$1("libp2p:peer-store:store"),NAMESPACE_COMMON="/peers/";class PersistentStore{constructor(a){this.components=a,this.lock=createMortice({name:"peer-store",singleProcess:!0})}_peerIdToDatastoreKey(a){if(a.type==null)throw log$k.error("peerId must be an instance of peer-id to store data"),errCode(new Error("peerId must be an instance of peer-id"),codes.ERR_INVALID_PARAMETERS);const $=a.toCID().toString();return new Key(`${NAMESPACE_COMMON}${$}`)}async has(a){return await this.components.datastore.has(this._peerIdToDatastoreKey(a))}async delete(a){await this.components.datastore.delete(this._peerIdToDatastoreKey(a))}async load(a){const $=await this.components.datastore.get(this._peerIdToDatastoreKey(a)),j=Peer.decode($),_e=new Map;for(const et of j.metadata)_e.set(et.key,et.value);return{...j,id:a,addresses:j.addresses.map(({multiaddr:et,isCertified:tt})=>({multiaddr:multiaddr(et),isCertified:tt??!1})),metadata:_e,pubKey:j.pubKey??void 0,peerRecordEnvelope:j.peerRecordEnvelope??void 0}}async save(a){if(a.pubKey!=null&&a.id.publicKey!=null&&!equals$1(a.pubKey,a.id.publicKey))throw log$k.error("peer publicKey bytes do not match peer id publicKey bytes"),errCode(new Error("publicKey bytes do not match peer id publicKey bytes"),codes.ERR_INVALID_PARAMETERS);const $=new Set,j=a.addresses.filter(tt=>$.has(tt.multiaddr.toString())?!1:($.add(tt.multiaddr.toString()),!0)).sort((tt,rt)=>tt.multiaddr.toString().localeCompare(rt.multiaddr.toString())).map(({multiaddr:tt,isCertified:rt})=>({multiaddr:tt.bytes,isCertified:rt})),_e=[];[...a.metadata.keys()].sort().forEach(tt=>{const rt=a.metadata.get(tt);rt!=null&&_e.push({key:tt,value:rt})});const et=Peer.encode({addresses:j,protocols:a.protocols.sort(),pubKey:a.pubKey,metadata:_e,peerRecordEnvelope:a.peerRecordEnvelope});return await this.components.datastore.put(this._peerIdToDatastoreKey(a.id),et.subarray()),await this.load(a.id)}async patch(a,$){const j=await this.load(a);return await this._patch(a,$,j)}async patchOrCreate(a,$){let j;try{j=await this.load(a)}catch(_e){if(_e.code!==codes.ERR_NOT_FOUND)throw _e;j={id:a,addresses:[],protocols:[],metadata:new Map}}return await this._patch(a,$,j)}async _patch(a,$,j){return await this.save({...j,...$,id:a})}async merge(a,$){const j=await this.load(a);return await this._merge(a,$,j)}async mergeOrCreate(a,$){let j;try{j=await this.load(a)}catch(_e){if(_e.code!==codes.ERR_NOT_FOUND)throw _e;j={id:a,addresses:[],protocols:[],metadata:new Map}}return await this._merge(a,$,j)}async _merge(a,$,j){const _e=new Map;return j.addresses.forEach(et=>{_e.set(et.multiaddr.toString(),et.isCertified)}),($.addresses??[]).forEach(et=>{const tt=et.multiaddr.toString(),nt=Boolean(_e.get(tt))||et.isCertified;_e.set(tt,nt)}),await this.save({id:a,addresses:Array.from(_e.entries()).map(([et,tt])=>({multiaddr:multiaddr(et),isCertified:tt})),protocols:Array.from(new Set([...j.protocols??[],...$.protocols??[]])),metadata:new Map([...j.metadata?.entries()??[],...$.metadata?.entries()??[]]),pubKey:$.pubKey??j?.pubKey,peerRecordEnvelope:$.peerRecordEnvelope??j?.peerRecordEnvelope})}async*all(){for await(const a of this.components.datastore.queryKeys({prefix:NAMESPACE_COMMON})){const $=a.toString().split("/")[2],j=base32$4.decode($);yield this.load(peerIdFromBytes(j))}}}var Tags;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{if(_e.lengthDelimited!==!1&&j.fork(),$.tags!=null)for(const et of $.tags)j.uint32(10),Tag.codec().encode(et,j,{writeDefaults:!0});_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={tags:[]},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.tags.push(Tag.codec().decode($,$.uint32()));break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(Tags||(Tags={}));var Tag;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{_e.lengthDelimited!==!1&&j.fork(),(_e.writeDefaults===!0||$.name!=="")&&(j.uint32(10),j.string($.name)),$.value!=null&&(j.uint32(16),j.uint32($.value)),$.expiry!=null&&(j.uint32(24),j.uint64($.expiry)),_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={name:""},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.name=$.string();break;case 2:_e.value=$.uint32();break;case 3:_e.expiry=$.uint64();break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(Tag||(Tag={}));const log$j=logger$1("libp2p:peer-store");class PersistentPeerStore extends EventEmitter$1{constructor(a,$={}){super(),this.components=a,this.store=new PersistentStore(a),this.addressBook=new PeerStoreAddressBook(this.dispatchEvent.bind(this),this.store,$.addressFilter),this.keyBook=new PeerStoreKeyBook(this.dispatchEvent.bind(this),this.store),this.metadataBook=new PeerStoreMetadataBook(this.dispatchEvent.bind(this),this.store),this.protoBook=new PeerStoreProtoBook(this.dispatchEvent.bind(this),this.store)}async forEach(a){log$j.trace("getPeers await read lock");const $=await this.store.lock.readLock();log$j.trace("getPeers got read lock");try{for await(const j of this.store.all())j.id.equals(this.components.peerId)||a(j)}finally{log$j.trace("getPeers release read lock"),$()}}async all(){const a=[];return await this.forEach($=>{a.push($)}),a}async delete(a){log$j.trace("delete await write lock");const $=await this.store.lock.writeLock();log$j.trace("delete got write lock");try{await this.store.delete(a)}finally{log$j.trace("delete release write lock"),$()}}async get(a){log$j.trace("get await read lock");const $=await this.store.lock.readLock();log$j.trace("get got read lock");try{return await this.store.load(a)}finally{log$j.trace("get release read lock"),$()}}async has(a){log$j.trace("has await read lock");const $=await this.store.lock.readLock();log$j.trace("has got read lock");try{return await this.store.has(a)}finally{log$j.trace("has release read lock"),$()}}async tagPeer(a,$,j={}){const _e=j.value??0,et=Math.round(_e),tt=j.ttl??void 0;if(et!==_e||et<0||et>100)throw errCode(new Error("Tag value must be between 0-100"),"ERR_TAG_VALUE_OUT_OF_BOUNDS");const rt=await this.metadataBook.getValue(a,"tags");let nt=[];rt!=null&&(nt=Tags.decode(rt).tags);for(const it of nt)if(it.name===$)throw errCode(new Error("Peer already tagged"),"ERR_DUPLICATE_TAG");nt.push({name:$,value:et,expiry:tt==null?void 0:BigInt(Date.now()+tt)}),await this.metadataBook.setValue(a,"tags",Tags.encode({tags:nt}).subarray())}async unTagPeer(a,$){const j=await this.metadataBook.getValue(a,"tags");let _e=[];j!=null&&(_e=Tags.decode(j).tags),_e=_e.filter(et=>et.name!==$),await this.metadataBook.setValue(a,"tags",Tags.encode({tags:_e}).subarray())}async getTags(a){const $=await this.metadataBook.getValue(a,"tags");let j=[];$!=null&&(j=Tags.decode($).tags);const _e=BigInt(Date.now()),et=j.filter(tt=>tt.expiry==null||tt.expiry>_e);return et.length!==j.length&&await this.metadataBook.setValue(a,"tags",Tags.encode({tags:et}).subarray()),et.map(tt=>({name:tt.name,value:tt.value??0}))}}class DHTContentRouting{constructor(a){this.dht=a}async provide(a){await drain$3(this.dht.provide(a))}async*findProviders(a,$={}){for await(const j of this.dht.findProviders(a,$))j.name==="PROVIDER"&&(yield*j.providers)}async put(a,$,j){await drain$3(this.dht.put(a,$,j))}async get(a,$){for await(const j of this.dht.get(a,$))if(j.name==="VALUE")return j.value;throw errCode(new Error("Not found"),"ERR_NOT_FOUND")}}class DefaultComponents{constructor(a={}){this._started=!1,this._peerId=a.peerId,this._addressManager=a.addressManager,this._peerStore=a.peerStore,this._upgrader=a.upgrader,this._metrics=a.metrics,this._registrar=a.registrar,this._connectionManager=a.connectionManager,this._transportManager=a.transportManager,this._connectionGater=a.connectionGater,this._contentRouting=a.contentRouting,this._peerRouting=a.peerRouting,this._datastore=a.datastore,this._connectionProtector=a.connectionProtector,this._dht=a.dht,this._pubsub=a.pubsub,this._dialer=a.dialer}isStarted(){return this._started}async beforeStart(){await Promise.all(Object.values(this).filter(a=>isStartable(a)).map(async a=>{a.beforeStart!=null&&await a.beforeStart()}))}async start(){await Promise.all(Object.values(this).filter(a=>isStartable(a)).map(async a=>{await a.start()})),this._started=!0}async afterStart(){await Promise.all(Object.values(this).filter(a=>isStartable(a)).map(async a=>{a.afterStart!=null&&await a.afterStart()}))}async beforeStop(){await Promise.all(Object.values(this).filter(a=>isStartable(a)).map(async a=>{a.beforeStop!=null&&await a.beforeStop()}))}async stop(){await Promise.all(Object.values(this).filter(a=>isStartable(a)).map(async a=>{await a.stop()})),this._started=!1}async afterStop(){await Promise.all(Object.values(this).filter(a=>isStartable(a)).map(async a=>{a.afterStop!=null&&await a.afterStop()}))}get peerId(){if(this._peerId==null)throw errCode(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this._peerId}set peerId(a){this._peerId=a}get addressManager(){if(this._addressManager==null)throw errCode(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this._addressManager}set addressManager(a){this._addressManager=a}get peerStore(){if(this._peerStore==null)throw errCode(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this._peerStore}set peerStore(a){this._peerStore=a}get upgrader(){if(this._upgrader==null)throw errCode(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this._upgrader}set upgrader(a){this._upgrader=a}get registrar(){if(this._registrar==null)throw errCode(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this._registrar}set registrar(a){this._registrar=a}get connectionManager(){if(this._connectionManager==null)throw errCode(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this._connectionManager}set connectionManager(a){this._connectionManager=a}get transportManager(){if(this._transportManager==null)throw errCode(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this._transportManager}set transportManager(a){this._transportManager=a}get connectionGater(){if(this._connectionGater==null)throw errCode(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this._connectionGater}set connectionGater(a){this._connectionGater=a}get contentRouting(){if(this._contentRouting==null)throw errCode(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this._contentRouting}set contentRouting(a){this._contentRouting=a}get peerRouting(){if(this._peerRouting==null)throw errCode(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this._peerRouting}set peerRouting(a){this._peerRouting=a}get datastore(){if(this._datastore==null)throw errCode(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this._datastore}set datastore(a){this._datastore=a}get connectionProtector(){return this._connectionProtector}set connectionProtector(a){this._connectionProtector=a}get dialer(){if(this._dialer==null)throw errCode(new Error("dialer not set"),"ERR_SERVICE_MISSING");return this._dialer}set dialer(a){this._dialer=a}get metrics(){return this._metrics}set metrics(a){this._metrics=a}get dht(){return this._dht}set dht(a){this._dht=a}get pubsub(){return this._pubsub}set pubsub(a){this._pubsub=a}}var s=1e3,m=s*60,h=m*60,d=h*24,w=d*7,y=d*365.25,ms=function(_,a){a=a||{};var $=typeof _;if($==="string"&&_.length>0)return parse(_);if($==="number"&&isFinite(_))return a.long?fmtLong(_):fmtShort(_);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(_))};function parse(_){if(_=String(_),!(_.length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(_);if(!!a){var $=parseFloat(a[1]),j=(a[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return $*y;case"weeks":case"week":case"w":return $*w;case"days":case"day":case"d":return $*d;case"hours":case"hour":case"hrs":case"hr":case"h":return $*h;case"minutes":case"minute":case"mins":case"min":case"m":return $*m;case"seconds":case"second":case"secs":case"sec":case"s":return $*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return $;default:return}}}}function fmtShort(_){var a=Math.abs(_);return a>=d?Math.round(_/d)+"d":a>=h?Math.round(_/h)+"h":a>=m?Math.round(_/m)+"m":a>=s?Math.round(_/s)+"s":_+"ms"}function fmtLong(_){var a=Math.abs(_);return a>=d?plural(_,a,d,"day"):a>=h?plural(_,a,h,"hour"):a>=m?plural(_,a,m,"minute"):a>=s?plural(_,a,s,"second"):_+" ms"}function plural(_,a,$,j){var _e=a>=$*1.5;return Math.round(_/$)+" "+j+(_e?"s":"")}var receptacle=Receptacle,toMS=ms,cache=Receptacle.prototype,counter=new Date%1e9;function getUID(){return(Math.random()*1e9>>>0)+counter++}function Receptacle(_){_=_||{},this.id=_.id||getUID(),this.max=_.max||1/0,this.items=_.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(_.lastModified||new Date);for(var a,$,j=this.items.length;j--;)a=this.items[j],$=new Date(a.expires)-new Date,this._lookup[a.key]=a,$>0?this.expire(a.key,$):$<=0&&this.delete(a.key)}cache.has=function(_){return _ in this._lookup};cache.get=function(_){if(!this.has(_))return null;var a=this._lookup[_];return a.refresh&&this.expire(_,a.refresh),this.items.splice(this.items.indexOf(a),1),this.items.push(a),a.value};cache.meta=function(_){if(!this.has(_))return null;var a=this._lookup[_];return"meta"in a?a.meta:null};cache.set=function(_,a,$){var j=this._lookup[_],_e=this._lookup[_]={key:_,value:a};return this.lastModified=new Date,j?(clearTimeout(j.timeout),this.items.splice(this.items.indexOf(j),1,_e)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(_e),this.size++),$&&("ttl"in $&&this.expire(_,$.ttl),"meta"in $&&(_e.meta=$.meta),$.refresh&&(_e.refresh=$.ttl)),this};cache.delete=function(_){var a=this._lookup[_];return a?(this.lastModified=new Date,this.items.splice(this.items.indexOf(a),1),clearTimeout(a.timeout),delete this._lookup[_],this.size--,this):!1};cache.expire=function(_,a){var $=a||0,j=this._lookup[_];if(!j)return this;if(typeof $=="string"&&($=toMS(a)),typeof $!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(j.timeout),j.timeout=setTimeout(this.delete.bind(this,j.key),$),j.expires=Number(new Date)+$,this};cache.clear=function(){for(var _=this.items.length;_--;)this.delete(this.items[_].key);return this};cache.toJSON=function(){for(var _=new Array(this.items.length),a,$=_.length;$--;)a=this.items[$],_[$]={key:a.key,meta:a.meta,value:a.value,expires:a.expires,refresh:a.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:_}};const globalFetch=globalThis.fetch,globalHeaders=globalThis.Headers;function buildResource(_,a,$){return`${_}?name=${a}&type=${$}`}async function request(_,a){return await(await globalFetch(_,{headers:new globalHeaders({accept:"application/dns-json"}),signal:a})).json()}function getCacheKey(_,a){return`${a}_${_}`}const log$i=Object.assign(debug("dns-over-http-resolver"),{error:debug("dns-over-http-resolver:error")});class Resolver{constructor(a={}){this._cache=new receptacle({max:a?.maxCache??100}),this._TXTcache=new receptacle({max:a?.maxCache??100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=a.request??request,this._abortControllers=[]}cancel(){this._abortControllers.forEach(a=>a.abort())}getServers(){return this._servers}_getShuffledServers(){const a=[...this._servers];for(let $=a.length-1;$>0;$--){const j=Math.floor(Math.random()*$),_e=a[$];a[$]=a[j],a[j]=_e}return a}setServers(a){this._servers=a}async resolve(a,$="A"){switch($){case"A":return await this.resolve4(a);case"AAAA":return await this.resolve6(a);case"TXT":return await this.resolveTxt(a);default:throw new Error(`${$} is not supported`)}}async resolve4(a){const $="A",j=this._cache.get(getCacheKey(a,$));if(j!=null)return j;let _e=!1;for(const et of this._getShuffledServers()){const tt=new AbortController;this._abortControllers.push(tt);try{const rt=await this._request(buildResource(et,a,$),tt.signal),nt=rt.Answer.map(st=>st.data),it=Math.min(...rt.Answer.map(st=>st.TTL));return this._cache.set(getCacheKey(a,$),nt,{ttl:it}),nt}catch{tt.signal.aborted&&(_e=!0),log$i.error(`${et} could not resolve ${a} record ${$}`)}finally{this._abortControllers=this._abortControllers.filter(rt=>rt!==tt)}}throw _e?Object.assign(new Error("queryA ECANCELLED"),{code:"ECANCELLED"}):new Error(`Could not resolve ${a} record ${$}`)}async resolve6(a){const $="AAAA",j=this._cache.get(getCacheKey(a,$));if(j!=null)return j;let _e=!1;for(const et of this._getShuffledServers()){const tt=new AbortController;this._abortControllers.push(tt);try{const rt=await this._request(buildResource(et,a,$),tt.signal),nt=rt.Answer.map(st=>st.data),it=Math.min(...rt.Answer.map(st=>st.TTL));return this._cache.set(getCacheKey(a,$),nt,{ttl:it}),nt}catch{tt.signal.aborted&&(_e=!0),log$i.error(`${et} could not resolve ${a} record ${$}`)}finally{this._abortControllers=this._abortControllers.filter(rt=>rt!==tt)}}throw _e?Object.assign(new Error("queryAaaa ECANCELLED"),{code:"ECANCELLED"}):new Error(`Could not resolve ${a} record ${$}`)}async resolveTxt(a){const $="TXT",j=this._TXTcache.get(getCacheKey(a,$));if(j!=null)return j;let _e=!1;for(const et of this._getShuffledServers()){const tt=new AbortController;this._abortControllers.push(tt);try{const rt=await this._request(buildResource(et,a,$),tt.signal),nt=rt.Answer.map(st=>[st.data.replace(/['"]+/g,"")]),it=Math.min(...rt.Answer.map(st=>st.TTL));return this._TXTcache.set(getCacheKey(a,$),nt,{ttl:it}),nt}catch{tt.signal.aborted&&(_e=!0),log$i.error(`${et} could not resolve ${a} record ${$}`)}finally{this._abortControllers=this._abortControllers.filter(rt=>rt!==tt)}}throw _e?Object.assign(new Error("queryTxt ECANCELLED"),{code:"ECANCELLED"}):new Error(`Could not resolve ${a} record ${$}`)}clearCache(){this._cache.clear(),this._TXTcache.clear()}}const{code:dnsaddrCode}=getProtocol("dnsaddr");async function dnsaddrResolver(_,a={}){const $=new Resolver;a.signal!=null&&a.signal.addEventListener("abort",()=>{$.cancel()});const j=_.getPeerId(),[,_e]=_.stringTuples().find(([rt])=>rt===dnsaddrCode)??[];if(_e==null)throw new Error("No hostname found in multiaddr");let tt=(await $.resolveTxt(`_dnsaddr.${_e}`)).flat().map(rt=>rt.split("=")[1]);return j!=null&&(tt=tt.filter(rt=>rt.includes(j))),tt}const DefaultConfig={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:_=>_},connectionManager:{maxConnections:300,minConnections:50,autoDial:!0,autoDialInterval:1e4,maxParallelDials:MAX_PARALLEL_DIALS,maxDialsPerPeer:MAX_PER_PEER_DIALS,dialTimeout:DIAL_TIMEOUT,inboundUpgradeTimeout:INBOUND_UPGRADE_TIMEOUT,resolvers:{dnsaddr:dnsaddrResolver},addressSorter:publicAddressesFirst},connectionGater:{},transportManager:{faultTolerance:FaultTolerance.FATAL_ALL},metrics:{enabled:!1,computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0},relay:{enabled:!0,advertise:{bootDelay:ADVERTISE_BOOT_DELAY,enabled:!1,ttl:ADVERTISE_TTL},hop:{enabled:!1,active:!1,timeout:3e4},autoRelay:{enabled:!1,maxListeners:2}},identify:{protocolPrefix:"ipfs",host:{agentVersion:AGENT_VERSION},timeout:6e4,maxInboundStreams:1,maxOutboundStreams:1,maxPushIncomingStreams:1,maxPushOutgoingStreams:1},ping:{protocolPrefix:"ipfs",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4},fetch:{protocolPrefix:"libp2p",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4}};function validateConfig(_){const a=mergeOptions$g(DefaultConfig,_);if(a.transports==null||a.transports.length<1)throw errCode(new Error(messages.ERR_TRANSPORTS_REQUIRED),codes$1.ERR_TRANSPORTS_REQUIRED);if(a.connectionEncryption==null||a.connectionEncryption.length===0)throw errCode(new Error(messages.CONN_ENCRYPTION_REQUIRED),codes$1.CONN_ENCRYPTION_REQUIRED);if(a.connectionProtector===null&&globalThis.process?.env?.LIBP2P_FORCE_PNET!=null)throw errCode(new Error(messages.ERR_PROTECTOR_REQUIRED),codes$1.ERR_PROTECTOR_REQUIRED);return a.identify.host.agentVersion===AGENT_VERSION&&(isNode||isElectronMain?a.identify.host.agentVersion+=` UserAgent=${globalThis.process.version}`:(isBrowser||isWebWorker||isElectronRenderer||isReactNative)&&(a.identify.host.agentVersion+=` UserAgent=${globalThis.navigator.userAgent}`)),a}var PeerIdProto;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{_e.lengthDelimited!==!1&&j.fork(),(_e.writeDefaults===!0||$.id!=null&&$.id.byteLength>0)&&(j.uint32(10),j.bytes($.id)),$.pubKey!=null&&(j.uint32(18),j.bytes($.pubKey)),$.privKey!=null&&(j.uint32(26),j.bytes($.privKey)),_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={id:new Uint8Array(0)},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.id=$.bytes();break;case 2:_e.pubKey=$.bytes();break;case 3:_e.privKey=$.bytes();break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(PeerIdProto||(PeerIdProto={}));const createEd25519PeerId=async()=>{const _=await generateKeyPair("Ed25519"),a=await createFromPrivKey(_);if(a.type==="Ed25519")return a;throw new Error(`Generated unexpected PeerId type "${a.type}"`)},createRSAPeerId=async _=>{const a=await generateKeyPair("RSA",_?.bits??2048),$=await createFromPrivKey(a);if($.type==="RSA")return $;throw new Error(`Generated unexpected PeerId type "${$.type}"`)};async function createFromPrivKey(_){return await peerIdFromKeys(marshalPublicKey(_.public),marshalPrivateKey(_))}class DummyDHT extends EventEmitter$1{get[symbol$1](){return!0}get[Symbol.toStringTag](){return"@libp2p/dummy-dht"}get wan(){throw errCode(new Error(messages.DHT_DISABLED),codes$1.DHT_DISABLED)}get lan(){throw errCode(new Error(messages.DHT_DISABLED),codes$1.DHT_DISABLED)}get(){throw errCode(new Error(messages.DHT_DISABLED),codes$1.DHT_DISABLED)}findProviders(){throw errCode(new Error(messages.DHT_DISABLED),codes$1.DHT_DISABLED)}findPeer(){throw errCode(new Error(messages.DHT_DISABLED),codes$1.DHT_DISABLED)}getClosestPeers(){throw errCode(new Error(messages.DHT_DISABLED),codes$1.DHT_DISABLED)}provide(){throw errCode(new Error(messages.DHT_DISABLED),codes$1.DHT_DISABLED)}put(){throw errCode(new Error(messages.DHT_DISABLED),codes$1.DHT_DISABLED)}async getMode(){throw errCode(new Error(messages.DHT_DISABLED),codes$1.DHT_DISABLED)}async setMode(){throw errCode(new Error(messages.DHT_DISABLED),codes$1.DHT_DISABLED)}async refreshRoutingTable(){throw errCode(new Error(messages.DHT_DISABLED),codes$1.DHT_DISABLED)}}class DummyPubSub extends EventEmitter$1{constructor(){super(...arguments),this.topicValidators=new Map}isStarted(){return!1}start(){}stop(){}get globalSignaturePolicy(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$1.ERR_PUBSUB_DISABLED)}get multicodecs(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$1.ERR_PUBSUB_DISABLED)}getPeers(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$1.ERR_PUBSUB_DISABLED)}getTopics(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$1.ERR_PUBSUB_DISABLED)}subscribe(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$1.ERR_PUBSUB_DISABLED)}unsubscribe(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$1.ERR_PUBSUB_DISABLED)}getSubscribers(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$1.ERR_PUBSUB_DISABLED)}async publish(){throw errCode(new Error(messages.PUBSUB_DISABLED),codes$1.ERR_PUBSUB_DISABLED)}}class AbortError$1 extends Error{constructor(a="The operation was aborted"){super(a),this.code=AbortError$1.code,this.type=AbortError$1.type}static get code(){return"ABORT_ERR"}static get type(){return"aborted"}}const pDefer$1=()=>{const _={};return _.promise=new Promise((a,$)=>{_.resolve=a,_.reject=$}),_};var pDefer_1$1=pDefer$1;const Fifo=fastFifo,defer$1=pDefer_1$1;var pFifo=class{constructor(){this._buffer=new Fifo,this._waitingConsumers=new Fifo}push(a){const{promise:$,resolve:j}=defer$1();return this._buffer.push({chunk:a,resolve:j}),this._consume(),$}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){const a=this._waitingConsumers.shift(),$=this._buffer.shift();a.resolve($.chunk),$.resolve()}}shift(){const{promise:a,resolve:$}=defer$1();return this._waitingConsumers.push({resolve:$}),this._consume(),a}isEmpty(){return this._buffer.isEmpty()}};const log$h=logger$1("libp2p:dialer:dial-request");class DialRequest{constructor(a){const{addrs:$,dialAction:j,dialer:_e}=a;this.addrs=$,this.dialer=_e,this.dialAction=j}async run(a={}){const $=this.dialer.getTokens(this.addrs.length);if($.length<1)throw errCode(new Error("No dial tokens available"),codes$1.ERR_NO_DIAL_TOKENS);const j=new pFifo;for(const rt of $)j.push(rt).catch(nt=>{log$h.error(nt)});const _e=this.addrs.map(()=>{const rt=new AbortController;try{events.exports.setMaxListeners?.(1/0,rt.signal)}catch{}return rt});if(a.signal!=null)try{events.exports.setMaxListeners?.(1/0,a.signal)}catch{}let et=0,tt=!1;try{return await Promise.any(this.addrs.map(async(rt,nt)=>{const it=await j.shift();if(tt)throw this.dialer.releaseToken($.splice($.indexOf(it),1)[0]),errCode(new Error("dialAction already succeeded"),codes$1.ERR_ALREADY_SUCCEEDED);const st=_e[nt];if(st==null)throw errCode(new Error("dialAction did not come with an AbortController"),codes$1.ERR_INVALID_PARAMETERS);let ot;try{const at=st.signal;ot=await this.dialAction(rt,{...a,signal:a.signal!=null?anySignal_2([at,a.signal]):at}),_e[nt]=void 0}finally{et++,this.addrs.length-et>=$.length?j.push(it).catch(at=>{log$h.error(at)}):this.dialer.releaseToken($.splice($.indexOf(it),1)[0])}if(ot==null)throw errCode(new Error("dialAction led to empty object"),codes$1.ERR_TRANSPORT_DIAL_FAILED);return tt=!0,ot}))}finally{_e.forEach(rt=>{rt!==void 0&&rt.abort()}),$.forEach(rt=>this.dialer.releaseToken(rt))}}}const log$g=logger$1("libp2p:dialer"),METRICS_COMPONENT="dialler",METRICS_PENDING_DIALS="pending-dials",METRICS_PENDING_DIAL_TARGETS="pending-dial-targets";class DefaultDialer{constructor(a,$={}){this.started=!1,this.addressSorter=$.addressSorter??publicAddressesFirst,this.maxAddrsToDial=$.maxAddrsToDial??MAX_ADDRS_TO_DIAL,this.timeout=$.dialTimeout??DIAL_TIMEOUT,this.maxDialsPerPeer=$.maxDialsPerPeer??MAX_PER_PEER_DIALS,this.tokens=[...new Array($.maxParallelDials??MAX_PARALLEL_DIALS)].map((j,_e)=>_e),this.components=a,this.pendingDials=trackedMap({component:METRICS_COMPONENT,metric:METRICS_PENDING_DIALS,metrics:$.metrics}),this.pendingDialTargets=trackedMap({component:METRICS_COMPONENT,metric:METRICS_PENDING_DIAL_TARGETS,metrics:a.metrics});for(const[j,_e]of Object.entries($.resolvers??{}))resolvers$1.set(j,_e)}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1;for(const a of this.pendingDials.values())try{a.controller.abort()}catch($){log$g.error($)}this.pendingDials.clear();for(const a of this.pendingDialTargets.values())a.reject(new AbortError$1("Dialer was destroyed"));this.pendingDialTargets.clear()}async dial(a,$={}){const{id:j,multiaddrs:_e}=getPeer(a);if(this.components.peerId.equals(j))throw errCode(new Error("Tried to dial self"),codes$1.ERR_DIALED_SELF);if(log$g("check multiaddrs %p",j),_e!=null&&_e.length>0&&(log$g("storing multiaddrs %p",j,_e),await this.components.peerStore.addressBook.add(j,_e)),await this.components.connectionGater.denyDialPeer(j))throw errCode(new Error("The dial request is blocked by gater.allowDialPeer"),codes$1.ERR_PEER_DIAL_INTERCEPTED);log$g("creating dial target for %p",j);const et=await this._createCancellableDialTarget(j,$);if(et.addrs.length===0)throw errCode(new Error("The dial request has no valid addresses"),codes$1.ERR_NO_VALID_ADDRESSES);const tt=this.pendingDials.get(et.id)??this._createPendingDial(et,$);try{const rt=await tt.promise;return log$g("dial succeeded to %s",et.id),rt}catch(rt){throw log$g("dial failed to %s",et.id,rt),tt.controller.signal.aborted&&(rt.code=codes$1.ERR_TIMEOUT),log$g.error(rt),rt}finally{tt.destroy()}}async _createCancellableDialTarget(a,$){const j=`${parseInt(String(Math.random()*1e9),10).toString()}${Date.now()}`,_e=new Promise((et,tt)=>{this.pendingDialTargets.set(j,{resolve:et,reject:tt})});try{return await Promise.race([this._createDialTarget(a,$),_e])}finally{this.pendingDialTargets.delete(j)}}async _createDialTarget(a,$){const j=this._resolve.bind(this),_e=await pipe(await this.components.peerStore.addressBook.get(a),et=>filter(et,async tt=>!await this.components.connectionGater.denyDialMultiaddr(a,tt.multiaddr)),et=>sort(et,this.addressSorter),async function*(tt){for await(const rt of tt)yield*await j(rt.multiaddr,$)},et=>filter(et,tt=>Boolean(this.components.transportManager.transportForMultiaddr(tt))),et=>map$6(et,tt=>a.toString()===tt.getPeerId()?tt:tt.encapsulate(`/p2p/${a.toString()}`)),async et=>await all$5(et));if(_e.length>this.maxAddrsToDial)throw await this.components.peerStore.delete(a),errCode(new Error("dial with more addresses than allowed"),codes$1.ERR_TOO_MANY_ADDRESSES);return{id:a.toString(),addrs:_e}}_createPendingDial(a,$={}){const j=async(it,st={})=>{if(st.signal?.aborted===!0)throw errCode(new Error("already aborted"),codes$1.ERR_ALREADY_ABORTED);return await this.components.transportManager.dial(it,st).catch(ot=>{throw log$g.error("dial to %s failed",it,ot),ot})},_e=new DialRequest({addrs:a.addrs,dialAction:j,dialer:this}),et=new timeoutAbortController.TimeoutController(this.timeout),tt=[et.signal];$.signal!=null&&tt.push($.signal);const rt=anySignal_2(tt);try{events.exports.setMaxListeners?.(1/0,rt)}catch{}const nt={dialRequest:_e,controller:et,promise:_e.run({...$,signal:rt}),destroy:()=>{et.clear(),this.pendingDials.delete(a.id)}};return this.pendingDials.set(a.id,nt),nt}getTokens(a){const $=Math.min(a,this.maxDialsPerPeer,this.tokens.length),j=this.tokens.splice(0,$);return log$g("%d tokens request, returning %d, %d remaining",a,$,this.tokens.length),j}releaseToken(a){this.tokens.includes(a)||(log$g("token %d released",a),this.tokens.push(a))}async _resolve(a,$){if(!a.protoNames().includes("dnsaddr"))return[a];const _e=await this._resolveRecord(a,$);return(await Promise.all(_e.map(async rt=>await this._resolve(rt,$)))).flat().reduce((rt,nt)=>(rt.find(it=>it.equals(nt))==null&&rt.push(nt),rt),[])}async _resolveRecord(a,$){try{return a=multiaddr(a.toString()),await a.resolve($)}catch(j){return log$g.error(`multiaddr ${a.toString()} could not be resolved`,j),[]}}}const log$f=logger$1("libp2p");class Libp2pNode extends EventEmitter$1{constructor(a){super(),this.started=!1,this.peerId=a.peerId;const $=this.components=new DefaultComponents({peerId:a.peerId,datastore:a.datastore??new MemoryDatastore,connectionGater:{denyDialPeer:async()=>await Promise.resolve(!1),denyDialMultiaddr:async()=>await Promise.resolve(!1),denyInboundConnection:async()=>await Promise.resolve(!1),denyOutboundConnection:async()=>await Promise.resolve(!1),denyInboundEncryptedConnection:async()=>await Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>await Promise.resolve(!1),denyInboundUpgradedConnection:async()=>await Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>await Promise.resolve(!1),filterMultiaddrForPeer:async()=>await Promise.resolve(!0),...a.connectionGater}});$.peerStore=new PersistentPeerStore($,{addressFilter:this.components.connectionGater.filterMultiaddrForPeer,...a.peerStore}),this.services=[$],a.metrics.enabled&&(this.metrics=this.components.metrics=new DefaultMetrics(a.metrics)),this.peerStore=this.components.peerStore,this.peerStore.addEventListener("peer",tt=>{const{detail:rt}=tt;this.dispatchEvent(new CustomEvent$1("peer:discovery",{detail:rt}))}),a.connectionProtector!=null&&(this.components.connectionProtector=a.connectionProtector($)),this.components.upgrader=new DefaultUpgrader(this.components,{connectionEncryption:(a.connectionEncryption??[]).map(tt=>this.configureComponent(tt(this.components))),muxers:(a.streamMuxers??[]).map(tt=>this.configureComponent(tt(this.components))),inboundUpgradeTimeout:a.connectionManager.inboundUpgradeTimeout}),this.components.dialer=new DefaultDialer(this.components,a.connectionManager),this.connectionManager=this.components.connectionManager=new DefaultConnectionManager(this.components,a.connectionManager),this.registrar=this.components.registrar=new DefaultRegistrar(this.components),this.components.transportManager=new DefaultTransportManager(this.components,a.transportManager),this.components.addressManager=new DefaultAddressManager(this.components,a.addresses),this.configureComponent(new PeerRecordUpdater(this.components)),this.configureComponent(new AutoDialler(this.components,{enabled:a.connectionManager.autoDial,minConnections:a.connectionManager.minConnections,autoDialInterval:a.connectionManager.autoDialInterval}));const j=KeyChain.generateOptions();this.keychain=this.configureComponent(new KeyChain(this.components,{...j,...a.keychain})),this.services.push(new NatManager(this.components,a.nat)),a.transports.forEach(tt=>{this.components.transportManager.add(this.configureComponent(tt(this.components)))}),this.identifyService=new IdentifyService(this.components,{...a.identify}),this.configureComponent(this.identifyService),a.dht!=null?this.dht=this.components.dht=a.dht(this.components):this.dht=new DummyDHT,a.pubsub!=null?this.pubsub=this.components.pubsub=a.pubsub(this.components):this.pubsub=new DummyPubSub;const _e=(a.peerRouters??[]).map(tt=>this.configureComponent(tt(this.components)));a.dht!=null&&(_e.push(this.configureComponent(new DHTPeerRouting(this.dht))),this.dht.addEventListener("peer",tt=>{this.onDiscoveryPeer(tt)})),this.peerRouting=this.components.peerRouting=this.configureComponent(new DefaultPeerRouting(this.components,{...a.peerRouting,routers:_e}));const et=(a.contentRouters??[]).map(tt=>this.configureComponent(tt(this.components)));a.dht!=null&&et.push(this.configureComponent(new DHTContentRouting(this.dht))),this.contentRouting=this.components.contentRouting=this.configureComponent(new CompoundContentRouting(this.components,{routers:et})),a.relay.enabled&&(this.components.transportManager.add(this.configureComponent(new Circuit(this.components,a.relay))),this.configureComponent(new Relay(this.components,{addressSorter:a.connectionManager.addressSorter,...a.relay}))),this.fetchService=this.configureComponent(new FetchService(this.components,{...a.fetch})),this.pingService=this.configureComponent(new PingService(this.components,{...a.ping}));for(const tt of a.peerDiscovery??[])this.configureComponent(tt(this.components)).addEventListener("peer",nt=>{this.onDiscoveryPeer(nt)})}configureComponent(a){return isStartable(a)&&this.services.push(a),a}async start(){if(!this.started){this.started=!0,log$f("libp2p is starting");try{await Promise.all(this.services.map(async a=>{a.beforeStart!=null&&await a.beforeStart()})),await Promise.all(this.services.map(a=>a.start())),await Promise.all(this.services.map(async a=>{a.afterStart!=null&&await a.afterStart()})),log$f("libp2p has started")}catch(a){throw log$f.error("An error occurred starting libp2p",a),await this.stop(),a}}}async stop(){!this.started||(log$f("libp2p is stopping"),this.started=!1,await Promise.all(this.services.map(async a=>{a.beforeStop!=null&&await a.beforeStop()})),await Promise.all(this.services.map(a=>a.stop())),await Promise.all(this.services.map(async a=>{a.afterStop!=null&&await a.afterStop()})),log$f("libp2p has stopped"))}isStarted(){return this.started}getConnections(a){return this.components.connectionManager.getConnections(a)}getPeers(){const a=new PeerSet;for(const $ of this.components.connectionManager.getConnections())a.add($.remotePeer);return Array.from(a)}async dial(a,$={}){const{id:j,multiaddrs:_e}=getPeer(a);return await this.components.peerStore.addressBook.add(j,_e),await this.components.connectionManager.openConnection(j,$)}async dialProtocol(a,$,j={}){if($==null)throw errCode(new Error("no protocols were provided to open a stream"),codes$1.ERR_INVALID_PROTOCOLS_FOR_STREAM);if($=Array.isArray($)?$:[$],$.length===0)throw errCode(new Error("no protocols were provided to open a stream"),codes$1.ERR_INVALID_PROTOCOLS_FOR_STREAM);return await(await this.dial(a,j)).newStream($,j)}getMultiaddrs(){return this.components.addressManager.getAddresses()}async hangUp(a){const{id:$}=getPeer(a);await this.components.connectionManager.closeConnections($)}async getPublicKey(a,$={}){if(log$f("getPublicKey %p",a),a.publicKey!=null)return a.publicKey;const j=await this.peerStore.get(a);if(j.pubKey!=null)return j.pubKey;if(this.dht==null)throw errCode(new Error("Public key was not in the peer store and the DHT is not enabled"),codes$1.ERR_NO_ROUTERS_AVAILABLE);const _e=concat$1([fromString$5("/pk/"),a.multihash.digest]);for await(const et of this.dht.get(_e,$))if(et.name==="VALUE"){const tt=unmarshalPublicKey(et.value);return await this.peerStore.keyBook.set(a,et.value),tt.bytes}throw errCode(new Error(`Node not responding with its public key: ${a.toString()}`),codes$1.ERR_INVALID_RECORD)}async fetch(a,$,j={}){const{id:_e,multiaddrs:et}=getPeer(a);return et!=null&&await this.components.peerStore.addressBook.add(_e,et),await this.fetchService.fetch(_e,$,j)}async ping(a,$={}){const{id:j,multiaddrs:_e}=getPeer(a);return _e.length>0&&await this.components.peerStore.addressBook.add(j,_e),await this.pingService.ping(j,$)}async handle(a,$,j){Array.isArray(a)||(a=[a]),await Promise.all(a.map(async _e=>{await this.components.registrar.handle(_e,$,j)}))}async unhandle(a){Array.isArray(a)||(a=[a]),await Promise.all(a.map(async $=>{await this.components.registrar.unhandle($)}))}onDiscoveryPeer(a){const{detail:$}=a;if($.id.toString()===this.peerId.toString()){log$f.error(new Error(codes$1.ERR_DISCOVERED_SELF));return}$.multiaddrs.length>0&&this.components.peerStore.addressBook.add($.id,$.multiaddrs).catch(j=>log$f.error(j)),$.protocols.length>0&&this.components.peerStore.protoBook.set($.id,$.protocols).catch(j=>log$f.error(j)),this.dispatchEvent(new CustomEvent$1("peer:discovery",{detail:$}))}}async function createLibp2pNode(_){return _.peerId==null&&(_.peerId=await createEd25519PeerId()),new Libp2pNode(validateConfig(_))}async function createLibp2p$1(_){return await createLibp2pNode(_)}var browser$1={exports:{}},safeBuffer={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(_,a){var $=buffer,j=$.Buffer;function _e(tt,rt){for(var nt in tt)rt[nt]=tt[nt]}j.from&&j.alloc&&j.allocUnsafe&&j.allocUnsafeSlow?_.exports=$:(_e($,a),a.Buffer=et);function et(tt,rt,nt){return j(tt,rt,nt)}et.prototype=Object.create(j.prototype),_e(j,et),et.from=function(tt,rt,nt){if(typeof tt=="number")throw new TypeError("Argument must not be a number");return j(tt,rt,nt)},et.alloc=function(tt,rt,nt){if(typeof tt!="number")throw new TypeError("Argument must be a number");var it=j(tt);return rt!==void 0?typeof nt=="string"?it.fill(rt,nt):it.fill(rt):it.fill(0),it},et.allocUnsafe=function(tt){if(typeof tt!="number")throw new TypeError("Argument must be a number");return j(tt)},et.allocUnsafeSlow=function(tt){if(typeof tt!="number")throw new TypeError("Argument must be a number");return $.SlowBuffer(tt)}})(safeBuffer,safeBuffer.exports);var MAX_BYTES=65536,MAX_UINT32=4294967295;function oldBrowser(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var Buffer$1=safeBuffer.exports.Buffer,crypto$1={}.crypto||{}.msCrypto;crypto$1&&crypto$1.getRandomValues?browser$1.exports=randomBytes$1:browser$1.exports=oldBrowser;function randomBytes$1(_,a){if(_>MAX_UINT32)throw new RangeError("requested too many random bytes");var $=Buffer$1.allocUnsafe(_);if(_>0)if(_>MAX_BYTES)for(var j=0;j<_;j+=MAX_BYTES)crypto$1.getRandomValues($.slice(j,j+MAX_BYTES));else crypto$1.getRandomValues($);return typeof a=="function"?process.nextTick(function(){a(null,$)}):$}const randomBytes=browser$1.exports,{EventEmitter}=events.exports;function arrayEquals(_,a){if(_===a)return!0;if(_.length!==a.length)return!1;for(let $=0,j=_.length;$<j;++$)if(_[$]!==a[$])return!1;return!0}function createNode(){return{contacts:[],dontSplit:!1,left:null,right:null}}function ensureInt8(_,a){if(!(a instanceof Uint8Array))throw new TypeError(_+" is not a Uint8Array")}class KBucket extends EventEmitter{constructor(a={}){super(),this.localNodeId=a.localNodeId||randomBytes(20),this.numberOfNodesPerKBucket=a.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=a.numberOfNodesToPing||3,this.distance=a.distance||KBucket.distance,this.arbiter=a.arbiter||KBucket.arbiter,this.metadata=Object.assign({},a.metadata),ensureInt8("option.localNodeId as parameter 1",this.localNodeId),this.root=createNode()}static arbiter(a,$){return a.vectorClock>$.vectorClock?a:$}static distance(a,$){let j=0,_e=0;const et=Math.min(a.length,$.length),tt=Math.max(a.length,$.length);for(;_e<et;++_e)j=j*256+(a[_e]^$[_e]);for(;_e<tt;++_e)j=j*256+255;return j}add(a){ensureInt8("contact.id",(a||{}).id);let $=0,j=this.root;for(;j.contacts===null;)j=this._determineNode(j,a.id,$++);const _e=this._indexOf(j,a.id);return _e>=0?(this._update(j,_e,a),this):j.contacts.length<this.numberOfNodesPerKBucket?(j.contacts.push(a),this.emit("added",a),this):j.dontSplit?(this.emit("ping",j.contacts.slice(0,this.numberOfNodesToPing),a),this):(this._split(j,$),this.add(a))}closest(a,$=1/0){if(ensureInt8("id",a),!Number.isInteger($)&&$!==1/0||$<=0)throw new TypeError("n is not positive number");let j=[];for(let _e=[this.root],et=0;_e.length>0&&j.length<$;){const tt=_e.pop();if(tt.contacts===null){const rt=this._determineNode(tt,a,et++);_e.push(tt.left===rt?tt.right:tt.left),_e.push(rt)}else j=j.concat(tt.contacts)}return j.map(_e=>[this.distance(_e.id,a),_e]).sort((_e,et)=>_e[0]-et[0]).slice(0,$).map(_e=>_e[1])}count(){let a=0;for(const $=[this.root];$.length>0;){const j=$.pop();j.contacts===null?$.push(j.right,j.left):a+=j.contacts.length}return a}_determineNode(a,$,j){const _e=j>>3,et=j%8;return $.length<=_e&&et!==0?a.left:$[_e]&1<<7-et?a.right:a.left}get(a){ensureInt8("id",a);let $=0,j=this.root;for(;j.contacts===null;)j=this._determineNode(j,a,$++);const _e=this._indexOf(j,a);return _e>=0?j.contacts[_e]:null}_indexOf(a,$){for(let j=0;j<a.contacts.length;++j)if(arrayEquals(a.contacts[j].id,$))return j;return-1}remove(a){ensureInt8("the id as parameter 1",a);let $=0,j=this.root;for(;j.contacts===null;)j=this._determineNode(j,a,$++);const _e=this._indexOf(j,a);if(_e>=0){const et=j.contacts.splice(_e,1)[0];this.emit("removed",et)}return this}_split(a,$){a.left=createNode(),a.right=createNode();for(const et of a.contacts)this._determineNode(a,et.id,$).contacts.push(et);a.contacts=null;const j=this._determineNode(a,this.localNodeId,$),_e=a.left===j?a.right:a.left;_e.dontSplit=!0}toArray(){let a=[];for(const $=[this.root];$.length>0;){const j=$.pop();j.contacts===null?$.push(j.right,j.left):a=a.concat(j.contacts)}return a}*toIterable(){for(const a=[this.root];a.length>0;){const $=a.pop();$.contacts===null?a.push($.right,$.left):yield*$.contacts}}_update(a,$,j){if(!arrayEquals(a.contacts[$].id,j.id))throw new Error("wrong index for _update");const _e=a.contacts[$],et=this.arbiter(_e,j);et===_e&&_e!==j||(a.contacts.splice($,1),a.contacts.push(et),this.emit("updated",_e,et))}}var kBucket=KBucket;const second=1e3,minute=60*second,hour=60*minute,MAX_RECORD_AGE=36*hour,LAN_PREFIX="/lan",PROTOCOL_PREFIX="/ipfs",PROTOCOL_DHT="/kad/1.0.0",RECORD_KEY_PREFIX="/dht/record",PROVIDER_KEY_PREFIX="/dht/provider",PROVIDERS_LRU_CACHE_SIZE=256,PROVIDERS_VALIDITY=24*hour,PROVIDERS_CLEANUP_INTERVAL=hour,K=20,ALPHA=3,QUERY_SELF_INTERVAL=Number(5*minute),QUERY_SELF_TIMEOUT=Number(30*second),TABLE_REFRESH_INTERVAL=Number(5*minute),TABLE_REFRESH_QUERY_TIMEOUT=Number(30*second),DEFAULT_QUERY_TIMEOUT=Number(30*second),PK_PREFIX=fromString$5("/pk/");function removePrivateAddresses(_){return{..._,multiaddrs:_.multiaddrs.filter(a=>{const[[$,j]]=a.stringTuples();return $!==4&&$!==6||j==null?!1:!privateIp(j)})}}function removePublicAddresses(_){return{..._,multiaddrs:_.multiaddrs.filter(a=>{const[[$,j]]=a.stringTuples();return $!==4&&$!==6||j==null?!1:privateIp(j)})}}async function convertBuffer(_){return(await sha256$4.digest(_)).digest}async function convertPeerId(_){return await convertBuffer(_.toBytes())}function bufferToRecordKey(_){return new Key(`${RECORD_KEY_PREFIX}/${toString$6(_,"base32")}`,!1)}function keyForPublicKey(_){return concat$1([PK_PREFIX,_.toBytes()])}function isPublicKeyKey(_){return toString$6(_.subarray(0,4))==="/pk/"}function fromPublicKeyKey(_){return peerIdFromBytes(_.subarray(4))}function createPutRecord(_,a){const $=new Date;return new Libp2pRecord(_,a,$).serialize()}function debounce$1(_,a=100){let $;return()=>{clearTimeout($),$=setTimeout(()=>_(),a)}}const KAD_CLOSE_TAG_NAME="kad-close",KAD_CLOSE_TAG_VALUE=50,KBUCKET_SIZE=20,PING_TIMEOUT=1e4,PING_CONCURRENCY=10,METRIC_ROUTING_TABLE_SIZE="routing-table-size",METRIC_PING_QUEUE_SIZE="ping-queue-size",METRIC_PING_RUNNING="ping-running";class RoutingTable{constructor(a,$){const{kBucketSize:j,pingTimeout:_e,lan:et,pingConcurrency:tt,protocol:rt,tagName:nt,tagValue:it}=$;this.components=a,this.log=logger$1(`libp2p:kad-dht:${et?"lan":"wan"}:routing-table`),this.kBucketSize=j??KBUCKET_SIZE,this.pingTimeout=_e??PING_TIMEOUT,this.pingConcurrency=tt??PING_CONCURRENCY,this.lan=et,this.running=!1,this.protocol=rt,this.tagName=nt??KAD_CLOSE_TAG_NAME,this.tagValue=it??KAD_CLOSE_TAG_VALUE;const st=()=>{this.components.metrics?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:METRIC_PING_QUEUE_SIZE,value:this.pingQueue.size}),this.components.metrics?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:METRIC_PING_RUNNING,value:this.pingQueue.pending})};this.pingQueue=new PQueue({concurrency:this.pingConcurrency}),this.pingQueue.addListener("add",st),this.pingQueue.addListener("next",st),this._onPing=this._onPing.bind(this)}isStarted(){return this.running}async start(){this.running=!0;const a=new kBucket({localNodeId:await convertPeerId(this.components.peerId),numberOfNodesPerKBucket:this.kBucketSize,numberOfNodesToPing:1});this.kb=a,a.on("ping",this._onPing),this._tagPeers(a)}async stop(){this.running=!1,this.pingQueue.clear(),this.kb=void 0}_tagPeers(a){let $=new PeerSet;const j=debounce$1(()=>{const _e=new PeerSet(a.closest(a.localNodeId,KBUCKET_SIZE).map(rt=>rt.peer)),et=_e.difference($),tt=$.difference(_e);Promise.resolve().then(async()=>{for(const rt of et)await this.components.peerStore.tagPeer(rt,this.tagName,{value:this.tagValue});for(const rt of tt)await this.components.peerStore.unTagPeer(rt,this.tagName)}).catch(rt=>{this.log.error("Could not update peer tags",rt)}),$=_e});a.on("added",()=>{j()}),a.on("removed",()=>{j()})}_onPing(a,$){this.pingQueue.add(async()=>{if(!this.running)return;let j=0;try{await Promise.all(a.map(async _e=>{let et;try{et=new timeoutAbortController.TimeoutController(this.pingTimeout);const tt={signal:et.signal};this.log("pinging old contact %p",_e.peer),(await(await this.components.connectionManager.openConnection(_e.peer,tt)).newStream(this.protocol,tt)).close(),j++}catch(tt){this.running&&this.kb!=null&&(this.log.error("could not ping peer %p",_e.peer,tt),this.log("evicting old contact after ping failed %p",_e),this.kb.remove(_e.id))}finally{et?.clear(),this.components.metrics?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:METRIC_ROUTING_TABLE_SIZE,value:this.size})}})),this.running&&j<a.length&&this.kb!=null&&(this.log("adding new contact %p",$.peer),this.kb.add($))}catch(_e){this.log.error("could not process k-bucket ping event",_e)}}).catch(j=>{this.log.error("could not process k-bucket ping event",j)})}get size(){return this.kb==null?0:this.kb.count()}async find(a){const $=await convertPeerId(a),j=this.closestPeer($);if(j!=null&&a.equals(j))return j}closestPeer(a){const $=this.closestPeers(a,1);if($.length>0)return $[0]}closestPeers(a,$=this.kBucketSize){return this.kb==null?[]:this.kb.closest(a,$).map(_e=>_e.peer)}async add(a){if(this.kb==null)throw new Error("RoutingTable is not started");const $=await convertPeerId(a);this.kb.add({id:$,peer:a}),this.log("added %p with kad id %b",a,$),this.components.metrics?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:METRIC_ROUTING_TABLE_SIZE,value:this.size})}async remove(a){if(this.kb==null)throw new Error("RoutingTable is not started");const $=await convertPeerId(a);this.kb.remove($),this.components.metrics?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:METRIC_ROUTING_TABLE_SIZE,value:this.size})}}const GENERATED_PREFIXES=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782],length$1=async _=>{let a=0;for await(const $ of _)a++;return a};var itLength=length$1;const MAX_COMMON_PREFIX_LENGTH=15;class RoutingTableRefresh{constructor(a){const{peerRouting:$,routingTable:j,refreshInterval:_e,refreshQueryTimeout:et,lan:tt}=a;this.log=logger$1(`libp2p:kad-dht:${tt?"lan":"wan"}:routing-table:refresh`),this.peerRouting=$,this.routingTable=j,this.refreshInterval=_e??TABLE_REFRESH_INTERVAL,this.refreshQueryTimeout=et??TABLE_REFRESH_QUERY_TIMEOUT,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}async start(){this.log(`refreshing routing table every ${this.refreshInterval}ms`),this.refreshTable(!0)}async stop(){this.refreshTimeoutId!=null&&clearTimeout(this.refreshTimeoutId)}refreshTable(a=!1){this.log("refreshing routing table");const $=this._maxCommonPrefix(),j=this._getTrackedCommonPrefixLengthsForRefresh($);this.log(`max common prefix length ${$}`),this.log(`tracked CPLs [ ${j.map(_e=>_e.toISOString()).join(", ")} ]`),Promise.all(j.map(async(_e,et)=>{try{if(await this._refreshCommonPrefixLength(et,_e,a),this._numPeersForCpl($)===0){const tt=Math.min(2*(et+1),j.length-1);for(let rt=et+1;rt<tt+1;rt++)try{await this._refreshCommonPrefixLength(rt,_e,a)}catch(nt){this.log.error(nt)}}}catch(tt){this.log.error(tt)}})).catch(_e=>{this.log.error(_e)}).then(()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),this.refreshTimeoutId.unref!=null&&this.refreshTimeoutId.unref()}).catch(_e=>{this.log.error(_e)})}async _refreshCommonPrefixLength(a,$,j){if(!j&&$.getTime()>Date.now()-this.refreshInterval){this.log("not running refresh for cpl %s as time since last refresh not above interval",a);return}const _e=await this._generateRandomPeerId(a);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",a,_e,this.routingTable.size);const et=new timeoutAbortController.TimeoutController(this.refreshQueryTimeout);try{const tt=await itLength(this.peerRouting.getClosestPeers(_e.toBytes(),{signal:et.signal}));this.log(`found ${tt} peers that were close to imaginary peer %p`,_e),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",a,_e,this.routingTable.size)}finally{et.clear()}}_getTrackedCommonPrefixLengthsForRefresh(a){a>MAX_COMMON_PREFIX_LENGTH&&(a=MAX_COMMON_PREFIX_LENGTH);const $=[];for(let j=0;j<=a;j++)$[j]=this.commonPrefixLengthRefreshedAt[j]??new Date;return $}async _generateRandomPeerId(a){if(this.routingTable.kb==null)throw new Error("Routing table not started");const $=randomBytes$3(2),j=($[1]<<8)+$[0],_e=await this._makePeerId(this.routingTable.kb.localNodeId,j,a);return peerIdFromBytes(_e)}async _makePeerId(a,$,j){if(j>MAX_COMMON_PREFIX_LENGTH)throw new Error(`Cannot generate peer ID for common prefix length greater than ${MAX_COMMON_PREFIX_LENGTH}`);const tt=new DataView(a.buffer,a.byteOffset,a.byteLength).getUint16(0,!1)^32768>>j,rt=65535<<16-(j+1),nt=tt&rt|$&~rt,it=GENERATED_PREFIXES[nt],st=new ArrayBuffer(34),ot=new DataView(st,0,st.byteLength);return ot.setUint8(0,sha256$4.code),ot.setUint8(1,32),ot.setUint32(2,it,!1),new Uint8Array(ot.buffer,ot.byteOffset,ot.byteLength)}_maxCommonPrefix(){let a=0;for(const $ of this._prefixLengths())$>a&&(a=$);return a}_numPeersForCpl(a){let $=0;for(const j of this._prefixLengths())j===a&&$++;return $}*_prefixLengths(){if(this.routingTable.kb!=null)for(const{id:a}of this.routingTable.kb.toIterable()){const $=xor(this.routingTable.kb.localNodeId,a);let j=0;for(const _e of $)if(_e===0)j++;else break;yield j}}}const drain=async _=>{for await(const a of _);};var itDrain=drain;const first=async _=>{for await(const a of _)return a};var itFirst=first,Record;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{_e.lengthDelimited!==!1&&j.fork(),$.key!=null&&(j.uint32(10),j.bytes($.key)),$.value!=null&&(j.uint32(18),j.bytes($.value)),$.author!=null&&(j.uint32(26),j.bytes($.author)),$.signature!=null&&(j.uint32(34),j.bytes($.signature)),$.timeReceived!=null&&(j.uint32(42),j.string($.timeReceived)),_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.key=$.bytes();break;case 2:_e.value=$.bytes();break;case 3:_e.author=$.bytes();break;case 4:_e.signature=$.bytes();break;case 5:_e.timeReceived=$.string();break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(Record||(Record={}));var Message$2;(function(_){(function(_e){_e.PUT_VALUE="PUT_VALUE",_e.GET_VALUE="GET_VALUE",_e.ADD_PROVIDER="ADD_PROVIDER",_e.GET_PROVIDERS="GET_PROVIDERS",_e.FIND_NODE="FIND_NODE",_e.PING="PING"})(_.MessageType||(_.MessageType={}));let a;(function(_e){_e[_e.PUT_VALUE=0]="PUT_VALUE",_e[_e.GET_VALUE=1]="GET_VALUE",_e[_e.ADD_PROVIDER=2]="ADD_PROVIDER",_e[_e.GET_PROVIDERS=3]="GET_PROVIDERS",_e[_e.FIND_NODE=4]="FIND_NODE",_e[_e.PING=5]="PING"})(a||(a={})),function(_e){_e.codec=()=>enumeration(a)}(_.MessageType||(_.MessageType={})),function(_e){_e.NOT_CONNECTED="NOT_CONNECTED",_e.CONNECTED="CONNECTED",_e.CAN_CONNECT="CAN_CONNECT",_e.CANNOT_CONNECT="CANNOT_CONNECT"}(_.ConnectionType||(_.ConnectionType={}));let $;(function(_e){_e[_e.NOT_CONNECTED=0]="NOT_CONNECTED",_e[_e.CONNECTED=1]="CONNECTED",_e[_e.CAN_CONNECT=2]="CAN_CONNECT",_e[_e.CANNOT_CONNECT=3]="CANNOT_CONNECT"})($||($={})),function(_e){_e.codec=()=>enumeration($)}(_.ConnectionType||(_.ConnectionType={})),function(_e){let et;_e.codec=()=>(et==null&&(et=message((tt,rt,nt={})=>{if(nt.lengthDelimited!==!1&&rt.fork(),tt.id!=null&&(rt.uint32(10),rt.bytes(tt.id)),tt.addrs!=null)for(const it of tt.addrs)rt.uint32(18),rt.bytes(it);else throw new Error('Protocol error: required field "addrs" was not found in object');tt.connection!=null&&(rt.uint32(24),_.ConnectionType.codec().encode(tt.connection,rt)),nt.lengthDelimited!==!1&&rt.ldelim()},(tt,rt)=>{const nt={addrs:[]},it=rt==null?tt.len:tt.pos+rt;for(;tt.pos<it;){const st=tt.uint32();switch(st>>>3){case 1:nt.id=tt.bytes();break;case 2:nt.addrs.push(tt.bytes());break;case 3:nt.connection=_.ConnectionType.codec().decode(tt);break;default:tt.skipType(st&7);break}}return nt})),et),_e.encode=tt=>encodeMessage(tt,_e.codec()),_e.decode=tt=>decodeMessage(tt,_e.codec())}(_.Peer||(_.Peer={}));let j;_.codec=()=>(j==null&&(j=message((_e,et,tt={})=>{if(tt.lengthDelimited!==!1&&et.fork(),_e.type!=null&&(et.uint32(8),_.MessageType.codec().encode(_e.type,et)),_e.clusterLevelRaw!=null&&(et.uint32(80),et.int32(_e.clusterLevelRaw)),_e.key!=null&&(et.uint32(18),et.bytes(_e.key)),_e.record!=null&&(et.uint32(26),et.bytes(_e.record)),_e.closerPeers!=null)for(const rt of _e.closerPeers)et.uint32(66),_.Peer.codec().encode(rt,et);else throw new Error('Protocol error: required field "closerPeers" was not found in object');if(_e.providerPeers!=null)for(const rt of _e.providerPeers)et.uint32(74),_.Peer.codec().encode(rt,et);else throw new Error('Protocol error: required field "providerPeers" was not found in object');tt.lengthDelimited!==!1&&et.ldelim()},(_e,et)=>{const tt={closerPeers:[],providerPeers:[]},rt=et==null?_e.len:_e.pos+et;for(;_e.pos<rt;){const nt=_e.uint32();switch(nt>>>3){case 1:tt.type=_.MessageType.codec().decode(_e);break;case 10:tt.clusterLevelRaw=_e.int32();break;case 2:tt.key=_e.bytes();break;case 3:tt.record=_e.bytes();break;case 8:tt.closerPeers.push(_.Peer.codec().decode(_e,_e.uint32()));break;case 9:tt.providerPeers.push(_.Peer.codec().decode(_e,_e.uint32()));break;default:_e.skipType(nt&7);break}}return tt})),j),_.encode=_e=>encodeMessage(_e,_.codec()),_.decode=_e=>decodeMessage(_e,_.codec())})(Message$2||(Message$2={}));const MESSAGE_TYPE=Message$2.MessageType,CONNECTION_TYPE=Message$2.ConnectionType,MESSAGE_TYPE_LOOKUP=Object.keys(MESSAGE_TYPE);class Message$1{constructor(a,$,j){if(!($ instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=a,this.key=$,this.clusterLevelRaw=j,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){const a=this.clusterLevelRaw-1;return a<0?0:a}set clusterLevel(a){this.clusterLevelRaw=a}serialize(){return Message$2.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(toPbPeer),providerPeers:this.providerPeers.map(toPbPeer),record:this.record==null?void 0:this.record.serialize().subarray()})}static deserialize(a){const $=Message$2.decode(a),j=new Message$1($.type??Message$2.MessageType.PUT_VALUE,$.key??Uint8Array.from([]),$.clusterLevelRaw??0);return j.closerPeers=$.closerPeers.map(fromPbPeer),j.providerPeers=$.providerPeers.map(fromPbPeer),$.record?.length!=null&&(j.record=Libp2pRecord.deserialize($.record)),j}}function toPbPeer(_){return{id:_.id.toBytes(),addrs:(_.multiaddrs??[]).map($=>$.bytes),connection:CONNECTION_TYPE.CONNECTED}}function fromPbPeer(_){if(_.id==null)throw new Error("Invalid peer in message");return{id:peerIdFromBytes(_.id),multiaddrs:(_.addrs??[]).map(a=>multiaddr(a)),protocols:[]}}function sendingQueryEvent(_){return{..._,name:"SENDING_QUERY",type:0,messageName:_.type,messageType:MESSAGE_TYPE_LOOKUP.indexOf(_.type.toString())}}function peerResponseEvent(_){return{..._,name:"PEER_RESPONSE",type:1,messageName:_.messageType,closer:_.closer!=null?_.closer:[],providers:_.providers!=null?_.providers:[]}}function finalPeerEvent(_){return{..._,name:"FINAL_PEER",type:2}}function queryErrorEvent(_){return{..._,name:"QUERY_ERROR",type:3}}function providerEvent(_){return{..._,name:"PROVIDER",type:4}}function valueEvent(_){return{..._,name:"VALUE",type:5}}function dialingPeerEvent(_){return{..._,name:"DIALING_PEER",type:7}}class Network$2 extends EventEmitter$1{constructor(a,$){super();const{protocol:j,lan:_e}=$;this.components=a,this.log=logger$1(`libp2p:kad-dht:${_e?"lan":"wan"}:network`),this.running=!1,this.protocol=j}async start(){this.running||(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}async*sendRequest(a,$,j={}){if(!!this.running){this.log("sending %s to %p",$.type,a),yield dialingPeerEvent({peer:a}),yield sendingQueryEvent({to:a,type:$.type});try{const et=await(await this.components.connectionManager.openConnection(a,j)).newStream(this.protocol,j),tt=await this._writeReadMessage(et,$.serialize(),j);yield peerResponseEvent({from:a,messageType:tt.type,closer:tt.closerPeers,providers:tt.providerPeers,record:tt.record})}catch(_e){yield queryErrorEvent({from:a,error:_e})}finally{}}}async*sendMessage(a,$,j={}){if(!!this.running){this.log("sending %s to %p",$.type,a),yield dialingPeerEvent({peer:a}),yield sendingQueryEvent({to:a,type:$.type});try{const et=await(await this.components.connectionManager.openConnection(a,j)).newStream(this.protocol,j);await this._writeMessage(et,$.serialize(),j),yield peerResponseEvent({from:a,messageType:$.type})}catch(_e){yield queryErrorEvent({from:a,error:_e})}finally{}}}async _writeMessage(a,$,j){j.signal!=null&&(a=abortableDuplex(a,j.signal)),await pipe([$],encode$5(),a,itDrain)}async _writeReadMessage(a,$,j){j.signal!=null&&(a=abortableDuplex(a,j.signal));const _e=await pipe([$],encode$5(),a,decode$4(),async tt=>{const rt=await itFirst(tt);if(rt!=null)return rt;throw errCode(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED")}),et=Message$1.deserialize(_e);return et.closerPeers.forEach(tt=>{this.dispatchEvent(new CustomEvent$1("peer",{detail:tt}))}),et.providerPeers.forEach(tt=>{this.dispatchEvent(new CustomEvent$1("peer",{detail:tt}))}),et}}function verifyRecord(_,a){const $=a.key,_e=toString$6($).split("/");if(_e.length<3)return;const et=_[_e[1].toString()];if(et==null){const tt="Invalid record keytype";throw errCode(new Error(tt),"ERR_INVALID_RECORD_KEY_TYPE")}return et($,a.value)}const validatePublicKeyRecord=async(_,a)=>{if(!(_ instanceof Uint8Array))throw errCode(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(_.byteLength<5)throw errCode(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if(toString$6(_.subarray(0,4))!=="/pk/")throw errCode(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");const j=_.slice(4),_e=await sha256$4.digest(a);if(!equals$1(j,_e.bytes))throw errCode(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")},validators={pk:validatePublicKeyRecord};function bestRecord(_,a,$){if($.length===0){const tt="No records given";throw errCode(new Error(tt),"ERR_NO_RECORDS_RECEIVED")}const _e=toString$6(a).split("/");if(_e.length<3){const tt="Record key does not have a selector function";throw errCode(new Error(tt),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}const et=_[_e[1].toString()];if(et==null){const tt=`Unrecognized key prefix: ${_e[1]}`;throw errCode(new Error(tt),"ERR_UNRECOGNIZED_KEY_PREFIX")}return $.length===1?0:et(a,$)}function publickKey(_,a){return 0}const selectors={pk:publickKey},pDefer=()=>{const _={};return _.promise=new Promise((a,$)=>{_.resolve=a,_.reject=$}),_};var pDefer_1=pDefer;const defer=pDefer_1,CustomEvent=globalThis.CustomEvent||Event;async function*parallel(_,a={}){let $=a.concurrency||1/0;$<1&&($=1/0);const j=a.ordered==null?!1:a.ordered,_e=new EventTarget,et=[];let tt=defer(),rt=defer(),nt=!1,it,st=!1;_e.addEventListener("task-complete",()=>{rt.resolve()}),Promise.resolve().then(async()=>{try{for await(const ct of _){if(et.length===$&&(tt=defer(),await tt.promise),st)break;const ut={done:!1};et.push(ut),ct().then(dt=>{ut.done=!0,ut.ok=!0,ut.value=dt,_e.dispatchEvent(new CustomEvent("task-complete"))},dt=>{ut.done=!0,ut.err=dt,_e.dispatchEvent(new CustomEvent("task-complete"))})}nt=!0,_e.dispatchEvent(new CustomEvent("task-complete"))}catch(ct){it=ct,_e.dispatchEvent(new CustomEvent("task-complete"))}});function ot(){return Boolean(j?et[0]&&et[0].done:et.find(ct=>ct.done))}function*at(){for(;et.length&&et[0].done;){const ct=et[0];if(et.shift(),ct.ok)yield ct.value;else throw st=!0,tt.resolve(),ct.err;tt.resolve()}}function*lt(){for(;ot();)for(let ct=0;ct<et.length;ct++)if(et[ct].done){const ut=et[ct];if(et.splice(ct,1),ct--,ut.ok)yield ut.value;else throw st=!0,tt.resolve(),ut.err;tt.resolve()}}for(;;){if(ot()||(rt=defer(),await rt.promise),it)throw it;if(j?yield*at():yield*lt(),nt&&et.length===0)break}}var itParallel=parallel;const map$1=async function*(_,a){for await(const $ of _)yield a($)};var itMap=map$1;class ContentFetching{constructor(a,$){const{validators:j,selectors:_e,peerRouting:et,queryManager:tt,routingTable:rt,network:nt,lan:it}=$;this.components=a,this.log=logger$1(`libp2p:kad-dht:${it?"lan":"wan"}:content-fetching`),this.validators=j,this.selectors=_e,this.peerRouting=et,this.queryManager=tt,this.routingTable=rt,this.network=nt}async putLocal(a,$){const j=bufferToRecordKey(a);await this.components.datastore.put(j,$)}async getLocal(a){this.log("getLocal %b",a);const $=bufferToRecordKey(a);this.log("fetching record for key %k",$);const j=await this.components.datastore.get($);this.log("found %k in local datastore",$);const _e=Libp2pRecord.deserialize(j);return await verifyRecord(this.validators,_e),_e}async*sendCorrectionRecord(a,$,j,_e={}){this.log("sendCorrection for %b",a);const et=await createPutRecord(a,j);for(const{value:tt,from:rt}of $){if(equals$1(tt,j)){this.log("record was ok");continue}if(this.components.peerId.equals(rt)){try{const st=bufferToRecordKey(a);this.log(`Storing corrected record for key ${st.toString()}`),await this.components.datastore.put(st,et.subarray())}catch(st){this.log.error("Failed error correcting self",st)}continue}let nt=!1;const it=new Message$1(MESSAGE_TYPE.PUT_VALUE,a,0);it.record=Libp2pRecord.deserialize(et);for await(const st of this.network.sendRequest(rt,it,_e))st.name==="PEER_RESPONSE"&&st.record!=null&&equals$1(st.record.value,Libp2pRecord.deserialize(et).value)&&(nt=!0),yield st;nt||(yield queryErrorEvent({from:rt,error:errCode(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})),this.log.error("Failed error correcting entry")}}async*put(a,$,j={}){this.log("put key %b value %b",a,$);const _e=await createPutRecord(a,$),et=bufferToRecordKey(a);this.log(`storing record for key ${et.toString()}`),await this.components.datastore.put(et,_e.subarray()),yield*pipe(this.peerRouting.getClosestPeers(a,{signal:j.signal}),tt=>itMap(tt,rt=>async()=>{if(rt.name!=="FINAL_PEER")return[rt];const nt=[],it=new Message$1(MESSAGE_TYPE.PUT_VALUE,a,0);it.record=Libp2pRecord.deserialize(_e),this.log("send put to %p",rt.peer.id);for await(const st of this.network.sendRequest(rt.peer.id,it,j))nt.push(st),st.name==="PEER_RESPONSE"&&(st.record!=null&&equals$1(st.record.value,Libp2pRecord.deserialize(_e).value)||nt.push(queryErrorEvent({from:rt.peer.id,error:errCode(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})));return nt}),tt=>itParallel(tt,{ordered:!1,concurrency:ALPHA}),async function*(tt){for await(const rt of tt)yield*rt})}async*get(a,$={}){this.log("get %b",a);const j=[];for await(const rt of this.getMany(a,$))rt.name==="VALUE"&&j.push(rt),yield rt;if(j.length===0)return;const _e=j.map(rt=>rt.value);let et=0;try{et=bestRecord(this.selectors,a,_e)}catch(rt){if(rt.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw rt}const tt=_e[et];if(this.log("GetValue %b %b",a,tt),tt==null)throw errCode(new Error("best value was not found"),"ERR_NOT_FOUND");yield*this.sendCorrectionRecord(a,j,tt,$),yield j[et]}async*getMany(a,$={}){this.log("getMany values for %b",a);try{const rt=await this.getLocal(a);yield valueEvent({value:rt.value,from:this.components.peerId})}catch(rt){this.log("error getting local value for %b",a,rt)}const j=await convertBuffer(a),_e=this.routingTable.closestPeers(j);this.log("found %d peers in routing table",_e.length);const et=this,tt=async function*({peer:rt,signal:nt}){for await(const it of et.peerRouting.getValueOrPeers(rt,a,{signal:nt}))yield it,it.name==="PEER_RESPONSE"&&it.record!=null&&(yield valueEvent({from:rt,value:it.record.value}))};yield*this.queryManager.run(a,_e,tt,$)}}class ContentRouting{constructor(a,$){const{network:j,peerRouting:_e,queryManager:et,routingTable:tt,providers:rt,lan:nt}=$;this.components=a,this.log=logger$1(`libp2p:kad-dht:${nt?"lan":"wan"}:content-routing`),this.network=j,this.peerRouting=_e,this.queryManager=et,this.routingTable=tt,this.providers=rt}async*provide(a,$,j={}){this.log("provide %s",a),await this.providers.addProvider(a,this.components.peerId);const _e=new Message$1(MESSAGE_TYPE.ADD_PROVIDER,a.bytes,0);_e.providerPeers=[{id:this.components.peerId,multiaddrs:$,protocols:[]}];let et=0;const tt=rt=>async()=>{if(rt.name!=="FINAL_PEER")return[rt];const nt=[];this.log("putProvider %s to %p",a,rt.peer.id);try{this.log("sending provider record for %s to %p",a,rt.peer.id);for await(const it of this.network.sendMessage(rt.peer.id,_e,j))it.name==="PEER_RESPONSE"&&(this.log("sent provider record for %s to %p",a,rt.peer.id),et++),nt.push(it)}catch(it){this.log.error("error sending provide record to peer %p",rt.peer.id,it),nt.push(queryErrorEvent({from:rt.peer.id,error:it}))}return nt};yield*pipe(this.peerRouting.getClosestPeers(a.multihash.bytes,j),rt=>itMap(rt,nt=>tt(nt)),rt=>itParallel(rt,{ordered:!1,concurrency:ALPHA}),async function*(rt){for await(const nt of rt)yield*nt}),this.log("sent provider records to %d peers",et)}async*findProviders(a,$){const j=this.routingTable.kBucketSize,_e=a.multihash.bytes,et=await convertBuffer(_e),tt=this;this.log("findProviders %c",a);const rt=await this.providers.getProviders(a);if(rt.length>0){const st=[];for(const ot of rt.slice(0,j))st.push({id:ot,multiaddrs:(await this.components.peerStore.addressBook.get(ot)??[]).map(at=>at.multiaddr),protocols:[]});yield peerResponseEvent({from:this.components.peerId,messageType:MESSAGE_TYPE.GET_PROVIDERS,providers:st}),yield providerEvent({from:this.components.peerId,providers:st})}if(rt.length>=j)return;const nt=async function*({peer:st,signal:ot}){const at=new Message$1(MESSAGE_TYPE.GET_PROVIDERS,_e,0);yield*tt.network.sendRequest(st,at,{signal:ot})},it=new Set(rt.map(st=>st.toString()));for await(const st of this.queryManager.run(_e,this.routingTable.closestPeers(et),nt,$))if(yield st,st.name==="PEER_RESPONSE"){this.log("Found %d provider entries for %c and %d closer peers",st.providers.length,a,st.closer.length);const ot=[];for(const at of st.providers)it.has(at.id.toString())||(it.add(at.id.toString()),ot.push(at));if(ot.length>0&&(yield providerEvent({from:st.from,providers:ot})),it.size===j)return}}}class PeerDistanceList{constructor(a,$){this.originDhtKey=a,this.capacity=$,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(a=>a.peerId)}async add(a){if(this.peerDistances.find(_e=>_e.peerId.equals(a))!=null)return;const $=await convertPeerId(a),j={peerId:a,distance:xor(this.originDhtKey,$)};this.peerDistances.push(j),this.peerDistances.sort((_e,et)=>compare$1(_e.distance,et.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(a){if(a.length===0)return!1;if(this.length===0)return!0;const $=await Promise.all(a.map(convertPeerId)),j=this.peerDistances[this.peerDistances.length-1].distance;for(const _e of $){const et=xor(this.originDhtKey,_e);if(compare$1(et,j)<0)return!0}return!1}}class PeerRouting{constructor(a,$){const{routingTable:j,network:_e,validators:et,queryManager:tt,lan:rt}=$;this.components=a,this.routingTable=j,this.network=_e,this.validators=et,this.queryManager=tt,this.log=logger$1(`libp2p:kad-dht:${rt?"lan":"wan"}:peer-routing`)}async findPeerLocal(a){let $;const j=await this.routingTable.find(a);if(j!=null){this.log("findPeerLocal found %p in routing table",a);try{$=await this.components.peerStore.get(j)}catch(_e){if(_e.code!=="ERR_NOT_FOUND")throw _e}}if($==null)try{$=await this.components.peerStore.get(a)}catch(_e){if(_e.code!=="ERR_NOT_FOUND")throw _e}if($!=null)return this.log("findPeerLocal found %p in peer store",a),{id:$.id,multiaddrs:$.addresses.map(_e=>_e.multiaddr),protocols:[]}}async*_getValueSingle(a,$,j={}){const _e=new Message$1(MESSAGE_TYPE.GET_VALUE,$,0);yield*this.network.sendRequest(a,_e,j)}async*getPublicKeyFromNode(a,$={}){const j=keyForPublicKey(a);for await(const _e of this._getValueSingle(a,j,$))if(yield _e,_e.name==="PEER_RESPONSE"&&_e.record!=null){const et=await peerIdFromKeys(marshalPublicKey({bytes:_e.record.value}));if(!et.equals(a))throw errCode(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(et.publicKey==null)throw errCode(new Error("public key missing"),"ERR_PUBLIC_KEY_MISSING");yield valueEvent({from:a,value:et.publicKey})}throw errCode(new Error(`Node not responding with its public key: ${a.toString()}`),"ERR_INVALID_RECORD")}async*findPeer(a,$={}){this.log("findPeer %p",a);const j=await this.findPeerLocal(a);if(j!=null){this.log("found local"),yield finalPeerEvent({from:this.components.peerId,peer:j});return}const _e=await convertPeerId(a),et=this.routingTable.closestPeers(_e);if(et.find(st=>st.equals(a))!=null)try{const st=await this.components.peerStore.get(a);this.log("found in peerStore"),yield finalPeerEvent({from:this.components.peerId,peer:{id:st.id,multiaddrs:st.addresses.map(ot=>ot.multiaddr),protocols:[]}});return}catch(st){if(st.code!=="ERR_NOT_FOUND")throw st}const rt=this,nt=async function*({peer:st,signal:ot}){const at=new Message$1(MESSAGE_TYPE.FIND_NODE,a.toBytes(),0);for await(const lt of rt.network.sendRequest(st,at,{signal:ot}))if(yield lt,lt.name==="PEER_RESPONSE"){const ct=lt.closer.find(ut=>ut.id.equals(a));ct!=null&&(yield finalPeerEvent({from:lt.from,peer:ct}))}};let it=!1;for await(const st of this.queryManager.run(a.toBytes(),et,nt,$))st.name==="FINAL_PEER"&&(it=!0),yield st;it||(yield queryErrorEvent({from:this.components.peerId,error:errCode(new Error("Not found"),"ERR_NOT_FOUND")}))}async*getClosestPeers(a,$={}){this.log("getClosestPeers to %b",a);const j=await convertBuffer(a),_e=this.routingTable.closestPeers(j),et=this,tt=new PeerDistanceList(j,this.routingTable.kBucketSize);await Promise.all(_e.map(async nt=>await tt.add(nt)));const rt=async function*({peer:nt,signal:it}){et.log("closerPeersSingle %s from %p",toString$6(a,"base32"),nt);const st=new Message$1(MESSAGE_TYPE.FIND_NODE,a,0);yield*et.network.sendRequest(nt,st,{signal:it})};for await(const nt of this.queryManager.run(a,_e,rt,$))yield nt,nt.name==="PEER_RESPONSE"&&await Promise.all(nt.closer.map(async it=>await tt.add(it.id)));this.log("found %d peers close to %b",tt.length,a);for(const nt of tt.peers)yield finalPeerEvent({from:this.components.peerId,peer:{id:nt,multiaddrs:(await this.components.peerStore.addressBook.get(nt)??[]).map(it=>it.multiaddr),protocols:[]}})}async*getValueOrPeers(a,$,j={}){for await(const _e of this._getValueSingle(a,$,j)){if(_e.name==="PEER_RESPONSE"&&_e.record!=null)try{await this._verifyRecordOnline(_e.record)}catch{const tt="invalid record received, discarded";this.log(tt),yield queryErrorEvent({from:_e.from,error:errCode(new Error(tt),"ERR_INVALID_RECORD")});continue}yield _e}}async _verifyRecordOnline(a){if(a.timeReceived==null)throw errCode(new Error("invalid record received"),"ERR_INVALID_RECORD");await verifyRecord(this.validators,new Libp2pRecord(a.key,a.value,a.timeReceived))}async getCloserPeersOffline(a,$){const j=await convertBuffer(a),_e=this.routingTable.closestPeers(j),et=[];for(const tt of _e)if(!tt.equals($))try{const rt=await this.components.peerStore.addressBook.get(tt),nt=await this.components.peerStore.protoBook.get(tt);et.push({id:tt,multiaddrs:rt.map(it=>it.multiaddr),protocols:nt})}catch(rt){if(rt.code!=="ERR_NOT_FOUND")throw rt}return et.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",et.length,a,$):this.log("getCloserPeersOffline could not find peer closer to %b than %p",a,$),et}}const log$e=logger$1("libp2p:kad-dht:providers");class Providers{constructor(a,$={}){const{cacheSize:j,cleanupInterval:_e,provideValidity:et}=$;this.components=a,this.cleanupInterval=_e??PROVIDERS_CLEANUP_INTERVAL,this.provideValidity=et??PROVIDERS_VALIDITY,this.cache=hashlru(j??PROVIDERS_LRU_CACHE_SIZE),this.syncQueue=new PQueue({concurrency:1}),this.started=!1}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cleaner=setInterval(()=>{this._cleanup().catch(a=>{log$e.error(a)})},this.cleanupInterval))}async stop(){this.started=!1,this.cleaner!=null&&(clearInterval(this.cleaner),this.cleaner=void 0)}async _cleanup(){return await this.syncQueue.add(async()=>{const a=Date.now();let $=0,j=0;const _e=new Map,et=this.components.datastore.batch(),tt=this.components.datastore.query({prefix:PROVIDER_KEY_PREFIX});for await(const rt of tt)try{const{cid:nt,peerId:it}=parseProviderKey(rt.key),st=readTime(rt.value).getTime(),ot=Date.now(),at=ot-st,lt=at>this.provideValidity;if(log$e("comparing: %d - %d = %d > %d %s",ot,st,at,this.provideValidity,lt?"(expired)":""),lt){j++,et.delete(rt.key);const ct=_e.get(nt)??new Set;ct.add(it),_e.set(nt,ct)}$++}catch(nt){log$e.error(nt.message)}_e.size>0?(log$e("deleting %d / %d entries",j,$),await et.commit()):log$e("nothing to delete");for(const[rt,nt]of _e){const it=makeProviderKey(rt),st=this.cache.get(it);if(st!=null){for(const ot of nt)st.delete(ot);st.size===0?this.cache.remove(it):this.cache.set(it,st)}}log$e("Cleanup successful (%dms)",Date.now()-a)})}async _getProvidersMap(a){const $=makeProviderKey(a);let j=this.cache.get($);return j==null&&(j=await loadProviders(this.components.datastore,a),this.cache.set($,j)),j}async addProvider(a,$){return await this.syncQueue.add(async()=>{log$e("%p provides %s",$,a);const j=await this._getProvidersMap(a);log$e("loaded %s provs",j.size);const _e=new Date;j.set($.toString(),_e);const et=makeProviderKey(a);this.cache.set(et,j),await writeProviderEntry(this.components.datastore,a,$,_e)})}async getProviders(a){return await this.syncQueue.add(async()=>(log$e("get providers for %s",a),[...(await this._getProvidersMap(a)).keys()].map(j=>peerIdFromString(j))))}}function makeProviderKey(_){const a=typeof _=="string"?_:toString$6(_.multihash.bytes,"base32");return`${PROVIDER_KEY_PREFIX}/${a}`}async function writeProviderEntry(_,a,$,j){const _e=[makeProviderKey(a),"/",$.toString()].join(""),et=new Key(_e),tt=Uint8Array.from(varint$4.encode(j.getTime()));return await _.put(et,tt)}function parseProviderKey(_){const a=_.toString().split("/");if(a.length!==5)throw new Error(`incorrectly formatted provider entry key in datastore: ${_.toString()}`);return{cid:a[3],peerId:a[4]}}async function loadProviders(_,a){const $=new Map,j=_.query({prefix:makeProviderKey(a)});for await(const _e of j){const{peerId:et}=parseProviderKey(_e.key);$.set(et,readTime(_e.value))}return $}function readTime(_){return new Date(varint$4.decode(_))}const MAX_XOR=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");async function*queryPath(_){const{key:a,startingPeer:$,ourPeerId:j,signal:_e,query:et,alpha:tt,pathIndex:rt,numPaths:nt,cleanUp:it,queryFuncTimeout:st,log:ot,peersSeen:at}=_,lt=new PQueue({concurrency:tt}),ct=await convertBuffer(a);function ut(dt,ft){if(dt==null)return;at.add(dt);const pt=BigInt("0x"+toString$6(xor(ft,ct),"base16"));lt.add(async()=>{let yt;const mt=[_e];st!=null&&(yt=new timeoutAbortController.TimeoutController(st),mt.push(yt.signal));const _t=anySignal_2(mt);try{for await(const vt of et({key:a,peer:dt,signal:_t,pathIndex:rt,numPaths:nt})){if(_t.aborted)return;if(vt.name==="PEER_RESPONSE")for(const ht of vt.closer){if(at.has(ht.id)){ot("already seen %p in query",ht.id);continue}if(j.equals(ht.id)){ot("not querying ourselves");continue}const St=await convertPeerId(ht.id);if(BigInt("0x"+toString$6(xor(St,ct),"base16"))>pt){ot("skipping %p as they are not closer to %b than %p",ht.id,a,dt);continue}ot("querying closer peer %p",ht.id),ut(ht.id,St)}lt.emit("completed",vt)}yt?.clear()}catch(vt){_e.aborted?lt.emit("error",vt):lt.emit("completed",queryErrorEvent({from:dt,error:vt}))}finally{yt?.clear()}},{priority:MAX_XOR-pt}).catch(yt=>{ot.error(yt)})}ut($,await convertPeerId($)),yield*toGenerator(lt,_e,it,ot)}async function*toGenerator(_,a,$,j){let _e=pDefer$2(),et=!0;const tt=[],rt=()=>{!et||(j("clean up queue, results %d, queue size %d, pending tasks %d",tt.length,_.size,_.pending),et=!1,_.clear(),tt.splice(0,tt.length))};for(_.on("completed",nt=>{tt.push(nt),_e.resolve()}),_.on("error",nt=>{j("queue error",nt),rt(),_e.reject(nt)}),_.on("idle",()=>{j("queue idle"),et=!1,_e.resolve()}),a.addEventListener("abort",()=>{j("abort queue");const nt=et;rt(),nt&&_e.reject(errCode(new Error("Query aborted"),"ERR_QUERY_ABORTED"))}),$.addEventListener("cleanup",()=>{rt(),_e.resolve()});et;)for(await _e.promise,_e=pDefer$2();tt.length>0;){const nt=tt.shift();nt!=null&&(yield nt)}yield*tt}const FIFO=fastFifo;var itPushable=_=>{_=_||{};let a;typeof _=="function"?(a=_,_={}):a=_.onEnd;let $=new FIFO,j,_e,et;const tt=()=>{if(!$.isEmpty()){if(_.writev){let ut;const dt=[];for(;!$.isEmpty();){if(ut=$.shift(),ut.error)throw ut.error;dt.push(ut.value)}return{done:ut.done,value:dt}}const ct=$.shift();if(ct.error)throw ct.error;return ct}return et?{done:!0}:new Promise((ct,ut)=>{_e=dt=>(_e=null,dt.error?ut(dt.error):_.writev&&!dt.done?ct({done:dt.done,value:[dt.value]}):ct(dt),j)})},rt=ct=>_e?_e(ct):($.push(ct),j),nt=ct=>($=new FIFO,_e?_e({error:ct}):($.push({error:ct}),j)),it=ct=>et?j:rt({done:!1,value:ct}),st=ct=>et?j:(et=!0,ct?nt(ct):rt({done:!0})),ot=()=>($=new FIFO,st(),{done:!0}),at=ct=>(st(ct),{done:!0});if(j={[Symbol.asyncIterator](){return this},next:tt,return:ot,throw:at,push:it,end:st},!a)return j;const lt=j;return j={[Symbol.asyncIterator](){return this},next(){return lt.next()},throw(ct){return lt.throw(ct),a&&(a(ct),a=null),{done:!0}},return(){return lt.return(),a&&(a(),a=null),{done:!0}},push:it,end(ct){return lt.end(ct),a&&(a(ct),a=null),j}},j};const pushable=itPushable,merge=async function*(..._){const a=pushable();setTimeout(async()=>{try{await Promise.all(_.map(async $=>{for await(const j of $)a.push(j)})),a.end()}catch($){a.end($)}},0),yield*a};var itMerge=merge;const METRIC_RUNNING_QUERIES="running-queries";class QueryManager{constructor(a,$){const{lan:j=!1,disjointPaths:_e=K,alpha:et=ALPHA}=$;this.components=a,this.disjointPaths=_e??K,this.controllers=new Set,this.running=!1,this.alpha=et??ALPHA,this.lan=j,this.queries=0}isStarted(){return this.running}async start(){this.running=!0}async stop(){this.running=!1;for(const a of this.controllers)a.abort();this.controllers.clear()}async*run(a,$,j,_e={}){if(!this.running)throw new Error("QueryManager not started");let et;if(_e.signal==null){et=new timeoutAbortController.TimeoutController(DEFAULT_QUERY_TIMEOUT),_e.signal=et.signal;try{events.exports.setMaxListeners!=null&&events.exports.setMaxListeners(1/0,et.signal)}catch{}}const tt=new AbortController;this.controllers.add(tt);const rt=[tt.signal];_e.signal!=null&&rt.push(_e.signal);const nt=anySignal_2(rt);try{events.exports.setMaxListeners!=null&&events.exports.setMaxListeners(1/0,nt)}catch{}const it=logger$1(`libp2p:kad-dht:${this.lan?"lan":"wan"}:query:`+toString$6(a,"base58btc")),st=$.slice(0,Math.min(this.disjointPaths,$.length)),ot=Date.now(),at=new EventEmitter$1;try{if(it("query:start"),this.queries++,this.components.metrics?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:METRIC_RUNNING_QUERIES,value:this.queries}),$.length===0){it.error("Running query with no peers");return}const lt=new PeerSet,ct=st.map((ut,dt)=>queryPath({key:a,startingPeer:ut,ourPeerId:this.components.peerId,signal:nt,query:j,pathIndex:dt,numPaths:st.length,alpha:this.alpha,cleanUp:at,queryFuncTimeout:_e.queryFuncTimeout,log:it,peersSeen:lt}));for await(const ut of itMerge(...ct))yield ut,ut.name==="QUERY_ERROR"&&it("error",ut.error)}catch(lt){if(!(!this.running&&lt.code==="ERR_QUERY_ABORTED"))throw lt}finally{this.controllers.delete(tt),et?.clear(),this.queries--,this.components.metrics?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:METRIC_RUNNING_QUERIES,value:this.queries}),at.dispatchEvent(new CustomEvent$1("cleanup")),it("query:done in %dms",Date.now()-ot)}}}const log$d=logger$1("libp2p:kad-dht:rpc:handlers:add-provider");class AddProviderHandler{constructor(a){const{providers:$}=a;this.providers=$}async handle(a,$){if(log$d("start"),$.key==null||$.key.length===0)throw errCode(new Error("Missing key"),"ERR_MISSING_KEY");let j;try{j=CID.decode($.key)}catch{throw errCode(new Error("Invalid CID"),"ERR_INVALID_CID")}($.providerPeers==null||$.providerPeers.length===0)&&log$d.error("no providers found in message"),await Promise.all($.providerPeers.map(async _e=>{if(!_e.id.equals(a)){log$d("invalid provider peer %p from %p",_e.id,a);return}if(_e.multiaddrs.length<1){log$d("no valid addresses for provider %p. Ignore",a);return}log$d("received provider %p for %s (addrs %s)",a,j,_e.multiaddrs.map(et=>et.toString())),await this.providers.addProvider(j,_e.id)}))}}const log$c=logger$1("libp2p:kad-dht:rpc:handlers:find-node");class FindNodeHandler{constructor(a,$){const{peerRouting:j,lan:_e}=$;this.components=a,this.peerRouting=j,this.lan=Boolean(_e)}async handle(a,$){log$c("incoming request from %p for peers closer to %b",a,$.key);let j=[];equals$1(this.components.peerId.toBytes(),$.key)?j=[{id:this.components.peerId,multiaddrs:this.components.addressManager.getAddresses().map(et=>et.decapsulateCode(getProtocol("p2p").code)),protocols:[]}]:j=await this.peerRouting.getCloserPeersOffline($.key,a),j=j.map(this.lan?removePublicAddresses:removePrivateAddresses).filter(({multiaddrs:et})=>et.length);const _e=new Message$1($.type,new Uint8Array(0),$.clusterLevel);return j.length>0?_e.closerPeers=j:log$c("could not find any peers closer to %b than %p",$.key,a),_e}}const log$b=logger$1("libp2p:kad-dht:rpc:handlers:get-providers");class GetProvidersHandler{constructor(a,$){const{peerRouting:j,providers:_e,lan:et}=$;this.components=a,this.peerRouting=j,this.providers=_e,this.lan=Boolean(et)}async handle(a,$){let j;try{j=CID.decode($.key)}catch{throw errCode(new Error("Invalid CID"),"ERR_INVALID_CID")}log$b("%p asking for providers for %s",a,j);const[_e,et]=await Promise.all([this.providers.getProviders(j),this.peerRouting.getCloserPeersOffline($.key,a)]),tt=await this._getPeers(_e),rt=await this._getPeers(et.map(({id:it})=>it)),nt=new Message$1($.type,$.key,$.clusterLevel);return tt.length>0&&(nt.providerPeers=tt),rt.length>0&&(nt.closerPeers=rt),log$b("got %s providers %s closerPeers",tt.length,rt.length),nt}async _getAddresses(a){return(await this.components.peerStore.addressBook.get(a)).map(j=>j.multiaddr)}async _getPeers(a){const $=[],j=this.lan?removePublicAddresses:removePrivateAddresses;for(const _e of a){const et=j({id:_e,multiaddrs:await this._getAddresses(_e),protocols:[]});et.multiaddrs.length>0&&$.push(et)}return $}}const log$a=logger$1("libp2p:kad-dht:rpc:handlers:get-value");class GetValueHandler{constructor(a,$){const{peerRouting:j}=$;this.components=a,this.peerRouting=j}async handle(a,$){const j=$.key;if(log$a("%p asked for key %b",a,j),j==null||j.length===0)throw errCode(new Error("Invalid key"),"ERR_INVALID_KEY");const _e=new Message$1(MESSAGE_TYPE.GET_VALUE,j,$.clusterLevel);if(isPublicKeyKey(j)){log$a("is public key");const rt=fromPublicKeyKey(j);let nt;try{const it=await this.components.peerStore.keyBook.get(rt);if(it==null)throw errCode(new Error("No public key found in key book"),"ERR_NOT_FOUND");nt=it}catch(it){if(it.code!=="ERR_NOT_FOUND")throw it}if(nt!=null)return log$a("returning found public key"),_e.record=new Libp2pRecord(j,nt,new Date),_e}const[et,tt]=await Promise.all([this._checkLocalDatastore(j),this.peerRouting.getCloserPeersOffline($.key,a)]);return et!=null&&(log$a("had record for %b in local datastore",j),_e.record=et),tt.length>0&&(log$a("had %s closer peers in routing table",tt.length),_e.closerPeers=tt),_e}async _checkLocalDatastore(a){log$a("checkLocalDatastore looking for %b",a);const $=bufferToRecordKey(a);let j;try{j=await this.components.datastore.get($)}catch(et){if(et.code==="ERR_NOT_FOUND")return;throw et}const _e=Libp2pRecord.deserialize(j);if(_e==null)throw errCode(new Error("Invalid record"),"ERR_INVALID_RECORD");if(_e.timeReceived==null||Date.now()-_e.timeReceived.getTime()>MAX_RECORD_AGE){await this.components.datastore.delete($);return}return _e}}const log$9=logger$1("libp2p:kad-dht:rpc:handlers:ping");class PingHandler{async handle(a,$){return log$9("ping from %p",a),$}}class PutValueHandler{constructor(a,$){const{validators:j}=$;this.components=a,this.log=logger$1("libp2p:kad-dht:rpc:handlers:put-value"),this.validators=j}async handle(a,$){const j=$.key;this.log("%p asked us to store value for key %b",a,j);const _e=$.record;if(_e==null){const et=`Empty record from: ${a.toString()}`;throw this.log.error(et),errCode(new Error(et),"ERR_EMPTY_RECORD")}try{await verifyRecord(this.validators,_e),_e.timeReceived=new Date;const et=bufferToRecordKey(_e.key);await this.components.datastore.put(et,_e.serialize().subarray()),this.log("put record for %b into datastore under key %k",j,et)}catch(et){this.log("did not put record for key %b into datastore %o",j,et)}return $}}class RPC{constructor(a,$){const{providers:j,peerRouting:_e,validators:et,lan:tt}=$;this.log=logger$1("libp2p:kad-dht:rpc"),this.routingTable=$.routingTable,this.handlers={[MESSAGE_TYPE.GET_VALUE]:new GetValueHandler(a,{peerRouting:_e}),[MESSAGE_TYPE.PUT_VALUE]:new PutValueHandler(a,{validators:et}),[MESSAGE_TYPE.FIND_NODE]:new FindNodeHandler(a,{peerRouting:_e,lan:tt}),[MESSAGE_TYPE.ADD_PROVIDER]:new AddProviderHandler({providers:j}),[MESSAGE_TYPE.GET_PROVIDERS]:new GetProvidersHandler(a,{peerRouting:_e,providers:j,lan:tt}),[MESSAGE_TYPE.PING]:new PingHandler}}async handleMessage(a,$){try{await this.routingTable.add(a)}catch(_e){this.log.error("Failed to update the kbucket store",_e)}const j=this.handlers[$.type];if(j==null){this.log.error(`no handler found for message type: ${$.type}`);return}return await j.handle(a,$)}onIncomingStream(a){Promise.resolve().then(async()=>{const{stream:$,connection:j}=a,_e=j.remotePeer;try{await this.routingTable.add(_e)}catch(tt){this.log.error(tt)}const et=this;await pipe($,decode$4(),async function*(tt){for await(const rt of tt){const nt=Message$1.deserialize(rt);et.log("incoming %s from %p",nt.type,_e);const it=await et.handleMessage(_e,nt);it!=null&&(yield it.serialize())}},encode$5(),$)}).catch($=>{this.log.error($)})}}class TopologyListener extends EventEmitter$1{constructor(a,$){super();const{protocol:j,lan:_e}=$;this.components=a,this.log=logger$1(`libp2p:kad-dht:topology-listener:${_e?"lan":"wan"}`),this.running=!1,this.protocol=j}isStarted(){return this.running}async start(){if(this.running)return;this.running=!0;const a=createTopology({onConnect:$=>{this.log("observed peer %p with protocol %s",$,this.protocol),this.dispatchEvent(new CustomEvent$1("peer",{detail:$}))}});this.registrarId=await this.components.registrar.register(this.protocol,a)}stop(){this.running=!1,this.registrarId!=null&&(this.components.registrar.unregister(this.registrarId),this.registrarId=void 0)}}class QuerySelf{constructor(a,$){const{peerRouting:j,lan:_e,count:et,interval:tt,queryTimeout:rt}=$;this.components=a,this.log=logger$1(`libp2p:kad-dht:${_e?"lan":"wan"}:query-self`),this.running=!1,this.peerRouting=j,this.count=et??K,this.interval=tt??QUERY_SELF_INTERVAL,this.queryTimeout=rt??QUERY_SELF_TIMEOUT}isStarted(){return this.running}async start(){this.running||(this.running=!0,this._querySelf())}async stop(){this.running=!1,this.timeoutId!=null&&clearTimeout(this.timeoutId),this.controller!=null&&this.controller.abort()}_querySelf(){Promise.resolve().then(async()=>{const a=new timeoutAbortController.TimeoutController(this.queryTimeout);try{this.controller=new AbortController;const $=anySignal_2([this.controller.signal,a.signal]);try{events.exports.setMaxListeners!=null&&events.exports.setMaxListeners(1/0,$)}catch{}const j=await pipe(this.peerRouting.getClosestPeers(this.components.peerId.toBytes(),{signal:$}),_e=>itTake(_e,this.count),async _e=>await itLength(_e));this.log("query ran successfully - found %d peers",j)}catch($){this.log("query error",$)}finally{this.timeoutId=setTimeout(this._querySelf.bind(this),this.interval),a.clear()}}).catch(a=>{this.log("query error",a)})}}const DEFAULT_MAX_INBOUND_STREAMS$1=32,DEFAULT_MAX_OUTBOUND_STREAMS$1=64;class KadDHT$1 extends EventEmitter$1{constructor(a,$){super();const{kBucketSize:j,clientMode:_e,validators:et,selectors:tt,querySelfInterval:rt,lan:nt,protocolPrefix:it,pingTimeout:st,pingConcurrency:ot,maxInboundStreams:at,maxOutboundStreams:lt}=$;this.running=!1,this.components=a,this.lan=Boolean(nt),this.log=logger$1(`libp2p:kad-dht:${nt===!0?"lan":"wan"}`),this.protocol=`${it??PROTOCOL_PREFIX}${nt===!0?LAN_PREFIX:""}${PROTOCOL_DHT}`,this.kBucketSize=j??20,this.clientMode=_e??!0,this.maxInboundStreams=at??DEFAULT_MAX_INBOUND_STREAMS$1,this.maxOutboundStreams=lt??DEFAULT_MAX_OUTBOUND_STREAMS$1,this.routingTable=new RoutingTable(a,{kBucketSize:j,lan:this.lan,pingTimeout:st,pingConcurrency:ot,protocol:this.protocol}),this.providers=new Providers(a),this.validators={...validators,...et},this.selectors={...selectors,...tt},this.network=new Network$2(a,{protocol:this.protocol,lan:this.lan}),this.queryManager=new QueryManager(a,{disjointPaths:Math.ceil(this.kBucketSize/2),lan:nt}),this.peerRouting=new PeerRouting(a,{routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,lan:this.lan}),this.contentFetching=new ContentFetching(a,{validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,network:this.network,lan:this.lan}),this.contentRouting=new ContentRouting(a,{network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,lan:this.lan}),this.routingTableRefresh=new RoutingTableRefresh({peerRouting:this.peerRouting,routingTable:this.routingTable,lan:this.lan}),this.rpc=new RPC(a,{routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,lan:this.lan}),this.topologyListener=new TopologyListener(a,{protocol:this.protocol,lan:this.lan}),this.querySelf=new QuerySelf(a,{peerRouting:this.peerRouting,interval:rt,lan:this.lan}),this.network.addEventListener("peer",ct=>{const ut=ct.detail;this.onPeerConnect(ut).catch(dt=>{this.log.error("could not add %p to routing table",ut.id,dt)}),this.dispatchEvent(new CustomEvent$1("peer",{detail:ut}))}),this.topologyListener.addEventListener("peer",ct=>{const ut=ct.detail;Promise.resolve().then(async()=>{const dt=await this.components.peerStore.addressBook.get(ut),ft={id:ut,multiaddrs:dt.map(pt=>pt.multiaddr),protocols:[]};await this.onPeerConnect(ft)}).catch(dt=>{this.log.error("could not add %p to routing table",ut,dt)})})}get[symbol$1](){return!0}get[Symbol.toStringTag](){return"@libp2p/kad-dht"}async onPeerConnect(a){if(this.log("peer %p connected with protocols %s",a.id,a.protocols),this.lan?a=removePublicAddresses(a):a=removePrivateAddresses(a),a.multiaddrs.length===0){this.log("ignoring %p as they do not have any %s addresses in %s",a.id,this.lan?"private":"public",a.multiaddrs.map($=>$.toString()));return}try{await this.routingTable.add(a.id)}catch($){this.log.error("could not add %p to routing table",a.id,$)}}isStarted(){return this.running}async getMode(){return this.clientMode?"client":"server"}async setMode(a){await this.components.registrar.unhandle(this.protocol),a==="client"?(this.log("enabling client mode"),this.clientMode=!0):(this.log("enabling server mode"),this.clientMode=!1,await this.components.registrar.handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))}async start(){this.running=!0,await this.setMode(this.clientMode?"client":"server"),await Promise.all([this.providers.start(),this.queryManager.start(),this.network.start(),this.routingTable.start(),this.topologyListener.start(),this.querySelf.start()]),await this.routingTableRefresh.start()}async stop(){this.running=!1,await Promise.all([this.providers.stop(),this.queryManager.stop(),this.network.stop(),this.routingTable.stop(),this.routingTableRefresh.stop(),this.topologyListener.stop(),this.querySelf.stop()])}async*put(a,$,j={}){yield*this.contentFetching.put(a,$,j)}async*get(a,$={}){yield*this.contentFetching.get(a,$)}async*provide(a,$={}){yield*this.contentRouting.provide(a,this.components.addressManager.getAddresses(),$)}async*findProviders(a,$={}){yield*this.contentRouting.findProviders(a,$)}async*findPeer(a,$={}){yield*this.peerRouting.findPeer(a,$)}async*getClosestPeers(a,$={}){yield*this.peerRouting.getClosestPeers(a,$)}async refreshRoutingTable(){await this.routingTableRefresh.refreshTable(!0)}}const log$8=logger$1("libp2p:kad-dht");class DualKadDHT extends EventEmitter$1{constructor(a,$,j){super(),this.components=a,this.wan=$,this.lan=j,this.wan.addEventListener("peer",_e=>{this.dispatchEvent(new CustomEvent$1("peer",{detail:_e.detail}))}),this.lan.addEventListener("peer",_e=>{this.dispatchEvent(new CustomEvent$1("peer",{detail:_e.detail}))})}get[symbol$1](){return!0}get[Symbol.toStringTag](){return"@libp2p/dual-kad-dht"}isStarted(){return this.wan.isStarted()&&this.lan.isStarted()}async getMode(){return await this.wan.getMode()}async setMode(a){await this.wan.setMode(a)}async start(){await Promise.all([this.lan.start(),this.wan.start()])}async stop(){await Promise.all([this.lan.stop(),this.wan.stop()])}async*put(a,$,j={}){for await(const _e of itMerge(this.lan.put(a,$,j),this.wan.put(a,$,j)))yield _e}async*get(a,$={}){let j=!1,_e=!1;for await(const et of itMerge(this.lan.get(a,$),this.wan.get(a,$)))yield et,et.name==="DIALING_PEER"&&(j=!0),et.name==="VALUE"&&(j=!0,et.value!=null&&(_e=!0)),et.name==="SENDING_QUERY"&&(j=!0);if(!j)throw errCode(new Error("No peers found in routing table!"),"ERR_NO_PEERS_IN_ROUTING_TABLE");_e||(yield queryErrorEvent({from:this.components.peerId,error:errCode(new Error("Not found"),"ERR_NOT_FOUND")}))}async*provide(a,$={}){let j=0,_e=0;const et=[],tt=[this.lan];await this.wan.getMode()==="server"&&tt.push(this.wan);for await(const rt of itMerge(...tt.map(nt=>nt.provide(a,$))))yield rt,rt.name==="SENDING_QUERY"&&j++,rt.name==="QUERY_ERROR"&&et.push(rt.error),rt.name==="PEER_RESPONSE"&&rt.messageName==="ADD_PROVIDER"&&(log$8("sent provider record for %s to %p",a,rt.from),_e++);if(_e===0)throw et.length>0?errCode(new Error(`Failed to provide to ${et.length} of ${j} peers`),"ERR_PROVIDES_FAILED",{errors:et}):errCode(new Error("Failed to provide - no peers found"),"ERR_PROVIDES_FAILED")}async*findProviders(a,$={}){yield*itMerge(this.lan.findProviders(a,$),this.wan.findProviders(a,$))}async*findPeer(a,$={}){let j=!1;for await(const _e of itMerge(this.lan.findPeer(a,$),this.wan.findPeer(a,$)))yield _e,(_e.name==="SENDING_QUERY"||_e.name==="FINAL_PEER")&&(j=!0);if(!j)throw errCode(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED")}async*getClosestPeers(a,$={}){yield*itMerge(this.lan.getClosestPeers(a,$),this.wan.getClosestPeers(a,$))}async refreshRoutingTable(){await Promise.all([this.lan.refreshRoutingTable(),this.wan.refreshRoutingTable()])}}class KadDHT extends DualKadDHT{constructor(a,$){super(a,new KadDHT$1(a,{protocolPrefix:"/ipfs",...$,lan:!1}),new KadDHT$1(a,{protocolPrefix:"/ipfs",...$,clientMode:!1,lan:!0}))}}function kadDHT(_){return a=>new KadDHT(a,_)}const log$7=logger$1("libp2p:bootstrap"),DEFAULT_BOOTSTRAP_TAG_NAME="bootstrap",DEFAULT_BOOTSTRAP_TAG_VALUE=50,DEFAULT_BOOTSTRAP_TAG_TTL=12e4,DEFAULT_BOOTSTRAP_DISCOVERY_TIMEOUT=1e3;class Bootstrap extends EventEmitter$1{constructor(a,$={list:[]}){if($.list==null||$.list.length===0)throw new Error("Bootstrap requires a list of peer addresses");super(),this.components=a,this.timeout=$.timeout??DEFAULT_BOOTSTRAP_DISCOVERY_TIMEOUT,this.list=[];for(const j of $.list){if(!P2P.matches(j)){log$7.error("Invalid multiaddr");continue}const _e=multiaddr(j),et=_e.getPeerId();if(et==null){log$7.error("Invalid bootstrap multiaddr without peer id");continue}const tt={id:peerIdFromString(et),multiaddrs:[_e],protocols:[]};this.list.push(tt)}this._init=$}get[symbol$1](){return!0}get[Symbol.toStringTag](){return"@libp2p/bootstrap"}isStarted(){return Boolean(this.timer)}start(){this.isStarted()||(log$7("Starting bootstrap node discovery, discovering peers after %s ms",this.timeout),this.timer=setTimeout(()=>{this._discoverBootstrapPeers().catch(a=>{log$7.error(a)})},this.timeout))}async _discoverBootstrapPeers(){if(this.timer!=null)for(const a of this.list){if(await this.components.peerStore.tagPeer(a.id,this._init.tagName??DEFAULT_BOOTSTRAP_TAG_NAME,{value:this._init.tagValue??DEFAULT_BOOTSTRAP_TAG_VALUE,ttl:this._init.tagTTL??DEFAULT_BOOTSTRAP_TAG_TTL}),this.timer==null)return;this.dispatchEvent(new CustomEvent$1("peer",{detail:a}))}}stop(){this.timer!=null&&clearTimeout(this.timer),this.timer=void 0}}Bootstrap.tag="bootstrap";function bootstrap(_){return a=>new Bootstrap(a,_)}const WebSocket$1=WebSocket;var dom={},eventIterator={};Object.defineProperty(eventIterator,"__esModule",{value:!0});class EventQueue{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(a){if(this.isStopped)return;const $={value:a,done:!1};if(this.pullQueue.length){const j=this.pullQueue.shift();j&&j.resolve($)}else this.pushQueue.push(Promise.resolve($)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(const a of this.pullQueue)a.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(a){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(const $ of this.pullQueue)$.reject(a);this.pullQueue.length=0}else{const $=Promise.reject(a);$.catch(()=>{}),this.pushQueue.push($)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:a=>{const $=this.pushQueue.shift();return $?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),$):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((j,_e)=>{this.pullQueue.push({resolve:j,reject:_e})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}}class EventIterator$1{constructor(a,{highWaterMark:$=100,lowWaterMark:j=1}={}){const _e=new EventQueue;_e.highWaterMark=$,_e.lowWaterMark=j,_e.removeCallback=a({push:et=>_e.push(et),stop:()=>_e.stop(),fail:et=>_e.fail(et),on:(et,tt)=>{_e.eventHandlers[et]=tt}})||(()=>{}),this[Symbol.asyncIterator]=()=>_e[Symbol.asyncIterator](),Object.freeze(this)}}eventIterator.EventIterator=EventIterator$1;eventIterator.default=EventIterator$1;Object.defineProperty(dom,"__esModule",{value:!0});const event_iterator_1=eventIterator;var EventIterator=dom.EventIterator=event_iterator_1.EventIterator;function subscribe(_,a,$){return new event_iterator_1.EventIterator(({push:j})=>(this.addEventListener(_,j,a),()=>this.removeEventListener(_,j,a)),$)}dom.subscribe=subscribe;dom.default=event_iterator_1.EventIterator;function isArrayBuffer(_){return _ instanceof ArrayBuffer||_?.constructor?.name==="ArrayBuffer"&&typeof _?.byteLength=="number"}const source=_=>{_.binaryType="arraybuffer";const a=async()=>await new Promise((et,tt)=>{if(j)return et();if(_e!=null)return tt(_e);const rt=st=>{_.removeEventListener("open",nt),_.removeEventListener("error",it),st()},nt=()=>rt(et),it=st=>{rt(()=>tt(st.error??new Error(`connect ECONNREFUSED ${_.url}`)))};_.addEventListener("open",nt),_.addEventListener("error",it)}),$=async function*(){const et=new EventIterator(({push:tt,stop:rt,fail:nt})=>{const it=ot=>{let at=null;typeof ot.data=="string"&&(at=fromString$5(ot.data)),isArrayBuffer(ot.data)&&(at=new Uint8Array(ot.data)),ot.data instanceof Uint8Array&&(at=ot.data),at!=null&&tt(at)},st=ot=>nt(ot.error??new Error("Socket error"));return _.addEventListener("message",it),_.addEventListener("error",st),_.addEventListener("close",rt),()=>{_.removeEventListener("message",it),_.removeEventListener("error",st),_.removeEventListener("close",rt)}},{highWaterMark:1/0});await a();for await(const tt of et)yield isArrayBuffer(tt)?new Uint8Array(tt):tt}();let j=_.readyState===1,_e;return _.addEventListener("open",()=>{j=!0,_e=null}),_.addEventListener("close",()=>{j=!1,_e=null}),_.addEventListener("error",et=>{j||(_e=et.error??new Error(`connect ECONNREFUSED ${_.url}`))}),Object.assign($,{connected:a})},ready=_=>{if(_.readyState>=2)throw new Error("socket closed");if(_.readyState!==1)return new Promise((a,$)=>{function j(){_.removeEventListener("open",_e),_.removeEventListener("error",et)}function _e(){j(),a()}function et(tt){j(),$(tt.error??new Error(`connect ECONNREFUSED ${_.url}`))}_.addEventListener("open",_e),_.addEventListener("error",et)})},sink=(_,a)=>(a=a??{},a.closeOnEnd=a.closeOnEnd!==!1,async j=>{for await(const _e of j){try{await ready(_)}catch(et){if(et.message==="socket closed")break;throw et}_.send(_e)}if(a.closeOnEnd!=null&&_.readyState<=1)return await new Promise((_e,et)=>{_.addEventListener("close",tt=>{if(tt.wasClean||tt.code===1006)_e();else{const rt=Object.assign(new Error("ws error"),{event:tt});et(rt)}}),setTimeout(()=>_.close())})}),duplex=(_,a)=>{a=a??{};const $=source(_);let j=a.remoteAddress,_e=a.remotePort;if(_.url!=null)try{const tt=new URL(_.url);j=tt.hostname,_e=parseInt(tt.port,10)}catch{}if(j==null||_e==null)throw new Error("Remote connection did not have address and/or port");return{sink:sink(_,a),source:$,connected:async()=>await $.connected(),close:async()=>{(_.readyState===_.CONNECTING||_.readyState===_.OPEN)&&await new Promise(tt=>{_.addEventListener("close",()=>{tt()}),_.close()})},destroy:()=>{_.terminate!=null?_.terminate():_.close()},remoteAddress:j,remotePort:_e,socket:_}},map={http:"ws",https:"wss"},def="ws",wsurl=(_,a)=>isoUrl.relative(_,a,map,def);function connect(_,a){const $=typeof window>"u"?"":window.location;a=a??{};const j=wsurl(_,$.toString()),_e=new WebSocket$1(j,a.websocket);return duplex(_e,a)}function createListener(){throw new Error("WebSocket Servers can not be created in the browser!")}const CODE_P2P=421,CODE_CIRCUIT=290,CODE_TCP=6,CODE_WSS=478,CLOSE_TIMEOUT=2e3;class TimeoutError extends Error{constructor(a){super(a),this.name="TimeoutError"}}class AbortError extends Error{constructor(a){super(),this.name="AbortError",this.message=a}}const getDOMException=_=>globalThis.DOMException===void 0?new AbortError(_):new DOMException(_),getAbortedReason=_=>{const a=_.reason===void 0?getDOMException("This operation was aborted."):_.reason;return a instanceof Error?a:getDOMException(a)};function pTimeout(_,a){const{milliseconds:$,fallback:j,message:_e,customTimers:et={setTimeout,clearTimeout}}=a;let tt;const rt=new Promise((nt,it)=>{if(typeof $!="number"||Math.sign($)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${$}\``);if($===Number.POSITIVE_INFINITY){nt(_);return}if(a.signal){const{signal:st}=a;st.aborted&&it(getAbortedReason(st)),st.addEventListener("abort",()=>{it(getAbortedReason(st))})}tt=et.setTimeout.call(void 0,()=>{if(j){try{nt(j())}catch(at){it(at)}return}const st=typeof _e=="string"?_e:`Promise timed out after ${$} milliseconds`,ot=_e instanceof Error?_e:new TimeoutError(st);typeof _.cancel=="function"&&_.cancel(),it(ot)},$),(async()=>{try{nt(await _)}catch(st){it(st)}finally{et.clearTimeout.call(void 0,tt)}})()});return rt.clear=()=>{et.clearTimeout.call(void 0,tt),tt=void 0},rt}const log$6=logger$1("libp2p:websockets:socket");function socketToMaConn(_,a,$){$=$??{};const j={async sink(_e){$?.signal!=null&&(_e=abortableSource(_e,$.signal));try{await _.sink(_e)}catch(et){et.type!=="aborted"&&log$6.error(et)}},source:$.signal!=null?abortableSource(_.source,$.signal):_.source,remoteAddr:a,timeline:{open:Date.now()},async close(){const _e=Date.now();try{await pTimeout(_.close(),{milliseconds:CLOSE_TIMEOUT})}catch{const{host:tt,port:rt}=j.remoteAddr.toOptions();log$6("timeout closing stream to %s:%s after %dms, destroying it manually",tt,rt,Date.now()-_e),_.destroy()}finally{j.timeline.close=Date.now()}}};return _.socket.addEventListener("close",()=>{j.timeline.close==null&&(j.timeline.close=Date.now())},{once:!0}),j}function all(_){return _.filter(a=>{if(a.protoCodes().includes(CODE_CIRCUIT))return!1;const $=a.decapsulateCode(CODE_P2P);return WebSockets$1.matches($)||WebSocketsSecure.matches($)})}function dnsWss(_){return _.filter(a=>{if(a.protoCodes().includes(CODE_CIRCUIT))return!1;const $=a.decapsulateCode(CODE_P2P);return WebSocketsSecure.matches($)&&DNS.matches($.decapsulateCode(CODE_TCP).decapsulateCode(CODE_WSS))})}const log$5=logger$1("libp2p:websockets");class WebSockets{constructor(a){this.init=a}get[Symbol.toStringTag](){return"@libp2p/websockets"}get[symbol$2](){return!0}async dial(a,$){log$5("dialing %s",a),$=$??{};const j=await this._connect(a,$),_e=socketToMaConn(j,a);log$5("new outbound connection %s",_e.remoteAddr);const et=await $.upgrader.upgradeOutbound(_e);return log$5("outbound connection %s upgraded",_e.remoteAddr),et}async _connect(a,$){if($?.signal?.aborted===!0)throw new AbortError$1;const j=a.toOptions();log$5("dialing %s:%s",j.host,j.port);const _e=pDefer$2(),et=it=>{log$5.error("connection error:",it),_e.reject(it)},tt=connect(multiaddrToUri(a),this.init);if(tt.socket.on!=null?tt.socket.on("error",et):tt.socket.onerror=et,$.signal==null)return await Promise.race([tt.connected(),_e.promise]),log$5("connected %s",a),tt;let rt;const nt=new Promise((it,st)=>{if(rt=()=>{st(new AbortError$1),tt.close().catch(ot=>{log$5.error("error closing raw socket",ot)})},$?.signal?.aborted===!0)return rt();$?.signal?.addEventListener("abort",rt)});try{await Promise.race([nt,_e.promise,tt.connected()])}finally{rt!=null&&$?.signal?.removeEventListener("abort",rt)}return log$5("connected %s",a),tt}createListener(a){return createListener({...this.init,...a})}filter(a){return a=Array.isArray(a)?a:[a],this.init?.filter!=null?this.init?.filter(a):isBrowser||isWebWorker?dnsWss(a):all(a)}}function webSockets(_={}){return()=>new WebSockets(_)}function allocUnsafe$1(_){return new Uint8Array(_)}var MessageTypes;(function(_){_[_.NEW_STREAM=0]="NEW_STREAM",_[_.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",_[_.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",_[_.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",_[_.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",_[_.RESET_RECEIVER=5]="RESET_RECEIVER",_[_.RESET_INITIATOR=6]="RESET_INITIATOR"})(MessageTypes||(MessageTypes={}));const MessageTypeNames=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),InitiatorMessageTypes=Object.freeze({NEW_STREAM:MessageTypes.NEW_STREAM,MESSAGE:MessageTypes.MESSAGE_INITIATOR,CLOSE:MessageTypes.CLOSE_INITIATOR,RESET:MessageTypes.RESET_INITIATOR}),ReceiverMessageTypes=Object.freeze({MESSAGE:MessageTypes.MESSAGE_RECEIVER,CLOSE:MessageTypes.CLOSE_RECEIVER,RESET:MessageTypes.RESET_RECEIVER}),POOL_SIZE=10*1024;class Encoder{constructor(){this._pool=allocUnsafe$1(POOL_SIZE),this._poolOffset=0}write(a){const $=this._pool;let j=this._poolOffset;varint$4.encode(a.id<<3|a.type,$,j),j+=varint$4.encode.bytes,(a.type===MessageTypes.NEW_STREAM||a.type===MessageTypes.MESSAGE_INITIATOR||a.type===MessageTypes.MESSAGE_RECEIVER)&&a.data!=null?varint$4.encode(a.data.length,$,j):varint$4.encode(0,$,j),j+=varint$4.encode.bytes;const _e=$.subarray(this._poolOffset,j);return POOL_SIZE-j<100?(this._pool=allocUnsafe$1(POOL_SIZE),this._poolOffset=0):this._poolOffset=j,(a.type===MessageTypes.NEW_STREAM||a.type===MessageTypes.MESSAGE_INITIATOR||a.type===MessageTypes.MESSAGE_RECEIVER)&&a.data!=null?[_e,...a.data instanceof Uint8Array?[a.data]:a.data]:[_e]}}const encoder=new Encoder;async function*encode$1(_){for await(const a of _)if(Array.isArray(a))for(const $ of a)yield*encoder.write($);else yield*encoder.write(a)}class Decoder{constructor(){this._buffer=new Uint8ArrayList,this._headerInfo=null}write(a){if(a==null||a.length===0)return[];this._buffer.append(a);const $=[];for(;this._buffer.length!==0;){if(this._headerInfo==null)try{this._headerInfo=this._decodeHeader(this._buffer)}catch{break}const{id:j,type:_e,length:et,offset:tt}=this._headerInfo;if(this._buffer.length-tt<et)break;const nt={id:j,type:_e};(_e===MessageTypes.NEW_STREAM||_e===MessageTypes.MESSAGE_INITIATOR||_e===MessageTypes.MESSAGE_RECEIVER)&&(nt.data=this._buffer.sublist(tt,tt+et)),$.push(nt),this._buffer.consume(tt+et),this._headerInfo=null}return $}_decodeHeader(a){const{value:$,offset:j}=readVarInt(a),{value:_e,offset:et}=readVarInt(a,j),tt=$&7;if(MessageTypeNames[tt]==null)throw new Error(`Invalid type received: ${tt}`);return{id:$>>3,type:tt,offset:j+et,length:_e}}}const MSB$2=128,REST$2=127;function readVarInt(_,a=0){let $=0,j=0,_e=a,et;const tt=_.length;do{if(_e>=tt||j>49)throw a=0,new RangeError("Could not decode varint");et=_.get(_e++),$+=j<28?(et&REST$2)<<j:(et&REST$2)*Math.pow(2,j),j+=7}while(et>=MSB$2);return a=_e-a,{value:$,offset:a}}async function*decode$1(_){const a=new Decoder;for await(const $ of _){const j=a.write($);j.length>0&&(yield j)}}const MAX_MSG_SIZE=1<<20;function restrictSize(_){const a=_??MAX_MSG_SIZE,$=j=>{if(!(j.type!==MessageTypes.NEW_STREAM&&j.type!==MessageTypes.MESSAGE_INITIATOR&&j.type!==MessageTypes.MESSAGE_RECEIVER)&&j.data.byteLength>a)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return j=>async function*(){for await(const et of j)Array.isArray(et)?(et.forEach($),yield*et):($(et),yield et)}()}const log$4=logger$1("libp2p:mplex:stream"),ERR_STREAM_RESET="ERR_STREAM_RESET",ERR_STREAM_ABORT="ERR_STREAM_ABORT",ERR_SINK_ENDED="ERR_SINK_ENDED",ERR_DOUBLE_SINK="ERR_DOUBLE_SINK";function createStream(_){const{id:a,name:$,send:j,onEnd:_e,type:et="initiator",maxMsgSize:tt=MAX_MSG_SIZE}=_,rt=new AbortController,nt=new AbortController,it=new AbortController,st=et==="initiator"?InitiatorMessageTypes:ReceiverMessageTypes,ot=et==="initiator"?`i${a}`:`r${a}`,at=`${$??a}`;let lt=!1,ct=!1,ut=!1,dt;const ft={open:Date.now()},pt=vt=>{lt||(lt=!0,log$4.trace("%s stream %s source end - err: %o",et,at,vt),vt!=null&&dt==null&&(dt=vt),ct&&(_t.stat.timeline.close=Date.now(),_e?.(dt)))},yt=vt=>{ct||(ct=!0,log$4.trace("%s stream %s sink end - err: %o",et,at,vt),vt!=null&&dt==null&&(dt=vt),lt&&(ft.close=Date.now(),_e?.(dt)))},mt=pushable$2({onEnd:pt}),_t={close:()=>{log$4.trace("%s stream %s close",et,at),_t.closeRead(),_t.closeWrite()},closeRead:()=>{log$4.trace("%s stream %s closeRead",et,at),!lt&&mt.end()},closeWrite:()=>{if(log$4.trace("%s stream %s closeWrite",et,at),!ct){it.abort();try{j({id:a,type:st.CLOSE})}catch(vt){log$4.trace("%s stream %s error sending close",et,$,vt)}yt()}},abort:vt=>{log$4.trace("%s stream %s abort",et,at,vt),mt.end(vt),rt.abort(),yt(vt)},reset:()=>{const vt=errCode(new Error("stream reset"),ERR_STREAM_RESET);nt.abort(),mt.end(vt),yt(vt)},sink:async vt=>{if(ut)throw errCode(new Error("sink already called on stream"),ERR_DOUBLE_SINK);if(ut=!0,ct)throw errCode(new Error("stream closed for writing"),ERR_SINK_ENDED);vt=abortableSource(vt,anySignal_2([rt.signal,nt.signal,it.signal]));try{et==="initiator"&&j({id:a,type:InitiatorMessageTypes.NEW_STREAM,data:new Uint8ArrayList(fromString$5(at))});const ht=new Uint8ArrayList;for await(const St of vt)if(St.length<=tt)j({id:a,type:st.MESSAGE,data:St instanceof Uint8ArrayList?St:new Uint8ArrayList(St)});else for(ht.append(St);ht.length!==0;){if(ht.length<=tt){j({id:a,type:st.MESSAGE,data:ht.sublist()}),ht.consume(ht.length);break}j({id:a,type:st.MESSAGE,data:ht.sublist(0,tt)}),ht.consume(tt)}}catch(ht){if(ht.type==="aborted"&&ht.message==="The operation was aborted"){if(it.signal.aborted)return;nt.signal.aborted&&(ht.message="stream reset",ht.code=ERR_STREAM_RESET),rt.signal.aborted&&(ht.message="stream aborted",ht.code=ERR_STREAM_ABORT)}if(ht.code===ERR_STREAM_RESET)log$4.trace("%s stream %s reset",et,$);else{log$4.trace("%s stream %s error",et,$,ht);try{j({id:a,type:st.RESET})}catch(St){log$4.trace("%s stream %s error sending reset",et,$,St)}}mt.end(ht),yt(ht);return}try{j({id:a,type:st.CLOSE})}catch(ht){log$4.trace("%s stream %s error sending close",et,$,ht)}yt()},source:mt,sourcePush:vt=>{mt.push(vt)},sourceReadableLength(){return mt.readableLength},stat:{direction:et==="initiator"?"outbound":"inbound",timeline:ft},metadata:{},id:ot};return _t}const log$3=logger$1("libp2p:mplex"),MAX_STREAMS_INBOUND_STREAMS_PER_CONNECTION=1024,MAX_STREAMS_OUTBOUND_STREAMS_PER_CONNECTION=1024,MAX_STREAM_BUFFER_SIZE=1024*1024*4,DISCONNECT_THRESHOLD=5;function printMessage(_){const a={..._,type:`${MessageTypeNames[_.type]} (${_.type})`};return _.type===MessageTypes.NEW_STREAM&&(a.data=toString$6(_.data instanceof Uint8Array?_.data:_.data.subarray())),(_.type===MessageTypes.MESSAGE_INITIATOR||_.type===MessageTypes.MESSAGE_RECEIVER)&&(a.data=toString$6(_.data instanceof Uint8Array?_.data:_.data.subarray(),"base16")),a}class MplexStreamMuxer{constructor(a){this.protocol="/mplex/6.7.0",a=a??{},this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=a,this.sink=this._createSink();const $=this._createSource();this._source=$,this.source=$,this.closeController=new AbortController,this.rateLimiter=new rateLimiterFlexible.RateLimiterMemory({points:a.disconnectThreshold??DISCONNECT_THRESHOLD,duration:1})}get streams(){const a=[];for(const $ of this._streams.initiators.values())a.push($);for(const $ of this._streams.receivers.values())a.push($);return a}newStream(a){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");const $=this._streamId++;a=a==null?$.toString():a.toString();const j=this._streams.initiators;return this._newStream({id:$,name:a,type:"initiator",registry:j})}close(a){this.closeController.signal.aborted||(a!=null?this.streams.forEach($=>$.abort(a)):this.streams.forEach($=>$.close()),this.closeController.abort())}_newReceiverStream(a){const{id:$,name:j}=a,_e=this._streams.receivers;return this._newStream({id:$,name:j,type:"receiver",registry:_e})}_newStream(a){const{id:$,name:j,type:_e,registry:et}=a;if(log$3("new %s stream %s %s",_e,$),_e==="initiator"&&this._streams.initiators.size===(this._init.maxOutboundStreams??MAX_STREAMS_OUTBOUND_STREAMS_PER_CONNECTION))throw errCode(new Error("Too many outbound streams open"),"ERR_TOO_MANY_OUTBOUND_STREAMS");if(et.has($))throw new Error(`${_e} stream ${$} already exists!`);const nt=createStream({id:$,name:j,send:it=>{log$3.enabled&&log$3.trace("%s stream %s send",_e,$,printMessage(it)),this._source.push(it)},type:_e,onEnd:()=>{log$3("%s stream with id %s and protocol %s ended",_e,$,nt.stat.protocol),et.delete($),this._init.onStreamEnd!=null&&this._init.onStreamEnd(nt)},maxMsgSize:this._init.maxMsgSize});return et.set($,nt),nt}_createSink(){return async $=>{const j=[this.closeController.signal];this._init.signal!=null&&j.push(this._init.signal),$=abortableSource($,anySignal$2.exports(j));try{await pipe($,decode$1,restrictSize(this._init.maxMsgSize),async _e=>{for await(const et of _e)await this._handleIncoming(et)}),this._source.end()}catch(_e){log$3("error in sink",_e),this._source.end(_e)}}}_createSource(){const $=pushableV({objectMode:!0,onEnd:j=>{this.close(j)}});return Object.assign(encode$1($),{push:$.push,end:$.end,return:$.return})}async _handleIncoming(a){const{id:$,type:j}=a;if(log$3.enabled&&log$3.trace("incoming message",printMessage(a)),a.type===MessageTypes.NEW_STREAM){if(this._streams.receivers.size===(this._init.maxInboundStreams??MAX_STREAMS_INBOUND_STREAMS_PER_CONNECTION)){log$3("too many inbound streams open"),this._source.push({id:$,type:MessageTypes.RESET_RECEIVER});try{await this.rateLimiter.consume("new-stream",1)}catch{log$3("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),this._source.end(new Error("Too many open streams"));return}return}const rt=this._newReceiverStream({id:$,name:toString$6(a.data instanceof Uint8Array?a.data:a.data.subarray())});this._init.onIncomingStream!=null&&this._init.onIncomingStream(rt);return}const et=((j&1)===1?this._streams.initiators:this._streams.receivers).get($);if(et==null){log$3("missing stream %s for message type %s",$,MessageTypeNames[j]);return}const tt=this._init.maxStreamBufferSize??MAX_STREAM_BUFFER_SIZE;switch(j){case MessageTypes.MESSAGE_INITIATOR:case MessageTypes.MESSAGE_RECEIVER:if(et.sourceReadableLength()>tt){this._source.push({id:a.id,type:j===MessageTypes.MESSAGE_INITIATOR?MessageTypes.RESET_RECEIVER:MessageTypes.RESET_INITIATOR});const rt=errCode(new Error("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers"),"ERR_STREAM_INPUT_BUFFER_FULL");et.abort(rt);return}et.sourcePush(a.data);break;case MessageTypes.CLOSE_INITIATOR:case MessageTypes.CLOSE_RECEIVER:et.closeRead();break;case MessageTypes.RESET_INITIATOR:case MessageTypes.RESET_RECEIVER:et.reset();break;default:log$3("unknown message type %s",j)}}}class Mplex{constructor(a={}){this.protocol="/mplex/6.7.0",this._init=a}createStreamMuxer(a={}){return new MplexStreamMuxer({...a,...this._init})}}function mplex(_={}){return()=>new Mplex(_)}function pbStream(_,a={}){const $=handshake(_),j=decode$4.fromReader($.reader,a),_e={read:async et=>{const{value:tt}=await $.reader.next(et);if(tt==null)throw new Error("Value is null");return tt},readLP:async()=>{const{value:et}=await j.next();if(et==null)throw new Error("Value is null");return et},readPB:async et=>{const tt=await _e.readLP();if(tt==null)throw new Error("Value is null");const rt=tt instanceof Uint8Array?tt:tt.slice();return et.decode(rt)},write:et=>{et instanceof Uint8Array?$.writer.push(et):$.writer.push(et.slice())},writeLP:et=>{_e.write(encode$5.single(et,a))},writePB:(et,tt)=>{_e.writeLP(tt.encode(et))},pb:et=>({read:async()=>await _e.readPB(et),write:tt=>_e.writePB(tt,et)}),unwrap:()=>($.rest(),$.stream)};return _e}function pair(){const _=pDefer$2();let a=!1;return{sink:async $=>{if(a)throw new Error("already piped");a=!0,_.resolve($)},source:async function*(){yield*await _.promise}()}}function duplexPair(){const _=pair(),a=pair();return[{source:_.source,sink:a.sink},{source:a.source,sink:_.sink}]}const NOISE_MSG_MAX_LENGTH_BYTES=65535,NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=NOISE_MSG_MAX_LENGTH_BYTES-16,DUMP_SESSION_KEYS=Boolean(globalThis.process?.env?.DUMP_SESSION_KEYS);var hkdf={},hmac$1={},hash={};Object.defineProperty(hash,"__esModule",{value:!0});function isSerializableHash(_){return typeof _.saveState<"u"&&typeof _.restoreState<"u"&&typeof _.cleanSavedState<"u"}hash.isSerializableHash=isSerializableHash;var constantTime={};Object.defineProperty(constantTime,"__esModule",{value:!0});function select(_,a,$){return~(_-1)&a|_-1&$}constantTime.select=select;function lessOrEqual(_,a){return(_|0)-(a|0)-1>>>31&1}constantTime.lessOrEqual=lessOrEqual;function compare(_,a){if(_.length!==a.length)return 0;for(var $=0,j=0;j<_.length;j++)$|=_[j]^a[j];return 1&$-1>>>8}constantTime.compare=compare;function equal(_,a){return _.length===0||a.length===0?!1:compare(_,a)!==0}constantTime.equal=equal;var wipe$1={};Object.defineProperty(wipe$1,"__esModule",{value:!0});function wipe(_){for(var a=0;a<_.length;a++)_[a]=0;return _}wipe$1.wipe=wipe;Object.defineProperty(hmac$1,"__esModule",{value:!0});var hash_1=hash,constant_time_1=constantTime,wipe_1$3=wipe$1,HMAC=function(){function _(a,$){this._finished=!1,this._inner=new a,this._outer=new a,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var j=new Uint8Array(this.blockSize);$.length>this.blockSize?this._inner.update($).finish(j).clean():j.set($);for(var _e=0;_e<j.length;_e++)j[_e]^=54;this._inner.update(j);for(var _e=0;_e<j.length;_e++)j[_e]^=106;this._outer.update(j),hash_1.isSerializableHash(this._inner)&&hash_1.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),wipe_1$3.wipe(j)}return _.prototype.reset=function(){if(!hash_1.isSerializableHash(this._inner)||!hash_1.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},_.prototype.clean=function(){hash_1.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),hash_1.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},_.prototype.update=function(a){return this._inner.update(a),this},_.prototype.finish=function(a){return this._finished?(this._outer.finish(a),this):(this._inner.finish(a),this._outer.update(a.subarray(0,this.digestLength)).finish(a),this._finished=!0,this)},_.prototype.digest=function(){var a=new Uint8Array(this.digestLength);return this.finish(a),a},_.prototype.saveState=function(){if(!hash_1.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},_.prototype.restoreState=function(a){if(!hash_1.isSerializableHash(this._inner)||!hash_1.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(a),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},_.prototype.cleanSavedState=function(a){if(!hash_1.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(a)},_}();hmac$1.HMAC=HMAC;function hmac(_,a,$){var j=new HMAC(_,a);j.update($);var _e=j.digest();return j.clean(),_e}hmac$1.hmac=hmac;hmac$1.equal=constant_time_1.equal;Object.defineProperty(hkdf,"__esModule",{value:!0});var hmac_1=hmac$1,wipe_1$2=wipe$1,HKDF=function(){function _(a,$,j,_e){j===void 0&&(j=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=a,this._info=_e;var et=hmac_1.hmac(this._hash,j,$);this._hmac=new hmac_1.HMAC(a,et),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return _.prototype._fillBuffer=function(){this._counter[0]++;var a=this._counter[0];if(a===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),a>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},_.prototype.expand=function(a){for(var $=new Uint8Array(a),j=0;j<$.length;j++)this._bufpos===this._buffer.length&&this._fillBuffer(),$[j]=this._buffer[this._bufpos++];return $},_.prototype.clean=function(){this._hmac.clean(),wipe_1$2.wipe(this._buffer),wipe_1$2.wipe(this._counter),this._bufpos=0},_}(),HKDF_1=hkdf.HKDF=HKDF,x25519={},random={},system={},browser={};Object.defineProperty(browser,"__esModule",{value:!0});browser.BrowserRandomSource=void 0;const QUOTA=65536;class BrowserRandomSource{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const a=typeof self<"u"?self.crypto||self.msCrypto:null;a&&a.getRandomValues!==void 0&&(this._crypto=a,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(a){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const $=new Uint8Array(a);for(let j=0;j<$.length;j+=QUOTA)this._crypto.getRandomValues($.subarray(j,j+Math.min($.length-j,QUOTA)));return $}}browser.BrowserRandomSource=BrowserRandomSource;var node={};Object.defineProperty(node,"__esModule",{value:!0});node.NodeRandomSource=void 0;const wipe_1$1=wipe$1;class NodeRandomSource{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof commonjsRequire<"u"){const a=require$$1;a&&a.randomBytes&&(this._crypto=a,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(a){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let $=this._crypto.randomBytes(a);if($.length!==a)throw new Error("NodeRandomSource: got fewer bytes than requested");const j=new Uint8Array(a);for(let _e=0;_e<j.length;_e++)j[_e]=$[_e];return(0,wipe_1$1.wipe)($),j}}node.NodeRandomSource=NodeRandomSource;Object.defineProperty(system,"__esModule",{value:!0});system.SystemRandomSource=void 0;const browser_1=browser,node_1=node;class SystemRandomSource{constructor(){if(this.isAvailable=!1,this.name="",this._source=new browser_1.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new node_1.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(a){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(a)}}system.SystemRandomSource=SystemRandomSource;var binary={},int={};(function(_){Object.defineProperty(_,"__esModule",{value:!0});function a(rt,nt){var it=rt>>>16&65535,st=rt&65535,ot=nt>>>16&65535,at=nt&65535;return st*at+(it*at+st*ot<<16>>>0)|0}_.mul=Math.imul||a;function $(rt,nt){return rt+nt|0}_.add=$;function j(rt,nt){return rt-nt|0}_.sub=j;function _e(rt,nt){return rt<<nt|rt>>>32-nt}_.rotl=_e;function et(rt,nt){return rt<<32-nt|rt>>>nt}_.rotr=et;function tt(rt){return typeof rt=="number"&&isFinite(rt)&&Math.floor(rt)===rt}_.isInteger=Number.isInteger||tt,_.MAX_SAFE_INTEGER=9007199254740991,_.isSafeInteger=function(rt){return _.isInteger(rt)&&rt>=-_.MAX_SAFE_INTEGER&&rt<=_.MAX_SAFE_INTEGER}})(int);Object.defineProperty(binary,"__esModule",{value:!0});var int_1=int;function readInt16BE(_,a){return a===void 0&&(a=0),(_[a+0]<<8|_[a+1])<<16>>16}binary.readInt16BE=readInt16BE;function readUint16BE(_,a){return a===void 0&&(a=0),(_[a+0]<<8|_[a+1])>>>0}binary.readUint16BE=readUint16BE;function readInt16LE(_,a){return a===void 0&&(a=0),(_[a+1]<<8|_[a])<<16>>16}binary.readInt16LE=readInt16LE;function readUint16LE(_,a){return a===void 0&&(a=0),(_[a+1]<<8|_[a])>>>0}binary.readUint16LE=readUint16LE;function writeUint16BE(_,a,$){return a===void 0&&(a=new Uint8Array(2)),$===void 0&&($=0),a[$+0]=_>>>8,a[$+1]=_>>>0,a}binary.writeUint16BE=writeUint16BE;binary.writeInt16BE=writeUint16BE;function writeUint16LE(_,a,$){return a===void 0&&(a=new Uint8Array(2)),$===void 0&&($=0),a[$+0]=_>>>0,a[$+1]=_>>>8,a}binary.writeUint16LE=writeUint16LE;binary.writeInt16LE=writeUint16LE;function readInt32BE(_,a){return a===void 0&&(a=0),_[a]<<24|_[a+1]<<16|_[a+2]<<8|_[a+3]}binary.readInt32BE=readInt32BE;function readUint32BE(_,a){return a===void 0&&(a=0),(_[a]<<24|_[a+1]<<16|_[a+2]<<8|_[a+3])>>>0}binary.readUint32BE=readUint32BE;function readInt32LE(_,a){return a===void 0&&(a=0),_[a+3]<<24|_[a+2]<<16|_[a+1]<<8|_[a]}binary.readInt32LE=readInt32LE;function readUint32LE(_,a){return a===void 0&&(a=0),(_[a+3]<<24|_[a+2]<<16|_[a+1]<<8|_[a])>>>0}binary.readUint32LE=readUint32LE;function writeUint32BE(_,a,$){return a===void 0&&(a=new Uint8Array(4)),$===void 0&&($=0),a[$+0]=_>>>24,a[$+1]=_>>>16,a[$+2]=_>>>8,a[$+3]=_>>>0,a}binary.writeUint32BE=writeUint32BE;binary.writeInt32BE=writeUint32BE;function writeUint32LE(_,a,$){return a===void 0&&(a=new Uint8Array(4)),$===void 0&&($=0),a[$+0]=_>>>0,a[$+1]=_>>>8,a[$+2]=_>>>16,a[$+3]=_>>>24,a}binary.writeUint32LE=writeUint32LE;binary.writeInt32LE=writeUint32LE;function readInt64BE(_,a){a===void 0&&(a=0);var $=readInt32BE(_,a),j=readInt32BE(_,a+4);return $*4294967296+j-(j>>31)*4294967296}binary.readInt64BE=readInt64BE;function readUint64BE(_,a){a===void 0&&(a=0);var $=readUint32BE(_,a),j=readUint32BE(_,a+4);return $*4294967296+j}binary.readUint64BE=readUint64BE;function readInt64LE(_,a){a===void 0&&(a=0);var $=readInt32LE(_,a),j=readInt32LE(_,a+4);return j*4294967296+$-($>>31)*4294967296}binary.readInt64LE=readInt64LE;function readUint64LE(_,a){a===void 0&&(a=0);var $=readUint32LE(_,a),j=readUint32LE(_,a+4);return j*4294967296+$}binary.readUint64LE=readUint64LE;function writeUint64BE(_,a,$){return a===void 0&&(a=new Uint8Array(8)),$===void 0&&($=0),writeUint32BE(_/4294967296>>>0,a,$),writeUint32BE(_>>>0,a,$+4),a}binary.writeUint64BE=writeUint64BE;binary.writeInt64BE=writeUint64BE;function writeUint64LE(_,a,$){return a===void 0&&(a=new Uint8Array(8)),$===void 0&&($=0),writeUint32LE(_>>>0,a,$),writeUint32LE(_/4294967296>>>0,a,$+4),a}binary.writeUint64LE=writeUint64LE;binary.writeInt64LE=writeUint64LE;function readUintBE(_,a,$){if($===void 0&&($=0),_%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(_/8>a.length-$)throw new Error("readUintBE: array is too short for the given bitLength");for(var j=0,_e=1,et=_/8+$-1;et>=$;et--)j+=a[et]*_e,_e*=256;return j}binary.readUintBE=readUintBE;function readUintLE(_,a,$){if($===void 0&&($=0),_%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(_/8>a.length-$)throw new Error("readUintLE: array is too short for the given bitLength");for(var j=0,_e=1,et=$;et<$+_/8;et++)j+=a[et]*_e,_e*=256;return j}binary.readUintLE=readUintLE;function writeUintBE(_,a,$,j){if($===void 0&&($=new Uint8Array(_/8)),j===void 0&&(j=0),_%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!int_1.isSafeInteger(a))throw new Error("writeUintBE value must be an integer");for(var _e=1,et=_/8+j-1;et>=j;et--)$[et]=a/_e&255,_e*=256;return $}binary.writeUintBE=writeUintBE;function writeUintLE(_,a,$,j){if($===void 0&&($=new Uint8Array(_/8)),j===void 0&&(j=0),_%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!int_1.isSafeInteger(a))throw new Error("writeUintLE value must be an integer");for(var _e=1,et=j;et<j+_/8;et++)$[et]=a/_e&255,_e*=256;return $}binary.writeUintLE=writeUintLE;function readFloat32BE(_,a){a===void 0&&(a=0);var $=new DataView(_.buffer,_.byteOffset,_.byteLength);return $.getFloat32(a)}binary.readFloat32BE=readFloat32BE;function readFloat32LE(_,a){a===void 0&&(a=0);var $=new DataView(_.buffer,_.byteOffset,_.byteLength);return $.getFloat32(a,!0)}binary.readFloat32LE=readFloat32LE;function readFloat64BE(_,a){a===void 0&&(a=0);var $=new DataView(_.buffer,_.byteOffset,_.byteLength);return $.getFloat64(a)}binary.readFloat64BE=readFloat64BE;function readFloat64LE(_,a){a===void 0&&(a=0);var $=new DataView(_.buffer,_.byteOffset,_.byteLength);return $.getFloat64(a,!0)}binary.readFloat64LE=readFloat64LE;function writeFloat32BE(_,a,$){a===void 0&&(a=new Uint8Array(4)),$===void 0&&($=0);var j=new DataView(a.buffer,a.byteOffset,a.byteLength);return j.setFloat32($,_),a}binary.writeFloat32BE=writeFloat32BE;function writeFloat32LE(_,a,$){a===void 0&&(a=new Uint8Array(4)),$===void 0&&($=0);var j=new DataView(a.buffer,a.byteOffset,a.byteLength);return j.setFloat32($,_,!0),a}binary.writeFloat32LE=writeFloat32LE;function writeFloat64BE(_,a,$){a===void 0&&(a=new Uint8Array(8)),$===void 0&&($=0);var j=new DataView(a.buffer,a.byteOffset,a.byteLength);return j.setFloat64($,_),a}binary.writeFloat64BE=writeFloat64BE;function writeFloat64LE(_,a,$){a===void 0&&(a=new Uint8Array(8)),$===void 0&&($=0);var j=new DataView(a.buffer,a.byteOffset,a.byteLength);return j.setFloat64($,_,!0),a}binary.writeFloat64LE=writeFloat64LE;(function(_){Object.defineProperty(_,"__esModule",{value:!0}),_.randomStringForEntropy=_.randomString=_.randomUint32=_.randomBytes=_.defaultRandomSource=void 0;const a=system,$=binary,j=wipe$1;_.defaultRandomSource=new a.SystemRandomSource;function _e(it,st=_.defaultRandomSource){return st.randomBytes(it)}_.randomBytes=_e;function et(it=_.defaultRandomSource){const st=_e(4,it),ot=(0,$.readUint32LE)(st);return(0,j.wipe)(st),ot}_.randomUint32=et;const tt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function rt(it,st=tt,ot=_.defaultRandomSource){if(st.length<2)throw new Error("randomString charset is too short");if(st.length>256)throw new Error("randomString charset is too long");let at="";const lt=st.length,ct=256-256%lt;for(;it>0;){const ut=_e(Math.ceil(it*256/ct),ot);for(let dt=0;dt<ut.length&&it>0;dt++){const ft=ut[dt];ft<ct&&(at+=st.charAt(ft%lt),it--)}(0,j.wipe)(ut)}return at}_.randomString=rt;function nt(it,st=tt,ot=_.defaultRandomSource){const at=Math.ceil(it/(Math.log(st.length)/Math.LN2));return rt(at,st,ot)}_.randomStringForEntropy=nt})(random);(function(_){Object.defineProperty(_,"__esModule",{value:!0}),_.sharedKey=_.generateKeyPair=_.generateKeyPairFromSeed=_.scalarMultBase=_.scalarMult=_.SHARED_KEY_LENGTH=_.SECRET_KEY_LENGTH=_.PUBLIC_KEY_LENGTH=void 0;const a=random,$=wipe$1;_.PUBLIC_KEY_LENGTH=32,_.SECRET_KEY_LENGTH=32,_.SHARED_KEY_LENGTH=32;function j(mt){const _t=new Float64Array(16);if(mt)for(let vt=0;vt<mt.length;vt++)_t[vt]=mt[vt];return _t}const _e=new Uint8Array(32);_e[0]=9;const et=j([56129,1]);function tt(mt){let _t=1;for(let vt=0;vt<16;vt++){let ht=mt[vt]+_t+65535;_t=Math.floor(ht/65536),mt[vt]=ht-_t*65536}mt[0]+=_t-1+37*(_t-1)}function rt(mt,_t,vt){const ht=~(vt-1);for(let St=0;St<16;St++){const It=ht&(mt[St]^_t[St]);mt[St]^=It,_t[St]^=It}}function nt(mt,_t){const vt=j(),ht=j();for(let St=0;St<16;St++)ht[St]=_t[St];tt(ht),tt(ht),tt(ht);for(let St=0;St<2;St++){vt[0]=ht[0]-65517;for(let Lt=1;Lt<15;Lt++)vt[Lt]=ht[Lt]-65535-(vt[Lt-1]>>16&1),vt[Lt-1]&=65535;vt[15]=ht[15]-32767-(vt[14]>>16&1);const It=vt[15]>>16&1;vt[14]&=65535,rt(ht,vt,1-It)}for(let St=0;St<16;St++)mt[2*St]=ht[St]&255,mt[2*St+1]=ht[St]>>8}function it(mt,_t){for(let vt=0;vt<16;vt++)mt[vt]=_t[2*vt]+(_t[2*vt+1]<<8);mt[15]&=32767}function st(mt,_t,vt){for(let ht=0;ht<16;ht++)mt[ht]=_t[ht]+vt[ht]}function ot(mt,_t,vt){for(let ht=0;ht<16;ht++)mt[ht]=_t[ht]-vt[ht]}function at(mt,_t,vt){let ht,St,It=0,Lt=0,Mt=0,Kt=0,kt=0,gt=0,Et=0,xt=0,Tt=0,At=0,Nt=0,Bt=0,Ot=0,bt=0,Rt=0,Gt=0,Pt=0,Ft=0,jt=0,Vt=0,Wt=0,Qt=0,qt=0,Yt=0,Xt=0,Zt=0,tr=0,Dr=0,fr=0,hr=0,Or=0,lr=vt[0],ir=vt[1],dr=vt[2],ar=vt[3],cr=vt[4],pr=vt[5],ur=vt[6],Ct=vt[7],wt=vt[8],$t=vt[9],Dt=vt[10],Ut=vt[11],zt=vt[12],Ht=vt[13],er=vt[14],Jt=vt[15];ht=_t[0],It+=ht*lr,Lt+=ht*ir,Mt+=ht*dr,Kt+=ht*ar,kt+=ht*cr,gt+=ht*pr,Et+=ht*ur,xt+=ht*Ct,Tt+=ht*wt,At+=ht*$t,Nt+=ht*Dt,Bt+=ht*Ut,Ot+=ht*zt,bt+=ht*Ht,Rt+=ht*er,Gt+=ht*Jt,ht=_t[1],Lt+=ht*lr,Mt+=ht*ir,Kt+=ht*dr,kt+=ht*ar,gt+=ht*cr,Et+=ht*pr,xt+=ht*ur,Tt+=ht*Ct,At+=ht*wt,Nt+=ht*$t,Bt+=ht*Dt,Ot+=ht*Ut,bt+=ht*zt,Rt+=ht*Ht,Gt+=ht*er,Pt+=ht*Jt,ht=_t[2],Mt+=ht*lr,Kt+=ht*ir,kt+=ht*dr,gt+=ht*ar,Et+=ht*cr,xt+=ht*pr,Tt+=ht*ur,At+=ht*Ct,Nt+=ht*wt,Bt+=ht*$t,Ot+=ht*Dt,bt+=ht*Ut,Rt+=ht*zt,Gt+=ht*Ht,Pt+=ht*er,Ft+=ht*Jt,ht=_t[3],Kt+=ht*lr,kt+=ht*ir,gt+=ht*dr,Et+=ht*ar,xt+=ht*cr,Tt+=ht*pr,At+=ht*ur,Nt+=ht*Ct,Bt+=ht*wt,Ot+=ht*$t,bt+=ht*Dt,Rt+=ht*Ut,Gt+=ht*zt,Pt+=ht*Ht,Ft+=ht*er,jt+=ht*Jt,ht=_t[4],kt+=ht*lr,gt+=ht*ir,Et+=ht*dr,xt+=ht*ar,Tt+=ht*cr,At+=ht*pr,Nt+=ht*ur,Bt+=ht*Ct,Ot+=ht*wt,bt+=ht*$t,Rt+=ht*Dt,Gt+=ht*Ut,Pt+=ht*zt,Ft+=ht*Ht,jt+=ht*er,Vt+=ht*Jt,ht=_t[5],gt+=ht*lr,Et+=ht*ir,xt+=ht*dr,Tt+=ht*ar,At+=ht*cr,Nt+=ht*pr,Bt+=ht*ur,Ot+=ht*Ct,bt+=ht*wt,Rt+=ht*$t,Gt+=ht*Dt,Pt+=ht*Ut,Ft+=ht*zt,jt+=ht*Ht,Vt+=ht*er,Wt+=ht*Jt,ht=_t[6],Et+=ht*lr,xt+=ht*ir,Tt+=ht*dr,At+=ht*ar,Nt+=ht*cr,Bt+=ht*pr,Ot+=ht*ur,bt+=ht*Ct,Rt+=ht*wt,Gt+=ht*$t,Pt+=ht*Dt,Ft+=ht*Ut,jt+=ht*zt,Vt+=ht*Ht,Wt+=ht*er,Qt+=ht*Jt,ht=_t[7],xt+=ht*lr,Tt+=ht*ir,At+=ht*dr,Nt+=ht*ar,Bt+=ht*cr,Ot+=ht*pr,bt+=ht*ur,Rt+=ht*Ct,Gt+=ht*wt,Pt+=ht*$t,Ft+=ht*Dt,jt+=ht*Ut,Vt+=ht*zt,Wt+=ht*Ht,Qt+=ht*er,qt+=ht*Jt,ht=_t[8],Tt+=ht*lr,At+=ht*ir,Nt+=ht*dr,Bt+=ht*ar,Ot+=ht*cr,bt+=ht*pr,Rt+=ht*ur,Gt+=ht*Ct,Pt+=ht*wt,Ft+=ht*$t,jt+=ht*Dt,Vt+=ht*Ut,Wt+=ht*zt,Qt+=ht*Ht,qt+=ht*er,Yt+=ht*Jt,ht=_t[9],At+=ht*lr,Nt+=ht*ir,Bt+=ht*dr,Ot+=ht*ar,bt+=ht*cr,Rt+=ht*pr,Gt+=ht*ur,Pt+=ht*Ct,Ft+=ht*wt,jt+=ht*$t,Vt+=ht*Dt,Wt+=ht*Ut,Qt+=ht*zt,qt+=ht*Ht,Yt+=ht*er,Xt+=ht*Jt,ht=_t[10],Nt+=ht*lr,Bt+=ht*ir,Ot+=ht*dr,bt+=ht*ar,Rt+=ht*cr,Gt+=ht*pr,Pt+=ht*ur,Ft+=ht*Ct,jt+=ht*wt,Vt+=ht*$t,Wt+=ht*Dt,Qt+=ht*Ut,qt+=ht*zt,Yt+=ht*Ht,Xt+=ht*er,Zt+=ht*Jt,ht=_t[11],Bt+=ht*lr,Ot+=ht*ir,bt+=ht*dr,Rt+=ht*ar,Gt+=ht*cr,Pt+=ht*pr,Ft+=ht*ur,jt+=ht*Ct,Vt+=ht*wt,Wt+=ht*$t,Qt+=ht*Dt,qt+=ht*Ut,Yt+=ht*zt,Xt+=ht*Ht,Zt+=ht*er,tr+=ht*Jt,ht=_t[12],Ot+=ht*lr,bt+=ht*ir,Rt+=ht*dr,Gt+=ht*ar,Pt+=ht*cr,Ft+=ht*pr,jt+=ht*ur,Vt+=ht*Ct,Wt+=ht*wt,Qt+=ht*$t,qt+=ht*Dt,Yt+=ht*Ut,Xt+=ht*zt,Zt+=ht*Ht,tr+=ht*er,Dr+=ht*Jt,ht=_t[13],bt+=ht*lr,Rt+=ht*ir,Gt+=ht*dr,Pt+=ht*ar,Ft+=ht*cr,jt+=ht*pr,Vt+=ht*ur,Wt+=ht*Ct,Qt+=ht*wt,qt+=ht*$t,Yt+=ht*Dt,Xt+=ht*Ut,Zt+=ht*zt,tr+=ht*Ht,Dr+=ht*er,fr+=ht*Jt,ht=_t[14],Rt+=ht*lr,Gt+=ht*ir,Pt+=ht*dr,Ft+=ht*ar,jt+=ht*cr,Vt+=ht*pr,Wt+=ht*ur,Qt+=ht*Ct,qt+=ht*wt,Yt+=ht*$t,Xt+=ht*Dt,Zt+=ht*Ut,tr+=ht*zt,Dr+=ht*Ht,fr+=ht*er,hr+=ht*Jt,ht=_t[15],Gt+=ht*lr,Pt+=ht*ir,Ft+=ht*dr,jt+=ht*ar,Vt+=ht*cr,Wt+=ht*pr,Qt+=ht*ur,qt+=ht*Ct,Yt+=ht*wt,Xt+=ht*$t,Zt+=ht*Dt,tr+=ht*Ut,Dr+=ht*zt,fr+=ht*Ht,hr+=ht*er,Or+=ht*Jt,It+=38*Pt,Lt+=38*Ft,Mt+=38*jt,Kt+=38*Vt,kt+=38*Wt,gt+=38*Qt,Et+=38*qt,xt+=38*Yt,Tt+=38*Xt,At+=38*Zt,Nt+=38*tr,Bt+=38*Dr,Ot+=38*fr,bt+=38*hr,Rt+=38*Or,St=1,ht=It+St+65535,St=Math.floor(ht/65536),It=ht-St*65536,ht=Lt+St+65535,St=Math.floor(ht/65536),Lt=ht-St*65536,ht=Mt+St+65535,St=Math.floor(ht/65536),Mt=ht-St*65536,ht=Kt+St+65535,St=Math.floor(ht/65536),Kt=ht-St*65536,ht=kt+St+65535,St=Math.floor(ht/65536),kt=ht-St*65536,ht=gt+St+65535,St=Math.floor(ht/65536),gt=ht-St*65536,ht=Et+St+65535,St=Math.floor(ht/65536),Et=ht-St*65536,ht=xt+St+65535,St=Math.floor(ht/65536),xt=ht-St*65536,ht=Tt+St+65535,St=Math.floor(ht/65536),Tt=ht-St*65536,ht=At+St+65535,St=Math.floor(ht/65536),At=ht-St*65536,ht=Nt+St+65535,St=Math.floor(ht/65536),Nt=ht-St*65536,ht=Bt+St+65535,St=Math.floor(ht/65536),Bt=ht-St*65536,ht=Ot+St+65535,St=Math.floor(ht/65536),Ot=ht-St*65536,ht=bt+St+65535,St=Math.floor(ht/65536),bt=ht-St*65536,ht=Rt+St+65535,St=Math.floor(ht/65536),Rt=ht-St*65536,ht=Gt+St+65535,St=Math.floor(ht/65536),Gt=ht-St*65536,It+=St-1+37*(St-1),St=1,ht=It+St+65535,St=Math.floor(ht/65536),It=ht-St*65536,ht=Lt+St+65535,St=Math.floor(ht/65536),Lt=ht-St*65536,ht=Mt+St+65535,St=Math.floor(ht/65536),Mt=ht-St*65536,ht=Kt+St+65535,St=Math.floor(ht/65536),Kt=ht-St*65536,ht=kt+St+65535,St=Math.floor(ht/65536),kt=ht-St*65536,ht=gt+St+65535,St=Math.floor(ht/65536),gt=ht-St*65536,ht=Et+St+65535,St=Math.floor(ht/65536),Et=ht-St*65536,ht=xt+St+65535,St=Math.floor(ht/65536),xt=ht-St*65536,ht=Tt+St+65535,St=Math.floor(ht/65536),Tt=ht-St*65536,ht=At+St+65535,St=Math.floor(ht/65536),At=ht-St*65536,ht=Nt+St+65535,St=Math.floor(ht/65536),Nt=ht-St*65536,ht=Bt+St+65535,St=Math.floor(ht/65536),Bt=ht-St*65536,ht=Ot+St+65535,St=Math.floor(ht/65536),Ot=ht-St*65536,ht=bt+St+65535,St=Math.floor(ht/65536),bt=ht-St*65536,ht=Rt+St+65535,St=Math.floor(ht/65536),Rt=ht-St*65536,ht=Gt+St+65535,St=Math.floor(ht/65536),Gt=ht-St*65536,It+=St-1+37*(St-1),mt[0]=It,mt[1]=Lt,mt[2]=Mt,mt[3]=Kt,mt[4]=kt,mt[5]=gt,mt[6]=Et,mt[7]=xt,mt[8]=Tt,mt[9]=At,mt[10]=Nt,mt[11]=Bt,mt[12]=Ot,mt[13]=bt,mt[14]=Rt,mt[15]=Gt}function lt(mt,_t){at(mt,_t,_t)}function ct(mt,_t){const vt=j();for(let ht=0;ht<16;ht++)vt[ht]=_t[ht];for(let ht=253;ht>=0;ht--)lt(vt,vt),ht!==2&&ht!==4&&at(vt,vt,_t);for(let ht=0;ht<16;ht++)mt[ht]=vt[ht]}function ut(mt,_t){const vt=new Uint8Array(32),ht=new Float64Array(80),St=j(),It=j(),Lt=j(),Mt=j(),Kt=j(),kt=j();for(let Tt=0;Tt<31;Tt++)vt[Tt]=mt[Tt];vt[31]=mt[31]&127|64,vt[0]&=248,it(ht,_t);for(let Tt=0;Tt<16;Tt++)It[Tt]=ht[Tt];St[0]=Mt[0]=1;for(let Tt=254;Tt>=0;--Tt){const At=vt[Tt>>>3]>>>(Tt&7)&1;rt(St,It,At),rt(Lt,Mt,At),st(Kt,St,Lt),ot(St,St,Lt),st(Lt,It,Mt),ot(It,It,Mt),lt(Mt,Kt),lt(kt,St),at(St,Lt,St),at(Lt,It,Kt),st(Kt,St,Lt),ot(St,St,Lt),lt(It,St),ot(Lt,Mt,kt),at(St,Lt,et),st(St,St,Mt),at(Lt,Lt,St),at(St,Mt,kt),at(Mt,It,ht),lt(It,Kt),rt(St,It,At),rt(Lt,Mt,At)}for(let Tt=0;Tt<16;Tt++)ht[Tt+16]=St[Tt],ht[Tt+32]=Lt[Tt],ht[Tt+48]=It[Tt],ht[Tt+64]=Mt[Tt];const gt=ht.subarray(32),Et=ht.subarray(16);ct(gt,gt),at(Et,Et,gt);const xt=new Uint8Array(32);return nt(xt,Et),xt}_.scalarMult=ut;function dt(mt){return ut(mt,_e)}_.scalarMultBase=dt;function ft(mt){if(mt.length!==_.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${_.SECRET_KEY_LENGTH} bytes`);const _t=new Uint8Array(mt);return{publicKey:dt(_t),secretKey:_t}}_.generateKeyPairFromSeed=ft;function pt(mt){const _t=(0,a.randomBytes)(32,mt),vt=ft(_t);return(0,$.wipe)(_t),vt}_.generateKeyPair=pt;function yt(mt,_t,vt=!1){if(mt.length!==_.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(_t.length!==_.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const ht=ut(mt,_t);if(vt){let St=0;for(let It=0;It<ht.length;It++)St|=ht[It];if(St===0)throw new Error("X25519: invalid shared key")}return ht}_.sharedKey=yt})(x25519);var sha256={};(function(_){Object.defineProperty(_,"__esModule",{value:!0});var a=binary,$=wipe$1;_.DIGEST_LENGTH=32,_.BLOCK_SIZE=64;var j=function(){function rt(){this.digestLength=_.DIGEST_LENGTH,this.blockSize=_.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return rt.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},rt.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},rt.prototype.clean=function(){$.wipe(this._buffer),$.wipe(this._temp),this.reset()},rt.prototype.update=function(nt,it){if(it===void 0&&(it=nt.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var st=0;if(this._bytesHashed+=it,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&it>0;)this._buffer[this._bufferLength++]=nt[st++],it--;this._bufferLength===this.blockSize&&(et(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(it>=this.blockSize&&(st=et(this._temp,this._state,nt,st,it),it%=this.blockSize);it>0;)this._buffer[this._bufferLength++]=nt[st++],it--;return this},rt.prototype.finish=function(nt){if(!this._finished){var it=this._bytesHashed,st=this._bufferLength,ot=it/536870912|0,at=it<<3,lt=it%64<56?64:128;this._buffer[st]=128;for(var ct=st+1;ct<lt-8;ct++)this._buffer[ct]=0;a.writeUint32BE(ot,this._buffer,lt-8),a.writeUint32BE(at,this._buffer,lt-4),et(this._temp,this._state,this._buffer,0,lt),this._finished=!0}for(var ct=0;ct<this.digestLength/4;ct++)a.writeUint32BE(this._state[ct],nt,ct*4);return this},rt.prototype.digest=function(){var nt=new Uint8Array(this.digestLength);return this.finish(nt),nt},rt.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},rt.prototype.restoreState=function(nt){return this._state.set(nt.state),this._bufferLength=nt.bufferLength,nt.buffer&&this._buffer.set(nt.buffer),this._bytesHashed=nt.bytesHashed,this._finished=!1,this},rt.prototype.cleanSavedState=function(nt){$.wipe(nt.state),nt.buffer&&$.wipe(nt.buffer),nt.bufferLength=0,nt.bytesHashed=0},rt}();_.SHA256=j;var _e=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function et(rt,nt,it,st,ot){for(;ot>=64;){for(var at=nt[0],lt=nt[1],ct=nt[2],ut=nt[3],dt=nt[4],ft=nt[5],pt=nt[6],yt=nt[7],mt=0;mt<16;mt++){var _t=st+mt*4;rt[mt]=a.readUint32BE(it,_t)}for(var mt=16;mt<64;mt++){var vt=rt[mt-2],ht=(vt>>>17|vt<<32-17)^(vt>>>19|vt<<32-19)^vt>>>10;vt=rt[mt-15];var St=(vt>>>7|vt<<32-7)^(vt>>>18|vt<<32-18)^vt>>>3;rt[mt]=(ht+rt[mt-7]|0)+(St+rt[mt-16]|0)}for(var mt=0;mt<64;mt++){var ht=(((dt>>>6|dt<<26)^(dt>>>11|dt<<21)^(dt>>>25|dt<<7))+(dt&ft^~dt&pt)|0)+(yt+(_e[mt]+rt[mt]|0)|0)|0,St=((at>>>2|at<<32-2)^(at>>>13|at<<32-13)^(at>>>22|at<<32-22))+(at&lt^at&ct^lt&ct)|0;yt=pt,pt=ft,ft=dt,dt=ut+ht|0,ut=ct,ct=lt,lt=at,at=ht+St|0}nt[0]+=at,nt[1]+=lt,nt[2]+=ct,nt[3]+=ut,nt[4]+=dt,nt[5]+=ft,nt[6]+=pt,nt[7]+=yt,st+=64,ot-=64}return st}function tt(rt){var nt=new j;nt.update(rt);var it=nt.digest();return nt.clean(),it}_.hash=tt})(sha256);var chacha20poly1305={},chacha={};Object.defineProperty(chacha,"__esModule",{value:!0});var binary_1=binary,wipe_1=wipe$1,ROUNDS=20;function core(_,a,$){for(var j=1634760805,_e=857760878,et=2036477234,tt=1797285236,rt=$[3]<<24|$[2]<<16|$[1]<<8|$[0],nt=$[7]<<24|$[6]<<16|$[5]<<8|$[4],it=$[11]<<24|$[10]<<16|$[9]<<8|$[8],st=$[15]<<24|$[14]<<16|$[13]<<8|$[12],ot=$[19]<<24|$[18]<<16|$[17]<<8|$[16],at=$[23]<<24|$[22]<<16|$[21]<<8|$[20],lt=$[27]<<24|$[26]<<16|$[25]<<8|$[24],ct=$[31]<<24|$[30]<<16|$[29]<<8|$[28],ut=a[3]<<24|a[2]<<16|a[1]<<8|a[0],dt=a[7]<<24|a[6]<<16|a[5]<<8|a[4],ft=a[11]<<24|a[10]<<16|a[9]<<8|a[8],pt=a[15]<<24|a[14]<<16|a[13]<<8|a[12],yt=j,mt=_e,_t=et,vt=tt,ht=rt,St=nt,It=it,Lt=st,Mt=ot,Kt=at,kt=lt,gt=ct,Et=ut,xt=dt,Tt=ft,At=pt,Nt=0;Nt<ROUNDS;Nt+=2)yt=yt+ht|0,Et^=yt,Et=Et>>>32-16|Et<<16,Mt=Mt+Et|0,ht^=Mt,ht=ht>>>32-12|ht<<12,mt=mt+St|0,xt^=mt,xt=xt>>>32-16|xt<<16,Kt=Kt+xt|0,St^=Kt,St=St>>>32-12|St<<12,_t=_t+It|0,Tt^=_t,Tt=Tt>>>32-16|Tt<<16,kt=kt+Tt|0,It^=kt,It=It>>>32-12|It<<12,vt=vt+Lt|0,At^=vt,At=At>>>32-16|At<<16,gt=gt+At|0,Lt^=gt,Lt=Lt>>>32-12|Lt<<12,_t=_t+It|0,Tt^=_t,Tt=Tt>>>32-8|Tt<<8,kt=kt+Tt|0,It^=kt,It=It>>>32-7|It<<7,vt=vt+Lt|0,At^=vt,At=At>>>32-8|At<<8,gt=gt+At|0,Lt^=gt,Lt=Lt>>>32-7|Lt<<7,mt=mt+St|0,xt^=mt,xt=xt>>>32-8|xt<<8,Kt=Kt+xt|0,St^=Kt,St=St>>>32-7|St<<7,yt=yt+ht|0,Et^=yt,Et=Et>>>32-8|Et<<8,Mt=Mt+Et|0,ht^=Mt,ht=ht>>>32-7|ht<<7,yt=yt+St|0,At^=yt,At=At>>>32-16|At<<16,kt=kt+At|0,St^=kt,St=St>>>32-12|St<<12,mt=mt+It|0,Et^=mt,Et=Et>>>32-16|Et<<16,gt=gt+Et|0,It^=gt,It=It>>>32-12|It<<12,_t=_t+Lt|0,xt^=_t,xt=xt>>>32-16|xt<<16,Mt=Mt+xt|0,Lt^=Mt,Lt=Lt>>>32-12|Lt<<12,vt=vt+ht|0,Tt^=vt,Tt=Tt>>>32-16|Tt<<16,Kt=Kt+Tt|0,ht^=Kt,ht=ht>>>32-12|ht<<12,_t=_t+Lt|0,xt^=_t,xt=xt>>>32-8|xt<<8,Mt=Mt+xt|0,Lt^=Mt,Lt=Lt>>>32-7|Lt<<7,vt=vt+ht|0,Tt^=vt,Tt=Tt>>>32-8|Tt<<8,Kt=Kt+Tt|0,ht^=Kt,ht=ht>>>32-7|ht<<7,mt=mt+It|0,Et^=mt,Et=Et>>>32-8|Et<<8,gt=gt+Et|0,It^=gt,It=It>>>32-7|It<<7,yt=yt+St|0,At^=yt,At=At>>>32-8|At<<8,kt=kt+At|0,St^=kt,St=St>>>32-7|St<<7;binary_1.writeUint32LE(yt+j|0,_,0),binary_1.writeUint32LE(mt+_e|0,_,4),binary_1.writeUint32LE(_t+et|0,_,8),binary_1.writeUint32LE(vt+tt|0,_,12),binary_1.writeUint32LE(ht+rt|0,_,16),binary_1.writeUint32LE(St+nt|0,_,20),binary_1.writeUint32LE(It+it|0,_,24),binary_1.writeUint32LE(Lt+st|0,_,28),binary_1.writeUint32LE(Mt+ot|0,_,32),binary_1.writeUint32LE(Kt+at|0,_,36),binary_1.writeUint32LE(kt+lt|0,_,40),binary_1.writeUint32LE(gt+ct|0,_,44),binary_1.writeUint32LE(Et+ut|0,_,48),binary_1.writeUint32LE(xt+dt|0,_,52),binary_1.writeUint32LE(Tt+ft|0,_,56),binary_1.writeUint32LE(At+pt|0,_,60)}function streamXOR(_,a,$,j,_e){if(_e===void 0&&(_e=0),_.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(j.length<$.length)throw new Error("ChaCha: destination is shorter than source");var et,tt;if(_e===0){if(a.length!==8&&a.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");et=new Uint8Array(16),tt=et.length-a.length,et.set(a,tt)}else{if(a.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");et=a,tt=_e}for(var rt=new Uint8Array(64),nt=0;nt<$.length;nt+=64){core(rt,et,_);for(var it=nt;it<nt+64&&it<$.length;it++)j[it]=$[it]^rt[it-nt];incrementCounter(et,0,tt)}return wipe_1.wipe(rt),_e===0&&wipe_1.wipe(et),j}chacha.streamXOR=streamXOR;function stream(_,a,$,j){return j===void 0&&(j=0),wipe_1.wipe($),streamXOR(_,a,$,$,j)}chacha.stream=stream;function incrementCounter(_,a,$){for(var j=1;$--;)j=j+(_[a]&255)|0,_[a]=j&255,j>>>=8,a++;if(j>0)throw new Error("ChaCha: counter overflow")}var poly1305={};(function(_){Object.defineProperty(_,"__esModule",{value:!0});var a=constantTime,$=wipe$1;_.DIGEST_LENGTH=16;var j=function(){function tt(rt){this.digestLength=_.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var nt=rt[0]|rt[1]<<8;this._r[0]=nt&8191;var it=rt[2]|rt[3]<<8;this._r[1]=(nt>>>13|it<<3)&8191;var st=rt[4]|rt[5]<<8;this._r[2]=(it>>>10|st<<6)&7939;var ot=rt[6]|rt[7]<<8;this._r[3]=(st>>>7|ot<<9)&8191;var at=rt[8]|rt[9]<<8;this._r[4]=(ot>>>4|at<<12)&255,this._r[5]=at>>>1&8190;var lt=rt[10]|rt[11]<<8;this._r[6]=(at>>>14|lt<<2)&8191;var ct=rt[12]|rt[13]<<8;this._r[7]=(lt>>>11|ct<<5)&8065;var ut=rt[14]|rt[15]<<8;this._r[8]=(ct>>>8|ut<<8)&8191,this._r[9]=ut>>>5&127,this._pad[0]=rt[16]|rt[17]<<8,this._pad[1]=rt[18]|rt[19]<<8,this._pad[2]=rt[20]|rt[21]<<8,this._pad[3]=rt[22]|rt[23]<<8,this._pad[4]=rt[24]|rt[25]<<8,this._pad[5]=rt[26]|rt[27]<<8,this._pad[6]=rt[28]|rt[29]<<8,this._pad[7]=rt[30]|rt[31]<<8}return tt.prototype._blocks=function(rt,nt,it){for(var st=this._fin?0:2048,ot=this._h[0],at=this._h[1],lt=this._h[2],ct=this._h[3],ut=this._h[4],dt=this._h[5],ft=this._h[6],pt=this._h[7],yt=this._h[8],mt=this._h[9],_t=this._r[0],vt=this._r[1],ht=this._r[2],St=this._r[3],It=this._r[4],Lt=this._r[5],Mt=this._r[6],Kt=this._r[7],kt=this._r[8],gt=this._r[9];it>=16;){var Et=rt[nt+0]|rt[nt+1]<<8;ot+=Et&8191;var xt=rt[nt+2]|rt[nt+3]<<8;at+=(Et>>>13|xt<<3)&8191;var Tt=rt[nt+4]|rt[nt+5]<<8;lt+=(xt>>>10|Tt<<6)&8191;var At=rt[nt+6]|rt[nt+7]<<8;ct+=(Tt>>>7|At<<9)&8191;var Nt=rt[nt+8]|rt[nt+9]<<8;ut+=(At>>>4|Nt<<12)&8191,dt+=Nt>>>1&8191;var Bt=rt[nt+10]|rt[nt+11]<<8;ft+=(Nt>>>14|Bt<<2)&8191;var Ot=rt[nt+12]|rt[nt+13]<<8;pt+=(Bt>>>11|Ot<<5)&8191;var bt=rt[nt+14]|rt[nt+15]<<8;yt+=(Ot>>>8|bt<<8)&8191,mt+=bt>>>5|st;var Rt=0,Gt=Rt;Gt+=ot*_t,Gt+=at*(5*gt),Gt+=lt*(5*kt),Gt+=ct*(5*Kt),Gt+=ut*(5*Mt),Rt=Gt>>>13,Gt&=8191,Gt+=dt*(5*Lt),Gt+=ft*(5*It),Gt+=pt*(5*St),Gt+=yt*(5*ht),Gt+=mt*(5*vt),Rt+=Gt>>>13,Gt&=8191;var Pt=Rt;Pt+=ot*vt,Pt+=at*_t,Pt+=lt*(5*gt),Pt+=ct*(5*kt),Pt+=ut*(5*Kt),Rt=Pt>>>13,Pt&=8191,Pt+=dt*(5*Mt),Pt+=ft*(5*Lt),Pt+=pt*(5*It),Pt+=yt*(5*St),Pt+=mt*(5*ht),Rt+=Pt>>>13,Pt&=8191;var Ft=Rt;Ft+=ot*ht,Ft+=at*vt,Ft+=lt*_t,Ft+=ct*(5*gt),Ft+=ut*(5*kt),Rt=Ft>>>13,Ft&=8191,Ft+=dt*(5*Kt),Ft+=ft*(5*Mt),Ft+=pt*(5*Lt),Ft+=yt*(5*It),Ft+=mt*(5*St),Rt+=Ft>>>13,Ft&=8191;var jt=Rt;jt+=ot*St,jt+=at*ht,jt+=lt*vt,jt+=ct*_t,jt+=ut*(5*gt),Rt=jt>>>13,jt&=8191,jt+=dt*(5*kt),jt+=ft*(5*Kt),jt+=pt*(5*Mt),jt+=yt*(5*Lt),jt+=mt*(5*It),Rt+=jt>>>13,jt&=8191;var Vt=Rt;Vt+=ot*It,Vt+=at*St,Vt+=lt*ht,Vt+=ct*vt,Vt+=ut*_t,Rt=Vt>>>13,Vt&=8191,Vt+=dt*(5*gt),Vt+=ft*(5*kt),Vt+=pt*(5*Kt),Vt+=yt*(5*Mt),Vt+=mt*(5*Lt),Rt+=Vt>>>13,Vt&=8191;var Wt=Rt;Wt+=ot*Lt,Wt+=at*It,Wt+=lt*St,Wt+=ct*ht,Wt+=ut*vt,Rt=Wt>>>13,Wt&=8191,Wt+=dt*_t,Wt+=ft*(5*gt),Wt+=pt*(5*kt),Wt+=yt*(5*Kt),Wt+=mt*(5*Mt),Rt+=Wt>>>13,Wt&=8191;var Qt=Rt;Qt+=ot*Mt,Qt+=at*Lt,Qt+=lt*It,Qt+=ct*St,Qt+=ut*ht,Rt=Qt>>>13,Qt&=8191,Qt+=dt*vt,Qt+=ft*_t,Qt+=pt*(5*gt),Qt+=yt*(5*kt),Qt+=mt*(5*Kt),Rt+=Qt>>>13,Qt&=8191;var qt=Rt;qt+=ot*Kt,qt+=at*Mt,qt+=lt*Lt,qt+=ct*It,qt+=ut*St,Rt=qt>>>13,qt&=8191,qt+=dt*ht,qt+=ft*vt,qt+=pt*_t,qt+=yt*(5*gt),qt+=mt*(5*kt),Rt+=qt>>>13,qt&=8191;var Yt=Rt;Yt+=ot*kt,Yt+=at*Kt,Yt+=lt*Mt,Yt+=ct*Lt,Yt+=ut*It,Rt=Yt>>>13,Yt&=8191,Yt+=dt*St,Yt+=ft*ht,Yt+=pt*vt,Yt+=yt*_t,Yt+=mt*(5*gt),Rt+=Yt>>>13,Yt&=8191;var Xt=Rt;Xt+=ot*gt,Xt+=at*kt,Xt+=lt*Kt,Xt+=ct*Mt,Xt+=ut*Lt,Rt=Xt>>>13,Xt&=8191,Xt+=dt*It,Xt+=ft*St,Xt+=pt*ht,Xt+=yt*vt,Xt+=mt*_t,Rt+=Xt>>>13,Xt&=8191,Rt=(Rt<<2)+Rt|0,Rt=Rt+Gt|0,Gt=Rt&8191,Rt=Rt>>>13,Pt+=Rt,ot=Gt,at=Pt,lt=Ft,ct=jt,ut=Vt,dt=Wt,ft=Qt,pt=qt,yt=Yt,mt=Xt,nt+=16,it-=16}this._h[0]=ot,this._h[1]=at,this._h[2]=lt,this._h[3]=ct,this._h[4]=ut,this._h[5]=dt,this._h[6]=ft,this._h[7]=pt,this._h[8]=yt,this._h[9]=mt},tt.prototype.finish=function(rt,nt){nt===void 0&&(nt=0);var it=new Uint16Array(10),st,ot,at,lt;if(this._leftover){for(lt=this._leftover,this._buffer[lt++]=1;lt<16;lt++)this._buffer[lt]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(st=this._h[1]>>>13,this._h[1]&=8191,lt=2;lt<10;lt++)this._h[lt]+=st,st=this._h[lt]>>>13,this._h[lt]&=8191;for(this._h[0]+=st*5,st=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=st,st=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=st,it[0]=this._h[0]+5,st=it[0]>>>13,it[0]&=8191,lt=1;lt<10;lt++)it[lt]=this._h[lt]+st,st=it[lt]>>>13,it[lt]&=8191;for(it[9]-=1<<13,ot=(st^1)-1,lt=0;lt<10;lt++)it[lt]&=ot;for(ot=~ot,lt=0;lt<10;lt++)this._h[lt]=this._h[lt]&ot|it[lt];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,at=this._h[0]+this._pad[0],this._h[0]=at&65535,lt=1;lt<8;lt++)at=(this._h[lt]+this._pad[lt]|0)+(at>>>16)|0,this._h[lt]=at&65535;return rt[nt+0]=this._h[0]>>>0,rt[nt+1]=this._h[0]>>>8,rt[nt+2]=this._h[1]>>>0,rt[nt+3]=this._h[1]>>>8,rt[nt+4]=this._h[2]>>>0,rt[nt+5]=this._h[2]>>>8,rt[nt+6]=this._h[3]>>>0,rt[nt+7]=this._h[3]>>>8,rt[nt+8]=this._h[4]>>>0,rt[nt+9]=this._h[4]>>>8,rt[nt+10]=this._h[5]>>>0,rt[nt+11]=this._h[5]>>>8,rt[nt+12]=this._h[6]>>>0,rt[nt+13]=this._h[6]>>>8,rt[nt+14]=this._h[7]>>>0,rt[nt+15]=this._h[7]>>>8,this._finished=!0,this},tt.prototype.update=function(rt){var nt=0,it=rt.length,st;if(this._leftover){st=16-this._leftover,st>it&&(st=it);for(var ot=0;ot<st;ot++)this._buffer[this._leftover+ot]=rt[nt+ot];if(it-=st,nt+=st,this._leftover+=st,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(it>=16&&(st=it-it%16,this._blocks(rt,nt,st),nt+=st,it-=st),it){for(var ot=0;ot<it;ot++)this._buffer[this._leftover+ot]=rt[nt+ot];this._leftover+=it}return this},tt.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var rt=new Uint8Array(16);return this.finish(rt),rt},tt.prototype.clean=function(){return $.wipe(this._buffer),$.wipe(this._r),$.wipe(this._h),$.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},tt}();_.Poly1305=j;function _e(tt,rt){var nt=new j(tt);nt.update(rt);var it=nt.digest();return nt.clean(),it}_.oneTimeAuth=_e;function et(tt,rt){return tt.length!==_.DIGEST_LENGTH||rt.length!==_.DIGEST_LENGTH?!1:a.equal(tt,rt)}_.equal=et})(poly1305);(function(_){Object.defineProperty(_,"__esModule",{value:!0});var a=chacha,$=poly1305,j=wipe$1,_e=binary,et=constantTime;_.KEY_LENGTH=32,_.NONCE_LENGTH=12,_.TAG_LENGTH=16;var tt=new Uint8Array(16),rt=function(){function nt(it){if(this.nonceLength=_.NONCE_LENGTH,this.tagLength=_.TAG_LENGTH,it.length!==_.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(it)}return nt.prototype.seal=function(it,st,ot,at){if(it.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var lt=new Uint8Array(16);lt.set(it,lt.length-it.length);var ct=new Uint8Array(32);a.stream(this._key,lt,ct,4);var ut=st.length+this.tagLength,dt;if(at){if(at.length!==ut)throw new Error("ChaCha20Poly1305: incorrect destination length");dt=at}else dt=new Uint8Array(ut);return a.streamXOR(this._key,lt,st,dt,4),this._authenticate(dt.subarray(dt.length-this.tagLength,dt.length),ct,dt.subarray(0,dt.length-this.tagLength),ot),j.wipe(lt),dt},nt.prototype.open=function(it,st,ot,at){if(it.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(st.length<this.tagLength)return null;var lt=new Uint8Array(16);lt.set(it,lt.length-it.length);var ct=new Uint8Array(32);a.stream(this._key,lt,ct,4);var ut=new Uint8Array(this.tagLength);if(this._authenticate(ut,ct,st.subarray(0,st.length-this.tagLength),ot),!et.equal(ut,st.subarray(st.length-this.tagLength,st.length)))return null;var dt=st.length-this.tagLength,ft;if(at){if(at.length!==dt)throw new Error("ChaCha20Poly1305: incorrect destination length");ft=at}else ft=new Uint8Array(dt);return a.streamXOR(this._key,lt,st.subarray(0,st.length-this.tagLength),ft,4),j.wipe(lt),ft},nt.prototype.clean=function(){return j.wipe(this._key),this},nt.prototype._authenticate=function(it,st,ot,at){var lt=new $.Poly1305(st);at&&(lt.update(at),at.length%16>0&&lt.update(tt.subarray(at.length%16))),lt.update(ot),ot.length%16>0&&lt.update(tt.subarray(ot.length%16));var ct=new Uint8Array(8);at&&_e.writeUint64LE(at.length,ct),lt.update(ct),_e.writeUint64LE(ot.length,ct),lt.update(ct);for(var ut=lt.digest(),dt=0;dt<ut.length;dt++)it[dt]=ut[dt];lt.clean(),j.wipe(ut),j.wipe(ct)},nt}();_.ChaCha20Poly1305=rt})(chacha20poly1305);const stablelib={hashSHA256(_){return sha256.hash(_)},getHKDF(_,a){const _e=new HKDF_1(sha256.SHA256,a,_).expand(96),et=_e.subarray(0,32),tt=_e.subarray(32,64),rt=_e.subarray(64,96);return[et,tt,rt]},generateX25519KeyPair(){const _=x25519.generateKeyPair();return{publicKey:_.publicKey,privateKey:_.secretKey}},generateX25519KeyPairFromSeed(_){const a=x25519.generateKeyPairFromSeed(_);return{publicKey:a.publicKey,privateKey:a.secretKey}},generateX25519SharedKey(_,a){return x25519.sharedKey(_,a)},chaCha20Poly1305Encrypt(_,a,$,j){return new chacha20poly1305.ChaCha20Poly1305(j).seal(a,_,$)},chaCha20Poly1305Decrypt(_,a,$,j){return new chacha20poly1305.ChaCha20Poly1305(j).open(a,_,$)}};function encryptStream(_){return async function*(a){for await(const $ of a)for(let j=0;j<$.length;j+=NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG){let _e=j+NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG;_e>$.length&&(_e=$.length),yield _.encrypt($.subarray(j,_e),_.session)}}}function decryptStream(_){return async function*(a){for await(const $ of a)for(let j=0;j<$.length;j+=NOISE_MSG_MAX_LENGTH_BYTES){let _e=j+NOISE_MSG_MAX_LENGTH_BYTES;_e>$.length&&(_e=$.length);const{plaintext:et,valid:tt}=await _.decrypt($.subarray(j,_e),_.session);if(!tt)throw new Error("Failed to validate decrypted chunk");yield et}}}const allocUnsafe=_=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(_):new Uint8Array(_),uint16BEEncode=_=>{const a=allocUnsafe(2);return new DataView(a.buffer,a.byteOffset,a.byteLength).setUint16(0,_,!1),a};uint16BEEncode.bytes=2;const uint16BEDecode=_=>{if(_.length<2)throw RangeError("Could not decode int16BE");return _ instanceof Uint8Array?new DataView(_.buffer,_.byteOffset,_.byteLength).getUint16(0,!1):_.getUint16(0)};uint16BEDecode.bytes=2;function encode0(_){return concat$1([_.ne,_.ciphertext],_.ne.length+_.ciphertext.length)}function encode1(_){return concat$1([_.ne,_.ns,_.ciphertext],_.ne.length+_.ns.length+_.ciphertext.length)}function encode2(_){return concat$1([_.ns,_.ciphertext],_.ns.length+_.ciphertext.length)}function decode0(_){if(_.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:_.subarray(0,32),ciphertext:_.subarray(32,_.length),ns:new Uint8Array(0)}}function decode1(_){if(_.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:_.subarray(0,32),ns:_.subarray(32,80),ciphertext:_.subarray(80,_.length)}}function decode2(_){if(_.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:_.subarray(0,48),ciphertext:_.subarray(48,_.length)}}class UnexpectedPeerError extends Error{constructor(a="Unexpected Peer"){super(a),this.code=UnexpectedPeerError.code}static get code(){return"ERR_UNEXPECTED_PEER"}}class InvalidCryptoExchangeError extends Error{constructor(a="Invalid crypto exchange"){super(a),this.code=InvalidCryptoExchangeError.code}static get code(){return"ERR_INVALID_CRYPTO_EXCHANGE"}}var NoiseExtensions;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{if(_e.lengthDelimited!==!1&&j.fork(),$.webtransportCerthashes!=null)for(const et of $.webtransportCerthashes)j.uint32(10),j.bytes(et);_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={webtransportCerthashes:[]},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.webtransportCerthashes.push($.bytes());break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(NoiseExtensions||(NoiseExtensions={}));var NoiseHandshakePayload;(function(_){let a;_.codec=()=>(a==null&&(a=message(($,j,_e={})=>{_e.lengthDelimited!==!1&&j.fork(),(_e.writeDefaults===!0||$.identityKey!=null&&$.identityKey.byteLength>0)&&(j.uint32(10),j.bytes($.identityKey)),(_e.writeDefaults===!0||$.identitySig!=null&&$.identitySig.byteLength>0)&&(j.uint32(18),j.bytes($.identitySig)),$.extensions!=null&&(j.uint32(34),NoiseExtensions.codec().encode($.extensions,j,{writeDefaults:!1})),_e.lengthDelimited!==!1&&j.ldelim()},($,j)=>{const _e={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},et=j==null?$.len:$.pos+j;for(;$.pos<et;){const tt=$.uint32();switch(tt>>>3){case 1:_e.identityKey=$.bytes();break;case 2:_e.identitySig=$.bytes();break;case 4:_e.extensions=NoiseExtensions.codec().decode($,$.uint32());break;default:$.skipType(tt&7);break}}return _e})),a),_.encode=$=>encodeMessage($,_.codec()),_.decode=$=>decodeMessage($,_.codec())})(NoiseHandshakePayload||(NoiseHandshakePayload={}));async function getPayload(_,a,$){const j=await signPayload(_,getHandshakePayload(a));if(_.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return createHandshakePayload(_.publicKey,j,$)}function createHandshakePayload(_,a,$){return NoiseHandshakePayload.encode({identityKey:_,identitySig:a,extensions:$??{webtransportCerthashes:[]}}).subarray()}async function signPayload(_,a){if(_.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return await(await unmarshalPrivateKey(_.privateKey)).sign(a)}async function getPeerIdFromPayload(_){return await peerIdFromKeys(_.identityKey)}function decodePayload(_){return NoiseHandshakePayload.decode(_)}function getHandshakePayload(_){const a=fromString$5("noise-libp2p-static-key:");return concat$1([a,_],a.length+_.length)}async function verifySignedPayload(_,a,$){const j=await peerIdFromKeys(a.identityKey);if(!j.equals($))throw new Error("Peer ID doesn't match libp2p public key.");const _e=getHandshakePayload(_);if(j.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(a.identitySig==null)throw new Error("Signature was missing from message");if(!await unmarshalPublicKey(j.publicKey).verify(_e,a.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return j}function isValidPublicKey(_){return!(!(_ instanceof Uint8Array)||_.length!==32)}const log$2=logger$1("libp2p:noise");let keyLogger;DUMP_SESSION_KEYS?keyLogger=log$2:keyLogger=Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});function logLocalStaticKeys(_){keyLogger(`LOCAL_STATIC_PUBLIC_KEY ${toString$6(_.publicKey,"hex")}`),keyLogger(`LOCAL_STATIC_PRIVATE_KEY ${toString$6(_.privateKey,"hex")}`)}function logLocalEphemeralKeys(_){_?(keyLogger(`LOCAL_PUBLIC_EPHEMERAL_KEY ${toString$6(_.publicKey,"hex")}`),keyLogger(`LOCAL_PRIVATE_EPHEMERAL_KEY ${toString$6(_.privateKey,"hex")}`)):keyLogger("Missing local ephemeral keys.")}function logRemoteStaticKey(_){keyLogger(`REMOTE_STATIC_PUBLIC_KEY ${toString$6(_,"hex")}`)}function logRemoteEphemeralKey(_){keyLogger(`REMOTE_EPHEMERAL_PUBLIC_KEY ${toString$6(_,"hex")}`)}function logCipherState(_){_.cs1&&_.cs2?(keyLogger(`CIPHER_STATE_1 ${_.cs1.n.getUint64()} ${toString$6(_.cs1.k,"hex")}`),keyLogger(`CIPHER_STATE_2 ${_.cs2.n.getUint64()} ${toString$6(_.cs2.k,"hex")}`)):keyLogger("Missing cipher state.")}const MIN_NONCE=0,MAX_NONCE=4294967295,ERR_MAX_NONCE="Cipherstate has reached maximum n, a new handshake must be performed";class Nonce{constructor(a=MIN_NONCE){this.n=a,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,a,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>MAX_NONCE)throw new Error(ERR_MAX_NONCE)}}class AbstractHandshake{constructor(a){this.crypto=a}encryptWithAd(a,$,j){const _e=this.encrypt(a.k,a.n,$,j);return a.n.increment(),_e}decryptWithAd(a,$,j){const{plaintext:_e,valid:et}=this.decrypt(a.k,a.n,$,j);return et&&a.n.increment(),{plaintext:_e,valid:et}}hasKey(a){return!this.isEmptyKey(a.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(a){const $=this.createEmptyKey();return equals$1($,a)}encrypt(a,$,j,_e){return $.assertValue(),this.crypto.chaCha20Poly1305Encrypt(_e,$.getBytes(),j,a)}encryptAndHash(a,$){let j;return this.hasKey(a.cs)?j=this.encryptWithAd(a.cs,a.h,$):j=$,this.mixHash(a,j),j}decrypt(a,$,j,_e){$.assertValue();const et=this.crypto.chaCha20Poly1305Decrypt(_e,$.getBytes(),j,a);return et?{plaintext:et,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(a,$){let j,_e=!0;return this.hasKey(a.cs)?{plaintext:j,valid:_e}=this.decryptWithAd(a.cs,a.h,$):j=$,this.mixHash(a,$),{plaintext:j,valid:_e}}dh(a,$){try{const j=this.crypto.generateX25519SharedKey(a,$);return j.length===32?j:j.subarray(0,32)}catch(j){return log$2(j.message),new Uint8Array(32)}}mixHash(a,$){a.h=this.getHash(a.h,$)}getHash(a,$){return this.crypto.hashSHA256(concat$1([a,$],a.length+$.length))}mixKey(a,$){const[j,_e]=this.crypto.getHKDF(a.ck,$);a.cs=this.initializeKey(_e),a.ck=j}initializeKey(a){return{k:a,n:new Nonce}}initializeSymmetric(a){const $=fromString$5(a,"utf-8"),j=this.hashProtocolName($),_e=j,et=this.createEmptyKey();return{cs:this.initializeKey(et),ck:_e,h:j}}hashProtocolName(a){if(a.length<=32){const $=new Uint8Array(32);return $.set(a),$}else return this.getHash(a,new Uint8Array(0))}split(a){const[$,j]=this.crypto.getHKDF(a.ck,new Uint8Array(0)),_e=this.initializeKey($),et=this.initializeKey(j);return{cs1:_e,cs2:et}}writeMessageRegular(a,$){const j=this.encryptWithAd(a,new Uint8Array(0),$),_e=this.createEmptyKey(),et=new Uint8Array(0);return{ne:_e,ns:et,ciphertext:j}}readMessageRegular(a,$){return this.decryptWithAd(a,new Uint8Array(0),$.ciphertext)}}class XX extends AbstractHandshake{initializeInitiator(a,$,j,_e){const et="Noise_XX_25519_ChaChaPoly_SHA256",tt=this.initializeSymmetric(et);this.mixHash(tt,a);const rt=new Uint8Array(32);return{ss:tt,s:$,rs:j,psk:_e,re:rt}}initializeResponder(a,$,j,_e){const et="Noise_XX_25519_ChaChaPoly_SHA256",tt=this.initializeSymmetric(et);this.mixHash(tt,a);const rt=new Uint8Array(32);return{ss:tt,s:$,rs:j,psk:_e,re:rt}}writeMessageA(a,$,j){const _e=new Uint8Array(0);j!==void 0?a.e=j:a.e=this.crypto.generateX25519KeyPair();const et=a.e.publicKey;this.mixHash(a.ss,et);const tt=this.encryptAndHash(a.ss,$);return{ne:et,ns:_e,ciphertext:tt}}writeMessageB(a,$){a.e=this.crypto.generateX25519KeyPair();const j=a.e.publicKey;this.mixHash(a.ss,j),this.mixKey(a.ss,this.dh(a.e.privateKey,a.re));const _e=a.s.publicKey,et=this.encryptAndHash(a.ss,_e);this.mixKey(a.ss,this.dh(a.s.privateKey,a.re));const tt=this.encryptAndHash(a.ss,$);return{ne:j,ns:et,ciphertext:tt}}writeMessageC(a,$){const j=a.s.publicKey,_e=this.encryptAndHash(a.ss,j);this.mixKey(a.ss,this.dh(a.s.privateKey,a.re));const et=this.encryptAndHash(a.ss,$),rt={ne:this.createEmptyKey(),ns:_e,ciphertext:et},{cs1:nt,cs2:it}=this.split(a.ss);return{h:a.ss.h,messageBuffer:rt,cs1:nt,cs2:it}}readMessageA(a,$){return isValidPublicKey($.ne)&&(a.re=$.ne),this.mixHash(a.ss,a.re),this.decryptAndHash(a.ss,$.ciphertext)}readMessageB(a,$){if(isValidPublicKey($.ne)&&(a.re=$.ne),this.mixHash(a.ss,a.re),!a.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(a.ss,this.dh(a.e.privateKey,a.re));const{plaintext:j,valid:_e}=this.decryptAndHash(a.ss,$.ns);_e&&isValidPublicKey(j)&&(a.rs=j),this.mixKey(a.ss,this.dh(a.e.privateKey,a.rs));const{plaintext:et,valid:tt}=this.decryptAndHash(a.ss,$.ciphertext);return{plaintext:et,valid:_e&&tt}}readMessageC(a,$){const{plaintext:j,valid:_e}=this.decryptAndHash(a.ss,$.ns);if(_e&&isValidPublicKey(j)&&(a.rs=j),!a.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(a.ss,this.dh(a.e.privateKey,a.rs));const{plaintext:et,valid:tt}=this.decryptAndHash(a.ss,$.ciphertext),{cs1:rt,cs2:nt}=this.split(a.ss);return{h:a.ss.h,plaintext:et,valid:_e&&tt,cs1:rt,cs2:nt}}initSession(a,$,j){const _e=this.createEmptyKey(),et=new Uint8Array(32);let tt;return a?tt=this.initializeInitiator($,j,et,_e):tt=this.initializeResponder($,j,et,_e),{hs:tt,i:a,mc:0}}sendMessage(a,$,j){let _e;if(a.mc===0)_e=this.writeMessageA(a.hs,$,j);else if(a.mc===1)_e=this.writeMessageB(a.hs,$);else if(a.mc===2){const{h:et,messageBuffer:tt,cs1:rt,cs2:nt}=this.writeMessageC(a.hs,$);_e=tt,a.h=et,a.cs1=rt,a.cs2=nt}else if(a.mc>2)if(a.i){if(!a.cs1)throw new Error("CS1 (cipher state) is not defined");_e=this.writeMessageRegular(a.cs1,$)}else{if(!a.cs2)throw new Error("CS2 (cipher state) is not defined");_e=this.writeMessageRegular(a.cs2,$)}else throw new Error("Session invalid.");return a.mc++,_e}recvMessage(a,$){let j=new Uint8Array(0),_e=!1;if(a.mc===0)({plaintext:j,valid:_e}=this.readMessageA(a.hs,$));else if(a.mc===1)({plaintext:j,valid:_e}=this.readMessageB(a.hs,$));else if(a.mc===2){const{h:et,plaintext:tt,valid:rt,cs1:nt,cs2:it}=this.readMessageC(a.hs,$);j=tt,_e=rt,a.h=et,a.cs1=nt,a.cs2=it}return a.mc++,{plaintext:j,valid:_e}}}class XXHandshake{constructor(a,$,j,_e,et,tt,rt,nt){this.remoteExtensions={webtransportCerthashes:[]},this.isInitiator=a,this.payload=$,this.prologue=j,this.staticKeypair=et,this.connection=tt,rt&&(this.remotePeer=rt),this.xx=nt??new XX(_e),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(logLocalStaticKeys(this.session.hs.s),this.isInitiator){log$2("Stage 0 - Initiator starting to send first message.");const a=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP(encode0(a)),log$2("Stage 0 - Initiator finished sending first message."),logLocalEphemeralKeys(this.session.hs.e)}else{log$2("Stage 0 - Responder waiting to receive first message...");const a=decode0((await this.connection.readLP()).subarray()),{valid:$}=this.xx.recvMessage(this.session,a);if(!$)throw new InvalidCryptoExchangeError("xx handshake stage 0 validation fail");log$2("Stage 0 - Responder received first message."),logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){log$2("Stage 1 - Initiator waiting to receive first message from responder...");const a=decode1((await this.connection.readLP()).subarray()),{plaintext:$,valid:j}=this.xx.recvMessage(this.session,a);if(!j)throw new InvalidCryptoExchangeError("xx handshake stage 1 validation fail");log$2("Stage 1 - Initiator received the message."),logRemoteEphemeralKey(this.session.hs.re),logRemoteStaticKey(this.session.hs.rs),log$2("Initiator going to check remote's signature...");try{const _e=decodePayload($);this.remotePeer=this.remotePeer||await getPeerIdFromPayload(_e),await verifySignedPayload(this.session.hs.rs,_e,this.remotePeer),this.setRemoteNoiseExtension(_e.extensions)}catch(_e){const et=_e;throw new UnexpectedPeerError(`Error occurred while verifying signed payload: ${et.message}`)}log$2("All good with the signature!")}else{log$2("Stage 1 - Responder sending out first message with signed payload and static key.");const a=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(encode1(a)),log$2("Stage 1 - Responder sent the second handshake message with signed payload."),logLocalEphemeralKeys(this.session.hs.e)}}async finish(){if(this.isInitiator){log$2("Stage 2 - Initiator sending third handshake message.");const a=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(encode2(a)),log$2("Stage 2 - Initiator sent message with signed payload.")}else{log$2("Stage 2 - Responder waiting for third handshake message...");const a=decode2((await this.connection.readLP()).subarray()),{plaintext:$,valid:j}=this.xx.recvMessage(this.session,a);if(!j)throw new InvalidCryptoExchangeError("xx handshake stage 2 validation fail");log$2("Stage 2 - Responder received the message, finished handshake.");try{const _e=decodePayload($);this.remotePeer=this.remotePeer||await getPeerIdFromPayload(_e),await verifySignedPayload(this.session.hs.rs,_e,this.remotePeer),this.setRemoteNoiseExtension(_e.extensions)}catch(_e){const et=_e;throw new UnexpectedPeerError(`Error occurred while verifying signed payload: ${et.message}`)}}logCipherState(this.session)}encrypt(a,$){const j=this.getCS($);return this.xx.encryptWithAd(j,new Uint8Array(0),a)}decrypt(a,$){const j=this.getCS($,!1);return this.xx.decryptWithAd(j,new Uint8Array(0),a)}getRemoteStaticKey(){return this.session.hs.rs}getCS(a,$=!0){if(!a.cs1||!a.cs2)throw new InvalidCryptoExchangeError("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?$?a.cs1:a.cs2:$?a.cs2:a.cs1}setRemoteNoiseExtension(a){a&&(this.remoteExtensions=a)}}class Noise{constructor(a={}){this.protocol="/noise";const{staticNoiseKey:$,extensions:j,crypto:_e,prologueBytes:et}=a;this.crypto=_e??stablelib,this.extensions=j,$?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed($):this.staticKeys=this.crypto.generateX25519KeyPair(),this.prologue=et??new Uint8Array(0)}async secureOutbound(a,$,j){const _e=pbStream($,{lengthEncoder:uint16BEEncode,lengthDecoder:uint16BEDecode,maxDataLength:NOISE_MSG_MAX_LENGTH_BYTES}),et=await this.performHandshake({connection:_e,isInitiator:!0,localPeer:a,remotePeer:j});return{conn:await this.createSecureConnection(_e,et),remoteExtensions:et.remoteExtensions,remotePeer:et.remotePeer}}async secureInbound(a,$,j){const _e=pbStream($,{lengthEncoder:uint16BEEncode,lengthDecoder:uint16BEDecode,maxDataLength:NOISE_MSG_MAX_LENGTH_BYTES}),et=await this.performHandshake({connection:_e,isInitiator:!1,localPeer:a,remotePeer:j});return{conn:await this.createSecureConnection(_e,et),remotePeer:et.remotePeer,remoteExtensions:et.remoteExtensions}}async performHandshake(a){const $=await getPayload(a.localPeer,this.staticKeys.publicKey,this.extensions);return await this.performXXHandshake(a,$)}async performXXHandshake(a,$){const{isInitiator:j,remotePeer:_e,connection:et}=a,tt=new XXHandshake(j,$,this.prologue,this.crypto,this.staticKeys,et,_e);try{await tt.propose(),await tt.exchange(),await tt.finish()}catch(rt){if(rt instanceof Error)throw rt.message=`Error occurred during XX handshake: ${rt.message}`,rt}return tt}async createSecureConnection(a,$){const[j,_e]=duplexPair(),et=a.unwrap();return await pipe(j,encryptStream($),encode$5({lengthEncoder:uint16BEEncode}),et,decode$4({lengthDecoder:uint16BEDecode}),decryptStream($),j),_e}}function noise(_={}){return()=>new Noise(_)}const mergeOptions$2=mergeOptions$g.bind({ignoreUndefined:!0,concatArrays:!0});function createLibp2p({options:_={},peerId:a,multiaddrs:$=[],repo:j,keychainConfig:_e={},config:et={}}){const{datastore:tt}=j,rt=getLibp2pOptions({options:_,config:et,datastore:tt,keychainConfig:_e,peerId:a,multiaddrs:$});return typeof _.libp2p=="function"?_.libp2p({libp2pOptions:rt,options:_,config:et,datastore:tt,peerId:a}):createLibp2p$1(rt)}function getLibp2pOptions({options:_,config:a,datastore:$,keychainConfig:j,peerId:_e,multiaddrs:et}){const tt=()=>{const lt=get$2(a,"Pubsub.Router")||"gossipsub",ct=routers();if(!ct[lt])throw errCode(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${lt} router.`),"ERR_NOT_SUPPORTED");return ct[lt]},rt={datastore:$,peerId:_e},nt={addresses:{listen:et.map(lt=>lt.toString()),announce:get$2(_,"addresses.announce",get$2(a,"Addresses.Announce",[])),noAnnounce:get$2(_,"addresses.noAnnounce",get$2(a,"Addresses.NoAnnounce",[]))},connectionManager:get$2(_,"connectionManager",{maxConnections:get$2(_,"config.Swarm.ConnMgr.HighWater",get$2(a,"Swarm.ConnMgr.HighWater")),minConnections:get$2(_,"config.Swarm.ConnMgr.LowWater",get$2(a,"Swarm.ConnMgr.LowWater"))}),keychain:j,identify:{host:{agentVersion:`js-ipfs/${ipfsCore}`}},contentRouters:[],peerRouters:[],peerDiscovery:[],transports:[],streamMuxers:[mplex({maxInboundStreams:256,maxOutboundStreams:1024})],connectionEncryption:[noise()],relay:{enabled:get$2(_,"relay.enabled",get$2(a,"relay.enabled",!0)),hop:{enabled:get$2(_,"relay.hop.enabled",get$2(a,"relay.hop.enabled",!1)),active:get$2(_,"relay.hop.active",get$2(a,"relay.hop.active",!1))}},nat:{enabled:!get$2(a,"Swarm.DisableNatPortMap",!1)}};get$2(_,"config.Pubsub.Enabled",get$2(a,"Pubsub.Enabled",!0))&&(nt.pubsub=tt()),get$2(a,"Routing.Type","dhtclient")!=="none"&&(nt.dht=kadDHT({clientMode:get$2(a,"Routing.Type","dht")!=="dhtserver",kBucketSize:get$2(_,"dht.kBucketSize",20),validators:{ipns:ipnsValidator},selectors:{ipns:ipnsSelector}}));const it=get$2(_,"config.Bootstrap",get$2(a,"Bootstrap",[]));it.length>0&&nt.peerDiscovery?.push(bootstrap({list:it}));let st=get$2(_,"libp2p",void 0);typeof st=="function"&&(st=void 0);const ot=mergeOptions$2(rt,libp2pConfig(),nt,st),at=get$2(_,"config.Addresses.Delegates",get$2(a,"Addresses.Delegates",[]));if(at.length>0){const lt=at[Math.floor(Math.random()*at.length)],ct=multiaddr(lt).toOptions(),ut={host:ct.host,protocol:parseInt(ct.port)===443?"https":"http",port:ct.port},dt=create$3(ut);ot.contentRouters?.push(delegatedContentRouting(dt)),ot.peerRouters?.push(delegatedPeerRouting(dt))}return get$2(_,"config.Discovery.MDNS.Enabled",get$2(a,"Discovery.MDNS.Enabled",!0))||(ot.peerDiscovery=ot.peerDiscovery?.filter(lt=>{try{if(typeof lt=="function")return lt({})[Symbol.toStringTag]!=="@libp2p/mdns"}catch{}return!0})),ot.transports==null&&(ot.transports=[]),ot.transports.find(lt=>{try{if(typeof lt=="function")return lt({})[Symbol.toStringTag]==="@libp2p/websockets"}catch{}return!1})==null&&ot.transports.push(webSockets()),ot}const mergeOptions$1=mergeOptions$g.bind({ignoreUndefined:!0}),log$1=logger$1("ipfs:components:peer:storage");class Storage{constructor(a,$,j,_e,et){this.print=_e,this.peerId=a,this.keychain=$,this.repo=j,this.print=_e,this.isNew=et}static async start(a,$,j){const{repoAutoMigrate:_e,repo:et,onMigrationProgress:tt}=j,rt=typeof et=="string"||et==null?createRepo$1(a,$,{path:et,autoMigrate:_e,onMigrationProgress:tt}):et,{peerId:nt,keychain:it,isNew:st}=await loadRepo(a,rt,j);return new Storage(nt,it,rt,a,st)}}const loadRepo=async(_,a,$)=>{if(!a.closed)return{...await configureRepo(a,$),isNew:!1};try{return await a.open(),{...await configureRepo(a,$),isNew:!1}}catch(j){if(j.code!==ERR_REPO_NOT_INITIALIZED)throw j;if($.init&&$.init.allowNew===!1)throw new NotEnabledError("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await initRepo(_,a,$),isNew:!0}}},initRepo=async(_,a,$)=>{const j=$.init||{},_e=await a.exists();if(log$1("repo exists?",_e),_e===!0)throw new Error("repo already exists");const et=j.privateKey?await decodePeerId(j.privateKey):await initPeerId(_,j),tt=peerIdToIdentity(et);log$1("peer identity: %s",tt.PeerID);const rt={...mergeOptions$1(applyProfiles(getDefaultConfig(),j.profiles),$.config),Identity:tt};await a.init(rt),await a.open(),log$1("repo opened");const nt={pass:$.pass};try{nt.dek=await a.config.get("Keychain.DEK")}catch(st){if(st.code!=="ERR_NOT_FOUND")throw st}const it=await createLibp2p({options:void 0,multiaddrs:void 0,peerId:et,repo:a,config:rt,keychainConfig:nt});return await a.datastore.has(new Key("/info/self"))||await it.keychain.importPeer("self",et),await a.config.set("Keychain",{DEK:it.keychain.init.dek}),{peerId:et,keychain:it.keychain}},decodePeerId=async _=>{if(log$1("using user-supplied private-key"),isPeerId(_))return _;const a=fromString$5(_,"base64pad"),$=await unmarshalPrivateKey(a);return await peerIdFromKeys($.public.bytes,$.bytes)},initPeerId=(_,{algorithm:a="Ed25519",bits:$=2048})=>{if(_("generating %s keypair...",a),a==="Ed25519")return createEd25519PeerId();if(a==="RSA")return createRSAPeerId({bits:$});throw errCode(new Error("Unknown PeerId algorithm"),"ERR_UNKNOWN_PEER_ID_ALGORITHM")},peerIdToIdentity=_=>{if(_.privateKey==null)throw errCode(new Error("Private key missing"),"ERR_MISSING_PRIVATE_KEY");return{PeerID:_.toString(),PrivKey:toString$6(_.privateKey,"base64pad")}},configureRepo=async(_,a)=>{const $=a.config,j=a.init&&a.init.profiles||[],_e=a.pass,et=await _.config.getAll(),tt=mergeConfigs(applyProfiles(et,j),$);if(et!==tt&&await _.config.replace(tt),!tt.Identity||!tt.Identity.PrivKey)throw new NotInitializedError("No private key was found in the config, please intialize the repo");const rt=fromString$5(tt.Identity.PrivKey,"base64pad"),nt=await unmarshalPrivateKey(rt),it=await peerIdFromKeys(nt.public.bytes,nt.bytes),st=await createLibp2p({options:void 0,multiaddrs:void 0,peerId:it,repo:_,config:tt,keychainConfig:{pass:_e,...tt.Keychain}});return{peerId:it,keychain:st.keychain}},mergeConfigs=(_,a)=>a?mergeOptions$1(_,a):_,applyProfiles=(_,a)=>(a||[]).reduce(($,j)=>{const _e=profiles[j];if(!_e)throw new Error(`Could not find profile with name '${j}'`);return log$1("applying profile %s",j),_e.transform($)},_);var encode_1=encode,MSB$1=128,REST$1=127,MSBALL=~REST$1,INT=Math.pow(2,31);function encode(_,a,$){a=a||[],$=$||0;for(var j=$;_>=INT;)a[$++]=_&255|MSB$1,_/=128;for(;_&MSBALL;)a[$++]=_&255|MSB$1,_>>>=7;return a[$]=_|0,encode.bytes=$-j+1,a}var decode=read,MSB=128,REST=127;function read(_,j){var $=0,j=j||0,_e=0,et=j,tt,rt=_.length;do{if(et>=rt)throw read.bytes=0,new RangeError("Could not decode varint");tt=_[et++],$+=_e<28?(tt&REST)<<_e:(tt&REST)*Math.pow(2,_e),_e+=7}while(tt>=MSB);return read.bytes=et-j,$}var N1=Math.pow(2,7),N2=Math.pow(2,14),N3=Math.pow(2,21),N4=Math.pow(2,28),N5=Math.pow(2,35),N6=Math.pow(2,42),N7=Math.pow(2,49),N8=Math.pow(2,56),N9=Math.pow(2,63),length=function(_){return _<N1?1:_<N2?2:_<N3?3:_<N4?4:_<N5?5:_<N6?6:_<N7?7:_<N8?8:_<N9?9:10},varint$1={encode:encode_1,decode,encodingLength:length};const varint=varint$1;var src=_=>{if(!(_ instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");const a=[];for(;_.length>0;){const $=varint.decode(_);a.push($),_=_.slice(varint.decode.bytes)}return a};function varintEncoder(_){let a=new Uint8Array(_.reduce((j,_e)=>j+varint$4.encodingLength(_e),0)),$=0;for(const j of _)a=varint$4.encode(j,a,$),$+=varint$4.encodingLength(j);return a}class WantListEntry{constructor(a,$,j){this._refCounter=1,this.cid=a,this.priority=$||1,this.wantType=j}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(base58btc$2)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(a){return this._refCounter===a._refCounter&&this.cid.equals(a.cid)&&this.priority===a.priority&&this.wantType===a.wantType}}const $Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots["ipfs-bitswap"]||($protobuf.roots["ipfs-bitswap"]={}),Message=$root.Message=(()=>{function _(a){if(this.blocks=[],this.payload=[],this.blockPresences=[],a)for(var $=Object.keys(a),j=0;j<$.length;++j)a[$[j]]!=null&&(this[$[j]]=a[$[j]])}return _.prototype.wantlist=null,_.prototype.blocks=$util.emptyArray,_.prototype.payload=$util.emptyArray,_.prototype.blockPresences=$util.emptyArray,_.prototype.pendingBytes=0,_.encode=function($,j){if(j||(j=$Writer.create()),$.wantlist!=null&&Object.hasOwnProperty.call($,"wantlist")&&$root.Message.Wantlist.encode($.wantlist,j.uint32(10).fork()).ldelim(),$.blocks!=null&&$.blocks.length)for(var _e=0;_e<$.blocks.length;++_e)j.uint32(18).bytes($.blocks[_e]);if($.payload!=null&&$.payload.length)for(var _e=0;_e<$.payload.length;++_e)$root.Message.Block.encode($.payload[_e],j.uint32(26).fork()).ldelim();if($.blockPresences!=null&&$.blockPresences.length)for(var _e=0;_e<$.blockPresences.length;++_e)$root.Message.BlockPresence.encode($.blockPresences[_e],j.uint32(34).fork()).ldelim();return $.pendingBytes!=null&&Object.hasOwnProperty.call($,"pendingBytes")&&j.uint32(40).int32($.pendingBytes),j},_.decode=function($,j){$ instanceof $Reader||($=$Reader.create($));for(var _e=j===void 0?$.len:$.pos+j,et=new $root.Message;$.pos<_e;){var tt=$.uint32();switch(tt>>>3){case 1:{et.wantlist=$root.Message.Wantlist.decode($,$.uint32());break}case 2:{et.blocks&&et.blocks.length||(et.blocks=[]),et.blocks.push($.bytes());break}case 3:{et.payload&&et.payload.length||(et.payload=[]),et.payload.push($root.Message.Block.decode($,$.uint32()));break}case 4:{et.blockPresences&&et.blockPresences.length||(et.blockPresences=[]),et.blockPresences.push($root.Message.BlockPresence.decode($,$.uint32()));break}case 5:{et.pendingBytes=$.int32();break}default:$.skipType(tt&7);break}}return et},_.fromObject=function($){if($ instanceof $root.Message)return $;var j=new $root.Message;if($.wantlist!=null){if(typeof $.wantlist!="object")throw TypeError(".Message.wantlist: object expected");j.wantlist=$root.Message.Wantlist.fromObject($.wantlist)}if($.blocks){if(!Array.isArray($.blocks))throw TypeError(".Message.blocks: array expected");j.blocks=[];for(var _e=0;_e<$.blocks.length;++_e)typeof $.blocks[_e]=="string"?$util.base64.decode($.blocks[_e],j.blocks[_e]=$util.newBuffer($util.base64.length($.blocks[_e])),0):$.blocks[_e].length>=0&&(j.blocks[_e]=$.blocks[_e])}if($.payload){if(!Array.isArray($.payload))throw TypeError(".Message.payload: array expected");j.payload=[];for(var _e=0;_e<$.payload.length;++_e){if(typeof $.payload[_e]!="object")throw TypeError(".Message.payload: object expected");j.payload[_e]=$root.Message.Block.fromObject($.payload[_e])}}if($.blockPresences){if(!Array.isArray($.blockPresences))throw TypeError(".Message.blockPresences: array expected");j.blockPresences=[];for(var _e=0;_e<$.blockPresences.length;++_e){if(typeof $.blockPresences[_e]!="object")throw TypeError(".Message.blockPresences: object expected");j.blockPresences[_e]=$root.Message.BlockPresence.fromObject($.blockPresences[_e])}}return $.pendingBytes!=null&&(j.pendingBytes=$.pendingBytes|0),j},_.toObject=function($,j){j||(j={});var _e={};if((j.arrays||j.defaults)&&(_e.blocks=[],_e.payload=[],_e.blockPresences=[]),j.defaults&&(_e.wantlist=null,_e.pendingBytes=0),$.wantlist!=null&&$.hasOwnProperty("wantlist")&&(_e.wantlist=$root.Message.Wantlist.toObject($.wantlist,j)),$.blocks&&$.blocks.length){_e.blocks=[];for(var et=0;et<$.blocks.length;++et)_e.blocks[et]=j.bytes===String?$util.base64.encode($.blocks[et],0,$.blocks[et].length):j.bytes===Array?Array.prototype.slice.call($.blocks[et]):$.blocks[et]}if($.payload&&$.payload.length){_e.payload=[];for(var et=0;et<$.payload.length;++et)_e.payload[et]=$root.Message.Block.toObject($.payload[et],j)}if($.blockPresences&&$.blockPresences.length){_e.blockPresences=[];for(var et=0;et<$.blockPresences.length;++et)_e.blockPresences[et]=$root.Message.BlockPresence.toObject($.blockPresences[et],j)}return $.pendingBytes!=null&&$.hasOwnProperty("pendingBytes")&&(_e.pendingBytes=$.pendingBytes),_e},_.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},_.getTypeUrl=function($){return $===void 0&&($="type.googleapis.com"),$+"/Message"},_.Wantlist=function(){function a($){if(this.entries=[],$)for(var j=Object.keys($),_e=0;_e<j.length;++_e)$[j[_e]]!=null&&(this[j[_e]]=$[j[_e]])}return a.prototype.entries=$util.emptyArray,a.prototype.full=!1,a.encode=function(j,_e){if(_e||(_e=$Writer.create()),j.entries!=null&&j.entries.length)for(var et=0;et<j.entries.length;++et)$root.Message.Wantlist.Entry.encode(j.entries[et],_e.uint32(10).fork()).ldelim();return j.full!=null&&Object.hasOwnProperty.call(j,"full")&&_e.uint32(16).bool(j.full),_e},a.decode=function(j,_e){j instanceof $Reader||(j=$Reader.create(j));for(var et=_e===void 0?j.len:j.pos+_e,tt=new $root.Message.Wantlist;j.pos<et;){var rt=j.uint32();switch(rt>>>3){case 1:{tt.entries&&tt.entries.length||(tt.entries=[]),tt.entries.push($root.Message.Wantlist.Entry.decode(j,j.uint32()));break}case 2:{tt.full=j.bool();break}default:j.skipType(rt&7);break}}return tt},a.fromObject=function(j){if(j instanceof $root.Message.Wantlist)return j;var _e=new $root.Message.Wantlist;if(j.entries){if(!Array.isArray(j.entries))throw TypeError(".Message.Wantlist.entries: array expected");_e.entries=[];for(var et=0;et<j.entries.length;++et){if(typeof j.entries[et]!="object")throw TypeError(".Message.Wantlist.entries: object expected");_e.entries[et]=$root.Message.Wantlist.Entry.fromObject(j.entries[et])}}return j.full!=null&&(_e.full=Boolean(j.full)),_e},a.toObject=function(j,_e){_e||(_e={});var et={};if((_e.arrays||_e.defaults)&&(et.entries=[]),_e.defaults&&(et.full=!1),j.entries&&j.entries.length){et.entries=[];for(var tt=0;tt<j.entries.length;++tt)et.entries[tt]=$root.Message.Wantlist.Entry.toObject(j.entries[tt],_e)}return j.full!=null&&j.hasOwnProperty("full")&&(et.full=j.full),et},a.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},a.getTypeUrl=function(j){return j===void 0&&(j="type.googleapis.com"),j+"/Message.Wantlist"},a.WantType=function(){const $={},j=Object.create($);return j[$[0]="Block"]=0,j[$[1]="Have"]=1,j}(),a.Entry=function(){function $(j){if(j)for(var _e=Object.keys(j),et=0;et<_e.length;++et)j[_e[et]]!=null&&(this[_e[et]]=j[_e[et]])}return $.prototype.block=$util.newBuffer([]),$.prototype.priority=0,$.prototype.cancel=!1,$.prototype.wantType=0,$.prototype.sendDontHave=!1,$.encode=function(_e,et){return et||(et=$Writer.create()),_e.block!=null&&Object.hasOwnProperty.call(_e,"block")&&et.uint32(10).bytes(_e.block),_e.priority!=null&&Object.hasOwnProperty.call(_e,"priority")&&et.uint32(16).int32(_e.priority),_e.cancel!=null&&Object.hasOwnProperty.call(_e,"cancel")&&et.uint32(24).bool(_e.cancel),_e.wantType!=null&&Object.hasOwnProperty.call(_e,"wantType")&&et.uint32(32).int32(_e.wantType),_e.sendDontHave!=null&&Object.hasOwnProperty.call(_e,"sendDontHave")&&et.uint32(40).bool(_e.sendDontHave),et},$.decode=function(_e,et){_e instanceof $Reader||(_e=$Reader.create(_e));for(var tt=et===void 0?_e.len:_e.pos+et,rt=new $root.Message.Wantlist.Entry;_e.pos<tt;){var nt=_e.uint32();switch(nt>>>3){case 1:{rt.block=_e.bytes();break}case 2:{rt.priority=_e.int32();break}case 3:{rt.cancel=_e.bool();break}case 4:{rt.wantType=_e.int32();break}case 5:{rt.sendDontHave=_e.bool();break}default:_e.skipType(nt&7);break}}return rt},$.fromObject=function(_e){if(_e instanceof $root.Message.Wantlist.Entry)return _e;var et=new $root.Message.Wantlist.Entry;switch(_e.block!=null&&(typeof _e.block=="string"?$util.base64.decode(_e.block,et.block=$util.newBuffer($util.base64.length(_e.block)),0):_e.block.length>=0&&(et.block=_e.block)),_e.priority!=null&&(et.priority=_e.priority|0),_e.cancel!=null&&(et.cancel=Boolean(_e.cancel)),_e.wantType){case"Block":case 0:et.wantType=0;break;case"Have":case 1:et.wantType=1;break}return _e.sendDontHave!=null&&(et.sendDontHave=Boolean(_e.sendDontHave)),et},$.toObject=function(_e,et){et||(et={});var tt={};return et.defaults&&(et.bytes===String?tt.block="":(tt.block=[],et.bytes!==Array&&(tt.block=$util.newBuffer(tt.block))),tt.priority=0,tt.cancel=!1,tt.wantType=et.enums===String?"Block":0,tt.sendDontHave=!1),_e.block!=null&&_e.hasOwnProperty("block")&&(tt.block=et.bytes===String?$util.base64.encode(_e.block,0,_e.block.length):et.bytes===Array?Array.prototype.slice.call(_e.block):_e.block),_e.priority!=null&&_e.hasOwnProperty("priority")&&(tt.priority=_e.priority),_e.cancel!=null&&_e.hasOwnProperty("cancel")&&(tt.cancel=_e.cancel),_e.wantType!=null&&_e.hasOwnProperty("wantType")&&(tt.wantType=et.enums===String?$root.Message.Wantlist.WantType[_e.wantType]:_e.wantType),_e.sendDontHave!=null&&_e.hasOwnProperty("sendDontHave")&&(tt.sendDontHave=_e.sendDontHave),tt},$.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},$.getTypeUrl=function(_e){return _e===void 0&&(_e="type.googleapis.com"),_e+"/Message.Wantlist.Entry"},$}(),a}(),_.Block=function(){function a($){if($)for(var j=Object.keys($),_e=0;_e<j.length;++_e)$[j[_e]]!=null&&(this[j[_e]]=$[j[_e]])}return a.prototype.prefix=$util.newBuffer([]),a.prototype.data=$util.newBuffer([]),a.encode=function(j,_e){return _e||(_e=$Writer.create()),j.prefix!=null&&Object.hasOwnProperty.call(j,"prefix")&&_e.uint32(10).bytes(j.prefix),j.data!=null&&Object.hasOwnProperty.call(j,"data")&&_e.uint32(18).bytes(j.data),_e},a.decode=function(j,_e){j instanceof $Reader||(j=$Reader.create(j));for(var et=_e===void 0?j.len:j.pos+_e,tt=new $root.Message.Block;j.pos<et;){var rt=j.uint32();switch(rt>>>3){case 1:{tt.prefix=j.bytes();break}case 2:{tt.data=j.bytes();break}default:j.skipType(rt&7);break}}return tt},a.fromObject=function(j){if(j instanceof $root.Message.Block)return j;var _e=new $root.Message.Block;return j.prefix!=null&&(typeof j.prefix=="string"?$util.base64.decode(j.prefix,_e.prefix=$util.newBuffer($util.base64.length(j.prefix)),0):j.prefix.length>=0&&(_e.prefix=j.prefix)),j.data!=null&&(typeof j.data=="string"?$util.base64.decode(j.data,_e.data=$util.newBuffer($util.base64.length(j.data)),0):j.data.length>=0&&(_e.data=j.data)),_e},a.toObject=function(j,_e){_e||(_e={});var et={};return _e.defaults&&(_e.bytes===String?et.prefix="":(et.prefix=[],_e.bytes!==Array&&(et.prefix=$util.newBuffer(et.prefix))),_e.bytes===String?et.data="":(et.data=[],_e.bytes!==Array&&(et.data=$util.newBuffer(et.data)))),j.prefix!=null&&j.hasOwnProperty("prefix")&&(et.prefix=_e.bytes===String?$util.base64.encode(j.prefix,0,j.prefix.length):_e.bytes===Array?Array.prototype.slice.call(j.prefix):j.prefix),j.data!=null&&j.hasOwnProperty("data")&&(et.data=_e.bytes===String?$util.base64.encode(j.data,0,j.data.length):_e.bytes===Array?Array.prototype.slice.call(j.data):j.data),et},a.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},a.getTypeUrl=function(j){return j===void 0&&(j="type.googleapis.com"),j+"/Message.Block"},a}(),_.BlockPresenceType=function(){const a={},$=Object.create(a);return $[a[0]="Have"]=0,$[a[1]="DontHave"]=1,$}(),_.BlockPresence=function(){function a($){if($)for(var j=Object.keys($),_e=0;_e<j.length;++_e)$[j[_e]]!=null&&(this[j[_e]]=$[j[_e]])}return a.prototype.cid=$util.newBuffer([]),a.prototype.type=0,a.encode=function(j,_e){return _e||(_e=$Writer.create()),j.cid!=null&&Object.hasOwnProperty.call(j,"cid")&&_e.uint32(10).bytes(j.cid),j.type!=null&&Object.hasOwnProperty.call(j,"type")&&_e.uint32(16).int32(j.type),_e},a.decode=function(j,_e){j instanceof $Reader||(j=$Reader.create(j));for(var et=_e===void 0?j.len:j.pos+_e,tt=new $root.Message.BlockPresence;j.pos<et;){var rt=j.uint32();switch(rt>>>3){case 1:{tt.cid=j.bytes();break}case 2:{tt.type=j.int32();break}default:j.skipType(rt&7);break}}return tt},a.fromObject=function(j){if(j instanceof $root.Message.BlockPresence)return j;var _e=new $root.Message.BlockPresence;switch(j.cid!=null&&(typeof j.cid=="string"?$util.base64.decode(j.cid,_e.cid=$util.newBuffer($util.base64.length(j.cid)),0):j.cid.length>=0&&(_e.cid=j.cid)),j.type){case"Have":case 0:_e.type=0;break;case"DontHave":case 1:_e.type=1;break}return _e},a.toObject=function(j,_e){_e||(_e={});var et={};return _e.defaults&&(_e.bytes===String?et.cid="":(et.cid=[],_e.bytes!==Array&&(et.cid=$util.newBuffer(et.cid))),et.type=_e.enums===String?"Have":0),j.cid!=null&&j.hasOwnProperty("cid")&&(et.cid=_e.bytes===String?$util.base64.encode(j.cid,0,j.cid.length):_e.bytes===Array?Array.prototype.slice.call(j.cid):j.cid),j.type!=null&&j.hasOwnProperty("type")&&(et.type=_e.enums===String?$root.Message.BlockPresenceType[j.type]:j.type),et},a.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},a.getTypeUrl=function(j){return j===void 0&&(j="type.googleapis.com"),j+"/Message.BlockPresence"},a}(),_})(),WantType$1={Block:Message.Wantlist.WantType.Block,Have:Message.Wantlist.WantType.Have},sortBy=(_,a)=>Array.prototype.slice.call(a,0).sort(($,j)=>{const _e=_($),et=_(j);return _e<et?-1:_e>et?1:0});class Wantlist{constructor(a,$){this.set=$?trackedMap({system:"ipfs",component:"bitswap",metric:"wantlist",metrics:$.metrics}):new Map,this._stats=a}get length(){return this.set.size}add(a,$,j){const _e=a.toString(base58btc$2),et=this.set.get(_e);et?(et.inc(),et.priority=$,et.wantType===WantType$1.Have&&j===WantType$1.Block&&(et.wantType=j)):(this.set.set(_e,new WantListEntry(a,$,j)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(a){const $=a.toString(base58btc$2),j=this.set.get($);!j||(j.dec(),!j.hasRefs()&&(this.set.delete($),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(a){this.set.has(a)&&this.set.delete(a)}forEach(a){return this.set.forEach(a)}entries(){return this.set.entries()}sortedEntries(){return new Map(sortBy(a=>a[1].key,Array.from(this.set.entries())))}contains(a){const $=a.toString(base58btc$2);return this.set.has($)}get(a){const $=a.toString(base58btc$2);return this.set.get($)}}Wantlist.Entry=WantListEntry;const WantlistEntry=Wantlist.Entry;class BitswapMessageEntry{constructor(a,$,j,_e,et){this.entry=new WantlistEntry(a,$,j),this.cancel=Boolean(_e),this.sendDontHave=Boolean(et)}get cid(){return this.entry.cid}set cid(a){this.entry.cid=a}get priority(){return this.entry.priority}set priority(a){this.entry.priority=a}get wantType(){return this.entry.wantType}set wantType(a){this.entry.wantType=a}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(base58btc$2)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(a){return this.cancel===a.cancel&&this.sendDontHave===a.sendDontHave&&this.wantType===a.wantType&&this.entry.equals(a.entry)}}const logger=(_,a)=>{const $=["bitswap"];return a&&$.push(a),_&&$.push(`${_.toString().slice(0,8)}`),Object.assign(debug($.join(":")),{error:debug($.concat(["error"]).join(":"))})},isMapEqual=(_,a)=>{if(_.size!==a.size)return!1;for(const[$,j]of _){const _e=a.get($);if(_e===void 0||j instanceof Uint8Array&&_e instanceof Uint8Array&&!equals$1(j,_e)||j instanceof BitswapMessageEntry&&_e instanceof BitswapMessageEntry&&!j.equals(_e))return!1}return!0};class BitswapMessage{constructor(a){this.full=a,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(a,$,j,_e,et){j==null&&(j=BitswapMessage.WantType.Block);const tt=a.toString(base58btc$2),rt=this.wantlist.get(tt);rt?(rt.wantType===j&&(rt.priority=$),_e&&(rt.cancel=Boolean(_e)),et&&(rt.sendDontHave=Boolean(et)),j===BitswapMessage.WantType.Block&&rt.wantType===BitswapMessage.WantType.Have&&(rt.wantType=j)):this.wantlist.set(tt,new BitswapMessageEntry(a,$,j,_e,et))}addBlock(a,$){const j=a.toString(base58btc$2);this.blocks.set(j,$)}addHave(a){const $=a.toString(base58btc$2);this.blockPresences.has($)||this.blockPresences.set($,BitswapMessage.BlockPresenceType.Have)}addDontHave(a){const $=a.toString(base58btc$2);this.blockPresences.has($)||this.blockPresences.set($,BitswapMessage.BlockPresenceType.DontHave)}cancel(a){const $=a.toString(base58btc$2);this.wantlist.delete($),this.addEntry(a,0,BitswapMessage.WantType.Block,!0,!1)}setPendingBytes(a){this.pendingBytes=a}serializeToBitswap100(){const a={wantlist:{entries:Array.from(this.wantlist.values()).map($=>({block:$.cid.bytes,priority:Number($.priority),cancel:Boolean($.cancel)})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values())};return Message.encode(a).finish()}serializeToBitswap110(){const a={wantlist:{entries:Array.from(this.wantlist.values()).map($=>({block:$.cid.bytes,priority:Number($.priority),wantType:$.wantType,cancel:Boolean($.cancel),sendDontHave:Boolean($.sendDontHave)})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(const[$,j]of this.blocks.entries()){const _e=CID.parse($),et=_e.version,tt=_e.code,rt=_e.multihash.code,nt=_e.multihash.digest.length,it=varintEncoder([et,tt,rt,nt]);a.payload.push(new Message.Block({prefix:it,data:j}))}for(const[$,j]of this.blockPresences)a.blockPresences.push(new Message.BlockPresence({cid:CID.parse($).bytes,type:j}));return this.pendingBytes>0&&(a.pendingBytes=this.pendingBytes),Message.encode(a).finish()}equals(a){return!(this.full!==a.full||this.pendingBytes!==a.pendingBytes||!isMapEqual(this.wantlist,a.wantlist)||!isMapEqual(this.blocks,a.blocks)||!isMapEqual(this.blockPresences,a.blockPresences))}get[Symbol.toStringTag](){const a=Array.from(this.wantlist.keys()),$=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${a}, blocks: ${$}>`}}BitswapMessage.deserialize=async(_,a)=>{const $=Message.decode(_),j=$.wantlist&&$.wantlist.full||!1,_e=new BitswapMessage(j);return $.wantlist&&$.wantlist.entries&&$.wantlist.entries.forEach(et=>{if(!et.block)return;const tt=CID.decode(et.block);_e.addEntry(tt,et.priority||0,et.wantType,Boolean(et.cancel),Boolean(et.sendDontHave))}),$.blockPresences&&$.blockPresences.forEach(et=>{if(!et.cid)return;const tt=CID.decode(et.cid);et.type===BitswapMessage.BlockPresenceType.Have?_e.addHave(tt):_e.addDontHave(tt)}),$.blocks.length>0?(await Promise.all($.blocks.map(async et=>{const tt=await sha256$4.digest(et),rt=CID.createV0(tt);_e.addBlock(rt,et)})),_e):($.payload.length>0&&(await Promise.all($.payload.map(async et=>{if(!et.prefix||!et.data)return;const tt=src(et.prefix),rt=tt[0],nt=tt[1],it=tt[2],st=it===sha256$4.code?sha256$4:a&&await a.getHasher(it);if(!st)throw errCode(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");const ot=await st.digest(et.data),at=CID.create(rt,nt,ot);_e.addBlock(at,et.data)})),_e.setPendingBytes($.pendingBytes)),_e)};BitswapMessage.blockPresenceSize=_=>_.bytes.length+1;BitswapMessage.Entry=BitswapMessageEntry;BitswapMessage.WantType={Block:Message.Wantlist.WantType.Block,Have:Message.Wantlist.WantType.Have};BitswapMessage.BlockPresenceType={Have:Message.BlockPresenceType.Have,DontHave:Message.BlockPresenceType.DontHave};const maxProvidersPerRequest=3,kMaxPriority=Math.pow(2,31)-1,maxListeners=1e3,wantlistSendDebounceMs=1;var functionDebounce=debounce;function debounce(_,a,$){var j=null,_e=null,et=function(){j&&(clearTimeout(j),_e=null,j=null)},tt=function(){var nt=_e;et(),nt&&nt()},rt=function(){if(!a)return _.apply(this,arguments);var nt=this,it=arguments,st=$&&!j;if(et(),_e=function(){_.apply(nt,it)},j=setTimeout(function(){if(j=null,!st){var ot=_e;return _e=null,ot()}},a),st)return _e()};return rt.cancel=et,rt.flush=tt,rt}class MsgQueue{constructor(a,$,j){this.peerId=$,this.network=j,this.refcnt=1,this._entries=[],this._log=logger(a,"msgqueue"),this.sendEntries=functionDebounce(this._sendEntries.bind(this),wantlistSendDebounceMs)}addMessage(a){a.empty||this.send(a)}addEntries(a){this._entries=this._entries.concat(a),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;const a=new BitswapMessage(!1);this._entries.forEach($=>{$.cancel?a.cancel($.cid):a.addEntry($.cid,$.priority)}),this._entries=[],this.addMessage(a)}async send(a){try{await this.network.connectTo(this.peerId)}catch($){this._log.error("cant connect to peer %s: %s",this.peerId.toString(),$.message);return}this._log("sending message to peer %s",this.peerId.toString()),this.network.sendMessage(this.peerId,a).catch($=>{this._log.error("send error: %s",$.message)})}}class WantManager{constructor(a,$,j,_e){this.peers=trackedMap({system:"ipfs",component:"bitswap",metric:"want-manager-peers",metrics:_e.metrics}),this.wantlist=new Wantlist(j,_e),this.network=$,this._stats=j,this._peerId=a,this._log=logger(a,"want")}_addEntries(a,$,j){const _e=a.map((et,tt)=>new BitswapMessage.Entry(et,kMaxPriority-tt,BitswapMessage.WantType.Block,$));_e.forEach(et=>{et.cancel?j?this.wantlist.removeForce(et.cid.toString(base58btc$2)):this.wantlist.remove(et.cid):(this._log("adding to wl"),this.wantlist.add(et.cid,et.priority))});for(const et of this.peers.values())et.addEntries(_e)}_startPeerHandler(a){let $=this.peers.get(a.toString());if($){$.refcnt++;return}$=new MsgQueue(this._peerId,a,this.network);const j=new BitswapMessage(!0);for(const _e of this.wantlist.entries())j.addEntry(_e[1].cid,_e[1].priority);return $.addMessage(j),this.peers.set(a.toString(),$),$}_stopPeerHandler(a){const $=this.peers.get(a.toString());!$||($.refcnt--,!($.refcnt>0)&&this.peers.delete(a.toString()))}wantBlocks(a,$={}){this._addEntries(a,!1),$&&$.signal&&$.signal.addEventListener("abort",()=>{this.cancelWants(a)})}unwantBlocks(a){this._log("unwant blocks: %s",a.length),this._addEntries(a,!0,!0)}cancelWants(a){this._log("cancel wants: %s",a.length),this._addEntries(a,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(a){this._startPeerHandler(a)}disconnected(a){this._stopPeerHandler(a)}start(){}stop(){this.peers.forEach(a=>this.disconnected(a.peerId))}}const BITSWAP100="/ipfs/bitswap/1.0.0",BITSWAP110="/ipfs/bitswap/1.1.0",BITSWAP120="/ipfs/bitswap/1.2.0",DEFAULT_MAX_INBOUND_STREAMS=32,DEFAULT_MAX_OUTBOUND_STREAMS=128,DEFAULT_INCOMING_STREAM_TIMEOUT=3e4;class Network$1{constructor(a,$,j,_e={}){this._log=logger(a.peerId,"network"),this._libp2p=a,this._bitswap=$,this._protocols=[BITSWAP100],_e.b100Only||(this._protocols.unshift(BITSWAP110),this._protocols.unshift(BITSWAP120)),this._stats=j,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=_e.hashLoader,this._maxInboundStreams=_e.maxInboundStreams??DEFAULT_MAX_INBOUND_STREAMS,this._maxOutboundStreams=_e.maxOutboundStreams??DEFAULT_MAX_OUTBOUND_STREAMS,this._incomingStreamTimeout=_e.incomingStreamTimeout??DEFAULT_INCOMING_STREAM_TIMEOUT}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection,{maxInboundStreams:this._maxInboundStreams,maxOutboundStreams:this._maxOutboundStreams});const a=createTopology({onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect});this._registrarIds=[];for(const $ of this._protocols)this._registrarIds.push(await this._libp2p.registrar.register($,a));this._libp2p.getConnections().forEach($=>{this._onPeerConnect($.remotePeer)})}async stop(){if(this._running=!1,await this._libp2p.unhandle(this._protocols),this._registrarIds!=null){for(const a of this._registrarIds)this._libp2p.registrar.unregister(a);this._registrarIds=[]}}_onConnection({stream:a,connection:$}){if(!this._running)return;const j=new timeoutAbortController.TimeoutController(this._incomingStreamTimeout);Promise.resolve().then(async()=>{this._log("incoming new bitswap %s connection from %p",a.stat.protocol,$.remotePeer),await pipe(abortableSource(a.source,j.signal),decode$4(),async _e=>{for await(const et of _e){try{const tt=await BitswapMessage.deserialize(et.subarray(),this._hashLoader);await this._bitswap._receiveMessage($.remotePeer,tt)}catch(tt){this._bitswap._receiveError(tt);break}j.reset()}})}).catch(_e=>{this._log(_e),a.abort(_e)}).finally(()=>{j.clear(),a.close()})}_onPeerConnect(a){this._bitswap._onPeerConnected(a)}_onPeerDisconnect(a){this._bitswap._onPeerDisconnected(a)}findProviders(a,$={}){return this._libp2p.contentRouting.findProviders(a,$)}async findAndConnect(a,$){const j=[];let _e=0;for await(const et of this.findProviders(a,$))if(this._log(`connecting to provider ${et.id}`),j.push(this.connectTo(et.id,$).catch(tt=>{this._log.error(tt)})),_e++,_e===maxProvidersPerRequest)break;await Promise.all(j)}async provide(a,$){await this._libp2p.contentRouting.provide(a,$)}async sendMessage(a,$){if(!this._running)throw new Error("network isn't running");const j=a.toString();this._log("sendMessage to %s",j,$);const et=await(await this._libp2p.dial(a)).newStream([BITSWAP120,BITSWAP110,BITSWAP100]);await writeMessage(et,$,this._log),this._updateSentStats(a,$.blocks)}async connectTo(a,$){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(a,$)}_updateSentStats(a,$){const j=a.toString();if(this._stats){for(const _e of $.values())this._stats.push(j,"dataSent",_e.length);this._stats.push(j,"blocksSent",$.size)}}}async function writeMessage(_,a,$){try{let j;switch(_.stat.protocol){case BITSWAP100:j=a.serializeToBitswap100();break;case BITSWAP110:case BITSWAP120:j=a.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+_.stat.protocol)}await pipe([j],encode$5(),_)}catch(j){$(j)}finally{_.close()}}class Ledger{constructor(a){this.partner=a,this.wantlist=new Wantlist,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(a){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=a}receivedBytes(a){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=a}wants(a,$,j){this.wantlist.add(a,$,j)}cancelWant(a){this.wantlist.remove(a)}wantlistContains(a){return this.wantlist.get(a)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}class SortedMap extends Map{constructor(a,$){super(),this._cmp=$||this._defaultSort,this._keys=[];for(const[j,_e]of a||[])this.set(j,_e)}update(a){if(a<0||a>=this._keys.length)return;const $=this._keys[a];this._keys.splice(a,1);const j=this._find($);this._keys.splice(j,0,$)}set(a,$){if(this.has(a)){const _e=this.indexOf(a);this._keys.splice(_e,1)}super.set(a,$);const j=this._find(a);return this._keys.splice(j,0,a),this}clear(){super.clear(),this._keys=[]}delete(a){if(!this.has(a))return!1;const $=this.indexOf(a);return this._keys.splice($,1),super.delete(a)}indexOf(a){if(!this.has(a))return-1;const $=this._find(a);if(this._keys[$]===a)return $;for(let j=1;j<this._keys.length;j++){if(this._keys[$+j]===a)return $+j;if(this._keys[$-j]===a)return $-j}return-1}_find(a){let $=0,j=this._keys.length;for(;$<j;){const _e=$+j>>>1,et=this._kCmp(this._keys[_e],a);if(et<0)$=_e+1;else if(et>0)j=_e;else return _e}return $}*keys(){for(const a of this._keys)yield a}*values(){for(const a of this._keys)yield this.get(a)}*entries(){for(const a of this._keys)yield[a,this.get(a)]}*[Symbol.iterator](){yield*this.entries()}forEach(a,$){if(!!a)for(const j of this._keys)a.apply($,[[j,this.get(j)]])}_defaultSort(a,$){return a[0]<$[0]?-1:$[0]<a[0]?1:0}_kCmp(a,$){return this._cmp([a,this.get(a)],[$,this.get($)])}}const DefaultTaskMerger={hasNewInfo(){return!1},merge(){}};class RequestQueue{constructor(a=DefaultTaskMerger){this._taskMerger=a,this._byPeer=new SortedMap([],PeerTasks.compare)}pushTasks(a,$){let j=this._byPeer.get(a.toString());j||(j=new PeerTasks(a,this._taskMerger)),j.pushTasks($),this._byPeer.set(a.toString(),j)}popTasks(a){const $=this._head();if($===void 0)return{tasks:[],pendingSize:0};const{tasks:j,pendingSize:_e}=$.popTasks(a);if(j.length===0)return{tasks:j,pendingSize:_e};const et=$.peerId;return $.isIdle()?this._byPeer.delete(et.toString()):this._byPeer.update(0),{peerId:et,tasks:j,pendingSize:_e}}_head(){if(this._byPeer.size!==0)for(const[,a]of this._byPeer)return a}remove(a,$){const j=this._byPeer.get($.toString());j&&j.remove(a)}tasksDone(a,$){const j=this._byPeer.get(a.toString());if(!j)return;const _e=this._byPeer.indexOf(a.toString());for(const et of $)j.taskDone(et);this._byPeer.update(_e)}}class PeerTasks{constructor(a,$){this.peerId=a,this._taskMerger=$,this._activeTotalSize=0,this._pending=new PendingTasks,this._active=new Set}pushTasks(a){for(const $ of a)this._pushTask($)}_pushTask(a){if(!this._taskHasMoreInfoThanActiveTasks(a))return;const $=this._pending.get(a.topic);if($){a.priority>$.priority&&this._pending.updatePriority(a.topic,a.priority),this._taskMerger.merge(a,$);return}this._pending.add(a)}_taskHasMoreInfoThanActiveTasks(a){const $=[];for(const j of this._active)j.topic===a.topic&&$.push(j);return $.length===0?!0:this._taskMerger.hasNewInfo(a,$)}popTasks(a){let $=0;const j=[],_e=this._pending.tasks();for(let et=0;et<_e.length&&$<a;et++){const tt=_e[et];j.push(tt),$+=tt.size,this._pending.delete(tt.topic),this._activeTotalSize+=tt.size,this._active.add(tt)}return{tasks:j,pendingSize:this._pending.totalSize}}taskDone(a){this._active.has(a)&&(this._activeTotalSize-=a.size,this._active.delete(a))}remove(a){this._pending.delete(a)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(a,$){return a[1]._pending.length===0?1:$[1]._pending.length===0?-1:a[1]._activeTotalSize===$[1]._activeTotalSize?$[1]._pending.length-a[1]._pending.length:a[1]._activeTotalSize-$[1]._activeTotalSize}}class PendingTasks{constructor(){this._tasks=new SortedMap([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((a,$)=>a+$.task.size,0)}get(a){return(this._tasks.get(a)||{}).task}add(a){this._tasks.set(a.topic,{created:Date.now(),task:a})}delete(a){this._tasks.delete(a)}tasks(){return[...this._tasks.values()].map(a=>a.task)}updatePriority(a,$){const j=this._tasks.get(a);if(!j)return;const _e=this._tasks.indexOf(a);j.task.priority=$,this._tasks.update(_e)}_compare(a,$){return a[1].task.priority===$[1].task.priority?a[1].created-$[1].created:$[1].task.priority-a[1].task.priority}}const TaskMerger={hasNewInfo(_,a){let $=!1,j=!1;for(const _e of a)_e.data.haveBlock&&($=!0),_e.data.isWantBlock&&(j=!0);return!!(!j&&_.data.isWantBlock||!$&&_.data.haveBlock)},merge(_,a){const $=_.data,j=a.data;!j.haveBlock&&$.haveBlock&&(j.haveBlock=$.haveBlock,j.blockSize=$.blockSize),!j.isWantBlock&&$.isWantBlock&&(j.isWantBlock=!0,(!j.haveBlock||$.haveBlock)&&(j.haveBlock=$.haveBlock,a.size=_.size)),j.isWantBlock&&j.haveBlock&&(a.size=j.blockSize)}},WantType=BitswapMessage.WantType,TARGET_MESSAGE_SIZE=16*1024,MAX_SIZE_REPLACE_HAS_WITH_BLOCK=1024;class DecisionEngine{constructor(a,$,j,_e,et,tt={}){this._log=logger(a,"engine"),this.blockstore=$,this.network=j,this._stats=_e,this._opts=this._processOpts(tt),this.ledgerMap=trackedMap({system:"ipfs",component:"bitswap",metric:"ledger-map",metrics:et.metrics}),this._running=!1,this._requestQueue=new RequestQueue(TaskMerger)}_processOpts(a){return{maxSizeReplaceHasWithBlock:MAX_SIZE_REPLACE_HAS_WITH_BLOCK,targetMessageSize:TARGET_MESSAGE_SIZE,...a}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;const{peerId:a,tasks:$,pendingSize:j}=this._requestQueue.popTasks(this._opts.targetMessageSize);if($.length===0)return;const _e=new BitswapMessage(!1);_e.setPendingBytes(j);const et=[],tt=new Map;for(const nt of $){const it=CID.parse(nt.topic);nt.data.haveBlock?nt.data.isWantBlock?(et.push(it),tt.set(nt.topic,nt.data)):_e.addHave(it):_e.addDontHave(it)}const rt=await this._getBlocks(et);for(const[nt,it]of tt){const st=CID.parse(nt),ot=rt.get(nt);ot?_e.addBlock(st,ot):it.sendDontHave&&_e.addDontHave(st)}if(_e.empty){a&&this._requestQueue.tasksDone(a,$),this._scheduleProcessTasks();return}try{a&&await this.network.sendMessage(a,_e);for(const[nt,it]of rt.entries())a&&this.messageSent(a,CID.parse(nt),it)}catch(nt){this._log.error(nt)}a&&this._requestQueue.tasksDone(a,$),this._scheduleProcessTasks()}wantlistForPeer(a){const $=a.toString(),j=this.ledgerMap.get($);return j?j.wantlist.sortedEntries():new Map}ledgerForPeer(a){const $=a.toString(),j=this.ledgerMap.get($);return j?{peer:j.partner,value:j.debtRatio(),sent:j.accounting.bytesSent,recv:j.accounting.bytesRecv,exchanged:j.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(a=>a.partner)}receivedBlocks(a){if(!!a.length){for(const $ of this.ledgerMap.values())for(const j of a){const _e=$.wantlistContains(j.cid);if(!_e)continue;const et=j.data.length,tt=this._sendAsBlock(_e.wantType,et);let rt=et;tt||(rt=BitswapMessage.blockPresenceSize(_e.cid)),this._requestQueue.pushTasks($.partner,[{topic:_e.cid.toString(base58btc$2),priority:_e.priority,size:rt,data:{blockSize:et,isWantBlock:tt,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(a,$){const j=this._findOrCreate(a);if($.empty)return;if($.full&&(j.wantlist=new Wantlist),this._updateBlockAccounting($.blocks,j),$.wantlist.size===0){this._scheduleProcessTasks();return}const _e=[],et=[];$.wantlist.forEach(tt=>{tt.cancel?(j.cancelWant(tt.cid),_e.push(tt.cid)):(j.wants(tt.cid,tt.priority,tt.wantType),et.push(tt))}),this._cancelWants(a,_e),await this._addWants(a,et),this._scheduleProcessTasks()}_cancelWants(a,$){for(const j of $)this._requestQueue.remove(j.toString(base58btc$2),a)}async _addWants(a,$){const j=await this._getBlockSizes($.map(et=>et.cid)),_e=[];for(const et of $){const tt=et.cid.toString(base58btc$2),rt=j.get(tt);if(rt==null)et.sendDontHave&&_e.push({topic:tt,priority:et.priority,size:BitswapMessage.blockPresenceSize(et.cid),data:{isWantBlock:et.wantType===WantType.Block,blockSize:0,haveBlock:!1,sendDontHave:et.sendDontHave}});else{const nt=this._sendAsBlock(et.wantType,rt);let it=rt;nt||(it=BitswapMessage.blockPresenceSize(et.cid)),_e.push({topic:tt,priority:et.priority,size:it,data:{isWantBlock:nt,blockSize:rt,haveBlock:!0,sendDontHave:et.sendDontHave}})}this._requestQueue.pushTasks(a,_e)}}_sendAsBlock(a,$){return a===WantType.Block||$<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(a){const $=await this._getBlocks(a);return new Map([...$].map(([j,_e])=>[j,_e.length]))}async _getBlocks(a){const $=new Map;return await Promise.all(a.map(async j=>{try{const _e=await this.blockstore.get(j);$.set(j.toString(base58btc$2),_e)}catch(_e){_e.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",j,_e)}})),$}_updateBlockAccounting(a,$){for(const j of a.values())this._log("got block (%s bytes)",j.length),$.receivedBytes(j.length)}messageSent(a,$,j){const _e=this._findOrCreate(a);_e.sentBytes(j.length),_e.wantlist.remove($)}numBytesSentTo(a){return this._findOrCreate(a).accounting.bytesSent}numBytesReceivedFrom(a){return this._findOrCreate(a).accounting.bytesRecv}peerDisconnected(a){this.ledgerMap.delete(a.toString())}_findOrCreate(a){const $=a.toString(),j=this.ledgerMap.get($);if(j)return j;const _e=new Ledger(a);return this.ledgerMap.set($,_e),this._stats&&this._stats.push($,"peerCount",1),_e}start(){this._running=!0}stop(){this._running=!1}}const unwantEvent=_=>`unwant:${toString$6(_.multihash.bytes,"base64")}`,blockEvent=_=>`block:${toString$6(_.multihash.bytes,"base64")}`;class Notifications extends events.exports.EventEmitter{constructor(a){super(),this.setMaxListeners(maxListeners),this._log=logger(a,"notif")}hasBlock(a,$){const j=blockEvent(a);this._log(j),this.emit(j,$)}wantBlock(a,$={}){if(!a)throw new Error("Not a valid cid");const j=blockEvent(a),_e=unwantEvent(a);return this._log(`wantBlock:${a}`),new Promise((et,tt)=>{const rt=()=>{this.removeListener(j,nt),tt(new Error(`Block for ${a} unwanted`))},nt=it=>{this.removeListener(_e,rt),et(it)};this.once(_e,rt),this.once(j,nt),$&&$.signal&&$.signal.addEventListener("abort",()=>{this.removeListener(j,nt),this.removeListener(_e,rt),tt(new Error(`Want for ${a} aborted`))})})}unwantBlock(a){const $=unwantEvent(a);this._log($),this.emit($)}}var movingAverage={exports:{}};(function(_,a){const $=Math.exp;_.exports=function(_e){if(typeof _e!="number")throw new Error("must provide a timespan to the moving average constructor");if(_e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let et,tt=0,rt=0,nt=0,it,st={};function ot(at,lt){return 1-$(-(at-lt)/_e)}return st.push=function(lt,ct){if(it){const ut=ot(lt,it),dt=ct-et,ft=ut*dt;et=ut*ct+(1-ut)*et,tt=(1-ut)*(tt+dt*ft),rt=Math.sqrt(tt),nt=et+ut*dt}else et=ct;it=lt},st.movingAverage=function(){return et},st.variance=function(){return tt},st.deviation=function(){return rt},st.forecast=function(){return nt},st}})(movingAverage);const MovingAverage=movingAverage.exports;class Stat extends events.exports.EventEmitter{constructor(a,$){super(),this._options=$,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),a.forEach(j=>{this._stats[j]=BigInt(0),this._movingAverages[j]={},this._options.movingAverageIntervals.forEach(_e=>{(this._movingAverages[j][_e]=MovingAverage(_e)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(a,$){this._enabled&&(this._queue.push([a,$,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){const a=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-a),0)}_update(){if(this._timeout=null,this._queue.length){let a;for(;this._queue.length;){const $=a=this._queue.shift();$&&this._applyOp($)}a&&this._updateFrequency(a[2]),this.emit("update",this._stats)}}_updateFrequency(a){const $=a-this._frequencyLastTime;$&&Object.keys(this._stats).forEach(j=>{this._updateFrequencyFor(j,$,a)}),this._frequencyLastTime=a}_updateFrequencyFor(a,$,j){const _e=this._frequencyAccumulators[a]||0;this._frequencyAccumulators[a]=0;const et=_e/$*1e3;let tt=this._movingAverages[a];tt||(tt=this._movingAverages[a]={}),this._options.movingAverageIntervals.forEach(rt=>{let nt=tt[rt];nt||(nt=tt[rt]=MovingAverage(rt)),nt.push(j,et)})}_applyOp(a){const $=a[0],j=a[1];if(typeof j!="number")throw new Error(`invalid increment number: ${j}`);Object.prototype.hasOwnProperty.call(this._stats,$)||(this._stats[$]=BigInt(0)),this._stats[$]=BigInt(this._stats[$])+BigInt(j),this._frequencyAccumulators[$]||(this._frequencyAccumulators[$]=0),this._frequencyAccumulators[$]+=j}}const defaultOptions$1={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]};class Stats extends events.exports.EventEmitter{constructor(a,$=[],j=defaultOptions$1){super();const _e=Object.assign({},defaultOptions$1,j);if(typeof _e.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof _e.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=$,this._options=_e,this._enabled=this._options.enabled,this._global=new Stat($,_e),this._global.on("update",et=>this.emit("update",et)),this._peers=trackedMap({system:"ipfs",component:"bitswap",metric:"stats-peers",metrics:a.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(const a of this._peers)a[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(a){const $=typeof a!="string"&&a.toString?a.toString():`${a}`;return this._peers.get($)}push(a,$,j){if(this._enabled&&(this._global.push($,j),a)){let _e=this._peers.get(a);_e||(_e=new Stat(this._initialCounters,this._options),this._peers.set(a,_e)),_e.push($,j)}}disconnected(a){const $=a.toString(),j=this._peers.get($);j&&(j.stop(),this._peers.delete($))}}const defaultOptions={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},statsKeys=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"];class Bitswap extends BaseBlockstore{constructor(a,$,j={}){super(),this._libp2p=a,this._log=logger(this.peerId),this._options=Object.assign({},defaultOptions,j),this._stats=new Stats(a,statsKeys,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new Network$1(a,this,this._stats,{hashLoader:j.hashLoader,maxInboundStreams:j.maxInboundStreams,maxOutboundStreams:j.maxOutboundStreams,incomingStreamTimeout:j.incomingStreamTimeout}),this.blockstore=$,this.engine=new DecisionEngine(this.peerId,$,this.network,this._stats,a),this.wm=new WantManager(this.peerId,this.network,this._stats,a),this.notifications=new Notifications(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(a,$){try{await this.engine.messageReceived(a,$)}catch{this._log("failed to receive message",$)}if($.blocks.size===0)return;const j=[];for(const[_e,et]of $.blocks.entries()){const tt=CID.parse(_e);j.push({wasWanted:this.wm.wantlist.contains(tt),cid:tt,data:et})}this.wm.cancelWants(j.filter(({wasWanted:_e})=>_e).map(({cid:_e})=>_e)),await Promise.all(j.map(({cid:_e,wasWanted:et,data:tt})=>this._handleReceivedBlock(a,_e,tt,et)))}async _handleReceivedBlock(a,$,j,_e){this._log("received block");const et=await this.blockstore.has($);this._updateReceiveCounters(a.toString(),$,j,et),_e&&await this.put($,j)}_updateReceiveCounters(a,$,j,_e){this._stats.push(a,"blocksReceived",1),this._stats.push(a,"dataReceived",j.length),_e&&(this._stats.push(a,"dupBlksReceived",1),this._stats.push(a,"dupDataReceived",j.length))}_receiveError(a){this._log.error("ReceiveError: %s",a.message)}_onPeerConnected(a){this.wm.connected(a)}_onPeerDisconnected(a){this.wm.disconnected(a),this.engine.peerDisconnected(a),this._stats.disconnected(a)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(a,$){return this.engine.wantlistForPeer(a)}ledgerForPeer(a){return this.engine.ledgerForPeer(a)}async get(a,$={}){const j=(nt,it)=>(this.wm.wantBlocks([nt],it),this.notifications.wantBlock(nt,it));let _e=!1;const et=async(nt,it)=>{try{return await this.blockstore.get(nt,it)}catch(st){if(st.code!=="ERR_NOT_FOUND")throw st;return _e||(_e=!0,this.network.findAndConnect(nt,it).catch(ot=>this._log.error(ot))),j(nt,it)}},tt=new AbortController,rt=$.signal?anySignal_2([$.signal,tt.signal]):tt.signal;try{return await Promise.race([this.notifications.wantBlock(a,{signal:rt}),et(a,{signal:rt})])}finally{tt.abort()}}async*getMany(a,$={}){for await(const j of a)yield this.get(j,$)}unwant(a){const $=Array.isArray(a)?a:[a];this.wm.unwantBlocks($),$.forEach(j=>this.notifications.unwantBlock(j))}cancelWants(a){this.wm.cancelWants(Array.isArray(a)?a:[a])}async put(a,$,j){await this.blockstore.put(a,$),this._sendHaveBlockNotifications(a,$)}async*putMany(a,$){for await(const{key:j,value:_e}of this.blockstore.putMany(a,$))this._sendHaveBlockNotifications(j,_e),yield{key:j,value:_e}}_sendHaveBlockNotifications(a,$){this.notifications.hasBlock(a,$),this.engine.receivedBlocks([{cid:a,data:$}]),this.network.provide(a).catch(j=>{this._log.error("Failed to provide: %s",j.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this._stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}}const createBitswap=(_,a,$={})=>new Bitswap(_,a,$);function notFoundError(_){return _=_||new Error("Not Found"),errCode(_,"ERR_NOT_FOUND")}function abortedError(_){return _=_||new Error("Aborted"),errCode(_,"ERR_ABORTED")}const ErrorsImport=Object.freeze(Object.defineProperty({__proto__:null,notFoundError,abortedError},Symbol.toStringTag,{value:"Module"}));({...ErrorsImport});class BlockStorage extends BaseBlockstore{constructor(a,$){super(),this.child=a,this.bitswap=$}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(a,$,j={}){await this.has(a)||(this.bitswap.isStarted()?await this.bitswap.put(a,$,j):await this.child.put(a,$,j))}async*putMany(a,$={}){const j=filter$3(a,async({key:_e})=>!await this.has(_e));this.bitswap.isStarted()?yield*this.bitswap.putMany(j,$):yield*this.child.putMany(j,$)}async get(a,$={}){return!await this.has(a)&&this.bitswap.isStarted()?this.bitswap.get(a,$):this.child.get(a,$)}async*getMany(a,$={}){const j=pushable$2({objectMode:!0}),_e=pushable$2({objectMode:!0});Promise.resolve().then(async()=>{for await(const et of a)!await this.has(et)&&this.bitswap.isStarted()?j.push(et):_e.push(et);j.end(),_e.end()}),yield*merge$2(this.bitswap.getMany(j,$),this.child.getMany(_e,$))}async delete(a,$){await this.child.delete(a,$)}async*deleteMany(a,$){yield*this.child.deleteMany(a,$)}async has(a,$={}){return this.child.has(a,$)}async*query(a,$={}){yield*this.child.query(a,$)}async*queryKeys(a,$={}){yield*this.child.queryKeys(a,$)}}class Network{constructor(a,$,j,_e,et){this.peerId=a,this.libp2p=$,this.bitswap=j,this.repo=_e,this.blockstore=et}static async start({peerId:a,repo:$,print:j,hashers:_e,options:et}){$.closed&&await $.open();const tt=await $.config.getAll(),rt=await createLibp2p({options:et,repo:$,peerId:a,multiaddrs:readAddrs(a,tt),config:tt,keychainConfig:void 0});await rt.start();for(const st of rt.getMultiaddrs())j(`Swarm listening on ${st.toString()}`);const nt=createBitswap(rt,$.blocks,{statsEnabled:!0,hashLoader:_e,maxInboundStreams:1024,maxOutboundStreams:1024});await nt.start();const it=new BlockStorage($.blocks,nt);return $.blocks=it,$.pins.blockstore=it,new Network(a,rt,nt,$,it)}static async stop(a){a.repo.blocks=a.blockstore.unwrap(),a.repo.pins.blockstore=a.blockstore.unwrap(),await a.bitswap.stop(),await a.libp2p.stop()}}const readAddrs=(_,a)=>{const $=_.toString(),j=[],_e=a.Addresses&&a.Addresses.Swarm||[];for(const et of _e){let tt=multiaddr(et);if(tt.protoCodes().includes(WEBSOCKET_STAR_PROTO_CODE))throw errCode(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");const rt=tt.getPeerId();rt&&rt!==$&&(tt=tt.encapsulate(`/p2p/${$}`)),j.push(tt)}return j},WEBSOCKET_STAR_PROTO_CODE=479;function createAddrs({network:_}){async function a($={}){const j=[],{libp2p:_e}=await _.use($);return await _e.peerStore.forEach(et=>{j.push({id:et.id,addrs:et.addresses.map(tt=>tt.multiaddr)})}),j}return withTimeoutOption(a)}function createConnect({network:_}){async function a($,j={}){const{libp2p:_e}=await _.use(j);await _e.dial($,j)}return withTimeoutOption(a)}function createDisconnect({network:_}){async function a($,j={}){const{libp2p:_e}=await _.use(j);await _e.hangUp($)}return withTimeoutOption(a)}function createLocalAddrs({network:_}){async function a($={}){const{libp2p:j}=await _.use($);return j.getMultiaddrs()}return withTimeoutOption(a)}function createPeers({network:_}){async function a($={}){const{libp2p:j}=await _.use($);if($.verbose){const et=[];for(const tt of j.getConnections()){const rt={addr:tt.remoteAddr,peer:tt.remotePeer};($.verbose||$.direction)&&(rt.direction=tt.stat.direction),$.verbose&&(rt.muxer=tt.stat.multiplexer,rt.latency="n/a",rt.streams=[]),et.push(rt)}return et}const _e=new Map;for(const et of j.getConnections()){const tt={addr:et.remoteAddr,peer:et.remotePeer};_e.set(et.remotePeer.toString(),tt)}return Array.from(_e.values())}return withTimeoutOption(a)}class SwarmAPI{constructor({network:a}){this.addrs=createAddrs({network:a}),this.connect=createConnect({network:a}),this.disconnect=createDisconnect({network:a}),this.localAddrs=createLocalAddrs({network:a}),this.peers=createPeers({network:a})}}const basePacket={success:!0,time:0,text:""};function createPing({network:_}){async function*a($,j={}){const{libp2p:_e}=await _.use();j.count=j.count||10;const et=await _e.peerStore.get($);let tt=et&&et.id;if(!tt){yield{...basePacket,text:`Looking up peer ${$}`};const it=await _e.peerRouting.findPeer($);tt=it&&it.id}if(!tt)throw new Error("Peer was not found");yield{...basePacket,text:`PING ${tt.toString()}`};let rt=0,nt=0;for(let it=0;it<j.count;it++)try{const st=await _e.ping(tt);nt+=st,rt++,yield{...basePacket,time:st}}catch(st){yield{...basePacket,success:!1,text:st.toString()}}if(rt){const it=nt/rt;yield{...basePacket,text:`Average latency: ${it}ms`}}}return withTimeoutOption(a)}const IPNS_PREFIX="/ipns/";function toDHTKey(_){_.startsWith(IPNS_PREFIX)&&(_=_.substring(IPNS_PREFIX.length));let a;if((_[0]==="1"||_[0]==="Q")&&(_=`z${_}`),_[0]==="z"&&(a=base58btc$2.decode(_)),_[0]==="k"&&(a=base36$4.decode(_)),!a)throw new Error("Could not parse string");if(a[0]!==1&&a[1]!==114&&(a=concat$1([[1,114],a])),a.length!==40)throw new Error("Incorrect length "+a.length);return concat$1([fromString$5(IPNS_PREFIX),a.subarray(2)])}function createDht({network:_,repo:a,peerId:$}){const{get:j,put:_e,findProvs:et,findPeer:tt,provide:rt,query:nt}={async*get(it,st={}){const{libp2p:ot}=await use(_,$,st),at=it instanceof Uint8Array?it:toDHTKey(it);if(ot.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*ot.dht.get(at,st)},async*put(it,st,ot){const{libp2p:at}=await use(_,$,ot),lt=it instanceof Uint8Array?it:toDHTKey(it);if(at.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*at.dht.put(lt,st,ot)},async*findProvs(it,st={}){const{libp2p:ot}=await use(_,$,st);if(ot.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*ot.dht.findProviders(it,{signal:st.signal})},async*findPeer(it,st={}){const{libp2p:ot}=await use(_,$,st);if(ot.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*ot.dht.findPeer(it,{signal:st.signal})},async*provide(it,st={recursive:!1}){const{libp2p:ot}=await use(_,$,st);if(!await a.blocks.has(it))throw errCode(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(st.recursive)throw errCode(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");if(ot.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*ot.dht.provide(it)},async*query(it,st={}){const{libp2p:ot}=await use(_,$,st);let at;const lt=CID.asCID(it);if(lt!=null?at=lt.multihash.bytes:at=peerIdFromString(it.toString()).toBytes(),ot.dht==null)throw errCode(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*ot.dht.getClosestPeers(at,st)}};return{get:withTimeoutOption(j),put:withTimeoutOption(_e),findProvs:withTimeoutOption(et),findPeer:withTimeoutOption(tt),provide:withTimeoutOption(rt),query:withTimeoutOption(nt)}}const use=async(_,a,$)=>{const j=await _.use($);if(j.libp2p.dht!=null)return j;{const _e=async function*(){yield{from:a,name:"QUERY_ERROR",type:3,error:new NotEnabledError("dht not enabled")}};return{libp2p:{dht:{get:_e,put:_e,findProviders:_e,findPeer:_e,provide:_e,getClosestPeers:_e}}}}};function createPubsub({network:_,config:a}){const $=get$2(a||{},"Pubsub.Enabled",!0),j={};let _e;return{subscribe:$?withTimeoutOption(et):notEnabled,unsubscribe:$?withTimeoutOption(tt):notEnabled,publish:$?withTimeoutOption(rt):notEnabled,ls:$?withTimeoutOption(nt):notEnabled,peers:$?withTimeoutOption(it):notEnabled};async function et(st,ot,at={}){const{libp2p:lt}=await _.use(at);lt.pubsub.subscribe(st),_e==null&&(_e=ct=>{const ut=ct.detail;j[ut.topic]&&j[ut.topic].forEach(dt=>{if(typeof dt=="function"){dt(ut);return}dt!=null&&dt.handleEvent!=null&&dt.handleEvent(ut)})},lt.pubsub.addEventListener("message",_e)),ot!=null&&(j[st]==null&&(j[st]=[]),j[st].push(ot))}async function tt(st,ot,at={}){const{libp2p:lt}=await _.use(at);ot!=null&&j[st]!=null&&(j[st]=j[st].filter(ct=>ct!==ot),j[st].length===0&&delete j[st]),typeof ot!="function"&&delete j[st],j[st]==null&&lt.pubsub.unsubscribe(st),Object.keys(j).length===0&&(lt.pubsub.removeEventListener("message",_e),_e=void 0)}async function rt(st,ot,at={}){const{libp2p:lt}=await _.use(at);if(!ot)throw errCode(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await lt.pubsub.publish(st,ot)}async function nt(st={}){const{libp2p:ot}=await _.use(st);return ot.pubsub.getTopics()}async function it(st,ot={}){const{libp2p:at}=await _.use(ot);return at.pubsub.getSubscribers(st)}}const notEnabled=async()=>{throw new NotEnabledError("pubsub not enabled")},mergeOptions=mergeOptions$g.bind({ignoreUndefined:!0}),log=logger$1("ipfs"),IPNS_INIT_KEYSPACE_TIMEOUT=3e4;class IPFS{constructor({print:a,storage:$,codecs:j,options:_e}){const{peerId:et,repo:tt,keychain:rt}=$,nt=Service.create(Network),it=createPreloader(_e.preload),st=createDns$1(),ot=createIsOnline$1({network:nt}),at=new IPNSAPI(_e),lt=Object.values(hashes);(_e.ipld&&_e.ipld.hashers?_e.ipld.hashers:[]).forEach(gt=>lt.push(gt)),this.hashers=new Multihashes({hashers:lt,loadHasher:_e.ipld&&_e.ipld.loadHasher});const ct=Object.values(bases$2);(_e.ipld&&_e.ipld.bases?_e.ipld.bases:[]).forEach(gt=>ct.push(gt)),this.bases=new Multibases({bases:ct,loadBase:_e.ipld&&_e.ipld.loadBase});const ut=new PinAPI({repo:tt,codecs:j}),dt=new BlockAPI({codecs:j,hashers:this.hashers,preload:it,repo:tt}),ft=new NameAPI({dns:st,ipns:at,repo:tt,codecs:j,peerId:et,isOnline:ot,keychain:rt,options:_e}),pt=createResolve$5({repo:tt,codecs:j,bases:this.bases,name:ft}),yt=new DagAPI({repo:tt,codecs:j,hashers:this.hashers,preload:it}),mt=Object.assign(createRefs$1({repo:tt,codecs:j,resolve:pt,preload:it}),{local:createLocal$1({repo:$.repo})}),{add:_t,addAll:vt,cat:ht,get:St,ls:It}=new RootAPI({preload:it,repo:tt,options:_e.EXPERIMENTAL,hashers:this.hashers}),Lt=createFiles$1({repo:tt,preload:it,hashers:this.hashers,options:_e}),Mt=createMfsPreloader({files:Lt,preload:it,options:_e.preload});this.preload=it,this.name=ft,this.ipns=at,this.pin=ut,this.resolve=pt,this.block=dt,this.refs=mt,this.start=createStart$1({network:nt,peerId:et,repo:tt,preload:it,ipns:at,mfsPreload:Mt,print:a,keychain:rt,hashers:this.hashers,options:_e}),this.stop=createStop$1({network:nt,preload:it,mfsPreload:Mt,ipns:at,repo:tt}),this.dht=createDht({network:nt,repo:tt,peerId:et}),this.pubsub=createPubsub({network:nt,config:_e.config}),this.dns=st,this.isOnline=ot,this.id=createId$1({network:nt,peerId:et}),this.version=createVersion$3({repo:tt}),this.bitswap=new BitswapAPI({network:nt}),this.bootstrap=new BootstrapAPI({repo:tt}),this.config=createConfig$1({repo:tt}),this.ping=createPing({network:nt}),this.add=_t,this.addAll=vt,this.cat=ht,this.get=St,this.ls=It,this.dag=yt,this.files=Lt,this.key=new KeyAPI({keychain:rt}),this.object=new ObjectAPI({preload:it,codecs:j,repo:tt}),this.repo=new RepoAPI({repo:tt,hashers:this.hashers}),this.stats=new StatsAPI({repo:tt,network:nt}),this.swarm=new SwarmAPI({network:nt}),Object.defineProperty(this,"libp2p",{get(){const gt=nt.try();return gt?gt.libp2p:void 0}});const Kt=()=>Promise.reject(errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),kt=async function*(){throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=Kt,this.diag={cmds:Kt,net:Kt,sys:Kt},this.log={level:Kt,ls:Kt,tail:kt},this.mount=Kt,this.codecs=j}async init(){throw new AlreadyInitializedError}}const addEmptyDir=async _=>{const a=encode$s({Data:new UnixFS({type:"directory"}).marshal(),Links:[]}),$=await _.block.put(a,{mhtype:"sha2-256",format:"dag-pb"});return await _.pin.add($),$},getDefaultOptions=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!env.isTest,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}});async function create$2(_={}){_=mergeOptions(getDefaultOptions(),_);const a=_.init||{},$={name:identity$8.name,code:identity$8.code,encode:it=>it,decode:it=>it},j=Object.values(codecs);[dagPB,dagCBOR,dagJSON,dagJOSE,$].concat(_.ipld&&_.ipld.codecs||[]).forEach(it=>j.push(it));const _e=new Multicodecs({codecs:j,loadCodec:_.ipld&&_.ipld.loadCodec}),et=_.silent?log:console.log;log("creating repo");const tt=await Storage.start(et,_e,_);log("getting repo config");const rt=await tt.repo.config.getAll(),nt=new IPFS({storage:tt,print:et,codecs:_e,options:{..._,config:rt}});if(log("starting preload"),await nt.preload.start(),log("starting storage"),nt.ipns.startOffline(tt),tt.isNew&&!a.emptyRepo){const it=await addEmptyDir(nt);if(log("adding default assets"),await(nt.addAll,void 0),log("initializing IPNS keyspace"),tt.peerId.publicKey==null)throw errCode(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");const st=new timeoutAbortController.TimeoutController(IPNS_INIT_KEYSPACE_TIMEOUT);try{await nt.ipns.initializeKeyspace(tt.peerId,fromString$5(`/ipfs/${it}`),{signal:st.signal})}finally{st.clear()}}return _.start!==!1&&(log("starting node"),await nt.start()),nt}const create$1=create$2,create=create$1,Zr=class{constructor(){en(this,"node")}async init(){this.node=await create()}static async getInstance(){return Zr.instance||(Zr.instance=new Zr,await Zr.instance.init()),Zr.instance}};let IPFSNode=Zr;en(IPFSNode,"instance");function useIPFS(){const[_,a]=react.exports.useState();react.exports.useEffect(()=>{IPFSNode.getInstance().then(_e=>{_e&&_e.node&&a(_e.node)})},[]);const $=async _e=>_?await all$5(_.addAll(_e.stream(),{preload:!0})):void 0,j=react.exports.useCallback(async(_e,et=tt=>{})=>{if(!_)throw Error("IPFS not ready");const tt=[];for(let rt of _e){const nt=await $(rt);if(nt&&nt[0]){const it={name:rt.name,type:rt.type,size:rt.size,cid:nt[0].cid.toString(),path:nt[0].path,url:`https://ipfs.io/ipfs/${nt[0].path}`};tt.push(it),et(tt.length/_e.length*100)}}return tt},[_]);return{ipfs:_,uploadFiles:j}}const address="0xc372e7F2139ea586014F2726e918e5BE1AFfe57A",provider=new JsonRpcProvider("https://polygon-mumbai.g.alchemy.com/v2/N-LPtcE6Zw7lEYnucIcMN-P2JbzaKxd6"),abi=[{inputs:[{internalType:"address",name:"_vrfConsumerAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"uint256",name:"songId",type:"uint256"}],name:"getSongMetadata",outputs:[{components:[{internalType:"uint256",name:"price",type:"uint256"},{internalType:"string",name:"name",type:"string"},{internalType:"uint256",name:"authorCoverTokenId",type:"uint256"},{internalType:"uint256",name:"authorAudioTokenId",type:"uint256"},{internalType:"uint256",name:"coverCollectionId",type:"uint256"},{internalType:"string",name:"authorCoverUri",type:"string"},{internalType:"string",name:"audioUri",type:"string"},{internalType:"string[]",name:"tokenUris",type:"string[]"}],internalType:"struct ProtoSound.SongMetadata",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"getSongs",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"price",type:"uint256"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"authorCoverUri",type:"string"},{internalType:"string",name:"audioUri",type:"string"},{internalType:"string[]",name:"tokenUris",type:"string[]"}],name:"mintSong",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"songAuthorAudioAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"songAuthorCoverAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"songCoverAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"songMetadata",outputs:[{internalType:"uint256",name:"price",type:"uint256"},{internalType:"string",name:"name",type:"string"},{internalType:"uint256",name:"authorCoverTokenId",type:"uint256"},{internalType:"uint256",name:"authorAudioTokenId",type:"uint256"},{internalType:"uint256",name:"coverCollectionId",type:"uint256"},{internalType:"string",name:"authorCoverUri",type:"string"},{internalType:"string",name:"audioUri",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"songs",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address payable",name:"artist",type:"address"},{internalType:"uint256",name:"collectionId",type:"uint256"}],name:"transferSongCover",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"updateSongAuthorAudioAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"updateSongAuthorCoverAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"updateSongCoverAddress",outputs:[],stateMutability:"nonpayable",type:"function"}];function useProtosoundContract(){const[_,a]=react.exports.useState();react.exports.useEffect(()=>{new Contract(address,abi,provider).deployed().then(_e=>{a(_e)})},[]);const $=react.exports.useCallback(async j=>{if(_)return _.connect(j)},[_]);return{protosound:_,sign:$}}const songReleaseImage="/assets/release.d1e5d2fb.png";function ProfileHeader({address:_}){const[a,$]=react.exports.useState(!1),[j,_e]=react.exports.useState(!1),[et,tt]=react.exports.useState(!1),[rt,nt]=react.exports.useState(""),{ipfs:it,uploadFiles:st}=useIPFS(),{signer:ot,connect:at}=useMetamask(),{protosound:lt,sign:ct}=useProtosoundContract(),[ut,dt]=react.exports.useState(""),[ft,pt]=react.exports.useState(),[yt,mt]=react.exports.useState(!1),[_t,vt]=react.exports.useState(!1),[ht,St]=react.exports.useState(!1),[It,Lt]=react.exports.useState(null),[Mt,Kt]=react.exports.useState(null),[kt,gt]=react.exports.useState([]);react.exports.useEffect(()=>{at()},[]);const Et=react.exports.useCallback(async()=>{if(!lt||!it||!ot)return console.log("Loading resources!");if(rt&&nt(""),!It||!Mt||!kt||!ut||!ft)return nt("Must complete all the fields");_e(!0),mt(!0);const[xt]=await st([It]);mt(!1),vt(!0);const[Tt]=await st([Mt]);vt(!1),St(!0);const At=await st(kt);St(!1);const Nt=await ct(ot);if(!Nt)throw Error("something unexpected happened");tt(!0),await(await Nt.functions.mintSong(ft,ut,xt.url,Tt.url,At.map(Ot=>Ot.url))).wait(),tt(!1),_e(!1),window.location.reload()},[it,ft,ut,It,Mt,kt,lt,ot]);return jsxs(Fragment$1,{children:[jsxs(Group,{style:{justifyContent:"space-between"},my:"md",children:[jsxs(Group,{children:[jsx(Avatar,{radius:"xl",src:`https://avatars.dicebear.com/api/identicon/${_}.svg`}),jsx("div",{children:jsx(Text,{size:"sm",weight:200,children:_})})]}),jsx(Button,{leftIcon:jsx(ghe,{}),onClick:()=>$(!a),children:"Release Song"})]}),jsxs(Modal,{opened:a,onClose:()=>$(!1),title:"Release a new Song",size:"md",children:[jsx(Image,{src:songReleaseImage,alt:"song release",height:150,fit:"cover",radius:"lg"}),jsxs("div",{children:[jsx(LoadingOverlay,{visible:!it,overlayBlur:2}),jsx(TextInput,{m:10,placeholder:"Song name",label:"Song name",withAsterisk:!0,onChange:xt=>dt(xt.target.value)}),jsx(TextInput,{m:10,placeholder:"Song price",label:"Song price",description:"The cost (in Matic) that your fans will pay for your song and minting one of the generated NFTs",withAsterisk:!0,icon:jsx(RD,{size:14}),type:"number",onChange:xt=>pt(Number(xt.target.value))}),jsx(FileInput,{m:10,label:"Soulbound cover (image)",placeholder:"Soulbound cover (image)",withAsterisk:!0,description:"The image Soulbound token, it is a visual representation of your song",accept:"image/png,image/jpeg",rightSection:yt&&jsx(Loader,{size:"xs"}),onChange:Lt,icon:jsx(dIe,{size:14})}),jsx(FileInput,{m:10,label:"Soulbound song (audio)",placeholder:"Soulbound song (audio)",withAsterisk:!0,description:"The audio Soulbound token, and its your actual song, it will belong to you forever since you are the author",accept:".mp3,audio/*",rightSection:_t&&jsx(Loader,{size:"xs"}),onChange:Kt,icon:jsx(dIe,{size:14})}),jsx(FileInput,{m:10,label:"NFT collection (images)",placeholder:"Soulbound song (images)",withAsterisk:!0,description:"The NFT collection that will be minted and for sell, when your fans buy your song, they also will receive one token from the collection randomly",multiple:!0,accept:"image/png,image/jpeg",rightSection:ht&&jsx(Loader,{size:"xs"}),onChange:gt,icon:jsx(dIe,{size:14})}),jsxs(Group,{m:10,style:{justifyContent:"right"},children:[rt&&jsx(Alert,{color:"red",children:rt}),j&&jsx(Loader,{size:"xs"}),jsx(Button,{disabled:!it||!lt||j,leftIcon:jsx(ghe,{}),onClick:()=>Et(),children:"Release"})]})]})]}),j&&jsx(Notification,{loading:!0,disallowClose:!0,title:et?"Minting tokens":"Uploading Files",children:et?"Your Soulbound and NFT tokens are in process of minting":"Your song files and nfts are being uploaded to IPFS decentralized storage."})]})}const useStyles$2=createStyles(_=>({badge:{width:"100%",position:"absolute",top:"24px",right:"24px"},audio:{width:"100%","&::-webkit-media-controls-panel":{backgroundColor:"transparent"},"&::-webkit-media-controls-enclosure":{backgroundColor:"transparent"},"&::-webkit-media-controls-current-time-display":{display:"none"},"&::-webkit-media-controls-time-remaining-display":{display:"none"}}}));function UserCollected(){const{classes:_}=useStyles$2();react.exports.useState(!0);const a=mockdata.map($=>jsxs(Card,{withBorder:!0,radius:"md",p:"md",children:[jsxs(Card.Section,{children:[jsx(Image,{src:$.image,alt:$.name,height:200}),jsx(Group,{position:"right",className:_.badge,children:jsx(Badge,{children:"NFT"})})]}),jsxs(Card.Section,{p:"md",children:[jsx(Text,{size:"xs",color:"dimmed",children:$.author}),jsx(Text,{size:"sm",weight:500,children:$.name})]}),jsx(Card.Section,{children:jsx(Center,{children:jsx("audio",{className:_.audio,src:$.audio,controls:!0})})})]},$.name));return jsxs(Box,{children:[jsx(WIPAlert,{}),jsx(Overlay,{blur:2,style:{top:320},zIndex:2,opacity:0}),jsx(SimpleGrid,{cols:3,mt:"md",breakpoints:[{maxWidth:"sm",cols:1},{maxWidth:"md",cols:2}],children:a})]})}const size=9;function GridLoader(){return jsx(SimpleGrid,{cols:3,mt:"md",breakpoints:[{maxWidth:"sm",cols:1},{maxWidth:"md",cols:2}],children:[...Array(size)].map((_,a)=>jsx(Skeleton,{height:300},a))})}const useStyles$1=createStyles(_=>({card:{height:300,display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"flex-start",backgroundSize:"cover",backgroundPositionY:"100%",transition:"transform 500ms ease",["&:hover"]:{transform:"scale(1.03)"},cursor:"pointer"},group:{width:"100%"},title:{color:"#fafafa",fontWeight:500,fontSize:20},subtitle:{color:"#efefef",fontWeight:400,fontSize:15},stack:{gap:0},audio:{width:"100%","&::-webkit-media-controls-panel":{backgroundColor:"transparent"},"&::-webkit-media-controls-enclosure":{backgroundColor:"transparent"},"&::-webkit-media-controls-current-time-display":{display:"none"},"&::-webkit-media-controls-time-remaining-display":{display:"none"}}})),exampleRelease={name:"Example song",author:"Marcos Carlomagno, Luis Lopez, Agust\xEDn Longoni",audio:"https://file-examples.com/storage/fe04183d33637128a9c93a7/2017/11/file_example_MP3_1MG.mp3",image:"https://images.unsplash.com/photo-1470225620780-dba8ba36b745?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80",price:20,covers:["https://images.unsplash.com/photo-1461784180009-21121b2f204c?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80","https://images.unsplash.com/photo-1542628682-88321d2a4828?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80","https://images.unsplash.com/photo-1526979118433-63c7344f06f1?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80","https://images.unsplash.com/photo-1513866942102-cfdd82745c6a?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1841&q=80","https://images.unsplash.com/photo-1651065700017-a741fc4a7f26?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MzR8fERKfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=800&q=60","https://images.unsplash.com/photo-1577930595497-05902654453e?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=688&q=80"]};function Release({name:_,author:a,audio:$,image:j,price:_e,covers:et}){const{classes:tt}=useStyles$1(),[rt,nt]=react.exports.useState(!1),it=et.map((st,ot)=>jsxs("div",{style:{position:"relative"},children:[jsx(Image,{src:st,alt:_,height:200,radius:"lg"}),jsx(Badge,{style:{position:"absolute",top:"15px",right:"20px"},children:"NFT"})]},ot));return jsxs(Paper,{shadow:"md",p:"xl",radius:"lg",sx:{backgroundImage:`linear-gradient(0deg, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.5)), url(${j})`},className:tt.card,onClick:()=>nt(!rt),children:[jsx(Group,{position:"right",className:tt.group,children:jsx(Badge,{children:"Soulbound NFT"})}),jsx(Group,{className:tt.group,children:jsx(Stack,{className:tt.stack,children:jsx(Text,{className:tt.title,children:_})})}),jsxs(Modal,{opened:rt,onClose:()=>nt(!1),title:jsx(Title,{order:3,children:_}),size:"xl",children:[jsxs("div",{style:{position:"relative"},children:[jsx(Image,{src:j,alt:_,height:200,radius:"lg"}),jsx(Badge,{style:{position:"absolute",top:"15px",right:"20px"},children:"Soulbound"})]}),jsx(Card,{children:jsxs(Center,{children:[jsx(Badge,{style:{minWidth:"100px"},children:"Soulbound"}),jsx("audio",{className:tt.audio,src:$,controls:!0})]})}),jsxs(Card,{withBorder:!0,children:[jsxs(Group,{m:10,style:{justifyContent:"space-between"},children:[jsx(Title,{order:4,children:"NFT Collection"}),jsxs(Badge,{color:"green",children:["Price: ",_e," Matic"]})]}),jsx(SimpleGrid,{cols:3,style:{maxHeight:200,overflowY:"scroll"},mt:"md",breakpoints:[{maxWidth:"sm",cols:2}],children:it})]})]})]},_)}function UserReleases(){const{accounts:_,getAccounts:a}=useMetamask(),{protosound:$}=useProtosoundContract(),[j,_e]=react.exports.useState(!1),[et,tt]=react.exports.useState([]);return react.exports.useEffect(()=>{a()},[]),react.exports.useEffect(()=>{if(_[0]&&$&&!j){_e(!0);const rt=_[0];$.functions.getSongs(rt).then(async nt=>{const it=nt[0].map(Number);console.log(it);for(let st of it){const[ot]=await $.functions.getSongMetadata(st),at={name:ot.name,audio:ot.audioUri,author:rt,image:ot.authorCoverUri,price:Number(ot.price),covers:ot.tokenUris};tt(lt=>[...lt,at])}_e(!1)})}},[_,$]),j?jsx(GridLoader,{}):jsx(SimpleGrid,{cols:3,mt:"md",breakpoints:[{maxWidth:"sm",cols:1},{maxWidth:"md",cols:2}],children:et.length>0?et.map((rt,nt)=>jsx(Release,{...rt},nt)):jsx(Release,{...exampleRelease},1)})}function Feed(){const{accounts:_,getAccounts:a}=useMetamask();return react.exports.useEffect(()=>{a()},[]),jsx(Container,{children:_[0]?jsxs(Fragment$1,{children:[jsx(ProfileHeader,{address:_[0]}),jsxs(Tabs,{defaultValue:"created",children:[jsxs(Tabs.List,{children:[jsx(Tabs.Tab,{value:"created",icon:jsx(zze,{size:14}),children:"Created"}),jsx(Tabs.Tab,{value:"collected",icon:jsx(Kb,{size:14}),children:"Collected"})]}),jsx(Tabs.Panel,{value:"created",pt:"xs",children:jsx(UserReleases,{})}),jsx(Tabs.Panel,{value:"collected",pt:"xs",children:jsx(UserCollected,{})})]})]}):jsx(Alert,{mx:"xl",icon:jsx(fe,{size:16}),title:"Wallet not connected",color:"cyan",children:"Press connect and start listenning and collecting songs!"})})}const useStyles=createStyles(_=>({card:{height:400,display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"flex-start",backgroundSize:"cover",backgroundPositionY:"100%",transition:"transform 500ms ease",["&:hover"]:{transform:"scale(1.03)"}},title:{fontWeight:900,color:"#fafafa",lineHeight:1.2,fontSize:32,marginTop:_.spacing.xs},description:{color:"#fafafa",opacity:.9,textShadow:"0 0 2px #000",fontWeight:700,textTransform:"uppercase"},button:{color:"black"}}));function CardBackground({image:_,title:a,description:$,buttonProps:j}){const{classes:_e}=useStyles();return jsxs(Paper,{shadow:"md",p:"xl",radius:"lg",sx:{backgroundImage:`linear-gradient(0deg, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 1)), url(${_})`},className:_e.card,children:[jsxs("div",{children:[jsx(Title,{order:3,className:_e.title,children:a}),jsx(Text,{className:_e.description,size:"sm",mt:15,children:$})]}),jsx(Link,{to:j.route,replace:!0,children:jsx(Button,{className:_e.button,variant:"white",leftIcon:j.icon==="browse"?jsx(UGe,{}):jsx(RQ,{}),children:j.label})})]})}const backgroundImages={createMintEarn:"https://images.unsplash.com/photo-1588638874655-9ff1b9c6668b?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&fit=crop&w=1470&q=80",supportListenCollect:"https://images.unsplash.com/photo-1429962714451-bb934ecdc4ec?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2940&q=80"};function Home(){return jsx(Container,{children:jsxs(SimpleGrid,{cols:2,breakpoints:[{maxWidth:"xs",cols:1}],children:[jsx(CardBackground,{image:backgroundImages.createMintEarn,title:"Create, Mint & Earn",description:"Release your song with personal song cover and a collection of album covers to engage with your fans.",buttonProps:{icon:"create",label:"Create new release",route:"profile"}}),jsx(CardBackground,{image:backgroundImages.supportListenCollect,title:"Support, Listen & Collect",description:"Browse the artists latest relases, find the music that you love and get your own NFTs.",buttonProps:{icon:"browse",label:"Browse latest releases",route:"feed"}})]})})}function App(){const[_,a]=react.exports.useState("light");return jsx(ColorSchemeProvider,{colorScheme:_,toggleColorScheme:j=>a(j||(_==="dark"?"light":"dark")),children:jsx(MantineProvider,{theme:{colorScheme:_},withGlobalStyles:!0,withNormalizeCSS:!0,children:jsx(BrowserRouter,{basename:"ProtoSound",children:jsx(AppShell,{navbarOffsetBreakpoint:"sm",asideOffsetBreakpoint:"sm",header:jsx(AppHeader,{}),children:jsxs(Routes,{children:[jsx(Route,{path:"/",element:jsx(Home,{})}),jsx(Route,{path:"/feed",element:jsx(Feed$1,{})}),jsx(Route,{path:"/profile",element:jsx(Feed,{})})]})})})})})}const index="";client.createRoot(document.getElementById("root")).render(jsx(React.StrictMode,{children:jsx(App,{})}));
